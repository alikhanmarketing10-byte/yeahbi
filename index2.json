[
  {
    "id": "3bg5VAmWsx3K3JlM",
    "meta": {
      "instanceId": "27a6ff0ad955755b3cfb05163a291648da82cf6eede255f6512cf3e601ff32ae",
      "templateCredsSetupCompleted": true
    },
    "name": "Zoho CRM - Smart Meeting Scheduler",
    "tags": [
      {
        "id": "MrPLV9qP4N9aNfVu",
        "name": "Submit",
        "createdAt": "2025-11-14T06:55:53.666Z",
        "updatedAt": "2025-11-14T06:55:53.666Z"
      }
    ],
    "nodes": [
      {
        "id": "5f5e5d7b-6d70-4c73-9f05-ffda8eb04dd8",
        "name": "New Lead Trigger",
        "type": "n8n-nodes-base.zohoCrm",
        "position": [
          -800,
          368
        ],
        "parameters": {
          "leadId": "",
          "resource": "lead",
          "operation": "get"
        },
        "credentials": {
          "zohoOAuth2Api": {
            "id": "ghfbEj1OQlzm3B24",
            "name": "Zoho account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "6fdef927-6c46-476c-89e4-3da12a64d3e8",
        "name": "Workflow Configuration",
        "type": "n8n-nodes-base.set",
        "position": [
          -496,
          368
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "id-1",
                "name": "meetingDuration",
                "type": "number",
                "value": 30
              },
              {
                "id": "id-2",
                "name": "bufferTimeBefore",
                "type": "number",
                "value": 15
              },
              {
                "id": "id-3",
                "name": "bufferTimeAfter",
                "type": "number",
                "value": 15
              },
              {
                "id": "id-4",
                "name": "daysToLookAhead",
                "type": "number",
                "value": 7
              },
              {
                "id": "id-5",
                "name": "workingHoursStart",
                "type": "string",
                "value": "09:00"
              },
              {
                "id": "id-6",
                "name": "workingHoursEnd",
                "type": "string",
                "value": "17:00"
              },
              {
                "id": "id-7",
                "name": "meetingLinkService",
                "type": "string",
                "value": "zoom"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "d74b2808-6562-446a-af66-546d93d48d80",
        "name": "Get Sales Rep Details",
        "type": "n8n-nodes-base.zohoCrm",
        "position": [
          -128,
          368
        ],
        "parameters": {
          "accountId": "",
          "operation": "get"
        },
        "credentials": {
          "zohoOAuth2Api": {
            "id": "ghfbEj1OQlzm3B24",
            "name": "Zoho account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4bd23adf-0fdf-4361-a6f2-a1947c4690c7",
        "name": "Detect Lead Timezone",
        "type": "n8n-nodes-base.code",
        "position": [
          48,
          368
        ],
        "parameters": {
          "jsCode": "const leadData = $input.first().json;\nconst phone = leadData.Phone || '';\nconst country = leadData.Country || '';\nconst state = leadData.State || '';\n\nlet timezone = 'America/New_York';\n\nif (country === 'United States' || country === 'USA') {\n  const stateTimezones = {\n    'California': 'America/Los_Angeles',\n    'New York': 'America/New_York',\n    'Texas': 'America/Chicago',\n    'Florida': 'America/New_York',\n    'Illinois': 'America/Chicago',\n    'Arizona': 'America/Phoenix'\n  };\n  timezone = stateTimezones[state] || 'America/New_York';\n} else if (country === 'United Kingdom' || country === 'UK') {\n  timezone = 'Europe/London';\n} else if (country === 'Germany') {\n  timezone = 'Europe/Berlin';\n} else if (country === 'Australia') {\n  timezone = 'Australia/Sydney';\n}\n\nreturn {\n  json: {\n    ...leadData,\n    detectedTimezone: timezone\n  }\n};"
        },
        "typeVersion": 2
      },
      {
        "id": "596b7c12-344f-4651-8986-42a4df49f61b",
        "name": "Get Rep Calendar Availability",
        "type": "n8n-nodes-base.googleCalendar",
        "position": [
          224,
          368
        ],
        "parameters": {
          "options": {},
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": ""
          },
          "operation": "getAll"
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "9Ol4XpISV1ODiA5r",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3,
        "alwaysOutputData": false
      },
      {
        "id": "3b78a1d2-bf0e-4b9b-9786-76cc39a65b25",
        "name": "Find Available Slots with Buffer",
        "type": "n8n-nodes-base.code",
        "position": [
          448,
          368
        ],
        "parameters": {
          "jsCode": "const config = $('Workflow Configuration').first().json;\nconst events = $input.all().map(item => item.json);\nconst meetingDuration = config.meetingDuration;\nconst bufferBefore = config.bufferTimeBefore;\nconst bufferAfter = config.bufferTimeAfter;\nconst workStart = config.workingHoursStart;\nconst workEnd = config.workingHoursEnd;\nconst daysAhead = config.daysToLookAhead;\nconst timezone = $('Detect Lead Timezone').first().json.detectedTimezone;\n\nconst availableSlots = [];\nconst now = new Date();\n\nfor (let day = 0; day < daysAhead; day++) {\n  const currentDay = new Date(now);\n  currentDay.setDate(now.getDate() + day);\n  const dayStart = new Date(currentDay.toDateString() + ' ' + workStart);\n  const dayEnd = new Date(currentDay.toDateString() + ' ' + workEnd);\n  \n  let currentTime = dayStart;\n  \n  while (currentTime < dayEnd) {\n    const slotEnd = new Date(currentTime.getTime() + meetingDuration * 60000);\n    if (slotEnd > dayEnd) break;\n    \n    const slotStartWithBuffer = new Date(currentTime.getTime() - bufferBefore * 60000);\n    const slotEndWithBuffer = new Date(slotEnd.getTime() + bufferAfter * 60000);\n    \n    const hasConflict = events.some(event => {\n      const eventStart = new Date(event.start.dateTime || event.start.date);\n      const eventEnd = new Date(event.end.dateTime || event.end.date);\n      return (slotStartWithBuffer < eventEnd && slotEndWithBuffer > eventStart);\n    });\n    \n    if (!hasConflict && currentTime > now) {\n      availableSlots.push({\n        startTime: currentTime.toISOString(),\n        endTime: slotEnd.toISOString(),\n        timezone: timezone\n      });\n    }\n    \n    currentTime = new Date(currentTime.getTime() + 30 * 60000);\n  }\n}\n\nreturn {\n  json: {\n    availableSlots: availableSlots.slice(0, 5),\n    hasSlots: availableSlots.length > 0\n  }\n};"
        },
        "typeVersion": 2
      },
      {
        "id": "3a2ef151-6eca-4757-964f-2da81eba5b48",
        "name": "Check Slots Available",
        "type": "n8n-nodes-base.if",
        "position": [
          720,
          368
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "id-1",
                "operator": {
                  "type": "boolean",
                  "operation": "true"
                },
                "leftValue": "={{ $json.hasSlots }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "44b47691-07a1-4b94-8712-8253426579cc",
        "name": "Generate Meeting Link",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1040,
          64
        ],
        "parameters": {
          "url": "https://zoom.us/oauth/token",
          "method": "POST",
          "options": {},
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpBasicAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "grant_type",
                "value": "account_credentials"
              },
              {
                "name": "account_id",
                "value": "UGR7lYDyTLGGuUUxURMMdw"
              }
            ]
          }
        },
        "credentials": {
          "httpBasicAuth": {
            "id": "TZQfwy6oavZXmDIU",
            "name": "Unnamed credential"
          }
        },
        "typeVersion": 4.3
      },
      {
        "id": "c80d5adf-e346-40a9-b841-dce726c188e6",
        "name": "Generate Personalized Invite",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1888,
          304
        ],
        "parameters": {
          "text": "=Lead details: {{ JSON.stringify($('Detect Lead Timezone').first().json) }}\nAvailable slots: {{ JSON.stringify($('Find Available Slots with Buffer').first().json.availableSlots) }}\nMeeting link: {{ $json.join_url }}",
          "options": {
            "systemMessage": "You are a professional meeting scheduler assistant.\n\nYour task is to:\n1. Analyze the lead information and available meeting slots\n2. Generate a warm, personalized email invitation\n3. Present the top 3 available time slots in the lead's timezone\n4. Include the meeting link\n5. Keep the tone professional yet friendly\n6. Highlight the value of the meeting\n\nReturn ONLY the email content with subject line and body in HTML format."
          },
          "promptType": "define"
        },
        "typeVersion": 3
      },
      {
        "id": "74cc79c0-dd30-4414-8af3-66601029ba2d",
        "name": "Send Meeting Invite",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2224,
          304
        ],
        "webhookId": "79b5f663-9fb9-47a4-951d-2ad93ae1f376",
        "parameters": {
          "sendTo": "={{ $('Detect Lead Timezone').item.json.Owner.email }}",
          "message": "={{ $json.output }}",
          "options": {},
          "subject": "={{ $json.output.split('Subject:')[1].split('\\n')[0].trim() }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "3HDLr4cJCAAOLj1y",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "830014ab-c1fc-43c4-a091-76325c1b0320",
        "name": "Log Meeting in Zoho CRM",
        "type": "n8n-nodes-base.zohoCrm",
        "position": [
          2464,
          304
        ],
        "parameters": {
          "Company": "Meeting Event",
          "lastName": "={{ $('Detect Lead Timezone').item.json.Owner.name }}",
          "resource": "lead",
          "additionalFields": {
            "Description": "={{ 'Meeting Scheduled with ' + $('Detect Lead Timezone').first().json.Full_Name + ' from ' + $('Find Available Slots with Buffer').first().json.availableSlots[0].startTime + ' to ' + $('Find Available Slots with Buffer').first().json.availableSlots[0].endTime }}"
          }
        },
        "credentials": {
          "zohoOAuth2Api": {
            "id": "ghfbEj1OQlzm3B24",
            "name": "Zoho account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "bcdcb6dd-9585-4369-822c-c9523819fa64",
        "name": "No Slots Available Message",
        "type": "n8n-nodes-base.set",
        "position": [
          1056,
          544
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "id-1",
                "name": "subject",
                "type": "string",
                "value": "Unable to Schedule Meeting - Let's Connect"
              },
              {
                "id": "id-2",
                "name": "message",
                "type": "string",
                "value": "=Hi {{ $('Detect Lead Timezone').first().json.Full_Name }},\n\nThank you for your interest! Unfortunately, our sales representative doesn't have any available slots in the next {{ $('Workflow Configuration').first().json.daysToLookAhead }} days.\n\nWe'd still love to connect with you. Please reply to this email with your preferred times, and we'll do our best to accommodate.\n\nBest regards,\nThe Team"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "4fc09d7c-4e51-4635-8927-5a938a7f3a7d",
        "name": "Send No Availability Email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1360,
          544
        ],
        "webhookId": "2b46b1b0-8af1-4a87-ac63-4e8da7b9ec21",
        "parameters": {
          "sendTo": "=dg3avt@gmail.com",
          "message": "={{ $json.message }}",
          "options": {},
          "subject": "={{ $json.subject }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "3HDLr4cJCAAOLj1y",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "326b149a-ef54-44e1-ba7f-73914f74bcca",
        "name": "Zoho CRM Lead Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -1040,
          368
        ],
        "webhookId": "31cff192-8aeb-49e8-8189-49aefcb859e8",
        "parameters": {
          "path": "zoho-lead-webhook",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "lastNode"
        },
        "typeVersion": 2.1
      },
      {
        "id": "13b1e2c4-3b4f-4cfb-a78c-1b6602928a50",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1920,
          544
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "googlePalmApi": {
            "id": "VWxpFrGJh1vghwdV",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "2fe13fe0-5ac7-4b1c-9a74-5801491e4c9a",
        "name": "HTTP Request",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          1328,
          64
        ],
        "parameters": {
          "url": "https://api.zoom.us/v2/users/me/meetings",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "topic",
                "value": "A Scheduled Meeting from n8n"
              },
              {
                "name": "type",
                "value": "2"
              },
              {
                "name": "start_time",
                "value": "={{ $('Check Slots Available').item.json.availableSlots[0].startTime }}"
              },
              {
                "name": "duration",
                "value": "30"
              },
              {
                "name": "timezone",
                "value": "={{ $('Check Slots Available').item.json.availableSlots[0].timezone }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ 'Bearer ' + $json.access_token }}"
              }
            ]
          }
        },
        "typeVersion": 4.3
      },
      {
        "id": "5bf907e6-4f69-4e62-ad19-e828e97431ea",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1840,
          -608
        ],
        "parameters": {
          "width": 656,
          "height": 1024,
          "content": "## How It Works\nThis workflow automatically schedules meetings for new Zoho CRM leads. When a lead is created, Zoho triggers a webhook that sends the lead ID to n8n, which then retrieves full lead details, identifies the sales rep, and detects the lead‚Äôs timezone. The workflow checks the rep‚Äôs Google Calendar availability and generates time slots based on your rules such as working hours, meeting duration, buffer time, and days to search.\n\nIf suitable slots exist, a Zoom meeting is created and Gemini AI generates a personalized email with the top three time options and meeting link, which is then sent to the lead. The workflow also updates Zoho CRM with the meeting details. If no slots are available, a fallback email is sent instead.\n\n## Setup Steps\n\n### 1.Connect Integrations\nAuthenticate Zoho CRM, Google Calendar, Gmail, Zoom, and Gemini in n8n.\n\n### 2.Import Workflow\nGo to n8n ‚Üí Workflows ‚Üí Import and paste the provided workflow JSON.\n\n### 3.Update Configuration\nIn the Workflow Configuration node, set meeting duration, buffers, working hours, days to search, and meeting provider.\n\n### 4.Adjust Timezone Logic\nIn the Detect Lead Timezone code node, edit or expand country/state ‚Üí timezone mappings.\n\n### 5.Verify Google Calendar Access\nEnsure each sales rep has a correct calendar ID in Zoho CRM and events are fetchable.\n\n### 6.Add Zoho Webhook\nCopy the webhook URL from n8n and add it under Zoho CRM ‚Üí Setup ‚Üí Automation ‚Üí Webhooks ‚Üí Lead Created.\n\n### 7.Run a Test Lead\nCreate a lead and confirm it detects timezone, finds slots, creates a Zoom meeting, emails the lead, and logs in CRM.\n\n### 8.Activate Workflow\nOnce verified, switch the workflow to Active."
        },
        "typeVersion": 1
      },
      {
        "id": "95c0d447-1545-446e-93b2-47ef3304ae24",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1088,
          176
        ],
        "parameters": {
          "color": 7,
          "width": 448,
          "height": 480,
          "content": "## Lead Capture & Retrieval (Webhook + Zoho CRM Get Lead)\n### Automatically triggers when a new lead is created in Zoho CRM. The webhook sends the lead ID to n8n, which then fetches full lead details for processing."
        },
        "typeVersion": 1
      },
      {
        "id": "e51df1c6-c11c-4510-9289-85a7c053cfb0",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -592,
          176
        ],
        "parameters": {
          "color": 7,
          "width": 320,
          "height": 480,
          "content": "## Workflow Configuration\n### Stores all scheduling settings such as meeting duration, buffers, working hours, days to search, and meeting provider for later workflow steps."
        },
        "typeVersion": 1
      },
      {
        "id": "701e6b38-0538-4421-810b-65e9f624cf18",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -192,
          176
        ],
        "parameters": {
          "color": 7,
          "width": 816,
          "height": 480,
          "content": "## Sales Rep & Availability Processing\n### Retrieves the assigned sales rep‚Äôs details, detects the lead‚Äôs timezone, checks the rep‚Äôs current calendar events, and generates conflict-free meeting slots using working hours, duration, and buffer rules."
        },
        "typeVersion": 1
      },
      {
        "id": "90d2adf7-7678-4156-a69a-9a76457b82a8",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          944,
          -224
        ],
        "parameters": {
          "color": 7,
          "width": 576,
          "height": 560,
          "content": "## Zoom Meeting Creation\n### Authenticates with Zoom to obtain an access token, then creates a scheduled Zoom meeting using the earliest available time slot and returns the join details."
        },
        "typeVersion": 1
      },
      {
        "id": "0c15bd75-4297-4c65-9a2b-7daf10df99a4",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          944,
          368
        ],
        "parameters": {
          "color": 7,
          "width": 576,
          "height": 464,
          "content": "## Fallback Email Handling\n### Prepares a polite ‚Äúno availability‚Äù message and sends it to the lead via Gmail when no suitable meeting slots are found, prompting them to share preferred times."
        },
        "typeVersion": 1
      },
      {
        "id": "d9fada0c-fa2e-487f-a955-692cdcfba297",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1664,
          80
        ],
        "parameters": {
          "color": 7,
          "width": 1056,
          "height": 624,
          "content": "## AI Email & CRM Logging\n### Generates a personalized HTML invite with meeting details and top time slots, sends it to the lead via Gmail, and logs the scheduled meeting inside Zoho CRM for tracking."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "c34da5a0-7fc6-4946-ac12-c8057f007dcd",
    "connections": {
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Generate Personalized Invite",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "New Lead Trigger": {
        "main": [
          [
            {
              "node": "Workflow Configuration",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Meeting Invite": {
        "main": [
          [
            {
              "node": "Log Meeting in Zoho CRM",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Detect Lead Timezone": {
        "main": [
          [
            {
              "node": "Get Rep Calendar Availability",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Slots Available": {
        "main": [
          [
            {
              "node": "Generate Meeting Link",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "No Slots Available Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Meeting Link": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Sales Rep Details": {
        "main": [
          [
            {
              "node": "Detect Lead Timezone",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Zoho CRM Lead Webhook": {
        "main": [
          [
            {
              "node": "New Lead Trigger",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Workflow Configuration": {
        "main": [
          [
            {
              "node": "Get Sales Rep Details",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Personalized Invite",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "No Slots Available Message": {
        "main": [
          [
            {
              "node": "Send No Availability Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Personalized Invite": {
        "main": [
          [
            {
              "node": "Send Meeting Invite",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Rep Calendar Availability": {
        "main": [
          [
            {
              "node": "Find Available Slots with Buffer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Find Available Slots with Buffer": {
        "main": [
          [
            {
              "node": "Check Slots Available",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "QO4Mg23JvVfNCICy",
    "meta": {
      "instanceId": "a2b23892dd6989fda7c1209b381f5850373a7d2b85609624d7c2b7a092671d44",
      "templateCredsSetupCompleted": true
    },
    "name": "Build a Phone Agent to qualify outbound leads and inbound calls with RetellAI -vide",
    "tags": [
      {
        "id": "12w64ydbjEKDaM0B",
        "name": "inbound",
        "createdAt": "2025-05-06T20:31:43.427Z",
        "updatedAt": "2025-05-06T20:31:43.427Z"
      },
      {
        "id": "xSqaFWDcbJCRECKZ",
        "name": "outbound",
        "createdAt": "2025-05-06T20:31:38.072Z",
        "updatedAt": "2025-05-06T20:31:38.072Z"
      }
    ],
    "nodes": [
      {
        "id": "78f39980-c9f8-49b6-93bb-a1f61d347ac3",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -240,
          0
        ],
        "parameters": {
          "width": 1260,
          "height": 320,
          "content": "# Outbound lead qualification call workflow"
        },
        "typeVersion": 1
      },
      {
        "id": "661006b9-dac7-4ac0-882a-2e0cba9dbae1",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -240,
          360
        ],
        "parameters": {
          "color": 5,
          "width": 1260,
          "height": 320,
          "content": "# Inbound call appointment scheduler workflow"
        },
        "typeVersion": 1
      },
      {
        "id": "96a278b9-8d2e-4f85-9f6a-2997932a7ca4",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1060,
          -420
        ],
        "parameters": {
          "color": 4,
          "width": 1400,
          "height": 1100,
          "content": "# Post-call workflow\n## Triggers when a new lead is added in Google Sheets:\n\n### 1 -Sends SMS to remind rep to call in 5 min\n### 2- (Optional delay step)\n### 3- Triggers RetellAI to place an automated call to the lead\n\n## üí° Requires phone numbers to be formatted in E.164"
        },
        "typeVersion": 1
      },
      {
        "id": "d082f904-f185-4615-b0d8-9438c731786f",
        "name": "Detect new lead in Google Sheets",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          -160,
          100
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyHour"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "pXaVMshaL2QzVDYh",
            "name": "Google Sheets Trigger account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c61172c2-7795-47be-acaa-d4824ca69680",
        "name": "Send SMS reminder to call lead in 5 minutes",
        "type": "n8n-nodes-base.twilio",
        "position": [
          140,
          100
        ],
        "parameters": {
          "to": "={{ $json['Phone Number'] }}",
          "from": "+33600000000",
          "message": "Hello, thanks for your interest in our roofing services. We'll be calling you shortly to ask about your project!",
          "options": {},
          "resource": "call"
        },
        "credentials": {
          "twilioApi": {
            "id": "udXVmM3xHYZbMW4g",
            "name": "Twilio account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d88573d4-ec99-40e4-8603-f1e910d034d1",
        "name": "Wait 5 minutes before making call",
        "type": "n8n-nodes-base.wait",
        "position": [
          460,
          100
        ],
        "webhookId": "344c2d5d-5629-4466-866b-ac6359b3b042",
        "parameters": {
          "unit": "minutes",
          "amount": 1
        },
        "typeVersion": 1.1
      },
      {
        "id": "d6778895-90dd-471e-9d9d-c48a35154291",
        "name": "Call new lead using RetellAI",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          760,
          100
        ],
        "parameters": {
          "url": "https://api.retellai.com/v2/create-phone-call",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"from_number\": \"+33600000000\",\n  \"to_number\": \"{{ $json['Phone Number'] }}\",\n  \"retell_llm_dynamic_variables\": {\n    \"uuid\": \"{{ $('Detect new lead in Google Sheets').item.json.UUID }}\"\n  }\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer YOUR_TOKEN_HERE"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "8e7e7c0c-2600-4b20-ba30-b855d456d302",
        "name": "Receive inbound call from RetellAI (webhook)",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -160,
          460
        ],
        "webhookId": "ebd11c9b-129c-4b59-8c27-9a4b567305f7",
        "parameters": {
          "path": "ebd11c9b-129c-4b59-8c27-9a4b567305f7",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "36bf25b0-d39d-4127-b005-5e3619069744",
        "name": "Check if phone number exists in Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          300,
          460
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupValue": "={{ $json.body.call_inbound.from_number }}",
                "lookupColumn": "Phone Number"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "0b2dc7b9-84c1-488b-9d02-47cf6ee460c7",
        "name": "Send response to inbound webhook call",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          760,
          460
        ],
        "parameters": {
          "options": {},
          "respondWith": "json",
          "responseBody": "={\n  \"call_inbound\": {\n    \"dynamic_variables\": {\n        \"name\": \"{{ $json.Name }}\"\n    }\n  }\n}"
        },
        "typeVersion": 1.1
      },
      {
        "id": "063a4a31-429f-4cf0-b248-869131e92633",
        "name": "Receive post-call data from RetellAI (webhook)",
        "type": "n8n-nodes-base.webhook",
        "position": [
          1180,
          80
        ],
        "webhookId": "f8878b78-43ea-4caa-b16c-cde9aaf2e9b1",
        "parameters": {
          "path": "f8878b78-43ea-4caa-b16c-cde9aaf2e9b1",
          "options": {},
          "httpMethod": "POST"
        },
        "typeVersion": 2
      },
      {
        "id": "215e2031-983a-4785-b46d-026f64c115e4",
        "name": "Filter for analyzed calls only",
        "type": "n8n-nodes-base.filter",
        "position": [
          1400,
          80
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "a0e40476-0054-43ec-b7a7-e872d1c6061a",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.body.event }}",
                "rightValue": "call_analyzed"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "f8cae0c3-1b5d-47e6-b7fd-b47558c30d3f",
        "name": "Check if call was outbound",
        "type": "n8n-nodes-base.if",
        "position": [
          1620,
          80
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "46590184-4e33-48fd-a9f4-c63b13f88c1f",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.body.call.direction }}",
                "rightValue": "outbound"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "8997d5ec-bfb9-4ce9-9e13-6035f02b634e",
        "name": "Update lead record in Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1860,
          -40
        ],
        "parameters": {
          "columns": {
            "value": {
              "UUID": "={{ $json.body.call.retell_llm_dynamic_variables.uuid }}",
              "Qualification": "={{ $json.body.call.call_analysis.custom_analysis_data.qualification }}"
            },
            "schema": [
              {
                "id": "UUID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "UUID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Phone Number",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Phone Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Datetime Called",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Datetime Called",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Qualification",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Qualification",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "UUID"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "20757ff8-6604-4c80-96ec-32bfac983ed7",
        "name": "Send call summary email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2220,
          -40
        ],
        "webhookId": "806ec3f9-8bcb-48ef-8e22-9d1ce3b06bf0",
        "parameters": {
          "sendTo": "youremail@gmail.com",
          "message": "=Name:\n{{ $json.body.call.call_analysis.custom_analysis_data.first_name }}\n\nNumber:\n{{ $json.body.call.call_analysis.custom_analysis_data.phone_number }}\n\nQualification:\n{{ $json.body.call.call_analysis.custom_analysis_data.qualification }}\n\n\nCall Summary:\n{{ $json.body.call.call_analysis.custom_analysis_data.call_summary }}",
          "options": {},
          "subject": "=New Lead - Call Summary",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "rKxQHWZ2F5XLJmwF",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "753bd92d-b95b-4710-bf49-6da89a43223f",
        "name": "Generate call summary with OpenAI",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          1860,
          180
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1",
            "cachedResultName": "GPT-4.1"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Analyze this call transcript to identify how the call went and identify possible improvements to the voice prompt:\n\n{{ $json.body.call.transcript }}"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "cf600277-bb07-4f7a-a9b7-3e20017f716d",
        "name": "Send confirmation email to lead",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2220,
          180
        ],
        "webhookId": "453fe9d9-1de6-40a2-bd0c-88cb9c1cc7ef",
        "parameters": {
          "sendTo": "youremail@gmail.com",
          "message": "=New roofing appointment:\n\nClient Name:\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.custom_analysis_data.first_name }}\n\nClient Number:\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.custom_analysis_data.phone_number }}\n\nAvailabilities:\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.custom_analysis_data.availabilities }}\n\n\nCall Summary:\n{{ $('Check if call was outbound').item.json.body.call.call_analysis.call_summary }}\n\n\nChatGPT analysis of how the call went and suggestions for improving the voice prompt:\n{{ $json.message.content }}",
          "options": {},
          "subject": "=Roofing Appointment Scheduled",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "rKxQHWZ2F5XLJmwF",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "f75763b6-0867-4625-89e1-cafa3c9e6e44",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -240,
          -420
        ],
        "parameters": {
          "width": 1260,
          "height": 400,
          "content": "# ‚úÖ General Workflow Explanation\n##  This workflow automates outbound and inbound lead calls with RetellAI, Google Sheets, OpenAI, and Gmail. It handles:\n\nScheduling and reminding outbound qualification calls\nHandling inbound appointment calls\nAutomatically updating records and sending summaries post-call\n\n## üëâ Dependencies:\n\nActive RetellAI API key\nGoogle Sheet set up with lead data\nGmail API credentials configured"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "879f8e4d-91d7-41fc-825d-08f2ef283c25",
    "connections": {
      "Check if call was outbound": {
        "main": [
          [
            {
              "node": "Update lead record in Google Sheets",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Generate call summary with OpenAI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter for analyzed calls only": {
        "main": [
          [
            {
              "node": "Check if call was outbound",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Detect new lead in Google Sheets": {
        "main": [
          [
            {
              "node": "Send SMS reminder to call lead in 5 minutes",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate call summary with OpenAI": {
        "main": [
          [
            {
              "node": "Send confirmation email to lead",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 5 minutes before making call": {
        "main": [
          [
            {
              "node": "Call new lead using RetellAI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update lead record in Google Sheets": {
        "main": [
          [
            {
              "node": "Send call summary email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send SMS reminder to call lead in 5 minutes": {
        "main": [
          [
            {
              "node": "Wait 5 minutes before making call",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Receive inbound call from RetellAI (webhook)": {
        "main": [
          [
            {
              "node": "Check if phone number exists in Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check if phone number exists in Google Sheets": {
        "main": [
          [
            {
              "node": "Send response to inbound webhook call",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Receive post-call data from RetellAI (webhook)": {
        "main": [
          [
            {
              "node": "Filter for analyzed calls only",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "ad48a01aec252f63ae8de1713711ab9e32029259011598511a3ef275db7ecb31"
    },
    "nodes": [
      {
        "id": "090c0c78-fa41-41cd-affa-188714c72e96",
        "name": "When clicking ‚ÄòExecute workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -2016,
          464
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "70f16c39-5979-4ee8-be93-62ebbf6c66da",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2224,
          -128
        ],
        "parameters": {
          "width": 716,
          "height": 488,
          "content": "### How it works:\n1. Initialisation\n   * intialisation of counters from \"Data Table\"\n   * lead selection and loading from Google Sheet\n\n2. Import of leads into CRM according 3 possibilities:\n   2.1 company does not exist ‚û°Ô∏è creation of company, incrementation of create counter\n   2.2 company exists only one time ‚û°Ô∏è update of existing company, incrementation of update counter\n   2.3 company exists multiple times ‚û°Ô∏è log quality inconsistency  \n\n3. Generation of import report \n\n### Setup steps:\n* Define credentials : Airtable, Google\n* Use or Create internal Data Table : EML_Import\n* Use or Create CRM Table(s) : Compagny\n* Airtable Search Conditions : AND({Company} = \"{{ $('Loop Over Items').item.json.Company }}\", {Email} = \"{{ $('Loop Over Items').item.json.Email }}\")\n* Google Search Conditions : Valid Email = OK"
        },
        "typeVersion": 1
      },
      {
        "id": "6aaeb094-4842-4153-b594-88feeb214860",
        "name": "Update row(s)",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          -1040,
          480
        ],
        "parameters": {
          "columns": {
            "value": {
              "executionId": "={{ $execution.id }}",
              "recordsRead": "={{ $json.recordsRead + 1}}"
            },
            "schema": [
              {
                "id": "executionId",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "executionId",
                "defaultMatch": false
              },
              {
                "id": "recordsRead",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "recordsRead",
                "defaultMatch": false
              },
              {
                "id": "recorsCreated",
                "type": "number",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "recorsCreated",
                "defaultMatch": false
              },
              {
                "id": "recordsUpdated",
                "type": "number",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "recordsUpdated",
                "defaultMatch": false
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "={{ $('Insert row').item.json.id }}"
              }
            ]
          },
          "options": {},
          "operation": "update",
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "YrL8Vo5VrnsRlXrx",
            "cachedResultUrl": "/projects/D1WQsJHiMg8XTFuj/datatables/YrL8Vo5VrnsRlXrx",
            "cachedResultName": "EML_Import"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "70c5df1b-ae7b-43f8-87ba-ff3cab94511f",
        "name": "Get row(s)",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          -1232,
          480
        ],
        "parameters": {
          "filters": {
            "conditions": [
              {
                "keyValue": "={{ $('Insert row').item.json.id }}"
              }
            ]
          },
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "YrL8Vo5VrnsRlXrx",
            "cachedResultUrl": "/projects/D1WQsJHiMg8XTFuj/datatables/YrL8Vo5VrnsRlXrx",
            "cachedResultName": "EML_Import"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e27e9dcb-29f2-40e9-9ff5-6aaa44e39e91",
        "name": "Insert row",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          -1824,
          464
        ],
        "parameters": {
          "columns": {
            "value": {
              "executionId": "={{ $execution.id }}",
              "recordsRead": 0,
              "recorsCreated": 0,
              "recordsUpdated": 0
            },
            "schema": [
              {
                "id": "executionId",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "executionId",
                "defaultMatch": false
              },
              {
                "id": "recordsRead",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "recordsRead",
                "defaultMatch": false
              },
              {
                "id": "recorsCreated",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "recorsCreated",
                "defaultMatch": false
              },
              {
                "id": "recordsUpdated",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "recordsUpdated",
                "defaultMatch": false
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "YrL8Vo5VrnsRlXrx",
            "cachedResultUrl": "/projects/D1WQsJHiMg8XTFuj/datatables/YrL8Vo5VrnsRlXrx",
            "cachedResultName": "EML_Import"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "abd4b1e1-5efc-4684-ba40-22220e1d2ae0",
        "name": "Limit",
        "type": "n8n-nodes-base.limit",
        "position": [
          -1040,
          -32
        ],
        "parameters": {
          "keep": "lastItems"
        },
        "typeVersion": 1
      },
      {
        "id": "81f73d48-a6d4-47b8-b5f5-fc9543d42edb",
        "name": "Get row(s)1",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          -864,
          -32
        ],
        "parameters": {
          "filters": {
            "conditions": [
              {
                "keyValue": "={{ $('Insert row').item.json.id }}"
              }
            ]
          },
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "YrL8Vo5VrnsRlXrx",
            "cachedResultUrl": "/projects/D1WQsJHiMg8XTFuj/datatables/YrL8Vo5VrnsRlXrx",
            "cachedResultName": "EML_Import"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "965719fb-0aa3-4c3b-8730-0ab54c706909",
        "name": "Send a message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          -672,
          -32
        ],
        "webhookId": "9d3a92c9-e610-45e5-8a6b-d3607c4c1a65",
        "parameters": {
          "sendTo": "email-address@gmail.com",
          "message": "=Leads Import Report\nNumber of records read: {{ $json.recordsRead }}\nNumber of records created : {{ $json.recorsCreated }}\nNumber of records updated : {{ $json.recordsUpdated }}",
          "options": {},
          "subject": "REPORT EML IMPORT DE LEADS",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "GAXaqBRhbEtySIYc",
            "name": "Gmail GS"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "a1258104-697e-47ac-bdae-b640f8a42b47",
        "name": "Wait1",
        "type": "n8n-nodes-base.wait",
        "position": [
          256,
          656
        ],
        "webhookId": "1e747e63-8c07-410a-87cb-605f5175b5ae",
        "parameters": {
          "amount": 1
        },
        "typeVersion": 1.1
      },
      {
        "id": "d48c78a4-14b5-43b0-8346-3cc02998df73",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -896,
          192
        ],
        "parameters": {
          "color": 2,
          "width": 544,
          "height": 608,
          "content": "### Determination of retuned row(s) :\n**none :** no exisitng company\n**one :** only one exisitng company\n**multiple :** multiple existing occurrences of the same company\n\nWhen there are multiple occurences of the same company, it indicates a data quality issue ‚û°Ô∏è this to be solved"
        },
        "typeVersion": 1
      },
      {
        "id": "ade429d2-7b9f-48bd-b469-6150f5424117",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -288,
          192
        ],
        "parameters": {
          "color": 4,
          "width": 448,
          "height": 192,
          "content": "### Creation of a new company"
        },
        "typeVersion": 1
      },
      {
        "id": "5025ced0-adf1-431b-a6d1-4c7be6c5d062",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -288,
          400
        ],
        "parameters": {
          "color": 4,
          "width": 448,
          "height": 192,
          "content": "### Update of existing company"
        },
        "typeVersion": 1
      },
      {
        "id": "475be580-d995-447d-8c77-0d8ed20e4f90",
        "name": "Create Company",
        "type": "n8n-nodes-base.airtable",
        "position": [
          -208,
          240
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appQMvR0bhVFIfsp5",
            "cachedResultUrl": "https://airtable.com/appQMvR0bhVFIfsp5",
            "cachedResultName": "PROSPECTION"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblZvVs5HurZQdK2u",
            "cachedResultUrl": "https://airtable.com/appQMvR0bhVFIfsp5/tblZvVs5HurZQdK2u",
            "cachedResultName": "COMPANY"
          },
          "columns": {
            "value": {
              "City": "={{ $('Loop Over Items').item.json.City }}",
              "Email": "={{ $('Loop Over Items').item.json.Email }}",
              "Address": "={{ $('Loop Over Items').item.json.Address }}",
              "Company": "={{ $('Loop Over Items').item.json.Company }}",
              "Activity": "={{ $('Loop Over Items').item.json.Activity }}",
              "URL Site": "={{ $('Loop Over Items').item.json['URL Site'] }}",
              "ZIP Code": "={{ $('Loop Over Items').item.json['Zip Code'] }}",
              "Valid Email": "={{ $('Loop Over Items').item.json['Valid Email'] }}",
              "Phone Number": "={{ $('Loop Over Items').item.json['Phone Number'] }}",
              "Business Leader": "={{ $('Loop Over Items').item.json['Business Leader'] }}"
            },
            "schema": [
              {
                "id": "Company",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Company",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Business Leader",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Business Leader",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Activity",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Activity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Address",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ZIP Code",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "ZIP Code",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "City",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "City",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Phone Number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Phone Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL Site",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "URL Site",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Opt-in",
                "type": "boolean",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Opt-in",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Campaign",
                "type": "boolean",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Campaign",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Valid Email",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "checked",
                    "value": "checked"
                  },
                  {
                    "name": "to be checked",
                    "value": "to be checked"
                  }
                ],
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Valid Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INTERACTION",
                "type": "array",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "INTERACTION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {
            "typecast": true
          },
          "operation": "create"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Psqhq4DEUuvikWZJ",
            "name": "Airtable GS"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "478376a9-0322-4b91-abf4-2b18b3aeb8e7",
        "name": "Update row(s) - Creation",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          0,
          240
        ],
        "parameters": {
          "columns": {
            "value": {
              "executionId": "={{ $execution.id }}",
              "recorsCreated": "={{ $('Get row(s)').item.json.recorsCreated + 1}}"
            },
            "schema": [
              {
                "id": "executionId",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "executionId",
                "defaultMatch": false
              },
              {
                "id": "recordsRead",
                "type": "number",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "recordsRead",
                "defaultMatch": false
              },
              {
                "id": "recorsCreated",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "recorsCreated",
                "defaultMatch": false
              },
              {
                "id": "recordsUpdated",
                "type": "number",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "recordsUpdated",
                "defaultMatch": false
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "={{ $('Insert row').item.json.id }}"
              }
            ]
          },
          "options": {},
          "operation": "update",
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "YrL8Vo5VrnsRlXrx",
            "cachedResultUrl": "/projects/D1WQsJHiMg8XTFuj/datatables/YrL8Vo5VrnsRlXrx",
            "cachedResultName": "EML_Import"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "f31d06a1-6a9c-4270-abe8-98cd151dd848",
        "name": "Update row(s) - Update",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          0,
          448
        ],
        "parameters": {
          "columns": {
            "value": {
              "executionId": "={{ $execution.id }}",
              "recordsUpdated": "={{ $('Get row(s)').item.json.recordsUpdated + 1}}"
            },
            "schema": [
              {
                "id": "executionId",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "executionId",
                "defaultMatch": false
              },
              {
                "id": "recordsRead",
                "type": "number",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "recordsRead",
                "defaultMatch": false
              },
              {
                "id": "recorsCreated",
                "type": "number",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "recorsCreated",
                "defaultMatch": false
              },
              {
                "id": "recordsUpdated",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "recordsUpdated",
                "defaultMatch": false
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "={{ $('Insert row').item.json.id }}"
              }
            ]
          },
          "options": {},
          "operation": "update",
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "YrL8Vo5VrnsRlXrx",
            "cachedResultUrl": "/projects/D1WQsJHiMg8XTFuj/datatables/YrL8Vo5VrnsRlXrx",
            "cachedResultName": "EML_Import"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "83710b3d-b32b-40b2-bc28-be7350f8754b",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          -672,
          480
        ],
        "parameters": {
          "jsCode": "const items = $items(\"Search Company\");\n\n// V√©rifier si on a vraiment des r√©sultats\nif (items.length === 0 || (items.length === 1 && !items[0].json.id)) {\n    // Aucun r√©sultat\n    return [{\n        json: {\n            resultType: \"none\",\n            count: 0,\n            message: \"Aucun enregistrement trouv√©\"\n        }\n    }];\n} else if (items.length === 1 && items[0].json.id) {\n    // Un seul r√©sultat\n    return [{\n        json: {\n            resultType: \"one\",\n            count: 1,\n            record: items[0].json,\n            message: \"Un enregistrement trouv√©\"\n        }\n    }];\n} else {\n    // Plusieurs r√©sultats\n    return [{\n        json: {\n            resultType: \"multiple\",\n            count: items.length,\n            records: items.map(item => item.json),\n            message: `${items.length} enregistrements trouv√©s`\n        }\n    }];\n}"
        },
        "typeVersion": 2
      },
      {
        "id": "7094a155-5554-42e8-adf0-3321fdee2a3b",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          -496,
          464
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "none",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "82df4137-54a6-4f3a-bf6f-bbde87c88001",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.resultType }}",
                      "rightValue": "none"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "one",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "1f244124-6f67-42de-9269-f474aaf06db9",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.resultType }}",
                      "rightValue": "one"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "multiple",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "728b1d9e-d5da-4d50-a96d-9b5777706018",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.resultType }}",
                      "rightValue": "multiple"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "819ea443-b06a-4d20-ab2f-e565202c8034",
        "name": "Get row(s) Leads",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -1632,
          464
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupValue": "OK",
                "lookupColumn": "Valid Email"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1FS4yS4CXmSg_Xa501AXNsRO8OQ_ieJDycLdsqLeTqic/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "=1FS4yS4CXmSg_Xa501AXNsRO8OQ_ieJDycLdsqLeTqic"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "XvZIHCYVdBaEPW3g",
            "name": "Google Sheets GS"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "12750d62-e59c-4a5a-8f2e-b1d1c077ef7b",
        "name": "Search Company",
        "type": "n8n-nodes-base.airtable",
        "position": [
          -848,
          480
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appQMvR0bhVFIfsp5",
            "cachedResultUrl": "https://airtable.com/appQMvR0bhVFIfsp5",
            "cachedResultName": "PROSPECTION"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblZvVs5HurZQdK2u",
            "cachedResultUrl": "https://airtable.com/appQMvR0bhVFIfsp5/tblZvVs5HurZQdK2u",
            "cachedResultName": "COMPANY"
          },
          "options": {},
          "operation": "search",
          "filterByFormula": "=AND({Company} = \"{{ $('Loop Over Items').item.json.Company }}\", {Email} = \"{{ $('Loop Over Items').item.json.Email }}\")"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Psqhq4DEUuvikWZJ",
            "name": "Airtable GS"
          }
        },
        "typeVersion": 2.1,
        "alwaysOutputData": true
      },
      {
        "id": "5d77c157-2913-4664-8a62-224ab4a58f8a",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -1440,
          464
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "92040fed-ecad-4dba-8955-cd7456cc252b",
        "name": "Update Company",
        "type": "n8n-nodes-base.airtable",
        "position": [
          -208,
          448
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appQMvR0bhVFIfsp5",
            "cachedResultUrl": "https://airtable.com/appQMvR0bhVFIfsp5",
            "cachedResultName": "PROSPECTION"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblZvVs5HurZQdK2u",
            "cachedResultUrl": "https://airtable.com/appQMvR0bhVFIfsp5/tblZvVs5HurZQdK2u",
            "cachedResultName": "COMPANY"
          },
          "columns": {
            "value": {
              "City": "={{ $('Loop Over Items').item.json.City }}",
              "Email": "={{ $('Loop Over Items').item.json.Email }}",
              "Address": "={{ $('Loop Over Items').item.json.Address }}",
              "Company": "={{ $('Loop Over Items').item.json.Company }}",
              "Activity": "={{ $('Loop Over Items').item.json.Activity }}",
              "URL Site": "={{ $('Loop Over Items').item.json['URL Site'] }}",
              "ZIP Code": "={{ $('Loop Over Items').item.json['Zip Code'] }}",
              "Valid Email": "={{ $('Loop Over Items').item.json['Valid Email'] }}",
              "Phone Number": "={{ $('Loop Over Items').item.json['Phone Number'] }}",
              "Business Leader": "={{ $('Loop Over Items').item.json['Business Leader'] }}"
            },
            "schema": [
              {
                "id": "Company",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Company",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Business Leader",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Business Leader",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Activity",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Activity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Address",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ZIP Code",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "ZIP Code",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "City",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "City",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Phone Number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Phone Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL Site",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "URL Site",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Opt-in",
                "type": "boolean",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Opt-in",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Campaign",
                "type": "boolean",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Campaign",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Valid Email",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "checked",
                    "value": "checked"
                  },
                  {
                    "name": "to be checked",
                    "value": "to be checked"
                  }
                ],
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Valid Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INTERACTION",
                "type": "array",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "INTERACTION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Company",
              "Email"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {
            "typecast": true
          },
          "operation": "update"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Psqhq4DEUuvikWZJ",
            "name": "Airtable GS"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "a092f0eb-0aaa-4074-8cc2-6c28b8e92330",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -288,
          608
        ],
        "parameters": {
          "color": 3,
          "width": 448,
          "height": 192,
          "content": "### Data Quality Issue ‚û°Ô∏è Log"
        },
        "typeVersion": 1
      },
      {
        "id": "72e037b6-3d72-477b-8d8c-e56063548e6b",
        "name": "Create row(s) Logs",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -208,
          656
        ],
        "parameters": {
          "columns": {
            "value": {
              "Email": "={{ $json.records[0].Email }}",
              "Remark": "Data quality Issue : Presence of duplicate(s) => to be investigated",
              "Company": "={{ $json.records[0].Company }}"
            },
            "schema": [
              {
                "id": "Company",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Company",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Remark",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Remark",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 868691243,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1FS4yS4CXmSg_Xa501AXNsRO8OQ_ieJDycLdsqLeTqic/edit#gid=868691243",
            "cachedResultName": "Logs"
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "=1FS4yS4CXmSg_Xa501AXNsRO8OQ_ieJDycLdsqLeTqic"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "XvZIHCYVdBaEPW3g",
            "name": "Google Sheets GS"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "7e6e8c4e-f589-4201-add1-b191969914b4",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2224,
          384
        ],
        "parameters": {
          "color": 5,
          "width": 720,
          "height": 432,
          "content": "## 1. Initialisation\n"
        },
        "typeVersion": 1
      },
      {
        "id": "e76ebbde-b82b-4a35-ba3d-72c3e1538fe5",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1456,
          176
        ],
        "parameters": {
          "color": 5,
          "width": 1824,
          "height": 640,
          "content": "## 2. Import of leads  (Iterative Loop)"
        },
        "typeVersion": 1
      },
      {
        "id": "1c5ca6ff-0aaa-4850-8de0-dc30655e9d8c",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1136,
          -128
        ],
        "parameters": {
          "color": 5,
          "width": 784,
          "height": 272,
          "content": "## 3. Generation of import report\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Code": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit": {
        "main": [
          [
            {
              "node": "Get row(s)1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "Create Company",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Update Company",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Create row(s) Logs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s)": {
        "main": [
          [
            {
              "node": "Update row(s)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Insert row": {
        "main": [
          [
            {
              "node": "Get row(s) Leads",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s)1": {
        "main": [
          [
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update row(s)": {
        "main": [
          [
            {
              "node": "Search Company",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Company": {
        "main": [
          [
            {
              "node": "Update row(s) - Creation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search Company": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Company": {
        "main": [
          [
            {
              "node": "Update row(s) - Update",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Get row(s)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s) Leads": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create row(s) Logs": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update row(s) - Update": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update row(s) - Creation": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòExecute workflow‚Äô": {
        "main": [
          [
            {
              "node": "Insert row",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "iYX4vUmfNoVCA86T",
    "meta": {
      "instanceId": "1037e065dca107c3c15857d49fe150792779e136a3c579aed02192a2b3d2a396",
      "templateCredsSetupCompleted": true
    },
    "name": "ü§ñ Smart Customer Support AI Agent",
    "tags": [],
    "nodes": [
      {
        "id": "696a1b2e-8f22-46ec-8fdd-3c7bb25f8429",
        "name": "üìã Workflow Guide",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1040,
          660
        ],
        "parameters": {
          "color": 6,
          "width": 400,
          "height": 1040,
          "content": "## ü§ñ Smart Customer Support AI Agent\n\n**Who is this for?**\nSmall to medium businesses, e-commerce stores, SaaS companies, and service providers who want to automate their customer support while maintaining a personal touch.\n\n**What problem does this solve?**\n- Reduces response time to customer inquiries\n- Handles repetitive questions automatically\n- Provides 24/7 customer support coverage\n- Maintains consistent brand voice across channels\n- Escalates complex issues to human agents\n\n**What this workflow does:**\n1. Monitors Gmail and Telegram for customer messages\n2. Uses AI to understand customer intent and context\n3. Accesses your knowledge base (Google Sheets) for accurate responses\n4. Sends personalized, contextual replies\n5. Escalates complex issues to human agents\n6. Logs all interactions for analysis\n\n**FIXES APPLIED:**\n- Separated Gmail and Telegram processing paths\n- Individual AI agents for each channel\n- Proper conversation memory management\n- Channel-specific response handling\n\n**Setup Instructions:**\n1. Configure Gmail OAuth2 credentials\n2. Set up Telegram bot token\n3. Create your knowledge base in Google Sheets\n4. Add your OpenAI API key\n5. Customize the AI prompts for your business\n6. Test with sample customer inquiries\n\n**Customization Tips:**\n- Update the knowledge base with your FAQs\n- Modify AI prompts to match your brand voice\n- Add more communication channels as needed\n- Set up escalation rules for complex cases"
        },
        "typeVersion": 1
      },
      {
        "id": "47324b70-8be7-4e92-a739-2ff60f37d14a",
        "name": "üí¨ Telegram Customer Message Trigger",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          1500,
          1220
        ],
        "webhookId": "customer-support-telegram",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "RIK7bBarkKBJAV5R",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "23ce0479-3ab0-4150-b893-3e08ed83fd73",
        "name": "üìã Process Telegram Message",
        "type": "n8n-nodes-base.set",
        "position": [
          1780,
          1240
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "channel",
                "name": "channel",
                "type": "string",
                "value": "telegram"
              },
              {
                "id": "customer_name",
                "name": "customer_name",
                "type": "string",
                "value": "={{ $json.message.from.first_name }} {{ $json.message.from.last_name }}"
              },
              {
                "id": "customer_id",
                "name": "customer_id",
                "type": "string",
                "value": "={{ $json.message.from.id }}"
              },
              {
                "id": "chat_id",
                "name": "chat_id",
                "type": "string",
                "value": "={{ $json.message.chat.id }}"
              },
              {
                "id": "message_content",
                "name": "message_content",
                "type": "string",
                "value": "={{ $json.message.text }}"
              },
              {
                "id": "message_id",
                "name": "message_id",
                "type": "string",
                "value": "={{ $json.message.message_id }}"
              },
              {
                "id": "subject",
                "name": "subject",
                "type": "string",
                "value": "Customer Support Inquiry"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "686affeb-1afb-45cf-b9b0-f3ba6c6ffb94",
        "name": "ü§ñ Telegram AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2080,
          1180
        ],
        "parameters": {
          "text": "={{ $json.message_content}}",
          "options": {
            "systemMessage": "You are a helpful and professional customer support AI assistant for Telegram inquiries. Your role is to:\n\n1. Understand customer inquiries and provide accurate, helpful responses\n2. Use the knowledge base tool to find relevant information\n3. Maintain a friendly, professional tone that matches the company brand\n4. If you cannot fully resolve an issue, escalate it appropriately\n5. Always aim to provide value and resolve customer concerns\n\nImportant guidelines:\n- Be empathetic and understanding\n- Provide clear, actionable responses\n- Use the customer's name when possible\n- If information is not in the knowledge base, say so honestly\n- For complex technical issues, recommend escalation to human support\n\nCompany context: You represent a professional service business focused on customer satisfaction and quality support via Telegram."
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "a5e67d73-73c2-4756-9c82-9c05c1dbc36a",
        "name": "üß† OpenAI Chat Model - Telegram",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1900,
          1420
        ],
        "parameters": {
          "options": {
            "maxTokens": 100,
            "temperature": 0.3
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "IdjfTMR7gLjapSWH",
            "name": "Open Ai"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "bfa0f8a9-58cc-4c15-8d7e-d633c23e10a6",
        "name": "üß† Telegram Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          2080,
          1440
        ],
        "parameters": {
          "sessionKey": "telegram_{{ $json.customer_id }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "64a05368-29f5-4333-b881-b0ba73e424cb",
        "name": "üí¨ Send Telegram Reply",
        "type": "n8n-nodes-base.telegram",
        "position": [
          2460,
          1120
        ],
        "parameters": {
          "text": "={{ $json.output }}",
          "chatId": "={{ $('üìã Process Telegram Message').item.json.chat_id }}",
          "additionalFields": {
            "parse_mode": "Markdown",
            "reply_to_message_id": "={{ $('üìã Process Telegram Message').item.json.message_id }}"
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "RIK7bBarkKBJAV5R",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "64c36c02-b56d-45dd-b3bf-4f49b3e14b5c",
        "name": "üìß Gmail Customer Inquiry Trigger",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          1540,
          720
        ],
        "parameters": {
          "filters": {
            "labelIds": [
              "INBOX",
              "CATEGORY_PERSONAL"
            ],
            "readStatus": "unread"
          },
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YQWc9jqYGygA6lXT",
            "name": "Gmail account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "baf01d18-d626-4b5c-bbc9-ac45c83b8e0b",
        "name": "üìã Process Gmail Message",
        "type": "n8n-nodes-base.set",
        "position": [
          1740,
          720
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "channel",
                "name": "channel",
                "type": "string",
                "value": "gmail"
              },
              {
                "id": "customer_email",
                "name": "customer_email",
                "type": "string",
                "value": "={{ $json[\"From\"].match(/<(.*?)>/)?.[1] || $json[\"From\"] }}"
              },
              {
                "id": "customer_name",
                "name": "customer_name",
                "type": "string",
                "value": "={{ $json[\"From\"].split(\" <\")[0] }}"
              },
              {
                "id": "subject",
                "name": "subject",
                "type": "string",
                "value": "={{ $json.Subject }}"
              },
              {
                "id": "message_content",
                "name": "message_content",
                "type": "string",
                "value": "={{ $json.text || $json.snippet }}"
              },
              {
                "id": "message_id",
                "name": "message_id",
                "type": "string",
                "value": "={{ $json.id }}"
              },
              {
                "id": "thread_id",
                "name": "thread_id",
                "type": "string",
                "value": "={{ $json.threadId }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "4d1c0b8a-9fed-4977-8ec4-91cb4460c2b6",
        "name": "ü§ñ Gmail AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1940,
          720
        ],
        "parameters": {
          "text": "={{ $json.message_content}}",
          "options": {
            "systemMessage": "You are a helpful and professional customer support AI assistant for Email inquiries. Your role is to:\n\n1. Understand customer inquiries and provide accurate, helpful responses\n2. Use the knowledge base tool to find relevant information\n3. Maintain a friendly, professional tone that matches the company brand\n4. If you cannot fully resolve an issue, escalate it appropriately\n5. Always aim to provide value and resolve customer concerns\n\nImportant guidelines:\n- Be empathetic and understanding\n- Provide clear, actionable responses\n- Use the customer's name when possible\n- If information is not in the knowledge base, say so honestly\n- For complex technical issues, recommend escalation to human support\n- Format responses appropriately for email\n\nCompany context: You represent a professional service business focused on customer satisfaction and quality support via Email."
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "8da4c0b1-86b7-436b-8d73-e96d3777be29",
        "name": "üß† OpenAI Chat Model - Gmail",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1900,
          900
        ],
        "parameters": {
          "options": {
            "maxTokens": 1000,
            "temperature": 0.3
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "IdjfTMR7gLjapSWH",
            "name": "Open Ai"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "b4cb3e8b-3d5c-49fb-9cc2-f46ffe4cd683",
        "name": "üß† Gmail Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          2040,
          980
        ],
        "parameters": {
          "sessionKey": "gmail_{{ $json.customer_email }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "442e8879-e6c3-4cd6-8f3b-3f64879047c1",
        "name": "üìß Send Gmail Reply",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2240,
          720
        ],
        "webhookId": "c09e3c26-5430-4b47-864d-2344b636fa4e",
        "parameters": {
          "message": "={{ $json.output }}",
          "options": {
            "ccList": "",
            "bccList": "",
            "replyToSenderOnly": true
          },
          "messageId": "={{ $('üìã Process Gmail Message').item.json.message_id }}",
          "operation": "reply"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YQWc9jqYGygA6lXT",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "668afdd0-f68b-45cb-afde-93ebaf7627d3",
        "name": "‚úÖ Mark Gmail as Read",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2480,
          620
        ],
        "webhookId": "3bae576f-ba6e-4ee2-a389-82171a9101d8",
        "parameters": {
          "messageId": "={{ $('üìã Process Gmail Message').item.json.message_id }}",
          "operation": "markAsRead"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YQWc9jqYGygA6lXT",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "2233ac1c-b704-4485-a4dd-3d873fb04538",
        "name": "üìä Log Gmail Interaction",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2540,
          820
        ],
        "parameters": {
          "columns": {
            "value": {
              "Status": "Completed",
              "Channel": "Email",
              "Timestamp": "={{ new Date().toISOString() }}",
              "AI_Response": "={{ $('ü§ñ Gmail AI Agent').item.json.output }}",
              "Customer_Name": "={{ $('üìã Process Gmail Message').item.json.customer_name }}",
              "Response_Time": "={{ new Date().toISOString() }}",
              "Inquiry_Subject": "={{ $json.subject || 'General Inquiry' }}",
              "Customer_Contact": "={{ $('üìã Process Gmail Message').item.json.customer_email }}",
              "Customer_Message": "={{ $('üìã Process Gmail Message').item.json.message_content }}"
            },
            "schema": [
              {
                "id": "Timestamp",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Timestamp",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Channel",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Channel",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Customer_Name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Customer_Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Customer_Contact",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Customer_Contact",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Inquiry_Subject",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Inquiry_Subject",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Customer_Message",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Customer_Message",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "AI_Response",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "AI_Response",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Response_Time",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Response_Time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1087576053,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit#gid=1087576053",
            "cachedResultName": "AI_Responses"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit?usp=drivesdk",
            "cachedResultName": "customer_support_knowledge_base"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "ubQXdpluCtk0bGFi",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "6e641113-9da3-430c-873d-59fd0c2997fb",
        "name": "üìä Log Telegram Interaction",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2760,
          960
        ],
        "parameters": {
          "columns": {
            "value": {
              "Status": "Completed",
              "Channel": "={{ $('üìã Process Telegram Message').item.json.channel }}",
              "Timestamp": "={{ new Date().toISOString() }}",
              "AI_Response": "={{ $json.output }}",
              "Customer_Name": "={{ $('üìã Process Telegram Message').item.json.customer_name }}",
              "Response_Time": "={{ new Date().toISOString() }}",
              "Inquiry_Subject": "={{ $('üìã Process Telegram Message').item.json.subject }}",
              "Customer_Contact": "={{ $('üìã Process Telegram Message').item.json.customer_id }}",
              "Customer_Message": "={{ $('üìã Process Telegram Message').item.json.message_content }}"
            },
            "schema": [
              {
                "id": "Timestamp",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Timestamp",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Channel",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Channel",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Customer_Name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Customer_Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Customer_Contact",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Customer_Contact",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Inquiry_Subject",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Inquiry_Subject",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Customer_Message",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Customer_Message",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "AI_Response",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "AI_Response",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Response_Time",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Response_Time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1087576053,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit#gid=1087576053",
            "cachedResultName": "AI_Responses"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit?usp=drivesdk",
            "cachedResultName": "customer_support_knowledge_base"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "ubQXdpluCtk0bGFi",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "50ded0f7-2513-4515-8843-e24cb50c89ae",
        "name": "‚ö†Ô∏è Error Handling Info",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3100,
          980
        ],
        "parameters": {
          "width": 300,
          "height": 280,
          "content": "## üö® Error Handling\n\nThis section handles any errors that occur during the workflow execution and notifies the admin team.\n\n**Features:**\n- Captures all workflow errors\n- Sends notifications to admin\n- Logs errors for debugging\n- Provides fallback responses"
        },
        "typeVersion": 1
      },
      {
        "id": "8634105f-1844-4e58-97f3-07697d86ac48",
        "name": "üö® Error Trigger",
        "type": "n8n-nodes-base.errorTrigger",
        "position": [
          2760,
          1300
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "807781dc-c1ac-4bca-b298-420a3a3d5c2c",
        "name": "üì¢ Notify Admin of Error",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3020,
          1300
        ],
        "parameters": {
          "url": "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "text",
                "value": "üö® Customer Support AI Error Alert\n\nWorkflow: Smart Customer Support AI\nError: {{ $json.error.message }}\nNode: {{ $json.error.node.name }}\nTime: {{ new Date().toISOString() }}\n\nPlease check the workflow execution for details."
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "4581974a-7e7c-4b61-b5c7-a6023ef931d0",
        "name": "Gmail Escalation Logger",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          2300,
          920
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1478316494,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit#gid=1478316494",
            "cachedResultName": "Customer_Inquiries"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit?usp=drivesdk",
            "cachedResultName": "customer_support_knowledge_base"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "ubQXdpluCtk0bGFi",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "d9f13fc4-0a68-4bee-a36f-67e779bef7fe",
        "name": "knowledge base",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          2180,
          1000
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit#gid=0",
            "cachedResultName": "Knowledge_Base"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit?usp=drivesdk",
            "cachedResultName": "customer_support_knowledge_base"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "ubQXdpluCtk0bGFi",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "dfaba1db-fc45-4c09-b83d-2413086f52d8",
        "name": "knowledge base1",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          2240,
          1440
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit#gid=0",
            "cachedResultName": "Knowledge_Base"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit?usp=drivesdk",
            "cachedResultName": "customer_support_knowledge_base"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "ubQXdpluCtk0bGFi",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "a79e16e6-409a-47b1-a7f9-60de7aac1700",
        "name": "Telegram Escalation Logger",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          2420,
          1400
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1478316494,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit#gid=1478316494",
            "cachedResultName": "Customer_Inquiries"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rEZ1A0Gd5ejT_b2F5tcYy9Xk4i0JvTrjss_oolf6WD8/edit?usp=drivesdk",
            "cachedResultName": "customer_support_knowledge_base"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "ubQXdpluCtk0bGFi",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "791294ac-b7d5-45f8-951a-7146057b58f7",
    "connections": {
      "knowledge base": {
        "ai_tool": [
          [
            {
              "node": "ü§ñ Gmail AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "knowledge base1": {
        "ai_tool": [
          [
            {
              "node": "ü§ñ Telegram AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "üß† Gmail Memory": {
        "ai_memory": [
          [
            {
              "node": "ü§ñ Gmail AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "üö® Error Trigger": {
        "main": [
          [
            {
              "node": "üì¢ Notify Admin of Error",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ü§ñ Gmail AI Agent": {
        "main": [
          [
            {
              "node": "üìß Send Gmail Reply",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üß† Telegram Memory": {
        "ai_memory": [
          [
            {
              "node": "ü§ñ Telegram AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "üìß Send Gmail Reply": {
        "main": [
          [
            {
              "node": "‚úÖ Mark Gmail as Read",
              "type": "main",
              "index": 0
            },
            {
              "node": "üìä Log Gmail Interaction",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ü§ñ Telegram AI Agent": {
        "main": [
          [
            {
              "node": "üí¨ Send Telegram Reply",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail Escalation Logger": {
        "ai_tool": [
          [
            {
              "node": "ü§ñ Gmail AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "üí¨ Send Telegram Reply": {
        "main": [
          [
            {
              "node": "üìä Log Telegram Interaction",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Escalation Logger": {
        "ai_tool": [
          [
            {
              "node": "ü§ñ Telegram AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "üìã Process Gmail Message": {
        "main": [
          [
            {
              "node": "ü§ñ Gmail AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìã Process Telegram Message": {
        "main": [
          [
            {
              "node": "ü§ñ Telegram AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üß† OpenAI Chat Model - Gmail": {
        "ai_languageModel": [
          [
            {
              "node": "ü§ñ Gmail AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "üß† OpenAI Chat Model - Telegram": {
        "ai_languageModel": [
          [
            {
              "node": "ü§ñ Telegram AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "üìß Gmail Customer Inquiry Trigger": {
        "main": [
          [
            {
              "node": "üìã Process Gmail Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üí¨ Telegram Customer Message Trigger": {
        "main": [
          [
            {
              "node": "üìã Process Telegram Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "CfdF2XtXC68iJ6Hr",
    "meta": {
      "instanceId": "31e69f7f4a77bf465b805824e303232f0227212ae922d12133a0f96ffeab4fef",
      "templateCredsSetupCompleted": true
    },
    "name": "‚ú®ü§ñAutomated AI Powered Social Media Content Factory for  X + Facebook + Instagram + LinkedIn",
    "tags": [],
    "nodes": [
      {
        "id": "1e77584f-76b4-420b-b6b0-99132d6c0151",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -300,
          -900
        ],
        "parameters": {
          "color": 4,
          "width": 360,
          "height": 360,
          "content": "# üßë‚Äçü¶± User Input for Social Media Posts \nüí° Unpin default data to get started"
        },
        "typeVersion": 1
      },
      {
        "id": "dc92fcf1-3618-4188-a30f-6c2205cc3266",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          100,
          -940
        ],
        "parameters": {
          "color": 6,
          "width": 640,
          "height": 600,
          "content": "# üõ†Ô∏è Social Media Content Factory\n- LinkedIn\n- Instagram\n- Facebook\n- X\n- TikTok\n- Threads\n- YouTube Shorts\n"
        },
        "typeVersion": 1
      },
      {
        "id": "02429ea7-be59-49e3-9d85-c1678ee64abd",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1840,
          -700
        ],
        "parameters": {
          "color": 4,
          "width": 400,
          "height": 360,
          "content": "# üëç Approve Content Before Proceeding"
        },
        "typeVersion": 1
      },
      {
        "id": "fa38e25c-89e9-4d9b-be78-03aeb6965e30",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1300,
          -900
        ],
        "parameters": {
          "color": 5,
          "width": 500,
          "height": 560,
          "content": "# ‚úâÔ∏è Prepare & Format Approval Email"
        },
        "typeVersion": 1
      },
      {
        "id": "9b6e2038-9f65-4e0f-b13d-6c09e8224ed6",
        "name": "Social Media Content",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          560,
          -540
        ],
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n\t\"type\": \"object\",\n\t\"properties\": {\n\t\t\"name\": {\n\t\t\t\"type\": \"string\"\n\t\t},\n\t\t\"description\": {\n\t\t\t\"type\": \"string\"\n\t\t},\n\t\t\"platform_posts\": {\n\t\t\t\"type\": \"object\",\n\t\t\t\"properties\": {\n\t\t\t\t\"LinkedIn\": {\n\t\t\t\t\t\"type\": \"object\",\n\t\t\t\t\t\"properties\": {\n                        \"image_suggestion\": {\n                  \t\t\t\"type\": \"string\"\n                  \t\t},\n\t\t\t\t\t\t\"post\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"hashtags\": {\n\t\t\t\t\t\t\t\"type\": \"array\",\n\t\t\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"call_to_action\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"Instagram\": {\n\t\t\t\t\t\"type\": \"object\",\n\t\t\t\t\t\"properties\": {\n\t\t\t\t\t\t\"image_suggestion\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"caption\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"hashtags\": {\n\t\t\t\t\t\t\t\"type\": \"array\",\n\t\t\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"emojis\": {\n\t\t\t\t\t\t\t\"type\": \"array\",\n\t\t\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"call_to_action\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"Facebook\": {\n\t\t\t\t\t\"type\": \"object\",\n\t\t\t\t\t\"properties\": {\n\t\t\t\t\t\t\"post\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"hashtags\": {\n\t\t\t\t\t\t\t\"type\": \"array\",\n\t\t\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"call_to_action\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"image_suggestion\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"X-Twitter\": {\n\t\t\t\t\t\"type\": \"object\",\n\t\t\t\t\t\"properties\": {\n                        \"video_suggestion\": {\n                \t\t\t\"type\": \"string\"\n                \t\t},\n                        \"image_suggestion\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"post\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"hashtags\": {\n\t\t\t\t\t\t\t\"type\": \"array\",\n\t\t\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"character_limit\": {\n\t\t\t\t\t\t\t\"type\": \"integer\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n                \"TikTok\": {\n                \t\"type\": \"object\",\n                \t\"properties\": {\n                \t\t\"video_suggestion\": {\n                \t\t\t\"type\": \"string\"\n                \t\t},\n                \t\t\"caption\": {\n                \t\t\t\"type\": \"string\"\n                \t\t},\n                \t\t\"hashtags\": {\n                \t\t\t\"type\": \"array\",\n                \t\t\t\"items\": {\n                \t\t\t\t\"type\": \"string\"\n                \t\t\t}\n                \t\t},\n                \t\t\"call_to_action\": {\n                \t\t\t\"type\": \"string\"\n                \t\t}\n                \t}\n                },\n                \"Threads\": {\n                \t\"type\": \"object\",\n                \t\"properties\": {\n                       \"image_suggestion\": {\n\t\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t\t},\n                \t\t\"text_post\": {\n                \t\t\t\"type\": \"string\"\n                \t\t},\n                \t\t\"hashtags\": {\n                \t\t\t\"type\": \"array\",\n                \t\t\t\"items\": {\n                \t\t\t\t\"type\": \"string\"\n                \t\t\t}\n                \t\t},\n                \t\t\"call_to_action\": {\n                \t\t\t\"type\": \"string\"\n                \t\t}\n                \t}\n                },\n                \"YouTube_Shorts\": {\n                  \t\"type\": \"object\",\n                  \t\"properties\": {\n                  \t\t\"video_suggestion\": {\n                  \t\t\t\"type\": \"string\"\n                  \t\t},\n                  \t\t\"title\": {\n                  \t\t\t\"type\": \"string\"\n                  \t\t},\n                          \"description\": {\n                              \"type\": \"string\"\n                          },\n                          \"hashtags\": {\n                              \"type\": \"array\",\n                              \"items\": {\n                                  \"type\": \"string\"\n                              }\n                          },\n                          \"call_to_action\": {\n                              \"type\": \"string\"\n                          }\n                      }\n                  }\n\t\t\t}\n\t\t},\n\t\t\"additional_notes\": {\n\t\t\t\"type\": \"string\"\n\t\t}\n\t}\n}\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "a1211873-05ca-48c7-aa93-57d80b37174b",
        "name": "Google Gemini LLM",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "disabled": true,
        "position": [
          320,
          -540
        ],
        "parameters": {
          "options": {
            "temperature": 0.4
          },
          "modelName": "models/gemini-2.0-flash-exp"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "L9UNQHflYlyF9Ngd",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "14327277-1e66-401d-9c74-8fdb6d76445f",
        "name": "gpt-4o-mini",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1360,
          -540
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "gpt-4o-mini"
          },
          "options": {
            "responseFormat": "text"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "9a49454b-f518-4388-82a7-2529addae3e5",
        "name": "gpt-4o",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "disabled": true,
        "position": [
          1500,
          -540
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "gpt-4o"
          },
          "options": {
            "responseFormat": "text"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "56eb9c72-87fc-42b2-b576-be68b3a8c7d2",
        "name": "gpt-4o LLM",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          180,
          -540
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "gpt-4o"
          },
          "options": {
            "responseFormat": "text"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "bf4e6d41-b2be-44fc-8fc7-6dc6bc4ee69a",
        "name": "pollinations.ai",
        "type": "n8n-nodes-base.httpRequest",
        "disabled": true,
        "position": [
          980,
          780
        ],
        "parameters": {
          "url": "=https://image.pollinations.ai/prompt/{{$('Social Media Content Factory').item.json.output.description.replaceAll(' ','-').replaceAll(',','').replaceAll('.','') }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "5a950645-8e74-4be8-bad2-73d9f827a6b8",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          880,
          620
        ],
        "parameters": {
          "width": 300,
          "height": 340,
          "content": "## Create Post Image\nhttps://pollinations.ai/\nhttps://image.pollinations.ai/prompt/[your image description]\n\n(alternative)"
        },
        "typeVersion": 1
      },
      {
        "id": "7b5b53eb-85c6-4a90-b209-7bd8d638f237",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          700,
          20
        ],
        "parameters": {
          "mode": "combine",
          "options": {
            "includeUnpaired": true
          },
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "daa6773e-0e15-4994-bcee-b3d996655855",
        "name": "Save Image to imgbb.com3",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          360,
          -140
        ],
        "parameters": {
          "url": "https://api.imgbb.com/1/upload",
          "method": "POST",
          "options": {
            "redirect": {
              "redirect": {}
            }
          },
          "sendBody": true,
          "sendQuery": true,
          "contentType": "multipart-form-data",
          "bodyParameters": {
            "parameters": [
              {
                "name": "image",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          },
          "queryParameters": {
            "parameters": [
              {
                "name": "expiration",
                "value": "0"
              },
              {
                "name": "key",
                "value": "={{ $env.IMGBB_API_KEY}} "
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "af06853c-258e-4dfb-a579-3168c8de96bd",
        "name": "Instagram Image",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          1700,
          -60
        ],
        "parameters": {
          "url": "https://graph.facebook.com/v20.0/[your-unique-id]/media",
          "method": "POST",
          "options": {},
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "image_url",
                "value": "={{ $json.data.medium.url }}"
              },
              {
                "name": "caption",
                "value": "={{ $('Social Media Content Factory').item.json.output.platform_posts.Instagram.caption }}"
              }
            ]
          },
          "nodeCredentialType": "facebookGraphApi"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "PzDfmiwB7GPtmSaP",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "6ee72138-a8ec-4fbd-8f14-fd6e881edfd1",
        "name": "Instragram Post",
        "type": "n8n-nodes-base.facebookGraphApi",
        "onError": "continueRegularOutput",
        "position": [
          1700,
          160
        ],
        "parameters": {
          "edge": "media_publish",
          "node": "[your-unique-id]",
          "options": {
            "queryParameters": {
              "parameter": [
                {
                  "name": "creation_id",
                  "value": "={{ $json.id }}"
                },
                {
                  "name": "caption",
                  "value": "={{ $('Social Media Content Factory').item.json.output.platform_posts.Instagram.caption }}"
                }
              ]
            }
          },
          "graphApiVersion": "v20.0",
          "httpRequestMethod": "POST"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "PzDfmiwB7GPtmSaP",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "9e168865-1eae-4e53-99c9-91b041426ecb",
        "name": "X Post",
        "type": "n8n-nodes-base.twitter",
        "onError": "continueRegularOutput",
        "position": [
          1700,
          380
        ],
        "parameters": {
          "text": "={{ $('Social Media Content Factory').item.json.output.platform_posts['X-Twitter'].post }}",
          "additionalFields": {}
        },
        "credentials": {
          "twitterOAuth2Api": {
            "id": "wRDruLTCqjQ7C5jq",
            "name": "X account"
          }
        },
        "typeVersion": 2,
        "alwaysOutputData": true
      },
      {
        "id": "4ee55c94-7251-445e-8ce7-15eee7165010",
        "name": "Facebook Post",
        "type": "n8n-nodes-base.facebookGraphApi",
        "onError": "continueRegularOutput",
        "position": [
          1700,
          600
        ],
        "parameters": {
          "edge": "photos",
          "node": "[your-unique-id]",
          "options": {
            "queryParameters": {
              "parameter": [
                {
                  "name": "message",
                  "value": "={{ $('Social Media Content Factory').item.json.output.platform_posts.Facebook.post }}\n\n{{ $('Social Media Content Factory').item.json.output.platform_posts.Facebook.call_to_action }}\n"
                },
                {
                  "name": "link",
                  "value": "={{ $('Social Media Content Factory').item.json.output.platform_posts.Facebook.call_to_action }}"
                }
              ]
            }
          },
          "sendBinaryData": true,
          "graphApiVersion": "v20.0",
          "httpRequestMethod": "POST",
          "binaryPropertyName": "data"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "PzDfmiwB7GPtmSaP",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "3a015f3f-a162-411a-85e8-e1f042d9c653",
        "name": "LinkedIn Post",
        "type": "n8n-nodes-base.linkedIn",
        "onError": "continueRegularOutput",
        "position": [
          1700,
          780
        ],
        "parameters": {
          "text": "={{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.post }}\n{{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.call_to_action }}\n{{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.hashtags }}\n{{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.call_to_action }}",
          "postAs": "organization",
          "organization": "12345678",
          "additionalFields": {},
          "binaryPropertyName": "=data",
          "shareMediaCategory": "IMAGE"
        },
        "credentials": {
          "linkedInOAuth2Api": {
            "id": "WMm6pzAEgNd4wJdO",
            "name": "LinkedIn account"
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "8ab03d75-b4c5-4271-8fa9-830f449a3a3c",
        "name": "OpenAI",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          40,
          -20
        ],
        "parameters": {
          "prompt": "={{ $('Social Media Content Factory').item.json.output.platform_posts.Instagram.caption }}",
          "options": {},
          "resource": "image"
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8,
        "alwaysOutputData": true
      },
      {
        "id": "d1ac29b1-128d-4615-b828-89f1f64d1b15",
        "name": "Merge1",
        "type": "n8n-nodes-base.merge",
        "position": [
          1440,
          -60
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "71eebce8-027a-4b12-b07e-692121de9a68",
        "name": "Merge2",
        "type": "n8n-nodes-base.merge",
        "position": [
          1440,
          680
        ],
        "parameters": {
          "mode": "combine",
          "options": {
            "includeUnpaired": true
          },
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "140cff41-a619-4111-8dc9-3ec8fc45e061",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          -240,
          520
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData"
        },
        "typeVersion": 1
      },
      {
        "id": "3e96bfac-dad5-4b75-b51b-50329892ee70",
        "name": "gpt-4o-mini1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -20,
          540
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "gpt-4o-mini"
          },
          "options": {
            "responseFormat": "text"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4d73d59f-bb8c-481b-877a-bf4dc64f3277",
        "name": "gpt-4o-mini2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -20,
          820
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "gpt-4o-mini"
          },
          "options": {
            "responseFormat": "text"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "aaef70d7-6029-4fae-afc1-72a6a0019b03",
        "name": "Gmail User for Approval",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2000,
          -540
        ],
        "webhookId": "c46cf421-ddb6-45a8-b83b-80b381666f0e",
        "parameters": {
          "sendTo": "={{ $env.EMAIL_ADDRESS_JOE }} ",
          "message": "={{ $json.output }}",
          "options": {
            "limitWaitTime": {
              "values": {
                "resumeUnit": "minutes",
                "resumeAmount": 45
              }
            }
          },
          "subject": "=üî•FOR APPROVALüî•{{ $('Social Media Content Factory').item.json.output.name }} - {{ $('Social Media Content Factory').item.json.output.description }}",
          "operation": "sendAndWait",
          "approvalOptions": {
            "values": {
              "approvalType": "double"
            }
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "1xpVDEQ1yx8gV022",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "44e3bada-7665-4268-bb79-12ffb377552e",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1600,
          -140
        ],
        "parameters": {
          "color": 6,
          "width": 300,
          "height": 1100,
          "content": "## Publish to Social Media"
        },
        "typeVersion": 1
      },
      {
        "id": "75bfc1f4-0afa-4d8d-b5cc-83e29b6570f9",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1940,
          80
        ],
        "parameters": {
          "color": 5,
          "width": 300,
          "height": 880,
          "content": "## Format Results"
        },
        "typeVersion": 1
      },
      {
        "id": "ff5d050a-111c-4467-bc61-e51444943cb5",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -360,
          240
        ],
        "parameters": {
          "color": 7,
          "width": 1020,
          "height": 760,
          "content": "# Step 4Ô∏è‚É£: Send Final Results of Social Media Factory"
        },
        "typeVersion": 1
      },
      {
        "id": "26a684cc-72d9-40c8-bd30-1d074d914328",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -40,
          -100
        ],
        "parameters": {
          "color": 3,
          "width": 260,
          "height": 260,
          "content": "## Create Post Image"
        },
        "typeVersion": 1
      },
      {
        "id": "930e76ac-6e9c-4a3f-9229-28ba18de25a3",
        "name": "Approve Final Post Content",
        "type": "n8n-nodes-base.gmail",
        "disabled": true,
        "position": [
          980,
          380
        ],
        "webhookId": "c46cf421-ddb6-45a8-b83b-80b381666f0e",
        "parameters": {
          "sendTo": "={{ $env.EMAIL_ADDRESS_JOE }} ",
          "message": "=<html>\n<body style=\"margin:0; padding:0; font-family: Arial, sans-serif; background-color: #f5f5f5;\">\n  <div style=\"max-width: 600px; margin: 0 auto; padding: 20px;\">\n\n    <h2 style=\"font-size:20px; color:#333; margin:0 0 15px 0;\">LinkedIn</h2>\n      \n    <!-- LinkedIn Card -->\n    <div style=\"background: #ffffff; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);\">\n\n      <!-- Card Header Image -->\n      <div style=\"height: 200px; overflow: hidden; border-radius: 8px 8px 0 0;\">\n        <img src=\"{{ $json.data.medium.url }}\" alt=\"Featured Image\" style=\"width: 100%; height: 100%; object-fit: cover;\">\n      </div>\n\n      <!-- Card Content -->\n      <div style=\"padding: 25px;\">\n\n        <p style=\"font-size:16px; color:#555; line-height: 1.6; margin-bottom: 15px;\">\n          {{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.post }}\n        </p>\n        \n        <div style=\"margin: 15px 0;\">\n          <span style=\"display: inline-block; background: #f0f0f0; padding: 4px 8px; margin: 2px; border-radius: 4px; font-size:12px; color:#333;\">\n            {{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.hashtags }}\n          </span>\n        </div>\n\n        <p style=\"font-size:14px; color:#1a0dab; font-weight: 600; margin:15px 0 0 0;\">\n          {{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.call_to_action }}\n        </p>\n      </div>\n    </div>\n  </div>\n</body>\n</html>\n",
          "options": {
            "limitWaitTime": {
              "values": {
                "resumeUnit": "minutes",
                "resumeAmount": 45
              }
            }
          },
          "subject": "=üî•FOR APPROVALüî• New LinkedIn Post",
          "operation": "sendAndWait",
          "approvalOptions": {
            "values": {
              "approvalType": "double"
            }
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "1xpVDEQ1yx8gV022",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "051b7ff6-febb-4aba-9790-bc977c11e645",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          880,
          240
        ],
        "parameters": {
          "width": 300,
          "height": 340,
          "content": "## Final Approval before Publishing to Social Feeds\n(optional)"
        },
        "typeVersion": 1
      },
      {
        "id": "b42df164-47ae-4e08-9099-d0958dd41c8f",
        "name": "Is Approved?",
        "type": "n8n-nodes-base.if",
        "position": [
          1160,
          20
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "efe337a1-63e0-4513-873d-421bf41e4868",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.data.approved }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "e3193aef-d115-4c3b-87b2-b8ebd5bb0c05",
        "name": "Instagram Result",
        "type": "n8n-nodes-base.set",
        "position": [
          2040,
          160
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "5c6edc76-1e3b-45b0-8baa-33a14c678150",
                "name": "Instagram Post Result",
                "type": "string",
                "value": "={{ $json }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "6f8b248f-5c79-412c-81ef-3c52bef7f257",
        "name": "X Result",
        "type": "n8n-nodes-base.set",
        "position": [
          2040,
          380
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "5c6edc76-1e3b-45b0-8baa-33a14c678150",
                "name": "X Post Result",
                "type": "string",
                "value": "={{ $json }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "4c1ee118-aba1-4632-bd48-27cef9d5e272",
        "name": "Facebook Result",
        "type": "n8n-nodes-base.set",
        "position": [
          2040,
          600
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "5c6edc76-1e3b-45b0-8baa-33a14c678150",
                "name": "Facebook Post Result",
                "type": "string",
                "value": "={{ $json }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "490223f9-9b6a-4617-8829-c8e4b130feb7",
        "name": "LinkedIn Result",
        "type": "n8n-nodes-base.set",
        "position": [
          2040,
          780
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "5c6edc76-1e3b-45b0-8baa-33a14c678150",
                "name": "LinkedIn Post Result",
                "type": "string",
                "value": "={{ $json }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "9732c12e-903e-49ac-8d29-ffc4d78c7ff8",
        "name": "Submit Social Post Details",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          -180,
          -740
        ],
        "webhookId": "3e762442-715e-47e1-a65e-ae92085857ae",
        "parameters": {
          "options": {
            "buttonLabel": "Automatically Generate Social Media Content"
          },
          "formTitle": "workflows.diy",
          "formFields": {
            "values": [
              {
                "fieldLabel": "Topic",
                "placeholder": "Provide a concise and clear title or main topic for your post (e.g., \"New Product Launch,\" \"Exciting Company Update\"). This helps the AI accurately capture the focus of your content.",
                "requiredField": true
              },
              {
                "fieldLabel": "Keywords or Hashtags (optional)",
                "placeholder": "Include any specific keywords or hashtags you'd like the AI to incorporate into the post. This ensures the content aligns with your branding and campaign objectives.",
                "requiredField": "={{ false }}"
              },
              {
                "fieldLabel": "Link (optional)",
                "placeholder": "=Provide the URL of any product, service, form, support page, or other resource. This link will be included in the generated post to direct your audience to the relevant content.\n"
              }
            ]
          },
          "responseMode": "lastNode",
          "formDescription": "=Welcome to the workflows.diy AI-Powered Assistant!\n\nThis tool is designed to streamline and enhance your social media content creation process.\n\nSimply provide key inputs like a topic or title and an optional image, and our intelligent agent will generate engaging, platform-specific post descriptions tailored to your audience. \n\nWhether you're a marketer, business owner, or influencer, this assistant saves you time while delivering professional-quality content optimized for maximum impact.\n\n"
        },
        "typeVersion": 2.2
      },
      {
        "id": "899f658f-4faa-4ba7-ae02-cc8fb1d22c71",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -360,
          -1060
        ],
        "parameters": {
          "color": 7,
          "width": 2640,
          "height": 760,
          "content": "# Step 1Ô∏è‚É£: Create Social Media Written Content\nNote:  \nYou could use the output of step 1 to create your written content and manually post if required.  \nYou so not have to implement step 2."
        },
        "typeVersion": 1
      },
      {
        "id": "a8075b2a-4cd0-4b0c-9b19-8bd58de449c0",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -360,
          -260
        ],
        "parameters": {
          "color": 7,
          "width": 1020,
          "height": 460,
          "content": "# Step 2Ô∏è‚É£: Create Image or Upload Image for Social Post"
        },
        "typeVersion": 1
      },
      {
        "id": "1da28ef3-9061-4e83-84e0-3502d254d63a",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          840,
          -260
        ],
        "parameters": {
          "color": 7,
          "width": 1680,
          "height": 1260,
          "content": "# Step 3Ô∏è‚É£: Publish Final Social Media Posts"
        },
        "typeVersion": 1
      },
      {
        "id": "1955b762-b9c4-4704-955b-093686e827bd",
        "name": "Merge Results",
        "type": "n8n-nodes-base.merge",
        "onError": "continueRegularOutput",
        "position": [
          2340,
          780
        ],
        "parameters": {
          "numberInputs": 4
        },
        "typeVersion": 3,
        "alwaysOutputData": true
      },
      {
        "id": "6dc47749-eb49-4351-89aa-50f2b6c035bb",
        "name": "Social Media Content Factory",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          300,
          -740
        ],
        "parameters": {
          "text": "=You are a **content creation AI** for workflows.diy, a leading creator of **n8n workflow automation solutions and AI Agentic workflows**.\n\nYour goal is to craft **engaging, platform-specific content** for LinkedIn, Instagram, Facebook, Twitter (X), TikTok, Threads, and YouTube Shorts. Each post must align with the platform‚Äôs audience preferences, tone, and style while reflecting workflows.diy's expertise. The content should provide **value-driven insights**, tutorials, reviews, and discussions that resonate with tech professionals, automation enthusiasts, businesses, and n8n users.\n\n### Key Objectives:\n1. **Platform Optimization**: Tailor content format, tone, and hashtags to suit each platform‚Äôs algorithm and audience engagement patterns.\n2. **SEO & Hashtags**: Use a mix of general automation hashtags and trending platform-specific hashtags to maximize reach.\n3. **Engagement Focus**: Create content that sparks interaction through tutorials, comparisons, reviews, or thought-provoking discussions.\n4. **Consistency**: Maintain a professional yet approachable tone across all platforms while adapting to audience needs.\n5. **Data-Driven Strategy**: Analyze trends and performance data to refine content strategy and hashtag usage.\n\n### General Hashtags:\n#workflowsdiy #n8n #automation #AIWorkflows #WorkflowAutomation #TechSolutions\n\n---\n\n### Platform-Specific Guidelines:\n\n#### 1. LinkedIn\n   - **Style**: Professional and insightful.\n   - **Tone**: Business-oriented; focus on automation use cases, industry insights, and community impact.\n   - **Content Length**: 3-4 sentences; concise but detailed.\n   - **Hashtags**: #Innovation #Automation #WorkflowSolutions #DigitalTransformation #Leadership\n   - **Call to Action (CTA)**: Encourage comments or visits to workflows.diy‚Äôs website for more insights.\n\n#### 2. Instagram\n   - **Style**: Visual storytelling with creative captions.\n   - **Tone**: Inspirational and engaging; use emojis for relatability.\n   - **Content Length**: 2-3 sentences paired with eye-catching visuals (e.g., infographics or workflow demos).\n   - **Visuals**: Showcase milestones (e.g., new workflow launches), tutorials, or product highlights.\n   - **CTA**: Use phrases like \"Swipe to learn more,\" \"Tag your team,\" or \"Check out the link below!\"\n   - **Link Placement**: Add the provided link before hashtags; if no link is provided, use \"Visit our website: https://workflows.diy.\"\n   - **Hashtags**: #AutomationLife #TechInnovation #WorkflowTips #Programming #Engineering\n\n#### 3. Facebook\n   - **Style**: Friendly and community-focused.\n   - **Tone**: Relatable; highlight user success stories or company achievements in automation.\n   - **Content Length**: 2-3 sentences; conversational yet professional.\n   - **Hashtags**: #SmallBusinessAutomation #Entrepreneurship #Leadership #WorkflowInnovation\n   - **CTA**: Encourage likes, shares, comments (e.g., ‚ÄúWhat‚Äôs your favorite automation tip?‚Äù).\n\n#### 4. Twitter (X)\n   - **Style**: Concise and impactful.\n   - **Tone**: Crisp and engaging; spark curiosity in 150 characters or less.\n   - **Hashtags**: #WorkflowTrends #AIWorkflows #AutomationTips #NoCodeSolutions\n   - **CTA**: Drive quick engagement through retweets or replies (e.g., ‚ÄúWhat‚Äôs your go-to n8n workflow?‚Äù).\n\n#### 5. TikTok\n   - **Style**: Short-form video content with trending audio or effects.\n   - **Tone**: Fun yet informative; focus on quick workflow demos or automation tips.\n   - **Content Length**: 15-60 seconds with captions summarizing the key message.\n   - **Hashtags**: Use trending tech-related hashtags relevant to TikTok‚Äôs audience (e.g., #n8nTips).\n   - **CTA**: Encourage viewers to follow workflows.diy for more automation hacks.\n\n#### 6. Threads\n   - **Style**: Conversational and community-driven posts.\n   - **Tone**: Casual yet informative; encourage discussions around automation trends or innovations.\n   - **Content Length**: 1-2 short paragraphs with a question or thought-provoking statement at the end.\n   - **Hashtags**: Similar to Instagram but tailored for trending Threads topics related to automation.\n\n#### 7. YouTube Shorts\n   - **Style**: Short-form video content showcasing quick workflow tutorials or use cases.\n   - **Tone**: Authoritative yet approachable; establish workflows.diy as a leader in n8n automation solutions.\n   - Content Length:\n     - Tutorials/Reviews (long-form): 5-10 minutes\n     - Shorts/Highlights (short-form): Under 1 minute\n   - CTA:** Encourage subscriptions**, likes, comments (e.g., ‚ÄúSubscribe for more workflow tips!‚Äù).\n\n---\n\n### Content Creation Workflow:\nFor every post:\n1. Use the following input fields:\n    - Topic/About the Post: {{ $json.Topic }}\n    - Keywords/Focus Areas: {{ $json.formMode }}\n    - Link (optional): {{ $json['Link (optional)'] }}\n2. Adapt the tone/style based on the platform guidelines above.\n\nEnsure every post reflects workflows.diy's mission of delivering high-quality automation insights while maximizing engagement across platforms.\n\nFollow the provided JSON schema for your reponse.\n",
          "options": {
            "systemMessage": "=Use the provided tools to research the topic based on latest information.  Todays date is {{ $now }}"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "retryOnFail": true,
        "typeVersion": 1.7
      },
      {
        "id": "88c548bf-40e5-4b89-aef0-9233c3f5bc9c",
        "name": "Prepare Content Review Email",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1440,
          -740
        ],
        "parameters": {
          "text": "=Generate clean, modern HTML email content from the provided JSON data with these requirements:\n- Use table-based layout with inline CSS for email compatibility\n- Create card sections for each platform containing:\n  ‚Ä¢ Title header (20px) \n  ‚Ä¢ Post content (16px) \n  ‚Ä¢ Video/image suggestions (italic 14px)\n  ‚Ä¢ Hashtag list (inline-block with # prefix)\n  ‚Ä¢ Emoji preservation where present\n  ‚Ä¢ Call-to-action (bold 14px)\n- Structure using:\n  ‚Ä¢ 600px max-width container\n  ‚Ä¢ 20px padding between cards\n  ‚Ä¢ Left-aligned text hierarchy\n  ‚Ä¢ Arial/sans-serif font stack\n  ‚Ä¢ Email-safe colors (#333 text, #555 secondary)\n- Include all platform-specific elements:\n  ‚ñ∂ Video/image suggestions in italic\n  ‚ñ∂ Hashtags as linked search terms\n  ‚ñ∂ Emojis in original positions\n  ‚ñ∂ Character limits for Twitter\n  ‚ñ∂ Platform-specific CTAs\n  ‚ñ∂ Visual quality reminders\n- Format hashtags as:\n  <span style=\"display: inline-block; background: #f0f0f0; padding: 2px 6px; margin: 2px; border-radius: 4px;\">#tag</span>\n\nInput data: {{ $json.output.toJsonString() }}\n\nRemove ALL code blocks and comments. Output ONLY the raw HTML with:\n- Platform cards in JSON order\n- All data elements represented\n- Mobile-responsive tables\n- W3C-valid markup\n\n## Example HTML:\n<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#fbfcfe;border:1px solid #dbdfe7;border-radius:8px\">\n\t\t<tbody><tr>\n\t\t\t<td align=\"center\" style=\"padding:24px 0\">\n\t\t\t\t<table width=\"448\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:100%;max-width:448px;background-color:#ffffff;border:1px solid #dbdfe7;border-radius:8px;padding:24px\">\n\t\t\t\t\t<tbody><tr>\n\t\t\t\t\t\t<td style=\"text-align:center;padding-top:8px;font-family:Arial,sans-serif;font-size:14px;color:#7e8186\">\n\t\t\t\t\t\t\t<p style=\"white-space:pre-line\"></p><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"max-width:600px;font-family:Arial,sans-serif;color:#333\"><tbody><tr><td style=\"padding:20px\"><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#f9f9f9;margin-bottom:20px;padding:20px;border-radius:8px\"><tbody><tr><td style=\"font-size:20px;font-weight:bold;padding-bottom:10px\">LinkedIn</td></tr><tr><td style=\"font-size:16px;padding-bottom:10px\">Discover why n8n stands out as the premier workflow automation tool. Its flexibility and open-source nature empower businesses to create custom solutions that drive efficiency and innovation.</td></tr><tr><td style=\"font-size:14px;font-style:italic;padding-bottom:10px\">Video/Image suggestion pending</td></tr><tr><td style=\"padding-bottom:10px\"><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#Innovation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#Automation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>WorkflowSolutions</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>DigitalTransformation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>Leadership</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#workflowsdiy</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#n8n</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>AIWorkflows</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#WorkflowAutomation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\"><wbr>#TechSolutions</span></td></tr><tr><td style=\"font-size:14px;font-weight:bold\">Visit workflows.diy to explore how n8n can transform your business processes!</td></tr></tbody></table><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#f9f9f9;margin-bottom:20px;padding:20px;border-radius:8px\"><tbody><tr><td style=\"font-size:20px;font-weight:bold;padding-bottom:10px\">Instagram</td></tr><tr><td style=\"font-size:14px;font-style:italic;padding-bottom:10px\">Eye-catching infographic comparing n8n to other automation tools, highlighting its unique features.</td></tr><tr><td style=\"font-size:16px;padding-bottom:10px\">n8n: The ultimate workflow automation tool! <img data-emoji=\"üí°\" class=\"an1\" alt=\"üí°\" aria-label=\"üí°\" draggable=\"false\" src=\"https://fonts.gstatic.com/s/e/notoemoji/16.0/1f4a1/32.png\" loading=\"lazy\"> Unlock limitless possibilities with its open-source platform. Boost your productivity and streamline your processes. <img data-emoji=\"üí§\" class=\"an1\" alt=\"üí§\" aria-label=\"üí§\" draggable=\"false\" src=\"https://fonts.gstatic.com/s/e/notoemoji/16.0/1f4a4/32.png\" loading=\"lazy\"></td></tr><tr><td style=\"padding-bottom:10px\"><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#AutomationLife</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#TechInnovation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\"><wbr>#WorkflowTips</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#Programming</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>Engineering</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#workflowsdiy</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#n8n</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>AIWorkflows</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#WorkflowAutomation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\"><wbr>#TechSolutions</span></td></tr><tr><td style=\"font-size:14px;font-weight:bold\">Visit our website: <a href=\"https://n8n.io/\" target=\"_blank\" data-saferedirecturl=\"https://www.google.com/url?q=https://n8n.io/&amp;source=gmail&amp;ust=1741030878129000&amp;usg=AOvVaw1Nr6ek3eGwe94zlbPaJrzT\">https://n8n.io/</a> #AutomationLife #TechInnovation #WorkflowTips #Programming #Engineering</td></tr></tbody></table><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#f9f9f9;margin-bottom:20px;padding:20px;border-radius:8px\"><tbody><tr><td style=\"font-size:20px;font-weight:bold;padding-bottom:10px\">Facebook</td></tr><tr><td style=\"font-size:16px;padding-bottom:10px\">See why businesses are choosing n8n for their workflow automation needs. From its user-friendly interface to its powerful customization options, n8n is revolutionizing how companies approach automation.</td></tr><tr><td style=\"font-size:14px;font-style:italic;padding-bottom:10px\">A visually appealing graphic showcasing n8n's key features and benefits.</td></tr><tr><td style=\"padding-bottom:10px\"><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#SmallBusinessAutomation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>Entrepreneurship</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#Leadership</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>WorkflowInnovation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>workflowsdiy</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#n8n</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#AIWorkflows</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>WorkflowAutomation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>TechSolutions</span></td></tr><tr><td style=\"font-size:14px;font-weight:bold\">What's your favorite automation tip? Share in the comments!</td></tr></tbody></table><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#f9f9f9;margin-bottom:20px;padding:20px;border-radius:8px\"><tbody><tr><td style=\"font-size:20px;font-weight:bold;padding-bottom:10px\">Twitter</td></tr><tr><td style=\"font-size:16px;padding-bottom:10px\">n8n: The best #WorkflowAutomation tool! Open-source, customizable, and powerful. Transform your business processes today!</td></tr><tr><td style=\"padding-bottom:10px\"><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#WorkflowTrends</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#AIWorkflows</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>AutomationTips</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#NoCodeSolutions</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\"><wbr>#workflowsdiy</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#n8n</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>TechSolutions</span></td></tr></tbody></table><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#f9f9f9;margin-bottom:20px;padding:20px;border-radius:8px\"><tbody><tr><td style=\"font-size:20px;font-weight:bold;padding-bottom:10px\">TikTok</td></tr><tr><td style=\"font-size:14px;font-style:italic;padding-bottom:10px\">Quick demo showcasing how n8n simplifies complex workflows with its intuitive interface.</td></tr><tr><td style=\"font-size:16px;padding-bottom:10px\">n8n: Your go-to for effortless workflow automation! <img data-emoji=\"‚ú®\" class=\"an1\" alt=\"‚ú®\" aria-label=\"‚ú®\" draggable=\"false\" src=\"https://fonts.gstatic.com/s/e/notoemoji/16.0/2728/32.png\" loading=\"lazy\"></td></tr><tr><td style=\"padding-bottom:10px\"><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#n8nTips</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#workflowsdiy</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#n8n</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>AIWorkflows</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#WorkflowAutomation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\"><wbr>#TechSolutions</span></td></tr><tr><td style=\"font-size:14px;font-weight:bold\">Follow workflows.diy for more automation hacks!</td></tr></tbody></table><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#f9f9f9;margin-bottom:20px;padding:20px;border-radius:8px\"><tbody><tr><td style=\"font-size:20px;font-weight:bold;padding-bottom:10px\">Threads</td></tr><tr><td style=\"font-size:16px;padding-bottom:10px\">n8n is transforming the automation landscape. Its open-source nature and extensive integrations make it a top choice for businesses of all sizes. What are your thoughts on the future of workflow automation?</td></tr><tr><td style=\"padding-bottom:10px\"><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#workflowsdiy</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#n8n</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#AIWorkflows</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>WorkflowAutomation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>TechSolutions</span></td></tr><tr><td style=\"font-size:14px;font-weight:bold\">Share your insights below!</td></tr></tbody></table><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#f9f9f9;margin-bottom:20px;padding:20px;border-radius:8px\"><tbody><tr><td style=\"font-size:20px;font-weight:bold;padding-bottom:10px\">YouTube Shorts</td></tr><tr><td style=\"font-size:14px;font-style:italic;padding-bottom:10px\">Short tutorial demonstrating how to build a simple automation workflow in n8n.</td></tr><tr><td style=\"font-size:16px;padding-bottom:10px\">Learn why n8n is the top choice for workflow automation. Its open-source platform and powerful features make it a game-changer for businesses.</td></tr><tr><td style=\"padding-bottom:10px\"><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#n8n</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#automation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>workflowautomation</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#nocode</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>workflowsdiy</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#AIWorkflows</span><span style=\"display:inline-block;background:#f0f0f0;padding:2px 6px;margin:2px;border-radius:4px\">#<wbr>TechSolutions</span></td></tr><tr><td style=\"font-size:14px;font-weight:bold\">Subscribe for more workflow tips!</td></tr></tbody></table></td></tr></tbody></table><p></p>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n</table>\n",
          "agent": "conversationalAgent",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "3b074887-262f-47ab-b69c-c51b3a513993",
        "name": "Prepare Results Email",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          0,
          380
        ],
        "parameters": {
          "text": "=Parse the social media post results and generate a modern single line HTML table showing platform statuses. For each entry:\n\n-Extract platform name from the JSON key\n-Identify status (Success/Error) based on statusCode or error presence\n-Capture error message if present\n-Format as responsive HTML table with professional styling\n-Ensure email client compatibility with inline CSS\n-Include error handling for invalid JSON formats\n-Remove all line breaks and \\n from response.\n-Avoid any preamble or further explanation and remove all ``` and ```html from response.\n\n## Implementation Example:\nThis solution uses the parsed results from your workflow to generate:\n<table style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif; margin: 20px 0; background-color: #f9f9f9; border: 1px solid #ddd;\">\n    <thead>\n        <tr style=\"background-color: #007bff; color: #fff;\">\n            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Platform</th>\n            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Status</th>\n            <th style=\"border: 1px solid #ddd; padding: 12px; text-align: left;\">Details</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr style=\"background-color: #ffffff;\">\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">Instagram</td>\n            <td style=\"border: 1px solid #ddd; padding: 12px; color: #dc3545;\">‚úó Error</td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">Unsupported post request. Object with ID '[your-unique-id]' does not exist, cannot be loaded due to missing permissions.</td>\n        </tr>\n        <tr style=\"background-color: #f8f9fa;\">\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">X (Twitter)</td>\n            <td style=\"border: 1px solid #ddd; padding: 12px; color: #dc3545;\">‚úó Error</td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">Unable to sign without access token</td>\n        </tr>\n        <tr style=\"background-color: #ffffff;\">\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">Facebook</td>\n            <td style=\"border: 1px solid #ddd; padding: 12px; color: #dc3545;\">‚úó Error</td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">Unsupported post request. Object with ID '[your-unique-id]' does not exist, cannot be loaded due to missing permissions.</td>\n        </tr>\n        <tr style=\"background-color: #f8f9fa;\">\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">LinkedIn</td>\n            <td style=\"border: 1px solid #ddd; padding: 12px; color: #dc3545;\">‚úó Error</td>\n            <td style=\"border: 1px solid #ddd; padding: 12px;\">Unable to sign without access token</td>\n        </tr>\n    </tbody>\n</table>\n\n\nThis is the social media post results: \n{{ $json.data.toJsonString() }}\n",
          "agent": "conversationalAgent",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "abb3994f-bf23-43f8-9c46-28795cfd2017",
        "name": "Prepare Results Message",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          0,
          660
        ],
        "parameters": {
          "text": "=Parse the social media post results and generate a brief summary of the results.\n\nThis is the social media post results: \n{{ $json.data.toJsonString() }}\n\n## Example Response:\nThe social media post results indicate multiple errors when attempting to access or post content on various platforms. \n\n1. Instagram: The response shows a 400 status code with an error message indicating that the specific post request is unsupported due to missing permissions or an invalid object ID. \n\n2. X Post: Success\n\n3. Facebook: Success \n\n4. LinkedIn: Also returned an 'Unable to sign without access token' error. \n\nOverall, access token issues and unsupported requests are frequent problems across these social media platforms.\n",
          "agent": "conversationalAgent",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "b4a4838a-83b0-4f28-a9f3-dea915228325",
        "name": "Image Choice",
        "type": "n8n-nodes-base.form",
        "disabled": true,
        "position": [
          -620,
          -120
        ],
        "webhookId": "0dc811ef-b2e0-4213-a0c9-e9b5fb9fcbf1",
        "parameters": {
          "options": {
            "formTitle": "Generate Post Image",
            "buttonLabel": "Submit"
          },
          "formFields": {
            "values": [
              {
                "fieldType": "file",
                "fieldLabel": "Upload Image (optional)",
                "multipleFiles": false,
                "acceptFileTypes": ".jpg, .png, .jpeg"
              },
              {
                "fieldType": "dropdown",
                "fieldLabel": "Generate Custom Image using AI Image Generator",
                "fieldOptions": {
                  "values": [
                    {
                      "option": "Yes"
                    },
                    {
                      "option": "No"
                    }
                  ]
                },
                "requiredField": true
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "1cf97c10-e60f-4584-b069-3d4506868d8e",
        "name": "Gmail Results",
        "type": "n8n-nodes-base.gmail",
        "position": [
          360,
          380
        ],
        "webhookId": "0a81b95a-cd82-465d-8450-cf38518a4cbb",
        "parameters": {
          "sendTo": "={{ $env.EMAIL_ADDRESS_JOE }} ",
          "message": "={{ $json.output }}",
          "options": {
            "appendAttribution": false
          },
          "subject": "üî•RESULTSüî• Social Media Factory"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "1xpVDEQ1yx8gV022",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "c845ae46-9d37-472b-ae0f-49fc6940e685",
        "name": "Telegram Results",
        "type": "n8n-nodes-base.telegram",
        "position": [
          360,
          660
        ],
        "webhookId": "bb40ede7-03cf-493d-b051-196b96725925",
        "parameters": {
          "text": "={{ $json.output }}",
          "chatId": "={{ $env.TELEGRAM_CHAT_ID }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "pAIFhguJlkO3c7aQ",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a33f9431-bede-4f66-ae0d-1e686a3092b7",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -320,
          340
        ],
        "parameters": {
          "color": 4,
          "width": 940,
          "height": 620,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "643b94c6-4535-4876-9660-d82ff69cbcf6",
        "name": "Is Content Approved?",
        "type": "n8n-nodes-base.if",
        "position": [
          -240,
          -20
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "e32d270f-f258-4522-94e1-2cb7ee4e8d2a",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.data.approved }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "fb7108e2-21cf-4df4-ab20-fe75b15b0a24",
        "name": "Set Default True 2",
        "type": "n8n-nodes-base.set",
        "position": [
          980,
          20
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "f150aa79-2d20-4869-b60a-350d49a215a5",
                "name": "data",
                "type": "object",
                "value": "={\n  \"approved\": true\n}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "66364a53-c2fc-43fd-be92-683b373652df",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -700,
          -260
        ],
        "parameters": {
          "width": 300,
          "height": 580,
          "content": "## Alternative User Uploaded Image\n(optional)"
        },
        "typeVersion": 1
      },
      {
        "id": "d0025029-1f6f-4b27-8495-00966f1dae12",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          880,
          -140
        ],
        "parameters": {
          "width": 460,
          "height": 340,
          "content": "## Implement Additional Approval Here\n(optional)"
        },
        "typeVersion": 1
      },
      {
        "id": "0a10bca0-c3a8-496b-a22e-120928ad7736",
        "name": "SerpAPI",
        "type": "@n8n/n8n-nodes-langchain.toolSerpApi",
        "position": [
          460,
          -540
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "serpApi": {
            "id": "DfdkTTaZtPp0iHYv",
            "name": "SerpAPI account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "fa765062-22ef-4f26-9f02-099235edc771",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          780,
          -900
        ],
        "parameters": {
          "width": 480,
          "height": 500,
          "content": "### üí°Notes\n\nAdjust the Social Media Content Factory prompts to suit your personal or business requirements.\n\nUpdate Credentials for:\n- OpenAI API Key\nhttps://auth.openai.com/log-in\n\n- Google Studio API\nhttps://aistudio.google.com/app/apikey\n\n- SERP API Key\nhttps://serpapi.com/\n\n- Gmail OAuth\nhttps://docs.n8n.io/integrations/builtin/credentials/google/\n\n- Telegram Bot (Optional)\nhttps://docs.n8n.io/integrations/builtin/credentials/telegram/\n\n- imgbb\nhttps://imgbb.com/"
        },
        "typeVersion": 1
      },
      {
        "id": "5ffc2b16-61af-4395-a57b-20d1cd125488",
        "name": "Sticky Note17",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1940,
          -140
        ],
        "parameters": {
          "width": 300,
          "height": 180,
          "content": "üí°Notes\n\nUpdate all Social Media Platform Credentials as required.\n\nAdjust parameters and content for each platform to suit your needs."
        },
        "typeVersion": 1
      },
      {
        "id": "b21f527c-5674-49d0-a114-866d669e7ad6",
        "name": "Rename Binary File",
        "type": "n8n-nodes-base.code",
        "position": [
          -620,
          120
        ],
        "parameters": {
          "jsCode": "$input.first().binary.data = $input.first().binary.Upload_Image__optional_\ndelete $input.first().binary.Upload_Image__optional_\nreturn $input.first()"
        },
        "typeVersion": 2,
        "alwaysOutputData": true
      }
    ],
    "active": false,
    "pinData": {
      "Submit Social Post Details": [
        {
          "json": {
            "Topic": "Why n8n is the Best Workflow Automation Tool",
            "formMode": "test",
            "submittedAt": "2025-03-02T13:32:20.807-05:00",
            "Link (optional)": "https://n8n.io/",
            "Keywords or Hashtags (optional)": "n8n, AIWorkflows, workflows.diy"
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "d44bf3b1-5ba6-48e2-8ab6-1cbe93a260e4",
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Set Default True 2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge1": {
        "main": [
          [
            {
              "node": "Instagram Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge2": {
        "main": [
          [
            {
              "node": "Facebook Post",
              "type": "main",
              "index": 0
            },
            {
              "node": "LinkedIn Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI": {
        "main": [
          [
            {
              "node": "Save Image to imgbb.com3",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            },
            {
              "node": "Merge2",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "X Post": {
        "main": [
          [
            {
              "node": "X Result",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "SerpAPI": {
        "ai_tool": [
          [
            {
              "node": "Social Media Content Factory",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "X Result": {
        "main": [
          [
            {
              "node": "Merge Results",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Prepare Results Email",
              "type": "main",
              "index": 0
            },
            {
              "node": "Prepare Results Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "gpt-4o LLM": {
        "ai_languageModel": [
          [
            {
              "node": "Social Media Content Factory",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "gpt-4o-mini": {
        "ai_languageModel": [
          [
            {
              "node": "Prepare Content Review Email",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Image Choice": {
        "main": [
          [
            {
              "node": "Rename Binary File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Approved?": {
        "main": [
          [
            {
              "node": "X Post",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge1",
              "type": "main",
              "index": 1
            },
            {
              "node": "Merge2",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "gpt-4o-mini1": {
        "ai_languageModel": [
          [
            {
              "node": "Prepare Results Email",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "gpt-4o-mini2": {
        "ai_languageModel": [
          [
            {
              "node": "Prepare Results Message",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Facebook Post": {
        "main": [
          [
            {
              "node": "Facebook Result",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "LinkedIn Post": {
        "main": [
          [
            {
              "node": "LinkedIn Result",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Merge Results": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Facebook Result": {
        "main": [
          [
            {
              "node": "Merge Results",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Instagram Image": {
        "main": [
          [
            {
              "node": "Instragram Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Instragram Post": {
        "main": [
          [
            {
              "node": "Instagram Result",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "LinkedIn Result": {
        "main": [
          [
            {
              "node": "Merge Results",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "pollinations.ai": {
        "main": [
          []
        ]
      },
      "Instagram Result": {
        "main": [
          [
            {
              "node": "Merge Results",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini LLM": {
        "ai_languageModel": [
          []
        ]
      },
      "Set Default True 2": {
        "main": [
          [
            {
              "node": "Is Approved?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Content Approved?": {
        "main": [
          [
            {
              "node": "OpenAI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Social Media Content": {
        "ai_outputParser": [
          [
            {
              "node": "Social Media Content Factory",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Results Email": {
        "main": [
          [
            {
              "node": "Gmail Results",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail User for Approval": {
        "main": [
          [
            {
              "node": "Is Content Approved?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Results Message": {
        "main": [
          [
            {
              "node": "Telegram Results",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Image to imgbb.com3": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Approve Final Post Content": {
        "main": [
          []
        ]
      },
      "Submit Social Post Details": {
        "main": [
          [
            {
              "node": "Social Media Content Factory",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Content Review Email": {
        "main": [
          [
            {
              "node": "Gmail User for Approval",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Social Media Content Factory": {
        "main": [
          [
            {
              "node": "Prepare Content Review Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "nodes": [
      {
        "id": "b9256d00-9dff-432a-a678-e71a4074b26c",
        "name": "Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -20,
          -160
        ],
        "webhookId": "06d29616-8fa9-42cf-8b5f-abe856083c75",
        "parameters": {
          "path": "06d29616-8fa9-42cf-8b5f-abe856083c75",
          "options": {},
          "httpMethod": "POST"
        },
        "typeVersion": 2
      },
      {
        "id": "2726dd28-5366-4c0e-ad16-bae6dc2cbc0b",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -880,
          -200
        ],
        "parameters": {
          "color": 4,
          "width": 320,
          "height": 440,
          "content": "## What does it do?\nObjective:\n\nStreamline the onboarding process for new customers, ensuring they receive all necessary resources and support.\nTrigger: Set a webhook trigger or a CRM trigger (like HubSpot or Salesforce) for when a new customer is added.\n\nSend Welcome Email: Use the Gmail or SMTP node to send a personalized welcome email to the customer.\n\nSchedule a Welcome Call: Use the Calendar node (Google Calendar) to automatically create a calendar event for a welcome call.\n\nAssign a CSM: Use the CRM node (like HubSpot) to assign the new customer to a dedicated CSM."
        },
        "typeVersion": 1
      },
      {
        "id": "680bdd4e-f382-4d20-8197-a7d65454ce36",
        "name": "Try Again",
        "type": "n8n-nodes-base.set",
        "position": [
          1000,
          500
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "7ab380a2-a8d3-421c-ab4e-748ea8fb7904",
                "name": "response",
                "type": "string",
                "value": "Unable to perform task. Please try again."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "1ab48997-7533-4572-86d5-980af557d09d",
        "name": "Success",
        "type": "n8n-nodes-base.set",
        "position": [
          1000,
          300
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "39c2f302-03be-4464-a17a-d7cc481d6d44",
                "name": "=response",
                "type": "string",
                "value": "={{$json.output}}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "4cb493a1-1eff-42ca-9c51-8f070fe3e9ba",
        "name": "Calendar Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "onError": "continueErrorOutput",
        "position": [
          412,
          400
        ],
        "parameters": {
          "text": "={{ $json.query }}",
          "options": {
            "systemMessage": "=# Overview\nYou are a calendar assistant. Your responsibilities include creating, getting, and deleting events in the user's calendar.\nIf no date is proposed, find the next available slot using \"Get Events\" and create an event using \"Create Event with Attendee\"\n\n**Calendar Management Tools**  \n   - Use \"Create Event with Attendee\" when an event includes a participant.     \n   - Use \"Get Events\" to fetch calendar schedules when requested.\n   - Use \"Delete Event\" to delete an event. You must use \"Get Events\" first to get the ID of the event to delete.\n   - Use \"Update Event\" to update an event. You must use \"Get Events\" first to get the ID of the event to update.\n\n## Final Notes\nHere is the current date/time: {{ $now }}\nIf a duration for an event isn't specified, assume it will be one hour."
          },
          "promptType": "define"
        },
        "typeVersion": 1.6
      },
      {
        "id": "8c088b37-1005-4bc4-bdf5-0558ccb0c873",
        "name": "Create Event with Attendee",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          320,
          620
        ],
        "parameters": {
          "end": "={{ $fromAI(\"eventEnd\") }}",
          "start": "={{ $fromAI(\"eventStart\") }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Calendar', ``, 'string') }}",
            "__regex": "(^[a-zA-Z0-9.!#$%&‚Äô*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*)"
          },
          "additionalFields": {
            "summary": "={{ $fromAI(\"eventTitle\") }}",
            "attendees": [
              "={{ $fromAI(\"eventAttendeeEmail\") }}"
            ]
          }
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "90bjjmYqtg3hnvFM",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "91a0e49a-888f-4511-94e7-e0166ce7dd58",
        "name": "Create Event",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          440,
          620
        ],
        "parameters": {
          "end": "={{ $fromAI(\"eventEnd\") }}",
          "start": "={{ $fromAI(\"eventStart\") }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Calendar', ``, 'string') }}",
            "__regex": "(^[a-zA-Z0-9.!#$%&‚Äô*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*)"
          },
          "additionalFields": {
            "summary": "={{ $fromAI(\"eventTitle\") }}",
            "attendees": []
          }
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "90bjjmYqtg3hnvFM",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "8cfb90e5-6108-4003-b048-271650d4bc6c",
        "name": "Get Events",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          560,
          620
        ],
        "parameters": {
          "options": {},
          "timeMax": "={{ $fromAI(\"dayBefore\",\"today plus 7 days\") }}",
          "timeMin": "={{ $fromAI(\"dayAfter\",\"today\") }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $fromAI('Calendar', `sender's email`, 'string') }}"
          },
          "operation": "getAll"
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "90bjjmYqtg3hnvFM",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "c5cc3550-7d9a-43c9-8434-e1ab78f7f596",
        "name": "Delete Event",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          680,
          620
        ],
        "parameters": {
          "eventId": "={{ $fromAI(\"eventID\") }}",
          "options": {},
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Calendar', ``, 'string') }}",
            "__regex": "(^[a-zA-Z0-9.!#$%&‚Äô*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*)"
          },
          "operation": "delete"
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "90bjjmYqtg3hnvFM",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "7ce45da8-dc24-4634-9f48-3864165885cd",
        "name": "Update Event",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          800,
          620
        ],
        "parameters": {
          "eventId": "={{ $fromAI(\"eventID\") }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Calendar', ``, 'string') }}",
            "__regex": "(^[a-zA-Z0-9.!#$%&‚Äô*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*)"
          },
          "operation": "update",
          "updateFields": {
            "end": "={{ $fromAI(\"endTime\") }}",
            "start": "={{ $fromAI(\"startTime\") }}"
          }
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "90bjjmYqtg3hnvFM",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "b46f24a4-719c-414e-94d9-ecfb1e7dfe39",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          200,
          400
        ],
        "parameters": {
          "inputSource": "passthrough"
        },
        "typeVersion": 1.1
      },
      {
        "id": "aedbe138-ed51-4300-881b-6b58928f5bb4",
        "name": "OpenAI Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1520,
          160
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "1IOLtYX7aTspCAN8",
            "name": "OpenAI Pollup"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a540ae6b-e1ee-4d91-988e-e60bae743377",
        "name": "calendarAgent",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          1640,
          160
        ],
        "parameters": {
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id}}",
            "cachedResultName": "={{ $workflow.id}}"
          },
          "description": "Call this tool for any calendar action.",
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "64979b9f-a29a-4c53-b87a-cec84e7ba1fe",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1760,
          160
        ],
        "parameters": {
          "jsonSchemaExample": "{\n\t\"subject\": \"\",\n\t\"body\": \"\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "359d7296-a8e9-494c-b519-cca62c0805df",
        "name": "Get list of owners",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          420,
          -60
        ],
        "parameters": {
          "url": "https://api.hubapi.com/crm/v3/owners",
          "options": {},
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "hubspotOAuth2Api"
        },
        "credentials": {
          "hubspotOAuth2Api": {
            "id": "qubiIFrowxvUdpu6",
            "name": "HubSpot account for node"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "e8aab719-a5d9-4168-9c68-eea32c7d3ef4",
        "name": "Split Out owners",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          640,
          -60
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "results"
        },
        "typeVersion": 1
      },
      {
        "id": "5e44ea67-e2f9-4cea-a030-c452b8bb482f",
        "name": "Get current owner",
        "type": "n8n-nodes-base.filter",
        "position": [
          860,
          -60
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "7c6aec6e-66a9-4739-8a59-28f2ab1c4a26",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.email }}",
                "rightValue": "={{ $('Enter your company data here').item.json.sender_email }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "c03bd58c-7a42-4966-96e8-45928f745475",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -540,
          -200
        ],
        "parameters": {
          "color": 5,
          "width": 680,
          "height": 1340,
          "content": "## How to Set a Webhook in n8n and HubSpot\n\n## 1. Set Up a Webhook in n8n\n\n### Step 1: Create a New Workflow\n- Go to your **n8n dashboard**.\n- Click on **\"New Workflow.\"**\n\n### Step 2: Add the Webhook Node\n- Click on the **‚Äú+‚Äù** icon to add a new node.\n- Search for **‚ÄúWebhook‚Äù** and select it.\n- Set the **Webhook Method** (usually POST).\n- Define the **Webhook URL path**, for example, `/hubspot-webhook`.\n- Set the **\"Response Mode\"** (e.g., \"On Received\").\n- Save the workflow.\n\n### Step 3: Set Webhook URL\n- Copy the **Webhook URL** generated by n8n. It should look something like:https://your-n8n-domain/webhook/hubspot-webhook\n\n- Ensure the workflow is **active**.\n\n---\n\n## 2. Set Up a Webhook in HubSpot\n\n### Step 1: Log in to HubSpot\n- Go to **HubSpot Developer Account** (required for webhook setup).\n- Navigate to **\"Settings\" > \"Integrations\" > \"Webhooks.\"**\n\n### Step 2: Create a New Webhook Subscription\n- Click **‚ÄúCreate Webhook‚Äù** or **‚ÄúAdd Webhook‚Äù** if this is your first one.\n- Select the **events** you want to track (e.g., contact creation, form submission).\n- Set the **Webhook URL** as the n8n Webhook URL you copied earlier.\n- Choose **‚ÄúPOST‚Äù** as the request method.\n- Set the **Authentication** if needed (you can set a secret or use OAuth).\n\n### Step 3: Test the Webhook\n- Use the **‚ÄúTest Webhook‚Äù** feature in HubSpot to send a test request.\n- Switch to n8n and ensure the webhook is triggering properly.\n\n---\n\n## 3. Process the Data in n8n\n- After the webhook is triggered in n8n, you will see the data sent by HubSpot.\n- You can now add additional nodes to **process the data** (e.g., save to database, send email, perform actions in another app).\n\n---\n\n## 4. Make the Workflow Active\n- Once you are done configuring, make sure the workflow is **set to ‚ÄúActive.‚Äù**\n- This will allow it to receive live data from HubSpot."
        },
        "typeVersion": 1
      },
      {
        "id": "3861fa49-909d-4591-a1b8-d7bdd20e6560",
        "name": "HubSpot Trigger",
        "type": "n8n-nodes-base.hubspotTrigger",
        "position": [
          -20,
          40
        ],
        "webhookId": "632f3fc8-b921-4697-ba12-037d5c7f8971",
        "parameters": {
          "eventsUi": {
            "eventValues": [
              {}
            ]
          },
          "additionalFields": {}
        },
        "credentials": {
          "hubspotDeveloperApi": {
            "id": "DVrqcbIPANwtlVSg",
            "name": "HubSpot Developer account for trigger"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9051cc3d-06be-4238-998e-7cb938313d24",
        "name": "Enter your company data here",
        "type": "n8n-nodes-base.set",
        "position": [
          200,
          -60
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "11a8b9e9-a7ed-454a-9aef-a9137c0e17ea",
                "name": "company_name",
                "type": "string",
                "value": "Pollup Data Services"
              },
              {
                "id": "f2dcfe2e-3145-4a30-9731-0a8d02c7aa9a",
                "name": "sender_name",
                "type": "string",
                "value": "Thomas Vi√©"
              },
              {
                "id": "18b5c0bd-4e75-4b98-92fc-5fca90a8b680",
                "name": "sender_email",
                "type": "string",
                "value": "zeerobug@gmail.com"
              },
              {
                "id": "2c8de3ed-57dc-455b-bfa5-87a0d8d046d2",
                "name": "company_activity",
                "type": "string",
                "value": "Whether it‚Äôs automating recurring tasks, analysing data faster, or personalising customer interactions, we build bespoke AI agents to help your workforce work smarter."
              }
            ]
          }
        },
        "notesInFlow": true,
        "typeVersion": 3.4
      },
      {
        "id": "5260ec73-0733-47d1-af03-66ead128820e",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          160,
          -200
        ],
        "parameters": {
          "color": 4,
          "width": 400,
          "height": 320,
          "content": "## Set your data and your company's \nThe sender_email you set here has to be the same as the one you use in hubspot "
        },
        "typeVersion": 1
      },
      {
        "id": "78e301c7-3146-4bd9-9546-9f8c5b46cac7",
        "name": "If a contact is created",
        "type": "n8n-nodes-base.if",
        "position": [
          1080,
          -60
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "b70f4699-008f-4924-8e69-af4fa69422a5",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $('Webhook').item.json.body[0].subscriptionType }}",
                "rightValue": "contact.creation"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "b575fed7-da03-412d-aa00-fcf0edc85ae2",
        "name": "Get all info about the contact",
        "type": "n8n-nodes-base.hubspot",
        "position": [
          1300,
          -60
        ],
        "parameters": {
          "contactId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Webhook').item.json.body[0].objectId }}"
          },
          "operation": "get",
          "authentication": "oAuth2",
          "additionalFields": {}
        },
        "credentials": {
          "hubspotOAuth2Api": {
            "id": "qubiIFrowxvUdpu6",
            "name": "HubSpot account for node"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "956a02eb-970b-49bd-b1a5-3eebf7acb852",
        "name": "Write a personalized message",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1552,
          -60
        ],
        "parameters": {
          "text": "=Your task is to write a personalized Welcome email to a recipient.\nWrite also to indicate him that he will receive shortly an invitation for a meeting to resolve his doubts. Use for that the calendarAgent.\nUse the \"Sender's calendar ID\" as the Calendar. And the \"Recipient email\" as an attendee\n\n## Tools\n- calendarAgent: Use this tool to take action in calendar. Send it a query like \"Schedule a meeting with attendee 'Recipient email' on 'Sender's calendar ID' calendar.\"\n\n## Rules\n- Some actions require you to look up contact information first. For the following actions, you must get contact information and send that to the agent who needs it:\n- creating calendar event with attendee, create it as son as there is some free slot\n\nreturn the message as a json like this one:{\"subject\":\"Subject of the message\",\"body\":\"Body of the message\"}\n\n## Use the variables below\nSender's name:  {{ $('Enter your company data here').item.json.sender_name }}\nSender's email: {{ $('Enter your company data here').item.json.sender_email }}\nSender's company name: {{ $('Enter your company data here').item.json.company_name }}\nSender's company activity: {{ $('Enter your company data here').item.json.company_activity }}\nSender's calendar ID: zeerobug@gmail.com\nRecipient first name: {{ $json.properties.firstname.value }}\nRecipient last name: {{ $json.properties.lastname }}\nRecipient email: {{ $json.properties.email.value }}",
          "options": {
            "systemMessage": "=# Overview\nYou are a professional Customer Success Manager.\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "6d392f67-5940-43ed-ac8d-d27f8dab91ed",
        "name": "Send the message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2180,
          -60
        ],
        "webhookId": "d1d18d77-71ad-4eab-91c6-08b6a9f5d736",
        "parameters": {
          "sendTo": "={{ $('Get all info about the contact').item.json.properties.email.value }}",
          "message": "={{ $json.data }}",
          "options": {
            "bccList": "thomas@pollup.net"
          },
          "subject": "={{ $json.output.subject }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "DLjspol9TLgpGaXa",
            "name": "Gmail account 2"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "1928e760-4ca1-443c-9de0-211b3c3c88b8",
        "name": "Set owner to contact",
        "type": "n8n-nodes-base.hubspot",
        "position": [
          2400,
          -60
        ],
        "parameters": {
          "email": "={{ $('Get all info about the contact').item.json.properties.email.value }}",
          "options": {},
          "authentication": "oAuth2",
          "additionalFields": {
            "contactOwner": "={{ $('Get current owner').item.json.id }}"
          }
        },
        "credentials": {
          "hubspotOAuth2Api": {
            "id": "qubiIFrowxvUdpu6",
            "name": "HubSpot account for node"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "727e52cc-ba62-4f1e-b7b3-c8cd17ef1f42",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          160,
          220
        ],
        "parameters": {
          "color": 4,
          "width": 1080,
          "height": 560,
          "content": "## Calendar tool\nThis part has been borrowed from the excellent [Nate Herk](https://www.youtube.com/@nateherk) youtube channel"
        },
        "typeVersion": 1
      },
      {
        "id": "e605ec3f-ecbe-47c7-a46b-d20ded665c55",
        "name": "Transforms markdown to HTML",
        "type": "n8n-nodes-base.markdown",
        "position": [
          1960,
          -60
        ],
        "parameters": {
          "mode": "markdownToHtml",
          "options": {},
          "markdown": "={{ $json.output.body }}"
        },
        "typeVersion": 1
      },
      {
        "id": "ac43422a-3642-424c-a95a-902652705dbc",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1460,
          -220
        ],
        "parameters": {
          "color": 4,
          "width": 440,
          "height": 540,
          "content": "## Email writer\n- This agent writes a personalized Email\n- Uses the calendar Agent tool to create an appointmenton an empty slot.\nFeel free to personalize the prompt"
        },
        "typeVersion": 1
      },
      {
        "id": "c0e5511a-a84f-4603-9c23-3d5266f761c1",
        "name": "OpenAI Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          200,
          620
        ],
        "parameters": {
          "model": "gpt-4o",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "1IOLtYX7aTspCAN8",
            "name": "OpenAI Pollup"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c195ad96-7b04-4b01-a3a5-cb0df3c5cb26",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -880,
          260
        ],
        "parameters": {
          "width": 320,
          "height": 260,
          "content": "## Contact me\n- If you need any modification to this workflow\n- if you need some help with this workflow\n- Or if you need any workflow in n8n, Make, or Langchain / Langgraph\n\nWrite to me: [thomas@pollup.net](mailto:thomas@pollup.net)\n\n**Take a look at my others workflows [here](https://n8n.io/creators/zeerobug/)**\n\n"
        },
        "typeVersion": 1
      }
    ],
    "connections": {
      "Webhook": {
        "main": [
          [
            {
              "node": "Enter your company data here",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Events": {
        "ai_tool": [
          [
            {
              "node": "Calendar Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create Event": {
        "ai_tool": [
          [
            {
              "node": "Calendar Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Delete Event": {
        "ai_tool": [
          [
            {
              "node": "Calendar Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Model": {
        "ai_languageModel": [
          [
            {
              "node": "Calendar Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Update Event": {
        "ai_tool": [
          [
            {
              "node": "Calendar Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "calendarAgent": {
        "ai_tool": [
          [
            {
              "node": "Write a personalized message",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Calendar Agent": {
        "main": [
          [
            {
              "node": "Success",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Try Again",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HubSpot Trigger": {
        "main": [
          [
            {
              "node": "Enter your company data here",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send the message": {
        "main": [
          [
            {
              "node": "Set owner to contact",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out owners": {
        "main": [
          [
            {
              "node": "Get current owner",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get current owner": {
        "main": [
          [
            {
              "node": "If a contact is created",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get list of owners": {
        "main": [
          [
            {
              "node": "Split Out owners",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Write a personalized message",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "If a contact is created": {
        "main": [
          [
            {
              "node": "Get all info about the contact",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Write a personalized message",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Create Event with Attendee": {
        "ai_tool": [
          [
            {
              "node": "Calendar Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Transforms markdown to HTML": {
        "main": [
          [
            {
              "node": "Send the message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Enter your company data here": {
        "main": [
          [
            {
              "node": "Get list of owners",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Write a personalized message": {
        "main": [
          [
            {
              "node": "Transforms markdown to HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get all info about the contact": {
        "main": [
          [
            {
              "node": "Write a personalized message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "Calendar Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "TEMPLATE_WORKFLOW_ID",
    "meta": {
      "instanceId": "TEMPLATE_INSTANCE_ID",
      "templateCredsSetupCompleted": false
    },
    "name": "Newsletter",
    "tags": [],
    "nodes": [
      {
        "id": "88924d6c-0524-45c6-8982-b43bc79951c6",
        "name": "When clicking 'Test workflow'",
        "type": "n8n-nodes-base.manualTrigger",
        "notes": "üöÄ START HERE: Click to generate newsletters from pending topics in your Google Sheet",
        "position": [
          -40,
          -180
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "d386375c-ecac-4335-a29a-cd39d9233f07",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "notes": "‚è∞ AUTOMATED: Runs daily to send approved newsletters to clients. Configure timing in settings.",
        "position": [
          -40,
          230
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ca49af2b-0d7f-4aa1-b63c-dc828bfeb7d6",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "notes": "üîÑ BATCH PROCESSING: Handles multiple client emails efficiently. Prevents rate limiting and ensures reliable delivery.",
        "position": [
          840,
          230
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "2208eb0e-a0aa-4082-905b-166fa521b75a",
        "name": "Get topic from newsletter sheet",
        "type": "n8n-nodes-base.googleSheets",
        "notes": "üìä FETCH TOPICS: Gets all pending newsletter topics from your Google Sheet. Only processes items with 'Pending' status.",
        "position": [
          180,
          -180
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupValue": "Pending",
                "lookupColumn": "Status"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID_HERE/edit#gid=0",
            "cachedResultName": "Topic"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "YOUR_GOOGLE_SHEET_ID_HERE",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID_HERE/edit?usp=drivesdk",
            "cachedResultName": "Newsletter"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "GOOGLE_SHEETS_CREDENTIAL_ID",
            "name": "Google Sheets Account"
          }
        },
        "typeVersion": 4.5,
        "alwaysOutputData": true
      },
      {
        "id": "2b47d026-a70e-40d5-a2c4-4f07551f0eef",
        "name": "Validate Status as Pending",
        "type": "n8n-nodes-base.if",
        "notes": "‚úÖ DATE FILTER: Only processes newsletters scheduled for today. Prevents processing old or future-dated items.",
        "position": [
          400,
          -180
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "2d883784-6213-45b4-944f-55c0ffcc19b6",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.Date }}",
                "rightValue": "={{ new Date().toLocaleDateString('en-US') }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "448be138-181b-4bda-95dd-66d632635256",
        "name": "Create HTML for Newsletter",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "notes": "ü§ñ AI MAGIC: Uses GPT-4O to create professional HTML newsletter content. Customize the prompt here for different styles and tones.",
        "position": [
          620,
          -180
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Create an HTML newsletter on the topic:{{ $json.Topic }}. \n Include these hook sentences:{{ $json.hooks }} . \n Structure with a header, body paragraphs, and footer\n"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "OPENAI_CREDENTIAL_ID",
            "name": "OpenAI Account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "f552d84a-9d14-4cb1-89d7-d99bc9784a5e",
        "name": "Prepare Data to create word doc",
        "type": "n8n-nodes-base.code",
        "notes": "üîß FORMAT PREP: Converts AI-generated HTML into proper file format for Google Drive upload. Auto-generates timestamped filename.",
        "position": [
          996,
          -180
        ],
        "parameters": {
          "jsCode": "// Get HTML content from current input\nconst htmlContent = $input.first().json.message.content;\n\n// Generate filename with current date\nconst currentDate = new Date().toISOString().split('T')[0];\nconst filename = `document_${currentDate}.html`;\n\n// Convert string to binary buffer\nconst buffer = Buffer.from(htmlContent, 'utf8');\n\nreturn [{\n  json: {\n    fileName: filename,\n    mimeType: 'text/html'\n  },\n  binary: {\n    data: buffer\n  }\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "f2421bc4-2045-46c9-beab-ff5459b4a17c",
        "name": "Upload doc to google drive",
        "type": "n8n-nodes-base.googleDrive",
        "notes": "üíæ CLOUD STORAGE: Saves the newsletter to your Google Drive 'Newsletter' folder. Creates shareable link for easy access.",
        "position": [
          1216,
          -180
        ],
        "parameters": {
          "name": "=newsletter-{{ $('Get topic from newsletter sheet').item.json.Date }}.html",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive",
            "cachedResultUrl": "https://drive.google.com/drive/my-drive",
            "cachedResultName": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "YOUR_GOOGLE_DRIVE_FOLDER_ID",
            "cachedResultUrl": "https://drive.google.com/drive/folders/YOUR_GOOGLE_DRIVE_FOLDER_ID",
            "cachedResultName": "Newsletter"
          },
          "inputDataFieldName": "=data"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "GOOGLE_DRIVE_CREDENTIAL_ID",
            "name": "Google Drive Account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "6b39c176-25cf-4b47-a25c-8b886f0709ba",
        "name": "Send an email to admin",
        "type": "n8n-nodes-base.gmail",
        "notes": "üìß ADMIN ALERT: Notifies you when newsletter is ready for review. Update email address to yours. Includes Google Drive link.",
        "position": [
          1436,
          -180
        ],
        "webhookId": "WEBHOOK_ID_PLACEHOLDER",
        "parameters": {
          "sendTo": "admin@yourcompany.com",
          "message": "=Review the attached newsletter  {{ $json.webViewLink }}",
          "options": {},
          "subject": "=Newsletter Preview for {{ $('Get topic from newsletter sheet').item.json.Date }} and HTML body attached",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "GMAIL_ADMIN_CREDENTIAL_ID",
            "name": "Gmail Admin Account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "8e7c42de-3fd8-4acc-afdb-83491674bf7b",
        "name": "Update Status as Generated",
        "type": "n8n-nodes-base.googleSheets",
        "notes": "üìù TRACKING UPDATE: Marks newsletter as 'Generated' in Google Sheet. Adds timestamp and document URL for audit trail.",
        "position": [
          1656,
          -180
        ],
        "parameters": {
          "columns": {
            "value": {
              "Date": "={{ $('Get topic from newsletter sheet').item.json.Date }}",
              "Status": "Generated",
              "Timestamp": "={{ $('Upload doc to google drive').item.json.createdTime }}",
              "Document URL": "={{ $('Upload doc to google drive').item.json.webViewLink }}"
            },
            "schema": [
              {
                "id": "Date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Topic",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Topic",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "hooks",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "hooks",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Timestamp",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Timestamp",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Document URL",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Document URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Date"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID_HERE/edit#gid=0",
            "cachedResultName": "Topic"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "YOUR_GOOGLE_SHEET_ID_HERE",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID_HERE/edit?usp=drivesdk",
            "cachedResultName": "Newsletter"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "GOOGLE_SHEETS_CREDENTIAL_ID",
            "name": "Google Sheets Account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "0f6f5d15-dbd9-415b-923d-81809708542d",
        "name": "Validate Status as Approved",
        "type": "n8n-nodes-base.if",
        "notes": "‚úÖ APPROVAL CHECK: Only sends newsletters with 'Approved' status. Prevents accidental sending of unreviewed content.",
        "position": [
          400,
          230
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "b3730359-d11f-4a9c-aa5f-f4dcc1f0702e",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.Status }}",
                "rightValue": "Approved"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "f03eed28-1c06-401e-8c4b-ba5b5891b048",
        "name": "Pick records to send email to client",
        "type": "n8n-nodes-base.googleSheets",
        "notes": "üì¨ CLIENT QUEUE: Fetches all newsletter records ready for client delivery. Runs on schedule to automate sending.",
        "position": [
          180,
          230
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID_HERE/edit#gid=0",
            "cachedResultName": "Topic"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "YOUR_GOOGLE_SHEET_ID_HERE",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID_HERE/edit?usp=drivesdk",
            "cachedResultName": "Newsletter"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "GOOGLE_SHEETS_CREDENTIAL_ID",
            "name": "Google Sheets Account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "23ae0b93-f121-493b-a0d1-80fc748137a2",
        "name": "Get Client email address",
        "type": "n8n-nodes-base.googleSheets",
        "notes": "üë• CLIENT LOOKUP: Gets email addresses from the 'Email' sheet. Maintains separate client database for easy management.",
        "position": [
          620,
          230
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "YOUR_EMAIL_SHEET_GID",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID_HERE/edit#gid=YOUR_EMAIL_SHEET_GID",
            "cachedResultName": "Email"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "YOUR_GOOGLE_SHEET_ID_HERE",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID_HERE/edit?usp=drivesdk",
            "cachedResultName": "Newsletter"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "GOOGLE_SHEETS_CREDENTIAL_ID",
            "name": "Google Sheets Account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "4281a45c-5af5-4311-bca6-aaee14152afc",
        "name": "Send email to client",
        "type": "n8n-nodes-base.gmail",
        "notes": "üì§ CLIENT DELIVERY: Sends newsletter to individual clients via Gmail. Customize subject line and message template here.",
        "position": [
          1060,
          280
        ],
        "webhookId": "CLIENT_WEBHOOK_ID_PLACEHOLDER",
        "parameters": {
          "sendTo": "={{ $json.Email }}",
          "message": "=Attached is the newsletter  {{ $('Pick records to send email to client').item.json['Document URL'] }}",
          "options": {},
          "subject": "Newsletter",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "GMAIL_CLIENT_CREDENTIAL_ID",
            "name": "Gmail Client Account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "c2634a85-88f6-49b5-bd14-6e03336a49f2",
        "name": "Update status as Sent",
        "type": "n8n-nodes-base.googleSheets",
        "notes": "‚úÖ COMPLETION TRACKING: Marks newsletter as 'Sent' to prevent duplicate deliveries. Maintains complete audit trail.",
        "position": [
          1060,
          80
        ],
        "parameters": {
          "columns": {
            "value": {
              "Date": "={{ $('Pick records to send email to client').item.json.Date }}",
              "Status": "Sent"
            },
            "schema": [
              {
                "id": "Date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Topic",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Topic",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "hooks",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "hooks",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Timestamp",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Timestamp",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Document URL",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Document URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Date"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID_HERE/edit#gid=0",
            "cachedResultName": "Topic"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "YOUR_GOOGLE_SHEET_ID_HERE",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/YOUR_GOOGLE_SHEET_ID_HERE/edit?usp=drivesdk",
            "cachedResultName": "Newsletter"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "GOOGLE_SHEETS_CREDENTIAL_ID",
            "name": "Google Sheets Account"
          }
        },
        "typeVersion": 4.5
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "TEMPLATE_VERSION_ID",
    "connections": {
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Update status as Sent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send email to client",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Pick records to send email to client",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send email to client": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send an email to admin": {
        "main": [
          [
            {
              "node": "Update Status as Generated",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Client email address": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create HTML for Newsletter": {
        "main": [
          [
            {
              "node": "Prepare Data to create word doc",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload doc to google drive": {
        "main": [
          [
            {
              "node": "Send an email to admin",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Validate Status as Pending": {
        "main": [
          [
            {
              "node": "Create HTML for Newsletter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Validate Status as Approved": {
        "main": [
          [
            {
              "node": "Get Client email address",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking 'Test workflow'": {
        "main": [
          [
            {
              "node": "Get topic from newsletter sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get topic from newsletter sheet": {
        "main": [
          [
            {
              "node": "Validate Status as Pending",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Data to create word doc": {
        "main": [
          [
            {
              "node": "Upload doc to google drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pick records to send email to client": {
        "main": [
          [
            {
              "node": "Validate Status as Approved",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "C7wEtrTBgzELOlo8",
    "meta": {
      "instanceId": "c91c5b6efe2709e07c37996245857ac5d863d575d07e0072127351337c204c40",
      "templateCredsSetupCompleted": true
    },
    "name": "003-Auto Lead Follow Up and Qualification 2",
    "tags": [
      {
        "id": "2V3HXFbv2wqNGm6s",
        "name": "Dev",
        "createdAt": "2025-06-17T05:42:41.949Z",
        "updatedAt": "2025-06-17T05:42:41.949Z"
      }
    ],
    "nodes": [
      {
        "id": "48285051-bb2e-4e5a-97c0-674ba9b2369e",
        "name": "Send a message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          400,
          592
        ],
        "webhookId": "3e601c6c-72f9-4693-bb9b-30810f95f781",
        "parameters": {
          "sendTo": "={{ $('Loop Over Items').item.json.Email }}",
          "message": "={{ $('AI Agent').item.json.output.body }}\n{{ $json.trackingImage }}",
          "options": {
            "appendAttribution": false
          },
          "subject": "={{ $('AI Agent').item.json.output.subject }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "lKNxzCikIoCJesk8",
            "name": "Gmail account 10 - (DEV)"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "72e333c6-0dfb-41d1-934f-39d04036b8ba",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -176,
          592
        ],
        "parameters": {
          "text": "=You are an expert email copywriter for iTechNotion.  \nGenerate a warm, professional, and friendly cold outreach email subject and HTML body for a lead from our database.\n\nLead Data:  \n- Lead Number: {{ $json.Number }}  \n- Lead Name: {{ $json['Name '] }}  \n- Lead Email: {{ $json.Email }}\n\nRequirements:  \n1. Produce a concise email subject (5‚Äì8 words) that is professional and relevant (e.g., \"Quick Hello from iTechNotion Team\").  \n2. Produce the email body as clean HTML using only <p> and <br> tags.  \n3. Body must start with: <p>Hi {{ $json['Name '] }},</p>  \n4. Body should contain 3‚Äì4 short paragraphs with a warm, conversational, helpful, and non-pushy tone.  \n5. Use this opening line:  \n   \"I hope you're doing well. I'm reaching out from iTechNotion as we noticed you in our network and wanted to reconnect and understand how we can support your upcoming initiatives.\"  \n6. Briefly introduce our services in one sentence: AI Automation, mobile app development, web development, cloud solutions, and custom software development.  \n7. Emphasize that we‚Äôd love to understand their goals or challenges and explore whether our team can assist.  \n8. Invite them to share anything they‚Äôre currently working on or planning.  \n9. End with this signature in its own <p> tag:  \n   <p>Best regards,<br>iTechNotion Team</p>  \n10. DO NOT include <html>, <body>, <head>, or any CSS.  \n11. RETURN ONLY a single-line JSON object with exactly two keys: \"subject\" and \"body\".  \n12. The \"body\" value must be a single-line string containing the HTML (no newline characters, no \\n).  \n13. Do NOT output any explanation, notes, or formatting outside the one-line JSON.\n\nExample format (single line):  \n{\"subject\":\"<Subject here>\",\"body\":\"<p>Hi Name,</p><p>...</p><p>Best regards,<br>iTechNotion Team</p>\"}",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "e54d6c06-c209-4eb5-a781-968c798c65b6",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -208,
          768
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "N5q0rQ3pRpLiTkA9",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "2a54ff42-75d8-43ae-84f5-6a26a5a379b9",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          -16,
          768
        ],
        "parameters": {
          "jsonSchemaExample": "{\n\t\"subject\": \"\",\n\t\"body\": \"\"\n}"
        },
        "typeVersion": 1.3
      },
      {
        "id": "864c8f4c-03c8-4977-98de-aefadde6c3d7",
        "name": "Generates Tracking ID",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          176,
          592
        ],
        "parameters": {
          "url": "https://api.inboxpl.us/user-emails/n8n/tracking-id",
          "method": "POST",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "api_key",
                "value": ""
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "07ba0db0-7fc0-414f-98dc-517b03fdeaaa",
        "name": "Fetches Email Data",
        "type": "n8n-nodes-base.gmail",
        "position": [
          624,
          592
        ],
        "webhookId": "69e05d49-bd30-4770-bbd4-6fc57b0e878c",
        "parameters": {
          "messageId": "={{ $json.id }}",
          "operation": "get"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "lKNxzCikIoCJesk8",
            "name": "Gmail account 10 - (DEV)"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "9c988b5b-4738-417f-bf3f-825e201fee53",
        "name": "Starts Sequence",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          848,
          592
        ],
        "parameters": {
          "url": "https://api.inboxpl.us/user-emails/n8n",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "recipient_email",
                "value": "={{ $json.To }}"
              },
              {
                "name": "subject",
                "value": "={{ $json.Subject }}"
              },
              {
                "name": "threadId",
                "value": "={{ $json.threadId }}"
              },
              {
                "name": "message_id",
                "value": "={{ $json.id }}"
              },
              {
                "name": "sender_email",
                "value": "={{ $json.From }}"
              },
              {
                "name": "tracking_id",
                "value": "={{ $('Generates Tracking ID').item.json.trackingId }}"
              },
              {
                "name": "sequenceId",
                "value": "Your_Sequence_ID"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "api_key",
                "value": ""
              }
            ]
          }
        },
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "id": "2f5a0944-ca13-4f48-b12f-b64803bd65d2",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -880,
          320
        ],
        "parameters": {
          "color": 7,
          "width": 976,
          "height": 688,
          "content": "## Step 1: Get rows & Loop  \nReads rows with Status = \"Pending\" from Google Sheets and splits them into individual items to process one-by-one.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "fe760d82-411c-420f-8ff5-da37f280537a",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          112,
          320
        ],
        "parameters": {
          "color": 7,
          "width": 432,
          "height": 688,
          "content": "## Step 2: AI Email & Tracking ID  \nAI Agent (with OpenAI + parser) creates the subject and HTML body. A tracking ID is generated via InboxPlus and attached to the outgoing message.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "1a6f5342-a253-46ca-acc5-c0c05d1eb9fb",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          576,
          320
        ],
        "parameters": {
          "color": 7,
          "width": 656,
          "height": 688,
          "content": "## Step 3: Send, Fetch & Start Tracking  \nSends email with Gmail, fetches the sent message details, then calls InboxPlus to start the tracking sequence and updates the sheet row to \"Done\".\n"
        },
        "typeVersion": 1
      },
      {
        "id": "10b3ba26-0766-46ac-a435-40ff8d13e1c9",
        "name": "Append or update row in sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1072,
          720
        ],
        "parameters": {
          "columns": {
            "value": {
              "Email": "={{ $('Loop Over Items').item.json.Email }}",
              "Name ": "={{ $('Loop Over Items').item.json[\"Name \"] }}",
              "Number": "={{ $('Loop Over Items').item.json.Number }}",
              "Status": "Done",
              "Message": "={{ $('Loop Over Items').item.json.Message }}"
            },
            "schema": [
              {
                "id": "Name ",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Name ",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Number",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Message",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Message",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Email"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/16vN03K8d0zjNpmMORi26Bu_juodIDZdeujzVm0lvz0o/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "16vN03K8d0zjNpmMORi26Bu_juodIDZdeujzVm0lvz0o",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/16vN03K8d0zjNpmMORi26Bu_juodIDZdeujzVm0lvz0o/edit?usp=drivesdk",
            "cachedResultName": "Test Sheet Monday Workflow 2"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "wlOXumuB0DISq174",
            "name": "Google Sheets account - (DEV)"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "2b1ccf41-1faa-4468-9a53-da4d351553cc",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -848,
          720
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 13
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e6bc0e8e-8c29-4a46-9570-b3f71b875c2f",
        "name": "Get row(s) in sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -624,
          720
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupValue": "Pending",
                "lookupColumn": "Status"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/16vN03K8d0zjNpmMORi26Bu_juodIDZdeujzVm0lvz0o/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "16vN03K8d0zjNpmMORi26Bu_juodIDZdeujzVm0lvz0o",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/16vN03K8d0zjNpmMORi26Bu_juodIDZdeujzVm0lvz0o/edit?usp=drivesdk",
            "cachedResultName": "Test Sheet Monday Workflow 2"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "wlOXumuB0DISq174",
            "name": "Google Sheets account - (DEV)"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "fca10c07-0b47-40ea-95f9-150a3932b724",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -400,
          720
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "5d162142-cd21-4be5-8853-dc2e59904662",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1456,
          320
        ],
        "parameters": {
          "width": 496,
          "height": 688,
          "content": "## Automated Outreach & Email Tracking ‚Äì Overview  \nThis workflow runs daily and sends friendly outreach emails from your spreadsheet. It picks up rows marked \"Pending\", loops through each contact, uses an AI agent to generate a short subject and clean HTML email body, creates a tracking ID, and sends the email via Gmail. After sending, it fetches the sent message details and tells InboxPlus to start the tracking sequence. Finally, the workflow updates the sheet to mark the row as done.\n\n### How it works\n- Runs on schedule and reads pending rows  \n- Loops each contact and generates email via AI  \n- Creates tracking ID, sends email, fetches sent data  \n- Starts tracking sequence and updates the sheet\n\n### Setup steps\n1. Connect Google Sheets, OpenAI, Gmail, and InboxPlus API key  \n2. Set schedule time (currently 13:00)  \n3. Confirm sheet columns (Email, Name, Number, Message, Status)  \n4. Test with one sample row  \n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "9bc25fc8-9458-488a-87f6-1f09ee1e3522",
    "connections": {
      "AI Agent": {
        "main": [
          [
            {
              "node": "Generates Tracking ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send a message": {
        "main": [
          [
            {
              "node": "Fetches Email Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Starts Sequence": {
        "main": [
          [
            {
              "node": "Append or update row in sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Get row(s) in sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Fetches Email Data": {
        "main": [
          [
            {
              "node": "Starts Sequence",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s) in sheet": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generates Tracking ID": {
        "main": [
          [
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Append or update row in sheet": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "03S1S3TyPxOWpBmX",
    "meta": {
      "instanceId": "d058cd335f2a92e6c40ed7f2551d3dde8bba821896809f1798ecf75cecc233c7"
    },
    "name": "Send Personalized Speed-to-Lead Email to Inbound Form Submissions",
    "tags": [],
    "nodes": [
      {
        "id": "73f5219f-5a7d-41dd-8f85-ce0195beb1aa",
        "name": "Create a record",
        "type": "n8n-nodes-base.airtable",
        "position": [
          -496,
          1616
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "apptYepOjWlWnbFZc",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc",
            "cachedResultName": "Inbound Leads v2"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzqOUjbbvSQYy5v",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc/tblzqOUjbbvSQYy5v",
            "cachedResultName": "Inbound Leads"
          },
          "columns": {
            "value": {
              "Role": "={{ $('key value pair').item.json.role }}",
              "Email": "={{ $('key value pair').item.json.email }}",
              "Goals": "={{ $('key value pair').item.json.notes }}",
              "Website": "={{ $('key value pair').item.json.website }}",
              "Last Name": "={{ $('key value pair').item.json.lastName }}",
              "First Name": "={{ $('key value pair').item.json.firstName }}",
              "Company Name": "={{ $('key value pair').item.json.company }}"
            },
            "schema": [
              {
                "id": "Company Name",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Company Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "First Name",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "First Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Last Name",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Last Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Role",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Role",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Website",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Website",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Goals",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Goals",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Website summary",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Website summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Booked appointment?",
                "type": "boolean",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Booked appointment?",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Appointment date",
                "type": "dateTime",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Appointment date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Created",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Created",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Record ID",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Record ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "create"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "jx6qfipAAF44HzE4",
            "name": "Jordan"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "90a2fcba-68cd-4a82-8508-cca1e875aae5",
        "name": "Search records1",
        "type": "n8n-nodes-base.airtable",
        "position": [
          704,
          2144
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "apptYepOjWlWnbFZc",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc",
            "cachedResultName": "Inbound Leads v2"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzqOUjbbvSQYy5v",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc/tblzqOUjbbvSQYy5v",
            "cachedResultName": "Inbound Leads"
          },
          "options": {},
          "operation": "search",
          "filterByFormula": "=LOWER({Email}) = \"{{ $json.email.toLowerCase() }}\""
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "jx6qfipAAF44HzE4",
            "name": "Jordan"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "a1d9ebad-ad4d-46bc-85c7-aed0e57890ff",
        "name": "Update record",
        "type": "n8n-nodes-base.airtable",
        "position": [
          928,
          2144
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "apptYepOjWlWnbFZc",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc",
            "cachedResultName": "Inbound Leads v2"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzqOUjbbvSQYy5v",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc/tblzqOUjbbvSQYy5v",
            "cachedResultName": "Inbound Leads"
          },
          "columns": {
            "value": {
              "Record ID": "={{ $json['Record ID'] }}",
              "Appointment date": "={{ $('Extract Appointment Date').item.json.eventDateTime }}",
              "Booked appointment?": true
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "id",
                "defaultMatch": true
              },
              {
                "id": "Company Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Company Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "First Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "First Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Last Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Last Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Role",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Role",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Website",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Website",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Goals",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Goals",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Website summary",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Website summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Booked appointment?",
                "type": "boolean",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Booked appointment?",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Appointment date",
                "type": "dateTime",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Appointment date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Created",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Created",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Record ID",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "Record ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Record ID"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "jx6qfipAAF44HzE4",
            "name": "Jordan"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "780ca756-232f-47cc-b4f7-4450bd14061f",
        "name": "scrape website",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueErrorOutput",
        "position": [
          -304,
          1488
        ],
        "parameters": {
          "url": "=https://{{ $json.fields.Website }}",
          "options": {
            "redirect": {
              "redirect": {}
            }
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "User-Agent",
                "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36"
              },
              {
                "name": "Accept-Language ",
                "value": "en-US,en;q=0.9"
              },
              {
                "name": "Accept",
                "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
              },
              {
                "name": "Connection ",
                "value": "keep-alive"
              },
              {
                "name": "Upgrade-Insecure-Requests",
                "value": "1"
              },
              {
                "name": "Cache-Control",
                "value": "no-cache"
              },
              {
                "name": "Pragma",
                "value": "no-cache"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "9665fddb-34e7-4181-baf5-37c9c0efc2a0",
        "name": "Markdown",
        "type": "n8n-nodes-base.markdown",
        "position": [
          -64,
          1440
        ],
        "parameters": {
          "html": "={{ $json.data }}",
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "f07157c1-bf9b-4dba-b8e0-dea8381f3ec7",
        "name": "Markdown1",
        "type": "n8n-nodes-base.markdown",
        "onError": "continueRegularOutput",
        "position": [
          -48,
          1808
        ],
        "parameters": {
          "html": "={{ $json.data }}",
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "83228d54-f2bb-44a4-a5ad-d07edb3ebd6c",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          352,
          1616
        ],
        "parameters": {},
        "typeVersion": 3.2
      },
      {
        "id": "36709a4d-122d-4eba-9b9e-1298d8654be9",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          608,
          1616
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "data"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "090e9bfb-9a29-4550-84de-f49c9de44c19",
        "name": "Summarizer",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          832,
          1616
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "role": "system",
                "content": "=# Role\nYou are the worlds greatest summarizer and writer when it comes to taking in scraped website data and creating the best summary possible to let your boss know more about the new lead"
              },
              {
                "content": "=# Task\nExtract specific details from company data for personalized cold emails.\n\nCompany data: \n{{ $json.data }}\n\n\n# Find and include:\n- What they do (simple description)\n- EXACT NUMBERS (users, ratings, percentages, quantities)\n- CLIENT NAMES mentioned\n- SPECIFIC FEATURES with benefits\n- TESTIMONIALS with person titles\n- INTEGRATIONS mentioned\n- RATINGS/REVIEWS data\n\n# Format:\n\"[Company] does [what]. Key numbers: [specific metrics]. Notable clients: [names]. Standout features: [specific features with benefits]. Testimonials: [quote with title]. Integrations: [list]. Social proof: [ratings/reviews]. Best mentions: [list ALL specific things worth complimenting - client names, features, numbers, achievements, unique capabilities].\"\n\nOutput in \"summary\" field. Be specific - include all numbers, names, and quotes found.\n\n"
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "UhFPcA7H2OyI3afK",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "419189cf-15d7-4682-b7dc-7b1dd4bb5d08",
        "name": "Compose personalized email",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          1408,
          1616
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "responses": {
            "values": [
              {
                "role": "system",
                "content": "=You are {YOUR BUSINESS INFO NAME ETC..} Write a brief, professional but friendly email following this EXACT template structure:\n\nTEMPLATE TO FOLLOW: (include the ending)\nHey [firstName], \n\nI just got your inquiry that you filled out on our website. I see that you {the goal they put make sure it flows}. Make sure to grab a time on the calendar if you haven't already. I had a chance to check out [Company Name]. [specific compliment based on website summary]. Looking forward to jumping on a call together. If you have any questions prior to the call, email me back here or text me at {YOUR NUMBER}.\"\n\n{HOWEVER YOU WANT TO END THE EMAIL}\n\nYOUR TASK:\nFill in these variables based on the input data:\n1. [their stated goal/need] - What they wrote in the form about what they need help with\n2. [Company Name] - Their company name\n3. [specific compliment] - ONE specific thing you noticed from their website summary (keep it brief and genuine)\n\nRULES FOR THE COMPLIMENT:\n- Must be specific to their business (not generic)\n- Keep it to 1 sentence or phrase\n- Examples: \"really impressive scale with 5M emails daily\" or \"love the deliverability focus with your warmup pool\" or \"the AI optimization tools look solid\"\n- Make it natural and conversational\n- EVERYTHING NEEDS TO FLOW SMOOTHLY AND MAKE SENSE LIKE A HUMAN TYPED IT\n_ THE COMPLIMENT NEEDS TO FLOW WITH THE EMAIL AND SOUND NATURAL \n\nWRITING STYLE:\n- Professional but casual\n- Friendly and welcoming (not salesy)\n- Brief and to the point\n- Natural tone (like you quickly typed this between meetings)\n\nOUTPUT FORMAT:\nReturn ONLY the email body text following the template exactly. No greeting like \"Hi [Name]\" (we add that separately). No signature block. Just fill in the template and return it.\n\nINPUT DATA YOU'LL RECEIVE:\n- Website Summary: Details about their company, products, features\n- Goals/Notes: What they said they need help with\n\nEXAMPLE OUTPUT:\n\"Just got your inquiry for discussing automation options. Make sure to grab a time on the calendar if you haven't already. I had a chance to check out Instantly and really impressive that you're handling 5M emails daily with that deliverability network. Looking forward to jumping on a call. If you have any questions prior to the call, email me back here or text me at {YOUR NUMBER HERE}.\"\n\n\n\n"
              },
              {
                "content": "=WEBSITE SUMMARY:\n{{ $('Summarizer').item.json.message.content.summary }}\n\nLEAD'S STATED GOALS:\n{{ $('key value pair').item.json.notes }}\n\nLEADS INFO: {{ JSON.stringify($json.fields) }}\n\nWrite the speed-to-lead email based on this."
              }
            ]
          },
          "builtInTools": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "UhFPcA7H2OyI3afK",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "09d5a65f-8fab-430b-9fbc-54d5586261d3",
        "name": "send email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1760,
          1616
        ],
        "webhookId": "b0012428-c6c3-43c3-a2af-0189e559ad6e",
        "parameters": {
          "sendTo": "={{ $('key value pair').item.json.email }}",
          "message": "={{ $json.output[0].content[0].text }}",
          "options": {
            "appendAttribution": false
          },
          "subject": "=Hey {{ $('key value pair').item.json.firstName }} just got your inquiry!",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Gwl4RgznEY9AmC3g",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "d8be25f1-c5e8-482d-830c-ecb940ae4711",
        "name": " Add summary to airtable",
        "type": "n8n-nodes-base.airtable",
        "position": [
          1184,
          1616
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "apptYepOjWlWnbFZc",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc",
            "cachedResultName": "Inbound Leads v2"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzqOUjbbvSQYy5v",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc/tblzqOUjbbvSQYy5v",
            "cachedResultName": "Inbound Leads"
          },
          "columns": {
            "value": {
              "Record ID": "={{ $('Create a record').item.json.fields['Record ID'] }}",
              "Website summary": "={{ $json.message.content.summary }}"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "id",
                "defaultMatch": true
              },
              {
                "id": "Company Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Company Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "First Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "First Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Last Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Last Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Role",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Role",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Website",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Website",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Goals",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Goals",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Website summary",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Website summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Booked appointment?",
                "type": "boolean",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Booked appointment?",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Created",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Created",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Record ID",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "Record ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Record ID"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "jx6qfipAAF44HzE4",
            "name": "Jordan"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "a2f2faba-fdf3-4b65-9573-34099419a4d1",
        "name": " Clean markdown",
        "type": "n8n-nodes-base.code",
        "position": [
          144,
          1440
        ],
        "parameters": {
          "jsCode": "// Process all input items, not just the first one\nconst items = $input.all();\nconst results = [];\n\nitems.forEach((item, index) => {\n  const raw = item.json.data || \"\";\n  \n  // Define patterns to remove or clean\n  const cleaningPatterns = [\n    // Remove image markdown but preserve alt text for context\n    { pattern: /!\\[([^\\]]*)\\]\\([^)]*\\)/g, replacement: '$1' },\n    \n    // Remove URLs and links but preserve link text\n    { pattern: /\\[([^\\]]+)\\]\\([^)]*\\)/g, replacement: '$1' },\n    \n    // Remove standalone URLs\n    { pattern: /https?:\\/\\/[^\\s]+/g, replacement: '' },\n    \n    // Clean up markdown formatting characters\n    { pattern: /[#*_`>]+/g, replacement: '' },\n    \n    // Remove multiple dashes or underscores\n    { pattern: /[-_]{2,}/g, replacement: '' },\n    \n    // Remove email addresses\n    { pattern: /\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b/g, replacement: '' },\n    \n    // Clean up escaped characters\n    { pattern: /\\\\(.)/g, replacement: '$1' },\n    \n    // Remove excessive punctuation\n    { pattern: /[.,!?]{2,}/g, replacement: '.' }\n  ];\n\n  // Sections to completely remove (case-insensitive)\n  const sectionsToRemove = [\n    /toggle\\s+menu/gi,\n    /previous\\s+slide\\s*next/gi,\n    /log\\s+in/gi,\n    /sign\\s+up/gi,\n    /book\\s+a\\s+demo/gi,\n    /contact\\s+sales/gi,\n    /¬©.*202\\d/gi, // Copyright notices\n    /follow\\s+us/gi,\n    /social\\s+media/gi\n  ];\n\n  // Navigation and UI elements patterns\n  const uiPatterns = [\n    /^\\s*\\d+\\s*$/gm, // Standalone numbers (likely UI elements)\n    /^\\s*(docs|tickers|sources|think|send)\\s*$/gmi,\n    /^\\s*toggle\\s*$/gmi\n  ];\n\n  let cleaned = raw;\n\n  // Apply cleaning patterns\n  cleaningPatterns.forEach(({pattern, replacement}) => {\n    cleaned = cleaned.replace(pattern, replacement);\n  });\n\n  // Remove unwanted sections\n  sectionsToRemove.forEach(pattern => {\n    cleaned = cleaned.replace(pattern, '');\n  });\n\n  // Remove UI patterns\n  uiPatterns.forEach(pattern => {\n    cleaned = cleaned.replace(pattern, '');\n  });\n\n  // Normalize whitespace and structure\n  cleaned = cleaned\n    // Replace multiple spaces with single space\n    .replace(/[ \\t]+/g, ' ')\n    // Replace multiple newlines with double newline (paragraph breaks)\n    .replace(/\\n{3,}/g, '\\n\\n')\n    // Remove lines with only whitespace\n    .replace(/^\\s*$/gm, '')\n    // Remove leading/trailing whitespace from each line\n    .split('\\n').map(line => line.trim()).join('\\n')\n    // Remove empty lines at start and end\n    .replace(/^\\n+|\\n+$/g, '')\n    // Fix spacing around punctuation\n    .replace(/\\s+([.,!?])/g, '$1')\n    // Ensure space after punctuation\n    .replace(/([.,!?])([A-Za-z])/g, '$1 $2');\n\n  // Additional content-specific cleaning\n  cleaned = cleaned\n    // Remove redundant phrases\n    .replace(/see\\s+the\\s+benchmark‚Üí?/gi, '')\n    .replace(/see\\s+all\\s+benchmarks?‚Üí?/gi, '')\n    // Clean up percentage comparisons\n    .replace(/(\\w+)(\\d+%)/g, '$1 $2')\n    // Fix common spacing issues\n    .replace(/([a-z])([A-Z])/g, '$1 $2') // Add space between camelCase\n    .replace(/(\\w)(\\d)/g, '$1 $2') // Space between word and number\n    .replace(/(\\d)(\\w)/g, '$1 $2'); // Space between number and word\n\n  // Final cleanup - remove very short lines that are likely UI artifacts\n  const lines = cleaned.split('\\n').filter(line => {\n    const trimmed = line.trim();\n    // Keep lines that are either longer than 3 chars or contain meaningful content\n    return trimmed.length > 3 || /^[A-Z][A-Za-z\\s]+$/.test(trimmed);\n  });\n\n  cleaned = lines.join('\\n').trim();\n\n  // Add the processed item to results with proper n8n format\n  results.push({\n    json: {\n      ...item.json, // Preserve all original data\n      cleaned_markdown: cleaned,\n      original_length: raw.length,\n      cleaned_length: cleaned.length,\n      reduction_percent: Math.round((1 - cleaned.length / raw.length) * 100)\n    },\n    pairedItem: { item: index } // Maintain pairing\n  });\n});\n\n// Return all processed items\nreturn results;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "c55bc8b4-67f2-46d3-8f62-9ba225a8c72e",
        "name": " Clean markdown1",
        "type": "n8n-nodes-base.code",
        "position": [
          176,
          1808
        ],
        "parameters": {
          "jsCode": "// Process all input items, not just the first one\nconst items = $input.all();\nconst results = [];\n\nitems.forEach((item, index) => {\n  const raw = item.json.data || \"\";\n  \n  // Define patterns to remove or clean\n  const cleaningPatterns = [\n    // Remove image markdown but preserve alt text for context\n    { pattern: /!\\[([^\\]]*)\\]\\([^)]*\\)/g, replacement: '$1' },\n    \n    // Remove URLs and links but preserve link text\n    { pattern: /\\[([^\\]]+)\\]\\([^)]*\\)/g, replacement: '$1' },\n    \n    // Remove standalone URLs\n    { pattern: /https?:\\/\\/[^\\s]+/g, replacement: '' },\n    \n    // Clean up markdown formatting characters\n    { pattern: /[#*_`>]+/g, replacement: '' },\n    \n    // Remove multiple dashes or underscores\n    { pattern: /[-_]{2,}/g, replacement: '' },\n    \n    // Remove email addresses\n    { pattern: /\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b/g, replacement: '' },\n    \n    // Clean up escaped characters\n    { pattern: /\\\\(.)/g, replacement: '$1' },\n    \n    // Remove excessive punctuation\n    { pattern: /[.,!?]{2,}/g, replacement: '.' }\n  ];\n\n  // Sections to completely remove (case-insensitive)\n  const sectionsToRemove = [\n    /toggle\\s+menu/gi,\n    /previous\\s+slide\\s*next/gi,\n    /log\\s+in/gi,\n    /sign\\s+up/gi,\n    /book\\s+a\\s+demo/gi,\n    /contact\\s+sales/gi,\n    /¬©.*202\\d/gi, // Copyright notices\n    /follow\\s+us/gi,\n    /social\\s+media/gi\n  ];\n\n  // Navigation and UI elements patterns\n  const uiPatterns = [\n    /^\\s*\\d+\\s*$/gm, // Standalone numbers (likely UI elements)\n    /^\\s*(docs|tickers|sources|think|send)\\s*$/gmi,\n    /^\\s*toggle\\s*$/gmi\n  ];\n\n  let cleaned = raw;\n\n  // Apply cleaning patterns\n  cleaningPatterns.forEach(({pattern, replacement}) => {\n    cleaned = cleaned.replace(pattern, replacement);\n  });\n\n  // Remove unwanted sections\n  sectionsToRemove.forEach(pattern => {\n    cleaned = cleaned.replace(pattern, '');\n  });\n\n  // Remove UI patterns\n  uiPatterns.forEach(pattern => {\n    cleaned = cleaned.replace(pattern, '');\n  });\n\n  // Normalize whitespace and structure\n  cleaned = cleaned\n    // Replace multiple spaces with single space\n    .replace(/[ \\t]+/g, ' ')\n    // Replace multiple newlines with double newline (paragraph breaks)\n    .replace(/\\n{3,}/g, '\\n\\n')\n    // Remove lines with only whitespace\n    .replace(/^\\s*$/gm, '')\n    // Remove leading/trailing whitespace from each line\n    .split('\\n').map(line => line.trim()).join('\\n')\n    // Remove empty lines at start and end\n    .replace(/^\\n+|\\n+$/g, '')\n    // Fix spacing around punctuation\n    .replace(/\\s+([.,!?])/g, '$1')\n    // Ensure space after punctuation\n    .replace(/([.,!?])([A-Za-z])/g, '$1 $2');\n\n  // Additional content-specific cleaning\n  cleaned = cleaned\n    // Remove redundant phrases\n    .replace(/see\\s+the\\s+benchmark‚Üí?/gi, '')\n    .replace(/see\\s+all\\s+benchmarks?‚Üí?/gi, '')\n    // Clean up percentage comparisons\n    .replace(/(\\w+)(\\d+%)/g, '$1 $2')\n    // Fix common spacing issues\n    .replace(/([a-z])([A-Z])/g, '$1 $2') // Add space between camelCase\n    .replace(/(\\w)(\\d)/g, '$1 $2') // Space between word and number\n    .replace(/(\\d)(\\w)/g, '$1 $2'); // Space between number and word\n\n  // Final cleanup - remove very short lines that are likely UI artifacts\n  const lines = cleaned.split('\\n').filter(line => {\n    const trimmed = line.trim();\n    // Keep lines that are either longer than 3 chars or contain meaningful content\n    return trimmed.length > 3 || /^[A-Z][A-Za-z\\s]+$/.test(trimmed);\n  });\n\n  cleaned = lines.join('\\n').trim();\n\n  // Add the processed item to results with proper n8n format\n  results.push({\n    json: {\n      ...item.json, // Preserve all original data\n      cleaned_markdown: cleaned,\n      original_length: raw.length,\n      cleaned_length: cleaned.length,\n      reduction_percent: Math.round((1 - cleaned.length / raw.length) * 100)\n    },\n    pairedItem: { item: index } // Maintain pairing\n  });\n});\n\n// Return all processed items\nreturn results;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "8830237a-0713-401e-b207-479aebf1a2f7",
        "name": " Scrape website about page",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          -288,
          1792
        ],
        "parameters": {
          "url": "=https://{{ $json.fields.Website }}/about",
          "options": {
            "redirect": {
              "redirect": {}
            }
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "User-Agent",
                "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36"
              },
              {
                "name": "Accept-Language ",
                "value": "en-US,en;q=0.9"
              },
              {
                "name": "Accept",
                "value": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
              },
              {
                "name": "Connection ",
                "value": "keep-alive"
              },
              {
                "name": "Upgrade-Insecure-Requests",
                "value": "1"
              },
              {
                "name": "Cache-Control",
                "value": "no-cache"
              },
              {
                "name": "Pragma",
                "value": "no-cache"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f5004a49-6097-4df2-8f05-710928970409",
        "name": " If website errors ",
        "type": "n8n-nodes-base.airtable",
        "position": [
          -64,
          1600
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "apptYepOjWlWnbFZc",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc",
            "cachedResultName": "Inbound Leads v2"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzqOUjbbvSQYy5v",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc/tblzqOUjbbvSQYy5v",
            "cachedResultName": "Inbound Leads"
          },
          "columns": {
            "value": {
              "Record ID": "={{ $('Create a record').item.json.fields['Record ID'] }}",
              "Website summary": "invalid website"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "id",
                "defaultMatch": true
              },
              {
                "id": "Company Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Company Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "First Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "First Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Last Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Last Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Role",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Role",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Website",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Website",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Goals",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Goals",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Website summary",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Website summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Booked appointment?",
                "type": "boolean",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Booked appointment?",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Appointment date",
                "type": "dateTime",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Appointment date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Created",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Created",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Record ID",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "Record ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Record ID"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "jx6qfipAAF44HzE4",
            "name": "Jordan"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "fb32438a-5dc2-477d-8d88-487d0dd78307",
        "name": "have they filled a form already?",
        "type": "n8n-nodes-base.switch",
        "position": [
          -720,
          1360
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "9c142b74-ee4f-4ee8-814c-3c0a3ecec3d1",
                      "operator": {
                        "type": "string",
                        "operation": "exists",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.Email }}",
                      "rightValue": ""
                    }
                  ]
                }
              },
              {
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "2c800987-acbf-4ce8-bf9d-4e8d43c187cd",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "",
                      "rightValue": ""
                    }
                  ]
                }
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.3
      },
      {
        "id": "bb5e5203-56a4-4567-9fc5-1d11cff58f28",
        "name": "Send a message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          -480,
          1168
        ],
        "webhookId": "63f31146-0115-4ecc-b36f-382d5d682b05",
        "parameters": {
          "sendTo": "={{ $json.Email }}",
          "message": "=Hey {{ $json['First Name'] }},\n\nI just got your inquiry but remembered that previously on {{ DateTime.fromISO($json.Created).toFormat('yyyy-MM-dd') }} you had already filled out a form where you said \"{{ $json.Goals }}\" looking forward to jumping on a call, go ahead and grab a time on my calendar if you haven't already. Also if you have any questions feel free to email me back here!\n\nJordan Austin | Founder | ZangFlow",
          "options": {
            "appendAttribution": false
          },
          "subject": "=Hey {{ $json['First Name'] }} just got your inquiry",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Gwl4RgznEY9AmC3g",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "fefa2885-56cb-47ec-a7be-2dff3fe48eaa",
        "name": "Send appointment confirmed",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1168,
          2144
        ],
        "webhookId": "9d040a94-f9f6-4768-899c-a046f09cfa9a",
        "parameters": {
          "sendTo": "={{ $json.fields.Email }}",
          "message": "=Hey {{ $json.fields[\"First Name\"] }},\n\nI just got your booking on: {{ DateTime.fromISO($json.fields[\"Appointment date\"]).toFormat('MMMM dd, yyyy \\'at\\' h:mm a ZZZZ') }} really looking forward to our call! If you have any questions prior or anything changes just shoot me a message back here!\n\nJordan Austin | Founder | ZangFlow",
          "options": {
            "appendAttribution": false
          },
          "subject": "=Confirmed appointment",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Gwl4RgznEY9AmC3g",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "18256748-8f51-4cc4-aa81-718618aeec91",
        "name": "Send a message2",
        "type": "n8n-nodes-base.gmail",
        "position": [
          112,
          1600
        ],
        "webhookId": "33c5c810-3387-4cc7-b3c6-537e2ed677e9",
        "parameters": {
          "sendTo": "={{ $('key value pair').item.json.email }}",
          "message": "=Hey {{ $json['First Name'] }},\n\nI just got your inquiry from you form you had just filled out on our website. Looking forward to jumping on a call, go ahead and grab a time on my calendar if you haven't already. Also if you have any questions feel free to email me back here!\n\nJordan Austin | Founder | ZangFlow",
          "options": {
            "appendAttribution": false
          },
          "subject": "=Hey {{ $json['First Name'] }} just got your inquiry",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Gwl4RgznEY9AmC3g",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "6a691f3c-5e28-4ef6-86ad-243e1f337079",
        "name": " Covert time to ISO",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          128,
          2144
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini",
            "cachedResultName": "GPT-4.1-MINI"
          },
          "options": {},
          "responses": {
            "values": [
              {
                "content": "=# Task\n\nextract the email and Extract the event date/time and format it as ISO 8601. from the snippet:\n{{ $json.snippet }}\n\n\nouput in 2 sepreate keys \n\nemail \n\neventDateTime\n\n\n\n\n\n\n"
              }
            ]
          },
          "builtInTools": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "UhFPcA7H2OyI3afK",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "b00cb6f4-9e2b-402e-830a-31a17601a489",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1680,
          1264
        ],
        "parameters": {
          "color": 7,
          "width": 704,
          "height": 288,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "b7174738-4c51-49fb-be56-fcce158d01b2",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1664,
          1280
        ],
        "parameters": {
          "width": 672,
          "height": 256,
          "content": "## Potential client fills out form on website\n"
        },
        "typeVersion": 1
      },
      {
        "id": "6da18454-f875-478f-9304-33119ef07295",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -976,
          1264
        ],
        "parameters": {
          "color": 7,
          "width": 416,
          "height": 288,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "2437fca2-5443-45b1-93b7-65c052cf4530",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -960,
          1280
        ],
        "parameters": {
          "color": 2,
          "width": 384,
          "height": 256,
          "content": "## Check if this person has filled out a form before "
        },
        "typeVersion": 1
      },
      {
        "id": "0848618b-1e86-4b70-bab6-b5679f51f224",
        "name": "Check to see if record exist already",
        "type": "n8n-nodes-base.airtable",
        "position": [
          -928,
          1360
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "apptYepOjWlWnbFZc",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc",
            "cachedResultName": "Inbound Leads v2"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzqOUjbbvSQYy5v",
            "cachedResultUrl": "https://airtable.com/apptYepOjWlWnbFZc/tblzqOUjbbvSQYy5v",
            "cachedResultName": "Inbound Leads"
          },
          "options": {},
          "operation": "search",
          "filterByFormula": "=OR(   LOWER({Email}) = \"{{ $json.email.toLowerCase() }}\",   LOWER({Company Name}) = \"{{ $json.company.toLowerCase() }}\" )"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "jx6qfipAAF44HzE4",
            "name": "Jordan"
          }
        },
        "typeVersion": 2.1,
        "alwaysOutputData": true
      },
      {
        "id": "1c8d4b97-e513-4182-9680-8785c10f58fb",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -560,
          1056
        ],
        "parameters": {
          "color": 7,
          "width": 512,
          "height": 320,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "3f926cb1-0a79-4d05-b10f-ea4125d488b0",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -544,
          1072
        ],
        "parameters": {
          "color": 3,
          "width": 480,
          "height": 288,
          "content": "## Send Already inquired email and notify team"
        },
        "typeVersion": 1
      },
      {
        "id": "d9529f4b-1208-4c16-b8e7-067dc11ffe48",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -560,
          1376
        ],
        "parameters": {
          "color": 7,
          "width": 1072,
          "height": 608,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "f8391a4e-8e8d-49a3-bd4b-a322fa9be58d",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -544,
          1392
        ],
        "parameters": {
          "color": 4,
          "width": 1040,
          "height": 576,
          "content": "## If new lead scrape website home page and about page if the about page exist \n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "01e99cc5-77da-427d-8948-a0830f166b1f",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          512,
          1376
        ],
        "parameters": {
          "color": 7,
          "width": 832,
          "height": 608,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "eb89cae7-8dbb-459c-8926-ce33ec96eb6f",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          528,
          1392
        ],
        "parameters": {
          "color": 5,
          "width": 800,
          "height": 576,
          "content": "## Summarize website data add summary to CRM \n### Feed in markdown form the website into an llm that summarizes the info"
        },
        "typeVersion": 1
      },
      {
        "id": "8bc20b69-645f-4a12-9757-d292cf2050a5",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1360,
          1392
        ],
        "parameters": {
          "color": 6,
          "width": 592,
          "height": 576,
          "content": "## Use website summary to draft and send personalized email "
        },
        "typeVersion": 1
      },
      {
        "id": "64793afe-166e-4914-b691-d87b681ed07d",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1344,
          1376
        ],
        "parameters": {
          "color": 7,
          "width": 624,
          "height": 608,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "a14b447b-33bd-4268-a24c-3751693c6508",
        "name": "Email from calendly?",
        "type": "n8n-nodes-base.switch",
        "position": [
          -304,
          2144
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "d645970e-3407-41a5-9a36-3b2a061ec6f7",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.From }}",
                      "rightValue": "Calendly <notifications@calendly.com>"
                    }
                  ]
                }
              },
              {
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "e8d9d2ee-b2ed-41af-b43c-47de151a261e",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "",
                      "rightValue": ""
                    }
                  ]
                }
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.3
      },
      {
        "id": "ab2adafa-cba9-4839-852a-4d2a59b8cfdd",
        "name": "Booking email?",
        "type": "n8n-nodes-base.switch",
        "position": [
          -96,
          2144
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "9b70e49e-f5df-4fa9-95d4-af265597d023",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $json.Subject }}",
                      "rightValue": "New Event"
                    }
                  ]
                }
              },
              {
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "25d4840c-7ed8-4e7c-9a6f-f28b3c39c5f7",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "",
                      "rightValue": ""
                    }
                  ]
                }
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.3
      },
      {
        "id": "c2763a75-ab3c-4b14-8f5b-ba5b1a7db6ef",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -560,
          1984
        ],
        "parameters": {
          "color": 7,
          "width": 656,
          "height": 416,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "f4e1b775-5901-4e2c-95b7-7e846b70c77b",
        "name": "Watch for booking email",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          -496,
          2144
        ],
        "parameters": {
          "filters": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Gwl4RgznEY9AmC3g",
            "name": "Gmail account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "df769c1f-9c9a-4652-b1c1-6ff5f7d98414",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -544,
          2000
        ],
        "parameters": {
          "width": 624,
          "height": 384,
          "content": "## Watch inbox for calendly booking email"
        },
        "typeVersion": 1
      },
      {
        "id": "65eb81ca-78c1-4c8b-a053-cb800b888ca9",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          96,
          1984
        ],
        "parameters": {
          "color": 7,
          "width": 560,
          "height": 416,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "2cf4c422-6333-43d8-b7a3-e5c5b52edeff",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          112,
          2000
        ],
        "parameters": {
          "color": 3,
          "width": 528,
          "height": 384,
          "content": "## Extract appointment data and time "
        },
        "typeVersion": 1
      },
      {
        "id": "10cf70f3-0049-4795-b13f-d7279a243045",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          672,
          2000
        ],
        "parameters": {
          "color": 4,
          "width": 400,
          "height": 384,
          "content": "## Add appointment time to CRM record "
        },
        "typeVersion": 1
      },
      {
        "id": "70082738-1014-4c1a-aedb-f00a514c93d7",
        "name": "Sticky Note17",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          656,
          1984
        ],
        "parameters": {
          "color": 7,
          "width": 720,
          "height": 416,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "7eeda6d1-d823-4bb4-b353-03099343d382",
        "name": "Sticky Note18",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1088,
          2000
        ],
        "parameters": {
          "color": 5,
          "width": 272,
          "height": 384,
          "content": "## Send email telling inquiry we got the booked appointment "
        },
        "typeVersion": 1
      },
      {
        "id": "6f0f1959-4a60-4d28-8604-b69373800bc2",
        "name": "Sticky Note21",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "width": 2384,
          "height": 1344,
          "content": "@[Youtube](2ZU_2zSO27w)"
        },
        "typeVersion": 1
      },
      {
        "id": "59500447-d838-499b-a279-8e9486fae371",
        "name": "Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -1616,
          1360
        ],
        "webhookId": "bcc30636-4ea2-4f2f-9ccf-ea0b7e81cfc0",
        "parameters": {
          "path": "bcc30636-4ea2-4f2f-9ccf-ea0b7e81cfc0",
          "options": {}
        },
        "typeVersion": 2.1
      },
      {
        "id": "a25d15fb-43f9-40ea-8e8d-bfafc091f87b",
        "name": "Sticky Note22",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1456,
          1552
        ],
        "parameters": {
          "width": 896,
          "height": 1488,
          "content": "# Send Personalized Speed-to-Lead Email to Inbound Form Submissions\n## By: [Jordan Austin](https://www.skool.com/ai-growth-lab-4394/about?ref=5065ab28874b4325b44ef3ead8105722)\n## System overview\n### - This system captures every lead that fills out a form on your website. When a form is submitted, the workflow checks if the lead already exists in your database. If they do, the system sends an email letting them know you already received their previous inquiry. If the lead is brand new, the system pulls their website URL, scrapes the site, summarizes the key information, and uses that summary to generate a personalized follow up email that feels human. After the follow up email is sent, the system waits to see if the person books a call through your embedded calendar. When a booking comes in, the workflow sends a clean confirmation email so the lead knows everything is locked in. The goal of this system is to respond to 100 percent of leads instantly, remove manual follow up, and prevent missed opportunities.\n\n## Who's it for\n\nThis template is essential for any business relying on **inbound lead forms** (e.g., from a website, Typeform, or dedicated CRM forms) that wants to instantly impress new prospects. It is perfect for high-velocity sales teams, founders, and consultants who need to reduce the critical \"speed to lead\" time from hours to mere seconds by automating a highly personalized first contact.\n\n## How it works\n\nThis workflow is triggered instantly by a form submission (Webhook) and executes a multi-step personalization process in under a minute:\n1. **Intake and Logging:** It immediately logs the new lead's details (name, company, goals) into an Airtable CRM and checks for duplicate records.\n2. **Website Insight:** It scrapes the lead's provided website URL to gather comprehensive company information. The HTML content is cleaned up using custom JavaScript to remove all noise (navigation, footers, scripts, etc.).\n3. **AI Personalization:** The cleaned data is fed to **GPT-4o** which analyzes the content, summarizing key numbers, features, and achievements.\n4. **Instant Follow-up:** This summary, combined with the lead's stated goals, is used by the AI to compose a unique, human-sounding, and highly specific follow-up email.\n5. **CRM Update:** The personalized email is sent via Gmail, and the full website summary is logged back into the Airtable record for sales team review.\n6. **Appointment Tracking:** A separate, connected branch monitors your inbox for Calendly booking confirmations and automatically updates the lead‚Äôs Airtable record with the confirmed appointment date and time.\n\n## How to set up\n\n1. **Airtable:** Create the necessary base and table structure for inbound leads. **CRITICAL:** You must replace the hardcoded Base and Table IDs with your own unique IDs in all Airtable nodes.\n2. **Webhook & Form Setup:**\n    * **This template was originally designed and tested using a form built with [Lovable](https://lovable.dev/).** The process was simple: the n8n Webhook URL was pasted directly into the form‚Äôs submission endpoint in Lovable.\n    * **Special Note:** If you are using a different website builder or form tool (e.g., WordPress, Webflow, custom HTML), the setup for connecting the form data to the n8n Webhook might require custom code or an intermediate tool (like Zapier or Make) to correctly format the data into a single JSON object.\n3. **AI Personalization:** In the **Compose personalized email** node, replace the hardcoded placeholders for the signature/closing (e.g., `{YOUR NUMBER}`, `{HOWEVER YOU WANT TO END THE EMAIL}`) with generic instructions for the user.\n4. **Security Check:** Ensure all personal identifiers like Google Sheets IDs, real email addresses, and your personal signature are replaced with generic placeholders.\n\n## Apis needed\n### - [Airtable](https://docs.n8n.io/integrations/builtin/credentials/airtable/?utm_source=n8n_app&utm_medium=credential_settings&utm_campaign=create_new_credentials_modal)\n### - [OpenAI](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-langchain.openai/?utm_source=n8n_app&utm_medium=node_settings_modal-credential_link&utm_campaign=%40n8n%2Fn8n-nodes-langchain.openAi)\n### - [WATCH THIS TO LEARN HOW TO SET UP ALL GOOGLE APIS](https://youtube.com/shorts/FBRQNmCN0F8?feature=share)\n\n## Airtable Base\n## [Link to the Airtable base](https://airtable.com/appdQOiJbMCveHwt4/shrQr4RjDfw1e2Tn3)"
        },
        "typeVersion": 1
      },
      {
        "id": "a99bd418-9a7a-441b-8def-256c2c66c07f",
        "name": "This is whatever you use to notify your team",
        "type": "n8n-nodes-base.noOp",
        "position": [
          -272,
          1168
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "71541645-4f11-4b44-8f2f-20458a9f9c15",
        "name": "Extract Appointment Date",
        "type": "n8n-nodes-base.code",
        "position": [
          480,
          2144
        ],
        "parameters": {
          "jsCode": "// The input is an array, so access the first item\nconst data = $input.all()[0].json;\n\n// Now navigate to the text\nconst responseText = data.output[0].content[0].text;\n\n// Remove markdown code blocks if present\nlet jsonStr = responseText;\nif (responseText.includes('```json')) {\n  jsonStr = responseText.split('```json')[1].split('```')[0];\n}\n\n// Clean and parse\njsonStr = jsonStr.trim();\nconst parsed = JSON.parse(jsonStr);\n\nreturn {\n  json: {\n    email: parsed.email,\n    eventDateTime: parsed.event_date_time || parsed.eventDateTime || parsed.event_datetime\n  }\n};"
        },
        "typeVersion": 2
      },
      {
        "id": "d8942e73-e213-43a5-83e0-b964c9df1b27",
        "name": "Parse Webhook Data",
        "type": "n8n-nodes-base.set",
        "position": [
          -1376,
          1360
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "cac06c8e-8007-4f2e-8054-db7c34633f7a",
                "name": "body",
                "type": "string",
                "value": "={{ $json.body }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "b3eea68d-3b32-48d2-b4ae-594729e86db3",
        "name": "key value pair",
        "type": "n8n-nodes-base.code",
        "position": [
          -1152,
          1360
        ],
        "parameters": {
          "jsCode": "// Robust parser for weirdly-wrapped payloads in n8n\nfunction toObject(input) {\n  if (input == null) return null;\n\n  // If it's a string, try to JSON.parse it, and recurse\n  if (typeof input === 'string') {\n    try {\n      const parsed = JSON.parse(input);\n      return toObject(parsed);\n    } catch {\n      return null; // string but not JSON\n    }\n  }\n\n  // If it's an array, take the first element and recurse\n  if (Array.isArray(input)) {\n    if (input.length === 0) return null;\n    return toObject(input[0]);\n  }\n\n  // If it's already an object, we're done\n  if (typeof input === 'object') {\n    return input;\n  }\n\n  return null;\n}\n\n// Try common locations\nconst raw =\n  $json.body ??\n  $json.payload ??\n  $json.data ??\n  $json.requestBody ??\n  $json; // last resort\n\nconst obj = toObject(raw);\n\nif (!obj || typeof obj !== 'object') {\n  throw new Error(\n    'Could not parse payload into an object. Saw: ' +\n    JSON.stringify(raw)?.slice(0, 250)\n  );\n}\n\nreturn [{ json: obj }];\n\n\n"
        },
        "typeVersion": 2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "aa82a7b2-c509-4e35-a1ea-c78f96ef171d",
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook": {
        "main": [
          [
            {
              "node": "Parse Webhook Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Markdown": {
        "main": [
          [
            {
              "node": " Clean markdown",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Summarizer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Markdown1": {
        "main": [
          [
            {
              "node": " Clean markdown1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Summarizer": {
        "main": [
          [
            {
              "node": " Add summary to airtable",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update record": {
        "main": [
          [
            {
              "node": "Send appointment confirmed",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Booking email?": {
        "main": [
          [
            {
              "node": " Covert time to ISO",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send a message": {
        "main": [
          [
            {
              "node": "This is whatever you use to notify your team",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "key value pair": {
        "main": [
          [
            {
              "node": "Check to see if record exist already",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "scrape website": {
        "main": [
          [
            {
              "node": "Markdown",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": " If website errors ",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Clean markdown": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create a record": {
        "main": [
          [
            {
              "node": "scrape website",
              "type": "main",
              "index": 0
            },
            {
              "node": " Scrape website about page",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search records1": {
        "main": [
          [
            {
              "node": "Update record",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Clean markdown1": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Parse Webhook Data": {
        "main": [
          [
            {
              "node": "key value pair",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Covert time to ISO": {
        "main": [
          [
            {
              "node": "Extract Appointment Date",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " If website errors ": {
        "main": [
          [
            {
              "node": "Send a message2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Email from calendly?": {
        "main": [
          [
            {
              "node": "Booking email?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Watch for booking email": {
        "main": [
          [
            {
              "node": "Email from calendly?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Add summary to airtable": {
        "main": [
          [
            {
              "node": "Compose personalized email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Appointment Date": {
        "main": [
          [
            {
              "node": "Search records1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Scrape website about page": {
        "main": [
          [
            {
              "node": "Markdown1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Compose personalized email": {
        "main": [
          [
            {
              "node": "send email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "have they filled a form already?": {
        "main": [
          [
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Create a record",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check to see if record exist already": {
        "main": [
          [
            {
              "node": "have they filled a form already?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "gP9EsxKN5agUGzDS",
    "meta": {
      "instanceId": "73d9d5380db181d01f4e26492c771d4cb5c4d6d109f18e2621cf49cac4c50763",
      "templateCredsSetupCompleted": true
    },
    "name": "Automate Pinterest Analysis & AI-Powered Content Suggestions With Pinterest API",
    "tags": [],
    "nodes": [
      {
        "id": "7f582bb4-97cd-458e-a7b7-b518c5b8a4ca",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          540,
          -260
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "95QGJD3XSz0piaNU",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c6772882-468c-4391-a259-93e52daf49d4",
        "name": "Airtable2",
        "type": "n8n-nodes-base.airtableTool",
        "position": [
          700,
          -260
        ],
        "parameters": {
          "id": "=",
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appfsNi1QEhw6WvXK",
            "cachedResultUrl": "https://airtable.com/appfsNi1QEhw6WvXK",
            "cachedResultName": "Pinterest_Metrics"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tbl9Dxdrwx5QZGFnp",
            "cachedResultUrl": "https://airtable.com/appfsNi1QEhw6WvXK/tbl9Dxdrwx5QZGFnp",
            "cachedResultName": "Pinterest_Organic_Data"
          },
          "options": {}
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "0ApVmNsLu7aFzQD6",
            "name": "Airtable Personal Access Token account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "85ea8bec-14c8-4277-b2e3-eb145db0713a",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          920,
          -280
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "95QGJD3XSz0piaNU",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "b8f7d0d6-b58f-4a41-a15d-99f4d838bb8c",
        "name": "8:00am Morning Scheduled Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -660,
          -140
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "daysInterval": 7,
                "triggerAtHour": 8
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "593a320d-825e-42f9-8ab6-adafd5288fa5",
        "name": "Pull List of Pinterest Pins From Account",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -340,
          -140
        ],
        "parameters": {
          "url": "https://api.pinterest.com/v5/pins",
          "options": {
            "redirect": {
              "redirect": {}
            }
          },
          "sendBody": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {}
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer YOUR_TOKEN_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "1e6d00fe-2b32-4d46-a230-063254ebab74",
        "name": "Update Data Field To Include Organic",
        "type": "n8n-nodes-base.code",
        "position": [
          -20,
          -140
        ],
        "parameters": {
          "jsCode": "// Initialize an array to hold the output formatted for Airtable\nconst outputItems = [];\n\nfor (const item of $input.all()) {\n  if (item.json.items && Array.isArray(item.json.items)) {\n    for (const subItem of item.json.items) {\n      // Construct an object with only the required fields for Airtable\n      outputItems.push({\n        id: subItem.id || null,\n        created_at: subItem.created_at || null,\n        title: subItem.title || null,\n        description: subItem.description || null,\n        link: subItem.link || null,\n        type: \"Organic\" // Assign the value \"Organic\" to the 'Type' field\n      });\n    }\n  }\n}\n\n// Return the structured output\nreturn outputItems;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "539de144-dc67-4b14-b58e-2896edb1c3e6",
        "name": "Create Record Within Pinterest Data Table",
        "type": "n8n-nodes-base.airtable",
        "position": [
          260,
          -140
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appfsNi1QEhw6WvXK",
            "cachedResultUrl": "https://airtable.com/appfsNi1QEhw6WvXK",
            "cachedResultName": "Pinterest_Metrics"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tbl9Dxdrwx5QZGFnp",
            "cachedResultUrl": "https://airtable.com/appfsNi1QEhw6WvXK/tbl9Dxdrwx5QZGFnp",
            "cachedResultName": "Pinterest_Organic_Data"
          },
          "columns": {
            "value": {
              "link": "={{ $json.link }}",
              "type": "={{ $json.type }}",
              "title": "={{ $json.title }}",
              "pin_id": "={{ $json.id }}",
              "created_at": "={{ $json.created_at }}",
              "description": "={{ $json.description }}"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "id",
                "defaultMatch": true
              },
              {
                "id": "pin_id",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "pin_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "created_at",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "created_at",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "description",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "link",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "link",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "type",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "active7DayUsers",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "active7DayUsers",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "sessions",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "sessions",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "userEngagementDuration",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "userEngagementDuration",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "upsert"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "0ApVmNsLu7aFzQD6",
            "name": "Airtable Personal Access Token account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "250f5121-437e-4bff-82af-95a156126127",
        "name": "Pinterest Analysis AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          540,
          -440
        ],
        "parameters": {
          "text": "You are a data analysis expert. You will pull data from the table and provide any information in regards to trends in the data. \n\nYour output should be suggestions of new pins that we can post to reach the target audiences. \n\nAnalyze the data and just summary of the pin suggestions that the team should build. ",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "181e9d89-c0f9-4de2-bdce-9359b967157c",
        "name": "Pinterest Data Analysis Summary LLM",
        "type": "@n8n/n8n-nodes-langchain.chainSummarization",
        "position": [
          900,
          -440
        ],
        "parameters": {
          "options": {
            "summarizationMethodAndPrompts": {
              "values": {
                "prompt": "=Write a concise summary of the following:\n\n\n\"{{ $json.output }}\"\n\n\nCONCISE SUMMARY:"
              }
            }
          }
        },
        "typeVersion": 2
      },
      {
        "id": "432e7bd7-36b4-4903-8e93-c8bd6e140a04",
        "name": "Send Marketing Trends & Pinterest Analysis To Marketing Manager",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1220,
          -440
        ],
        "webhookId": "f149c1b5-c028-4dff-9d22-a72951f2ef91",
        "parameters": {
          "sendTo": "john.n.foster1@gmail.com",
          "message": "={{ $json.response.text }}",
          "options": {},
          "subject": "Pinterest Trends & Suggestions"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "pIXP1ZseBP4Z5CCp",
            "name": "Gmail account"
          }
        },
        "executeOnce": true,
        "typeVersion": 2.1
      },
      {
        "id": "dadfb22a-b1d3-459d-a332-5a2c52fd4ca0",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -740,
          -320
        ],
        "parameters": {
          "color": 5,
          "width": 280,
          "height": 440,
          "content": "Scheduled trigger at 8:00am to start the workflow. \n\nThis can be updated to your schedule preference as an email with marketing trends can be sent to best fit one's schedule. "
        },
        "typeVersion": 1
      },
      {
        "id": "3b156d97-11bf-4d8a-9bd9-c1e23a0592d8",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -420,
          -300
        ],
        "parameters": {
          "color": 6,
          "width": 860,
          "height": 360,
          "content": "Scheduled trigger begin process to gather Pinterest Pin data and store them within Airtable. This data can be referenced or analyzed accordingly. \n\n*If you would like to bring in Pinterest Ads data, the data is already labeled as Organic.\n\nThis is perfect for those who are creating content calendars to understand content scheduling."
        },
        "typeVersion": 1
      },
      {
        "id": "65586422-a631-477b-833d-5c445b1be744",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          480,
          -580
        ],
        "parameters": {
          "color": 4,
          "width": 940,
          "height": 460,
          "content": "AI Agent will go through Pinterest Pins and analyze any data and trends to be able to reach target audience. The data is then summarized within the Summary LLM.\n\nThe summarized results are then sent to the Marketing Manager within an email to help lead content creation efforts. "
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "d6f64ee7-ae49-4a6b-8bf8-9a709c580357",
    "connections": {
      "Airtable2": {
        "ai_tool": [
          [
            {
              "node": "Pinterest Analysis AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Pinterest Analysis AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Pinterest Data Analysis Summary LLM",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Pinterest Analysis AI Agent": {
        "main": [
          [
            {
              "node": "Pinterest Data Analysis Summary LLM",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "8:00am Morning Scheduled Trigger": {
        "main": [
          [
            {
              "node": "Pull List of Pinterest Pins From Account",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pinterest Data Analysis Summary LLM": {
        "main": [
          [
            {
              "node": "Send Marketing Trends & Pinterest Analysis To Marketing Manager",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Data Field To Include Organic": {
        "main": [
          [
            {
              "node": "Create Record Within Pinterest Data Table",
              "type": "main",
              "index": 0
            },
            {
              "node": "Pinterest Analysis AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pull List of Pinterest Pins From Account": {
        "main": [
          [
            {
              "node": "Update Data Field To Include Organic",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "9pEgr7vVvXPDtNdZ",
    "meta": {
      "instanceId": "1a54c41d9050a8f1fa6f74ca858828ad9fb97b9fafa3e9760e576171c531a787"
    },
    "name": "Automate Quickbook Customer & Estimation Creation",
    "tags": [],
    "nodes": [
      {
        "id": "4cf9b22e-5514-4e34-9cb3-ed66411e6de0",
        "name": "Set - normalize fields",
        "type": "n8n-nodes-base.set",
        "position": [
          540,
          980
        ],
        "parameters": {
          "values": {
            "number": [
              {
                "name": "Amount",
                "value": "={{$json.Amount }}"
              }
            ],
            "string": [
              {
                "name": "CustomerName",
                "value": "={{$json['CustomerName']}}"
              },
              {
                "name": "Email",
                "value": "={{$json['Email']}}"
              },
              {
                "name": "Phone",
                "value": "={{$json['Phone']}}"
              },
              {
                "name": "Company Name",
                "value": "={{$json['Company Name']}}"
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "bd6f49f4-27ec-4a52-afe3-453863d0a785",
        "name": "QuickBooks - Find Customer",
        "type": "n8n-nodes-base.quickbooks",
        "position": [
          1020,
          980
        ],
        "parameters": {
          "limit": 500,
          "filters": {
            "query": "=WHERE DisplayName = '{{ $json.CustomerName }}'\n\n"
          },
          "operation": "getAll"
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "82e53cdc-6e3b-4df0-8f05-8b5802d97d69",
        "name": "IF - Customer exists?",
        "type": "n8n-nodes-base.if",
        "position": [
          1460,
          980
        ],
        "parameters": {
          "conditions": {
            "string": [
              {
                "value1": "={{ $json[\"Id\"] }}",
                "operation": "isEmpty"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8631ac1c-94a8-47a4-bc7d-601b55c4e388",
        "name": "QuickBooks - Create Customer (NEW)",
        "type": "n8n-nodes-base.quickbooks",
        "position": [
          1960,
          640
        ],
        "parameters": {
          "operation": "create",
          "displayName": "={{ $('Google Sheets Trigger').item.json.CustomerName }}",
          "additionalFields": {
            "CompanyName": "={{ $('Google Sheets Trigger').item.json['Company Name'] }}",
            "PrimaryPhone": "={{ $('Google Sheets Trigger').item.json.Phone }}",
            "PrimaryEmailAddr": "={{ $('Google Sheets Trigger').item.json.Email }}"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "52f890dd-8f40-4e8d-abd6-ae844a01f97d",
        "name": "No-op (end)",
        "type": "n8n-nodes-base.noOp",
        "position": [
          3300,
          1000
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "f98ee27a-73e2-4625-92f0-18fd2969760f",
        "name": "Google Sheets Trigger",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          100,
          980
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/{YOUR_GOOGLE_SHEETS_ID}/edit#gid=0",
            "cachedResultName": "quickbooksCustomer"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "{YOUR_GOOGLE_SHEETS_ID}",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/{YOUR_GOOGLE_SHEETS_ID}/edit?usp=drivesdk",
            "cachedResultName": "quickbooksCustomer"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8addc4c1-0f40-4e07-83fe-f11ae9706069",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          640
        ],
        "parameters": {
          "color": 6,
          "width": 440,
          "height": 320,
          "content": "### Step 1: Google Sheet Trigger üìä‚ö°\n\nThis node listens for new rows appended to a Google Sheet and triggers the workflow each time a new entry is added.\n\nWhy this step is important:\n\n- ‚è∞ Automatically starts the workflow without manual intervention.\n- üìà Captures new data entries in real time.\n- üîÑ Ensures your automation reacts instantly to updates in the sheet.\n\nIt‚Äôs the step that keeps your workflow in sync with your Google Sheet data. üîî‚ú®\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9a2cd2c2-2d58-4a82-8187-937d96f7a6bc",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          1140
        ],
        "parameters": {
          "width": 480,
          "height": 300,
          "content": "### Step 2: Data Formatter (Set Node) üõ†Ô∏èüìã\n\nThis node formats and organizes the raw data from the Google Sheet into clean, usable variables for the workflow.\n\nWhy this step is important:\n\n- üßπ Cleans and structures incoming data for easier processing.\n- üîÑ Prepares variables needed for subsequent nodes.\n- üéØ Ensures consistent data format throughout the workflow.\n\nIt‚Äôs the step that shapes your raw input into actionable information. ‚öôÔ∏è‚ú®\n"
        },
        "typeVersion": 1
      },
      {
        "id": "31fe85c1-e5e0-458c-9493-114ac37eb07f",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          800,
          640
        ],
        "parameters": {
          "color": 3,
          "width": 560,
          "height": 300,
          "content": "### Step 3: Find Customer in QuickBooks üîçüë§\n\nThis node uses the **Find Customer** operation to check if a customer already exists in QuickBooks based on the name.\n\nWhy this step is important:\n\n- ‚úÖ Avoids duplicate customer entries.\n- üîé Confirms customer presence before creating or updating records.\n- üìã Helps maintain clean and accurate customer data.\n\nIt‚Äôs the step that verifies your customer‚Äôs existence to keep your database tidy and consistent. üßπ‚ú®\n"
        },
        "typeVersion": 1
      },
      {
        "id": "532ad17a-c3a3-411d-94a6-23c68639644d",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1280,
          1140
        ],
        "parameters": {
          "color": 5,
          "width": 560,
          "height": 360,
          "content": "### Step 4: Customer Existence Check (If Node) ‚ùì‚úÖ‚ùå\n\nThis node evaluates whether the customer exists based on the previous **Find Customer** step.\n\n- **True:** Customer does **not** exist in QuickBooks.\n- **False:** Customer **already exists** in QuickBooks.\n\nWhy this step is important:\n\n- üîÑ Directs the workflow to create a new customer or skip creation.\n- ‚öôÔ∏è Ensures the right path is taken for accurate data handling.\n- üõ°Ô∏è Prevents duplicate customer records in your system.\n\nIt‚Äôs the decision point that keeps your customer data clean and your workflow efficient. üîÄ‚ú®\n"
        },
        "typeVersion": 1
      },
      {
        "id": "75bb775b-9f42-4502-b656-f155d4deee91",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1740,
          300
        ],
        "parameters": {
          "color": 4,
          "width": 540,
          "height": 300,
          "content": "### Step 5: Create New Customer in QuickBooks ‚ûïüë§\n\nThis node uses the **Create Customer** operation to add a new customer to QuickBooks when they don‚Äôt already exist.\n\nWhy this step is important:\n\n- üÜï Adds missing customers automatically.\n- üì• Keeps your QuickBooks customer database up-to-date.\n- üîó Ensures new invoices link to the correct customer records.\n\nIt‚Äôs the step that fills gaps in your customer list, making sure no one gets left out. ‚úçÔ∏è‚ú®\n"
        },
        "typeVersion": 1
      },
      {
        "id": "fb2a8680-92e8-4a86-ba7c-c93a85a0c232",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3140,
          1180
        ],
        "parameters": {
          "color": 6,
          "width": 480,
          "height": 280,
          "content": "### Step 7: No-Op Node üõë‚ú®\n\nThis node acts as a **no operation** step to gracefully conclude the workflow without performing any action.\n\nWhy this step is important:\n\n- üõ°Ô∏è Ensures a smooth and clean workflow termination.\n- üîÑ Prevents errors by providing a controlled end point.\n- üß© Helps maintain clear and organized workflow logic.\n\nIt‚Äôs the final checkpoint that safely wraps up the process. üé¨‚úÖ\n"
        },
        "typeVersion": 1
      },
      {
        "id": "26f5e203-a313-4bcc-a7db-dcaaf10ce0fa",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          300
        ],
        "parameters": {
          "color": 3,
          "width": 400,
          "height": 220,
          "content": "### Prerequisites ‚öôÔ∏èüîó\n\n- Connect your **Google OAuth2** credentials with both **Google Sheets** and **Google Drive** enabled.\n- Connect your **QuickBooks OAuth2** credentials.\n\nThese connections ensure seamless authentication and access to the required services throughout the workflow. üîêüöÄ\n"
        },
        "typeVersion": 1
      },
      {
        "id": "242b1395-cbd2-414f-bccf-ab1a8921778b",
        "name": "Create an estimate",
        "type": "n8n-nodes-base.quickbooks",
        "position": [
          2860,
          640
        ],
        "parameters": {
          "Line": [
            {
              "Amount": "={{ $('Google Sheets Trigger').item.json.Amount}}",
              "itemId": "15",
              "LineNum": 1,
              "DetailType": "SalesItemLineDetail",
              "TaxCodeRef": "TAX",
              "Description": "Sales Estimate"
            }
          ],
          "resource": "estimate",
          "operation": "create",
          "CustomerRef": "={{ $json.Id }}",
          "additionalFields": {}
        },
        "typeVersion": 1
      },
      {
        "id": "6fe76106-1236-41ec-96c0-f94eec48cce8",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2580,
          340
        ],
        "parameters": {
          "color": 5,
          "width": 580,
          "height": 280,
          "content": "### Step 6: Create Estimate in QuickBooks üßæ‚ú®\n\nThis node uses the **Create Estimate** operation to generate an estimate in QuickBooks based on the data from the Google Sheet.\n\nWhy this step is important:\n\n- üìä Converts your sheet data into a formal QuickBooks estimate.\n- üíº Streamlines your sales process by automating estimate creation.\n- üîó Links estimates directly to customer and invoice records.\n\nIt‚Äôs the step that turns raw data into actionable sales documents. üí°üìà\n"
        },
        "typeVersion": 1
      },
      {
        "id": "d02e5da2-204e-4461-bec0-815f13ab7b6e",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3820,
          940
        ],
        "parameters": {
          "color": 6,
          "width": 520,
          "height": 340,
          "content": "### Get in Touch\n\nPlease feel free to reachout to us, if you need any help in settin up this workflow.\n\nWe can also help customize workflow pet the use-case. \n\nReach out us at: getstarted@intuz.com\n\nWebsite: https://www.intuz.com/\n\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "21e19475-1189-471a-bbfc-57b092fa82a6",
    "connections": {
      "Create an estimate": {
        "main": [
          [
            {
              "node": "No-op (end)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets Trigger": {
        "main": [
          [
            {
              "node": "Set - normalize fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "IF - Customer exists?": {
        "main": [
          [
            {
              "node": "QuickBooks - Create Customer (NEW)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "No-op (end)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set - normalize fields": {
        "main": [
          [
            {
              "node": "QuickBooks - Find Customer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "QuickBooks - Find Customer": {
        "main": [
          [
            {
              "node": "IF - Customer exists?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "QuickBooks - Create Customer (NEW)": {
        "main": [
          [
            {
              "node": "Create an estimate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "5aaf4236c70e34e423fbdb2c7b754d19253a933bb1476d548f75848a01e473cf",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "e5b2e77c-54df-46e4-a130-b30eed7934ab",
        "name": "Fetch Reddit Posts",
        "type": "n8n-nodes-base.reddit",
        "position": [
          2440,
          3580
        ],
        "parameters": {
          "limit": 5,
          "keyword": "why I stopped using it",
          "operation": "search",
          "subreddit": "Chatgpt",
          "additionalFields": {}
        },
        "typeVersion": 1
      },
      {
        "id": "696586e7-a66b-49a9-a3e7-d309bb441951",
        "name": "Summarize Posts with AI",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2780,
          3580
        ],
        "parameters": {
          "text": "=Analyze the following Reddit post. Classify its main topic in 3-5 words, and write a 1-sentence summary.\n\nTitle: {{ $json[\"title\"] }}  \nContent: {{ $json.selftext }}\n",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "c665d7bb-0c34-4d34-807c-4861c984277e",
        "name": "Generate AI Insights",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2740,
          3800
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "57ba5821-49e1-4ede-9bb0-a7097f94a286",
        "name": "Send Summary to Slack",
        "type": "n8n-nodes-base.slack",
        "position": [
          3340,
          3480
        ],
        "webhookId": "e021423b-e10c-4044-96e4-46cfb82be060",
        "parameters": {
          "text": "=Topic:\n{{ $('Fetch Reddit Posts').item.json.subreddit }}\n\nSummary:\n{{ $json.output }}\n\nView on Reddit:\n{{ $('Fetch Reddit Posts').item.json.media_metadata.cnn80k7excte1.p[0].u }}",
          "select": "channel",
          "channelId": {
            "__rl": true,
            "mode": "list",
            "value": "C08TTV0CC3E",
            "cachedResultName": "all-nathing"
          },
          "otherOptions": {}
        },
        "typeVersion": 2.3
      },
      {
        "id": "b4a501fb-7f2d-4d72-ae38-c418e10b588e",
        "name": "Send Summary to Gmail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          3340,
          3720
        ],
        "webhookId": "c118adb5-da2c-4108-ae40-a056e2d51f89",
        "parameters": {
          "sendTo": "uu941401@gmail.com",
          "message": "=Topic:\n{{ $('Fetch Reddit Posts').item.json.subreddit }}\n\nSummary:\n{{ $json.output }}\n\nView on Reddit:\n{{ $('Fetch Reddit Posts').item.json.media_metadata.cnn80k7excte1.p[0].u }}",
          "options": {},
          "subject": "=New Reddit Post on  {{ $('Fetch Reddit Posts').item.json.subreddit }}"
        },
        "typeVersion": 2.1
      },
      {
        "id": "0eb7d480-bf92-4794-af7c-320b1bee5687",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2160,
          2760
        ],
        "parameters": {
          "color": 3,
          "width": 440,
          "height": 1000,
          "content": "## üõ´ Step 1: Get the Post\n\nThis is the **entry point** of the Reddit Insight workflow, responsible for fetching fresh Reddit content on a regular basis.\n\n### üîÅ **Trigger Daily Reddit Scan**\n\nThis **Schedule Trigger** node initiates the workflow automatically at a predefined time‚Äîtypically once per day. It ensures that your automation always works with the most recent content from Reddit without any manual input.\n\n### üì• **Fetch Reddit Posts**\n\nThis **Reddit node** is configured to search specific subreddits using filters like:\n\n* **Subreddit** (e.g., `technology`, `ai`)\n* **Search term** (e.g., `GPT-5`, `startup launch`)\n* **Time range** (`day`, `week`, etc.)\n* **Sort by** (`top`, `hot`, `new`)\n* **Limit** (e.g., 5 posts)\n\nIt pulls the top relevant posts based on these criteria and passes them along for AI analysis in the next step.\n\n> üîç This section ensures you're always working with timely, relevant Reddit discussions‚Äîperfect for trend monitoring or content summarization.\n\n---\n\nLet me know if you want to break this into a reusable subworkflow or add dynamic inputs via a UI form.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c9b3000d-17df-4b32-b4d6-ca381b1f2aa7",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2660,
          3120
        ],
        "parameters": {
          "color": 4,
          "width": 440,
          "height": 820,
          "content": "## üß† Step 2: Post Summarization\n\nThis section turns raw Reddit content into concise insights using AI.\n\n### ü§ñ **Summarize Posts with AI**\n\nThe **AI Agent** receives posts and uses a connected chat model to analyze and summarize each one. It can extract key points, tone, and trends ‚Äî making the content more actionable.\n\n### üîó **Generate AI Insights (OpenAI Chat Model)**\n\nThe summarization is powered by the **OpenAI Chat Model**, which processes each post using a tailored prompt.\n\n> üìå This step helps convert Reddit noise into clear, valuable summaries for decision-making or sharing."
        },
        "typeVersion": 1
      },
      {
        "id": "bdd58493-78ed-4dbc-ad6f-3fa136168a4e",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3160,
          2980
        ],
        "parameters": {
          "color": 6,
          "width": 440,
          "height": 920,
          "content": "## üì§ Step 3: Send the Summary\n\nThis section distributes the AI-generated summary to communication channels.\n\n### üí¨ **Send Summary to Slack**\n\nThe summarized content is sent to a **Slack channel** via a message post. Ideal for quick team updates directly in your workflow.\n\n### üìß **Send Summary to Gmail**\n\nSimultaneously, the same summary is sent to a **Gmail inbox**, ensuring recipients outside Slack still get the insights.\n\n> üìå This step ensures summaries are instantly shared with stakeholders via preferred communication tools."
        },
        "typeVersion": 1
      },
      {
        "id": "4013e36b-6070-4120-a5cc-ae5824d3e1d9",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          480,
          2760
        ],
        "parameters": {
          "color": 4,
          "width": 1300,
          "height": 320,
          "content": "=======================================\n            WORKFLOW ASSISTANCE\n=======================================\nFor any questions or support, please contact:\n    Yaron@nofluff.online\n\nExplore more tips and tutorials here:\n   - YouTube: https://www.youtube.com/@YaronBeen/videos\n   - LinkedIn: https://www.linkedin.com/in/yaronbeen/\n=======================================\n"
        },
        "typeVersion": 1
      },
      {
        "id": "22cc5f85-cd65-4fb9-ab3d-70393e580d55",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          480,
          3100
        ],
        "parameters": {
          "color": 4,
          "width": 1289,
          "height": 2378,
          "content": "Based on your example, here‚Äôs a detailed breakdown for your **Reddit to AI Summary for Slack & Gmail** workflow, using the same structure and clarity:\n\n---\n\n# üîé Reddit Insight Broadcaster\n\nAutomatically fetch top Reddit posts, generate insights using OpenAI, and broadcast summaries to Slack and Gmail. Perfect for:\n‚úÖ Market Monitoring ‚Äî get daily pulse on trends and user sentiment\n‚úÖ Content Curation ‚Äî surface engaging discussions for teams\n\n---\n\n## ‚öôÔ∏è What's Used\n\n**n8n Nodes:**\nSchedule Trigger ‚Üí Reddit ‚Üí AI Agent ‚Üí OpenAI Chat Model ‚Üí Slack ‚Üí Gmail\n\n**External Tools:**\n\n* **Reddit** ‚Äì Public API via n8n's Reddit node\n* **OpenAI GPT** ‚Äì For intelligent summarization or sentiment tagging\n* **Slack** ‚Äì Post to selected channel\n* **Gmail** ‚Äì Send summaries via email\n\n---\n\n## üîë Setup ‚Äì Credentials Needed\n\n* **Reddit Access** ‚Äì Use n8n Reddit node (API key or OAuth2 if rate-limited access is needed)\n* **OpenAI API Key** ‚Äì Add in the OpenAI Chat node\n* **Slack OAuth2** ‚Äì Connect your workspace\n* **Gmail OAuth2** ‚Äì Connect your Google account\n\n---\n\n## üöÄ Workflow Steps\n\n1. **Trigger Every Morning**\n   Scheduler runs daily at a set time.\n\n2. **Search Reddit Posts**\n   Uses subreddit and keyword filters.\n\n3. **Analyze Content with AI**\n   The AI Agent passes each post to OpenAI to:\n\n   * Summarize discussion\n   * Extract insights\n   * Optionally classify sentiment\n\n4. **Broadcast Insights**\n\n   * Post to a designated Slack channel\n   * Send via Gmail to stakeholders\n\n---\n\n## üì• Example Output (Slack/Gmail Message)\n\n```\nüîç Top Reddit Discussion ‚Äî r/technology\n\n**Title:** OpenAI releases new GPT model  \n**Summary:** Users are discussing the implications of GPT-5's capabilities. General sentiment is excitement mixed with concern over ethical use.  \n**Upvotes:** 1,200 | üí¨ Comments: 350  \nüîó [Read Post](https://reddit.com/r/technology/example)\n```\n\n---\n\n## üí° Pro Tips\n\n* Change subreddit dynamically using variables or UI form\n* Use OpenAI to classify tone (positive/neutral/negative)\n* Add branching: e.g., only email posts with >500 upvotes\n* Extend to Notion or Google Sheets for archiving\n* Use emojis or markdown in Slack messages for better UX\n\n---\n\n## üõ†Ô∏è Customize It\n\n* **Add filters:** Only include posts with >X upvotes\n* **Score content:** Prioritize based on engagement + AI relevance\n* **Route by topic:** Post AI topics to `#ai`, startup topics to `#founders`\n* **Trigger on-demand:** Add webhook or form to control when it runs\n\n---\n\nThis workflow is a lightweight yet powerful Reddit monitoring tool‚Äîperfect for keeping your team updated, generating newsletter content, or tracking niche trends.\nüì° One bot. One summary. Fully automated."
        },
        "typeVersion": 1
      },
      {
        "id": "3b1c680a-0c74-4a83-bf3f-163e9b5114e6",
        "name": "Trigger Daily Reddit Scan",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          2220,
          3580
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 9
              }
            ]
          }
        },
        "typeVersion": 1.2
      }
    ],
    "pinData": {},
    "connections": {
      "Fetch Reddit Posts": {
        "main": [
          [
            {
              "node": "Summarize Posts with AI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate AI Insights": {
        "ai_languageModel": [
          [
            {
              "node": "Summarize Posts with AI",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Summarize Posts with AI": {
        "main": [
          [
            {
              "node": "Send Summary to Slack",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send Summary to Gmail",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger Daily Reddit Scan": {
        "main": [
          [
            {
              "node": "Fetch Reddit Posts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "OQuVjQzqswmDM86W",
    "meta": {
      "instanceId": "dd69efaf8212c74ad206700d104739d3329588a6f3f8381a46a481f34c9cc281",
      "templateCredsSetupCompleted": true
    },
    "name": "WhatsApp Chatbot ‚Äì Restaurant Info Assistant (Bookings, Menu, Timing)",
    "tags": [],
    "nodes": [
      {
        "id": "2990c149-51a8-4fa8-a9a6-2fe4c4e42b72",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -220,
          -620
        ],
        "parameters": {
          "width": 1000,
          "content": "## This workflow powers a WhatsApp chatbot that answers customer questions about restaurant timing, menu, booking, services, and offers.\n\n## It uses a chat model (LLM) to understand queries and respond clearly via WhatsApp.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "32a367b4-c14d-47f8-9ba1-483772e30564",
        "name": "Send Reply to Customer",
        "type": "n8n-nodes-base.whatsApp",
        "position": [
          636,
          -140
        ],
        "webhookId": "a607994c-4e44-4d84-8d8c-725cd4cd903e",
        "parameters": {
          "textBody": "={{ $json.output }}",
          "operation": "send",
          "phoneNumberId": "550325331503475",
          "additionalFields": {},
          "recipientPhoneNumber": "={{ $('Receive WhatsApp Message').item.json.contacts[0].wa_id }}"
        },
        "credentials": {
          "whatsAppApi": {
            "id": "b0PxTDPdWzznWnfG",
            "name": "WhatsApp-test "
          }
        },
        "typeVersion": 1
      },
      {
        "id": "44c64110-9c14-411b-9e12-9843510696d2",
        "name": "Wait For Response",
        "type": "n8n-nodes-base.wait",
        "position": [
          196,
          -240
        ],
        "webhookId": "d9c5d69c-2dfa-4b9f-89f5-76f25d0dd241",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "3021f85b-00af-417b-8022-dc5f717e4ab7",
        "name": "Receive WhatsApp Message",
        "type": "n8n-nodes-base.whatsAppTrigger",
        "position": [
          -400,
          -240
        ],
        "webhookId": "62614db0-4088-41be-a329-fc9ca989ca81",
        "parameters": {
          "options": {},
          "updates": [
            "messages"
          ]
        },
        "credentials": {
          "whatsAppTriggerApi": {
            "id": "jt1wbDtaEmlHpPFc",
            "name": "WhatsApp -test"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "34cf3695-d559-43ab-b720-e419c1094aee",
        "name": "Extract Customer Query",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -180,
          -240
        ],
        "parameters": {
          "text": "={{ $json.messages[0].text.body }}",
          "options": {
            "systemMessage": "=**You are a helpful and friendly WhatsApp chatbot for a restaurant.**\nWhen a customer sends a message, greet them politely and provide clear, short replies to their questions about:\n\n* Restaurant timings (opening/closing hours)\n* Table booking or reservation availability\n* Menu items (food types, popular dishes, specials)\n* Restaurant location or directions\n* Services offered (dine-in, takeaway, delivery)\n* Pricing and current offers\n* Confirming or cancelling a reservation\n\nIf the customer asks something unrelated to the restaurant, reply:\nüü¢ *‚ÄúI‚Äôm here to help with restaurant-related questions. Would you like to know our timings, menu, or book a table?‚Äù*\n\nIf a message is unclear or incomplete, respond with:\nüü¢ *‚ÄúCould you please clarify your question so I can assist you better?‚Äù*\n\nAlways keep the conversation short, polite, and informative.\n\n"
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "92c21a3b-01ad-4ec7-97e2-e5816f23ff81",
        "name": "Generate Reply with AI",
        "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
        "position": [
          -92,
          -20
        ],
        "parameters": {
          "model": "llama3.2-16000:latest",
          "options": {}
        },
        "credentials": {
          "ollamaApi": {
            "id": "h9CEBFmYALm3FvZf",
            "name": "Ollama account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "dd5381b8-337a-4b60-857c-4c84b682edd6",
        "name": "Check If Table Booking Required",
        "type": "n8n-nodes-base.if",
        "position": [
          416,
          -240
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "0282b709-8b08-4831-ab40-5725db7d6034",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "Booking",
                "rightValue": "add_your_value_here"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "6fd96474-c7b2-444c-9f9e-960f6897a76d",
        "name": "Create New Table Booking",
        "type": "n8n-nodes-base.postgres",
        "position": [
          636,
          -340
        ],
        "parameters": {
          "table": {
            "__rl": true,
            "mode": "name",
            "value": "id"
          },
          "schema": {
            "__rl": true,
            "mode": "list",
            "value": "public"
          },
          "columns": {
            "value": {},
            "schema": [],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "credentials": {
          "postgres": {
            "id": "4Y4qEFGqF2krfRHZ",
            "name": "Postgres-test"
          }
        },
        "typeVersion": 2.6
      },
      {
        "id": "f5a58ce9-c39e-40bf-989a-328e8e1a67b3",
        "name": "Send Booking Confirmation to Customer",
        "type": "n8n-nodes-base.whatsApp",
        "position": [
          856,
          -340
        ],
        "webhookId": "a607994c-4e44-4d84-8d8c-725cd4cd903e",
        "parameters": {
          "textBody": "={{ $json.output }}",
          "operation": "send",
          "phoneNumberId": "550325331503475",
          "additionalFields": {},
          "recipientPhoneNumber": "={{ $('Receive WhatsApp Message').item.json.contacts[0].wa_id }}"
        },
        "credentials": {
          "whatsAppApi": {
            "id": "b0PxTDPdWzznWnfG",
            "name": "WhatsApp-test "
          }
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "3bedc946-ce52-4aaa-b868-96b0e6b59b1b",
    "connections": {
      "Wait For Response": {
        "main": [
          [
            {
              "node": "Check If Table Booking Required",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Customer Query": {
        "main": [
          [
            {
              "node": "Wait For Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Reply with AI": {
        "ai_languageModel": [
          [
            {
              "node": "Extract Customer Query",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Create New Table Booking": {
        "main": [
          [
            {
              "node": "Send Booking Confirmation to Customer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Receive WhatsApp Message": {
        "main": [
          [
            {
              "node": "Extract Customer Query",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check If Table Booking Required": {
        "main": [
          [
            {
              "node": "Create New Table Booking",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send Reply to Customer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "iD8sbZKww1NpC3At",
    "meta": {
      "instanceId": "dd69efaf8212c74ad206700d104739d3329588a6f3f8381a46a481f34c9cc281",
      "templateCredsSetupCompleted": true
    },
    "name": "Automate Restaurant Marketing & Booking via Excel and VAPI Voice Agent",
    "tags": [],
    "nodes": [
      {
        "id": "61f3ed14-9be9-42bb-ac7b-90072005ebc1",
        "name": "New Lead Trigger (Excel)",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          -20,
          -220
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1760068917,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mkHJIhSFXdh1n65GKPwzEzFw0QasunyYm9BDglnXeiI/edit#gid=1760068917",
            "cachedResultName": "call_list"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1mkHJIhSFXdh1n65GKPwzEzFw0QasunyYm9BDglnXeiI",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mkHJIhSFXdh1n65GKPwzEzFw0QasunyYm9BDglnXeiI/edit?usp=drivesdk",
            "cachedResultName": "Vapi_real-estate"
          }
        },
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "BoDTTv5L67GVL3Fi",
            "name": "Google Sheets  - test"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "de15cc25-830d-4efe-9265-685eef529094",
        "name": "Prepare Lead Data",
        "type": "n8n-nodes-base.set",
        "position": [
          200,
          -220
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a10873fa-0c01-46ed-a364-d31200e44e76",
                "name": "Phone",
                "type": "string",
                "value": "=+{{ $json.Phone }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "22384d76-3c0d-4d3b-9e85-4e9d6a005e7f",
        "name": "Loop Through Leads",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          420,
          -220
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "eea1ca56-260e-4f81-980a-6f2dd46e0667",
        "name": "Start Marketing Call (VAPI)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          640,
          -220
        ],
        "parameters": {
          "url": "https://api.vapi.ai/call",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"assistantId\": \"add_id_here\",\n  \"phoneNumberId\": \"add_id_here\",\n  \"customers\": [\n    {\n      \"number\":\"{{ $json.Phone }}\"\n    }\n  ]\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "httpBearerAuth"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "JzfcNGi2NYJB6wll",
            "name": "Bearer YOUR_TOKEN_HERE account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "9addff6d-2a29-4f02-94a8-d76406987569",
        "name": "VAPI Call Response Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -20,
          40
        ],
        "webhookId": "a34ac7ac-7ea4-4942-8dbf-f9ce3f0986e4",
        "parameters": {
          "path": "a34ac7ac-7ea4-4942-8dbf-f9ce3f0986e4",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "9797586c-4313-4ce1-b58b-ec3e31cb705e",
        "name": "Store User Response (Sheet)",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          200,
          40
        ],
        "parameters": {
          "columns": {
            "value": {
              "next_step": "={{ $json.body.message.toolCalls[0].function.arguments.next_step }}",
              "call_notes": "={{ $json.body.message.toolCalls[0].function.arguments.call_notes }}",
              "website_url": "={{ $json.body.message.toolCalls[0].function.arguments.website_url }}",
              "call_outcome": "={{ $json.body.message.toolCalls[0].function.arguments.call_outcome }}",
              "company_name": "={{ $json.body.message.toolCalls[0].function.arguments.company_name }}",
              "phone_number": "={{ $json.body.message.toolCalls[0].function.arguments.phone_number }}",
              "email_address": "={{ $json.body.message.toolCalls[0].function.arguments.email_address }}",
              "prospect_name": "={{ $json.body.message.toolCalls[0].function.arguments.prospect_name }}",
              "prospect_role": "={{ $json.body.message.toolCalls[0].function.arguments.prospect_role }}",
              "follow_up_date": "={{ $json.body.message.toolCalls[0].function.arguments.follow_up_date }}",
              "interest_level": "={{ $json.body.message.toolCalls[0].function.arguments.interest_level }}",
              "website_strength": "={{ $json.body.message.toolCalls[0].function.arguments.website_strength }}",
              "biggest_challenge": "={{ $json.body.message.toolCalls[0].function.arguments.biggest_challenge }}",
              "objections_raised": "={{ $json.body.message.toolCalls[0].function.arguments.objections_raised }}",
              "opt_out_requested": "={{ $json.body.message.toolCalls[0].function.arguments.opt_out_requested }}",
              "appointment_datetime": "={{ $json.body.message.toolCalls[0].function.arguments.appointment_datetime }}",
              "current_marketing_methods": "={{ $json.body.message.toolCalls[0].function.arguments.current_marketing_methods }}",
              "previous_digital_marketing": "={{ $json.body.message.toolCalls[0].function.arguments.previous_digital_marketing }}"
            },
            "schema": [
              {
                "id": "prospect_name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "prospect_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "prospect_role",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "prospect_role",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "company_name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "company_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "website_url",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "website_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "website_strength",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "website_strength",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "phone_number",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "phone_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "current_marketing_methods",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "current_marketing_methods",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "biggest_challenge",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "biggest_challenge",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "previous_digital_marketing",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "previous_digital_marketing",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "objections_raised",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "objections_raised",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "interest_level",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "interest_level",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "next_step",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "next_step",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "appointment_datetime",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "appointment_datetime",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "call_outcome",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "call_outcome",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "call_notes",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "call_notes",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "follow_up_date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "follow_up_date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "opt_out_requested",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "opt_out_requested",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "prospect_name"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mkHJIhSFXdh1n65GKPwzEzFw0QasunyYm9BDglnXeiI/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1mkHJIhSFXdh1n65GKPwzEzFw0QasunyYm9BDglnXeiI",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mkHJIhSFXdh1n65GKPwzEzFw0QasunyYm9BDglnXeiI/edit?usp=drivesdk",
            "cachedResultName": "Vapi_real-estate"
          },
          "authentication": "serviceAccount"
        },
        "credentials": {
          "googleApi": {
            "id": "ScSS2KxGQULuPtdy",
            "name": "Google Sheets- test"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "b5dbaaf8-c8e2-4dda-a3a0-862cf25bd659",
        "name": "Extract Booking/Order Info",
        "type": "n8n-nodes-base.code",
        "position": [
          420,
          40
        ],
        "parameters": {
          "jsCode": "function formatIST(date) {\n  const options = {\n    timeZone: 'Asia/Kolkata',\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    second: '2-digit',\n    hour12: false\n  };\n  const parts = new Intl.DateTimeFormat('en-GB', options).formatToParts(date);\n  const lookup = {};\n  parts.forEach(p => lookup[p.type] = p.value);\n  return `${lookup.year}-${lookup.month}-${lookup.day} ${lookup.hour}:${lookup.minute}:${lookup.second} IST`;\n}\n\nfor (const item of items) {\n  let dateStr = item.json.date_input?.toLowerCase?.() || 'today';\n  let timeStr = item.json.time_input || '17:00'; // default to 5 PM\n\n  // Step 1: base date\n  let baseDate = new Date();\n  if (dateStr === 'tomorrow') {\n    baseDate.setDate(baseDate.getDate() + 1);\n  } else if (dateStr !== 'today') {\n    baseDate = new Date(dateStr);\n  }\n\n  // Step 2: parse time\n  const [timePart, ampm] = timeStr.trim().split(/ (AM|PM)/i);\n  let [hours, minutes] = timePart.split(':').map(Number);\n  if (ampm?.toLowerCase() === 'pm' && hours < 12) hours += 12;\n  if (ampm?.toLowerCase() === 'am' && hours === 12) hours = 0;\n\n  baseDate.setHours(hours, minutes || 0, 0, 0);\n\n  // Step 3: set IST formatted times\n  const startIST = formatIST(baseDate);\n  const endIST = formatIST(new Date(baseDate.getTime() + 60 * 60 * 1000)); // +1 hour\n\n  item.json.appointment_datetime_parsed = startIST;\n  item.json.appointment_end_datetime = endIST;\n}\n\nreturn items;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "74ca51eb-c7c3-4965-839e-db0e80f8dc02",
        "name": "Schedule Delivery/Table Booking",
        "type": "n8n-nodes-base.googleCalendar",
        "position": [
          640,
          40
        ],
        "parameters": {
          "end": "={{ $json.appointment_end_datetime }}",
          "start": "={{ $json.appointment_datetime_parsed }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "abc@gmail.com"
          },
          "additionalFields": {}
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "6ldLmzzYtaqng4pw",
            "name": "Google Calendar account - test"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "d34f8054-9d1c-48fe-a6df-35e12a0d09a1",
        "name": "Send Response to VAPI",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          860,
          40
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "f1a84630-df6e-4f6f-8633-b60a712bbd82",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          -540
        ],
        "parameters": {
          "color": 3,
          "width": 980,
          "height": 520,
          "content": "## Lead Management & Marketing Automation Workflow\n\n- New Lead Trigger: Excel triggers capture new leads when customers are added to the lead management spreadsheet\n\n- Lead Preparation: The system processes and formats lead data, extracting relevant details (name, phone, preferences, booking history)\n\n- Campaign Loop: Automated loop processes through multiple leads for batch marketing campaigns\n\n- Voice Marketing Call: VAPI initiates personalized voice calls to leads with tailored restaurant offers and booking invitations\n\n- Response Tracking: All call results and lead responses are logged back to Excel for campaign analysis\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "62f06ede-32ed-40fe-b40f-4887245e34f9",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -140,
          0
        ],
        "parameters": {
          "width": 1240,
          "height": 500,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Booking & Order Processing Workflow\n\n- Voice Response Capture: VAPI webhook triggers when customers respond to marketing calls or make direct booking requests\n\n- Response Storage: Customer responses and booking preferences are immediately saved to Excel sheets\n\n- Information Extraction: System processes natural language responses to extract booking details (party size, preferred times, special requests)\n\n- Calendar Integration: Booking information is automatically scheduled in restaurant management systems\n\n- Confirmation Loop: Automated follow-up voice messages confirm bookings and provide additional restaurant information"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "timezone": "Asia/Kolkata",
      "callerPolicy": "workflowsFromSameOwner",
      "executionOrder": "v1"
    },
    "versionId": "dc998ee6-b2db-4413-8198-a94fc7ff539f",
    "connections": {
      "Prepare Lead Data": {
        "main": [
          [
            {
              "node": "Loop Through Leads",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Through Leads": {
        "main": [
          [
            {
              "node": "Start Marketing Call (VAPI)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Loop Through Leads",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "New Lead Trigger (Excel)": {
        "main": [
          [
            {
              "node": "Prepare Lead Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Booking/Order Info": {
        "main": [
          [
            {
              "node": "Schedule Delivery/Table Booking",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "VAPI Call Response Webhook": {
        "main": [
          [
            {
              "node": "Store User Response (Sheet)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Store User Response (Sheet)": {
        "main": [
          [
            {
              "node": "Extract Booking/Order Info",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Delivery/Table Booking": {
        "main": [
          [
            {
              "node": "Send Response to VAPI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "QIkMJhue2s5le6jM",
    "meta": {
      "instanceId": "c2650793f644091dc80fb900fe63448ad1f4b774008de9608064d67294f8307c",
      "templateCredsSetupCompleted": true
    },
    "name": "Reranks #1",
    "tags": [],
    "nodes": [
      {
        "id": "f0678325-baee-4210-886b-72d4e4fcc4ce",
        "name": "Search File",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          3680,
          580
        ],
        "parameters": {
          "filter": {
            "folderId": {
              "__rl": true,
              "mode": "list",
              "value": "1dh1Rr2yrhSdoSYpiR8s1yXiSWLYxpoLJ",
              "cachedResultUrl": "https://drive.google.com/drive/folders/1dh1Rr2yrhSdoSYpiR8s1yXiSWLYxpoLJ",
              "cachedResultName": "ReCharge"
            }
          },
          "options": {},
          "resource": "fileFolder",
          "returnAll": true
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "nTWGelaHlbvHrG66",
            "name": "Khaisa Studio"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "52a98bc4-4364-49cd-b7dc-5ea77024473e",
        "name": "Get Data",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          3840,
          580
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {},
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "nTWGelaHlbvHrG66",
            "name": "Khaisa Studio"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "13e41f0e-c890-4e8c-8fc0-76615187c1db",
        "name": "Supabase Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          4080,
          380
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "documents",
            "cachedResultName": "documents"
          }
        },
        "credentials": {
          "supabaseApi": {
            "id": "rb73xq0erYUAZCau",
            "name": "REcharge"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "739dd64e-9493-41de-b5aa-f0a376e8ce85",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          4060,
          560
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "IWdqsaVAq1AL1S28",
            "name": "n8n - Money manager Khairul"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6674cbfc-c0e0-48e1-b044-d7ee693dfc83",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          4200,
          580
        ],
        "parameters": {
          "options": {},
          "dataType": "binary"
        },
        "typeVersion": 1
      },
      {
        "id": "b3c042bb-4c0b-4dd3-ac7e-be7a99d792df",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          4240,
          720
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "13cff178-5db2-478e-97de-dee175b62a8f",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          3860,
          380
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "a077fb5d-f2c5-40c4-9dd5-6abc28a21311",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2380,
          740
        ],
        "parameters": {
          "text": "={{ $json.payload._data.key.id }}",
          "options": {
            "systemMessage": "=You are a business intelligence assistant for ReCharge with access to:\n\n1. **company knowledge based** - General business documents and guides\n2. **Restaurant Leads Database** - Potential restaurant clients with ratings, contact info, and business details\n\nYou can help with:\n- Finding high-potential restaurant leads by location, rating, or category\n- Analyzing restaurant market opportunities  \n- Providing restaurant recommendations and insights\n- Preparing cold outreach strategies with personalized data\n- Business intelligence from collected restaurant data\n\nAlways use both knowledge sources to provide comprehensive answers."
          },
          "promptType": "define"
        },
        "typeVersion": 2
      },
      {
        "id": "ef8f5cec-f189-4d46-b5b3-7a07b201f942",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2320,
          900
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "IWdqsaVAq1AL1S28",
            "name": "n8n - Money manager Khairul"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c054fd37-688b-40ef-86c7-fb7ada0b13ba",
        "name": "Postgres Chat Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
        "position": [
          2460,
          900
        ],
        "parameters": {
          "sessionKey": "={{ $('WAHA Trigger').item.json.payload._data.key.remoteJid }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 20
        },
        "credentials": {
          "postgres": {
            "id": "8PMGgjtS4muxnKxT",
            "name": "ReCharge Database"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "482e862f-6592-4d02-9bd1-6b50d1e87e5b",
        "name": "Embeddings OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          2600,
          1040
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "IWdqsaVAq1AL1S28",
            "name": "n8n - Money manager Khairul"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "3b6a1f51-882b-4f0c-9e39-2676c08f1e71",
        "name": "Google Drive Trigger",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          3500,
          580
        ],
        "parameters": {
          "event": "fileUpdated",
          "options": {
            "fileType": "all"
          },
          "pollTimes": {
            "item": [
              {
                "hour": 0
              }
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "list",
            "value": "1dh1Rr2yrhSdoSYpiR8s1yXiSWLYxpoLJ",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1dh1Rr2yrhSdoSYpiR8s1yXiSWLYxpoLJ",
            "cachedResultName": "ReCharge"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "nTWGelaHlbvHrG66",
            "name": "Khaisa Studio"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "91703e9f-78c7-4db3-a58f-b9736379d6f5",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3420,
          260
        ],
        "parameters": {
          "color": 5,
          "width": 1100,
          "height": 620,
          "content": "# Company Knowledge Base\n"
        },
        "typeVersion": 1
      },
      {
        "id": "0ea74b68-0ade-4b9a-9371-38184aac722f",
        "name": "When clicking ‚ÄòExecute workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          2080,
          180
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "9150f04a-1201-41e8-902d-dcf18c7a6bb2",
        "name": "Scrape Maps",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2520,
          180
        ],
        "parameters": {
          "url": "<your apify url>",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n    \"includeWebResults\": false,\n    \"language\": \"id\",\n    \"locationQuery\": \"{{ $json.lokasi }}\",\n    \"maxCrawledPlacesPerSearch\": 500,\n    \"maxImages\": 0,\n    \"maximumLeadsEnrichmentRecords\": 0,\n    \"scrapeContacts\": false,\n    \"scrapeDirectories\": false,\n    \"scrapeImageAuthors\": false,\n    \"scrapePlaceDetailPage\": false,\n    \"scrapeReviewsPersonalData\": true,\n    \"scrapeTableReservationProvider\": false,\n    \"searchStringsArray\": [\n        \"Restoran\"\n    ],\n    \"skipClosedPlaces\": false\n}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.2
      },
      {
        "id": "ee02f5bb-be98-4344-b9d3-1637e923d7e2",
        "name": "Clean Data",
        "type": "n8n-nodes-base.code",
        "position": [
          2520,
          380
        ],
        "parameters": {
          "jsCode": "// Bersihkan dan format data dari spreadsheet\nconst cleanData = $input.all().map(item => {\n  const data = item.json;\n  \n  // Parse JSON strings jadi array yang mudah dibaca\n  function parseJsonField(field) {\n    try {\n      if (!field || field === 'not found') return [];\n      const parsed = JSON.parse(field);\n      if (Array.isArray(parsed)) {\n        return parsed.map(item => {\n          if (typeof item === 'object') {\n            return Object.keys(item).filter(key => item[key] === true);\n          }\n          return item;\n        }).flat();\n      }\n      return [];\n    } catch {\n      return [];\n    }\n  }\n  \n  // Parse opening hours jadi format mudah dibaca\n  function parseOpeningHours(hoursString) {\n    try {\n      if (!hoursString) return 'Jam buka tidak tersedia';\n      const hours = JSON.parse(hoursString);\n      return hours.map(h => `${h.day}: ${h.hours}`).join(', ');\n    } catch {\n      return 'Jam buka tidak tersedia';\n    }\n  }\n  \n  // Ekstrak data bersih\n  const keunggulan = parseJsonField(data.Keunggulan);\n  const fasilitas = parseJsonField(data.Fasilitas);\n  const pembayaran = parseJsonField(data.Pembayaran);\n  const allCategories = parseJsonField(data['All Categories']);\n  const openingHours = parseOpeningHours(data['Opening Hours']);\n  \n  // Buat deskripsi lengkap untuk AI\n  const businessDescription = `\n${data.Title} adalah ${data.Category} yang berlokasi di ${data.Neighborhood}. \nRating: ${data.Rating}/5 dengan ${data.Reviews} review. \nHarga: ${data.Price || 'Tidak diketahui'}.\n${data.Description || ''}\n\nKeunggulan: ${keunggulan.join(', ') || 'Tidak ada info keunggulan'}\nFasilitas: ${fasilitas.join(', ') || 'Tidak ada info fasilitas'}  \nMetode Pembayaran: ${pembayaran.join(', ') || 'Tidak ada info pembayaran'}\nKategori: ${allCategories.join(', ') || data.Category}\nJam Buka: ${openingHours}\n\nKontak: ${data.Phone || 'Tidak ada nomor telepon'}\nWebsite: ${data.Website !== 'not found' ? data.Website : 'Tidak ada website'}\nAlamat Lengkap: ${data.Address}\n`.trim();\n\n  // Hitung lead score\n  let leadScore = 0;\n  if (data.Rating >= 4.5) leadScore += 30;\n  if (data.Rating >= 4.0) leadScore += 20;\n  if (data.Reviews >= 1000) leadScore += 25;\n  if (data.Reviews >= 100) leadScore += 15;\n  if (data.Phone) leadScore += 20;\n  if (data.Website && data.Website !== 'not found') leadScore += 20;\n  if (keunggulan.length > 0) leadScore += 10;\n\n  return {\n    // Data utama\n    restaurant_name: data.Title,\n    category: data.Category,\n    description: data.Description || '',\n    location: data.Neighborhood,\n    full_address: data.Address,\n    phone: data.Phone,\n    website: data.Website !== 'not found' ? data.Website : '',\n    rating: data.Rating,\n    total_reviews: data.Reviews,\n    price_range: data.Price || 'Tidak diketahui',\n    \n    // Data terformat\n    keunggulan_list: keunggulan.join(', '),\n    fasilitas_list: fasilitas.join(', '),\n    pembayaran_list: pembayaran.join(', '),\n    kategori_lengkap: allCategories.join(', '),\n    jam_operasional: openingHours,\n    \n    // Untuk AI analysis\n    business_summary: businessDescription,\n    lead_score: leadScore,\n    lead_quality: leadScore >= 70 ? 'High' : leadScore >= 40 ? 'Medium' : 'Low',\n    \n    // Metadata\n    scraped_date: new Date().toLocaleString('id-ID'),\n    data_source: 'Google Maps via Apify'\n  };\n});\n\nreturn cleanData;"
        },
        "typeVersion": 2
      },
      {
        "id": "93664ba7-c18c-4064-b984-f592791cb731",
        "name": "Update Data",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2740,
          380
        ],
        "parameters": {
          "columns": {
            "value": {
              "Phone": "={{ $json.phone }}",
              "Price": "={{ $json.price_range }}",
              "Title": "={{ $json.restaurant_name }}",
              "Rating": "={{ $json.rating }}",
              "Address": "={{ $json.full_address }}",
              "Reviews": "={{ $json.total_reviews }}",
              "Website": "={{ $json.website }}",
              "Category": "={{ $json.category }}",
              "Fasilitas": "={{ $json.fasilitas_list }}",
              "Keunggulan": "={{ $json.keunggulan_list }}",
              "Lead Score": "={{ $json.lead_score }}",
              "Pembayaran": "={{ $json.pembayaran_list }}",
              "row_number": "={{ $('Get Leads').item.json.row_number }}",
              "Description": "={{ $json.description }}",
              "Lead Quality": "={{ $json.lead_quality }}",
              "Neighborhood": "={{ $json.location }}",
              "Opening Hours": "={{ $json.jam_operasional }}",
              "All Categories": "={{ $json.kategori_lengkap }}"
            },
            "schema": [
              {
                "id": "Title",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Description",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Category",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Category",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Address",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Phone",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Phone",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Rating",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Rating",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Reviews",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Reviews",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Price",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Price",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Website",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Website",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Neighborhood",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Neighborhood",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Opening Hours",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Opening Hours",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "All Categories",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "All Categories",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Keunggulan",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Keunggulan",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Fasilitas",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Fasilitas",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Pembayaran",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Pembayaran",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Lead Score",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Lead Score",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Lead Quality",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Lead Quality",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DKXYqpb0EWNYsbq2x8h5xqUWXy772toNDVrl8d-8nfA/edit#gid=0",
            "cachedResultName": "Restaurant"
          },
          "documentId": {
            "__rl": true,
            "mode": "url",
            "value": "https://docs.google.com/spreadsheets/d/1DKXYqpb0EWNYsbq2x8h5xqUWXy772toNDVrl8d-8nfA/edit?usp=sharing"
          },
          "authentication": "serviceAccount"
        },
        "credentials": {
          "googleApi": {
            "id": "Os8sgTGkRS1YybbJ",
            "name": "Sheet & Drive"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "51681e42-74ca-4fe8-9254-40f150c0a2aa",
        "name": "Webhook",
        "type": "n8n-nodes-base.webhook",
        "disabled": true,
        "position": [
          2080,
          380
        ],
        "webhookId": "4ef17aa0-fc90-4b34-a6e2-e8a2ede9c334",
        "parameters": {
          "path": "<your webhook>",
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "e0fea0f5-7281-439f-bf90-841a80646590",
        "name": "HTTP Request1",
        "type": "n8n-nodes-base.httpRequest",
        "disabled": true,
        "position": [
          3180,
          180
        ],
        "parameters": {
          "url": "<your webhook>",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "92aa2a7f-c626-4a60-99e4-b5712ba9a1c1",
        "name": "Get Result",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2740,
          180
        ],
        "parameters": {
          "url": "<your apify get>",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "412a7be8-66ec-484c-b539-583dbe531f73",
        "name": "Append Leads",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2960,
          180
        ],
        "parameters": {
          "columns": {
            "value": {
              "Phone": "={{ $json.phone ? $json.phone.replace(/[-\\s]/g, '') : '' }}",
              "Price": "={{ $json.price }}",
              "Title": "={{ $json.title }}",
              "Rating": "={{ $json.totalScore }}",
              "Address": "={{ $json.address }}",
              "Reviews": "={{ $json.reviewsCount }}",
              "Website": "={{ $json.website || \"not found\" }}",
              "Category": "={{ $json.categoryName }}",
              "Fasilitas": "={{ $json.additionalInfo.Fasilitas }}",
              "Keunggulan": "={{ $json.additionalInfo.Keunggulan }}",
              "Pembayaran": "={{ $json.additionalInfo.Pembayaran }}",
              "Description": "={{ $json.description }}",
              "Neighborhood": "={{ $json.neighborhood }}",
              "Opening Hours": "={{ $json.openingHours }}",
              "All Categories": "={{ $json.categories }}"
            },
            "schema": [
              {
                "id": "Title",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Category",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Category",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Address",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Phone",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Phone",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Rating",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Rating",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Reviews",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Reviews",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Price",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Price",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Website",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Website",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Neighborhood",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Neighborhood",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Opening Hours",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Opening Hours",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "All Categories",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "All Categories",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Keunggulan",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Keunggulan",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Fasilitas",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Fasilitas",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Pembayaran",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Pembayaran",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DKXYqpb0EWNYsbq2x8h5xqUWXy772toNDVrl8d-8nfA/edit#gid=0",
            "cachedResultName": "Restaurant"
          },
          "documentId": {
            "__rl": true,
            "mode": "url",
            "value": "https://docs.google.com/spreadsheets/d/1DKXYqpb0EWNYsbq2x8h5xqUWXy772toNDVrl8d-8nfA/edit?usp=sharing"
          },
          "authentication": "serviceAccount"
        },
        "credentials": {
          "googleApi": {
            "id": "Os8sgTGkRS1YybbJ",
            "name": "Sheet & Drive"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "93eefe61-c614-4f52-8d3e-2bcc268628bc",
        "name": "Get Leads",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2300,
          380
        ],
        "parameters": {
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "",
            "cachedResultUrl": "",
            "cachedResultName": ""
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "authentication": "serviceAccount"
        },
        "credentials": {
          "googleApi": {
            "id": "Os8sgTGkRS1YybbJ",
            "name": "Sheet & Drive"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "d666e66e-a749-4484-8564-a136e54a4dd2",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2020,
          80
        ],
        "parameters": {
          "color": 7,
          "width": 1360,
          "height": 520,
          "content": "# Scrapping and data Cleaning\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3b072239-fc03-4208-b2c6-2a8dc9dd4bed",
        "name": "Supabase Vector Store2",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          4080,
          1060
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "restaurant_leads",
            "cachedResultName": "restaurant_leads"
          }
        },
        "credentials": {
          "supabaseApi": {
            "id": "rb73xq0erYUAZCau",
            "name": "REcharge"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "1237145e-e64e-4f52-880c-07a7acd58bb3",
        "name": "small3",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          4060,
          1280
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "IWdqsaVAq1AL1S28",
            "name": "n8n - Money manager Khairul"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "7beea738-09bb-44c2-80eb-405ea9bca15b",
        "name": "Default Data Loader2",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          4200,
          1220
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "88ae6f60-796c-4507-8c5e-c71ed7232533",
        "name": "Recursive Character Text Splitter1",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          4200,
          1360
        ],
        "parameters": {
          "options": {},
          "chunkOverlap": 200
        },
        "typeVersion": 1
      },
      {
        "id": "ab1ca886-dad6-4cc5-83a7-da5d2c6f0fd4",
        "name": "Google Sheets Trigger",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          3480,
          1060
        ],
        "parameters": {
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyHour"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DKXYqpb0EWNYsbq2x8h5xqUWXy772toNDVrl8d-8nfA/edit#gid=0",
            "cachedResultName": "Restaurant"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1DKXYqpb0EWNYsbq2x8h5xqUWXy772toNDVrl8d-8nfA",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1DKXYqpb0EWNYsbq2x8h5xqUWXy772toNDVrl8d-8nfA/edit?usp=drivesdk",
            "cachedResultName": "Database ReCharge"
          }
        },
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "F3lxq4bAfCrWKqMD",
            "name": "Oauth "
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5a8f4c25-e22f-40f0-b139-50088dfeb8e4",
        "name": "Transform for Vector",
        "type": "n8n-nodes-base.code",
        "position": [
          3660,
          1060
        ],
        "parameters": {
          "jsCode": "// Transform data yang baru ditambah dari spreadsheet\nconst newData = $input.all().map(item => {\n  const data = item.json;\n  \n  // Skip jika data kosong\n  if (!data.Title || data.Title.trim() === '') {\n    return null;\n  }\n  \n  // Buat business summary untuk embedding\n  const businessSummary = `\n${data.Title} adalah ${data.Category || 'restoran'} yang berlokasi di ${data.Neighborhood || 'lokasi tidak diketahui'}. \nRating: ${data.Rating || 'belum ada rating'}/5 dengan ${data.Reviews || 0} review. \nHarga: ${data.Price || 'Tidak diketahui'}.\n${data.Description || ''}\n\nKeunggulan: ${data['Keunggulan Clean'] || 'Tidak ada info keunggulan'}\nFasilitas: ${data['Fasilitas Clean'] || 'Tidak ada info fasilitas'}  \nMetode Pembayaran: ${data['Pembayaran Clean'] || 'Tidak ada info pembayaran'}\nJam Operasional: ${data['Jam Operasional'] || 'Tidak tersedia'}\n\nKontak: ${data.Phone || 'Tidak ada nomor telepon'}\nWebsite: ${data.Website !== 'not found' ? data.Website : 'Tidak ada website'}\nAlamat: ${data.Address || 'Alamat tidak lengkap'}\n`.trim();\n\n  return {\n    // Content untuk embedding\n    business_summary: businessSummary,\n    \n    // Metadata\n    metadata: {\n      restaurant_name: data.Title,\n      category: data.Category,\n      location: data.Neighborhood,\n      phone: data.Phone,\n      rating: data.Rating,\n      total_reviews: data.Reviews,\n      lead_score: data['Lead Score'] || 0,\n      lead_quality: data['Lead Quality'] || 'Unknown',\n      keunggulan: data['Keunggulan Clean'] || '',\n      fasilitas: data['Fasilitas Clean'] || '',\n      pembayaran: data['Pembayaran Clean'] || '',\n      website: data.Website !== 'not found' ? data.Website : '',\n      price_range: data.Price || 'Tidak diketahui',\n      full_address: data.Address,\n      jam_operasional: data['Jam Operasional'] || 'Tidak tersedia',\n      row_number: data.row_number,\n      last_updated: new Date().toISOString(),\n      data_type: \"restaurant_lead\",\n      source: \"google_sheets_auto\"\n    }\n  };\n}).filter(item => item !== null);\n\nreturn newData;"
        },
        "typeVersion": 2
      },
      {
        "id": "d0223130-8df1-4f3b-9800-3ead95a29c5f",
        "name": "Check Existing Data",
        "type": "n8n-nodes-base.code",
        "position": [
          3880,
          1060
        ],
        "parameters": {
          "jsCode": "// Check dan handle existing data di Supabase vector database\nconst inputData = $input.all();\nconst processedData = [];\n\nfor (const item of inputData) {\n  const data = item.json;\n  \n  // Skip jika data kosong atau tidak valid\n  if (!data.Title || data.Title.trim() === '') {\n    console.log(`Skipping empty data for row ${data.row_number}`);\n    continue;\n  }\n  \n  // Buat unique identifier berdasarkan kombinasi nama + alamat\n  const uniqueId = `${data.Title}_${data.Address}`.replace(/[^a-zA-Z0-9]/g, '_').toLowerCase();\n  \n  // Buat business summary untuk embedding\n  const businessSummary = `\nNama Restoran: ${data.Title}\nKategori: ${data.Category || 'Restoran'}\nLokasi: ${data.Neighborhood || 'Tidak diketahui'}\nAlamat: ${data.Address || 'Alamat tidak lengkap'}\nRating: ${data.Rating || 'Belum ada rating'}/5 (${data.Reviews || 0} reviews)\nHarga: ${data.Price || 'Tidak diketahui'}\nDeskripsi: ${data.Description || 'Tidak ada deskripsi'}\n\nDetail Bisnis:\n- Keunggulan: ${data.Keunggulan || 'Tidak ada info keunggulan'}\n- Fasilitas: ${data.Fasilitas || 'Tidak ada info fasilitas'}\n- Metode Pembayaran: ${data.Pembayaran || 'Tidak ada info pembayaran'}\n- Jam Operasional: ${data['Opening Hours'] || 'Tidak tersedia'}\n\nKontak:\n- Telepon: ${data.Phone || 'Tidak ada nomor telepon'}\n- Website: ${data.Website && data.Website !== 'not found' ? data.Website : 'Tidak ada website'}\n\nLead Score: ${data['Lead Score'] || 0}\nLead Quality: ${data['Lead Quality'] || 'Unknown'}\n`.trim();\n\n  // Prepare data untuk vector store\n  const vectorData = {\n    // Text content untuk embedding\n    pageContent: businessSummary,\n    \n    // Metadata untuk filtering dan searching\n    metadata: {\n      unique_id: uniqueId,\n      restaurant_name: data.Title,\n      category: data.Category || 'Restoran',\n      location: data.Neighborhood || 'Tidak diketahui',\n      full_address: data.Address || '',\n      phone: data.Phone || '',\n      website: data.Website && data.Website !== 'not found' ? data.Website : '',\n      rating: parseFloat(data.Rating) || 0,\n      total_reviews: parseInt(data.Reviews) || 0,\n      price_range: data.Price || 'Tidak diketahui',\n      lead_score: parseInt(data['Lead Score']) || 0,\n      lead_quality: data['Lead Quality'] || 'Unknown',\n      \n      // Additional business info\n      keunggulan: data.Keunggulan || '',\n      fasilitas: data.Fasilitas || '',\n      pembayaran: data.Pembayaran || '',\n      jam_operasional: data['Opening Hours'] || '',\n      \n      // System metadata\n      row_number: data.row_number,\n      data_source: 'google_sheets',\n      data_type: 'restaurant_lead',\n      last_updated: new Date().toISOString(),\n      \n      // Status tracking\n      contact_status: 'not_contacted',\n      is_active: true\n    },\n    \n    // Original row data untuk reference\n    original_data: data\n  };\n  \n  // Add flag untuk indicate ini adalah update atau insert baru\n  vectorData.metadata.is_update = !!data.row_number;\n  \n  processedData.push(vectorData);\n  \n  console.log(`Processed: ${data.Title} (ID: ${uniqueId})`);\n}\n\nconsole.log(`Total processed: ${processedData.length} items`);\n\nreturn processedData;"
        },
        "typeVersion": 2
      },
      {
        "id": "5793e2f7-4cd9-47d4-a54c-ca426a606204",
        "name": "RAG",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          2600,
          920
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "topK": 20,
          "options": {},
          "toolName": "CompanyDocuments",
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "documents",
            "cachedResultName": "documents"
          },
          "toolDescription": "Search CompanyDocument knowledge base and business documents"
        },
        "credentials": {
          "supabaseApi": {
            "id": "rb73xq0erYUAZCau",
            "name": "REcharge"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "4d621157-f7c5-40f3-b074-9b291834d502",
        "name": "Leads",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          2880,
          920
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "topK": 20,
          "options": {},
          "toolName": "RestaurantLeads",
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "restaurant_leads",
            "cachedResultName": "restaurant_leads"
          },
          "toolDescription": "=Search restaurant leads and potential clients data"
        },
        "credentials": {
          "supabaseApi": {
            "id": "rb73xq0erYUAZCau",
            "name": "REcharge"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "a0d34cae-29ed-4bcc-960f-1c32187ed7ac",
        "name": "Embeddings OpenAI2",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          2880,
          1060
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "IWdqsaVAq1AL1S28",
            "name": "n8n - Money manager Khairul"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "92a0a539-b14a-4b12-9bdf-3f6d1b4baf5f",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3420,
          940
        ],
        "parameters": {
          "color": 5,
          "width": 1100,
          "height": 600,
          "content": "# Potential Leads Knowledge Base\n"
        },
        "typeVersion": 1
      },
      {
        "id": "ebf1d8e0-f7a2-4303-97be-07f70f4430c2",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2020,
          640
        ],
        "parameters": {
          "width": 1360,
          "height": 560,
          "content": "# Respond as a chatbot"
        },
        "typeVersion": 1
      },
      {
        "id": "23ea6d0b-c66a-4d74-8b42-b09065abeace",
        "name": "WAHA Trigger",
        "type": "@devlikeapro/n8n-nodes-waha.wahaTrigger",
        "disabled": true,
        "position": [
          1700,
          340
        ],
        "webhookId": "886de7ed-318f-4c8f-8d98-01720ddc8b82",
        "parameters": {},
        "typeVersion": 202502
      },
      {
        "id": "07c892fe-1c58-4c1e-943c-700c6bc1926d",
        "name": "AI Agent1",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2380,
          1340
        ],
        "parameters": {
          "options": {
            "systemMessage": "=# Company Business Intelligence Assistant\n\nYou are \"MinCharge\", a specialized business intelligence assistant for the company. Your primary responsibility is to provide answers exclusively based on the available knowledge sources.\n\n## Knowledge Sources\nYou have access to two critical knowledge bases:\n1. **CompanyDocuments** - Contains business documents, service guides, company information, and operational procedures\n2. **RestaurantLeads** - Contains potential restaurant client data including ratings, contact information, business details, and market insights\n\n## üö® CRITICAL: Tool Selection Protocol\n\n### MANDATORY Tool Usage Rules:\n**CompanyDocuments tool MUST be used for:**\n- ANY question about company services, capabilities, or offerings\n- Pricing inquiries (\"how much\", \"cost\", \"price\", \"fee\")\n- Company information (\"about the company\", \"what is the company\", \"company details\")\n- Business processes (\"how does the company work\", \"process\", \"procedure\")\n- Service features and benefits\n- Any question containing keywords: company, service, price, cost, business, how to, process, capability, offering\n\n**RestaurantLeads tool MUST be used for:**\n- Lead generation and prospecting requests\n- Restaurant recommendations and listings\n- Market analysis and competitive intelligence\n- Location-based restaurant queries\n- Rating, review, and business characteristic analysis\n- Contact information and outreach data\n\n### Search Strategy Hierarchy:\n1. **Company-specific queries** ‚Üí Use CompanyDocuments FIRST, always\n2. **Restaurant/lead queries** ‚Üí Use RestaurantLeads FIRST\n3. **Business intelligence/strategy** ‚Üí Use BOTH tools sequentially\n4. **Ambiguous queries** ‚Üí Default to CompanyDocuments first, then RestaurantLeads if needed\n\n## Execution Process (Follow Strictly):\n1. **Query Classification**: \n   - Identify if query mentions company, services, pricing, or company info\n   - If YES ‚Üí Immediately use CompanyDocuments tool\n   - If restaurant/lead focused ‚Üí Use RestaurantLeads tool\n   - If business strategy ‚Üí Use both tools\n\n2. **Tool Selection Verification**:\n   - Double-check that you're using the correct tool for the query type\n   - When in doubt about company-related content ‚Üí ALWAYS search CompanyDocuments\n\n3. **Search Execution**: \n   - Execute search in identified tool(s) before generating any response\n   - Use specific, relevant keywords from user query\n\n4. **Response Generation**: \n   - Base response entirely on search results\n   - Clearly cite which knowledge base provided the information\n   - Match user's language (Indonesian/English)\n\n## Core Operating Principles\n- **MANDATORY SEARCH**: Never respond without searching appropriate knowledge base first\n- **NO EXTERNAL KNOWLEDGE**: Absolutely no information from outside the knowledge bases\n- **EXPLICIT SOURCE CITATION**: Always state \"Based on CompanyDocuments...\" or \"According to RestaurantLeads...\"\n- **LANGUAGE MATCHING**: Respond in exact same language as user input\n- **ACCURACY OVER COMPLETENESS**: Better to say \"no information found\" than guess\n\n## Quality Assurance Checklist\nBefore every response, verify:\n- ‚úÖ Did I search the appropriate knowledge base?\n- ‚úÖ Is my answer based solely on search results?\n- ‚úÖ Did I cite the correct source?\n- ‚úÖ Am I responding in the user's language?\n- ‚úÖ Did I avoid using external knowledge?\n\n## Error Handling\nIf no relevant information found in knowledge bases:\n- **English**: \"I searched [specific knowledge base] but don't have information about [topic]. Could you provide more specific details or rephrase your question?\"\n- **Indonesian**: \"Saya telah mencari di [basis pengetahuan spesifik] tetapi tidak memiliki informasi tentang [topik]. Bisakah Anda memberikan detail yang lebih spesifik atau mengubah pertanyaan Anda?\"\n\n## Debugging Mode\nAlways mention in your response which tool you used:\n- \"After searching CompanyDocuments...\"\n- \"Based on my search in RestaurantLeads...\"\n- \"From both knowledge bases...\"\n\nThis helps identify if tool selection is working correctly.\n\nRemember: Your value comes from providing accurate, source-backed intelligence from the company's specific business context and restaurant lead database. Always search first, cite sources, and match the user's language."
          }
        },
        "typeVersion": 2
      },
      {
        "id": "80997c1f-4ddd-47b0-be81-bc75abd6dbfd",
        "name": "Embeddings OpenAI3",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          2580,
          1660
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "IWdqsaVAq1AL1S28",
            "name": "n8n - Money manager Khairul"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "1640e426-2920-4e77-bac4-779cb6081194",
        "name": "RAG1",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          2600,
          1520
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "topK": 20,
          "options": {},
          "toolName": "CompanyDocuments",
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "documents",
            "cachedResultName": "documents"
          },
          "useReranker": true,
          "toolDescription": "=MANDATORY TOOL for questions about: CompanyDocument services, pricing, company information, business processes, operational procedures, service capabilities, company policies, internal guidelines, and any ReCharge-specific business inquiries. Always use this tool first when users ask about ReCharge services or company information."
        },
        "credentials": {
          "supabaseApi": {
            "id": "rb73xq0erYUAZCau",
            "name": "REcharge"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "6c8f2db0-ec5b-4164-9f4a-ea36d33478e6",
        "name": "Leads1",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          2880,
          1520
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "topK": 20,
          "options": {},
          "toolName": "RestaurantLeads",
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "restaurant_leads",
            "cachedResultName": "restaurant_leads"
          },
          "useReranker": true,
          "toolDescription": "=Search restaurant leads database containing potential client information, ratings, contact details, business characteristics, location data, and market insights. Use for lead generation, market analysis, and client prospecting."
        },
        "credentials": {
          "supabaseApi": {
            "id": "rb73xq0erYUAZCau",
            "name": "REcharge"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "21d6d2c8-1ad3-455e-8171-77ed6f60f5e1",
        "name": "Embeddings OpenAI4",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          2900,
          1660
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "IWdqsaVAq1AL1S28",
            "name": "n8n - Money manager Khairul"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "2b711442-2dd0-43b7-b3a0-19a785bc0417",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2020,
          1240
        ],
        "parameters": {
          "color": 4,
          "width": 1360,
          "height": 580,
          "content": "# Send Message"
        },
        "typeVersion": 1
      },
      {
        "id": "782a8690-70f8-403f-8d59-13bf96b343d7",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          2200,
          1340
        ],
        "webhookId": "2d2ee28f-a0f6-4e3f-ace2-91558f2fae95",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "c4a980f5-681a-4d5b-bcf7-504d5b832a53",
        "name": "Chat Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
        "position": [
          2460,
          1500
        ],
        "parameters": {
          "contextWindowLength": 20
        },
        "credentials": {
          "postgres": {
            "id": "8PMGgjtS4muxnKxT",
            "name": "ReCharge Database"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "6faff427-ccc8-4747-801f-e4846460c7c5",
        "name": "Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2320,
          1500
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "IWdqsaVAq1AL1S28",
            "name": "n8n - Money manager Khairul"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "579ac8c8-359b-4297-b93b-4dff7dd41928",
        "name": "Reranker Cohere",
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "position": [
          2720,
          1660
        ],
        "parameters": {
          "modelName": "rerank-multilingual-v3.0"
        },
        "credentials": {
          "cohereApi": {
            "id": "vEf2FhO0BZLEAmaR",
            "name": "trial Cohere"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "bf15a02a-a529-4c06-8bc4-7e595cde718b",
        "name": "Reranker Cohere1",
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "position": [
          3020,
          1660
        ],
        "parameters": {
          "modelName": "rerank-multilingual-v3.0"
        },
        "credentials": {
          "cohereApi": {
            "id": "vEf2FhO0BZLEAmaR",
            "name": "trial Cohere"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "547e4f7d-737c-4819-85af-fa02e3196da9",
        "name": "Set Location",
        "type": "n8n-nodes-base.set",
        "position": [
          2300,
          180
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e80e3961-4f18-4e38-8642-4c35075f13a1",
                "name": "lokasi",
                "type": "string",
                "value": "Bali"
              }
            ]
          }
        },
        "typeVersion": 3.4
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "f96e50a9-3b2c-4de0-a80d-c5bf5cb2b336",
    "connections": {
      "RAG": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "RAG1": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Leads": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Leads1": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "small3": {
        "ai_embedding": [
          [
            {
              "node": "Supabase Vector Store2",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Webhook": {
        "main": [
          [
            {
              "node": "Get Leads",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          []
        ]
      },
      "Get Data": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          []
        ]
      },
      "Get Leads": {
        "main": [
          [
            {
              "node": "Clean Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Clean Data": {
        "main": [
          [
            {
              "node": "Update Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Result": {
        "main": [
          [
            {
              "node": "Append Leads",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Chat Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Scrape Maps": {
        "main": [
          [
            {
              "node": "Get Result",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search File": {
        "main": [
          [
            {
              "node": "Get Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Append Leads": {
        "main": [
          [
            {
              "node": "HTTP Request1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Location": {
        "main": [
          [
            {
              "node": "Scrape Maps",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "WAHA Trigger": {
        "main": [
          [],
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Supabase Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere": {
        "ai_reranker": [
          [
            {
              "node": "RAG1",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere1": {
        "ai_reranker": [
          [
            {
              "node": "Leads1",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Supabase Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "RAG",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI2": {
        "ai_embedding": [
          [
            {
              "node": "Leads",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI3": {
        "ai_embedding": [
          [
            {
              "node": "RAG1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI4": {
        "ai_embedding": [
          [
            {
              "node": "Leads1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Check Existing Data": {
        "main": [
          [
            {
              "node": "Supabase Vector Store2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Supabase Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader2": {
        "ai_document": [
          [
            {
              "node": "Supabase Vector Store2",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Google Drive Trigger": {
        "main": [
          [
            {
              "node": "Search File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres Chat Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Transform for Vector": {
        "main": [
          [
            {
              "node": "Check Existing Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets Trigger": {
        "main": [
          [
            {
              "node": "Transform for Vector",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Supabase Vector Store": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter1": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader2",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòExecute workflow‚Äô": {
        "main": [
          [
            {
              "node": "Set Location",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9"
    },
    "nodes": [
      {
        "id": "201ef455-2d65-4563-8ec1-318211b1fa6a",
        "name": "Get Message Contents",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2080,
          500
        ],
        "webhookId": "fa1d496f-17fa-4e50-bae9-84ca85ed4502",
        "parameters": {
          "simple": false,
          "options": {},
          "messageId": "={{ $json.id }}",
          "operation": "get"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "ded010af-e977-4c47-87dd-8221d601af74",
        "name": "Simplify Emails",
        "type": "n8n-nodes-base.set",
        "position": [
          2240,
          500
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "2006c806-42db-4457-84c2-35f59ed39018",
                "name": "date",
                "type": "string",
                "value": "={{ $json.date }}"
              },
              {
                "id": "872278d2-b97c-45ba-a9d3-162f154fe7dc",
                "name": "subject",
                "type": "string",
                "value": "={{ $json.subject }}"
              },
              {
                "id": "282f03e9-1d0f-4a17-b9ed-75b44171d4ee",
                "name": "text",
                "type": "string",
                "value": "={{ $json.text }}"
              },
              {
                "id": "9421776c-ff53-4490-b0e1-1e610534ba25",
                "name": "from",
                "type": "string",
                "value": "={{ $json.from.value[0].name }} ({{ $json.from.value[0].address }})"
              },
              {
                "id": "3b6716e8-5582-4da3-ae9d-e8dd1afad530",
                "name": "to",
                "type": "string",
                "value": "={{ $json.to.value[0].name }} ({{ $json.to.value[0].address }})"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "816bf787-ff9c-4b97-80ac-4b0c6ae5638b",
        "name": "Check For Upcoming Meetings",
        "type": "n8n-nodes-base.googleCalendar",
        "position": [
          526,
          -180
        ],
        "parameters": {
          "limit": 1,
          "options": {
            "orderBy": "startTime",
            "timeMax": "={{ $now.toUTC().plus(1, 'hour') }}",
            "timeMin": "={{ $now.toUTC() }}",
            "singleEvents": true
          },
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "c_5792bdf04bc395cbcbc6f7b754268245a33779d36640cc80a357711aa2f09a0a@group.calendar.google.com",
            "cachedResultName": "n8n-events"
          },
          "operation": "getAll"
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "kWMxmDbMDDJoYFVK",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "234d5c79-bf40-44bb-8829-c6ccf8648359",
        "name": "OpenAI Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          920,
          -20
        ],
        "parameters": {
          "model": "gpt-4o-2024-08-06",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "445aa0f4-d41a-4d46-aa2f-e79a9cdb04b5",
        "name": "Extract Attendee Information",
        "type": "@n8n/n8n-nodes-langchain.informationExtractor",
        "position": [
          920,
          -180
        ],
        "parameters": {
          "text": "=start: {{ $json.start.dateTime }}\nmeeting url: {{ $json.hangoutLink }}\nsummary: {{ $json.summary }}\ndescription: {{ $json.description }}\norganiser: {{ $json.organizer.displayName }} ({{ $json.organizer.email }})\nattendees: {{ $json.attendees.filter(item => !item.organizer).map(item => item.email).join(',') }}",
          "options": {
            "systemPromptTemplate": "You are an expert extraction algorithm. Try to link any information found in the description to help fill in the attendee details.\nIf you do not know the value of an attribute asked to extract, you may omit the attribute's value."
          },
          "schemaType": "manual",
          "inputSchema": "{\n\t\"type\": \"object\",\n\t\"properties\": {\n\t\t\"attendees\": {\n          \"type\": \"array\",\n          \"description\": \"list of attendees excluding the meeting organiser\",\n          \"items\": {\n\t\t\t\"type\": \"object\",\n\t\t\t\"properties\": {\n\t\t\t  \"name\": { \"type\": \"string\" },\n              \"email\": { \"type\": \"string\" },\n              \"linkedin_url\": { \"type\": \"string\" }\n\t\t\t}\n          }\n\t\t}\n\t}\n}"
        },
        "typeVersion": 1
      },
      {
        "id": "390743d8-acfd-4951-8901-212f162dcbb4",
        "name": "Execute Workflow Trigger",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          920,
          580
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "ea9c76a0-40a0-413a-a93a-ad99069d0d91",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2460,
          640
        ],
        "parameters": {
          "model": "gpt-4o-2024-08-06",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8d9df9e4-1815-44a2-a6fc-a9af42a77153",
        "name": "Get Last Correspondence",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1740,
          500
        ],
        "webhookId": "b00c960c-3689-4fa1-9f0f-7d6c9479f0c6",
        "parameters": {
          "limit": 1,
          "filters": {
            "sender": "={{ $json.email }}"
          },
          "operation": "getAll"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1,
        "alwaysOutputData": true
      },
      {
        "id": "23c7161f-60e2-4a99-9279-ff1dca5efc1c",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          4020,
          1320
        ],
        "parameters": {
          "model": "gpt-4o-2024-08-06",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9ab535aa-bd8c-4bd6-a7a0-f7182d8d7123",
        "name": "OpenAI Chat Model3",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2720,
          -20
        ],
        "parameters": {
          "model": "gpt-4o-2024-08-06",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "410acb11-a16c-4abd-9f10-7582168d100e",
        "name": "WhatsApp Business Cloud",
        "type": "n8n-nodes-base.whatsApp",
        "position": [
          3360,
          -140
        ],
        "parameters": {
          "textBody": "={{ $json.text }}",
          "operation": "send",
          "phoneNumberId": "477115632141067",
          "requestOptions": {},
          "additionalFields": {},
          "recipientPhoneNumber": "44123456789"
        },
        "credentials": {
          "whatsAppApi": {
            "id": "9SFJPeqrpChOkAmw",
            "name": "WhatsApp account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "a7e8195d-eb73-4acb-aae1-eb04f8290d24",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          180,
          -400
        ],
        "parameters": {
          "color": 7,
          "width": 616.7897454470152,
          "height": 449.1424626006906,
          "content": "## 1. Periodically Search For Upcoming Meetings\n[Read about the Scheduled Trigger](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.scheduletrigger)\n\nLet's use the Scheduled Trigger node to trigger our Assistant to notify about upcoming meetings. Here, we'll set it for 1 hour intervals to check for meetings scheduled in our Google Calendar. You may need to play with the intervals and frequency depending on how many meetings you typically have."
        },
        "typeVersion": 1
      },
      {
        "id": "1aebb209-e440-4ef2-8527-381e5e70b4ea",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          326,
          -180
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "hours"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "95758053-fcc2-45c6-96c2-ec0bf89bcb82",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          820,
          -520
        ],
        "parameters": {
          "color": 7,
          "width": 655.5654775604146,
          "height": 670.4114154200236,
          "content": "## 2. Extract Attendee Details From Invite\n[Learn more about the Information Extractor node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.information-extractor/)\n\nOnce we have our upcoming meeting, it'll be nice to prepare for it by reminding the user what the meeting is about and some context with the attendees. This will be the goal this template and of our assistant! However, first we'll need to extract some contact information of the attendees to do so.\n\nFor this demonstration, we'll assume that attendee's email and LinkedIn profile URLs are included in the meeting invite. We'll extract this information for each attendee using the Information Extractor node. This convenient node uses AI to parse and extract which saves us from writing complex pattern matching code otherwise.\n\nIn your own scenario, feel free to use your CRM to get this information instead."
        },
        "typeVersion": 1
      },
      {
        "id": "bd17aed0-9c96-4301-b09b-e61a03ebc1ac",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1500,
          -520
        ],
        "parameters": {
          "color": 7,
          "width": 1020.0959898041108,
          "height": 670.8210817031078,
          "content": "## 3. Fetch Recent Correspondance & LinkedIn Activity\n[Learn more about the Execute Workflow node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.executeworkflow)\n\nAs both email fetching and LinkedIn scraping actions are quite complex, we'll split them out as subworkflow executions. Doing so (in my honest opinion), helps with development and maintainability of the template. Here, we'll make perform the research for all applicable attendees by making 2 calls to the subworkflow and merging them back into a single node at the end.\n\nHead over to the subworkflow (see below - step 3a) to see how we pull the summaries from Gmail and LinkedIn."
        },
        "typeVersion": 1
      },
      {
        "id": "ae804039-32e0-4d2d-a2ef-a6e8d65f7ce2",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2547.540603371386,
          -440
        ],
        "parameters": {
          "color": 7,
          "width": 610.3630186140072,
          "height": 582.1201380897592,
          "content": "## 4. Generate Pre-Meeting Notification\n[Read more about the Basic LLM node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainllm)\n\nNow that we have (1) our upcoming meeting details and (2) recent email and/or Linkedin summaries about our attendee, let's feed them into our LLM node to generate the best pre-meeting notification ever seen! Of course, we'll need to keep it short as we intend to send this notification via WhatsApp message but should you choose to use another channel such as email, feel free to adjust the length of the message which suits."
        },
        "typeVersion": 1
      },
      {
        "id": "045eb1d9-fd80-4f9c-8218-ae66583d0186",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3180,
          -360
        ],
        "parameters": {
          "color": 7,
          "width": 466.8967433831988,
          "height": 454.24485615650235,
          "content": "## 5. Send Notification via WhatsApp\n[Learn more about the WhatsApp node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.whatsapp)\n\nThe WhatsApp node is a super convenient way to send messages to WhatsApp which is one of the many messaging apps supported by n8n out of the box. Not using WhatsApp? Simply swap this our for Twilio, Telegram, Slack and others."
        },
        "typeVersion": 1
      },
      {
        "id": "46d35c68-88d7-445f-9834-b8b37ce90619",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1740,
          260
        ],
        "parameters": {
          "color": 7,
          "width": 519.1145893777881,
          "height": 190.5042226526524,
          "content": "## 3.2: Fetch Last Email Correspondance\n[Learn more about Gmail node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.gmail)\n\nFetching our attendee's last email will definitely help the user \"pick up\" from when they last last off. To do this, we'll assume a Gmail user and use the Gmail node to filter messages by the attendee's email address."
        },
        "typeVersion": 1
      },
      {
        "id": "fe1c751c-4879-482b-bb6f-89df23e1faa8",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1740,
          860
        ],
        "parameters": {
          "color": 7,
          "width": 667.8619481635637,
          "height": 259.7914017217902,
          "content": "## 3.4 Scraping LinkedIn With [Apify.com](https://www.apify.com?fpr=414q6)\n[Learn more about Apify.com for Web Scraping](https://www.apify.com?fpr=414q6)\n\nTo get the attendee's recent LinkedIn activity, we'll need a webscraper capable of rendering the user's LinkedIn profile. We'll use [Apify.com](https://www.apify.com?fpr=414q6) which is a commercial web scraping service but has a very generous monthly free tier ($5/mo).\n\nWhile Apify offers a number of dedicated LinkedIn scrapers, we'll build our own which works by impersonating our own LinkedIn account using our login cookie - this can be obtained by inspecting network requests when logged into Linkedin. **Add your LinkedIn Cookie to the node below!**"
        },
        "typeVersion": 1
      },
      {
        "id": "a648cf7d-b859-4fec-8ae7-6450c70e6333",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          920,
          310
        ],
        "parameters": {
          "color": 7,
          "width": 572.0305871208889,
          "height": 231.49547088049098,
          "content": "## 3.1 Attendee Researcher SubWorkflow\n[Learn more about using Execute Workflow Trigger](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.executeworkflowtrigger/)\n\nThe Attendee Researcher SubWorkflow's aims to collect and summarize both an attendee's last correspondance  with the user (if applicable) and the attendee's LinkedIn profile (if available). It uses the router pattern to handle both branches allowing for shorter execution chains. Using the Switch node, this subworkflow is either triggered to fetch emails or scrape LinkedIn but never both simultaneously."
        },
        "typeVersion": 1
      },
      {
        "id": "8a8dbe4f-86b1-41a4-9b7e-3affdee8e524",
        "name": "Return LinkedIn Success",
        "type": "n8n-nodes-base.set",
        "position": [
          4360,
          1180
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "fc4b63a7-ad4d-49ff-9d42-715760910f6a",
                "name": "linkedin_summary",
                "type": "string",
                "value": "={{ $json.text }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "537a399b-1f78-440b-abc4-ad2e91c5950a",
        "name": "Return LinkedIn Error",
        "type": "n8n-nodes-base.set",
        "position": [
          2380,
          1320
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "bf5a0781-3bad-4f63-a49c-273b03204747",
                "name": "linkedin_summary",
                "type": "string",
                "value": "No activities found."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "a68e7df7-8467-46e2-8ea8-fcf270755d12",
        "name": "Return Email Error",
        "type": "n8n-nodes-base.set",
        "position": [
          2080,
          680
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "9a7efc9e-26b0-48c9-83aa-ae989f20b1df",
                "name": "email_summary",
                "type": "string",
                "value": "No correspondance found."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "00df2b18-22ca-48d6-b053-12fe502effc5",
        "name": "Return Email Success",
        "type": "n8n-nodes-base.set",
        "position": [
          2800,
          500
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "fc4b63a7-ad4d-49ff-9d42-715760910f6a",
                "name": "email_summary",
                "type": "object",
                "value": "={{ $json.text }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "cdae9f9f-11c0-4f26-9ba1-5d5ed279ebfc",
        "name": "Set Route Email",
        "type": "n8n-nodes-base.set",
        "position": [
          1600,
          -260
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "={{ Object.assign({ \"route\": \"email\" }, $json) }}"
        },
        "typeVersion": 3.4
      },
      {
        "id": "b01371f6-8871-4ad9-866d-888e22e7908e",
        "name": "Set Route Linkedin",
        "type": "n8n-nodes-base.set",
        "position": [
          1600,
          -100
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "={{ Object.assign({ \"route\": \"linkedin\" }, $json) }}"
        },
        "typeVersion": 3.4
      },
      {
        "id": "c4907171-b239-46a6-a0b0-6bf66570005f",
        "name": "Router",
        "type": "n8n-nodes-base.switch",
        "position": [
          1100,
          580
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "email",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.route }}",
                      "rightValue": "email"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "linkedin",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "ba71a258-de67-4f61-a24a-33c86bd4c4f5",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.route }}",
                      "rightValue": "linkedin"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "45554355-57ad-464d-b768-5b00d707fc58",
        "name": "Return LinkedIn Error1",
        "type": "n8n-nodes-base.set",
        "position": [
          1440,
          870
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "bf5a0781-3bad-4f63-a49c-273b03204747",
                "name": "linkedin_summary",
                "type": "string",
                "value": "No activities found."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "05b04c17-eeeb-42f2-8d94-bc848889f17c",
        "name": "Has Emails?",
        "type": "n8n-nodes-base.if",
        "position": [
          1900,
          500
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "ff11640a-33e4-4695-a62c-7dcab57f0ae5",
                "operator": {
                  "type": "object",
                  "operation": "empty",
                  "singleValue": true
                },
                "leftValue": "={{ $json }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "c24aca66-6222-46ae-bb9b-1838b01f3100",
        "name": "Return Email Error1",
        "type": "n8n-nodes-base.set",
        "position": [
          1440,
          700
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "9a7efc9e-26b0-48c9-83aa-ae989f20b1df",
                "name": "email_summary",
                "type": "string",
                "value": "No correspondance found."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "22f3ccbf-19a2-4ca5-ba23-f91963b52c0a",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2560,
          920
        ],
        "parameters": {
          "color": 7,
          "width": 682.7350931085596,
          "height": 219.59936012669806,
          "content": "## 3.5: Extract LinkedIn Profile & Recent Activity\n[Learn more about the HTML node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.html)\n\nOnce we have our scraped LinkedIn profile, it's just a simple case of parsing and extracting the relevant sections from the page.\nFor the purpose of our workflow, we'll only need the \"About\" and \"Activity\" sections which we'll pull out of the page using a series of HTML nodes. Feel free to extract other sections to suit your needs! Once extracted, we'll combine the about and activities data in preparation of sending it to our LLM."
        },
        "typeVersion": 1
      },
      {
        "id": "49b1fc8f-1259-4596-84b0-b37fae1c098c",
        "name": "Sections To List",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          2720,
          1180
        ],
        "parameters": {
          "options": {
            "destinationFieldName": "data"
          },
          "fieldToSplitOut": "sections"
        },
        "typeVersion": 1
      },
      {
        "id": "875b278d-44c6-4315-87e3-459a90799a9b",
        "name": "Set LinkedIn Cookie",
        "type": "n8n-nodes-base.set",
        "position": [
          1800,
          1180
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b4354c00-cc1a-4a55-8b44-6ba4854cc6ba",
                "name": "linkedin_profile_url",
                "type": "string",
                "value": "={{ $json.linkedin_url }}"
              },
              {
                "id": "4888db89-2573-4246-8ab9-c106a7fe5f38",
                "name": "linkedin_cookies",
                "type": "string",
                "value": "<COPY_YOUR_LINKEDIN_COOKIES_HERE>"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "91da49ab-86a1-4539-b673-106b9edaeae9",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1400,
          1240
        ],
        "parameters": {
          "color": 3,
          "width": 308.16846950517856,
          "height": 110.18457997698513,
          "content": "### Be aware of LinkedIn T&Cs!\nFor production, you may want to consider not using your main Linkedin account if you can help it!"
        },
        "typeVersion": 1
      },
      {
        "id": "7abd390f-36a6-49af-b190-5bb720bd2ae8",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1740,
          1152
        ],
        "parameters": {
          "width": 209.84856156501735,
          "height": 301.5806674338321,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n### üö® Input Required!\nYou need to add your cuurent linkedIn Cookies here to continue."
        },
        "typeVersion": 1
      },
      {
        "id": "40dfb438-76c2-40b5-8945-94dcf7cafcf7",
        "name": "Attendees to List",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1260,
          -180
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "output.attendees"
        },
        "typeVersion": 1
      },
      {
        "id": "cc7f8416-6ea1-4425-a320-3f8217d2ad4e",
        "name": "Merge Attendee with Summaries",
        "type": "n8n-nodes-base.set",
        "position": [
          2160,
          -180
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "={{ Object.assign({}, $('Attendees to List').item.json, $json) }}"
        },
        "typeVersion": 3.4
      },
      {
        "id": "459c5f2b-5dd5-491f-8bed-475ae5af7ac0",
        "name": "Has Email Address?",
        "type": "n8n-nodes-base.if",
        "position": [
          1280,
          580
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "1382e335-bfae-4665-a2ee-a05496a7b463",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.email }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "610e9849-f06c-4534-a269-d1982dcab259",
        "name": "Has LinkedIn URL?",
        "type": "n8n-nodes-base.if",
        "position": [
          1280,
          750
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "1382e335-bfae-4665-a2ee-a05496a7b463",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.linkedin_url }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "43e5192e-c1b0-4d71-8d0e-aa466aa9930c",
        "name": "Get Correspondance",
        "type": "n8n-nodes-base.executeWorkflow",
        "onError": "continueRegularOutput",
        "position": [
          1780,
          -260
        ],
        "parameters": {
          "mode": "each",
          "options": {
            "waitForSubWorkflow": true
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "4662f928-d38b-42e1-8a70-5676eb638ce1",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          2000,
          -180
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "3eaf5d5b-d99c-4f9f-beaa-53b859bf482e",
        "name": "Aggregate Attendees",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          2340,
          -180
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData",
          "destinationFieldName": "attendees"
        },
        "typeVersion": 1
      },
      {
        "id": "752afdd3-0561-4e53-8b18-391741a2f43b",
        "name": "Activities To Array",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          3680,
          1360
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData",
          "destinationFieldName": "activity"
        },
        "typeVersion": 1
      },
      {
        "id": "a35dc751-62a0-4f5c-92cb-2801d060c613",
        "name": "Extract Profile Metadata",
        "type": "n8n-nodes-base.html",
        "position": [
          2560,
          1180
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "dataPropertyName": "body",
          "extractionValues": {
            "values": [
              {
                "key": "name",
                "cssSelector": "h1"
              },
              {
                "key": "tagline",
                "cssSelector": ".pv-text-details__left-panel--full-width .text-body-medium"
              },
              {
                "key": "location",
                "cssSelector": ".pv-text-details__left-panel--full-width + div .text-body-small"
              },
              {
                "key": "num_connections",
                "cssSelector": "a[href=\"/mynetwork/invite-connect/connections/\"]"
              },
              {
                "key": "num_followers",
                "cssSelector": "a[href=\"https://www.linkedin.com/feed/followers/\"]"
              },
              {
                "key": "sections",
                "cssSelector": "section[data-view-name]",
                "returnArray": true,
                "returnValue": "html"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "5685ec9f-c219-41b4-94d7-787daef8a628",
        "name": "Activities To List",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          3360,
          1360
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "activity"
        },
        "typeVersion": 1
      },
      {
        "id": "71240827-3e0d-4276-afb0-9ed72878ea4c",
        "name": "APIFY Web Scraper",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2000,
          1180
        ],
        "parameters": {
          "url": "https://api.apify.com/v2/acts/apify~web-scraper/run-sync-get-dataset-items",
          "options": {},
          "jsonBody": "={\n  \"startUrls\": [\n    {\n      \"url\": \"{{ $json.linkedin_profile_url }}\",\n      \"method\": \"GET\"\n    }\n  ],\n  \"initialCookies\": [\n    {\n      \"name\": \"li_at\",\n      \"value\": \"{{ $json.linkedin_cookies.match(/li_at=([^;]+)/)[1] }}\",\n      \"domain\": \".www.linkedin.com\"\n    }\n  ],\n  \"breakpointLocation\": \"NONE\",\n  \"browserLog\": false,\n  \"closeCookieModals\": false,\n  \"debugLog\": false,\n  \"downloadCss\": false,\n  \"downloadMedia\": false,\n  \"excludes\": [\n    {\n      \"glob\": \"/**/*.{png,jpg,jpeg,pdf}\"\n    }\n  ],\n  \"headless\": true,\n  \"ignoreCorsAndCsp\": false,\n  \"ignoreSslErrors\": false,\n  \n  \"injectJQuery\": true,\n  \"keepUrlFragments\": false,\n  \"linkSelector\": \"a[href]\",\n  \"maxCrawlingDepth\": 1,\n  \"maxPagesPerCrawl\": 1,\n  \"maxRequestRetries\": 1,\n  \"maxResultsPerCrawl\": 1,\n  \"pageFunction\": \"// The function accepts a single argument: the \\\"context\\\" object.\\n// For a complete list of its properties and functions,\\n// see https://apify.com/apify/web-scraper#page-function \\nasync function pageFunction(context) {\\n\\n    await new Promise(res => { setTimeout(res, 6000) });\\n    // This statement works as a breakpoint when you're trying to debug your code. Works only with Run mode: DEVELOPMENT!\\n    // debugger; \\n\\n    // jQuery is handy for finding DOM elements and extracting data from them.\\n    // To use it, make sure to enable the \\\"Inject jQuery\\\" option.\\n    const $ = context.jQuery;\\n    const title = $('title').first().text();\\n\\n    // Clone the body to avoid modifying the original content\\n    const bodyClone = $('body').clone();\\n    bodyClone.find('iframe, img, script, style, object, embed, noscript, svg, video, audio').remove();\\n    const body = bodyClone.html();\\n\\n    // Return an object with the data extracted from the page.\\n    // It will be stored to the resulting dataset.\\n    return {\\n        url: context.request.url,\\n        title,\\n        body\\n    };\\n}\",\n  \"postNavigationHooks\": \"// We need to return array of (possibly async) functions here.\\n// The functions accept a single argument: the \\\"crawlingContext\\\" object.\\n[\\n    async (crawlingContext) => {\\n        // ...\\n    },\\n]\",\n  \"preNavigationHooks\": \"// We need to return array of (possibly async) functions here.\\n// The functions accept two arguments: the \\\"crawlingContext\\\" object\\n// and \\\"gotoOptions\\\".\\n[\\n    async (crawlingContext, gotoOptions) => {\\n        // ...\\n    },\\n]\\n\",\n  \"proxyConfiguration\": {\n    \"useApifyProxy\": true\n  },\n  \"runMode\": \"PRODUCTION\",\n  \n  \"useChrome\": false,\n  \"waitUntil\": [\n    \"domcontentloaded\"\n  ],\n  \"globs\": [],\n  \"pseudoUrls\": [],\n  \"proxyRotation\": \"RECOMMENDED\",\n  \"maxConcurrency\": 50,\n  \"pageLoadTimeoutSecs\": 60,\n  \"pageFunctionTimeoutSecs\": 60,\n  \"maxScrollHeightPixels\": 5000,\n  \"customData\": {}\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpQueryAuth"
        },
        "credentials": {
          "httpQueryAuth": {
            "id": "cO2w8RDNOZg8DRa8",
            "name": "Apify API"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "01659121-44f9-4d53-b973-cea29a8b0301",
        "name": "Get Activity Details",
        "type": "n8n-nodes-base.html",
        "position": [
          3520,
          1360
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "dataPropertyName": "activity",
          "extractionValues": {
            "values": [
              {
                "key": "header",
                "attribute": "aria-label",
                "cssSelector": ".feed-mini-update-optional-navigation-context-wrapper",
                "returnValue": "attribute"
              },
              {
                "key": "url",
                "attribute": "href",
                "cssSelector": ".feed-mini-update-optional-navigation-context-wrapper",
                "returnValue": "attribute"
              },
              {
                "key": "content",
                "cssSelector": ".inline-show-more-text--is-collapsed"
              },
              {
                "key": "num_reactions",
                "cssSelector": ".social-details-social-counts__reactions-count"
              },
              {
                "key": "num_comments",
                "cssSelector": ".social-details-social-counts__comments"
              },
              {
                "key": "num_reposts",
                "cssSelector": ".social-details-social-counts__item--truncate-text"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "420a3a3e-ca99-49fb-b6b7-e9757f27b5d4",
        "name": "Get Sections",
        "type": "n8n-nodes-base.html",
        "position": [
          2880,
          1180
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {
                "key": "title",
                "cssSelector": "h2 [aria-hidden=true]"
              },
              {
                "key": "content",
                "cssSelector": "*",
                "returnValue": "html"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4983c987-79a7-4725-9913-630a71608f41",
        "name": "Get About Section",
        "type": "n8n-nodes-base.set",
        "position": [
          3040,
          1180
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "79d7943f-45a5-456c-a15b-cef53903409d",
                "name": "html",
                "type": "string",
                "value": "={{\n$input.all()\n  .find(input => input.json.title.toLowerCase().trim() === 'about')\n  .json\n  .content\n}}"
              }
            ]
          }
        },
        "executeOnce": true,
        "typeVersion": 3.4
      },
      {
        "id": "0e8bed5b-a622-4dbd-a11e-24df5d68f038",
        "name": "Get Activity Section",
        "type": "n8n-nodes-base.set",
        "position": [
          3040,
          1360
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "79d7943f-45a5-456c-a15b-cef53903409d",
                "name": "html",
                "type": "string",
                "value": "={{\n$input.all()\n  .find(input => input.json.title.toLowerCase().trim() === 'activity')\n  .json\n  .content\n}}"
              }
            ]
          }
        },
        "executeOnce": true,
        "typeVersion": 3.4
      },
      {
        "id": "5dd2677f-a4fc-447f-af7d-28e90dda46e8",
        "name": "Extract Activities",
        "type": "n8n-nodes-base.html",
        "position": [
          3200,
          1360
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "dataPropertyName": "html",
          "extractionValues": {
            "values": [
              {
                "key": "activity",
                "cssSelector": ".profile-creator-shared-feed-update__mini-container",
                "returnArray": true,
                "returnValue": "html"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "1a32808f-e465-47ef-b8bd-52b19c26ff1a",
        "name": "Merge1",
        "type": "n8n-nodes-base.merge",
        "position": [
          3860,
          1180
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "6e452337-55a3-4466-a094-ec9106b36498",
        "name": "Is Scrape Successful?",
        "type": "n8n-nodes-base.if",
        "position": [
          2180,
          1180
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "3861abc7-7699-4459-b983-0c8b33e090b5",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.body }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "51a79d99-46af-4951-a99e-64f1d59f556e",
        "name": "Extract About",
        "type": "n8n-nodes-base.html",
        "position": [
          3200,
          1180
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "dataPropertyName": "html",
          "extractionValues": {
            "values": [
              {
                "key": "about",
                "cssSelector": "body"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "d943fbde-f8fc-42b1-8b7e-f73735b81394",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3860,
          940
        ],
        "parameters": {
          "color": 7,
          "width": 508.12647286359606,
          "height": 212.26880753952497,
          "content": "## 3.6 Summarize LinkedIn For Attendee\n[Read more about the Basic LLM node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainllm)\n\nFinally, we'll use the Basic LLM node to summarize our attendee's LinkedIn profile and recent activity. Our goal here is to identify and send back interesting tidbits of information which may be relevant to the meeting as well as inform the user. Should you require different criteria, simply edit the summarizer to get the response you need."
        },
        "typeVersion": 1
      },
      {
        "id": "b64bbfb0-ebd6-4fe7-9c02-3c1b72407df5",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2460,
          270
        ],
        "parameters": {
          "color": 7,
          "width": 593.8676556715506,
          "height": 196.6490014749014,
          "content": "## 3.3: Summarize Correspondance For Attendee\n[Read more about the Basic LLM node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.chainllm)\n\nNext, we'll generate a shorter version of the email(s) using the Basic LLM node - useful if the email was part of a large chain. The goal here is, if applicable, to remind the user of the conversion with this attendee and highlight any expectations which might be set before going into the meeting."
        },
        "typeVersion": 1
      },
      {
        "id": "a2dd5060-dd12-463b-8bbe-327ed691bdb9",
        "name": "Get LinkedIn Profile & Activity",
        "type": "n8n-nodes-base.executeWorkflow",
        "onError": "continueRegularOutput",
        "position": [
          1780,
          -100
        ],
        "parameters": {
          "mode": "each",
          "options": {
            "waitForSubWorkflow": true
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "fde0fa35-e692-4ca9-83ef-14e527f2f8d2",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -320,
          -660
        ],
        "parameters": {
          "width": 453.4804561790962,
          "height": 588.3011632094225,
          "content": "## Try It Out!\n\n### This workflow builds an AI meeting assistant who sends information-dense pre-meeting notifications for a user's upcoming meetings. This template is ideal for busy professional who is constantly on the move and wants to save time and make an impression.\n\n### How It Works\n* A scheduled trigger fires hourly and checks for upcoming meetings within the hour.\n* When found, a search for last correspondence and LinkedIn profile + recent activity is performed for each attendee.\n* Using both available correspondance and/or Linkedin profile, an AI/LLM is used to summarize this information and generate a short notification message which should help the user prepare for the meeting.\n* The notification is finally sent to the user's WhatsApp.\n\n### Need Help?\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!\n\nHappy Hacking!"
        },
        "typeVersion": 1
      },
      {
        "id": "f2f19824-9865-465b-a612-7d3215209c79",
        "name": "Correspondance Recap Agent",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          2460,
          500
        ],
        "parameters": {
          "text": "=from: {{ $json.from }}\nto: {{ $json.to }}\ndate: {{ $json.date }}\nsubject: {{ $json.subject }}\ntext:\n{{ $json.text }}",
          "messages": {
            "messageValues": [
              {
                "message": "=You are helping the \"to\" user recap the last correspondance they had in this email thread. Summarize succiently what was discussed, changed or agreed to help the user prepare for their upcoming meeting."
              }
            ]
          },
          "promptType": "define"
        },
        "typeVersion": 1.4
      },
      {
        "id": "42641933-edf6-4b01-a17f-8cda2be7a093",
        "name": "Attendee Research Agent",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          2720,
          -180
        ],
        "parameters": {
          "text": "=meeting date: {{ $('Check For Upcoming Meetings').item.json.start.dateTime }}\nmeeting url: {{ $('Check For Upcoming Meetings').item.json.hangoutLink }}\nmeeting summary: {{ $('Check For Upcoming Meetings').first().json.summary }}\nmeeting description: {{ $('Check For Upcoming Meetings').item.json.description }}\nmeeting with: {{ $json.attendees.map(item => item.name).join(',') }}\n---\n{{\n$json.attendees.map(item => {\n  return\n`attendee name: ${item.name}\n${item.name}'s last correspondance: ${item.email_summary.replaceAll('\\n', ' ') || `We have not had any correspondance with ${item.name}`}\n${item.name}'s linkedin profile: ${item.linkedin_summary.replaceAll('\\n', ' ') || `We were unable to find the linkedin profile for ${$json.name}`}\n`\n}).join('\\n---\\n')\n}}",
          "messages": {
            "messageValues": [
              {
                "message": "=You are a personal meeing assistant.\nYou are helping to remind user of an upcoming meeting with {{ $json.attendees.map(item => item.name).join(',') }} (aka \"the attendee(s)\"}. You will structure your notification using the following guidance:\n1. Start by providing the meeting summary, mentioning the date, with whom and providing the meeting link.\n2. For each attendee, give a short bullet point summary of their last correspondance. Assess if the correspondance has any relevance to the meeting and if so, identify any important todos or items which should be mentioned during the meeting. Additionally, give a short bullet point summary of attendee's recent activity which makes for good talking points. These need not be relevant to the meeting.\n\nWrite your response in a casual tone as if sending a SMS message to the user. USe bullet points where appropriate."
              }
            ]
          },
          "promptType": "define"
        },
        "typeVersion": 1.4
      },
      {
        "id": "1916515d-8b85-4da9-ac17-1c08485cdf04",
        "name": "LinkedIn Summarizer Agent",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          4020,
          1180
        ],
        "parameters": {
          "text": "=### name\n{{ $('Extract Profile Metadata').item.json.name }}\n### about\n\"{{ $('Extract Profile Metadata').item.json.tagline }}\"\n{{ $json.about.replaceAll('\\n', ' ')}}\n### recent activity\n{{\n$json.activity.map((item, idx) => {\n  return [\n    item.header.replace('View full post.', ''),\n    `(${item.url})`,\n    ' - ',\n    item.content.replaceAll('\\n', ' ').replaceAll('‚Ä¶show more', '')\n  ].join(' ')\n}).join('\\n---\\n')\n}}",
          "messages": {
            "messageValues": [
              {
                "message": "=Summarize briefly the person and their recent activities as seen in the given feed and highlight noteworthy awards or achievements which make for good talking points."
              }
            ]
          },
          "promptType": "define"
        },
        "typeVersion": 1.4
      }
    ],
    "pinData": {},
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Merge Attendee with Summaries",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge1": {
        "main": [
          [
            {
              "node": "LinkedIn Summarizer Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Router": {
        "main": [
          [
            {
              "node": "Has Email Address?",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Has LinkedIn URL?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Has Emails?": {
        "main": [
          [
            {
              "node": "Get Message Contents",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Return Email Error",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Sections": {
        "main": [
          [
            {
              "node": "Get About Section",
              "type": "main",
              "index": 0
            },
            {
              "node": "Get Activity Section",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract About": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Route Email": {
        "main": [
          [
            {
              "node": "Get Correspondance",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simplify Emails": {
        "main": [
          [
            {
              "node": "Correspondance Recap Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Check For Upcoming Meetings",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Sections To List": {
        "main": [
          [
            {
              "node": "Get Sections",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "APIFY Web Scraper": {
        "main": [
          [
            {
              "node": "Is Scrape Successful?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Attendees to List": {
        "main": [
          [
            {
              "node": "Set Route Email",
              "type": "main",
              "index": 0
            },
            {
              "node": "Set Route Linkedin",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get About Section": {
        "main": [
          [
            {
              "node": "Extract About",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Has LinkedIn URL?": {
        "main": [
          [
            {
              "node": "Set LinkedIn Cookie",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Return LinkedIn Error1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Correspondance Recap Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Activities To List": {
        "main": [
          [
            {
              "node": "Get Activity Details",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Activities": {
        "main": [
          [
            {
              "node": "Activities To List",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Correspondance": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Has Email Address?": {
        "main": [
          [
            {
              "node": "Get Last Correspondence",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Return Email Error1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "LinkedIn Summarizer Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Extract Attendee Information",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "Attendee Research Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Set Route Linkedin": {
        "main": [
          [
            {
              "node": "Get LinkedIn Profile & Activity",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Activities To Array": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Aggregate Attendees": {
        "main": [
          [
            {
              "node": "Attendee Research Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set LinkedIn Cookie": {
        "main": [
          [
            {
              "node": "APIFY Web Scraper",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Activity Details": {
        "main": [
          [
            {
              "node": "Activities To Array",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Activity Section": {
        "main": [
          [
            {
              "node": "Extract Activities",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Message Contents": {
        "main": [
          [
            {
              "node": "Simplify Emails",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Scrape Successful?": {
        "main": [
          [
            {
              "node": "Extract Profile Metadata",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Return LinkedIn Error",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Attendee Research Agent": {
        "main": [
          [
            {
              "node": "WhatsApp Business Cloud",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Last Correspondence": {
        "main": [
          [
            {
              "node": "Has Emails?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Workflow Trigger": {
        "main": [
          [
            {
              "node": "Router",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Profile Metadata": {
        "main": [
          [
            {
              "node": "Sections To List",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "LinkedIn Summarizer Agent": {
        "main": [
          [
            {
              "node": "Return LinkedIn Success",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Correspondance Recap Agent": {
        "main": [
          [
            {
              "node": "Return Email Success",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check For Upcoming Meetings": {
        "main": [
          [
            {
              "node": "Extract Attendee Information",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Attendee Information": {
        "main": [
          [
            {
              "node": "Attendees to List",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge Attendee with Summaries": {
        "main": [
          [
            {
              "node": "Aggregate Attendees",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get LinkedIn Profile & Activity": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      }
    }
  },
  {
    "id": "o907NaeC17Uw78Jv",
    "meta": {
      "instanceId": "fd8840506e6bace33d111a4e4035f23db50a2ddf7734869f63585dee254fba7e"
    },
    "name": "Sales Order Prioritization Based on Customer SLA",
    "tags": [],
    "nodes": [
      {
        "id": "fed36f3d-9961-48ce-b978-016bd12a8454",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          272,
          1280
        ],
        "parameters": {
          "width": 352,
          "height": 800,
          "content": "## Overview\nAutomates sales order prioritization using customer SLA tiers, urgency, value, and margin. Critical orders trigger immediate alerts & tasks; normal orders are batched, scheduled, dispatched, and reported.\n\n## How it works\n1. **Trigger** every 15 min ‚Üí fetch pending orders.\n2. **Enrich** with SLA data ‚Üí calculate priority scores.\n3. **Branch**: critical ‚Üí urgent task + alert; else ‚Üí batch & schedule.\n4. **Schedule** picking/dispatch ‚Üí update ERP ‚Üí send summary.\n\n## Setup steps\n1. Replace all `https://your-*.com` URLs with real endpoints.\n2. Add API credentials (header auth shown for alerts).\n3. Adjust batch size, weights, or scheduling logic in Code nodes if needed.\n4. Activate workflow.\n\n(‚âà180 words)"
        },
        "typeVersion": 1
      },
      {
        "id": "db57d111-77d4-4199-9285-5af954bd0049",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          816,
          1504
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "cronExpression",
                "expression": "*/15 * * * *"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "867bf758-971b-4450-97e5-26e77489d626",
        "name": "Fetch Pending Orders",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1040,
          1504
        ],
        "parameters": {
          "url": "https://your-erp.com/api/orders",
          "options": {},
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "status",
                "value": "pending,confirmed"
              },
              {
                "name": "limit",
                "value": "100"
              }
            ]
          }
        },
        "typeVersion": 4.1
      },
      {
        "id": "096bd3fd-85cc-4449-8837-14be45277738",
        "name": "Fetch Customer SLA Data",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1264,
          1504
        ],
        "parameters": {
          "url": "https://your-erp.com/api/customers/batch",
          "method": "POST",
          "options": {},
          "jsonBody": "={{ { \"customer_ids\": $json.orders.map(o => o.customer_id) } }}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.1
      },
      {
        "id": "5b32443d-c53a-4ebe-b6c9-6efc2f9d9248",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1232,
          1344
        ],
        "parameters": {
          "color": 5,
          "width": 630,
          "height": 384,
          "content": "üë• pending orders Retrieves customer SLA tiers Delivery timeframes & priorities than\nüéØ Calculates priority scores Urgency 40% + Tier 30% + Value 20% + Margin 10% after we get calculates ‚ö†Ô∏è Identifies critical orders\nSLA breach = Immediate action"
        },
        "typeVersion": 1
      },
      {
        "id": "6b358de4-cb68-4d1b-87be-1b19f3b239a5",
        "name": "Calculate Priority Scores",
        "type": "n8n-nodes-base.code",
        "position": [
          1488,
          1504
        ],
        "parameters": {
          "jsCode": "const ordersData = $input.all()[0].json;\nconst customersData = $input.all()[1].json;\n\nconst customerSLAMap = {};\nif (customersData.customers) {\n  customersData.customers.forEach(customer => {\n    customerSLAMap[customer.customer_id] = {\n      sla_tier: customer.sla_tier || 'bronze',\n      delivery_days: customer.delivery_days || 7,\n      priority_multiplier: customer.priority_multiplier || 1,\n      profit_margin: customer.profit_margin || 20\n    };\n  });\n}\n\nconst tierWeights = {\n  'platinum': 100,\n  'gold': 75,\n  'silver': 50,\n  'bronze': 25,\n  'standard': 10\n};\n\nconst enrichedOrders = ordersData.orders.map(order => {\n  const customerSLA = customerSLAMap[order.customer_id] || {\n    sla_tier: 'bronze',\n    delivery_days: 7,\n    priority_multiplier: 1,\n    profit_margin: 20\n  };\n  \n  const orderDate = new Date(order.created_at);\n  const slaDeadline = new Date(orderDate);\n  slaDeadline.setDate(slaDeadline.getDate() + customerSLA.delivery_days);\n  const daysUntilBreach = Math.ceil((slaDeadline - new Date()) / (1000 * 60 * 60 * 24));\n  \n  const urgencyScore = daysUntilBreach <= 0 ? 1000 : (100 / Math.max(daysUntilBreach, 1));\n  const tierScore = tierWeights[customerSLA.sla_tier.toLowerCase()] || 10;\n  const valueScore = Math.min((order.total_amount || 0) / 100, 100);\n  const marginScore = (customerSLA.profit_margin || 20);\n  \n  const priorityScore = Math.round(\n    (urgencyScore * 0.4) + \n    (tierScore * 0.3) + \n    (valueScore * 0.2) + \n    (marginScore * 0.1)\n  ) * customerSLA.priority_multiplier;\n  \n  let urgencyLevel = 'normal';\n  if (daysUntilBreach <= 0) urgencyLevel = 'critical';\n  else if (daysUntilBreach <= 1) urgencyLevel = 'urgent';\n  else if (daysUntilBreach <= 2) urgencyLevel = 'high';\n  \n  return {\n    ...order,\n    sla_info: {\n      tier: customerSLA.sla_tier,\n      delivery_days: customerSLA.delivery_days,\n      deadline: slaDeadline.toISOString(),\n      days_until_breach: daysUntilBreach,\n      urgency_level: urgencyLevel\n    },\n    scoring: {\n      priority_score: priorityScore,\n      urgency_score: Math.round(urgencyScore),\n      tier_score: tierScore,\n      value_score: Math.round(valueScore),\n      margin_score: marginScore\n    },\n    profit_margin: customerSLA.profit_margin\n  };\n});\n\nenrichedOrders.sort((a, b) => b.scoring.priority_score - a.scoring.priority_score);\n\nreturn enrichedOrders.map(order => ({ json: order }));"
        },
        "typeVersion": 2
      },
      {
        "id": "b602f629-fbac-49a4-86d5-9281da31e1ca",
        "name": "Check if SLA Critical",
        "type": "n8n-nodes-base.if",
        "position": [
          1712,
          1504
        ],
        "parameters": {
          "conditions": {
            "number": [
              {
                "value1": "={{ $json.sla_info.days_until_breach }}",
                "operation": "smallerEqual"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5cba1751-15e4-4d4c-bcfd-c28cae3db6f6",
        "name": "Create Urgent Picking Task",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1936,
          1408
        ],
        "parameters": {
          "url": "https://your-wms.com/api/picking-tasks/urgent",
          "method": "POST",
          "options": {},
          "jsonBody": "={{ {\n  \"order_id\": $json.order_id,\n  \"priority\": \"critical\",\n  \"sla_deadline\": $json.sla_info.deadline,\n  \"customer_tier\": $json.sla_info.tier,\n  \"items\": $json.items,\n  \"warehouse_location\": $json.warehouse_id || \"MAIN\",\n  \"notes\": \"URGENT: SLA breach in \" + $json.sla_info.days_until_breach + \" days\",\n  \"assign_to\": \"senior_picker\",\n  \"auto_schedule\": true\n} }}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.1
      },
      {
        "id": "f1e04e3e-af01-4dc5-966d-c263901fa1f0",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1888,
          1280
        ],
        "parameters": {
          "color": 7,
          "width": 438,
          "height": 320,
          "content": "üö® Creates urgent task Assign to senior picker immediately tha üì± Alerts manager via SMS + Email High priority notification"
        },
        "typeVersion": 1
      },
      {
        "id": "de7fa61a-28ee-4f68-8d31-d4dc5167d69a",
        "name": "Alert Warehouse Manager",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2160,
          1408
        ],
        "parameters": {
          "url": "https://your-notification-service.com/api/send",
          "method": "POST",
          "options": {},
          "jsonBody": "={{ {\n  \"channel\": \"sms,email\",\n  \"recipient\": \"warehouse-manager@company.com\",\n  \"priority\": \"high\",\n  \"subject\": \"üö® CRITICAL SLA Alert - \" + $json.order_id,\n  \"body\": \"Critical order! Order: \" + $json.order_id + \" | Tier: \" + $json.sla_info.tier + \" | Breach: \" + Math.abs($json.sla_info.days_until_breach) + \" days | Value: $\" + $json.total_amount\n} }}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "typeVersion": 4.1
      },
      {
        "id": "3f2ee818-d814-4520-86e2-1d3caf5a4f86",
        "name": "Batch Normal Orders",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          1936,
          1872
        ],
        "parameters": {
          "options": {},
          "batchSize": 10
        },
        "typeVersion": 3
      },
      {
        "id": "599c9d46-8038-4aa8-a12a-eae69c7a95d0",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1888,
          1680
        ],
        "parameters": {
          "color": 2,
          "width": 422,
          "height": 352,
          "content": "üì¶ Batches orders in groups of 10 Optimizes processing after execution üìÖ Smart scheduling by urgency High: 4hrs | Normal: Today | Low: 2-3 days"
        },
        "typeVersion": 1
      },
      {
        "id": "a987eb38-c86a-4fe5-b34e-2c0c41cc6031",
        "name": "Generate Picking Schedule",
        "type": "n8n-nodes-base.code",
        "position": [
          2176,
          1872
        ],
        "parameters": {
          "jsCode": "const items = $input.all();\nconst ordersByUrgency = {\n  high: [],\n  normal: [],\n  low: []\n};\n\nitems.forEach(item => {\n  const order = item.json;\n  const urgency = order.sla_info.urgency_level;\n  \n  if (urgency === 'high' || urgency === 'urgent') {\n    ordersByUrgency.high.push(order);\n  } else if (order.sla_info.days_until_breach <= 4) {\n    ordersByUrgency.normal.push(order);\n  } else {\n    ordersByUrgency.low.push(order);\n  }\n});\n\nconst now = new Date();\nconst schedules = [];\n\nordersByUrgency.high.forEach((order, index) => {\n  const scheduledTime = new Date(now.getTime() + (index * 30 * 60000));\n  schedules.push({\n    ...order,\n    scheduled_time: scheduledTime.toISOString(),\n    time_slot: 'high_priority',\n    estimated_pick_duration: 45\n  });\n});\n\nordersByUrgency.normal.forEach((order, index) => {\n  const scheduledTime = new Date(now.getTime() + ((index + 8) * 60 * 60000));\n  schedules.push({\n    ...order,\n    scheduled_time: scheduledTime.toISOString(),\n    time_slot: 'normal',\n    estimated_pick_duration: 30\n  });\n});\n\nordersByUrgency.low.forEach((order, index) => {\n  const scheduledTime = new Date(now.getTime() + ((index + 24) * 60 * 60000));\n  schedules.push({\n    ...order,\n    scheduled_time: scheduledTime.toISOString(),\n    time_slot: 'standard',\n    estimated_pick_duration: 30\n  });\n});\n\nreturn [{ json: { \n  schedules: schedules, \n  summary: {\n    total_orders: schedules.length,\n    high_priority: ordersByUrgency.high.length,\n    normal_priority: ordersByUrgency.normal.length,\n    low_priority: ordersByUrgency.low.length\n  }\n}}];"
        },
        "typeVersion": 2
      },
      {
        "id": "aff8f182-17c2-4762-943e-ebc7b7cfc1cb",
        "name": "Create Bulk Picking Tasks",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2384,
          1600
        ],
        "parameters": {
          "url": "https://your-wms.com/api/picking-tasks/bulk",
          "method": "POST",
          "options": {},
          "jsonBody": "={{ {\n  \"tasks\": $json.schedules.map(order => ({\n    order_id: order.order_id,\n    customer_id: order.customer_id,\n    priority: order.sla_info.urgency_level,\n    scheduled_time: order.scheduled_time,\n    estimated_duration: order.estimated_pick_duration,\n    sla_deadline: order.sla_info.deadline,\n    items: order.items,\n    warehouse_location: order.warehouse_id || \"MAIN\",\n    notes: \"Tier: \" + order.sla_info.tier + \" | Score: \" + order.scoring.priority_score\n  })),\n  \"auto_assign\": true,\n  \"optimize_route\": true\n} }}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.1
      },
      {
        "id": "ac398148-10e9-4064-9f1c-73c75956831a",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2336,
          1488
        ],
        "parameters": {
          "color": 5,
          "width": 1334,
          "height": 320,
          "content": "Creates tasks in WMS (auto-assign + route optimize) ‚Üí Plans shipments (Express/Priority/Standard) ‚Üí Sends to TMS (book carriers + reserve capacity) ‚Üí Updates ERP (status, schedule, deadlines) ‚Üí Generates summary report (stats, breakdowns, next deadlines) ‚Üí Emails ops team (execution summary)."
        },
        "typeVersion": 1
      },
      {
        "id": "107fd068-d573-448e-8d4a-9f9f526d4d5f",
        "name": "Generate Dispatch Schedule",
        "type": "n8n-nodes-base.code",
        "position": [
          2608,
          1600
        ],
        "parameters": {
          "jsCode": "const scheduleData = $input.first().json;\nconst pickingTasks = $input.all()[1].json;\n\nconst dispatchSchedule = scheduleData.schedules.map(order => {\n  const pickingTime = new Date(order.scheduled_time);\n  const dispatchTime = new Date(pickingTime.getTime() + \n    ((order.estimated_pick_duration + 45) * 60000));\n  \n  let shippingMethod = 'standard';\n  if (order.sla_info.urgency_level === 'critical' || order.sla_info.urgency_level === 'urgent') {\n    shippingMethod = 'express';\n  } else if (order.sla_info.urgency_level === 'high') {\n    shippingMethod = 'priority';\n  }\n  \n  return {\n    order_id: order.order_id,\n    customer_id: order.customer_id,\n    dispatch_time: dispatchTime.toISOString(),\n    shipping_method: shippingMethod,\n    carrier: order.preferred_carrier || 'auto_select',\n    sla_deadline: order.sla_info.deadline,\n    priority: order.scoring.priority_score,\n    customer_tier: order.sla_info.tier\n  };\n});\n\nconst dispatchSlots = {};\ndispatchSchedule.forEach(dispatch => {\n  const hour = new Date(dispatch.dispatch_time).toISOString().slice(0, 13);\n  if (!dispatchSlots[hour]) dispatchSlots[hour] = [];\n  dispatchSlots[hour].push(dispatch);\n});\n\nreturn [{ json: {\n  dispatch_schedule: dispatchSchedule,\n  dispatch_slots: dispatchSlots,\n  total_dispatches: dispatchSchedule.length\n}}];"
        },
        "typeVersion": 2
      },
      {
        "id": "c53642b0-6cd8-4570-bc1a-aa00f5abf420",
        "name": "Schedule Dispatches in TMS",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2832,
          1600
        ],
        "parameters": {
          "url": "https://your-tms.com/api/dispatch/schedule",
          "method": "POST",
          "options": {},
          "jsonBody": "={{ $json }}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.1
      },
      {
        "id": "8c114593-3f39-4962-a4d3-e478eb5a4c9f",
        "name": "Update Order Statuses",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3056,
          1600
        ],
        "parameters": {
          "url": "https://your-erp.com/api/orders/update-bulk",
          "method": "POST",
          "options": {},
          "jsonBody": "={{ {\n  \"updates\": $input.first().json.schedules.map(order => ({\n    order_id: order.order_id,\n    status: \"scheduled\",\n    priority_score: order.scoring.priority_score,\n    urgency_level: order.sla_info.urgency_level,\n    scheduled_pick_time: order.scheduled_time,\n    sla_deadline: order.sla_info.deadline,\n    updated_at: new Date().toISOString()\n  }))\n} }}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.1
      },
      {
        "id": "0770cd61-31d9-4cbe-b225-a41c5b1eaeec",
        "name": "Generate Summary Report",
        "type": "n8n-nodes-base.code",
        "position": [
          3280,
          1600
        ],
        "parameters": {
          "jsCode": "const scheduleData = $input.all()[0].json;\nconst dispatchData = $input.all()[1].json;\nconst updateResponse = $input.all()[2].json;\n\nconst summary = {\n  execution_time: new Date().toISOString(),\n  orders_processed: scheduleData.summary.total_orders,\n  priority_breakdown: {\n    critical: scheduleData.schedules.filter(o => o.sla_info.urgency_level === 'critical').length,\n    urgent: scheduleData.schedules.filter(o => o.sla_info.urgency_level === 'urgent').length,\n    high: scheduleData.summary.high_priority,\n    normal: scheduleData.summary.normal_priority,\n    low: scheduleData.summary.low_priority\n  },\n  sla_tiers: {\n    platinum: scheduleData.schedules.filter(o => o.sla_info.tier === 'platinum').length,\n    gold: scheduleData.schedules.filter(o => o.sla_info.tier === 'gold').length,\n    silver: scheduleData.schedules.filter(o => o.sla_info.tier === 'silver').length,\n    bronze: scheduleData.schedules.filter(o => o.sla_info.tier === 'bronze').length\n  },\n  picking_tasks_created: scheduleData.summary.total_orders,\n  dispatches_scheduled: dispatchData.total_dispatches,\n  next_critical_deadline: scheduleData.schedules\n    .filter(o => o.sla_info.urgency_level === 'critical')\n    .sort((a, b) => new Date(a.sla_info.deadline) - new Date(b.sla_info.deadline))[0]?.sla_info.deadline || 'None'\n};\n\nreturn [{ json: summary }];"
        },
        "typeVersion": 2
      },
      {
        "id": "56d8fefd-1541-4792-acf5-61011feb4e5c",
        "name": "Send Summary Notification",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3504,
          1600
        ],
        "parameters": {
          "url": "https://your-notification-service.com/api/send",
          "method": "POST",
          "options": {},
          "jsonBody": "={{ {\n  \"recipient\": \"operations@company.com\",\n  \"subject\": \"‚úÖ SLA Prioritization Complete\",\n  \"body\": \"Orders: \" + $json.orders_processed + \" | Critical: \" + $json.priority_breakdown.critical + \" | Urgent: \" + $json.priority_breakdown.urgent + \" | High: \" + $json.priority_breakdown.high + \" | Tasks: \" + $json.picking_tasks_created + \" | Dispatches: \" + $json.dispatches_scheduled,\n  \"priority\": \"normal\"\n} }}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.1
      },
      {
        "id": "fedd9164-d9fa-4081-a932-6a85b3cefe6a",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          789,
          1408
        ],
        "parameters": {
          "color": 5,
          "width": 422,
          "height": 272,
          "content": "‚è∞ Runs every 15 minutes Fetches pending orders than üì• Gets pending/confirmed orders Limit: 100 per run"
        },
        "typeVersion": 1
      },
      {
        "id": "1b8f961e-92d8-46f1-b238-4e2cc6786485",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3808,
          1312
        ],
        "parameters": {
          "width": 464,
          "height": 800,
          "content": "## Overview\n\n\nAutomates sales order prioritization using customer SLAs, inventory status, and margin criteria. Plans shipments, creates WMS & TMS tasks, and notifies teams automatically once scheduled, dispatched, and reported.\n\n**How it works**\n\nTrigger runs every 15 min to fetch pending orders.\n\nEnrich data with SLA to calculate priority score.\n\nBranch logic: urgent ‚Üí alert & create tasks; normal ‚Üí batch schedule.\n\nDispatch info pushed to ERP & digital channels.\n\nSetup steps\n\nReplace URLs with your API endpoints.\n\nAdd authentication headers as shown for each HTTP node.\n\nAdjust cron, logic, weights, or scheduling as required.\n\nActivate workflow.\n\n**Output**\n\n‚úÖ WMS & TMS tasks created (with assigned users & routes)\nüöö Shipments planned & booked (Express / Priority / Standard)\nüíæ ERP updated (status, schedules, deadlines)\nüìä Summary report generated (stats, breakdowns, next deadlines)\nüìß Execution summary emailed to ops team"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "9709981c-1cb1-4576-8255-659696bd76bf",
    "connections": {
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Fetch Pending Orders",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Batch Normal Orders": {
        "main": [
          [
            {
              "node": "Generate Picking Schedule",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Pending Orders": {
        "main": [
          [
            {
              "node": "Fetch Customer SLA Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check if SLA Critical": {
        "main": [
          [
            {
              "node": "Create Urgent Picking Task",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Batch Normal Orders",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Order Statuses": {
        "main": [
          [
            {
              "node": "Generate Summary Report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Alert Warehouse Manager": {
        "main": [
          [
            {
              "node": "Create Bulk Picking Tasks",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Customer SLA Data": {
        "main": [
          [
            {
              "node": "Calculate Priority Scores",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Summary Report": {
        "main": [
          [
            {
              "node": "Send Summary Notification",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Calculate Priority Scores": {
        "main": [
          [
            {
              "node": "Check if SLA Critical",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Bulk Picking Tasks": {
        "main": [
          [
            {
              "node": "Generate Dispatch Schedule",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Picking Schedule": {
        "main": [
          [
            {
              "node": "Create Bulk Picking Tasks",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Urgent Picking Task": {
        "main": [
          [
            {
              "node": "Alert Warehouse Manager",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Dispatch Schedule": {
        "main": [
          [
            {
              "node": "Schedule Dispatches in TMS",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Dispatches in TMS": {
        "main": [
          [
            {
              "node": "Update Order Statuses",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "SdBKwXCUZaS6VYQE",
    "meta": {
      "instanceId": "84ad02d6104594179f43f1ce9cfe3a81637b2faedb57dafcb9e649b7542988db"
    },
    "name": "BuiltWith to trello",
    "tags": [],
    "nodes": [
      {
        "id": "ecafd36c-ff4a-4348-95ec-5a221a73ddf7",
        "name": "Manual Trigger",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -420,
          900
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "efbaced5-1171-406b-9704-277a12a51f0d",
        "name": "Read Domains from Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -200,
          900
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Hs9LcBpC-kaGgD_QjkkqBEJzDeAd85RW_L1fXTYEdCA/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1Hs9LcBpC-kaGgD_QjkkqBEJzDeAd85RW_L1fXTYEdCA",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Hs9LcBpC-kaGgD_QjkkqBEJzDeAd85RW_L1fXTYEdCA/edit?usp=drivesdk",
            "cachedResultName": "BuiltWith Domain"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "Rp7XiR3hxJfv03ZO",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "1793828d-c274-4b8b-b612-33a80a27fba0",
        "name": "Fetch detail via BuiltWith",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          60,
          900
        ],
        "parameters": {
          "url": "https://api.builtwith.com/v21/api.json",
          "options": {},
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "KEY",
                "value": "YOUR_API_KEY"
              },
              {
                "name": "LOOKUP",
                "value": "={{ $json.Domain }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "d64e4b44-5a7c-487d-98ec-5f5ff40ecf56",
        "name": "Extract Tech Stack Info",
        "type": "n8n-nodes-base.code",
        "position": [
          280,
          900
        ],
        "parameters": {
          "jsCode": "const result = $json.Results?.[0];\nconst domain = result?.Lookup || null;\nconst path = result?.Result?.Paths?.[0];\nconst url = path?.Url || null;\n\nlet extracted = null;\n\n// Loop through Groups to find the first available Tech entry\nfor (const group of path?.Groups || []) {\n  const category = group.Name;\n  const tech = group.Tech?.[0];\n  \n  if (tech) {\n    extracted = {\n      Technology: tech.Name,\n      Category: category,\n      \"First Detected\": tech.FirstDetected,\n      \"Last Detected\": tech.LastDetected,\n      Domain: domain,\n      URL: url\n    };\n    break; // Stop after first match\n  }\n}\n\nreturn extracted ? [extracted] : [];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "63da73d8-06a5-4780-a8b3-24ebf1c93176",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          480,
          220
        ],
        "parameters": {
          "color": 5,
          "width": 360,
          "height": 880,
          "content": "# üìä **Section 3: Create Trello Cards**\n\nüì•üìù\n**Node:**\n\n* `üìó Create Trello Cards with Tech Stack`\n\n---\n\n### üîπ What it does:\n\n* Takes the extracted data and **create trello cards for scan**.\n* Fills in columns like:\n\n  * `Technology`\n  * `Category`\n  * `First Detected`\n  * `Last Detected`\n  * `URL`\n\n### ‚úçÔ∏è How it works:\n\n* Provide Due date and member ids\n"
        },
        "typeVersion": 1
      },
      {
        "id": "43a5ae54-2faa-42c0-bdf1-013fe7cdbd34",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 440,
          "height": 1100,
          "content": "## üåç **Section 2: Tech Stack Lookup**\n\nüîçüåê‚û°Ô∏èüß†\n**Nodes:**\n\n* `üåê Fetch Tech Stack from BuiltWith`\n* `üß† Extract Tech Stack Info (Function node)`\n\n---\n\n### üîπ What it does:\n\n* For each domain, it sends an HTTP GET request to the **BuiltWith API** to fetch that site's detected technologies.\n* The **Code (Function)** node then parses the complex response and extracts only what you care about:\n\n  * `Technology` üõ†Ô∏è\n  * `Category` üì¶\n  * `First Detected` üïê\n  * `Last Detected` ‚åõ\n  * `Domain` üåê\n  * `URL` üîó\n\n### üß† How it works:\n\n* BuiltWith returns a rich JSON structure with all detected tech.\n* Your function loops through it and pulls **just one matching technology** per domain (to keep it simple).\n* This makes it easy to update a single row in your sheet.\n\n### üí° Beginner Tips:\n\n* Want **all technologies** per domain? Modify the function to return multiple results per input.\n* Make sure to handle **API limits** if you‚Äôre processing many domains‚Äîadd delays using the `Wait` node if needed.\n\n---\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "4b3f94c2-ff44-49b4-9382-da3933a015af",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -460,
          100
        ],
        "parameters": {
          "color": 6,
          "width": 420,
          "height": 1000,
          "content": "## üß© **Section 1: Input Collection**\n\nüìÑ‚û°Ô∏èüì§\n**Nodes:**\n\n* `üñ±Ô∏è Manual Trigger`\n* `üìó Read Domains from Google Sheets`\n\n---\n\n### üîπ What it does:\n\n* The workflow starts **when you click \"Test workflow\"** (manual trigger). This is useful for testing before setting up a schedule.\n* Then it connects to a **Google Sheet**, which contains a list of domains (e.g., `webflow.com`, `shopify.com`) you want to analyze.\n\n### üìö How it works:\n\n* You‚Äôve connected your Google Sheets account.\n* It reads all rows from a specific sheet (e.g., a tab called `Domains`).\n* Each row should include at least one column like `Domain`.\n\n### üí° Beginner Tips:\n\n* Want to analyze other domains? Just paste them into the Google Sheet.\n* You can automate this by replacing the manual trigger with a `Cron` node to run every day, week, or month.\n\n---\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "4be59f24-b1bf-43c9-979c-70d53e4292c8",
        "name": "Trello",
        "type": "n8n-nodes-base.trello",
        "position": [
          620,
          900
        ],
        "parameters": {
          "name": "Scan BuiltWith Results",
          "description": "=Domain: {{ $json.Domain }}\nTechnology: {{ $json.Technology }}\nCategory: {{ $json.Category }}\nFirst Detected: {{ $json['First Detected'] }}\nLast Detected: {{ $json['Last Detected'] }}\nURL: {{ $json.URL }}",
          "additionalFields": {
            "due": "",
            "idMembers": ""
          }
        },
        "typeVersion": 1
      },
      {
        "id": "7df51d43-61d0-4999-8e65-d0d7271e0684",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2100,
          100
        ],
        "parameters": {
          "color": 4,
          "width": 1300,
          "height": 320,
          "content": "=======================================\n            WORKFLOW ASSISTANCE\n=======================================\nFor any questions or support, please contact:\n    Yaron@nofluff.online\n\nExplore more tips and tutorials here:\n   - YouTube: https://www.youtube.com/@YaronBeen/videos\n   - LinkedIn: https://www.linkedin.com/in/yaronbeen/\n=======================================\n"
        },
        "typeVersion": 1
      },
      {
        "id": "df23bd49-1a2c-4c40-8f38-3b90d24850a8",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2100,
          440
        ],
        "parameters": {
          "color": 4,
          "width": 1289,
          "height": 2858,
          "content": "## ‚öôÔ∏è **Workflow Overview: Scrape BuiltWith Tech Data and create trello cards**\n\nThis automation does three main things:\n\n1. üì• **Reads domains from Google Sheets**\n2. üåê **Fetches tech stack data from BuiltWith**\n3. üì§ **Create trello cards for scan**\n\n---\n\n## üß© **Section 1: Input Collection**\n\nüìÑ‚û°Ô∏èüì§\n**Nodes:**\n\n* `üñ±Ô∏è Manual Trigger`\n* `üìó Read Domains from Google Sheets`\n\n---\n\n### üîπ What it does:\n\n* The workflow starts **when you click \"Test workflow\"** (manual trigger). This is useful for testing before setting up a schedule.\n* Then it connects to a **Google Sheet**, which contains a list of domains (e.g., `webflow.com`, `shopify.com`) you want to analyze.\n\n### üìö How it works:\n\n* You‚Äôve connected your Google Sheets account.\n* It reads all rows from a specific sheet (e.g., a tab called `Domains`).\n* Each row should include at least one column like `Domain`.\n\n### üí° Beginner Tips:\n\n* Want to analyze other domains? Just paste them into the Google Sheet.\n* You can automate this by replacing the manual trigger with a `Cron` node to run every day, week, or month.\n\n---\n\n## üåç **Section 2: Tech Stack Lookup**\n\nüîçüåê‚û°Ô∏èüß†\n**Nodes:**\n\n* `üåê Fetch Tech Stack from BuiltWith`\n* `üß† Extract Tech Stack Info (Function node)`\n\n---\n\n### üîπ What it does:\n\n* For each domain, it sends an HTTP GET request to the **BuiltWith API** to fetch that site's detected technologies.\n* The **Code (Function)** node then parses the complex response and extracts only what you care about:\n\n  * `Technology` üõ†Ô∏è\n  * `Category` üì¶\n  * `First Detected` üïê\n  * `Last Detected` ‚åõ\n  * `Domain` üåê\n  * `URL` üîó\n\n### üß† How it works:\n\n* BuiltWith returns a rich JSON structure with all detected tech.\n* Your function loops through it and pulls **just one matching technology** per domain (to keep it simple).\n* This makes it easy to update a single row in your sheet.\n\n### üí° Beginner Tips:\n\n* Want **all technologies** per domain? Modify the function to return multiple results per input.\n* Make sure to handle **API limits** if you‚Äôre processing many domains‚Äîadd delays using the `Wait` node if needed.\n\n---\n\n# üìä **Section 3: Create Trello Cards**\n\nüì•üìù\n**Node:**\n\n* `üìó Create Trello Cards with Tech Stack`\n\n---\n\n### üîπ What it does:\n\n* Takes the extracted data and **create trello cards for scan**.\n* Fills in columns like:\n\n  * `Technology`\n  * `Category`\n  * `First Detected`\n  * `Last Detected`\n  * `URL`\n\n### ‚úçÔ∏è How it works:\n\n* Provide Due date and member ids\n\n\n### üí° Beginner Tips:\n\n* Add more columns like `Confidence`, `Data Source`, or `Notes` if you want to enrich your research.\n* Use this sheet for:\n\n  * üíº Lead qualification\n  * üìä Market analysis\n  * üöÄ Tech product targeting\n\n---\n\n## üéØ Final Thoughts\n\nüîÅ This automation turns a **manual and tedious research task** into a repeatable, scalable, and accurate process. By connecting **Google Sheets + BuiltWith + Trello + n8n**, you can:\n\n‚úÖ Automatically analyze websites\n‚úÖ Store structured data for marketing or sales\n‚úÖ Scale your intelligence gathering with just a few clicks\n\n---\n\n\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {
      "Fetch detail via BuiltWith": [
        {
          "json": {
            "Results": [
              {
                "Lookup": "webflow.com",
                "Result": {
                  "Paths": [
                    {
                      "Url": "http://webflow.com",
                      "Groups": [
                        {
                          "Name": "Web Hosting Providers",
                          "Tech": [
                            {
                              "Name": "Amazon Web Services",
                              "LastDetected": "2025-06-06",
                              "FirstDetected": "2022-01-10"
                            }
                          ]
                        },
                        {
                          "Name": "JavaScript Libraries",
                          "Tech": [
                            {
                              "Name": "React",
                              "LastDetected": "2025-06-06",
                              "FirstDetected": "2021-05-01"
                            },
                            {
                              "Name": "jQuery",
                              "LastDetected": "2024-12-01",
                              "FirstDetected": "2020-09-15"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              }
            ]
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "c7136027-b14e-4f10-a759-fbd538ae3991",
    "connections": {
      "Manual Trigger": {
        "main": [
          [
            {
              "node": "Read Domains from Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Tech Stack Info": {
        "main": [
          [
            {
              "node": "Trello",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch detail via BuiltWith": {
        "main": [
          [
            {
              "node": "Extract Tech Stack Info",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Domains from Google Sheets": {
        "main": [
          [
            {
              "node": "Fetch detail via BuiltWith",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "Mbuax8L8jEmBBYkz",
    "meta": {
      "instanceId": "a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462",
      "templateCredsSetupCompleted": true
    },
    "name": "The Ultimate Guide to Optimize WordPress Blog Posts with AI",
    "tags": [
      {
        "id": "2VG6RbmUdJ2VZbrj",
        "name": "Google Drive",
        "createdAt": "2024-12-04T16:50:56.177Z",
        "updatedAt": "2024-12-04T16:50:56.177Z"
      },
      {
        "id": "kH2Zf266Nh4c1aga",
        "name": "DeepSeek",
        "createdAt": "2025-01-02T15:24:47.534Z",
        "updatedAt": "2025-01-02T15:24:47.534Z"
      },
      {
        "id": "sAbYDJMthctD4UVJ",
        "name": "Wordpress",
        "createdAt": "2024-12-17T17:37:24.345Z",
        "updatedAt": "2024-12-17T17:37:24.345Z"
      }
    ],
    "nodes": [
      {
        "id": "5c88bf7d-cd9d-4b76-8233-6e5927692e7a",
        "name": "When clicking ‚ÄòTest workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -540,
          -80
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "d3fc9ed5-9ddc-480d-9fa8-f0a66bb69520",
        "name": "Get context",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -320,
          -80
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": true
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "ID POST"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WlmjnObleBuHRno_axjc-GjV7Wg9gCoIsOK1PD4TxGU/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1WlmjnObleBuHRno_axjc-GjV7Wg9gCoIsOK1PD4TxGU",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WlmjnObleBuHRno_axjc-GjV7Wg9gCoIsOK1PD4TxGU/edit?usp=drivesdk",
            "cachedResultName": "Complete Plan Blog post"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "JYR6a64Qecd6t8Hb",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "27a1aaf2-435f-4fcc-b7be-f88f2e51a6c7",
        "name": "Set context",
        "type": "n8n-nodes-base.set",
        "position": [
          -100,
          -80
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "3e8d2523-66aa-46fe-adcc-39dc78b9161e",
                "name": "prompt",
                "type": "string",
                "value": "={{ $json.PROMPT }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "b2f0a242-ef9f-42d9-974b-e823f23bf37f",
        "name": "Generate title",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          360,
          -80
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "id",
            "value": "=deepseek-chat"
          },
          "options": {
            "maxTokens": 2048
          },
          "messages": {
            "values": [
              {
                "content": "=You are an SEO Copywriter and you need to find a title of maximum 60 characters for the following article:\n{{ $json.message.content }}\n\nInstructions:\n- Use keywords contained in the article\n- Do not use any HTML characters\n- Output only the string containing the title.\n- Do not use quotes. The only characters allowed are: and ,"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "97Cz4cqyiy1RdcQL",
            "name": "DeepSeek"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "b3b30328-0dfe-4471-9195-d411e737df5e",
        "name": "Generate article",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          140,
          -80
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "id",
            "value": "=deepseek-chat"
          },
          "options": {
            "maxTokens": 2048
          },
          "messages": {
            "values": [
              {
                "content": "=an SEO-friendly article on these topics:\n{{ $json.prompt }}\n\nInstructions:\n- In the introduction, introduce the topic that will be covered in more detail in the rest of the text\n- The introduction should be about 60 words\n- The conclusion should be about 60 words\n- Use the conclusion to summarize everything said in the article and offer a conclusion to the reader\n- Write a maximum of 2-3 chapters.\n- Chapters should follow a logical flow and not repeat the same ideas.\n- Chapters should be related to each other and not isolated blocks of text. The text should flow and follow a linear logic.\n- Do not start chapters with \"Chapter 1\", \"Chapter 2\", \"Chapter 3\" ... write only the chapter title\n- For the text, use HTML for formatting, but limit yourself to bold, italics, paragraphs and lists.\n- Do not put the output between ```html but only the text\n- Do not use markdown for formatting.\n- Go deeper into the topic you are talking about, don't just throw superficial information out there\n- I only want HTML format in output"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "97Cz4cqyiy1RdcQL",
            "name": "DeepSeek"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "e3f7d28b-ac23-4192-bd46-127491240ee2",
        "name": "Add draft to WP",
        "type": "n8n-nodes-base.wordpress",
        "position": [
          620,
          -80
        ],
        "parameters": {
          "title": "={{ $json.message.content }}",
          "additionalFields": {
            "status": "draft",
            "content": "={{ $('Generate article').item.json.message.content }}"
          }
        },
        "credentials": {
          "wordpressApi": {
            "id": "OE4AgquSkMWydRqn",
            "name": "Wordpress (wp.test.7hype.com)"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "3ebcf40b-7a3b-43fa-a075-0e6dfaa2665e",
        "name": "Generate image",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          -540,
          200
        ],
        "parameters": {
          "prompt": "=Generate a real photo image used as a blog post cover:\n\nImage prompt:\n{{ $('Generate title').item.json.message.content }}, photography, realistic, sigma 85mm f/1.4",
          "options": {
            "size": "1024x1024",
            "style": "natural",
            "quality": "hd"
          },
          "resource": "image"
        },
        "credentials": {
          "openAiApi": {
            "id": "CDX6QM4gLYanh0P4",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "2eedf2db-660b-4e1e-a38d-34ad2ddb1314",
        "name": "Upload image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -320,
          200
        ],
        "parameters": {
          "url": "https://URL/wp-json/wp/v2/media",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "binaryData",
          "sendHeaders": true,
          "authentication": "predefinedCredentialType",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Disposition",
                "value": "=attachment; filename=\"copertina-{{ $('Add draft to WP').item.json.id }}.jpg\""
              }
            ]
          },
          "inputDataFieldName": "data",
          "nodeCredentialType": "wordpressApi"
        },
        "credentials": {
          "wordpressApi": {
            "id": "OE4AgquSkMWydRqn",
            "name": "Wordpress (wp.test.7hype.com)"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "58e3aa00-a1d7-4b19-916e-4d07dd7c2009",
        "name": "Set image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -120,
          200
        ],
        "parameters": {
          "url": "=https://URL/wp-json/wp/v2/posts/{{ $('Add draft to WP').item.json.id }}",
          "method": "POST",
          "options": {},
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "featured_media",
                "value": "={{ $json.id }}"
              }
            ]
          },
          "nodeCredentialType": "wordpressApi"
        },
        "credentials": {
          "wordpressApi": {
            "id": "OE4AgquSkMWydRqn",
            "name": "Wordpress (wp.test.7hype.com)"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "6f9277be-26c4-4d01-9e61-acf3ab90739d",
        "name": "Update Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          140,
          200
        ],
        "parameters": {
          "columns": {
            "value": {
              "URL": "={{ $('Add draft to WP').item.json.guid.rendered }}",
              "DATA": "={{ $now.format('dd/LL/yyyy') }}",
              "TITLE": "={{ $('Add draft to WP').item.json.title.rendered }}",
              "ID POST": "={{ $('Add draft to WP').item.json.id }}",
              "row_number": "={{ $('Get context').item.json.row_number }}"
            },
            "schema": [
              {
                "id": "DATA",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "DATA",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PROMPT",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "PROMPT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "TITLE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "TITLE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID POST",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "ID POST",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "METATITLE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "METATITLE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "METADESCRIPTION",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "METADESCRIPTION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/16VFeCrE5BkMBoA_S5HD-9v7C0sxcXAUiDbq5JvkDqnI/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1WlmjnObleBuHRno_axjc-GjV7Wg9gCoIsOK1PD4TxGU",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WlmjnObleBuHRno_axjc-GjV7Wg9gCoIsOK1PD4TxGU/edit?usp=drivesdk",
            "cachedResultName": "Complete Plan Blog post"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "JYR6a64Qecd6t8Hb",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "1d880c40-af32-4c78-9fa2-fb6b120039d3",
        "name": "SEO Expert",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          500,
          200
        ],
        "parameters": {
          "text": "=Create metatitle and metadescription in the language of the following product:\n- Title: {{ $('Add draft to WP').item.json.title.rendered }}\n- Content: {{ $('Add draft to WP').item.json.content.rendered }}\n- Excerpt: {{ $('Add draft to WP').item.json.excerpt.rendered }}",
          "messages": {
            "messageValues": [
              {
                "message": "=You are an expert SEO content optimizer specialized in creating meta tags for both web pages and blog articles. Your task is to analyze the provided content and generate optimized meta tags based on the content type.\n\nMETA TAG REQUIREMENTS:\n\n1. Meta Title (max 60 characters):\n   - Include primary keyword near the beginning\n   - State the main value proposition\n   - Include brand name when relevant\n   - Use action-oriented language for commercial pages\n   - Format: Primary Keyword | Main Benefit | Brand (if applicable)\n\n2. Meta Description (max 160 characters):\n   - Lead with unique selling proposition\n   - Include primary and secondary keywords naturally\n   - Add clear call-to-action\n   - Highlight key benefits or features\n   - Address user pain points\n   - Tease the main insights or findings\n   - Mention key topics covered\n   - Use engaging question or statement\n   - Include expertise indicators\n   - Promise value or solution\n\nANALYSIS PROCESS:\n1. Content Assessment:\n   - Identify content type and purpose\n   - Extract main topic and keywords\n   - Determine search intent\n   - Identify target audience\n   - Note key differentiators\n\n2. Optimization Strategy:\n   - Align with search intent\n   - Consider competition level\n   - Factor in brand guidelines\n   - Account for content freshness\n   - Optimize for click-through rate\n\nOUTPUT FORMAT:\nPlease provide meta tags in the required format\n\nVALIDATION CHECKLIST:\n- Title length ‚â§ 60 characters\n- Description length ‚â§ 160 characters\n- Primary keyword included in both\n- Matches identified search intent\n- Appropriate for content type\n- Clear value proposition\n- Compelling call-to-action\n- Natural keyword placement\n- Proper grammar and spelling\n- Mobile display optimized\n- Don't use placeholder\n\nBEST PRACTICES:\n- Avoid clickbait or misleading content\n- Use power words appropriately\n- Maintain brand voice and tone\n- Ensure mobile snippet optimization\n- Consider local SEO when relevant\n- Keep seasonal content timely\n- Use numbers and data when available\n- Include price/offers if applicable\n- Add emotional triggers when appropriate\n- Consider SERP feature optimization\n\nTECHNICAL GUIDELINES:\n- No double quotes in meta description\n- Avoid unnecessary special characters\n- Use UTF-8 encoding\n- Capitalize properly\n- Avoid keyword cannibalization\n- Respect brand guidelines\n- Consider local market variations\n- Update meta tags for seasonal content\n- Monitor CTR performance\n- A/B test when possible\n\nRemember: The goal is to create meta tags that serve both search engines and users effectively while maintaining specificity for the content type and maximizing organic click-through rates."
              }
            ]
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.5
      },
      {
        "id": "d26e13c4-e26d-4f3c-9977-82d32879530e",
        "name": "OpenRouter Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          480,
          440
        ],
        "parameters": {
          "model": "google/gemini-2.0-flash-exp:free",
          "options": {}
        },
        "credentials": {
          "openRouterApi": {
            "id": "pb06rfB4xmxzVe3Q",
            "name": "OpenRouter"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c4833efe-1b43-42e7-a5ec-cca1908f327b",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          700,
          440
        ],
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n\t\"type\": \"object\",\n\t\"properties\": {\n\t\t\"metatitle\": {\n\t\t\t\"type\": \"string\"\n\t\t},\n\t\t\"metadescription\": {\n\t\t\t\"type\": \"string\"\n\t\t}\n\t}\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "962e5d6f-df35-4e5c-b46e-9c2164a3648d",
        "name": "Set metatag",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -540,
          480
        ],
        "parameters": {
          "url": "=https://URL/wp-json/wp/v2/posts/{{ $('Add draft to WP').item.json.id }}",
          "method": "PUT",
          "options": {},
          "jsonBody": "={\n  \"meta\":{\n    \"_yoast_wpseo_title\":\"{{ $json.output.metatitle }}\",\n    \"_yoast_wpseo_metadesc\":\"{{ $json.output.metadescription }}\"\n  }\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpBasicAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpBasicAuth": {
            "id": "WCjOvm7HOMwGEMWs",
            "name": "WP (wp.test.7hype.com)"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "55e8e3c3-2270-4227-863c-e7cf1337c13b",
        "name": "Finish work",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -320,
          480
        ],
        "parameters": {
          "columns": {
            "value": {
              "METATITLE": "={{ $('SEO Expert').item.json.output.metatitle }}",
              "row_number": "={{ $('Update Sheet').item.json.row_number }}",
              "METADESCRIPTION": "={{ $('SEO Expert').item.json.output.metadescription }}"
            },
            "schema": [
              {
                "id": "DATA",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "DATA",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PROMPT",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "PROMPT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "TITLE",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "TITLE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID POST",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "ID POST",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "METATITLE",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "METATITLE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "METADESCRIPTION",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "METADESCRIPTION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WlmjnObleBuHRno_axjc-GjV7Wg9gCoIsOK1PD4TxGU/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1WlmjnObleBuHRno_axjc-GjV7Wg9gCoIsOK1PD4TxGU",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WlmjnObleBuHRno_axjc-GjV7Wg9gCoIsOK1PD4TxGU/edit?usp=drivesdk",
            "cachedResultName": "Complete Plan Blog post"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "JYR6a64Qecd6t8Hb",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "f50be61f-7502-4186-9952-22e740de896e",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -360,
          -160
        ],
        "parameters": {
          "width": 180,
          "height": 240,
          "content": "Fetches the context of the article you want to generate via AI"
        },
        "typeVersion": 1
      },
      {
        "id": "149e3535-60fb-4547-8dad-567a47f9bc4b",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          540,
          -160
        ],
        "parameters": {
          "width": 280,
          "height": 240,
          "content": "Create the draft post on Wordpress with the article text and the title that were previously generated"
        },
        "typeVersion": 1
      },
      {
        "id": "779e3a0d-1429-4973-9757-fa1645796cbd",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -360,
          140
        ],
        "parameters": {
          "width": 400,
          "height": 220,
          "content": "Upload the generated image to Wordpress media and then associate it with the newly created article"
        },
        "typeVersion": 1
      },
      {
        "id": "9b375c3e-3c3a-44e9-b234-2538e6f33d32",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          140
        ],
        "parameters": {
          "width": 420,
          "height": 220,
          "content": "The SEO expert analyzes the created article and generates the appropriate meta title and meta description"
        },
        "typeVersion": 1
      },
      {
        "id": "d4c503c9-9d0f-4411-a3a6-bdd77f782a77",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -600,
          420
        ],
        "parameters": {
          "width": 220,
          "height": 200,
          "content": "The generated metadata is associated with the post"
        },
        "typeVersion": 1
      },
      {
        "id": "8d7a1d61-3fbe-4d76-9f2d-68b4c9de23bb",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -560,
          -460
        ],
        "parameters": {
          "color": 3,
          "width": 820,
          "content": "## Optimize WordPress Blog Posts with AI\n\nThis is a powerful tool for automating the creation and optimization of blog posts, saving time and ensuring high-quality, SEO-friendly content for Wordpress with Yoast plugin. \n\n[Clone this Sheet](https://docs.google.com/spreadsheets/d/1WlmjnObleBuHRno_axjc-GjV7Wg9gCoIsOK1PD4TxGU/edit?usp=sharing) and in the \"Prompt\" column write the topic that will then be developed by the AI"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "8d701d17-18ae-478c-881d-eedb422e9700",
    "connections": {
      "Set image": {
        "main": [
          [
            {
              "node": "Update Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "SEO Expert": {
        "main": [
          [
            {
              "node": "Set metatag",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get context": {
        "main": [
          [
            {
              "node": "Set context",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set context": {
        "main": [
          [
            {
              "node": "Generate article",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set metatag": {
        "main": [
          [
            {
              "node": "Finish work",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Sheet": {
        "main": [
          [
            {
              "node": "SEO Expert",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload image": {
        "main": [
          [
            {
              "node": "Set image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate image": {
        "main": [
          [
            {
              "node": "Upload image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate title": {
        "main": [
          [
            {
              "node": "Add draft to WP",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add draft to WP": {
        "main": [
          [
            {
              "node": "Generate image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate article": {
        "main": [
          [
            {
              "node": "Generate title",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "SEO Expert",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "SEO Expert",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Get context",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "HRSrLncWtsjpThtX",
    "meta": {
      "instanceId": "c2650793f644091dc80fb900fe63448ad1f4b774008de9608064d67294f8307c",
      "templateCredsSetupCompleted": true
    },
    "name": "bykhaisa",
    "tags": [],
    "nodes": [
      {
        "id": "4db560b9-9410-402e-a2dc-8d23f7a25139",
        "name": "Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -32,
          96
        ],
        "webhookId": "1339c533-da44-428b-ae38-f0429adb6534",
        "parameters": {
          "path": "makeup-booking",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "77858380-3f0b-43eb-b8cd-d1c6ce4ac6c7",
        "name": "Process Booking",
        "type": "n8n-nodes-base.set",
        "position": [
          192,
          96
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "06763823-d778-4ce9-938f-c61677d1262f",
                "name": "bookingId",
                "type": "string",
                "value": "=Khaisa_BOOK_{{ $json.body.nama }}-{{ $json.body.tanggal }}-{{ $json.body.jenisMakeup }}"
              },
              {
                "id": "9be38ec2-23eb-4554-8a12-d6154cc13d59",
                "name": "customerName",
                "type": "string",
                "value": "={{ $json.body.nama }}"
              },
              {
                "id": "cad27706-3ab9-4be3-9000-cf8dc5fad37f",
                "name": "whatsappNumber",
                "type": "string",
                "value": "={{ $json.body.noHp }}"
              },
              {
                "id": "ccccaeda-e246-4005-b4ad-e8cf0a96715d",
                "name": "eventDate",
                "type": "string",
                "value": "={{ $json.body.tanggal }}"
              },
              {
                "id": "aca82216-f4cb-4c21-909a-85d8fb6d48aa",
                "name": "eventTime",
                "type": "string",
                "value": "={{ $json.body.jam }}"
              },
              {
                "id": "2edf7411-5924-4418-b168-7f15fcdadaf9",
                "name": "location",
                "type": "string",
                "value": "={{ $json.body.tempatAcara }}"
              },
              {
                "id": "fe9c718b-4109-4974-8170-f984dc0c0c72",
                "name": "makeupType",
                "type": "string",
                "value": "={{ $json.body.jenisMakeup }}"
              },
              {
                "id": "4ad1710c-47b8-46eb-a6c5-3791352059f8",
                "name": "addOns",
                "type": "string",
                "value": "={{ $json.body.addOn }}"
              },
              {
                "id": "1da023a8-5d47-4472-b0c6-3d67b4cf9d13",
                "name": "paymentType",
                "type": "string",
                "value": "={{ $json.body.tipePembayaran }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "ffc2341f-eab0-4665-9167-fa1097b90108",
        "name": "Calculate Price",
        "type": "n8n-nodes-base.code",
        "position": [
          416,
          96
        ],
        "parameters": {
          "jsCode": "// Loop over input items and calculate pricing for each booking\nfor (const item of $input.all()) {\n  // Base pricing untuk setiap jenis makeup\n  const basePrice = {\n    'Yudisium': 200000,\n    'Wisuda': 200000,\n    'Pendamping': 250000,\n    'Bridesmaid': 200000,\n    'Tunangan': 200000,\n    'Photoshoot': 200000,\n    'Prewedding': 200000,\n    'Party': 200000\n  };\n  \n  const makeupType = item.json.makeupType;\n  const serviceType = item.json.serviceType || '';\n  const addOns = item.json.addOns || '';\n  const paymentType = item.json.paymentType || '';\n  \n  // Format nomor WhatsApp - ubah 0 di awal menjadi 62\n  let formattedWhatsapp = item.json.whatsappNumber || '';\n  if (formattedWhatsapp.startsWith('0')) {\n    formattedWhatsapp = '62' + formattedWhatsapp.substring(1);\n  }\n  // Hapus karakter non-numeric (spasi, dash, dll)\n  formattedWhatsapp = formattedWhatsapp.replace(/[^0-9]/g, '');\n  \n  // Update nomor WhatsApp yang sudah diformat\n  item.json.whatsappNumber = formattedWhatsapp;\n  item.json.formattedWhatsapp = formattedWhatsapp;\n  \n  // Hitung base price berdasarkan jenis makeup\n  let totalPrice = basePrice[makeupType] || 200000;\n  \n  // Tambah biaya transport untuk homeservice\n  if (serviceType.toLowerCase().includes('homeservice')) {\n    totalPrice += 50000; // Transport fee Rp 50,000\n  }\n  \n  // Tambah biaya add-ons jika ada (10% dari base price)\n  if (addOns && addOns.trim() !== '') {\n    const addOnFee = Math.round(basePrice[makeupType] * 0.1);\n    totalPrice += addOnFee;\n    item.json.addOnFee = addOnFee;\n  } else {\n    item.json.addOnFee = 0;\n  }\n  \n  // Logic untuk DP - jika payment type mengandung \"DP\" atau \"Booking\", set amount ke 50000\n  let invoiceAmount = totalPrice;\n  let isDP = false;\n  \n  if (paymentType.toLowerCase().includes('dp') || \n      paymentType.toLowerCase().includes('booking')) {\n    invoiceAmount = 50000;\n    isDP = true;\n  }\n  \n  // Format currency untuk display\n  const formattedPrice = new Intl.NumberFormat('id-ID', {\n    style: 'currency',\n    currency: 'IDR',\n    minimumFractionDigits: 0\n  }).format(totalPrice);\n  \n  const formattedInvoiceAmount = new Intl.NumberFormat('id-ID', {\n    style: 'currency',\n    currency: 'IDR',\n    minimumFractionDigits: 0\n  }).format(invoiceAmount);\n  \n  // Format currency tanpa symbol untuk Xendit\n  const priceForXendit = invoiceAmount.toString();\n  \n  // Tambahkan field pricing ke item\n  item.json.basePrice = basePrice[makeupType] || 200000;\n  item.json.transportFee = serviceType.toLowerCase().includes('homeservice') ? 50000 : 0;\n  item.json.totalPrice = totalPrice;\n  item.json.formattedPrice = formattedPrice;\n  item.json.invoiceAmount = invoiceAmount;\n  item.json.formattedInvoiceAmount = formattedInvoiceAmount;\n  item.json.priceForXendit = priceForXendit;\n  item.json.isDP = isDP;\n  \n  // Generate unique external ID untuk Xendit\n  item.json.externalId = `MUA_${item.json.bookingId.replace('BOOK_', '')}`;\n  \n  // Generate invoice description dengan indikator DP jika applicable\n  const dpIndicator = isDP ? ' (DP)' : '';\n  item.json.invoiceDescription = `Makeup ${makeupType} - ${item.json.customerName} (${item.json.eventDate} ${item.json.eventTime})${dpIndicator}`;\n  \n  // Calculate expiry time (24 hours from now)\n  const expiryTime = new Date();\n  expiryTime.setHours(expiryTime.getHours() + 24);\n  item.json.invoiceExpiry = expiryTime.toISOString();\n  \n  // Jika DP, hitung sisa pembayaran\n  if (isDP) {\n    item.json.remainingPayment = totalPrice - invoiceAmount;\n    item.json.formattedRemainingPayment = new Intl.NumberFormat('id-ID', {\n      style: 'currency',\n      currency: 'IDR',\n      minimumFractionDigits: 0\n    }).format(item.json.remainingPayment);\n  }\n}\nreturn $input.all();"
        },
        "typeVersion": 2
      },
      {
        "id": "528354f5-b69e-417e-966b-ab26400d76b3",
        "name": "Respond to Webhook",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          880,
          16
        ],
        "parameters": {
          "options": {},
          "respondWith": "allIncomingItems"
        },
        "typeVersion": 1.4
      },
      {
        "id": "37b3137c-a724-465c-b6c3-a157f4e32b56",
        "name": "Delay Typing",
        "type": "n8n-nodes-base.wait",
        "position": [
          1104,
          240
        ],
        "webhookId": "2ad403e6-4377-4e0f-b0d1-76182bcef108",
        "parameters": {
          "amount": "={{ Math.random()*5+3 }}"
        },
        "typeVersion": 1.1
      },
      {
        "id": "e0c4a033-5b6a-4679-a57f-8db6e60e79b4",
        "name": "Start Typing",
        "type": "@aldinokemal2104/n8n-nodes-gowa.gowa",
        "position": [
          880,
          240
        ],
        "parameters": {
          "operation": "sendChatPresence",
          "phoneNumber": "={{ $('Calculate Price').item.json.formattedWhatsapp }}"
        },
        "credentials": {
          "goWhatsappApi": {
            "id": "WJo4Yn0Xouu1FkD3",
            "name": "anisa"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5c5d6484-368f-4fd5-b26b-41f70c2a1203",
        "name": "Stop Typing",
        "type": "@aldinokemal2104/n8n-nodes-gowa.gowa",
        "position": [
          1328,
          240
        ],
        "parameters": {
          "operation": "sendChatPresence",
          "phoneNumber": "={{ $('Calculate Price').item.json.formattedWhatsapp }}",
          "chatPresenceAction": "stop"
        },
        "credentials": {
          "goWhatsappApi": {
            "id": "WJo4Yn0Xouu1FkD3",
            "name": "anisa"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "bb23ee2d-1656-49ff-a003-060e739e3efe",
        "name": "Send Message",
        "type": "@aldinokemal2104/n8n-nodes-gowa.gowa",
        "position": [
          1552,
          240
        ],
        "parameters": {
          "message": "=Hai, {{ $('Calculate Price').item.json.customerName }}\n\nBerikut Detail Booking Kamu:\nBooking Id: {{ $('Process Booking').item.json.bookingId }}\nTipe Makeup: {{ $('Process Booking').item.json.makeupType }}\nTanggal: {{ $('Process Booking').item.json.eventDate }} / {{ $('Process Booking').item.json.eventTime }}\nLokasi: {{ $('Process Booking').item.json.location }}\nTipe Pembayaran: {{ $('Process Booking').item.json.paymentType }}\n\nJika Belum melakukan pembayaran di halaman form, kamu bisa melakukan pembayaran melalui link berikut ya\n{{ $('Generate Invoice').item.json.invoice_url }}",
          "phoneNumber": "={{ $('Calculate Price').item.json.formattedWhatsapp }}"
        },
        "credentials": {
          "goWhatsappApi": {
            "id": "WJo4Yn0Xouu1FkD3",
            "name": "anisa"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4c12d09a-6f4f-4c04-a4ae-e31c490e34dd",
        "name": "Generate Invoice",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          640,
          96
        ],
        "parameters": {
          "url": "https://api.xendit.co/v2/invoices",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n    \"external_id\": \"{{ $json.invoiceExpiry }}\",\n    \"amount\": {{ $json.priceForXendit }},\n    \"description\": \"Pembayaran untuk {{ $json.invoiceDescription }}\",\n    \"invoice_duration\": 86400,\n    \"customer\": {\n      \"given_names\": \"{{ $json.customerName }}\",\n      \"surname\": \"{{ $json.customerName }}\",\n      \"email\": \"email@email.com\",\n      \"mobile_number\": \"{{ $json.whatsappNumber }}\"\n    },\n    \"success_redirect_url\": \"https://bykhaisa.my.id/payment-success\",\n    \"failure_redirect_url\": \"https://bykhaisa.my.id/payment-failed\",\n    \"currency\": \"IDR\",\n    \"items\": [\n      {\n        \"name\": \"Make Up {{ $json.makeupType }}\",\n        \"quantity\": 1,\n        \"price\": {{ $json.priceForXendit }},\n        \"category\": \"Makeup - {{ $json.makeupType }}\",\n        \"url\": \"testo\"\n      }\n    ],\n    \"metadata\": {\n      \"store_branch\": \"Jakarta\"\n    }\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpBasicAuth"
        },
        "credentials": {
          "httpBasicAuth": {
            "id": "QTs9FpNdOTvm3C5A",
            "name": "Xendit test Khaisa Studio"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "63c2e449-9dc5-488a-958a-7c8d6e2db713",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -16,
          448
        ],
        "parameters": {
          "color": 6,
          "width": 448,
          "height": 608,
          "content": "![form](https://raw.githubusercontent.com/khmuhtadin/n8n-template/main/Additional%20FE/Automate%20Booking%20with%20Xendit%20/Images/Screenshot%202025-07-25%20at%2021.09.06.png)"
        },
        "typeVersion": 1
      },
      {
        "id": "0e3d106d-287a-4fba-8232-5242044ba274",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          448,
          448
        ],
        "parameters": {
          "color": 5,
          "width": 512,
          "height": 608,
          "content": "## 1. Xendit API Key\n\n### How to Get API Key:\n1. **Register/Login** to [Xendit Dashboard](https://dashboard.xendit.co/)\n2. **Choose Environment**:\n   - Test mode for development\n   - Live mode for production\n3. **Generate API Key**:\n   - Go to **Settings** ‚Üí **API Keys**\n   - Click **Generate new key**\n   - Copy **Secret Key** (format: `xnd_test_xxx` or `xnd_production_xxx`)\n\n### Setup in n8n:\n- **Node**: HTTP Request\n- **Authentication**: Basic Auth\n- **Username**: Xendit API Key\n- **Password**: (leave empty)\n\n### Documentation:\n- [Xendit API Documentation](https://developers.xendit.co/)\n- [Invoice API Guide](https://developers.xendit.co/api-reference/#create-invoice)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c3d61119-cbc7-4ca7-b183-97f0444d6944",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          992,
          448
        ],
        "parameters": {
          "color": 5,
          "width": 656,
          "height": 608,
          "content": "## 2. GoWhatsApp API\n\n### Setup Process:\n1. **Install GoWhatsApp** on your server\n2. **Setup Container**:\n   ```bash\n   docker run -d -p 3000:3000 aldinokemal2104/go-whatsapp-web-multidevice\n   ```\n3. **Scan QR Code**:\n   - Open `http://localhost:3000`\n   - Scan QR with WhatsApp\n4. **Get API Endpoint**: `http://localhost:3000`\n\n### Setup in n8n:\n- **Node**: [GoWA](https://www.npmjs.com/package/@aldinokemal2104/n8n-nodes-gowa) (Community Node)\n- **API URL**: `http://localhost:3000`\n- **Phone Number**: Format 62xxx (without +)\n\n### Documentation:\n- [GoWhatsApp GitHub](https://github.com/aldinokemal/go-whatsapp-web-multidevice)\n- [API Endpoints](https://github.com/aldinokemal/go-whatsapp-web-multidevice#api-docs)"
        },
        "typeVersion": 1
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "6e219bda-3118-48d7-b509-42d81a17ad64",
    "connections": {
      "Webhook": {
        "main": [
          [
            {
              "node": "Process Booking",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Stop Typing": {
        "main": [
          [
            {
              "node": "Send Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Delay Typing": {
        "main": [
          [
            {
              "node": "Stop Typing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Start Typing": {
        "main": [
          [
            {
              "node": "Delay Typing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Calculate Price": {
        "main": [
          [
            {
              "node": "Generate Invoice",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Process Booking": {
        "main": [
          [
            {
              "node": "Calculate Price",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Invoice": {
        "main": [
          [
            {
              "node": "Respond to Webhook",
              "type": "main",
              "index": 0
            },
            {
              "node": "Start Typing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "zeNxNNUlmqMS21UM",
    "meta": {
      "instanceId": "f450cd0986d5bfb741d4d1b31068440b1642915c91f795fd72913ef923830e67",
      "templateCredsSetupCompleted": true
    },
    "name": "Package Recommender with Sales Pipeline Tracking",
    "tags": [],
    "nodes": [
      {
        "id": "9e48feeb-9589-4a78-b10f-759698fb6b39",
        "name": "Package Inquiry Form",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          -16,
          32
        ],
        "webhookId": "package-inquiry-webhook",
        "parameters": {
          "options": {},
          "formTitle": "Find Your Perfect Package",
          "formFields": {
            "values": [
              {
                "fieldLabel": "Full Name",
                "requiredField": true
              },
              {
                "fieldType": "email",
                "fieldLabel": "Email Address",
                "requiredField": true
              },
              {
                "fieldLabel": "Phone Number"
              },
              {
                "fieldType": "dropdown",
                "fieldLabel": "Budget Range",
                "fieldOptions": {
                  "values": [
                    {
                      "option": "Under $3,000"
                    },
                    {
                      "option": "$3,000 - $6,000"
                    },
                    {
                      "option": "$6,000 - $10,000"
                    },
                    {
                      "option": "$10,000+"
                    }
                  ]
                },
                "requiredField": true
              },
              {
                "fieldType": "dropdown",
                "fieldLabel": "Timeline",
                "fieldOptions": {
                  "values": [
                    {
                      "option": "ASAP (1-2 weeks)"
                    },
                    {
                      "option": "This Month"
                    },
                    {
                      "option": "Next 1-3 Months"
                    },
                    {
                      "option": "Just Exploring"
                    }
                  ]
                },
                "requiredField": true
              },
              {
                "fieldType": "textarea",
                "fieldLabel": "Main Challenge",
                "requiredField": true
              }
            ]
          },
          "formDescription": "Tell us about your needs and we'll recommend the best solution for you"
        },
        "typeVersion": 2.2
      },
      {
        "id": "1a303fb7-39a5-4a8f-aa8d-3421ec8ad17c",
        "name": "Log Inquiry to Pipeline",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          208,
          32
        ],
        "parameters": {
          "columns": {
            "value": {
              "Name": "={{ $json['Full Name'] }}",
              "Email": "={{ $json['Email Address'] }}",
              "Phone": "={{ $json['Phone Number'] }}",
              "Budget": "={{ $json['Budget Range'] }}",
              "Status": "Inquiry Received",
              "Timeline": "={{ $json['Timeline'] }}",
              "Challenge": "={{ $json['Main Challenge'] }}",
              "Date Sent": "",
              "Timestamp": "={{ $now.format('yyyy-MM-dd HH:mm:ss') }}",
              "Package Price": "",
              "Follow-Up Date": "",
              "Package Recommended": ""
            },
            "mappingMode": "defineBelow"
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "name",
            "value": "Package Inquiries"
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "YOUR_GOOGLE_SHEET_ID"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "bNNrQVyG0f0LvHLl",
            "name": "xavtwl"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "3941d96b-e2de-493d-ab11-aba546b1a2f8",
        "name": "Route by Budget",
        "type": "n8n-nodes-base.switch",
        "position": [
          432,
          16
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Basic Package",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "585e85b1-ec33-4444-8534-b230cdada992",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json['Budget Range'] }}",
                      "rightValue": "Under $3,000"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Standard Package",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "2155e925-ad49-4c45-ac8c-6c23773dcdce",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json['Budget Range'] }}",
                      "rightValue": "$3,000 - $6,000"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Premium Package",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "or",
                  "conditions": [
                    {
                      "id": "44e7e04e-ef5f-4f26-bd8b-4e1c4bf66df8",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $json['Budget Range'] }}",
                      "rightValue": "$6,000"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "9fcaaed8-ab10-4a08-8e1a-317b716d2ee8",
        "name": "Set Basic Package Details",
        "type": "n8n-nodes-base.set",
        "position": [
          784,
          -176
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "package-name",
                "name": "packageName",
                "type": "string",
                "value": "Basic Package"
              },
              {
                "id": "package-price",
                "name": "packagePrice",
                "type": "string",
                "value": "$1,500 - $2,995"
              },
              {
                "id": "package-features",
                "name": "packageFeatures",
                "type": "string",
                "value": "‚Ä¢ Initial consultation & strategy session\n‚Ä¢ Up to 3 custom automations\n‚Ä¢ Basic integrations (Gmail, Google Sheets, Forms)\n‚Ä¢ 30 days of support\n‚Ä¢ Video tutorials for your team"
              },
              {
                "id": "case-study",
                "name": "caseStudy",
                "type": "string",
                "value": "A local real estate agent automated their lead follow-up system and saved 15 hours per week with our Basic Package."
              },
              {
                "id": "booking-link",
                "name": "bookingLink",
                "type": "string",
                "value": "https://calendly.com/yourname/basic-package-call"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "32b27ff6-6637-4197-ad2e-e9e7f2924d13",
        "name": "Set Standard Package Details",
        "type": "n8n-nodes-base.set",
        "position": [
          784,
          32
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "package-name",
                "name": "packageName",
                "type": "string",
                "value": "Standard Package"
              },
              {
                "id": "package-price",
                "name": "packagePrice",
                "type": "string",
                "value": "$3,500 - $5,995"
              },
              {
                "id": "package-features",
                "name": "packageFeatures",
                "type": "string",
                "value": "‚Ä¢ Everything in Basic, PLUS:\n‚Ä¢ Up to 8 custom automations\n‚Ä¢ Advanced integrations (CRM, Slack, APIs)\n‚Ä¢ Multi-stage workflow sequences\n‚Ä¢ 60 days of priority support\n‚Ä¢ Monthly optimization review"
              },
              {
                "id": "case-study",
                "name": "caseStudy",
                "type": "string",
                "value": "A marketing agency automated their entire client onboarding process and reduced manual work by 80% with our Standard Package."
              },
              {
                "id": "booking-link",
                "name": "bookingLink",
                "type": "string",
                "value": "https://calendly.com/yourname/standard-package-call"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "f69dfe7a-a5c2-48a2-a1e1-3ac641767b17",
        "name": "Set Premium Package Details",
        "type": "n8n-nodes-base.set",
        "position": [
          784,
          256
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "package-name",
                "name": "packageName",
                "type": "string",
                "value": "Premium Package"
              },
              {
                "id": "package-price",
                "name": "packagePrice",
                "type": "string",
                "value": "$6,500 - $12,000"
              },
              {
                "id": "package-features",
                "name": "packageFeatures",
                "type": "string",
                "value": "‚Ä¢ Everything in Standard, PLUS:\n‚Ä¢ Unlimited automations\n‚Ä¢ Enterprise integrations & custom APIs\n‚Ä¢ AI-powered workflows (ChatGPT, Claude)\n‚Ä¢ Dedicated automation strategist\n‚Ä¢ 90 days of VIP support\n‚Ä¢ Quarterly strategy & optimization sessions"
              },
              {
                "id": "case-study",
                "name": "caseStudy",
                "type": "string",
                "value": "A SaaS company automated their entire sales pipeline from lead capture to onboarding and increased conversion rates by 45% with our Premium Package."
              },
              {
                "id": "booking-link",
                "name": "bookingLink",
                "type": "string",
                "value": "https://calendly.com/yourname/premium-package-call"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "e07455ec-2801-47cc-800a-835c19abbe4e",
        "name": "Send Package Recommendation",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1200,
          32
        ],
        "webhookId": "9c75e62a-d870-4b3f-8174-05b55a75d40d",
        "parameters": {
          "sendTo": "={{ $('Package Inquiry Form').item.json['Email Address'] }}",
          "message": "=<div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n\n<h1 style=\"color: #2c3e50;\">Hi {{ $('Package Inquiry Form').item.json['Full Name'].split(' ')[0] }}! üëã</h1>\n\n<p>Based on your budget of <strong>{{ $('Package Inquiry Form').item.json['Budget Range'] }}</strong> and your timeline (<strong>{{ $('Package Inquiry Form').item.json['Timeline'] }}</strong>), here's our recommendation:</p>\n\n<div style=\"background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 10px; margin: 20px 0;\">\n<h2 style=\"margin: 0 0 10px 0; color: white;\">{{ $json.packageName }}</h2>\n<p style=\"font-size: 24px; font-weight: bold; margin: 0;\">{{ $json.packagePrice }}</p>\n</div>\n\n<h3 style=\"color: #2c3e50;\">What's Included:</h3>\n<div style=\"background-color: #f8f9fa; padding: 20px; border-radius: 5px; white-space: pre-line;\">\n{{ $json.packageFeatures }}\n</div>\n\n<h3 style=\"color: #2c3e50; margin-top: 30px;\">Real Results:</h3>\n<p style=\"background-color: #e8f5e9; padding: 15px; border-left: 4px solid #4caf50; font-style: italic;\">{{ $json.caseStudy }}</p>\n\n<h3 style=\"color: #2c3e50;\">Your Challenge:</h3>\n<p style=\"background-color: #fff3cd; padding: 15px; border-left: 4px solid #ffc107;\">{{ $('Package Inquiry Form').item.json['Main Challenge'] }}</p>\n\n<p><strong>This package is specifically designed to address challenges like yours.</strong> Let's talk about how we can customize it to fit your exact needs.</p>\n\n<div style=\"text-align: center; margin: 40px 0;\">\n<a href=\"{{ $json.bookingLink }}\" style=\"background-color: #4CAF50; color: white; padding: 15px 40px; text-decoration: none; border-radius: 5px; font-size: 18px; font-weight: bold; display: inline-block;\">Book Your Free Strategy Call ‚Üí</a>\n</div>\n\n<p style=\"color: #666; font-size: 14px;\">No sales pitch. No obligation. Just a genuine conversation about whether we're the right fit for each other.</p>\n\n<hr style=\"border: none; border-top: 1px solid #eee; margin: 30px 0;\">\n\n<p style=\"font-size: 13px; color: #999;\">Questions? Just reply to this email - I read and respond to every message personally.</p>\n\n<p>Looking forward to connecting,<br><strong>Your Name</strong><br>Automation Specialist</p>\n\n</div>",
          "options": {},
          "subject": "Your Personalized Package: {{ $json.packageName }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "q6ykhKvA2dIxxYqm",
            "name": "XavEasyScalers"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "7d725aff-b967-4b1f-8044-8f8b87ad74e7",
        "name": "Update Pipeline Status",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1488,
          32
        ],
        "parameters": {
          "columns": {
            "value": {
              "Email": "={{ $('Package Inquiry Form').item.json['Email Address'] }}",
              "Status": "Package Sent",
              "Date Sent": "={{ $now.format('yyyy-MM-dd') }}",
              "Package Price": "={{ $json.packagePrice }}",
              "Follow-Up Date": "={{ $now.plus({ days: 3 }).format('yyyy-MM-dd') }}",
              "Package Recommended": "={{ $json.packageName }}"
            },
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Email"
            ]
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "name",
            "value": "Package Inquiries"
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "YOUR_GOOGLE_SHEET_ID"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "bNNrQVyG0f0LvHLl",
            "name": "xavtwl"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "af578034-3975-4116-a15f-bccf3a24e732",
        "name": "Schedule Follow-Up Reminder",
        "type": "n8n-nodes-base.googleCalendar",
        "position": [
          1744,
          32
        ],
        "parameters": {
          "end": "={{ $now.plus({ days: 3 }).format('yyyy-MM-dd') }}T10:30:00",
          "start": "={{ $now.plus({ days: 3 }).format('yyyy-MM-dd') }}T10:00:00",
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "primary",
            "cachedResultName": "primary"
          },
          "additionalFields": {}
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "Sz1H3GxTY4qYokGq",
            "name": "XTWL google Calendar"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "57f5bb11-5cee-4048-a89b-4599a4e946fd",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -656,
          -528
        ],
        "parameters": {
          "color": 6,
          "width": 560,
          "height": 1232,
          "content": "# üí∞ Package Recommender with Sales Pipeline Tracking\n\n## What It Does\nAutomatically recommends the right service package based on budget, sends beautifully formatted proposal emails with case studies, logs everything to a sales pipeline tracker, and schedules your follow-up reminders. Converts inquiries into booked calls without manual proposal writing.\n\n## How It Works\n1. **Form Trigger** ‚Üí Lead submits budget and challenge details\n2. **Log to Pipeline** ‚Üí All inquiry data saved to tracking sheet\n3. **Budget Router** ‚Üí Directs to Basic ($0-3K), Standard ($3-6K), or Premium ($6K+)\n4. **Set Package Variables** ‚Üí Loads appropriate features, pricing, case study\n5. **Send Proposal Email** ‚Üí Gorgeous HTML email with personalized package details\n6. **Update Pipeline** ‚Üí Marks \"Package Sent\" and sets follow-up date (+3 days)\n7. **Calendar Reminder** ‚Üí Creates event in 3 days reminding you to follow up\n\n---\n\n## üöÄ SETUP INSTRUCTIONS\n\n### Step 1: Create Sales Pipeline Sheet\n- Create Google Sheet with tab \"Package Inquiries\"\n- Add columns: `Timestamp | Name | Email | Phone | Budget | Timeline | Challenge | Package Recommended | Package Price | Status | Date Sent | Follow-Up Date`\n- Update `YOUR_GOOGLE_SHEET_ID` in nodes 2, 7, and calendar description\n\n### Step 2: Customize Package Details\n- Edit nodes 4, 5, 6 (Set Package Details nodes)\n- Update pricing, features, and case studies for your services\n- Replace booking links with your actual Calendly/scheduling URLs\n- Adjust package names if needed\n\n### Step 3: Configure Email Template\n- Edit node 7 email design/branding\n- Update \"Your Name\" and signature\n- Customize colors (currently: purple gradient, green CTA)\n- Test email rendering across devices\n\n### Step 4: Setup Calendar Integration\n- Add Google Calendar OAuth2 credentials\n- Verify follow-up timing (currently +3 days)\n- Customize reminder description with your workflow\n- Update Google Sheet link in calendar event"
        },
        "typeVersion": 1
      },
      {
        "id": "107b39c6-9d06-44ac-98ec-491ec20dad29",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          -336
        ],
        "parameters": {
          "color": 4,
          "width": 464,
          "height": 832,
          "content": "## Step 1: Capture And Log Inquiry\nPurpose: Collect package inquiries via form and store them in the sales pipeline sheet."
        },
        "typeVersion": 1
      },
      {
        "id": "3a9699ff-dddd-4f6d-9030-1f5d1258982e",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          -336
        ],
        "parameters": {
          "color": 5,
          "width": 656,
          "height": 832,
          "content": "## Step 2: Segment Lead And Set Package Details\nPurpose: Route each lead by budget and attach the matching package name, price, and feature set."
        },
        "typeVersion": 1
      },
      {
        "id": "448f0f21-cd48-4de7-b1fb-af6c779e68a7",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1072,
          -336
        ],
        "parameters": {
          "color": 4,
          "width": 336,
          "height": 832,
          "content": "## Step 3: Send Personalized Package Recommendation\nPurpose: Email the lead a tailored package offer based on their budget, timeline, and challenge.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "e5c84d22-d107-447d-ad02-2884eeaed6dd",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1424,
          -336
        ],
        "parameters": {
          "color": 5,
          "width": 496,
          "height": 832,
          "content": "## Step 4: Update Pipeline And Schedule Follow Up\nPurpose: Record the package status and dates in the sheet, then create a calendar reminder to follow up.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "25b0ad28-393d-4842-b482-a76692b71205",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1936,
          -528
        ],
        "parameters": {
          "color": 6,
          "width": 448,
          "height": 1232,
          "content": "## üîß Customization Options\n\n- **Add More Packages**: Add another Switch output and Set node for custom tier\n- **Different Follow-Up Timing**: Change `plus({ days: 3 })` in nodes 7 and 8\n- **Budget Ranges**: Modify Switch conditions in node 3 to match your pricing\n- **Include Attachments**: Add PDF proposals using HTTP Request + attachment option\n- **Multi-Stage Follow-Up**: Connect to Workflow 3 (Daily Follow-Up System)\n\n---\n\n## üö® Troubleshooting\n\n- **Wrong package sent**: Verify budget values in form exactly match Switch conditions\n- **Calendar not creating**: Check OAuth permissions and calendar selection (primary vs specific)\n- **Email formatting broken**: Test HTML in email preview tool (e.g., Litmus, Email on Acid)\n- **Sheet not updating**: Confirm Email column used as matching key and exists in both operations\n- **No reminder appearing**: Verify calendar event time is in future and notifications enabled\n\n---\n\n## üí° Enhancement Ideas\n\n- Add Stripe payment links directly in package email\n- Track email opens using tracking pixels\n- Send SMS notification when high-value inquiry comes in\n- Create separate sequences for different industries/niches\n- Add \"Fast Action Bonus\" discount for immediate bookings\n- Integrate with CRM (HubSpot, Pipedrive) for advanced pipeline management\n- Generate PDF proposal documents automatically"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "2ed3d528-bed4-4467-97f9-9f8062537de2",
    "connections": {
      "Route by Budget": {
        "main": [
          [
            {
              "node": "Set Basic Package Details",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Set Standard Package Details",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Set Premium Package Details",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Package Inquiry Form": {
        "main": [
          [
            {
              "node": "Log Inquiry to Pipeline",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Pipeline Status": {
        "main": [
          [
            {
              "node": "Schedule Follow-Up Reminder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Log Inquiry to Pipeline": {
        "main": [
          [
            {
              "node": "Route by Budget",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Basic Package Details": {
        "main": [
          [
            {
              "node": "Send Package Recommendation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Package Recommendation": {
        "main": [
          [
            {
              "node": "Update Pipeline Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Premium Package Details": {
        "main": [
          [
            {
              "node": "Send Package Recommendation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Standard Package Details": {
        "main": [
          [
            {
              "node": "Send Package Recommendation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "9a562c06a632241f66aadd52a495ad98e76b760ef5cfce9c319a4759c47cd94e",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "e9d9200c-3696-4f76-b04b-9472c205a39a",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -1936,
          -976
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 8
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "62cf078e-066a-492d-9882-c8dac3ea5baf",
        "name": "Edit Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          -1728,
          -976
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "2790e2d6-bf5f-4d3a-a02a-705afd3b1caf",
                "name": "stale_days",
                "type": "number",
                "value": 14
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "8a0f4a2f-9339-4de1-a614-e00ef8298139",
        "name": "Perform a query",
        "type": "n8n-nodes-base.salesforce",
        "position": [
          -1488,
          -976
        ],
        "parameters": {
          "query": "=Select id from opportunity where Stage_Unchanged_Days__c =  {{ $json.stale_days }} And StageName Not In ('Closed Won', 'Closed Lost')",
          "resource": "search"
        },
        "credentials": {
          "salesforceOAuth2Api": {
            "id": "LDbxyOy7NMH6fin9",
            "name": "Salesforce account 2"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "7ba41db7-0f84-4cd3-8a19-b0ea640601b5",
        "name": "Get an opportunity",
        "type": "n8n-nodes-base.salesforce",
        "position": [
          -1264,
          -976
        ],
        "parameters": {
          "resource": "opportunity",
          "operation": "get",
          "opportunityId": "={{ $json.Id }}"
        },
        "credentials": {
          "salesforceOAuth2Api": {
            "id": "LDbxyOy7NMH6fin9",
            "name": "Salesforce account 2"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "75389940-46a3-4512-aca9-b8c21bab5f9b",
        "name": "Message a model",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          -1040,
          -976
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5.1",
            "cachedResultName": "GPT-5.1"
          },
          "options": {},
          "responses": {
            "values": [
              {
                "role": "system",
                "content": "=You are a Salesforce Sales Follow-Up Assistant.\n\nYour job:\n- When an Opportunity stage has not changed for some time, draft:\n  1) A follow-up EMAIL to the client\n  2) A short SMS to the client\n  3) A concise SLACK message to the internal team\n\nYou will receive:\n- A Salesforce Opportunity record as JSON (called `opportunity`).\n{{ JSON.stringify($json) }}\n- Key fields include (but are not limited to):\n  - Id, Name, AccountId, StageName, Stage_Unchanged_Days__c,\n    Amount, CloseDate, Type, LeadSource, OwnerId,\n    MainCompetitors__c, OrderNumber__c, IsClosed, IsWon.\n\nYou have access to the following tool:\n- query_soql(soql: string)\n  - Executes a SOQL query and returns a list of records as JSON\n    with the fields specified in the SELECT clause.\n\nTOOL USAGE ‚Äì ALWAYS DO THESE QUERIES\n\n1) Fetch Opportunity Notes\n- Goal: personalize messages with recent context / pain points / last interactions.\n- Call `query_soql` with a SOQL that fetches notes on this Opportunity, for example:\n  - SELECT Id, Title, Body\n    FROM Note\n    WHERE ParentId = '{opportunity.Id}'\n    ORDER BY LastModifiedDate DESC\n    LIMIT 5\n- Use the returned notes (Title and Body) to understand:\n  - recent discussions,\n  - customer concerns,\n  - agreed next steps,\n  - any specific products or competitors mentioned.\n\n2) Fetch Primary Contact on the Account\n- Goal: address the right person and use email/phone where possible.\n- Call `query_soql` with a SOQL that fetches ONE contact for the Opportunity‚Äôs Account that has an Email, for example:\n  - SELECT Id, Name, Email, Phone\n    FROM Contact\n    WHERE AccountId = '{opportunity.AccountId}'\n      AND Email != null\n    ORDER BY LastModifiedDate DESC\n    LIMIT 1\n- Treat the returned Contact (if any) as the **primary contact**.\n- Use:\n  - Contact.Name to personalize greeting (‚ÄúHi <Name>,‚Äù).\n  - Contact.Email as the assumed receiver of the email.\n  - Contact.Phone for SMS (if Phone is null, still write an SMS template as if sent to their mobile).\n- If no contact is returned:\n  - Use a generic salutation like ‚ÄúHi there,‚Äù\n  - Still draft the email and SMS text as templates.\n\n3) Fetch Opportunity Owner (for Signature and Slack)\n- Goal: include the owner‚Äôs name (and optionally email) in the email signature and Slack mentions.\n- Call `query_soql` with a SOQL that returns the Owner user, for example:\n  - SELECT Id, Name, Email\n    FROM User\n    WHERE Id = '{opportunity.OwnerId}'\n    LIMIT 1\n- Use:\n  - Owner.Name in the email signature and in the Slack message.\n  - Owner.Email in the signature if available.\n  - Owner.Id (or opportunity.OwnerId) as the Task OwnerId.\n- If no owner record is returned, you can:\n  - Still use opportunity.OwnerId for the Task OwnerId field.\n  - Sign the email as ‚ÄúYour account manager‚Äù without a name.\n\nYou should:\n- Perform up to THREE calls to `query_soql` (Notes, Contact, Owner) at the beginning.\n- Incorporate the returned data into your reasoning before drafting any messages.\n- If a query returns no rows, handle it gracefully and write more generic content.\n\nCOMMUNICATION LOGIC\n\n- This assistant is triggered because `Stage_Unchanged_Days__c` indicates the stage has not changed for some time.\n- Adapt the messaging based on `StageName` and status flags:\n  - If the Opportunity is still open (IsClosed = false):\n    - Use a polite, value-driven nudge to move things forward.\n    - Reference any relevant notes or previous conversations.\n  - If the Opportunity is Closed Won (IsClosed = true AND IsWon = true):\n    - Treat it as a post-sale check-in, onboarding, or upsell touch.\n    - Confirm everything is going smoothly and offer next steps.\n  - If the Opportunity is Closed Lost (IsClosed = true AND IsWon = false):\n    - Keep it short: thank them, request brief feedback if appropriate, and keep the door open for future opportunities.\n- Refer to the delay naturally (‚Äúover the past few weeks‚Äù, ‚Äúrecently‚Äù) instead of exact day counts,\n  unless referencing Stage_Unchanged_Days__c is clearly helpful.\n\nSTYLE GUIDELINES\n\nEMAIL:\n- Audience: the primary Contact (if found) or generic client.\n- Tone: professional, friendly, concise.\n- Structure:\n  - Greeting: use Contact.Name if available; otherwise ‚ÄúHi there,‚Äù.\n  - Intro: who you are + why you‚Äôre reaching out (reference Opportunity Name in natural language:\n    e.g., ‚Äúyour order for mobile generators‚Äù).\n  - Context: mention that things have been quiet / unchanged for a while, referencing notes if possible.\n  - Value: 1‚Äì3 sentences focusing on next steps, clarifying questions, or how you can help.\n  - CTA: clear and simple (e.g., propose a time to talk, ask for confirmation/feedback).\n  - Signature:\n    - Include Owner.Name (and Owner.Email if available).\n    - Include company name or generic role (‚ÄúSales Team‚Äù) if needed.\n- Do NOT invent discounts, promises, or contractual commitments that are not mentioned.\n\nSMS:\n- Very short and to the point.\n- Assume they know who you/your company are (add a short identifier like ‚Äú‚Äì <Owner Name>, <Company>‚Äù).\n- Use a clear CTA (e.g., ‚ÄúReply if you‚Äôd like to schedule a quick call this week.‚Äù).\n- If Contact.Phone is missing, still generate an SMS template as if it will be sent to the right number later.\n\nSLACK (INTERNAL TEAM):\n- Target: Opportunity Owner and sales / deals channel.\n- Include:\n  - Opportunity Name, StageName, Amount, CloseDate, Stage_Unchanged_Days__c.\n  - Account/Contact name (if available).\n  - Short summary of key insights from Notes.\n  - Short summary of the angle of the email/SMS (no need to paste the full text).\n- Recommend the next internal action (e.g., ‚Äúcall the client‚Äù, ‚Äúreview pricing‚Äù, ‚Äúconfirm delivery timeline‚Äù).\n- Mention the Owner by name; if your environment supports @mentions, format text in a way that could be used\n\nTASK (for Owner):\n- Purpose: ensure there is a clear owner action in Salesforce linked to this Opportunity.\n- The Task should:\n    - Be assigned to the Opportunity Owner (OwnerId = opportunity.OwnerId or Owner.Id).\n    - Be related to the Opportunity (WhatId = opportunity.Id).\n    - Have a clear Subject describing the follow-up (e.g., ‚ÄúFollow up on stalled opportunity ‚Äì <Opportunity Name>‚Äù).\n    - Have a Description summarizing:\n      - Why the task was created (stage unchanged),\n      - Key context from notes,\n      - The gist of the email/SMS that will be sent.\n    - Use reasonable default fields:\n      - Status: \"Not Started\"\n      - Priority: \"Normal\"\n    - DueDate can be set conceptually to ‚Äútoday‚Äù or ‚Äútomorrow‚Äù as a short text description in the Description,\nbut leave it out of the api_body if you are not given a date field.\n\nOUTPUT FORMAT\n\nReturn ONLY a JSON object with this structure (no extra text, no markdown):\n\n{\n  \"email\": {\n    \"to\":\"email\"\n    \"subject\": \"string\",\n    \"body\": \"string\"\n  },\n  \"sms\": {\n    \"to\":\"Phone\"\n    \"body\": \"string\"\n  },\n  \"slack\": {\n    \"channel_hint\": \"string\",\n    \"message\": \"string\"\n  },\n  \"task\": {\n    \"subject\": \"string\",\n    \"description\": \"string\",\n    \"status\": \"string\",\n    \"priority\": \"string\",\n    \"api_body\": {\n    \"Subject\": \"string\",\n    \"Description\": \"string\",\n    \"Status\": \"string\",\n    \"Priority\": \"string\",\n    \"OwnerId\": \"string\",\n    \"WhatId\": \"string\"\n  }\n}\n\n- email.subject: clear and concise.\n- email.body: multi-paragraph email using \"\\n\\n\" for paragraph breaks.\n- sms.body: 1‚Äì3 sentences max.\n- slack.channel_hint: short hint to help route this message (e.g., \"#sales\", \"@OwnerName\", \"#opportunity-followup\").\n- slack.message: a concise message summarizing the situation and internal recommendation.\n\nREASONING\n\nBefore you generate the JSON:\n- Think through:\n  - What is the current stage and has it stalled?\n  - What do the Notes say about last interactions and customer concerns?\n  - Who is the primary Contact and how to address them?\n  - Who is the Owner and how to include them in signature and Slack?\n  - What is the most reasonable, low-friction next step for the client?\n  - What does the internal team need to know and do?\n\nThen, generate the JSON output EXACTLY in the specified schema.\n"
              }
            ]
          },
          "builtInTools": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "ciKVFfcmd36noEnL",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "29cfe789-91e7-48ef-8f5f-b7e15275b883",
        "name": "query_soql",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          -896,
          -736
        ],
        "parameters": {
          "url": "https://[mydomain].salesforce.com/services/data/v64.0/query/",
          "options": {},
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "q",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters0_Value', ``, 'string') }}"
              }
            ]
          },
          "toolDescription": "Use to query opportunity notes ",
          "nodeCredentialType": "salesforceOAuth2Api"
        },
        "credentials": {
          "salesforceOAuth2Api": {
            "id": "LDbxyOy7NMH6fin9",
            "name": "Salesforce account 2"
          }
        },
        "typeVersion": 4.3
      },
      {
        "id": "33b39d65-3f0e-4f4d-ba59-6770bd21a831",
        "name": "Create Task",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -336,
          -720
        ],
        "parameters": {
          "url": "https://[mydomain ].salesforce.com/services/data/v60.0/sobjects/Task",
          "method": "POST",
          "options": {},
          "jsonBody": "={{ $json.task.api_body }}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "salesforceOAuth2Api"
        },
        "credentials": {
          "salesforceOAuth2Api": {
            "id": "LDbxyOy7NMH6fin9",
            "name": "Salesforce account 2"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "cd24d4f9-9d47-4994-9b0a-26253ec5f7cd",
        "name": "Parse JSON",
        "type": "n8n-nodes-base.code",
        "position": [
          -720,
          -976
        ],
        "parameters": {
          "jsCode": "return JSON.parse($input.first().json.output[0].content[0].text)"
        },
        "typeVersion": 2,
        "alwaysOutputData": true
      },
      {
        "id": "7f5a791d-7a0e-42ec-b46e-599aa85c458b",
        "name": "Send Email SMTP Customer",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          -336,
          -1312
        ],
        "webhookId": "0d00699f-5b81-4090-a172-fdc18f658efa",
        "parameters": {
          "text": "={{ $json.email.body }}",
          "options": {},
          "subject": "={{ $json.email.subject }}",
          "toEmail": "={{ $json.email.to }}",
          "fromEmail": "=from@email.com",
          "emailFormat": "text"
        },
        "credentials": {
          "smtp": {
            "id": "JNtQ5FosqXaLKi5O",
            "name": "SMTP account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "c9998bd2-6222-45b0-917e-b9cb1a7948b1",
        "name": "Send Message To Internal Team",
        "type": "n8n-nodes-base.slack",
        "position": [
          -336,
          -1024
        ],
        "webhookId": "1dbf4e8a-16a6-4c49-9240-2d3c7f12d505",
        "parameters": {
          "text": "={{ $('Parse JSON').item.json.slack.message }}",
          "select": "channel",
          "channelId": {
            "__rl": true,
            "mode": "id",
            "value": "ChannelID"
          },
          "otherOptions": {}
        },
        "credentials": {
          "slackApi": {
            "id": "RS6fmPwwNPKGfeZC",
            "name": "Slack account"
          }
        },
        "typeVersion": 2.3
      },
      {
        "id": "850f5ec2-aa83-404f-be88-dbdec5524889",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2336,
          -1600
        ],
        "parameters": {
          "width": 320,
          "height": 368,
          "content": "**Stale Opportunity Follow-Up ‚Äì Email, Slack & Task**\n\nThis flow automatically follows up on Salesforce Opportunities whose stage hasn‚Äôt changed for a configured number of days. Each morning at 8:00, it finds ‚Äústale‚Äù Opportunities, enriches them with Notes, Contact and Owner data, and sends a personalized follow-up email to the client plus a Slack summary to the internal team. It also creates a Salesforce Task for the Opportunity Owner so every stalled deal has a clear next action and is tracked inside Salesforce.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8e038257-2fab-47c1-9765-5ae9f43db833",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2336,
          -1200
        ],
        "parameters": {
          "width": 320,
          "height": 832,
          "content": "**Setup & Testing Instructions**\n\n1. Create the `Stage_Unchanged_Days__c` field on Opportunity:\n   - Type: Formula (Number, 0 decimal places)  \n   - Formula:  \n     `IF(ISBLANK(LastStageChangeDate), TODAY() - DATEVALUE(CreatedDate), TODAY() - DATEVALUE(LastStageChangeDate))`  \n   This calculates how many days the Opportunity has been in its current stage (or since creation if `LastStageChangeDate` is blank) and is what the flow uses to detect ‚Äústale‚Äù deals.\n\n2. Configure credentials: make sure your Salesforce OAuth2, OpenAI API, SMTP and Slack credentials are all valid and selected in their nodes (Salesforce nodes, `query_soql`, `Create Task`, `Send Email SMTP Customer`, Slack node).  \n\n3. Adjust logic: set `stale_days` in the **Edit Fields** node to the number of days you consider a stage to be stalled (e.g. 7, 14). Optionally, refine the Salesforce query in **Perform a query** to match your pipeline rules.  \n\n4. Test safely: disable the **Schedule Trigger**, then run the flow manually on a small set of test Opportunities. Check the AI output in **Message a model** and **Parse JSON**, confirm Tasks are created in Salesforce, and verify the test email and Slack message look correct before re-enabling the schedule for production.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "42812b94-f828-4e1c-b7fa-befaa60352b0",
        "name": "Sticky Note ‚Äì Actions Summary",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -448,
          -1424
        ],
        "parameters": {
          "color": 7,
          "width": 736,
          "height": 896,
          "content": "## Send Email (SMTP)\nUses `email.to`, `email.subject`, `email.body` to email the customer.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Slack ‚Äì Internal Update\nPosts a short stale-opportunity summary to the selected Slack channel.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Create Salesforce Task\nUses `task.api_body` to create a follow-up Task linked to the Opportunity.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "eb1c4494-2e32-4dd3-915f-49395db2694f",
        "name": "Sticky Note ‚Äì AI Engine1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1088,
          -1168
        ],
        "parameters": {
          "color": 7,
          "width": 544,
          "height": 640,
          "content": "## AI Follow-Up Engine\nCalls the model with Opportunity data and the `query_soql` tool, then parses JSON into `email`, `sms`, `slack`, and `task.api_body`. Central brain and guardrail between AI and Salesforce, fetching live CRM data for smarter, safer follow-up automation.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "bcbb9e81-302e-4370-8bea-fd2389ab23af",
        "name": "Sticky Note ‚Äì Schedule & Threshold",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1984,
          -1168
        ],
        "parameters": {
          "color": 7,
          "width": 400,
          "height": 416,
          "content": "## Schedule & Stale Threshold\nRuns the flow on a schedule (default 8:00) and sets `stale_days` for the SOQL filter. Adjust the schedule or `stale_days` value here to match your follow-up policy.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "fd995303-b70e-4534-a038-70da75dbf451",
        "name": "Sticky Note ‚Äì Opportunity Fetch",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1568,
          -1168
        ],
        "parameters": {
          "color": 7,
          "width": 464,
          "height": 416,
          "content": "## Salesforce Opportunity Fetch\nQueries Salesforce for open Opportunities whose stage is unchanged for `stale_days`, excluding closed deals, then loads full Opportunity details for each match. This defines which deals are ‚Äústale‚Äù and provides rich context for AI follow-up.\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Parse JSON": {
        "main": [
          [
            {
              "node": "Send Email SMTP Customer",
              "type": "main",
              "index": 0
            },
            {
              "node": "Create Task",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send Message To Internal Team",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "query_soql": {
        "ai_tool": [
          [
            {
              "node": "Message a model",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create Task": {
        "main": [
          []
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Perform a query",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Message a model": {
        "main": [
          [
            {
              "node": "Parse JSON",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Perform a query": {
        "main": [
          [
            {
              "node": "Get an opportunity",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get an opportunity": {
        "main": [
          [
            {
              "node": "Message a model",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Email SMTP Customer": {
        "main": [
          []
        ]
      }
    }
  },
  {
    "id": "rApsjUd8dqh2ySSV",
    "meta": {
      "instanceId": "25c199642db438990006dd3c95e9c2bc11faee0ea33efdd495644a882d3b7117"
    },
    "name": "Deep Research AI Workflow",
    "tags": [],
    "nodes": [
      {
        "id": "27d13444-fc79-40ec-a483-3ffccd4ef7d4",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          784,
          176
        ],
        "webhookId": "a5ea9aa7-a977-4976-aeb2-e781fc863097",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.3
      },
      {
        "id": "12afa4de-2a04-4143-bbdf-400717423285",
        "name": "Search Google",
        "type": "n8n-nodes-oxylabs-ai-studio.oxylabsAiStudio",
        "position": [
          1792,
          176
        ],
        "parameters": {
          "resource": "search",
          "searchQuery": "={{ $json.query }}",
          "searchReturnContent": false
        },
        "retryOnFail": true,
        "typeVersion": 1,
        "waitBetweenTries": 1000
      },
      {
        "id": "2c795a46-4418-497b-b5d7-908f42db8d3a",
        "name": "Split URLs",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          2352,
          176
        ],
        "parameters": {
          "options": {
            "destinationFieldName": "url"
          },
          "fieldToSplitOut": "output[0].content[0].text.urls"
        },
        "typeVersion": 1
      },
      {
        "id": "53cf66de-b210-4b5d-b631-d80633612c5e",
        "name": "Split queries",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1328,
          176
        ],
        "parameters": {
          "options": {
            "destinationFieldName": "query"
          },
          "fieldToSplitOut": "output[0].content[0].text.queries"
        },
        "typeVersion": 1
      },
      {
        "id": "ffea02a2-0341-4d34-89a2-aa8288154119",
        "name": "Get number of URLs",
        "type": "n8n-nodes-base.set",
        "position": [
          1712,
          752
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "d55ad15b-5d31-4103-b2b5-c9d0158c7558",
                "name": "length",
                "type": "string",
                "value": "={{ $('Split URLs').all().length }}"
              }
            ]
          }
        },
        "executeOnce": true,
        "typeVersion": 3.4
      },
      {
        "id": "ad23e5a2-81be-4aab-b5b8-59f62f8eb91e",
        "name": "Get all data",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          2848,
          432
        ],
        "parameters": {
          "operation": "get",
          "returnAll": true,
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "ZNXGefBcwkYYdyDE",
            "cachedResultUrl": "/projects/jsKya8bKmDGhXtT2/datatables/ZNXGefBcwkYYdyDE",
            "cachedResultName": "Content summaries"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e3b3d79a-1cb8-45f0-802d-7fd5e2bd0db4",
        "name": "Get current data for polling",
        "type": "n8n-nodes-base.dataTable",
        "maxTries": 5,
        "position": [
          1936,
          752
        ],
        "parameters": {
          "operation": "get",
          "returnAll": true,
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "ZNXGefBcwkYYdyDE",
            "cachedResultUrl": "/projects/jsKya8bKmDGhXtT2/datatables/ZNXGefBcwkYYdyDE",
            "cachedResultName": "Content summaries"
          }
        },
        "executeOnce": false,
        "notesInFlow": false,
        "retryOnFail": false,
        "typeVersion": 1,
        "alwaysOutputData": false,
        "waitBetweenTries": 5000
      },
      {
        "id": "9996d9ba-083c-44e5-9487-1f7008247a87",
        "name": "If all data exists",
        "type": "n8n-nodes-base.if",
        "position": [
          2320,
          656
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "or",
            "conditions": [
              {
                "id": "9b2069cc-152e-490e-8c87-3687f24d350c",
                "operator": {
                  "type": "number",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.id.last() }}",
                "rightValue": "={{ $('Get number of URLs').item.json.length }}"
              }
            ]
          },
          "looseTypeValidation": true
        },
        "executeOnce": false,
        "typeVersion": 2.2
      },
      {
        "id": "d5760b93-94a9-4b42-acf2-b35ec10babf6",
        "name": "Extract IDs",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          2096,
          752
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "id"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5effde9e-3260-49d6-8058-6c1b9ea31a8f",
        "name": "Wait 60s",
        "type": "n8n-nodes-base.wait",
        "position": [
          1472,
          864
        ],
        "webhookId": "18e044ce-5518-45e1-9828-8405432614e0",
        "parameters": {
          "amount": 60
        },
        "typeVersion": 1.1
      },
      {
        "id": "0c6e19c9-12c5-4217-b605-e9157965a15c",
        "name": "Wait 10s",
        "type": "n8n-nodes-base.wait",
        "position": [
          2304,
          912
        ],
        "webhookId": "a109b907-16d0-4d05-be48-cc751368e4ca",
        "parameters": {
          "amount": 10
        },
        "typeVersion": 1.1
      },
      {
        "id": "70ab5aa1-8d40-4be1-b90d-522b01d1ed63",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 960,
          "height": 448,
          "content": "# üîé  STEP 1: Create Google search queries\nSubmit your message/questions, automatically create strategic Google Search queries, and make them ready for processing."
        },
        "typeVersion": 1
      },
      {
        "id": "44a7c413-9768-4e11-a7b7-ff9a28b1e47c",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1664,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 960,
          "height": 448,
          "content": "# üìå  STEP 2: Scrape Google & pick relevant URLs\nScrape Google Search results for each query, select relevant and authoritative sources from all results, and prepare the list of URLs for further processing."
        },
        "typeVersion": 1
      },
      {
        "id": "18aa0a13-86ff-4024-9370-2706aec66546",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          512
        ],
        "parameters": {
          "color": 7,
          "width": 960,
          "height": 704,
          "content": "# üìë  STEP 3: Scrape & summarize content in parallel\n\nScrape content from each URL, summarize it with AI, and save it into a data table. Make sure to convert the 3 nodes below to a sub-workflow and edit its setting to enable parallel execution. **See the setup instructions**."
        },
        "typeVersion": 1
      },
      {
        "id": "31855d55-0845-48e5-b0c2-787c57cda75f",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1664,
          512
        ],
        "parameters": {
          "color": 7,
          "width": 960,
          "height": 704,
          "content": "# ‚è≥  STEP 4: Wait for data\nCheck the data table whether the last row's ID matches the amount of URLs we've sent to the sub-workflow. If it doesn't, wait for 10 seconds and repeat."
        },
        "typeVersion": 1
      },
      {
        "id": "214c885f-34f7-4164-8284-cf0a4d3c7a3e",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2688,
          288
        ],
        "parameters": {
          "color": 7,
          "width": 768,
          "height": 400,
          "content": "# ‚úÖ STEP 5: Create final analysis\nGet all summaries from the data table and analyze everything with AI to produce a comprehensive deep research report."
        },
        "typeVersion": 1
      },
      {
        "id": "87025c0d-ae1d-4158-baea-e11c158dc4da",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "width": 576,
          "height": 1216,
          "content": "# ‚ö°Ô∏é  Fast Deep Research AI Flow\n\nFully automate **deep research from start to finish**: scrape Google Search results, select relevant sources, scrape & analyze each source in parallel, and generate a comprehensive research report.\n\nCheck out the [comprehensive step-by-step tutorial](https://blog.n8n.io/build-a-fast-deep-research-automation-flow-with-oxylabs-and-n8n/) on the n8n blog.\n\n\n## ‚ùì How it works\n1. **Submit your research questions** through n8n‚Äôs chat interface\n2. **AI generates strategic search queries** to explore different angles of your topic\n3. **Oxylabs scrapes Google Search** results for each query\n4. **AI evaluates and selects sources** that are the most relevant and authoritative\n5. **Content extraction runs in parallel** via a sub-workflow as Oxylabs scrapes each source and AI extracts key insights\n6. **Summaries are collected in n8n‚Äôs data table** for final processing\n7. **AI synthesizes everything** into a comprehensive research report with actionable insights\n\n\n\n\n##  ‚ö†Ô∏è  Requirements\n1. üÜì Create a **[free Oxylabs AI Studio key](https://aistudio.oxylabs.io/)** ‚Äì 1000 credits\n2. üß† Create **OpenAI API key** ‚Äì or use Gemini, Claude, or local Ollama models\n\n\n\n## ‚öôÔ∏è Setup\n1. **Install Oxylabs AI Studio** as [shown on this page](https://n8n.io/integrations/oxylabs-ai-studio/)\n2. **Set your API keys**:\n    1.1 Oxylabs AI Studio\n    1.2 OpenAI\n3. **Create a [data table](https://docs.n8n.io/data/data-tables/) inside n8n**\n4. **Select the table name** in each data table node\n5. **Create a sub-workflow**:\n    4.1 Select the 3 nodes (Scrape content, Summarize content, Insert row)\n    4.2 Right-click\n    4.3 Select ‚ÄúConvert 3 nodes to sub-workflow‚Äù\n6. **Edit the sub-workflow settings** for for parallel execution:\n    5.1 Mode: Run once for each item\n    5.2 Options ‚Üí Add Option ‚Üí disable ‚ÄúWait For Sub-Workflow Completion‚Äù\n"
        },
        "typeVersion": 1
      },
      {
        "id": "77a2e3e0-3bb0-45ea-bfe8-0b25e84ca397",
        "name": "Create search queries",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          992,
          176
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5-mini",
            "cachedResultName": "GPT-5-MINI"
          },
          "options": {
            "textFormat": {
              "textOptions": {
                "type": "json_object",
                "verbosity": "low"
              }
            }
          },
          "responses": {
            "values": [
              {
                "content": "={{ $json.chatInput }}"
              },
              {
                "role": "system",
                "content": "You are a part of a deep research team. Your task is to analyze the user's message and create highly specific Google Search queries that will uncover precise and actionable information.\n\nGuidelines for creating search queries:\n- Include ALL key requirements and constraints from the user's message in your queries\n- Every query MUST include the core topic/goal from the user's message\n- Each query must explore a DIFFERENT angle or aspect of the topic\n- Prioritize specificity over breadth - avoid generic terms\n- Use exact terminology and technical terms when relevant\n- Each query should be 4-8 words to balance specificity with searchability\n\nProvide 3 search queries in a list that together cover the full scope of what needs to be researched."
              }
            ]
          },
          "builtInTools": {}
        },
        "typeVersion": 2
      },
      {
        "id": "3d580a2b-a175-43b4-8187-bd1790efb58c",
        "name": "Pick URLs",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          2016,
          176
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5-mini",
            "cachedResultName": "GPT-5-MINI"
          },
          "options": {
            "textFormat": {
              "textOptions": {
                "type": "json_object",
                "verbosity": "low"
              }
            }
          },
          "responses": {
            "values": [
              {
                "content": "={{ JSON.stringify($input.all().flatMap(item => item.json.data || [])) }}"
              },
              {
                "role": "system",
                "content": "=You are a part of a deep research team.\nAnalyze the provided Google SERP results and select up to 10 of the most relevant and trustworthy distinct sources for answering this question:\n\"{{ $('When chat message received').item.json.chatInput }}\"\n\nImportant: The Google SERP results are combined from different searches into a single list. Each search term was distinct:\n{{ $('Create search queries').item.json.output[0].content[0].text.queries }}\n\nEvaluation criteria:\n- Prioritize authoritative sources (official sites, established publications, expert domains)\n- Use the SERP descriptions to assess topical relevance to the user's question\n- Prefer recent, primary sources over aggregators when applicable\n\nReturn only the selected URLs compiled into a single JSON array: {\"urls\": [\"url1\", \"url2\", \"url3\"]}\n\nIf fewer than 10 sources meet the criteria, return only the quality ones."
              }
            ]
          },
          "builtInTools": {}
        },
        "executeOnce": true,
        "typeVersion": 2
      },
      {
        "id": "b901ffde-9522-46b8-b7a8-d6f3f22af22c",
        "name": "Scrape content",
        "type": "n8n-nodes-oxylabs-ai-studio.oxylabsAiStudio",
        "position": [
          736,
          688
        ],
        "parameters": {
          "scrapeUrl": "={{ $json.url }}"
        },
        "executeOnce": false,
        "retryOnFail": true,
        "typeVersion": 1
      },
      {
        "id": "9b7d6165-ec14-47a0-9e73-23e837b5df19",
        "name": "Insert row",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          1296,
          688
        ],
        "parameters": {
          "columns": {
            "value": {
              "summary": "={{ $json.output[0].content[0].text }}"
            },
            "schema": [
              {
                "id": "summary",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "summary",
                "defaultMatch": false
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "summary"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "ZNXGefBcwkYYdyDE",
            "cachedResultUrl": "/projects/jsKya8bKmDGhXtT2/datatables/ZNXGefBcwkYYdyDE",
            "cachedResultName": "Content summaries"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "6bb49288-2aba-4495-b9c2-1f41b11d6bea",
        "name": "Summarize content",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          944,
          688
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5",
            "cachedResultName": "GPT-5"
          },
          "options": {},
          "responses": {
            "values": [
              {
                "content": "={{ $json.data }}"
              },
              {
                "role": "system",
                "content": "=You are a member of a deep research team and you specificaly focus on extracting relevant information from provided web sources. Analyze the provided Markdown content and extract information relevant to the user's question.\n\nStructure your response in Markdown with these sections:\n\n# Key Findings\nList the main facts, statistics, or claims relevant to the question. Provide as much details as necessary.\n\n# Step-by-Step Instructions (skip if none)\nIf the content includes procedural steps or how-to information, extract them here. Provide as much in detail as necessary.\n\n# Supporting Details\nAdditional context, explanations, or evidence that supports the findings\n\nCRITICAL RULES:\n- Only extract information present in the source - never infer or add external knowledge\n- If the source doesn't address part of the question, state \"Not covered in this source\"\n- Keep extractions concise but preserve key specifics (numbers, dates, technical terms)\n- Use bullet points for clarity\n- Provide a 700-1000 words summary\n\nUser's Question:\n{{ $('Start').item.json.chatInput }}"
              }
            ]
          },
          "builtInTools": {}
        },
        "typeVersion": 2
      },
      {
        "id": "27fd20bb-87cb-4bb9-814e-03fc493926bb",
        "name": "Final analysis",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          3088,
          432
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5",
            "cachedResultName": "GPT-5"
          },
          "options": {},
          "responses": {
            "values": [
              {
                "content": "={{ JSON.stringify($input.all().flatMap(item => item.json.summary || [])) }}"
              },
              {
                "role": "system",
                "content": "=You are a senior research analyst in a deep research team. Your role is to synthesize multiple content summaries into a comprehensive and actionable final report.\n\n## YOUR TASK\nAnswer this user question using ONLY the provided summaries:\n{{ $('When chat message received').item.json.chatInput }}\n\n## CRITICAL RULES\n- **Use ONLY the provided summaries** - Do not add information from your training data or make assumptions beyond what's explicitly stated in the summaries\n- Maximum 1500 words\n\n## REPORT STRUCTURE\n1. **Executive Summary** - Direct answer and key takeaway (2-3 sentences)\n2. **Main Analysis** - Synthesize findings, identify patterns, consensus views\n3. **Actionable Recommendations** - Specific steps the user can take, prioritized suggestions based on data, clear next actions\n4. **Gaps & Limitations** - Missing information and areas needing more research (short section, max 100 words)\n\n## STYLE GUIDELINES\n- Be concise and direct - avoid fluff or repetition\n- Always use clear HEADINGS and FORMATTING for scanability\n- When sources disagree, present both perspectives fairly\n\n## FORMATTING REQUIREMENTS\nUse RICH Markdown formatting for readability:\n- H1, H2, H3, H4 headings to structure content\n- Bold text for emphasis on key findings\n- Tables for comparisons or structured data\n- Bullet lists and numbered lists when appropriate\n- inline code and code blocks where relevant\n- Keep paragraphs concise"
              }
            ]
          },
          "builtInTools": {}
        },
        "executeOnce": true,
        "typeVersion": 2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "a8d7464d-d4ee-4cc5-8bf8-7eb863a409c2",
    "connections": {
      "Wait 10s": {
        "main": [
          [
            {
              "node": "Get current data for polling",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 60s": {
        "main": [
          [
            {
              "node": "Get number of URLs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pick URLs": {
        "main": [
          [
            {
              "node": "Split URLs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Insert row": {
        "main": [
          [
            {
              "node": "Wait 60s",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split URLs": {
        "main": [
          [
            {
              "node": "Scrape content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract IDs": {
        "main": [
          [
            {
              "node": "If all data exists",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get all data": {
        "main": [
          [
            {
              "node": "Final analysis",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search Google": {
        "main": [
          [
            {
              "node": "Pick URLs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split queries": {
        "main": [
          [
            {
              "node": "Search Google",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Scrape content": {
        "main": [
          [
            {
              "node": "Summarize content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Summarize content": {
        "main": [
          [
            {
              "node": "Insert row",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get number of URLs": {
        "main": [
          [
            {
              "node": "Get current data for polling",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If all data exists": {
        "main": [
          [
            {
              "node": "Get all data",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait 10s",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create search queries": {
        "main": [
          [
            {
              "node": "Split queries",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Create search queries",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get current data for polling": {
        "main": [
          [
            {
              "node": "Extract IDs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "8RiTOY4w1qA2cIHH",
    "meta": {
      "instanceId": "38ca7e7c56bd100b75ffa3078e60870ab62a811559dc904ac56ffa5d1f2960d4"
    },
    "name": "Automate weekly Hollywood film briefing via Tavily and Gemini",
    "tags": [],
    "nodes": [
      {
        "id": "6c3feb79-dbbe-4e1c-849d-3a1792865611",
        "name": "Send a message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2016,
          400
        ],
        "webhookId": "68887666-c2da-4012-8d34-1713fb13960d",
        "parameters": {
          "sendTo": "titanfactz@gmail.com",
          "message": "={{ $json.output.body }}",
          "options": {},
          "subject": "={{ $json.output.subject }}"
        },
        "typeVersion": 2.1
      },
      {
        "id": "f299b3c1-3293-4aaa-8885-be14992c313e",
        "name": "Hollywood News Research Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1248,
          400
        ],
        "parameters": {
          "text": "=You are an AI summarizer creating a daily Hollywood film industry briefing.\n\nYou will receive four Tavily search results:\n- Hollywood movies releasing this week\n- Hollywood box office results last week\n- Hollywood news\n- Must‚Äëwatch Hollywood movies currently in theatres\n\nEach result contains `title` and `content`.\n\n---\n\n### TASK\nSummarize each result into Gmail‚Äëfriendly HTML with emojis and bullet points:\n\nüé¨ Releases  \nüìä Box Office  \nüì∞ News  \nüé• Must-Watch Movies  \n\nFor **Must-Watch Movies**:\n- If details (reviews/hype) exist, summarize them briefly.\n- If only movie names appear, **assume reasons** (e.g., ‚Äúgreat for IMAX/4DX,‚Äù ‚Äúbig visual effects,‚Äù ‚Äúaudience buzz,‚Äù or ‚Äúfan‚Äëfavorite franchise‚Äù).\n\nIf no data at all, write ‚ÄúNo data available‚Äù.\n\n---\n\n### OUTPUT FORMAT\nReturn JSON:\n{\n  \"subject\": \"Daily Hollywood Film Industry Briefing ‚Äì {{ $json['Readable date'] }}\",\n  \"body\": \"<html>\n    üé¨ Releases\n    <ul><li>Movie 1</li></ul>\n    üìä Box Office\n    <ul><li>Result 1</li></ul>\n    üì∞ News\n    <ul><li>Update 1</li></ul>\n    üé• Must-Watch Movies\n    <ul><li>Recommendation 1 with assumed reason (if needed)</li></ul>\n  </html>\"\n}\n",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2.1
      },
      {
        "id": "dc02dc33-b13b-4892-b5a6-470a37034b31",
        "name": "Fetch Weekly Releases (Tavily)",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          1024,
          624
        ],
        "parameters": {
          "url": "https://api.tavily.com/search",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"query\": \"hollywood movies releasing this week\",\n  \"search_depth\": \"basic\",\n  \"time_range\": \"week\",\n  \"max_results\": 5\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "{{$credentials.TavilyApiKey}}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f0000837-1172-4c5a-8aea-791e032362d4",
        "name": "Fetch Weekly Box Office (Tavily)",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          1216,
          624
        ],
        "parameters": {
          "url": "https://api.tavily.com/search",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"query\": \"hollywood box office results last week\",\n  \"search_depth\": \"basic\",\n  \"time_range\": \"week\",\n  \"max_results\": 5\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "{{$credentials.TavilyApiKey}}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "07db402d-013d-4e4b-9fa4-ad7061bf9bb8",
        "name": "Fetch Hollywood News (Tavily)",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          1408,
          624
        ],
        "parameters": {
          "url": "https://api.tavily.com/search",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"query\": \"hollywood news latest casting director production\",\n  \"search_depth\": \"basic\",\n  \"time_range\": \"week\",\n  \"max_results\": 5\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "{{$credentials.TavilyApiKey}}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "b4f79b09-9400-4320-bf1c-0d80c7f6f81b",
        "name": "Fetch Must-Watch Movies (Tavily)",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          1600,
          624
        ],
        "parameters": {
          "url": "https://api.tavily.com/search",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"query\": \"best hollywood movies playing in theatres\",\n  \"search_depth\": \"basic\",\n  \"time_range\": \"week\",\n  \"max_results\": 5\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "{{$credentials.TavilyApiKey}}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "ae3101db-1b83-410c-a652-9d98f6e923c1",
        "name": "Format Output for Email",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1808,
          624
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"subject\": \"Daily Hollywood Film Industry Briefing ‚Äì July 25, 2025\",\n  \"body\": \"<html> ... formatted content ... </html>\"\n}\n"
        },
        "typeVersion": 1.3
      },
      {
        "id": "616af767-7d9e-46c0-95ce-052d98eb17bf",
        "name": "Weekly Thursday Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          656,
          400
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "weeks",
                "triggerAtDay": [
                  4
                ],
                "triggerAtHour": 7
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "d2a93b27-543b-4701-95a3-6536613c3531",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "width": 576,
          "height": 992,
          "content": "## Try It Out! üé¨(for free)\n\n### This n8n template demonstrates how to build a **weekly Hollywood film industry briefing** using Tavily for real-time search and Google Gemini for summarization. It sends a concise, emoji‚Äëstyled email with **movie releases, box office results, industry news, and must‚Äëwatch recommendations**.\n\nUse cases: Perfect for **film journalists, entertainment blogs, or movie fans** who want an automated weekly update in their inbox.\n\n### How it works\n\n* **Trigger:** Scheduled every Thursday morning (configurable).\n* **Search:** Four Tavily API calls fetch:\n  * Movies releasing this week\n  * Last week‚Äôs box office results\n  * Hollywood industry news\n  * Must-watch movies currently in theatres\n* **Summarization:** Google Gemini processes the search results and formats them into Gmail‚Äëfriendly HTML with emojis and bullet points.\n* **Output:** Email sent automatically via Gmail node with subject and formatted briefing.\n\n### How to use\n\n* Configure **Tavily API** and **Gmail OAuth2** credentials in n8n.\n* (Optional) Edit search queries in Tavily nodes to focus on specific genres or regions.\n* Adjust the **schedule trigger** to your preferred day/time.\n\n### Requirements\n\n* Tavily API account (free tier available)\n* Google Gemini API key for summarization\n* Gmail account (OAuth2 credentials)\n\n### Need Help?\n\nDM me on [X (formerly Twitter)](https://x.com/manav170303) or email [titanfactz@gmail.com](mailto:titanfactz@gmail.com).\n\nAlways open to feedback and improvements!\n"
        },
        "typeVersion": 1
      },
      {
        "id": "69476e75-f1a9-4bdb-8de6-89ceb6b55eaa",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2272,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 752,
          "height": 896,
          "content": "## Example Email Output\n\n**Daily Hollywood Film Industry Briefing ‚Äì 2025, 07:00 am**\nInbox\n\n[titanfactz@gmail.com](mailto:titanfactz@gmail.com)\n07:00am (0 minutes ago)\nto me\n\n## üé¨ **Releases**\n* Dora and the Search for Sol Dorado (July 2, 2025)\n* Jurassic World Rebirth (July 2, 2025)\n* The Old Guard 2 (July 2, 2025)\n* The Sound (June 27, 2025)\n\n## üìä **Box Office**\n* Fantastic Four: First Steps ‚Äì estimated \\$40M-\\$45M opening\n* Bad Guys 2 ‚Äì estimated \\$22M opening\n* Naked Gun ‚Äì estimated \\$16M opening\n* Together ‚Äì estimated \\$10M+ over 5-day opening\n* Superman ‚Äì \\$24.8 million last week (\\$289.5 million total)\n* Jurassic World: Rebirth ‚Äì \\$13.0 million last week (\\$301.5 million total)\n* F1: The Movie ‚Äì \\$6.2 million last week (\\$165.5 million total)\n\n## üì∞ **News**\n* Michael Pe√±a joins Chris Hemsworth and Lily James in Amazon‚Äôs new submarine action film, *Subversion*.\n* Casting director seeks 2,000 extras for a massive concert scene in the new TV series *9-1-1*.\n* *Emily in Paris* casting director Juliette Menager discusses finding Sylvie and Camille Razat‚Äôs exit.\n\n## üé• **Must-Watch Movies**\n* Caught by the Tides ‚Äì Jia Zhangke‚Äôs latest experimental film blending memories and archives.\n* Sinners ‚Äì Highly rated 9.5/10, a compelling cinematic experience.\n* Fantastic Four: The First Steps ‚Äì A big Marvel win, rated 9/10 with stunning visuals.\n* MI: The Final Reckoning ‚Äì Rated 8.5/10, audiences are buzzing about this action-packed finale.\n* Superman ‚Äì Fan-favorite franchise, rated 8.5/10, delivering powerful storytelling.\n* Ballerina ‚Äì Rated 8.5/10, expected to feature breathtaking choreography and action.\n* Thunderbolts ‚Äì Rated 7.5/10, thrilling ensemble film with dynamic character arcs."
        },
        "typeVersion": 1
      },
      {
        "id": "c1a150d1-ea4b-4974-9666-da79e1d58111",
        "name": "Google Gemini 2.5 Flash",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          816,
          624
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "e7127690-4873-41c2-b900-56efc200d570",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          896,
          1248
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "weeks",
                "triggerAtDay": [
                  5
                ],
                "triggerAtHour": 7
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6ce1e1b9-397a-410f-aa75-19e5cc1467ee",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1296,
          1248
        ],
        "parameters": {
          "text": "=You are an AI summarizer creating a daily Hollywood film industry briefing.\nYou have access to web search and must perform FOUR structured searches and summarize results into a clean, factual briefing.\n\nSearch Tasks\n1) Weekly Movie Releases (Hollywood)\nFind up to 10 movies releasing in theatres THIS WEEK ONLY.\n\nStrictly exclude:\n\nOTT releases or web series\n\nOld or previously released movies (even if trending or re-released)\n\nMonthly/yearly recap lists\n\nProvide for each movie:\n\nName\n\nExact release date\n\nDay of the week (e.g., Friday)\n\nVerify releases are between Monday‚ÄìSunday of the current week based on {{ $json['Readable date'] }}.\nIf fewer than 10, include as many accurate releases as possible.\n\n2) Box Office Results (Hollywood)\nFind:\n\nTop highest-grossing Hollywood films of THIS YEAR (worldwide gross)\n\nLast week‚Äôs box office performance (Hollywood) with gross numbers\n\nHighlight notable new releases and trends (e.g., record-breaking debut, strong overseas performance).\n\nCurrent week is {{ $json['Readable date'] }}, current day is {{ $json['Day of week'] }}.\nIgnore any box office data older than last week.\n\n3) Industry Buzz (Casting / Directors / Strikes)\nProvide exactly 7 major updates from Hollywood:\n\nCasting announcements\n\nDirector signings/new projects\n\nProduction updates & filming progress\n\nStrikes, controversies, industry events\n\nMust be from this week only (ignore outdated news).\nProvide detailed summaries (context + relevance).\nDo not include links ‚Äî summaries only.\nMust always give 7 updates, even if some are long.\n\n4) Best Movies Currently in Theatres\nRecommend best currently running Hollywood movies in theatres in Surat, India.\n\nExclude old films (e.g., pre-2025 releases like Fast X or Oppenheimer).\n\nProvide:\n\nWhy recommended (reviews, visuals, fan hype)\n\nBest format (e.g., IMAX, 3D, standard)\n\nOnly include movies running this week or recently released (before {{ $json['Readable date'] }}).\n\nFormatting Rules\nMovie names must be plain text (no bold, no markdown).\n\nUse emojis for section headers:\n\nüé¨ Releases\n\nüìä Box Office\n\nüì∞ Industry Buzz\n\nüé• Must-Watch in Theatres\n\nInclude release dates, box office numbers where available.\n\nIf no data for a section, output ‚ÄúNo data available‚Äù (do not guess).\n\nOutput Requirements\nReturn as a JSON object with two keys:\n\nsubject: Daily Hollywood Film Industry Briefing ‚Äì {{ $json['Readable date'] }}\n\nbody: Full HTML email (Gmail-friendly) with sections, bullet lists, emojis, and clean formatting. No markdown.\n\nCritical Instructions\nUse only fresh search results (ignore outdated or evergreen data).\n\nExclude re-released films unless explicitly stated as new this week.\n\nEnsure weekly relevance: include only events/releases around this week‚Äôs date.\n\nAvoid duplicates; merge similar data cleanly.\n\nPrioritize accuracy ‚Äî if unsure, clearly state ‚ÄúNo data available.‚Äù",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 2.1
      },
      {
        "id": "60e63ea3-63ce-48f2-ae77-f81ec89b27d9",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1248,
          1472
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "0158b036-f57d-4478-9184-1755ecc0de35",
        "name": "HTTP Request",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          1520,
          1472
        ],
        "parameters": {
          "method": "POST",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "8f68597f-06e7-403f-8dd0-57fdce9b48e8",
        "name": "Send a message1",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1856,
          1248
        ],
        "webhookId": "68887666-c2da-4012-8d34-1713fb13960d",
        "parameters": {
          "sendTo": "titanfactz@gmail.com",
          "message": "={{ $json.output.body }}",
          "options": {},
          "subject": "={{ $json.output.subject }}"
        },
        "typeVersion": 2.1
      },
      {
        "id": "77f7fc9d-69fc-40a6-b2f3-bc7374571ecc",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2160,
          1104
        ],
        "parameters": {
          "color": 7,
          "width": 944,
          "height": 1504,
          "content": "**Subject:** Daily Hollywood Film Industry Briefing ‚Äì August 3, 2025\n\n---\n\nGood morning,\nHere's your daily Hollywood film briefing for August 3, 2025:\n\n---\n\nüé¨ **Releases**\n\n* The Bad Guys 2 ‚Äì Released Friday, August¬†1,¬†2025\n* The Naked Gun ‚Äì Released Friday, August¬†1,¬†2025\n\nThese are the confirmed new wide theatrical Hollywood releases this week (Monday through Sunday of current week). No additional new Hollywood theatrical releases found for this week.\n\n---\n\nüìä **Box Office**\n\n**Highest‚Äëgrossing Hollywood films of 2025 (worldwide):**\n\n* Ne Zha¬†2 ‚Äì approx. \\$1.90‚ÄØbillion (non‚ÄëHollywood Chinese animated film leads)\n* Lilo & Stitch ‚Äì approx. \\$1.02‚ÄØbillion\n* A Minecraft Movie ‚Äì approx. \\$955‚ÄØmillion\n* Jurassic World Rebirth ‚Äì approx. \\$731‚ÄØmillion\n* How to Train Your Dragon ‚Äì approx. \\$610‚ÄØmillion\n\n**Last week‚Äôs box office performance (Monday‚ÄìSunday):**\n\n* The Fantastic Four: First Steps ‚Äì domestic debut \\~\\$118‚ÄØM; global \\~\\$218‚ÄØM, Marvel‚Äôs biggest opening of 2025\n* Superman ‚Äì added \\~\\$94‚ÄØM worldwide last week, passing \\$500‚ÄØM global total\n* Jurassic World Rebirth ‚Äì up \\~\\$70‚ÄØM worldwide last week, despite \\~40‚ÄØ% drop week‚Äëon‚Äëweek\n* F1: The Movie ‚Äì up \\~\\$48‚ÄØM last week internationally/domestically growth visible\n* Lilo & Stitch ‚Äì added \\~\\$10‚ÄØM worldwide last week, slower tail but still billion‚Äëplus gross\n\n**Highlights & trends:**\nFantastic Four‚Äôs strong debut reboots Marvel success, signaling resumed audience interest; Superman continues to hold strong; Jurassic World Rebirth remains durable after holiday surge; surge in box office recovery noted across key titles. Overall box office up \\~12‚Äì15‚ÄØ% year‚Äëon‚Äëyear.\n\n---\n\nüì∞ **Industry Buzz**\n\n1. Christopher Nolan has signed to direct a massive \\$250‚ÄØmillion adaptation of Homer‚Äôs *The Odyssey*, starring Matt Damon and Tom Holland, with Imax pre‚Äësales at 95‚ÄØ% capacity across major locations.\n2. Marvel has relaunched the *Fantastic Four* franchise successfully with *First Steps*; positive CinemaScore and strong visuals marking a fresh start.\n3. DC‚Äôs *Superman* continues strong with over \\$500‚ÄØM global, solidifying DC‚Äôs summer comeback.\n4. Universal‚Äôs *Jurassic World Rebirth* continues strong overseas, especially in China, contributing to \\$318‚ÄØM global in opening holiday weekend.\n5. Warner Bros.‚ÄìDiscovery stock surges (\\~30‚ÄØ%) amid box office rebound, with Disney, IMAX and Cinemark also seeing robust growth in 2025.\n6. *Ne Zha¬†2* becomes highest‚Äëgrossing animated and non‚ÄëHollywood film ever, crossing \\$2‚ÄØbillion globally‚Äîthough not Hollywood, its impact on global trends is notable.\n7. *Mission: Impossible ‚Äì The Final Reckoning* quietly solidifies strong global numbers (\\~\\$562‚ÄØM) and continues reliable franchise performance.\n\n---\n\nüé• **Must‚ÄëWatch in Theatres (Surat, India)**\n\n* **The Fantastic Four: First Steps** ‚Äì Currently showing in English/Hindi/Tamil/Telugu in Surat cinemas; hyped globally, strong visuals, action‚Äëheavy, best experienced in IMAX or premium formats if available in Surat multiplexes. Runs this week.\n* **F1: The Movie** ‚Äì Available in Surat in multiple languages, strong reviews praising adrenaline‚Äëfuelled direction and visuals and growing fan hype; ideal in standard or Dolby formats for immersive sound and speed feel.\n* **Jurassic World Rebirth** ‚Äì Still playing in Surat, popular with family audiences; grand visuals and dinosaur action well‚Äësuited to IMAX or large format screens.\n\n---\n\nThat‚Äôs all for today‚Äôs briefing. Have a great theatrical weekend ahead!"
        },
        "typeVersion": 1
      },
      {
        "id": "3833cf6f-66df-469a-a8e3-56ba508f6f8a",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          272,
          1232
        ],
        "parameters": {
          "width": 480,
          "content": "### Cool, right? But here‚Äôs the twist:\nSwap in ChatGPT ‚Äî GPT‚Äë3.5 Turbo (‚âà‚ÄØ$0.002/run), GPT‚Äë4o (‚âà‚ÄØ$0.009/run), or GPT‚Äë4.5 (‚âà‚ÄØ$0.15/run) ‚Äî and the briefing goes nuclear: cleaner, richer, straight‚Äëup ‚Äúdid‚Äëa‚Äëhuman‚Äëwrite‚Äëthis?‚Äù energy.\nBasically IMAX‚Äëgrade output for the cost of a coffee‚Ä¶ or a flex if you go full 4.5."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "8016c395-5396-4c0a-b306-aa5f9c8b3147",
    "connections": {
      "AI Agent": {
        "main": [
          [
            {
              "node": "Send a message1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Format Output for Email": {
        "ai_outputParser": [
          [
            {
              "node": "Hollywood News Research Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini 2.5 Flash": {
        "ai_languageModel": [
          [
            {
              "node": "Hollywood News Research Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Weekly Thursday Trigger": {
        "main": [
          [
            {
              "node": "Hollywood News Research Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Hollywood News (Tavily)": {
        "ai_tool": [
          [
            {
              "node": "Hollywood News Research Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Hollywood News Research Agent": {
        "main": [
          [
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Weekly Releases (Tavily)": {
        "ai_tool": [
          [
            {
              "node": "Hollywood News Research Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Must-Watch Movies (Tavily)": {
        "ai_tool": [
          [
            {
              "node": "Hollywood News Research Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Weekly Box Office (Tavily)": {
        "ai_tool": [
          [
            {
              "node": "Hollywood News Research Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "jbTm6O9bLBMm6RWy",
    "meta": {
      "instanceId": "7b7fd5f72a378d0859f4d1cf8dd3c226094df4777ef6aca192ac32e815fe212a",
      "templateCredsSetupCompleted": true
    },
    "name": "My workflow 3",
    "tags": [],
    "nodes": [
      {
        "id": "24be1991-3de5-49c2-91a1-c636fb721a87",
        "name": "Weekly Trigger (Monday 7AM)",
        "type": "n8n-nodes-base.cron",
        "position": [
          80,
          180
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "43d7764d-fbd4-414b-be44-bcc80c068db2",
        "name": "Get SEO Data from GSC",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          300,
          180
        ],
        "parameters": {
          "url": "https://searchconsole.googleapis.com/webmasters/v3/sites/YOUR_SITE_URL/searchAnalytics/query",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpBasicAuth"
        },
        "typeVersion": 2
      },
      {
        "id": "92852fd3-7663-413e-b1a9-8c728dea9a23",
        "name": "Generate SEO Report",
        "type": "n8n-nodes-base.function",
        "position": [
          500,
          180
        ],
        "parameters": {
          "functionCode": "\n                const rows = items[0].json.rows || [];\n                const reportLines = rows.map((row, index) => {\n                    return `${index + 1}. ${row.keys[0]} - Clicks: ${row.clicks}, Impressions: ${row.impressions}, CTR: ${row.ctr.toFixed(2)}, Position: ${row.position.toFixed(2)}`;\n                });\n                return [{\n                    json: {\n                        report: `Top 10 Search Queries (Last 7 Days):\\n\\n${reportLines.join(\"\\n\")}`\n                    }\n                }];\n            "
        },
        "typeVersion": 1
      },
      {
        "id": "28d9f152-15a0-4a66-aa5e-aa6b9b4c1fa3",
        "name": "üìå Setup Instructions",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          60
        ],
        "parameters": {
          "color": 6,
          "width": 280,
          "height": 320,
          "content": "\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8e9551d4-27ab-4106-b0cd-b82d6a671ec7",
        "name": "üìå Google Search Console Config",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          240,
          60
        ],
        "parameters": {
          "color": 2,
          "height": 320,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "c2aabd2e-0a2b-4b4b-a239-bf0927ad1e4d",
        "name": "üìå Email Node Setup",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          40
        ],
        "parameters": {
          "color": 5,
          "height": 360,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "1b870a08-d53c-4a51-9a41-4d71a5c954f9",
        "name": "Send Weekly Report by Email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          720,
          180
        ],
        "webhookId": "c9455684-b943-41a5-b2d7-adeafb985083",
        "parameters": {
          "sendTo": "rodrigue.gbadou@gmail.com",
          "options": {},
          "subject": "Send Weekly Report by Email"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "6dONI23VTND78rYK",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "72378158-06bb-40fd-a300-b89a73676d8d",
    "connections": {
      "Generate SEO Report": {
        "main": [
          [
            {
              "node": "Send Weekly Report by Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get SEO Data from GSC": {
        "main": [
          [
            {
              "node": "Generate SEO Report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Weekly Trigger (Monday 7AM)": {
        "main": [
          [
            {
              "node": "Get SEO Data from GSC",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "IyhsZQh7TFAGsDqL",
    "meta": {
      "instanceId": "a2b23892dd6989fda7c1209b381f5850373a7d2b85609624d7c2b7a092671d44",
      "templateCredsSetupCompleted": true
    },
    "name": "Automate WhatsApp bookings with an AI assistant and smart SMS reminders (24/7)",
    "tags": [],
    "nodes": [
      {
        "id": "1d45c88a-5c71-42bb-9207-a7060a64030b",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -500,
          480
        ],
        "parameters": {
          "color": 4,
          "width": 1620,
          "height": 280,
          "content": "# üü© STEP 3 ‚Äî Send SMS Reminder Before Appointment\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "1274c8bb-78fd-445f-b3bb-c1adedba3acc",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -500,
          -540
        ],
        "parameters": {
          "width": 1620,
          "height": 460,
          "content": "# üü´ STEP 1 ‚Äî Qualify User and Suggest Appointment"
        },
        "typeVersion": 1
      },
      {
        "id": "bb147090-c21c-4b75-bfd7-92b1b61646f5",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -500,
          -60
        ],
        "parameters": {
          "color": 3,
          "width": 1620,
          "height": 520,
          "content": "# üü• STEP 2 ‚Äî Book Appointment Automatically\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3b2b3031-55a6-4c98-a6a5-75eb746b2c99",
        "name": "Webhook Trigger (WhatsApp Input)",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -960,
          -80
        ],
        "webhookId": "6438cd95-74cb-4f40-a1a5-853706fe96f6",
        "parameters": {
          "path": "6438cd95-74cb-4f40-a1a5-853706fe96f6",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "6c7ffde6-b3bc-4162-b45d-8e483e347d49",
        "name": "Switch: Confirm vs Chat Flow",
        "type": "n8n-nodes-base.switch",
        "position": [
          -740,
          -80
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Discussion",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "2b0aa9e5-7215-435b-8b66-fddb9973c7d0",
                      "operator": {
                        "type": "string",
                        "operation": "notContains"
                      },
                      "leftValue": "={{ $json.body.userInput }}",
                      "rightValue": "confirm"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Confirm booking",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "ed81f2e7-f97d-4581-bc84-ed703db2ec08",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $json.body.userInput }}",
                      "rightValue": "confirm"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "f7f43574-cfed-4448-983f-dc53343ec4ab",
        "name": "AI Booking Assistant (Dr Firas)",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          40,
          -460
        ],
        "parameters": {
          "text": "=input :  {{ $json.body.userInput }}",
          "options": {
            "systemMessage": "=#IMPORTANT  \nLes rendez-vous ne peuvent √™tre pris qu‚Äôapr√®s avoir collect√© le nom, l‚Äôe-mail/Courriel et le service choisi.\n\n#IDENTIT√â  \nVous √™tes l‚Äôassistant de Dr Firas, coach expert en automatisation n8n, sur WhatsApp.\n\n#CONTEXTE  \n- Dr Firas propose des coachings et ateliers en ligne pour ma√Ætriser n8n  \n- Horaires : du lundi au vendredi, 9 h‚Äì18 h (heure de Paris)  \n- Fran√ßais et anglais possibles\n- La date d'aujourd'hui est : {{$now}}\n\n#SERVICES ET MAPPING (CRITIQUE)  \n- ¬´ Audit express n8n ¬ª (30 min) ‚Äì 40 $ ‚Äì Event ID : 2638115  \n- ¬´ Coaching Workflow n8n ¬ª (60 min) ‚Äì 65 $ ‚Äì Event ID : 2638127  \n- ¬´ Atelier Automatisation Avanc√©e ¬ª (90 min) ‚Äì 99 $ ‚Äì Event ID : 2638131  \n\nQuand l‚Äôutilisateur choisit un service, m√©morisez l‚ÄôEvent ID correspondant.\n\n#TON  \nDynamique, professionnel et chaleureux. Emojis l√©gers üëçü§ñ.\n\n#FLUX DE CONVERSATION\n\n## 1. Accueil  \n¬´ Bonjour ! Je suis l‚Äôassistant de Dr Firas, pr√™t √† vous guider pour votre session n8n. Puis-je vous poser quelques questions ? ¬ª\n\n## 2. Choix du service (une question √† la fois)  \na) ¬´ Quel service souhaitez-vous ? ¬ª  \n- Si ¬´ je ne sais pas ¬ª ou ¬´ que proposez-vous ¬ª ‚Üí listez les 3 services avec dur√©e, prix et b√©n√©fice court.  \n- Sinon, continuez.\n\n## 3. Collecte des infos client  \n¬´ Parfait ! Pour r√©server votre [nom du service], j‚Äôai besoin de votre pr√©nom et de votre e-mail. ¬ª\n\n‚Üí Apr√®s avoir re√ßu nom + e-mail/Courriel , enregistrez dans le Google Sheet Prospect (nom, e-mail, t√©l√©phone={{ $json.body.phoneNumber }}, service, Event ID, r√©sum√©).\n\n## 4. Proposition de cr√©neaux  \n¬´ Souhaitez-vous voir les disponibilit√©s imm√©diatement ? ¬ª  \n- Si oui :  \n  1. Appelez l‚Äôoutil **Get Availability** avec :  \n     - Event ID du service  \n     - startTime = maintenant (ISO 8601, UTC, ex. `2025-06-13T12:00:00Z`)  \n     - endTime = +48 h (ISO 8601, UTC)  \n     - max 5 cr√©neaux  \n  2. Convertissez chaque horaire UTC en heure de Paris (+02:00) et affichez-les en plain text (ex. ‚Äú14:30‚Äù).\n\n## 5. Choix du cr√©neau  \n¬´ Lequel de ces cr√©neaux vous convient ? ¬ª  \n- L‚Äôutilisateur r√©pond date+heure ‚Üí  \n  - Demandez ¬´ Tapez ‚Äúoui‚Äù pour confirmer ce cr√©neau ¬ª.  \n  - √Ä ¬´ oui ¬ª, enregistrez via Google Sheet Update_Leads (nom, e-mail, service, Event ID, date+heure).  \n  - Puis : ¬´ Votre rendez-vous est fix√© au [date] √† [heure] (heure de Paris). Tapez ‚Äúconfirm‚Äù pour finaliser. ¬ª\n\n## 6. Confirmation finale  \n- √Ä ‚Äúconfirm‚Äù ‚Üí  \n  - Confirmez la r√©servation et rappelez la politique d‚Äôannulation 24 h √† l‚Äôavance.  \n  - Proposez un lien d‚Äôajout au calendrier si besoin.\n\n#CONTRAINTES OUTIL ‚ÄúGet Availability‚Äù  \n- Toujours ISO 8601 UTC  \n- startTime = maintenant, endTime = +48 h  \n- Maximum 5 cr√©neaux  \n- Plain text, < 400 car.\n\n#R√àGLES G√âN√âRALES  \n- Une question √† la fois  \n- Ne jamais redemander une info d√©j√† fournie  \n- ‚ÄúRESET‚Äù relance la conversation depuis le d√©but  \n"
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "03d391f5-43b5-462e-8c56-cdce426f9751",
        "name": "LLM: GPT-4o Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -200,
          -260
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "gpt-4o"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "365fc08f-6514-4182-b77f-86a13ef55576",
        "name": "AI Conversation Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          -40,
          -260
        ],
        "parameters": {
          "sessionKey": "={{ $json.body.contactId }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 50
        },
        "typeVersion": 1.3
      },
      {
        "id": "96eeb9b5-aea9-46cc-893f-4ea3697a3fb5",
        "name": "Create New Prospect in Google Sheet",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          140,
          -260
        ],
        "parameters": {
          "columns": {
            "value": {
              "Nom": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Nom', ``, 'string') }}",
              "Courriel": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Courriel', ``, 'string') }}",
              "R√©sum√©": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('R_sum_', `ici il y a le r√©sum√© de toute la conversation`, 'string') }}",
              "ID du contact": "={{ $json.body.contactId }}",
              "Num√©ro de t√©l√©phone": "={{ $json.body.phoneNumber }}"
            },
            "schema": [
              {
                "id": "Nom",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Nom",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Courriel",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Courriel",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Num√©ro de t√©l√©phone",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Num√©ro de t√©l√©phone",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "R√©sum√©",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "R√©sum√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "R√©serv√©",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "R√©serv√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Nom de l‚Äô√©v√©nement",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Nom de l‚Äô√©v√©nement",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID de l‚Äô√©v√©nement",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "ID de l‚Äô√©v√©nement",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Date du rendez-vous",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Date du rendez-vous",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Rappel SMS envoy√©",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Rappel SMS envoy√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID du contact",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "ID du contact",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "ID du contact"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc/edit#gid=0",
            "cachedResultName": "mes RDV"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc/edit?usp=drivesdk",
            "cachedResultName": "MES RDV"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "9fcb6a32-34e7-4c5a-997a-cd0fe58f62cd",
        "name": "Update Prospect with Booking Details",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          320,
          -260
        ],
        "parameters": {
          "columns": {
            "value": {
              "ID du contact": "={{ $json.body.contactId }}",
              "Date du rendez-vous": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Date_du_rendez-vous', ``, 'string') }}",
              "ID de l‚Äô√©v√©nement": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('ID_de_l__v_nement', ``, 'string') }}",
              "Nom de l‚Äô√©v√©nement": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Nom_de_l__v_nement', ``, 'string') }}"
            },
            "schema": [
              {
                "id": "Nom",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Nom",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Courriel",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Courriel",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Num√©ro de t√©l√©phone",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Num√©ro de t√©l√©phone",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "R√©sum√©",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "R√©sum√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "R√©serv√©",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "R√©serv√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Nom de l‚Äô√©v√©nement",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Nom de l‚Äô√©v√©nement",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID de l‚Äô√©v√©nement",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "ID de l‚Äô√©v√©nement",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Date du rendez-vous",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Date du rendez-vous",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Rappel SMS envoy√©",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Rappel SMS envoy√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID du contact",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "ID du contact",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "ID du contact"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc/edit#gid=0",
            "cachedResultName": "mes RDV"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc/edit?usp=drivesdk",
            "cachedResultName": "MES RDV"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "9e1a6470-0937-4190-9d24-259ea2749190",
        "name": "Fetch Available Time Slots",
        "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
        "position": [
          520,
          -260
        ],
        "parameters": {
          "url": "https://api.cal.com/v2/slots/available",
          "sendQuery": true,
          "sendHeaders": true,
          "parametersQuery": {
            "values": [
              {
                "name": "eventTypeId"
              },
              {
                "name": "startTime"
              },
              {
                "name": "endTime"
              }
            ]
          },
          "toolDescription": "Appelez cet outil pour r√©cup√©rer la disponibilit√© des rendez-vous.\nVous devez imp√©rativement utiliser le fuseau horaire de Paris.\nRespectez strictement le format ISO pour les dates, par exemple :\n2025-01-01T09:00:00-02:00\nExemple de sch√©ma d‚Äôentr√©e :\n{\n  \"startTime\": \"...\",\n  \"endTime\": \"...\"\n}",
          "parametersHeaders": {
            "values": [
              {
                "name": "Authorization",
                "value": "Bearer YOUR_TOKEN_HERE",
                "valueProvider": "fieldValue"
              },
              {
                "name": "Content-Type",
                "value": "application/json",
                "valueProvider": "fieldValue"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "5d8dc1ce-020f-4df3-88cc-7f61594a3347",
        "name": "Send Response to WhatsApp",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          700,
          -460
        ],
        "parameters": {
          "options": {},
          "respondWith": "allIncomingItems"
        },
        "typeVersion": 1.1
      },
      {
        "id": "5cd00123-c0ea-48f9-85e6-e496a0bd6620",
        "name": "Retrieve Prospect Details",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -420,
          140
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupValue": "={{ $('Webhook Trigger (WhatsApp Input)').item.json.body.contactId }}",
                "lookupColumn": "ID du contact"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc/edit#gid=0",
            "cachedResultName": "mes RDV"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc/edit?usp=drivesdk",
            "cachedResultName": "MES RDV"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "9696140f-857f-42b6-9bb9-3d25f5d893d4",
        "name": "Normalize Booking Time (UTC Format)",
        "type": "n8n-nodes-base.code",
        "position": [
          -200,
          140
        ],
        "parameters": {
          "jsCode": "const input = $input.first().json['Date du rendez-vous']; // e.g.,\n\"2025-06-04T09:00:00+02:00\"\nfunction normalizeToUTCZFormat(dateString) {\ntry {\nif\n(/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$/.test(dateString)\n) {\nreturn new Date(dateString).toISOString();\n}\nconst date = new Date(dateString);\nif (isNaN(date.getTime())) {\nthrow new Error(\"Invalid date format\");\n}\nreturn date.toISOString(); // Returns in UTC with Z\n} catch (e) {\nreturn `Invalid input: ${e.message}`;\n}\n}\nreturn [\n{\njson: {\noriginal: input,\nnormalized: normalizeToUTCZFormat(input),\n},\n},\n];"
        },
        "typeVersion": 2
      },
      {
        "id": "6d2ef19a-93d1-46f1-bc31-ad1010d3bb4a",
        "name": "Send Booking",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          20,
          140
        ],
        "parameters": {
          "url": "https://api.cal.com/v2/bookings",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n\"eventTypeId\": {{ $('Retrieve Prospect Details').item.json['ID de l‚Äô√©v√©nement'] }},\n\"start\": \"{{ $json.normalized }}\",\n\"attendee\": {\n\"name\": \"{{ $('Retrieve Prospect Details').item.json.Nom }}\",\n\"email\": \"{{ $('Retrieve Prospect Details').item.json.Courriel }}\",\n\"timeZone\": \"Europe/Paris\"\n},\n\"bookingFieldsResponses\": {\n\"title\": \"{{ $('Retrieve Prospect Details').item.json['R√©sum√©'] }}\"\n}\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer YOUR_TOKEN_HERE"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "cal-api-version",
                "value": "2024-08-13"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "472dc55f-b42f-483f-b6cc-1f8c25f0158e",
        "name": "Format Date for Readability (Display)",
        "type": "n8n-nodes-base.code",
        "position": [
          240,
          140
        ],
        "parameters": {
          "jsCode": "const input = $('Retrieve Prospect Details').first().json['Date du rendez-vous']; \nfunction formatToReadableDate(dateString) {\ntry {\nconst date = new Date(dateString);\nif (isNaN(date.getTime())) throw new Error(\"Invalid date\");\nconst options = {\ntimeZone: \"Europe/Berlin\", // Ensures correct local time\nmonth: \"long\",\nday: \"numeric\",\nhour: \"numeric\",\nminute: \"2-digit\",\nhour12: true,\n};\nconst formatted = date.toLocaleString(\"en-US\", options);\n// Example output: \"June 4, 09:00 AM\" ‚Üí make it shorter like\n\"June 4, 9am\"\nreturn formatted\n.replace(\":00\", \"\") // remove :00 if exact hour\n.replace(\"AM\", \"am\")\n.replace(\"PM\", \"pm\");\n} catch (e) {\nreturn `Invalid input: ${e.message}`;\n}\n}\nreturn [\n{\njson: {\noriginal: input,\nformatted: formatToReadableDate(input),\n},\n},\n]; "
        },
        "typeVersion": 2
      },
      {
        "id": "7f0f86bc-8199-4d81-8bce-e96ced534f6e",
        "name": "Check Booking Status (Success or Error)",
        "type": "n8n-nodes-base.switch",
        "position": [
          460,
          140
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "succeeded",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "cbf9b691-0bc1-4a14-b35d-96664d82bc91",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $('Send Booking').item.json.status }}",
                      "rightValue": "success"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Failed",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "f78214f9-ecd4-4913-aef0-9a2a453b052c",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $('Send Booking').item.json.status }}",
                      "rightValue": "error"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "108c9a6b-a345-4f33-ab22-113b6e63914b",
        "name": "Webhook Response: Booking Confirmed",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          700,
          -20
        ],
        "parameters": {
          "options": {},
          "respondWith": "json",
          "responseBody": "\n[\n{\n\"output\": \"Votre r√©servation a √©t√© effectu√©e avec succ√®s. Vous recevrez bient√¥t un e-mail de confirmation pour votre massage, RDV : .\"\n}\n]"
        },
        "typeVersion": 1.1
      },
      {
        "id": "8c3d9734-7aad-4445-9810-29d7045fbc78",
        "name": "Webhook Response: Booking Failed",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          700,
          280
        ],
        "parameters": {
          "options": {},
          "respondWith": "json",
          "responseBody": "[\n{\n\"output\": \"Il semble que le cr√©neau horaire que vous avez choisi ne soit plus disponible. Veuillez en s√©lectionner un autre.\"\n}\n]"
        },
        "typeVersion": 1.1
      },
      {
        "id": "2a3ed659-5cec-497b-bde8-f6a15585cc41",
        "name": "Mark Booking as Confirmed in Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          920,
          140
        ],
        "parameters": {
          "columns": {
            "value": {
              "R√©serv√©": "confirm",
              "ID du contact": "={{ $('Retrieve Prospect Details').item.json['ID du contact'] }}"
            },
            "schema": [
              {
                "id": "Nom",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Nom",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Courriel",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Courriel",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Num√©ro de t√©l√©phone",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Num√©ro de t√©l√©phone",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "R√©sum√©",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "R√©sum√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "R√©serv√©",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "R√©serv√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Nom de l‚Äô√©v√©nement",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Nom de l‚Äô√©v√©nement",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID de l‚Äô√©v√©nement",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "ID de l‚Äô√©v√©nement",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Date du rendez-vous",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Date du rendez-vous",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Rappel SMS envoy√©",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Rappel SMS envoy√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID du contact",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "ID du contact",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "ID du contact"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc/edit#gid=0",
            "cachedResultName": "mes RDV"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc/edit?usp=drivesdk",
            "cachedResultName": "MES RDV"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "5bfa51a3-e939-41e8-a1df-b4e59c4feef1",
        "name": "Trigger: Check Appointments Every Hour",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -420,
          580
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "hours"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "0413b7b7-b523-4e22-ad4a-40d7342abed9",
        "name": "Read Upcoming Appointments from Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -200,
          580
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc/edit#gid=0",
            "cachedResultName": "mes RDV"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1PsuURJg5nxVnb18OMDShjC-sTA9i_32pyBSjfswOpqc/edit?usp=drivesdk",
            "cachedResultName": "MES RDV"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "408e1330-29e4-4de7-b681-1bb372b5f841",
        "name": "Filter Appointments Within Next 2 Hours",
        "type": "n8n-nodes-base.code",
        "position": [
          20,
          580
        ],
        "parameters": {
          "jsCode": "const nowParis = new Date(\n  new Date().toLocaleString(\"en-US\", { timeZone: \"Europe/Paris\" })\n);\nconst nowTimestamp = nowParis.getTime();\nconst twoHoursFromNow = nowTimestamp + 2 * 60 * 60 * 1000;\n\nreturn items\n  .filter(item => {\n    const booked = item.json[\"R√©serv√©\"]?.toLowerCase() === \"confirm\";\n    const reminderSent = item.json[\"Rappel SMS envoy√©\"]?.toLowerCase() === \"envoyer\";\n    const rawDate = item.json[\"Date du rendez-vous\"];\n    if (!booked || reminderSent || !rawDate) {\n      return false;\n    }\n\n    const appointmentTimestamp = Date.parse(rawDate);\n    return appointmentTimestamp > nowTimestamp &&\n           appointmentTimestamp <= twoHoursFromNow;\n  })\n  .map(item => {\n    const rawDate = item.json[\"Date du rendez-vous\"];\n    const date = new Date(rawDate);\n    if (isNaN(date.getTime())) {\n      item.json.appointmentDisplayTime = \"(Invalid date)\";\n      return item;\n    }\n\n    const options = {\n      timeZone: \"Europe/Paris\",\n      month: \"long\",\n      day: \"numeric\",\n      hour: \"numeric\",\n      minute: \"2-digit\",\n      hour12: true\n    };\n\n    const formatted = date.toLocaleString(\"en-US\", options)\n      .replace(\":00\", \"\")\n      .replace(\"AM\", \"AM\")\n      .replace(\"PM\", \"PM\");\n\n    item.json.appointmentDisplayTime = formatted;\n    return item;\n  });\n"
        },
        "typeVersion": 2
      },
      {
        "id": "0a9d6747-85d2-400e-a9fd-b5768ae4605c",
        "name": "Send SMS Reminder",
        "type": "n8n-nodes-base.sms77",
        "position": [
          240,
          580
        ],
        "parameters": {
          "to": "={{ $('Read Upcoming Appointments from Sheet').item.json['Num√©ro de t√©l√©phone'] }}",
          "message": "=Bonjour {{ $json.Nom }}, ceci est un petit rappel : votre rendez-vous pour {{ $json['Nom de l‚Äô√©v√©nement'] }} est pr√©vu dans les 2 prochaines heures ",
          "options": {}
        },
        "credentials": {
          "sms77Api": {
            "id": "nC2L4tQyF03xEMAX",
            "name": "seven account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "3a01ec5e-57ea-43ac-8e59-97d66e85454f",
        "name": "Mark SMS as Sent in Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          460,
          580
        ],
        "parameters": {
          "columns": {
            "value": {
              "ID du contact": "={{ $('Read Upcoming Appointments from Sheet').item.json['ID du contact'] }}",
              "Rappel SMS envoy√©": "envoyer"
            },
            "schema": [
              {
                "id": "Nom",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Nom",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Courriel",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Courriel",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Num√©ro de t√©l√©phone",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Num√©ro de t√©l√©phone",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "R√©sum√©",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "R√©sum√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "R√©serv√©",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "R√©serv√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Nom de l‚Äô√©v√©nement",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Nom de l‚Äô√©v√©nement",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID de l‚Äô√©v√©nement",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "ID de l‚Äô√©v√©nement",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Date du rendez-vous",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Date du rendez-vous",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Rappel SMS envoy√©",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Rappel SMS envoy√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID du contact",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "ID du contact",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "ID du contact"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "5c82e86c-e3b2-4b70-b686-a782edbaee55",
    "connections": {
      "Send Booking": {
        "main": [
          [
            {
              "node": "Format Date for Readability (Display)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send SMS Reminder": {
        "main": [
          [
            {
              "node": "Mark SMS as Sent in Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Conversation Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Booking Assistant (Dr Firas)",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "LLM: GPT-4o Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Booking Assistant (Dr Firas)",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Retrieve Prospect Details": {
        "main": [
          [
            {
              "node": "Normalize Booking Time (UTC Format)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Available Time Slots": {
        "ai_tool": [
          [
            {
              "node": "AI Booking Assistant (Dr Firas)",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Switch: Confirm vs Chat Flow": {
        "main": [
          [
            {
              "node": "AI Booking Assistant (Dr Firas)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Retrieve Prospect Details",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Booking Assistant (Dr Firas)": {
        "main": [
          [
            {
              "node": "Send Response to WhatsApp",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook Trigger (WhatsApp Input)": {
        "main": [
          [
            {
              "node": "Switch: Confirm vs Chat Flow",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create New Prospect in Google Sheet": {
        "ai_tool": [
          [
            {
              "node": "AI Booking Assistant (Dr Firas)",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Normalize Booking Time (UTC Format)": {
        "main": [
          [
            {
              "node": "Send Booking",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook Response: Booking Confirmed": {
        "main": [
          [
            {
              "node": "Mark Booking as Confirmed in Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Prospect with Booking Details": {
        "ai_tool": [
          [
            {
              "node": "AI Booking Assistant (Dr Firas)",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Format Date for Readability (Display)": {
        "main": [
          [
            {
              "node": "Check Booking Status (Success or Error)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Upcoming Appointments from Sheet": {
        "main": [
          [
            {
              "node": "Filter Appointments Within Next 2 Hours",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger: Check Appointments Every Hour": {
        "main": [
          [
            {
              "node": "Read Upcoming Appointments from Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Booking Status (Success or Error)": {
        "main": [
          [
            {
              "node": "Webhook Response: Booking Confirmed",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Webhook Response: Booking Failed",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter Appointments Within Next 2 Hours": {
        "main": [
          [
            {
              "node": "Send SMS Reminder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "P2I09TDwHXkMSQ7Q",
    "meta": {
      "instanceId": "a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462",
      "templateCredsSetupCompleted": true
    },
    "name": "Automated AI Music Generation with ElevenLabs",
    "tags": [],
    "nodes": [
      {
        "id": "a98ccb05-9771-48db-9968-95e485270f7f",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -544,
          -480
        ],
        "parameters": {
          "width": 864,
          "height": 496,
          "content": "## Automated AI Music Generation with ElevenLabs & Google Drive\n\nThis workflow automates the creation, storage, and cataloging of AI-generated music using the ElevenLabs Music API, Google Sheets, and Google Drive.\n\nWith Eleven Music*, businesses, creators, artists, and every single one of our users can generate studio-grade music from natural language prompts. Please fill this form to register your interest in the [Eleven Music API](https://try.elevenlabs.io/ahkbf00hocnu). \n\nGenerated music has a minimum duration of 10 seconds and a maximum duration of 5 minutes.\n\n*Only paid plan\n\n## **How it works:**\nThe workflow reads music requests from Google Sheets, sends prompts to ElevenLabs Music API, uploads generated MP3s to Google Drive, and updates sheet URLs. It loops through each request with a 1-minute delay to avoid rate limits.\n\n## **Setup steps:**\nConnect ElevenLabs API, Google Sheets, and Google Drive in n8n. Add required columns and IDs, authenticate each service, then test and run the workflow to generate and store tracks automatically.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c42079f2-9717-4958-a8d5-39b25f8a0f3a",
        "name": "When clicking ‚ÄòExecute workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -720,
          192
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "a827047c-52d4-4bd1-9e13-f730f7c7026b",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -192,
          192
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "e8493c6f-c6c7-4789-a941-33480ad9c6e4",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          800,
          208
        ],
        "webhookId": "0694cd4a-44c9-462d-957b-c2aae16920ce",
        "parameters": {
          "unit": "minutes",
          "amount": 1
        },
        "typeVersion": 1.1
      },
      {
        "id": "b113abe5-28a7-425c-835e-a20e627aeac1",
        "name": "Get tracks",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -448,
          192
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "URL"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/10yDGf9Xyx2l-zdd5S1orxZaKbW3_vnONVgRBk_CLrpg/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "10yDGf9Xyx2l-zdd5S1orxZaKbW3_vnONVgRBk_CLrpg",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/10yDGf9Xyx2l-zdd5S1orxZaKbW3_vnONVgRBk_CLrpg/edit?usp=drivesdk",
            "cachedResultName": "My Music Tracks"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "JYR6a64Qecd6t8Hb",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "3e27ab71-a906-4f5e-be2c-27ea15f2d3da",
        "name": "Compose music",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          128,
          208
        ],
        "parameters": {
          "url": "https://api.elevenlabs.io/v1/music",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"respect_sections_durations\": true,\n  \"prompt\": \"{{ $json.PROMPT }}\",\n  \"music_length_ms\": {{ $json['DURATION (ms)'] }},\n  \"model_id\": \"music_v1\"\n} ",
          "sendBody": true,
          "sendQuery": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "output_format",
                "value": "mp3_44100_128"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "z4znOxNaoFLL56Lj",
            "name": "Elevenlabs API (dave85heat)"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "beeb4fa4-bad8-403b-b441-44f7e7916910",
        "name": "Upload music",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          368,
          208
        ],
        "parameters": {
          "name": "=song_{{$now.format('yyyyLLdd')}}.{{ $binary.data.fileExtension }}",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1tkCr7xdraoZwsHqeLm7FZ4aRWY94oLbZ",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1tkCr7xdraoZwsHqeLm7FZ4aRWY94oLbZ",
            "cachedResultName": "n8n"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "HEy5EuZkgPZVEa9w",
            "name": "Google Drive account (n3w.it)"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "794e79c0-6e08-4736-9799-ca64529ade3e",
        "name": "Update Link tracks",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          592,
          208
        ],
        "parameters": {
          "columns": {
            "value": {
              "URL": "={{ $json.webViewLink }}",
              "row_number": "={{ $('Loop Over Items').item.json.row_number }}"
            },
            "schema": [
              {
                "id": "N.",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "N.",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "TITLE",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "TITLE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PROMPT",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "PROMPT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "DURATION (ms)",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "DURATION (ms)",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/10yDGf9Xyx2l-zdd5S1orxZaKbW3_vnONVgRBk_CLrpg/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "10yDGf9Xyx2l-zdd5S1orxZaKbW3_vnONVgRBk_CLrpg",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/10yDGf9Xyx2l-zdd5S1orxZaKbW3_vnONVgRBk_CLrpg/edit?usp=drivesdk",
            "cachedResultName": "My Music Tracks"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "JYR6a64Qecd6t8Hb",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "e68ee0dc-8d56-4501-8338-9181500b9a07",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          64
        ],
        "parameters": {
          "color": 7,
          "width": 320,
          "height": 304,
          "content": "### Compose music with ElevenLabs\nGo to Developers, create API Key. Set Music Generation from \"No Access\" to \"Access\". Set Header Auth (Name: xi-api-key, Value: YOUR_API_KEY)"
        },
        "typeVersion": 1
      },
      {
        "id": "19fba490-199c-4ef6-8cdb-16cdef12dee3",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -544,
          64
        ],
        "parameters": {
          "color": 7,
          "width": 288,
          "height": 304,
          "content": "### Setup tracks\nPlease  clone [this sheet](https://docs.google.com/spreadsheets/d/10yDGf9Xyx2l-zdd5S1orxZaKbW3_vnONVgRBk_CLrpg/edit?usp=sharing) and fill the columns \"Title\", \"Prompt\" and \"Duration (ms)\""
        },
        "typeVersion": 1
      },
      {
        "id": "181588ea-1902-4905-9328-e394ed886395",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          336,
          64
        ],
        "parameters": {
          "color": 7,
          "width": 592,
          "height": 304,
          "content": "### Upload music and update Sheet\nUpload the music generated with ElevenLabs on Google Drive and update the Sheet with the URL of the MP3 track"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "46c8c4de-bd4d-4d0b-933c-5aabac769eea",
    "connections": {
      "Wait": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get tracks": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload music": {
        "main": [
          [
            {
              "node": "Update Link tracks",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Compose music": {
        "main": [
          [
            {
              "node": "Upload music",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Compose music",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Link tracks": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòExecute workflow‚Äô": {
        "main": [
          [
            {
              "node": "Get tracks",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "cb5caf45c9475b848c7e83772505bb02340e165acdd8de77e25011192306257c",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "1a608370-405e-4601-b65d-7a336fa0ae82",
        "name": "Generate Report",
        "type": "n8n-nodes-base.function",
        "position": [
          -16,
          320
        ],
        "parameters": {
          "functionCode": "const duplicates = [];\nconst lowQuality = [];\n\nfor (const item of $input.all()) {\n  if (item.json.leadScore <= 50) {\n    lowQuality.push(item.json.businessName);\n  }\n}\n\nreturn [{\n  json: {\n    totalProcessed: $input.all().length,\n    lowQualityLeads: lowQuality.length,\n    lowQualityNames: lowQuality,\n    timestamp: new Date().toISOString()\n  }\n}];"
        },
        "typeVersion": 1
      },
      {
        "id": "07cff94f-48fb-4667-abf9-3e7c929508a5",
        "name": "Error Logging",
        "type": "n8n-nodes-base.function",
        "position": [
          -48,
          512
        ],
        "parameters": {
          "functionCode": "// Error log for debugging\nconst errorLog = {\n  workflow: 'Google Maps Lead Generator',\n  timestamp: new Date().toISOString(),\n  error: 'Low quality or invalid lead detected',\n  data: $json\n};\n\nconsole.log('Error Log:', errorLog);\n\nreturn [{ json: errorLog }];"
        },
        "typeVersion": 1
      },
      {
        "id": "af642ea6-17a4-4fd2-a6e7-b26f9bdff825",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          976,
          128
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "7ZvT0NzDJ8AjFf1B",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "3ecdbef5-6df9-4f62-a9f9-44fa94ad32bc",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1152,
          128
        ],
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n\t\"type\": \"object\",\n\t\"properties\": {\n\t\t\"contact\": {\n\t\t\t\"type\": \"object\",\n\t\t\t\"description\": \"E-posta ve telefon numaralarƒ± gibi ileti≈üim bilgilerini i√ßerir.\",\n\t\t\t\"properties\": {\n\t\t\t\t\"emails\": {\n\t\t\t\t\t\"type\": \"array\",\n\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t},\n\t\t\t\t\t\"description\": \"Bulunan t√ºm e-posta adreslerinin listesi.\"\n\t\t\t\t},\n\t\t\t\t\"phones\": {\n\t\t\t\t\t\"type\": \"array\",\n\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\"type\": \"string\"\n\t\t\t\t\t},\n\t\t\t\t\t\"description\": \"Bulunan t√ºm telefon numaralarƒ±nƒ±n listesi.\"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"social\": {\n\t\t\t\"type\": \"object\",\n\t\t\t\"description\": \"Sabit sosyal medya platformlarƒ±nƒ±n URL'lerini i√ßerir. Bulunamayan linkler i√ßin alan bo≈ü bir metin olarak bƒ±rakƒ±lmalƒ±dƒ±r.\",\n\t\t\t\"properties\": {\n\t\t\t\t\"facebook\": {\n\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\"description\": \"Facebook sayfasƒ±nƒ±n tam URL'si.\"\n\t\t\t\t},\n\t\t\t\t\"instagram\": {\n\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\"description\": \"Instagram profilinin tam URL'si.\"\n\t\t\t\t},\n\t\t\t\t\"linkedin\": {\n\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\"description\": \"LinkedIn profilinin tam URL'si.\"\n\t\t\t\t},\n\t\t\t\t\"youtube\": {\n\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\"description\": \"YouTube kanalƒ±nƒ±n tam URL'si.\"\n\t\t\t\t},\n\t\t\t\t\"pinterest\": {\n\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\"description\": \"Pinterest profilinin tam URL'si.\"\n\t\t\t\t},\n\t\t\t\t\"twitter\": {\n\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\"description\": \"Twitter (X) profilinin tam URL'si.\"\n\t\t\t\t},\n\t\t\t\t\"whatsapp\": {\n\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\"description\": \"WhatsApp ileti≈üim linki (√∂rn: wa.me/...).\"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"location\": {\n\t\t\t\"type\": \"object\",\n\t\t\t\"description\": \"≈ûirketin yapƒ±landƒ±rƒ±lmƒ±≈ü fiziksel adresi.\",\n\t\t\t\"properties\": {\n\t\t\t\t\"full_address\": {\n\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\"description\": \"Adresin ham ve tam metin hali.\"\n\t\t\t\t},\n\t\t\t\t\"city\": {\n\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\"description\": \"Adresten √ßƒ±karƒ±lan ≈üehir bilgisi.\"\n\t\t\t\t},\n\t\t\t\t\"country\": {\n\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\"description\": \"Adresten √ßƒ±karƒ±lan √ºlke bilgisi.\"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\"other_contact_methods\": {\n\t\t\t\"type\": \"array\",\n\t\t\t\"description\": \"ƒ∞leti≈üim formu veya WhatsApp butonu gibi diƒüer ileti≈üim y√∂ntemleri.\",\n\t\t\t\"items\": {\n\t\t\t\t\"type\": \"object\",\n\t\t\t\t\"properties\": {\n\t\t\t\t\t\"type\": {\n\t\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\t\"description\": \"ƒ∞leti≈üim y√∂nteminin t√ºr√º (√ñrn: Contact Form, WhatsApp Chat).\"\n\t\t\t\t\t},\n\t\t\t\t\t\"url\": {\n\t\t\t\t\t\t\"type\": \"string\",\n\t\t\t\t\t\t\"description\": \"ƒ∞lgili sayfanƒ±n veya √∂zelliƒüin linki.\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}"
        },
        "typeVersion": 1.3
      },
      {
        "id": "944898a5-6bed-408a-ac9b-b62101132f51",
        "name": "When clicking ‚ÄòExecute workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -1024,
          -64
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "2f801af9-c230-4910-97db-8adf7a8ac650",
        "name": "1. Set Search Parameters",
        "type": "n8n-nodes-base.set",
        "position": [
          -800,
          -64
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "searchCategory",
                "value": "dentist"
              },
              {
                "name": "locationName",
                "value": "Istanbul, Turkey"
              },
              {
                "name": "latitude",
                "value": "41.0082"
              },
              {
                "name": "longitude",
                "value": "28.9784"
              },
              {
                "name": "radius",
                "value": "5000"
              },
              {
                "name": "maxResults",
                "value": "20"
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "3a046790-67dd-4db5-9254-25e2c5b30027",
        "name": "2. Find Businesses (Google Places)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -608,
          -64
        ],
        "parameters": {
          "url": "https://places.googleapis.com/v1/places:searchNearby",
          "method": "POST",
          "options": {
            "timeout": 30000,
            "response": {
              "response": {
                "responseFormat": "json"
              }
            }
          },
          "jsonBody": "={\"includedTypes\":[\"{{$json[\"searchCategory\"]}}\"],\"maxResultCount\":{{$json[\"maxResults\"]}},\"locationRestriction\":{\"circle\":{\"center\":{\"latitude\":{{$json[\"latitude\"]}},\"longitude\":{{$json[\"longitude\"]}}},\"radius\":{{$json[\"radius\"]}}}}}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "X-Goog-FieldMask",
                "value": "places.id,places.displayName,places.formattedAddress,places.nationalPhoneNumber,places.websiteUri,places.rating,places.businessStatus,places.primaryType,places.location"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "VY5PZ0lGBGhYEw7h",
            "name": "Header Auth account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "93842018-1c3a-465c-b7a9-d90af939323e",
        "name": "3. Parse & Score Leads",
        "type": "n8n-nodes-base.function",
        "position": [
          -400,
          -64
        ],
        "parameters": {
          "functionCode": "const items = [];\nconst places = $input.first().json.places || [];\nconst searchParams = $node[\"1. Set Search Parameters\"].json;\n\nfor (const place of places) {\n  const item = {\n    id: place.id || '',\n    businessName: place.displayName?.text || 'N/A',\n    address: place.formattedAddress || 'N/A',\n    phone: place.nationalPhoneNumber || 'N/A',\n    website: place.websiteUri || 'N/A',\n    rating: place.rating || 0,\n    businessStatus: place.businessStatus || 'UNKNOWN',\n    primaryType: place.primaryType || searchParams.searchCategory,\n    latitude: place.location?.latitude || 0,\n    longitude: place.location?.longitude || 0,\n    searchLocation: searchParams.locationName,\n    searchCategory: searchParams.searchCategory,\n    createdAt: new Date().toISOString(),\n    leadScore: 0,\n    status: 'New Lead'\n  };\n  \n  // Calculate lead score\n  let score = 0;\n  if (item.rating >= 4.5) score += 30;\n  else if (item.rating >= 4.0) score += 20;\n  else if (item.rating >= 3.5) score += 10;\n  \n  if (item.website !== 'N/A') score += 25;\n  if (item.phone !== 'N/A') score += 20;\n  if (item.businessStatus === 'OPERATIONAL') score += 25;\n  \n  item.leadScore = score;\n  \n  items.push({ json: item });\n}\n\nreturn items;"
        },
        "typeVersion": 1
      },
      {
        "id": "f946456d-53fa-4b03-8521-406b2b6b14ca",
        "name": "4. Filter High-Quality Leads",
        "type": "n8n-nodes-base.if",
        "position": [
          -208,
          -64
        ],
        "parameters": {
          "conditions": {
            "number": [
              {
                "value1": "={{$json[\"leadScore\"]}}",
                "value2": 50,
                "operation": "larger"
              }
            ],
            "string": [
              {
                "value1": "={{$json[\"businessName\"]}}",
                "value2": "N/A",
                "operation": "notEqual"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "1121701f-c2f7-43d1-af89-1a75b9159ce5",
        "name": "5. Loop Through Each Lead",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          64,
          -96
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "58958e08-90c8-4f7d-8922-21dd84b80406",
        "name": "6a. Scrape Website with Scrape.do",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          320,
          -80
        ],
        "parameters": {
          "url": "http://api.scrape.do/",
          "options": {},
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "url",
                "value": "={{ $json.website }}"
              },
              {
                "name": "token",
                "value": "{{$env[\"SCRAPE_DO_API_KEY\"]}}"
              }
            ]
          }
        },
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "id": "d4a3c983-fa0c-4afc-86ba-d47543202e1a",
        "name": "6b. Check if Scrape Was Successful",
        "type": "n8n-nodes-base.if",
        "position": [
          528,
          -80
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "076a0652-9f88-4992-b111-791aa327e571",
                "operator": {
                  "type": "number",
                  "operation": "notEquals"
                },
                "leftValue": "={{ $json.error.status }}",
                "rightValue": 400
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "012b5b66-460f-4efb-a960-7df911ce05cc",
        "name": "6c. Extract Footer from HTML",
        "type": "n8n-nodes-base.html",
        "position": [
          784,
          -80
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {
                "key": "footer",
                "cssSelector": "footer"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "b28b0efc-e480-4629-9b39-e649c23b2531",
        "name": "6d. Extract Contact Info with AI",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          992,
          -80
        ],
        "parameters": {
          "text": "=Analyze the following HTML snippet, which comes from a website's footer section. Your task is to extract all available contact information and populate the structured format as requested.\n\n1.  **Extract Social Media URLs:** Scan the HTML for links to specific social media platforms. Find the unique URL for each platform and place it in the corresponding field within the `social` object (e.g., the Facebook URL goes into `social.facebook`). If a link for a platform is not found, leave its field as an empty string.\n\n2.  **Extract Contact Info:** Find all email addresses (`mailto:` links) for `contact.emails`. Find all phone numbers (`tel:` links) for `contact.phones`.\n\n3.  **Extract Location:** Find the physical address and populate `location.full_address`, `location.city`, and `location.country`.\n\n4.  **Extract Other Methods:** Find links to contact forms or WhatsApp (`wa.me/`) and add them to the `other_contact_methods` array.\n\nHTML Content:\n{{ $json.footer }}",
          "options": {
            "systemMessage": "You are a highly efficient and accurate data extraction AI. Your sole purpose is to parse raw HTML content and extract specific information into a structured JSON format as requested. You must only respond with the structured data. Do not add any extra text, comments, or explanations."
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "3cc6fa78-f210-49e8-a49a-b5735ef7c262",
        "name": "7. Save Enriched Lead to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1616,
          128
        ],
        "parameters": {
          "options": {},
          "fieldsUi": {
            "fieldValues": [
              {
                "fieldId": "BusinessName",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.businessName }}"
              },
              {
                "fieldId": "Address",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.address }}"
              },
              {
                "fieldId": "Phone",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.phone }}"
              },
              {
                "fieldId": "website",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.website }}"
              },
              {
                "fieldId": "emails",
                "fieldValue": "={{ $json.output.contact.emails[0] }}"
              },
              {
                "fieldId": "Facebook",
                "fieldValue": "={{ $json.output.social.facebook }}"
              },
              {
                "fieldId": "Instagram",
                "fieldValue": "={{ $json.output.social.instagram }}"
              },
              {
                "fieldId": "Youtube",
                "fieldValue": "={{ $json.output.social.youtube }}"
              },
              {
                "fieldId": "Linkedin",
                "fieldValue": "={{ $json.output.social.linkedin }}"
              },
              {
                "fieldId": "Pinterest",
                "fieldValue": "={{ $json.output.social.pinterest }}"
              },
              {
                "fieldId": "Other",
                "fieldValue": "={{ $json.output.other_contact_methods[0].url }}"
              },
              {
                "fieldId": "rating",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.rating }}"
              },
              {
                "fieldId": "businessStatus",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.businessStatus }}"
              },
              {
                "fieldId": "primaryType",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.primaryType }}"
              },
              {
                "fieldId": "Lantitude",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.latitude }}"
              },
              {
                "fieldId": "Longitude",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.longitude }}"
              },
              {
                "fieldId": "searchLocation",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.searchLocation }}"
              },
              {
                "fieldId": "SearchCategory",
                "fieldValue": "={{ $('5. Loop Through Each Lead').item.json.searchCategory }}"
              }
            ]
          },
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1I9uFYn0q-yBmaGwmN24w6L_1-qjqEVaQj0FwN5RfoFY/edit#gid=0",
            "cachedResultName": "Table"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1I9uFYn0q-yBmaGwmN24w6L_1-qjqEVaQj0FwN5RfoFY",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1I9uFYn0q-yBmaGwmN24w6L_1-qjqEVaQj0FwN5RfoFY/edit?usp=drivesdk",
            "cachedResultName": "Lead Generator"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "df8r9D022KIAOHTC",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "7981793a-4b97-4f32-91eb-52fafc237aa5",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1632,
          -208
        ],
        "parameters": {
          "width": 560,
          "height": 576,
          "content": "# Lead Generation Bot: Google Places & AI Enrichment\n\n**Purpose:** This workflow finds businesses on Google Maps, scores them as potential leads, scrapes their websites to find contact details (email, social media) using AI, and saves the enriched data to Google Sheets.\n\n### Quick Setup Guide\n\n1.  **Configure Credentials:**\n    *   `2. Find Businesses`: Set up your Google Places API credentials (Header Auth).\n    *   `6a. Scrape Website`: Set up your Scrape.do (or other scraping service) credentials.\n    *   `6d. AI Agent`: Configure your OpenAI credentials.\n    *   `7. Save to Google Sheets`: Configure your Google Sheets OAuth2 credentials.\n2.  **Set Your Search:** In the `1. Set Search Parameters` node, define your target business category and location.\n3.  **Configure Google Sheet:** In the `7. Save to Google Sheets` node, select your spreadsheet and sheet. Make sure the column names match.\n4.  **Activate Workflow:** Turn the workflow on. It will run based on the schedule you set in the `Schedule Trigger`."
        },
        "typeVersion": 1
      },
      {
        "id": "54e30c62-7eee-496e-9bb4-3f90bbda77d0",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -752,
          -400
        ],
        "parameters": {
          "color": 2,
          "width": 512,
          "height": 288,
          "content": "### 1. Find, Parse & Score Leads\n\n**Purpose:** This section queries the Google Places API for businesses matching your criteria, formats the data, and calculates a `leadScore` for each one based on their rating, website, phone, and operational status.\n\n*   **1. Set Search Parameters:** **THIS IS THE MAIN NODE TO CONFIGURE.** Change `searchCategory` and `locationName` to define your target audience.\n*   **4. Filter High-Quality Leads:** Only leads with a score greater than 50 are processed further. You can adjust this threshold in the IF node's settings."
        },
        "typeVersion": 1
      },
      {
        "id": "57a2105c-67c2-4f4d-a7ec-7f29bac341e2",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          208,
          -448
        ],
        "parameters": {
          "color": 4,
          "width": 656,
          "height": 304,
          "content": "### 2. Data Enrichment Loop\n\n**Purpose:** This is the core enrichment part. The workflow iterates through each high-quality lead one by one.\n\n*   **6a. Scrape Website HTML:** It visits the business's website (if one exists) via a scraping service to get the raw HTML content.\n*   **6c. Extract Footer:** It specifically isolates the `<footer>` section of the website, as this area most commonly contains contact information.\n*   **6d. Extract Contact Info with AI:** It uses an OpenAI model to analyze the footer HTML and intelligently extract structured data like emails, social media links, and phone numbers."
        },
        "typeVersion": 1
      },
      {
        "id": "4ef856f2-b46d-4243-a001-4f0c4ab32019",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1776,
          48
        ],
        "parameters": {
          "color": 6,
          "width": 464,
          "height": 240,
          "content": "### 3. Save to Google Sheets\n\n**Purpose:** Appends the final, enriched lead data to your specified Google Sheet.\n\n*   **Action:** If the AI successfully extracts contact info, it's combined with the initial Google Places data and saved.\n*   **Configuration:** You must select your credentials, spreadsheet, and sheet name here. Ensure your sheet has columns matching the fields defined in this node."
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "6d. Extract Contact Info with AI",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "3. Parse & Score Leads": {
        "main": [
          [
            {
              "node": "4. Filter High-Quality Leads",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "1. Set Search Parameters": {
        "main": [
          [
            {
              "node": "2. Find Businesses (Google Places)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "6d. Extract Contact Info with AI",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "5. Loop Through Each Lead": {
        "main": [
          [],
          [
            {
              "node": "6a. Scrape Website with Scrape.do",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "4. Filter High-Quality Leads": {
        "main": [
          [
            {
              "node": "5. Loop Through Each Lead",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Generate Report",
              "type": "main",
              "index": 0
            },
            {
              "node": "Error Logging",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "6c. Extract Footer from HTML": {
        "main": [
          [
            {
              "node": "6d. Extract Contact Info with AI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "6d. Extract Contact Info with AI": {
        "main": [
          [
            {
              "node": "7. Save Enriched Lead to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "6a. Scrape Website with Scrape.do": {
        "main": [
          [
            {
              "node": "6b. Check if Scrape Was Successful",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "2. Find Businesses (Google Places)": {
        "main": [
          [
            {
              "node": "3. Parse & Score Leads",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "6b. Check if Scrape Was Successful": {
        "main": [
          [
            {
              "node": "6c. Extract Footer from HTML",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "When clicking ‚ÄòExecute workflow‚Äô": {
        "main": [
          [
            {
              "node": "1. Set Search Parameters",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "7. Save Enriched Lead to Google Sheets": {
        "main": [
          [
            {
              "node": "5. Loop Through Each Lead",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "mV1Dg3cHIDTFuUAG",
    "meta": {
      "instanceId": "60046904b104f0f72b2629a9d88fe9f676be4035769f1f08dad1dd38a76b9480",
      "templateCredsSetupCompleted": true
    },
    "name": "4 Track Competitor Website Updates",
    "tags": [],
    "nodes": [
      {
        "id": "4188b754-04e5-491b-9d1e-33769030e9cb",
        "name": "‚è∞ Trigger: Check Job Listings",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          60,
          0
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 9
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c7e3e3a6-dfc9-4b10-b760-d223d438b303",
        "name": "üõ†Ô∏è Set Search Parameters",
        "type": "n8n-nodes-base.set",
        "position": [
          260,
          0
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "94a104cf-e1fb-42b2-9613-f943e04547f3",
                "name": "url",
                "type": "string",
                "value": "https://clickup.com/pricing"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "532416b3-ae69-4b41-82f5-369e69ccc996",
        "name": "üß† OpenAI: LLM Brain",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          700,
          300
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8sEyPDkC5p4w4Jha",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "87a06fc5-9ea9-4299-b407-dc5f108274bd",
        "name": "MCP Client to Scrape as markdown",
        "type": "n8n-nodes-mcp.mcpClientTool",
        "position": [
          900,
          300
        ],
        "parameters": {
          "toolName": "scrape_as_markdown",
          "operation": "executeTool",
          "toolParameters": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', ``, 'json') }}",
          "descriptionType": "manual",
          "toolDescription": "Scrape a single webpage URL with advanced options for content extraction and get back the results in markdown."
        },
        "credentials": {
          "mcpClientApi": {
            "id": "eqq94k789oJCd6jU",
            "name": "MCP Client (STDIO) account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "846bfb1d-d58b-47d1-abde-131cf319c96e",
        "name": "No Operation, do nothing",
        "type": "n8n-nodes-base.noOp",
        "position": [
          1520,
          -140
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "8022ef12-5026-4fbf-8af2-0e91a2f06007",
        "name": "AI agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          780,
          0
        ],
        "parameters": {
          "text": "=Scrape Plan name and pricing from the url below\nurl: {{ $('üõ†Ô∏è Set Search Parameters').item.json.url }}",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2
      },
      {
        "id": "e1ec72d3-b1b3-4606-b331-061be896fe3f",
        "name": "Retrieve Pricing data",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          460,
          0
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1olDNB5lFN8NGfVK8otJF2A8aYiR5jG6ve7cqwPyPXrY/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1olDNB5lFN8NGfVK8otJF2A8aYiR5jG6ve7cqwPyPXrY",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1olDNB5lFN8NGfVK8otJF2A8aYiR5jG6ve7cqwPyPXrY/edit?usp=drivesdk",
            "cachedResultName": "Clickup Pricing"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "r2mDaisH6e9VkwHl",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "4cc13c60-95c0-4d3e-88c5-bd141b74935c",
        "name": "If price changes",
        "type": "n8n-nodes-base.if",
        "position": [
          1280,
          0
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "ecde1a05-35fd-4d57-880c-dc426f38f34f",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $('Retrieve Pricing data').item.json['1 Pricing'] }}",
                "rightValue": "={{ $('AI agent').item.json.output.plans[0].price }}"
              },
              {
                "id": "96f46f31-2703-4f5f-9cf9-034527f19d38",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $('Retrieve Pricing data').item.json['2 Pricing'] }}",
                "rightValue": "={{ $('AI agent').item.json.output.plans[1].price }}1"
              },
              {
                "id": "09861d6d-6553-4d1d-9533-334b5a7c55e1",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $('Retrieve Pricing data').item.json['3 Pricing'] }}",
                "rightValue": "={{ $('AI agent').item.json.output.plans[2].price }}"
              },
              {
                "id": "f5a9ca6e-205a-47c3-be52-8c935f4095e7",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $('Retrieve Pricing data').item.json['4 Pricing'] }}",
                "rightValue": "={{ $('AI agent').item.json.output.plans[3].price }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "c6a01b37-84e6-4cdf-9614-ca090aa843ce",
        "name": "Update google sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1520,
          120
        ],
        "parameters": {
          "columns": {
            "value": {
              "1 Plan": "={{ $json.output.plans[0].plan_name }}",
              "2 Plan": "={{ $json.output.plans[1].plan_name }}",
              "3 Plan": "={{ $json.output.plans[2].plan_name }}",
              "4 Plan": "={{ $json.output.plans[3].plan_name }}",
              "1 Pricing": "={{ $json.output.plans[0].price }}",
              "2 Pricing": "={{ $json.output.plans[1].price }}",
              "3 Pricing": "={{ $json.output.plans[2].price }}",
              "4 Pricing": "={{ $json.output.plans[3].price }}",
              "row_number": "2",
              "1 Key Features": "={{ $json.output.plans[0].key_features }}",
              "2 Key Features": "={{ $json.output.plans[1].key_features }}",
              "3 Key Features": "={{ $json.output.plans[2].key_features }}",
              "4 Key Features": "={{ $json.output.plans[3].key_features }}"
            },
            "schema": [
              {
                "id": "1 Plan",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "1 Plan",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "1 Pricing",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "1 Pricing",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "1 Key Features",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "1 Key Features",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "2 Plan",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "2 Plan",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "2 Pricing",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "2 Pricing",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "2 Key Features",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "2 Key Features",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "3 Plan",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "3 Plan",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "3 Pricing",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "3 Pricing",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "3 Key Features",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "3 Key Features",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "4 Plan",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "4 Plan",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "4 Pricing",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "4 Pricing",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "4 Key Features",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "4 Key Features",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1olDNB5lFN8NGfVK8otJF2A8aYiR5jG6ve7cqwPyPXrY/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1olDNB5lFN8NGfVK8otJF2A8aYiR5jG6ve7cqwPyPXrY",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1olDNB5lFN8NGfVK8otJF2A8aYiR5jG6ve7cqwPyPXrY/edit?usp=drivesdk",
            "cachedResultName": "Clickup Pricing"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "r2mDaisH6e9VkwHl",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "0bc8b647-8aaf-447c-aefd-b819219b7327",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          20,
          -1260
        ],
        "parameters": {
          "color": 6,
          "width": 580,
          "height": 1440,
          "content": "## üß© **SECTION 1: Setup & Historical Data Fetch**\n\n### üîÅ 1. **Trigger: Check Job Listings**\n\nüïí **(Schedule Node)**\nThis starts the automation on a regular interval ‚Äî daily, weekly, etc.\n\n**Use Case**: Ensures your workflow is constantly monitoring the latest ClickUp pricing updates without manual effort.\n\n---\n\n### üõ†Ô∏è 2. **Set Search Parameters**\n\n‚úèÔ∏è **(Set Node)**\nDefines static inputs like the page URL, service name (\"ClickUp\"), or brand being tracked. These parameters tell the agent what exactly to look for.\n\n**Use Case**: You can reuse this automation for other tools (Notion, Airtable, etc.) by just updating these search values.\n\n---\n\n### üìÑ 3. **Retrieve Pricing Data**\n\nüìó **(Google Sheet Read Node)**\nThis fetches the last known pricing saved in your Google Sheet, acting as the reference to detect future changes.\n\n**Use Case**: Maintains a historical record to compare against the freshly scraped data.\n\n---\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c52243c8-4e6a-4011-ba0c-cc980b3b8f7d",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          700,
          -920
        ],
        "parameters": {
          "color": 2,
          "width": 400,
          "height": 1100,
          "content": "## ü§ñ **SECTION 2: AI Agent Scrapes Pricing**\n\n### ü§ñ 4. **AI Agent**\n\nüí° **(Agent Node Powered by OpenAI)**\nThe heart of the workflow. It does the intelligent part:\n\n* Uses Bright Data‚Äôs **MCP proxy** to bypass bot protections\n* Scrapes ClickUp‚Äôs pricing page\n* Parses it into structured plans using markdown + structured output\n\n**Sub-Nodes**:\n\n* üîó **MCP Client to Scrape as Markdown** ‚Äì fetches page source via mobile proxy\n* üß† **LLM Brain (OpenAI)** ‚Äì interprets content and extracts clean pricing details\n* üßÆ **Structured Output Parser** ‚Äì formats data into structured JSON like:\n\n  ```json\n  { \"plan_name\": \"Business\", \"price\": \"$12\", \"key_features\": [...] }\n  ```\n\n**Use Case**: No scraping code required. AI handles extraction even if layout or structure changes slightly on the competitor website.\n\n---\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "1d9ae3ab-13e3-43d0-a33c-6deab25cdb82",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1240,
          -1240
        ],
        "parameters": {
          "color": 3,
          "width": 440,
          "height": 1520,
          "content": "## üîÑ **SECTION 3: Compare, Decide & Update**\n\n### üß≠ 5. **If Price Changes**\n\n‚öñÔ∏è **(IF Node)**\nSmart comparison logic:\n\n* Compares scraped price with saved price\n* If they **match**, nothing happens\n* If they **differ**, it triggers an update\n\n**Use Case**: Prevents unnecessary writes or noise. Only acts when something truly changed.\n\n---\n\n### ‚ùå 6. **No Operation, Do Nothing**\n\nüõë **(Empty Node)**\nThis is the false branch of the IF check. If prices are the same, this path confirms that no update is needed.\n\n---\n\n### üì§ 7. **Update Google Sheet**\n\nüìó **(Google Sheet Write Node)**\nIf there's a price change, this node updates your record with the new pricing info.\n\n**Use Case**: Keeps your competitor tracking spreadsheet always up-to-date ‚Äî automatically.\n\n---\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "6c257ba0-74ad-4b80-ac49-c8ca92de931b",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1760,
          -1240
        ],
        "parameters": {
          "color": 7,
          "width": 380,
          "height": 240,
          "content": "## I‚Äôll receive a tiny commission if you join Bright Data through this link‚Äîthanks for fueling more free content!\n\n### https://get.brightdata.com/1tndi4600b25"
        },
        "typeVersion": 1
      },
      {
        "id": "4ba2638f-0995-477b-8031-d34423041e93",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1640,
          -1260
        ],
        "parameters": {
          "color": 4,
          "width": 1300,
          "height": 320,
          "content": "=======================================\n            WORKFLOW ASSISTANCE\n=======================================\nFor any questions or support, please contact:\n    Yaron@nofluff.online\n\nExplore more tips and tutorials here:\n   - YouTube: https://www.youtube.com/@YaronBeen/videos\n   - LinkedIn: https://www.linkedin.com/in/yaronbeen/\n=======================================\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b0e2647e-9bf5-4dd4-8114-863dc2f9ba1a",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1640,
          -920
        ],
        "parameters": {
          "color": 4,
          "width": 1289,
          "height": 3198,
          "content": "## üöÄ **Track ClickUp Pricing Changes Automatically**\n\nA no-code automation using **n8n**, **Bright Data MCP**, and **Google Sheets** to monitor pricing changes on ClickUp and update the record only when something changes.\n\n---\n\n## üß© **SECTION 1: Setup & Historical Data Fetch**\n\n### üîÅ 1. **Trigger: Check Job Listings**\n\nüïí **(Schedule Node)**\nThis starts the automation on a regular interval ‚Äî daily, weekly, etc.\n\n**Use Case**: Ensures your workflow is constantly monitoring the latest ClickUp pricing updates without manual effort.\n\n---\n\n### üõ†Ô∏è 2. **Set Search Parameters**\n\n‚úèÔ∏è **(Set Node)**\nDefines static inputs like the page URL, service name (\"ClickUp\"), or brand being tracked. These parameters tell the agent what exactly to look for.\n\n**Use Case**: You can reuse this automation for other tools (Notion, Airtable, etc.) by just updating these search values.\n\n---\n\n### üìÑ 3. **Retrieve Pricing Data**\n\nüìó **(Google Sheet Read Node)**\nThis fetches the last known pricing saved in your Google Sheet, acting as the reference to detect future changes.\n\n**Use Case**: Maintains a historical record to compare against the freshly scraped data.\n\n---\n\n## ü§ñ **SECTION 2: AI Agent Scrapes Pricing**\n\n### ü§ñ 4. **AI Agent**\n\nüí° **(Agent Node Powered by OpenAI)**\nThe heart of the workflow. It does the intelligent part:\n\n* Uses Bright Data‚Äôs **MCP proxy** to bypass bot protections\n* Scrapes ClickUp‚Äôs pricing page\n* Parses it into structured plans using markdown + structured output\n\n**Sub-Nodes**:\n\n* üîó **MCP Client to Scrape as Markdown** ‚Äì fetches page source via mobile proxy\n* üß† **LLM Brain (OpenAI)** ‚Äì interprets content and extracts clean pricing details\n* üßÆ **Structured Output Parser** ‚Äì formats data into structured JSON like:\n\n  ```json\n  { \"plan_name\": \"Business\", \"price\": \"$12\", \"key_features\": [...] }\n  ```\n\n**Use Case**: No scraping code required. AI handles extraction even if layout or structure changes slightly on the competitor website.\n\n---\n\n## üîÑ **SECTION 3: Compare, Decide & Update**\n\n### üß≠ 5. **If Price Changes**\n\n‚öñÔ∏è **(IF Node)**\nSmart comparison logic:\n\n* Compares scraped price with saved price\n* If they **match**, nothing happens\n* If they **differ**, it triggers an update\n\n**Use Case**: Prevents unnecessary writes or noise. Only acts when something truly changed.\n\n---\n\n### ‚ùå 6. **No Operation, Do Nothing**\n\nüõë **(Empty Node)**\nThis is the false branch of the IF check. If prices are the same, this path confirms that no update is needed.\n\n---\n\n### üì§ 7. **Update Google Sheet**\n\nüìó **(Google Sheet Write Node)**\nIf there's a price change, this node updates your record with the new pricing info.\n\n**Use Case**: Keeps your competitor tracking spreadsheet always up-to-date ‚Äî automatically.\n\n---\n\n## üéØ **Benefits for Beginners**\n\n| üß† **Smart**                            | üö´ **No Coding Needed**     | üîÑ **Always Updated**                         |\n| --------------------------------------- | --------------------------- | --------------------------------------------- |\n| Uses AI to extract complex pricing info | Every part is drag-and-drop | Keeps your database aligned with live pricing |\n\n---\n\n## ‚ú® **Visual Summary**\n\n```\n[‚è± Trigger] ‚ûù [‚úèÔ∏è Set Params] ‚ûù [üìÑ Fetch Old Prices]\n        ‚¨á\n     [ü§ñ Agent Scrapes with AI & Bright Data MCP]\n        ‚¨á\n[‚öñÔ∏è Compare Old vs New] ‚Üí false ‚Üí [üö´ Do Nothing]\n                     ‚Ü≥ true ‚Üí [üìó Update Google Sheet]\n```\n\n---\n\n## üß© Want to Extend This?\n\n* üîî **Slack Alerts**: Notify your team when pricing changes\n* üìä **Charts**: Build dashboards from historical pricing\n* üì• **Auto-Save Snapshots**: Save HTML or screenshots for compliance\n* üìå **Multiple Competitors**: Track Airtable, Notion, Monday.com by duplicating this setup\n\n---\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b25022dc-2a54-4738-9720-230af526fa5d",
        "name": "Auto-fixing Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
        "position": [
          1060,
          300
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "0f5ff62f-d358-4031-a2a7-f771e0d6fe81",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1000,
          560
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8sEyPDkC5p4w4Jha",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "44a40a39-67c1-4445-9b8b-f5dcda67ed99",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1180,
          560
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"plans\": [\n    {\n      \"plan_name\": \"Free Forever\",\n      \"price\": \"Free\",\n      \"key_features\": [\n        \"60MB Storage\",\n        \"Unlimited Tasks\",\n        \"Unlimited Free Plan Members\",\n        \"Two-Factor Authentication\",\n        \"Collaborative Docs\",\n        \"Kanban Boards\",\n        \"Sprint Management\",\n        \"Calendar View\",\n        \"Custom Field Manager Basic\",\n        \"In-App Video Recording\",\n        \"24/7 Support\",\n        \"1 Form\"\n      ]\n    },\n    {\n      \"plan_name\": \"Unlimited\",\n      \"price\": \"$7 per user per month\",\n      \"key_features\": [\n        \"Everything in Free Forever plus\",\n        \"2GB Storage per user\",\n        \"Unlimited Folders and Spaces\",\n        \"Unlimited Integrations\",\n        \"Unlimited Gantt Charts\",\n        \"Unlimited Custom Fields\",\n        \"Unlimited Chat Messages\",\n        \"Unlimited Forms\",\n        \"Guests with Permissions\",\n        \"Email in ClickUp\",\n        \"3 Teams (User Group)\",\n        \"Native Time Tracking\",\n        \"Goals & Portfolios\",\n        \"Resource Management\",\n        \"AI Compatible\"\n      ]\n    },\n    {\n      \"plan_name\": \"Business\",\n      \"price\": \"$12 per user per month\",\n      \"key_features\": [\n        \"Everything in Unlimited, plus\",\n        \"Google SSO\",\n        \"Unlimited Storage\",\n        \"Unlimited Teams\",\n        \"Unlimited Message History\",\n        \"Unlimited Mind Maps\",\n        \"Unlimited Activity views\",\n        \"Unlimited Timeline views\",\n        \"Unlimited Dashboards\",\n        \"Unlimited Whiteboards\",\n        \"Sprint Points & Reporting\",\n        \"Automation Integrations\",\n        \"Custom Exporting\",\n        \"Private Whiteboards\",\n        \"Workload Management\",\n        \"SMS 2-Factor Authentication\",\n        \"More Automations\"\n      ]\n    },\n    {\n      \"plan_name\": \"Enterprise\",\n      \"price\": \"Custom pricing\",\n      \"key_features\": [\n        \"Everything in Business, plus\",\n        \"White Labeling\",\n        \"Conditional Logic in Forms\",\n        \"Team Sharing for Spaces\",\n        \"Custom Roles\",\n        \"Custom Capacity in Workload\",\n        \"Enterprise API\",\n        \"Unlimited Posts\",\n        \"Default Personal Views\",\n        \"Advanced Permissions\",\n        \"Advanced Public Sharing\",\n        \"MSA & HIPPA Available\",\n        \"Single Sign-On (SSO)\",\n        \"SCIM Provisioning\",\n        \"US, EU, & APAC Data Residency\",\n        \"Live Onboarding Training\",\n        \"Customer Success Manager\",\n        \"Access to Managed Services\"\n      ]\n    }\n  ]\n}\n"
        },
        "typeVersion": 1.2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "d26222dc-4c8c-46da-9a8f-5a7977d940e2",
    "connections": {
      "AI agent": {
        "main": [
          [
            {
              "node": "If price changes",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If price changes": {
        "main": [
          [
            {
              "node": "No Operation, do nothing",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Update google sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Auto-fixing Output Parser",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Retrieve Pricing data": {
        "main": [
          [
            {
              "node": "AI agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üß† OpenAI: LLM Brain": {
        "ai_languageModel": [
          [
            {
              "node": "AI agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Auto-fixing Output Parser",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Auto-fixing Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "AI agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "üõ†Ô∏è Set Search Parameters": {
        "main": [
          [
            {
              "node": "Retrieve Pricing data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "‚è∞ Trigger: Check Job Listings": {
        "main": [
          [
            {
              "node": "üõ†Ô∏è Set Search Parameters",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "MCP Client to Scrape as markdown": {
        "ai_tool": [
          [
            {
              "node": "AI agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "YOUR_WORKFLOW_ID",
    "meta": {
      "instanceId": "YOUR_INSTANCE_ID",
      "templateCredsSetupCompleted": true
    },
    "name": "Automated Content Generation & Publishing - Wordpress",
    "tags": [],
    "nodes": [
      {
        "id": "9cd63357-19dc-4420-baa9-1e1389c7120f",
        "name": "Create posts on Wordpress",
        "type": "n8n-nodes-base.wordpress",
        "position": [
          1180,
          280
        ],
        "parameters": {
          "title": "={{ $('Save to Sheet').item.json['title'] }}",
          "additionalFields": {
            "status": "publish",
            "content": "=<img src=\"{{ $('Automated Image Retrieval from Pexels').item.json.photos[0].src.landscape }}\" alt=\"image text\" style=\"width:100%; height:auto;\"><br><br>\n<br><br>\n{{ $node['Save to Sheet'].json['content'] }}"
          }
        },
        "credentials": {
          "wordpressApi": {
            "id": "YOUR_WORDPRESS_CREDENTIAL_ID",
            "name": "Wordpress account 2"
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": false
      },
      {
        "id": "65f62f19-d10f-4ca1-a853-9cedb3506743",
        "name": "Processing Delay",
        "type": "n8n-nodes-base.code",
        "position": [
          180,
          580
        ],
        "parameters": {
          "jsCode": "const delay = Math.floor(Math.random() * (6 * 60 * 60 * 1000)); // random delay 0-6 hour\nreturn {\n  json: {\n    delay: delay,\n    delay_minutes: Math.round(delay / 60000),  // to minutes\n    delay_hours: (delay / 3600000).toFixed(2) // to hours\n  }\n};\n"
        },
        "typeVersion": 2
      },
      {
        "id": "193d2876-c50e-4b9e-8856-9fd11baa025e",
        "name": "Random Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          180,
          760
        ],
        "webhookId": "61377399-ce9f-497a-80b1-aab29fc9fb69",
        "parameters": {
          "amount": "={{$json[\"delay\"] / 1000}}"
        },
        "typeVersion": 1.1
      },
      {
        "id": "cf510c21-7c19-4e84-a43a-62d170277cdf",
        "name": "Save to Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          780,
          280
        ],
        "parameters": {
          "columns": {
            "value": {
              "title": "={{ $json.message.content.title }}",
              "content": "={{ $json.message.content.content }}",
              "Image search keyword": "={{ $json.message.content.keywords.join(\"+\") }}"
            },
            "schema": [
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "content",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "content",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Image search keyword",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Image search keyword",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": []
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "name",
            "value": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "url",
            "value": "YOURDOCUMENT_URL"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "YOUR_GOOGLE_SHEETS_CREDENTIAL_ID",
            "name": "Google Sheets account_Ê≠£Á¢∫"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "1778f649-c09e-4ef9-b153-4160eed6805c",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -220,
          0
        ],
        "parameters": {
          "width": 607.503259452412,
          "height": 892.7656453715782,
          "content": "## Automated Article Scheduling\n\n**1. Fast Bulk Article Generation**\nQuickly create multiple AI-generated articles.\nEfficiently streamline content creation.\nReduces manual effort while maintaining quality.\n\n**2. Workflow Testing Before Execution**\nManually test the workflow for debugging.\nEnsure each step runs as expected.\nOptimize before full automation.\n\n**3. Automated & Randomized Publishing**\nSchedule posts at predefined intervals.\nIntroduce random delays for a natural posting pattern.\nPrevents overly predictable publishing behavior."
        },
        "typeVersion": 1
      },
      {
        "id": "6f385e8c-b3e6-4456-9738-e85ea2cbbea1",
        "name": "1. Auto Start",
        "type": "n8n-nodes-base.scheduleTrigger",
        "disabled": true,
        "position": [
          180,
          20
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "minutes",
                "minutesInterval": 1
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6d7712e8-9033-453b-ad52-09f718bcb701",
        "name": "2. When clicking ‚ÄòTest workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "disabled": true,
        "position": [
          180,
          200
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "0fd8fe8f-a0d5-42d9-b728-53340c6e4233",
        "name": "3. Schedule Your Posts",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          180,
          380
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "weeks",
                "triggerAtDay": [
                  2,
                  4,
                  0
                ],
                "triggerAtHour": "={{ 12 }}"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "16c26c36-fb8e-4903-a64c-57803fac83b9",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          440
        ],
        "parameters": {
          "width": 351.77682676671327,
          "height": 271.4285686334568,
          "content": "## AI Content Generating\n\n**Automatic Content & Keyword Generation\n\n- Use your own prompt to start\n- ChatGPT generates full-length articles with structured headings.\n- Extracts relevant image search keywords for visual enhancement.\n- To implement this, add the following prompt (green note) below your workflow:\n"
        },
        "typeVersion": 1
      },
      {
        "id": "921173fb-ae10-4f88-a1ab-15f063cd623f",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          740
        ],
        "parameters": {
          "color": 4,
          "width": 349.47344203333904,
          "height": 1277.4269457977707,
          "content": "(YOUR PROMPT)\n\n**Image Search Keywords (For Visual Alignment)**\n\n- Automatically generates 3-5 English keywords for image searches based on the article content.\n- Keywords should be specific objects, locations, or atmospheres rather than abstract concepts.\n\n**Article Formatting Requirements**\n\n1Ô∏è‚É£ Title (H1): Ensure unique and trend-driven headlines.\n2Ô∏è‚É£ H2 / H3 Subheadings: Structure content in an SEO-optimized format.\n3Ô∏è‚É£ Article Structure (Enhanced Readability)\n\n** Introduction **\n- Go straight to the point, avoiding excessive background.\n- Use question hooks or market trend data to engage readers.\n\n** Core Content **\n- Include at least three knowledge points to ensure depth.\n- Balance short and long sentences for better flow.\n\n** Conclusion **\n- Avoid generic AI-style summaries; instead, provide insights or actionable takeaways.\n- Optionally include a CTA (Call to Action).\n\n** HTML Formatting **\nEnsure the article is properly structured in HTML format:\n- Headings: Use <h1>, <h2>, <h3> appropriately.\n- Paragraphs: Enclose text within <p>.\n- Emphasized Words: Use <strong> to highlight key terms.\n- Lists: Use <ul> and <li> for bullet points.\n\nEnsure a clean, well-structured output instead of plain text.\n\n### **Final JSON Format\nEnsure the output follows this structure:\n\n{\n  \"title\": \"{Generate an H1 title that aligns with market trends, ensures high click-through rates, and follows keyword strategy}\",\n  \"content\": \"{Generate a complete HTML article including H1, H2, H3 headings, paragraphs, lists, etc.}\",\n  \"keywords\": [\"{Image search keyword 1}\", \"{Image search keyword 2}\", \"{Image search keyword 3}\", \"{Image search keyword 4}\", \"{Image search keyword 5}\"]\n}"
        },
        "typeVersion": 1
      },
      {
        "id": "364b1ee1-4685-4b10-b988-1704dc65592b",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          760,
          440
        ],
        "parameters": {
          "width": 367.1064142931126,
          "height": 267.17005729996885,
          "content": "## Google Sheet Setting\n**You need to set up these in your sheet column** \n- title\n- content\n- image search keyword\n\n**Mapping \"Values to Send\"**\n- {{ $json.message.content.title }}\n- {{ $json.message.content.content }}\n- {{ $json.message.content.keywords.join(\"+\") }}"
        },
        "typeVersion": 1
      },
      {
        "id": "26876b53-aa27-4e16-991e-c3618e751c17",
        "name": "Automated Image Retrieval from Pexels",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          980,
          280
        ],
        "parameters": {
          "url": "=https://api.pexels.com/v1/search?per_page=1&orientation=landscape&query={{ $json[\"Image search keyword\"] }}\n",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "query",
                "value": "={{ $json['Image search keyword'] }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "YOUR_PEXELS_API_KEY"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "769638be-ee38-4e40-a508-f998b09ce1f4",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -220,
          -240
        ],
        "parameters": {
          "color": 3,
          "width": 608.0701163493336,
          "height": 211.65896369815192,
          "content": "## Introduction: WordPress automatically publishes posts and inserts the first image\n\nIt is **highly recommended to install the Featured Image from URL (FIFU) plugin** and enable:\n\n**Auto > Set Featured Media Automatically from Content.** before you generate contents."
        },
        "typeVersion": 1
      },
      {
        "id": "37f3606f-f110-49d2-bcf5-1edc27149fee",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          229.99235545929986
        ],
        "parameters": {
          "width": 348.08256103956126,
          "height": 170.00764454070014,
          "content": "Add your API credential"
        },
        "typeVersion": 1
      },
      {
        "id": "2399a40d-4b79-400c-9e96-df7e683fd666",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          760,
          228.00611563256007
        ],
        "parameters": {
          "width": 150,
          "height": 170.00764454070008,
          "content": "Add your API credential"
        },
        "typeVersion": 1
      },
      {
        "id": "45e479a6-2eea-44a1-9096-9895a18904fd",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          920,
          226.01987580582022
        ],
        "parameters": {
          "width": 201.97095074533956,
          "height": 172.00917344884022,
          "content": "Add your API credential"
        },
        "typeVersion": 1
      },
      {
        "id": "e0489552-a7b5-4161-9553-95e23605a9d5",
        "name": "Generate AI Content",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          440,
          280
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "(YOUR PROMPT)\n(YOUR PROMPT)\n\n**Image Search Keywords (For Visual Alignment)**\n\n- Automatically generates 3-5 English keywords for image searches based on the article content.\n- Keywords should be specific objects, locations, or atmospheres rather than abstract concepts.\n\n**Article Formatting Requirements**\n\n1Ô∏è‚É£ Title (H1): Ensure unique and trend-driven headlines.\n2Ô∏è‚É£ H2 / H3 Subheadings: Structure content in an SEO-optimized format.\n3Ô∏è‚É£ Article Structure (Enhanced Readability)\n\n** Introduction **\n- Go straight to the point, avoiding excessive background.\n- Use question hooks or market trend data to engage readers.\n\n** Core Content **\n- Include at least three knowledge points to ensure depth.\n- Balance short and long sentences for better flow.\n\n** Conclusion **\n- Avoid generic AI-style summaries; instead, provide insights or actionable takeaways.\n- Optionally include a CTA (Call to Action).\n\n** HTML Formatting **\nEnsure the article is properly structured in HTML format:\n- Headings: Use <h1>, <h2>, <h3> appropriately.\n- Paragraphs: Enclose text within <p>.\n- Emphasized Words: Use <strong> to highlight key terms.\n- Lists: Use <ul> and <li> for bullet points.\n\nEnsure a clean, well-structured output instead of plain text.\n\n### **Final JSON Format\nEnsure the output follows this structure:\n\n{\n  \"title\": \"{Generate an H1 title that aligns with market trends, ensures high click-through rates, and follows keyword strategy}\",\n  \"content\": \"{Generate a complete HTML article including H1, H2, H3 headings, paragraphs, lists, etc.}\",\n  \"keywords\": [\"{Image search keyword 1}\", \"{Image search keyword 2}\", \"{Image search keyword 3}\", \"{Image search keyword 4}\", \"{Image search keyword 5}\"]\n}"
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "YOUR_OPENAI_CREDENTIAL_ID",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.6
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "timezone": "Asia/Taipei",
      "callerPolicy": "workflowsFromSameOwner",
      "executionOrder": "v1",
      "executionTimeout": -1,
      "saveManualExecutions": true
    },
    "versionId": "YOUR_VERSION_ID",
    "connections": {
      "Random Wait": {
        "main": [
          [
            {
              "node": "Generate AI Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save to Sheet": {
        "main": [
          [
            {
              "node": "Automated Image Retrieval from Pexels",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Processing Delay": {
        "main": [
          [
            {
              "node": "Random Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate AI Content": {
        "main": [
          [
            {
              "node": "Save to Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "3. Schedule Your Posts": {
        "main": [
          [
            {
              "node": "Processing Delay",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Automated Image Retrieval from Pexels": {
        "main": [
          [
            {
              "node": "Create posts on Wordpress",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "04fd795d32aabb18b913b4a3350b5cd0e9313a422ea0e7bdac0da2fb76cac9f7"
    },
    "nodes": [
      {
        "id": "7c3b77b8-3c35-4902-9390-20a923c1e225",
        "name": "Daily Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -340,
          120
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "a8feb8a7-e4ca-4191-9197-cb4ecbcf12f0",
        "name": "üìã Configuration Settings",
        "type": "n8n-nodes-base.set",
        "position": [
          -120,
          120
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "competitor_domains",
                "value": "opofinance.com,etoro.com"
              },
              {
                "name": "target_regions",
                "value": "US,UK,DE,FR,JP"
              },
              {
                "name": "seed_keywords",
                "value": "forex trading,social trade,how to trade"
              },
              {
                "name": "timeframe_days",
                "value": "30"
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "ae1d8d60-63c7-4caa-a588-820cb0366210",
        "name": "üìä SEMrush Competitor Keywords",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          100,
          140
        ],
        "parameters": {
          "url": "https://api.semrush.com/",
          "options": {},
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "queryAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "type",
                "value": "domain_organic"
              },
              {
                "name": "key",
                "value": "={{ $credentials.semrush.api_key }}"
              },
              {
                "name": "domain",
                "value": "={{ $json.competitor_domains.split(',')[0] }}"
              },
              {
                "name": "display_limit",
                "value": "50"
              },
              {
                "name": "export_columns",
                "value": "Ph,Po,Pp,Pd,Nq,Cp,Ur,Tr,Tc,Co,Nr,Td"
              }
            ]
          }
        },
        "typeVersion": 4
      },
      {
        "id": "03c76954-73b0-4fe6-8a56-91641d243f60",
        "name": "üìà BuzzSumo Content Performance",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          100,
          260
        ],
        "parameters": {
          "url": "https://api.buzzsumo.com/search/articles.json",
          "options": {},
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "q",
                "value": "={{ $json.seed_keywords.split(',')[0] }}"
              },
              {
                "name": "num_results",
                "value": "20"
              },
              {
                "name": "published_after",
                "value": "={{ $now.minus({ days: parseInt($json.timeframe_days) }).toFormat('yyyy-MM-dd') }}"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "luTyM3gZSgwhM8i0",
            "name": "Header Auth account"
          }
        },
        "typeVersion": 4
      },
      {
        "id": "30b4a756-daa8-4dc8-a39d-cb769e20bf2d",
        "name": "üìä Google Trends Data",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          320,
          20
        ],
        "parameters": {
          "url": "https://trends.google.com/trends/api/explore",
          "options": {},
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "hl",
                "value": "en-US"
              },
              {
                "name": "tz",
                "value": "360"
              },
              {
                "name": "req",
                "value": "={\"comparisonItem\":[{\"keyword\":\"{{ $json.seed_keywords.split(',')[0] }}\",\"geo\":\"US\",\"time\":\"today 3-m\"}],\"category\":0,\"property\":\"\"}"
              }
            ]
          }
        },
        "typeVersion": 4
      },
      {
        "id": "16bd1558-e709-4304-972b-feb339b647af",
        "name": "‚ùì AnswerThePublic Questions",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          320,
          140
        ],
        "parameters": {
          "url": "https://api.answerthepublic.com/api/v1/questions",
          "options": {},
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "keyword",
                "value": "={{ $json.seed_keywords.split(',')[0] }}"
              },
              {
                "name": "country",
                "value": "us"
              },
              {
                "name": "language",
                "value": "en"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "luTyM3gZSgwhM8i0",
            "name": "Header Auth account"
          }
        },
        "typeVersion": 4
      },
      {
        "id": "522ac238-e87c-43ea-8cac-26dc5faf21b5",
        "name": "üí¨ Reddit Audience Insights",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          320,
          260
        ],
        "parameters": {
          "url": "=https://oauth.reddit.com/r/{{ $json.seed_keywords.split(',')[0].replace(' ', '') }}/hot.json",
          "options": {},
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "oAuth2Api",
          "queryParameters": {
            "parameters": [
              {
                "name": "limit",
                "value": "25"
              },
              {
                "name": "t",
                "value": "month"
              }
            ]
          }
        },
        "credentials": {
          "oAuth2Api": {
            "id": "5wHvALjli8pAJpgP",
            "name": "Unnamed credential"
          }
        },
        "typeVersion": 4
      },
      {
        "id": "935024db-a6ba-4218-8ac3-9aaf247f9a1c",
        "name": "üîÑ Process Competitor Data",
        "type": "n8n-nodes-base.code",
        "position": [
          540,
          80
        ],
        "parameters": {
          "jsCode": "// Combine all competitor data\nconst ahrefsData = $input.first()?.json || {};\nconst semrushData = $input.all().find(item => item.json?.domain) || {};\nconst buzzsumoData = $input.all().find(item => item.json?.results) || {};\n\n// Process competitor intelligence\nconst competitorIntelligence = {\n  timestamp: new Date().toISOString(),\n  domain: ahrefsData.target || 'N/A',\n  traffic_estimate: ahrefsData.traffic?.organic?.value || 0,\n  backlinks: ahrefsData.backlinks?.total || 0,\n  top_keywords: semrushData.json?.keywords?.slice(0, 10) || [],\n  viral_content: buzzsumoData.json?.results?.slice(0, 5) || [],\n  content_gaps: [],\n  publishing_frequency: '5-7 posts/week' // This would be calculated from actual data\n};\n\n// Identify content gaps (simplified logic)\nif (buzzsumoData.json?.results) {\n  const competitorTopics = buzzsumoData.json.results.map(article => article.title);\n  competitorIntelligence.content_gaps = [\n    'Sustainable packaging solutions',\n    'Circular economy in fashion',\n    'Eco-friendly manufacturing processes'\n  ];\n}\n\nreturn [{ json: competitorIntelligence }];"
        },
        "typeVersion": 2
      },
      {
        "id": "a0799c40-03a3-482a-8329-af088430ce6e",
        "name": "üìà Process Keyword Trends",
        "type": "n8n-nodes-base.code",
        "position": [
          540,
          200
        ],
        "parameters": {
          "jsCode": "// Combine trends and keyword data\nconst trendsData = $input.all().find(item => item.json?.default) || {};\nconst questionsData = $input.all().find(item => item.json?.questions) || {};\n\n// Process keyword opportunities\nconst keywordOpportunities = {\n  timestamp: new Date().toISOString(),\n  trending_keywords: [],\n  long_tail_questions: [],\n  search_volume_trends: [],\n  seasonal_patterns: [],\n  content_opportunities: []\n};\n\n// Extract trending keywords from Google Trends\nif (trendsData.json?.default?.timelineData) {\n  keywordOpportunities.trending_keywords = trendsData.json.default.timelineData\n    .slice(0, 10)\n    .map(item => ({\n      keyword: item.formattedValue || 'Unknown',\n      trend_velocity: item.value?.[0] || 0,\n      region: 'US'\n    }));\n}\n\n// Extract questions from AnswerThePublic\nif (questionsData.json?.questions) {\n  keywordOpportunities.long_tail_questions = questionsData.json.questions\n    .slice(0, 15)\n    .map(q => ({\n      question: q.question || q,\n      search_volume: Math.floor(Math.random() * 1000) + 100, // Placeholder\n      difficulty: Math.floor(Math.random() * 100) + 1,\n      suggested_format: ['blog', 'video', 'infographic'][Math.floor(Math.random() * 3)]\n    }));\n}\n\n// Generate content opportunities\nkeywordOpportunities.content_opportunities = [\n  {\n    title: '5 Sustainable Fashion Trends Taking Over 2024',\n    keyword_target: 'sustainable fashion trends',\n    estimated_traffic: 2500,\n    content_type: 'blog',\n    priority: 'high'\n  },\n  {\n    title: 'How to Build a Circular Economy Wardrobe',\n    keyword_target: 'circular economy fashion',\n    estimated_traffic: 1800,\n    content_type: 'guide',\n    priority: 'medium'\n  }\n];\n\nreturn [{ json: keywordOpportunities }];"
        },
        "typeVersion": 2
      },
      {
        "id": "01ad5545-7d95-4de6-bb85-5e0647de8b08",
        "name": "üë• Process Audience Insights",
        "type": "n8n-nodes-base.code",
        "position": [
          540,
          320
        ],
        "parameters": {
          "jsCode": "// Process Reddit audience insights\nconst redditData = $input.first()?.json || {};\n\nconst audienceInsights = {\n  timestamp: new Date().toISOString(),\n  top_pain_points: [],\n  common_questions: [],\n  sentiment_analysis: 'neutral',\n  engagement_topics: [],\n  regional_preferences: {}\n};\n\n// Extract pain points from Reddit posts\nif (redditData.data?.children) {\n  const posts = redditData.data.children;\n  \n  audienceInsights.top_pain_points = posts\n    .filter(post => post.data.title.includes('problem') || post.data.title.includes('issue'))\n    .slice(0, 10)\n    .map(post => ({\n      pain_point: post.data.title,\n      upvotes: post.data.ups || 0,\n      comments: post.data.num_comments || 0,\n      source: 'reddit'\n    }));\n    \n  audienceInsights.common_questions = posts\n    .filter(post => post.data.title.includes('?') || post.data.title.toLowerCase().includes('how'))\n    .slice(0, 10)\n    .map(post => ({\n      question: post.data.title,\n      engagement_score: (post.data.ups || 0) + (post.data.num_comments || 0),\n      category: 'general'\n    }));\n    \n  audienceInsights.engagement_topics = posts\n    .sort((a, b) => (b.data.ups || 0) - (a.data.ups || 0))\n    .slice(0, 5)\n    .map(post => ({\n      topic: post.data.title,\n      engagement_score: post.data.ups || 0,\n      discussion_level: post.data.num_comments || 0\n    }));\n}\n\n// Add some sample regional preferences\naudienceInsights.regional_preferences = {\n  'US': ['affordability', 'brand transparency'],\n  'EU': ['sustainability certifications', 'local production'],\n  'APAC': ['quality', 'innovation']\n};\n\nreturn [{ json: audienceInsights }];"
        },
        "typeVersion": 2
      },
      {
        "id": "7309b40f-a792-44e6-9330-cdde7f74ae39",
        "name": "üíæ Save to Airtable - Competitors",
        "type": "n8n-nodes-base.airtable",
        "position": [
          1200,
          20
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "content-research-base"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "competitor-intelligence"
          },
          "columns": {
            "value": {
              "domain": "={{ $('üîÑ Process Competitor Data').first().json.domain }}",
              "backlinks": "={{ $('üîÑ Process Competitor Data').first().json.backlinks }}",
              "timestamp": "={{ $('üîÑ Process Competitor Data').first().json.timestamp }}",
              "content_gaps": "={{ $('üîÑ Process Competitor Data').first().json.content_gaps.join(', ') }}",
              "traffic_estimate": "={{ $('üîÑ Process Competitor Data').first().json.traffic_estimate }}",
              "publishing_frequency": "={{ $('üîÑ Process Competitor Data').first().json.publishing_frequency }}"
            },
            "mappingMode": "defineBelow"
          },
          "options": {},
          "operation": "create"
        },
        "typeVersion": 2
      },
      {
        "id": "67f76da6-0961-4e99-93d4-1c1a9f2735f6",
        "name": "üíæ Save to Airtable - Keywords",
        "type": "n8n-nodes-base.airtable",
        "position": [
          1200,
          140
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "content-research-base"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "keyword-opportunities"
          },
          "columns": {
            "value": {
              "timestamp": "={{ $('üìà Process Keyword Trends').first().json.timestamp }}",
              "top_questions": "={{ $('üìà Process Keyword Trends').first().json.long_tail_questions.map(q => q.question).slice(0, 5).join('; ') }}",
              "trending_keywords": "={{ $('üìà Process Keyword Trends').first().json.trending_keywords.map(k => k.keyword).join(', ') }}",
              "content_opportunities": "={{ $('üìà Process Keyword Trends').first().json.content_opportunities.map(o => o.title).join('; ') }}"
            },
            "mappingMode": "defineBelow"
          },
          "options": {},
          "operation": "create"
        },
        "typeVersion": 2
      },
      {
        "id": "cbbecb7f-eb99-4f75-a9ce-07a7a9037b5a",
        "name": "üìù Save to Notion",
        "type": "n8n-nodes-base.notion",
        "position": [
          1200,
          260
        ],
        "parameters": {
          "pageId": {
            "__rl": true,
            "mode": "url",
            "value": ""
          },
          "simple": false,
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "e7f0fb5b-2a21-490f-9dff-af59cc922967",
        "name": "üì¢ Send Slack Alert",
        "type": "n8n-nodes-base.slack",
        "position": [
          1200,
          380
        ],
        "webhookId": "277f81d9-9e7b-4515-8056-56c1465f8d5a",
        "parameters": {
          "text": "=üö® **Content Research Alert**\n\n**New competitor activity detected!**\n\nüìä **Top Findings:**\n‚Ä¢ {{ $('üîÑ Process Competitor Data').first().json.content_gaps.slice(0, 3).join('\\n‚Ä¢ ') }}\n\nüìà **Trending Keywords:**\n‚Ä¢ {{ $('üìà Process Keyword Trends').first().json.trending_keywords.slice(0, 3).map(k => k.keyword).join('\\n‚Ä¢ ') }}\n\nüí° **AI Recommendations:**\n{{ $('ü§ñ AI Content Recommendations').first().json.choices?.[0]?.message?.content?.substring(0, 300) || 'Processing recommendations...' }}...\n\nüìã **Full report saved to Airtable & Notion**\n\n*Generated: {{ new Date().toLocaleString() }}*",
          "select": "channel",
          "channelId": {
            "__rl": true,
            "mode": "list",
            "value": "content-research-alerts"
          },
          "otherOptions": {
            "mrkdwn": true
          },
          "authentication": "oAuth2"
        },
        "typeVersion": 2
      },
      {
        "id": "071e9048-a290-41fb-a05e-4c25f6fb5183",
        "name": "üîó Merge All Data",
        "type": "n8n-nodes-base.merge",
        "position": [
          1420,
          200
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combinationMode": "multiplex"
        },
        "typeVersion": 2
      },
      {
        "id": "86db9795-5c2f-4f46-a695-b48fcd172502",
        "name": "‚úÖ Data Quality Check",
        "type": "n8n-nodes-base.if",
        "position": [
          760,
          20
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 1,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "competitor-data-exists",
                "operator": {
                  "type": "string",
                  "operation": "notEqual"
                },
                "leftValue": "={{ $('üîÑ Process Competitor Data').first().json.domain }}",
                "rightValue": "N/A"
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "d24360bd-f574-4fd2-979f-1ee3299bf563",
        "name": "üìñ Setup Instructions",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1040,
          -300
        ],
        "parameters": {
          "width": 600,
          "height": 1080,
          "content": "## üß† Advanced Content Research Automation\n\n### üìã **Configuration Required:**\n\n1. **API Credentials** (Go to Settings ‚Üí Credentials):\n   - Ahrefs API Key\n   - SEMrush API Key  \n   - BuzzSumo API Key\n   - AnswerThePublic API Key\n   - OpenAI API Key\n   - Reddit OAuth\n   - Airtable Token\n   - Notion API Key\n   - Slack OAuth\n\n2. **Database Setup**:\n   - Create Airtable base: \"content-research-base\"\n   - Create tables: \"competitor-intelligence\", \"keyword-opportunities\"\n   - Create Notion database: \"content-research-database\"\n   - Create Slack channel: \"content-research-alerts\"\n\n3. **Customize Settings**:\n   - Update competitor domains in Configuration node\n   - Adjust target regions and keywords\n   - Set appropriate timeframes\n\n### üöÄ **Workflow Features:**\n- **Module 1:** Competitor Content Intelligence\n- **Module 2:** Keyword & Trend Discovery\n- **Module 3:** Audience Pain Point Extraction\n- **Module 4:** AI-Powered Recommendations\n\n### üìä **Outputs:**\n- Airtable dashboards with live data\n- Notion database with AI insights\n- Slack alerts for immediate action\n- Error handling and data validation\n\n### ‚öôÔ∏è **Execution:**\n- Runs daily automatically\n- Processes data in parallel\n- Includes retry logic for API failures\n- Generates actionable recommendations\n\n**Ready to activate? Configure your credentials and hit Execute!**"
        },
        "typeVersion": 1
      },
      {
        "id": "a812cd3b-e280-4647-8170-8e623ad46f08",
        "name": "üìù Prepare AI Prompt",
        "type": "n8n-nodes-base.set",
        "position": [
          760,
          200
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "user_prompt",
                "value": "Based on this data:\n\nCompetitor Intelligence: {{ $('üîÑ Process Competitor Data').first().json }}\n\nKeyword Opportunities: {{ $('üìà Process Keyword Trends').first().json }}\n\nAudience Insights: {{ $('üë• Process Audience Insights').first().json }}\n\nProvide specific recommendations for:\n1. Content topics to prioritize\n2. Content formats by region\n3. Publishing schedule\n4. Competitive advantages to leverage\n5. Audience pain points to address\n\nFormat as JSON with clear action items."
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "50d64d8e-1905-492a-97c4-f8978bd34931",
        "name": "üîß OpenAI HTTP Request Alternative",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          960,
          320
        ],
        "parameters": {
          "url": "https://api.openai.com/v1/chat/completions",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendHeaders": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {}
            ]
          },
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "luTyM3gZSgwhM8i0",
            "name": "Header Auth account"
          }
        },
        "typeVersion": 4
      },
      {
        "id": "4501e9b6-8c01-4e77-b963-26b3f792fa03",
        "name": "Stop and Error",
        "type": "n8n-nodes-base.stopAndError",
        "position": [
          960,
          120
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "dda25d39-be93-4a13-af39-41d57b11e8de",
        "name": "üîç Ahrefs Competitor Data",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          100,
          0
        ],
        "parameters": {
          "url": "https://api.ahrefs.com/v3/site-explorer/overview",
          "options": {
            "timeout": 60000
          },
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "target",
                "value": "={{ $json.competitor_domains.split(',')[0] }}"
              },
              {
                "name": "mode",
                "value": "domain"
              },
              {
                "name": "output",
                "value": "json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "luTyM3gZSgwhM8i0",
            "name": "Header Auth account"
          }
        },
        "typeVersion": 4
      }
    ],
    "pinData": {},
    "connections": {
      "üìù Save to Notion": {
        "main": [
          [
            {
              "node": "üîó Merge All Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üì¢ Send Slack Alert": {
        "main": [
          [
            {
              "node": "üîó Merge All Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Daily Schedule Trigger": {
        "main": [
          [
            {
              "node": "üìã Configuration Settings",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "‚úÖ Data Quality Check": {
        "main": [
          [
            {
              "node": "üíæ Save to Airtable - Competitors",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Stop and Error",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìù Prepare AI Prompt": {
        "main": [
          [
            {
              "node": "üîß OpenAI HTTP Request Alternative",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìä Google Trends Data": {
        "main": [
          [
            {
              "node": "üìà Process Keyword Trends",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìà Process Keyword Trends": {
        "main": [
          [
            {
              "node": "üìù Prepare AI Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìã Configuration Settings": {
        "main": [
          [
            {
              "node": "üìä SEMrush Competitor Keywords",
              "type": "main",
              "index": 0
            },
            {
              "node": "üìà BuzzSumo Content Performance",
              "type": "main",
              "index": 0
            },
            {
              "node": "üìä Google Trends Data",
              "type": "main",
              "index": 0
            },
            {
              "node": "‚ùì AnswerThePublic Questions",
              "type": "main",
              "index": 0
            },
            {
              "node": "üí¨ Reddit Audience Insights",
              "type": "main",
              "index": 0
            },
            {
              "node": "üîç Ahrefs Competitor Data",
              "type": "main",
              "index": 0
            },
            {
              "node": "üîÑ Process Competitor Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîç Ahrefs Competitor Data": {
        "main": [
          [
            {
              "node": "üîÑ Process Competitor Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîÑ Process Competitor Data": {
        "main": [
          [
            {
              "node": "‚úÖ Data Quality Check",
              "type": "main",
              "index": 0
            },
            {
              "node": "üìù Prepare AI Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "‚ùì AnswerThePublic Questions": {
        "main": [
          [
            {
              "node": "üìà Process Keyword Trends",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üí¨ Reddit Audience Insights": {
        "main": [
          [
            {
              "node": "üë• Process Audience Insights",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üë• Process Audience Insights": {
        "main": [
          [
            {
              "node": "üìù Prepare AI Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üíæ Save to Airtable - Keywords": {
        "main": [
          [
            {
              "node": "üîó Merge All Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìä SEMrush Competitor Keywords": {
        "main": [
          [
            {
              "node": "üîÑ Process Competitor Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìà BuzzSumo Content Performance": {
        "main": [
          [
            {
              "node": "üîÑ Process Competitor Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üíæ Save to Airtable - Competitors": {
        "main": [
          [
            {
              "node": "üîó Merge All Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîß OpenAI HTTP Request Alternative": {
        "main": [
          [
            {
              "node": "üíæ Save to Airtable - Competitors",
              "type": "main",
              "index": 0
            },
            {
              "node": "üíæ Save to Airtable - Keywords",
              "type": "main",
              "index": 0
            },
            {
              "node": "üìù Save to Notion",
              "type": "main",
              "index": 0
            },
            {
              "node": "üì¢ Send Slack Alert",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "Ucu10DYuMwYdLLVk",
    "meta": {
      "instanceId": "159ec2e1d690fe685084d28de8ca73848642bf563457a19b94cfc00f23a0d9a9",
      "templateCredsSetupCompleted": true
    },
    "name": "Scheduled Daily Email Pulse",
    "tags": [],
    "nodes": [
      {
        "id": "908a85db-7b15-4ece-8dab-19398e0c1871",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -80,
          -80
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 18
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "8cadc5e6-193e-42e9-b2fc-54a2025191c2",
        "name": "Gmail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          360,
          -80
        ],
        "webhookId": "6fbdcf54-7d41-4fb0-aa17-07edb33cd5d0",
        "parameters": {
          "simple": false,
          "filters": {
            "receivedAfter": "={{ $json.today}}",
            "receivedBefore": "={{ $json.tomorrow }}"
          },
          "options": {},
          "operation": "getAll"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "gUrhTlOlNSEw7OKA",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1,
        "alwaysOutputData": true
      },
      {
        "id": "62ab4e36-b42f-4aff-8ec5-4456f4827ca3",
        "name": "Date Transformer",
        "type": "n8n-nodes-base.code",
        "position": [
          140,
          -80
        ],
        "parameters": {
          "jsCode": "const now = new Date();\nconst today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\nconst tomorrow = new Date(today);\ntomorrow.setDate(today.getDate() + 1);\n\nconst isoDate = (d) => d.toISOString().split('.')[0] + 'Z';\n\nreturn [\n  {\n    json: {\n      today: isoDate(today),\n      tomorrow: isoDate(tomorrow),\n    },\n  },\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "c25a964f-6d41-4c97-b90f-f5ce15cadaa7",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1020,
          160
        ],
        "parameters": {
          "text": "You are an AI Chief of Staff for a small business owner. Your job is to review a day‚Äôs worth of emails, texts, and calls and produce a concise, structured summary that helps them stay focused and effective.\n\nYou must only surface tasks, people, and opportunities that appear in the message content. Do not invent next steps, leads, or strategy notes.\n\nIf a section has no relevant content, leave it out entirely. It‚Äôs better to report nothing than to guess.",
          "options": {
            "systemMessage": "=Below is a transcript of today‚Äôs messages ‚Äî including email, text, and call summaries.\n\nAnalyze the content and generate a markdown-formatted **Daily Business Pulse**, using only what appears in the messages. Do not assume, extrapolate, or fabricate any details.\n\nMessages:\n{{ $json.combinedText }}\n\nUse the structure below. Omit any section that has no relevant content.\n\n---\n\nüëã **Here‚Äôs what matters from your day**\n\n---\n\nüìù **Open Loops / Pending Follow-Ups**  \n_List any conversations that require a response or action._\n\n---\n\nüöÄ **Next Steps You've Committed To**  \n_List anything the user said they would do._\n\n---\n\nüß≤ **Leads or Conversations Worth Following Up On**  \n_Only include if the person expressed interest or asked for help._\n\n---\n\nüõë **Conversations That Aren‚Äôt Leading Anywhere**  \n_Include if there are back-and-forths with no progress, spam, or promotional threads._\n\n---\n\nüß† **Strategy Notes**  \n_Only add notes if there are clear, recurring themes or opportunities based on the content._\n\n---\n\n‚úÖ **Top 3 Tasks for Tomorrow**  \n_If tasks were mentioned and clearly matter, list the top 3. Otherwise, leave this out._"
          },
          "promptType": "define"
        },
        "typeVersion": 2
      },
      {
        "id": "fe2552ce-48be-44bd-b975-cde379b46b51",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1020,
          360
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "qiPWoGhtEMQi7AWs",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "d2410164-fde8-46f1-8df1-6cbf3874d397",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          580,
          60
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "headers.from"
              },
              {
                "fieldToAggregate": "headers.subject"
              },
              {
                "fieldToAggregate": "text"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9c3c28f5-35d5-4164-a694-8a9bc26354d5",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -120,
          -120
        ],
        "parameters": {
          "color": 4,
          "width": 620,
          "height": 200,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "476d2f5a-c0da-4683-89a2-9cbe9d93c638",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          520,
          40
        ],
        "parameters": {
          "color": 6,
          "width": 420,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "f9301bfa-2cd7-4eaf-9798-729604a6b49a",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          980,
          140
        ],
        "parameters": {
          "width": 540,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "5cdda71c-ba41-41ba-aae1-66d39caf75c9",
        "name": "Email Cleanup",
        "type": "n8n-nodes-base.code",
        "position": [
          780,
          60
        ],
        "parameters": {
          "jsCode": "const cleanMessages = items.map(item => {\n  const from = item.json.header?.from || \"Unknown sender\";\n  const subject = item.json.header?.subject || \"No subject\";\n  const rawBody = item.json.text || \"\"; // fall back to empty string\n  const body = String(rawBody); // ensure it's a string\n\n  const cleaned = body\n    .replace(/<\\/?[^>]+(>|$)/g, \"\")             // Remove HTML\n    .replace(/(Unsubscribe|View in browser)/gi, \"\") // Strip only promo triggers\n    .replace(/\\n{3,}/g, \"\\n\\n\")                 // Collapse excess breaks\n    .trim();                                    // Clean up\n\n  return `üì© **From:** ${from}\\n**Subject:** ${subject}\\n**Preview:**\\n${cleaned}\\n\\n---\\n`;\n});\n\nreturn [{\n  json: {\n    combinedText: cleanMessages.join('\\n')\n  }\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "0807cef5-876f-433d-a94a-2db7f86d844d",
        "name": "Format HTML",
        "type": "n8n-nodes-base.code",
        "position": [
          1380,
          160
        ],
        "parameters": {
          "jsCode": "const markdown = $input.all().map((item) => item.json.output);\nlet html = markdown.map((md) =>\n  md\n    .replace(/(\\*\\*|__)(.*?)\\1/g, \"<b>$2</b>\")\n    .replace(/(\\*|_)(.*?)\\1/g, \"<i>$2</i>\")\n    .replace(/~~(.*?)~~/g, \"<del>$1</del>\")\n    .replace(/`([^`\\n]+)`/g, \"<code>$1</code>\")\n    .replace(/!\\[([^\\]]+)\\]\\(([^\\)]+)\\)/g, '<img src=\"$2\" alt=\"$1\">')\n    .replace(/\\[([^\\]]+)\\]\\(([^\\)]+)\\)/g, '<a href=\"$2\">$1</a>')\n    .replace(/(\\r\\n|\\n|\\r)/gm, \"<br>\"),\n);\n\nreturn { html };\n"
        },
        "typeVersion": 2
      },
      {
        "id": "bfc39659-9e36-4dde-9536-558d491f965c",
        "name": "Send Message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1580,
          320
        ],
        "webhookId": "39d8fc4a-0fa4-4a13-a123-2f1373787a79",
        "parameters": {
          "sendTo": "youremail@gmail.com",
          "message": "={{ $json.html[0] }}",
          "options": {},
          "subject": "Here's Your Daily Pulse"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "gUrhTlOlNSEw7OKA",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "fa9af357-4a58-4540-94d4-7228678ea75b",
    "connections": {
      "Gmail": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Format HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Email Cleanup",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format HTML": {
        "main": [
          [
            {
              "node": "Send Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Email Cleanup": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Date Transformer": {
        "main": [
          [
            {
              "node": "Gmail",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Date Transformer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "sKPt2XLNb9anT2fW",
    "meta": {
      "instanceId": "15d6057a37b8367f33882dd60593ee5f6cc0c59310ff1dc66b626d726083b48d"
    },
    "name": "Multi-Channel DHL Status Bot with n8n, Gmail, and Webhooks",
    "tags": [],
    "nodes": [
      {
        "id": "intro-note-1",
        "name": "Workflow Overview",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -112,
          80
        ],
        "parameters": {
          "width": 320,
          "height": 410,
          "content": "## Multi-Channel DHL Status Bot\n\nThis workflow automatically answers customer inquiries about DHL shipment status from two different channels: web forms and email.\n\n**Channels Handled:**\n- **Webhooks:** For 'Track My Order' forms on your website.\n- **Gmail:** For direct email inquiries.\n\n**Process Flow:**\n1. Receives a tracking number from either source.\n2. Fetches the latest status from the DHL API.\n3. Sends a formatted response back to the original channel."
        },
        "typeVersion": 1
      },
      {
        "id": "webhook-trigger",
        "name": "Webhook Form Trigger",
        "type": "n8n-nodes-base.webhook",
        "position": [
          304,
          112
        ],
        "webhookId": "dhl-tracking-webhook",
        "parameters": {
          "path": "dhl-tracking-inquiry",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "gmail-trigger",
        "name": "Gmail Email Trigger",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          304,
          304
        ],
        "parameters": {
          "simple": false,
          "filters": {
            "sender": [],
            "readStatus": "unread"
          },
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "gmailCredentials",
            "name": "Gmail OAuth2"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "setup-note-1",
        "name": "Trigger Setup",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          304,
          480
        ],
        "parameters": {
          "color": 3,
          "width": 280,
          "height": 308,
          "content": "## ‚öôÔ∏è Trigger Configuration\n\n**1. Gmail Trigger:**\n- Select the 'Gmail Email Trigger' node.\n- Connect your Gmail OAuth2 credentials.\n- **Action:** This allows the workflow to monitor an inbox for new tracking inquiries.\n\n**2. Webhook Trigger:**\n- Copy the Production URL from the 'Webhook Form Trigger' node.\n- **Action:** Paste this URL into your website's form settings (e.g., WordPress, Webflow, custom HTML form)."
        },
        "typeVersion": 1
      },
      {
        "id": "merge-triggers",
        "name": "Merge Triggers",
        "type": "n8n-nodes-base.merge",
        "position": [
          608,
          208
        ],
        "parameters": {
          "mode": "combine",
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "extract-tracking",
        "name": "Extract Tracking Number",
        "type": "n8n-nodes-base.code",
        "position": [
          800,
          208
        ],
        "parameters": {
          "jsCode": "// Extract tracking number from different sources\nconst items = $input.all();\nconst output = [];\n\nfor (const item of items) {\n  let trackingNumber = '';\n  let customerEmail = '';\n  let customerName = '';\n  \n  // Check if from webhook (form submission)\n  if (item.json.body) {\n    trackingNumber = item.json.body.trackingNumber || item.json.body.orderNumber || '';\n    customerEmail = item.json.body.email || '';\n    customerName = item.json.body.name || 'Customer';\n  }\n  \n  // Check if from email\n  if (item.json.subject || item.json.text) {\n    // Extract tracking number using regex (DHL format)\n    const text = item.json.text || item.json.snippet || '';\n    const dhlPattern = /\\b\\d{10,}\\b/g;\n    const matches = text.match(dhlPattern);\n    \n    if (matches && matches.length > 0) {\n      trackingNumber = matches[0];\n    }\n    \n    customerEmail = item.json.from?.value?.[0]?.address || item.json.from || '';\n    customerName = item.json.from?.value?.[0]?.name || 'Customer';\n  }\n  \n  if (trackingNumber) {\n    output.push({\n      json: {\n        trackingNumber: trackingNumber,\n        customerEmail: customerEmail,\n        customerName: customerName,\n        originalData: item.json\n      }\n    });\n  }\n}\n\nreturn output;"
        },
        "typeVersion": 2
      },
      {
        "id": "extraction-note",
        "name": "Extraction Logic",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          688,
          384
        ],
        "parameters": {
          "color": 5,
          "width": 250,
          "height": 236,
          "content": "## Data Normalization\n\nThis Code node unifies data from both triggers.\n\n**It extracts:**\n- Tracking Number (from form body or email text)\n- Customer Email\n- Customer Name\n\nThis ensures the rest of the workflow can process the data in a consistent format, regardless of the source."
        },
        "typeVersion": 1
      },
      {
        "id": "dhl-api-request",
        "name": "Get DHL Tracking Status",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1008,
          208
        ],
        "parameters": {
          "url": "https://api-eu.dhl.com/track/shipments",
          "options": {
            "response": {
              "response": {
                "responseFormat": "json"
              }
            }
          },
          "sendQuery": true,
          "sendHeaders": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "trackingNumber",
                "value": "={{ $json.trackingNumber }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "DHL-API-Key",
                "value": "YOUR_DHL_API_KEY"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "9clRo88n4LVt91WQ",
            "name": "ÂãïÁîªÁîüÊàêAIÔºøsora"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "api-note",
        "name": "DHL API Configuration",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1008,
          384
        ],
        "parameters": {
          "color": 4,
          "width": 280,
          "height": 240,
          "content": "## ‚öôÔ∏è DHL API Configuration\n\n**Action Required:** You must add your DHL API key to proceed.\n\n1. **Get API Key:** Register and get a key from the [DHL Developer Portal](https://developer.dhl.com/).\n2. **Add Key to Node:**\n   - Select the 'Get DHL Tracking Status' node.\n   - Go to `Headers` > `Header Parameters`.\n   - Replace `YOUR_DHL_API_KEY` with your actual key."
        },
        "typeVersion": 1
      },
      {
        "id": "format-response",
        "name": "Format Response Message",
        "type": "n8n-nodes-base.code",
        "position": [
          1200,
          208
        ],
        "parameters": {
          "jsCode": "// Format the tracking response\nconst trackingData = $input.item.json;\nconst customerData = $node[\"Extract Tracking Number\"].json;\n\nlet statusMessage = '';\nlet trackingDetails = {};\n\ntry {\n  // Parse DHL API response\n  const shipment = trackingData.shipments?.[0];\n  \n  if (shipment) {\n    const latestEvent = shipment.events?.[0];\n    const status = shipment.status;\n    \n    trackingDetails = {\n      trackingNumber: customerData.trackingNumber,\n      currentStatus: status?.status || 'In Transit',\n      statusDescription: status?.description || '',\n      lastUpdate: latestEvent?.timestamp || new Date().toISOString(),\n      location: latestEvent?.location?.address?.addressLocality || 'Unknown',\n      estimatedDelivery: shipment.estimatedTimeOfDelivery || 'Not available',\n      carrier: 'DHL Express'\n    };\n    \n    statusMessage = `\nDear ${customerData.customerName},\n\nThank you for your inquiry about tracking number: ${trackingDetails.trackingNumber}\n\nüì¶ **Current Status:** ${trackingDetails.currentStatus}\nüìç **Last Location:** ${trackingDetails.location}\nüïí **Last Update:** ${new Date(trackingDetails.lastUpdate).toLocaleString()}\nüìÖ **Estimated Delivery:** ${trackingDetails.estimatedDelivery}\n\n${trackingDetails.statusDescription}\n\nYou can track your shipment in real-time at:\nhttps://www.dhl.com/track?tracking-id=${trackingDetails.trackingNumber}\n\nIf you have any questions, please don't hesitate to contact us.\n\nBest regards,\nCustomer Service Team\n    `;\n  } else {\n    statusMessage = `\nDear ${customerData.customerName},\n\nWe couldn't find tracking information for: ${customerData.trackingNumber}\n\nPlease verify the tracking number and try again. If the issue persists, please contact our support team.\n\nBest regards,\nCustomer Service Team\n    `;\n  }\n} catch (error) {\n  statusMessage = `\nDear ${customerData.customerName},\n\nWe encountered an issue retrieving your tracking information. Our team has been notified and will look into this immediately.\n\nTracking Number: ${customerData.trackingNumber}\n\nPlease try again later or contact our support team for immediate assistance.\n\nBest regards,\nCustomer Service Team\n  `;\n}\n\nreturn {\n  json: {\n    customerEmail: customerData.customerEmail,\n    customerName: customerData.customerName,\n    subject: `Re: DHL Tracking Update - ${customerData.trackingNumber}`,\n    message: statusMessage,\n    trackingDetails: trackingDetails,\n    isWebhook: customerData.originalData?.body ? true : false\n  }\n};"
        },
        "typeVersion": 2
      },
      {
        "id": "check-source",
        "name": "Check Source",
        "type": "n8n-nodes-base.if",
        "position": [
          1408,
          208
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "condition-1",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.isWebhook }}",
                "rightValue": true
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "routing-note",
        "name": "Response Routing",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1344,
          352
        ],
        "parameters": {
          "color": 6,
          "width": 220,
          "height": 232,
          "content": "## Response Routing\n\nThis IF node intelligently routes the response based on the original inquiry source.\n\n- **If `isWebhook` is true:** The workflow sends a JSON response back to the web form.\n- **If `isWebhook` is false:** The workflow sends a formatted reply via Gmail."
        },
        "typeVersion": 1
      },
      {
        "id": "webhook-response",
        "name": "Webhook Response",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          1600,
          112
        ],
        "parameters": {
          "options": {
            "responseCode": 200,
            "responseHeaders": {
              "entries": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                }
              ]
            }
          },
          "respondWith": "json",
          "responseBody": "={{ JSON.stringify($json.trackingDetails) }}"
        },
        "typeVersion": 1.1
      },
      {
        "id": "gmail-send",
        "name": "Send Gmail Response",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1600,
          304
        ],
        "webhookId": "3c958446-e0e3-4b3d-91c0-2dad70585160",
        "parameters": {
          "sendTo": "={{ $json.customerEmail }}",
          "message": "={{ $json.message }}",
          "options": {
            "replyTo": "support@yourcompany.com"
          },
          "subject": "={{ $json.subject }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "gmailCredentials",
            "name": "Gmail OAuth2"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "email-config-note",
        "name": "Email Setup",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1600,
          464
        ],
        "parameters": {
          "color": 2,
          "height": 252,
          "content": "## ‚úâÔ∏è Email Customization\n\nCustomize the automated email reply.\n\n**Suggestions:**\n- **Set `Reply-To` in 'Send Gmail Response' node:** Add a support address like `support@yourcompany.com`.\n- **Refine Message:** Edit the email body in the \"Format Response Message\" node to add your company signature or branding."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "timezone": "America/New_York",
      "errorWorkflow": "",
      "executionOrder": "v1",
      "saveManualExecutions": true,
      "saveExecutionProgress": true,
      "saveDataErrorExecution": "all",
      "saveDataSuccessExecution": "all"
    },
    "versionId": "9066dca1-1efe-41ec-8477-457dcaadd0a8",
    "connections": {
      "Check Source": {
        "main": [
          [
            {
              "node": "Webhook Response",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send Gmail Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge Triggers": {
        "main": [
          [
            {
              "node": "Extract Tracking Number",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail Email Trigger": {
        "main": [
          [
            {
              "node": "Merge Triggers",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Webhook Form Trigger": {
        "main": [
          [
            {
              "node": "Merge Triggers",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Tracking Number": {
        "main": [
          [
            {
              "node": "Get DHL Tracking Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Response Message": {
        "main": [
          [
            {
              "node": "Check Source",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get DHL Tracking Status": {
        "main": [
          [
            {
              "node": "Format Response Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "igcrMcr9XPqqxnqk",
    "meta": {
      "instanceId": "3378b0d68c3b7ebfc71b79896d94e1a044dec38e99a1160aed4e9c323910fbe2",
      "templateCredsSetupCompleted": true
    },
    "name": "Auto-Reply to Instagram Comments with DMs",
    "tags": [],
    "nodes": [
      {
        "id": "82aaa8f5-c2fc-49b4-9d69-2b439001c7dd",
        "name": "Start Monitoring",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -1520,
          80
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "c191f69e-4483-409a-b313-2e11e0250e47",
        "name": "Configure Post & Message",
        "type": "n8n-nodes-base.set",
        "position": [
          -1300,
          220
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "postUrl",
                "name": "postUrl",
                "type": "string",
                "value": "Instagram url post/reel"
              },
              {
                "id": "replyMessage",
                "name": "replyMessage",
                "type": "string",
                "value": "Thanks so much!  This is the template: xxxxx"
              },
              {
                "id": "profileUsername",
                "name": "profileUsername",
                "type": "string",
                "value": "add_upload_post_username"
              }
            ]
          }
        },
        "typeVersion": 3.3
      },
      {
        "id": "66a72bd2-4f15-4c01-bbad-27d0ec3ce775",
        "name": "Read Contacted Users",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -1100,
          220
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SNZYngGfvIxZJ6VAiwD9Keuj6DugbijLH59vyK4L298/edit#gid=0",
            "cachedResultName": "Hoja 1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1SNZYngGfvIxZJ6VAiwD9Keuj6DugbijLH59vyK4L298",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SNZYngGfvIxZJ6VAiwD9Keuj6DugbijLH59vyK4L298/edit?usp=drivesdk",
            "cachedResultName": "respuestas a post de instagram"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "3IOU2VjBnR4hGohx",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4,
        "alwaysOutputData": true
      },
      {
        "id": "78881d28-aa34-408d-a6ed-d3578f92c394",
        "name": "Filter New Comments",
        "type": "n8n-nodes-base.code",
        "position": [
          -700,
          220
        ],
        "parameters": {
          "jsCode": "const comments = $input.first().json.comments || [];\n// CR√çTICO: Usar .all() para obtener TODAS las filas, no solo la primera\nconst allContactedUsersData = $('Read Contacted Users').all();\nconsole.log('üîç DEBUG - Raw all contacted users:', JSON.stringify(allContactedUsersData, null, 2));\nconsole.log('üîç DEBUG - Number of items from Read Contacted Users:', allContactedUsersData.length);\n\n// Extraer todos los objetos JSON de todas las ejecuciones y aplanar en un solo array\nlet contactedUsersData = [];\nallContactedUsersData.forEach((item, index) => {\n  console.log(`üîç DEBUG - Processing item ${index}:`, JSON.stringify(item.json, null, 2));\n  if (item.json) {\n    if (Array.isArray(item.json)) {\n      // Si es un array, agregar todos los elementos\n      contactedUsersData.push(...item.json);\n      console.log(`üîç DEBUG - Added ${item.json.length} items from array`);\n    } else {\n      // Si es un solo objeto, agregarlo\n      contactedUsersData.push(item.json);\n      console.log(`üîç DEBUG - Added 1 object`);\n    }\n  }\n});\n\nconsole.log('üîç DEBUG - Total extracted contacted users:', contactedUsersData.length);\n\n// DEBUGGING DETALLADO\nconsole.log('üîç DEBUG - Input comments found:', comments.length);\nconsole.log('üîç DEBUG - Raw contacted users data:', JSON.stringify(contactedUsersData, null, 2));\nconsole.log('üîç DEBUG - Contacted users data type:', typeof contactedUsersData);\nconsole.log('üîç DEBUG - Contacted users data keys:', Object.keys(contactedUsersData));\n\n// Handle different Google Sheets response formats\nlet contactedUsers = [];\n\n// IMPORTANTE: Primero verificar si es un array directo (m√∫ltiples filas)\nif (Array.isArray(contactedUsersData)) {\n  contactedUsers = contactedUsersData;\n  console.log('üîç DEBUG - Using direct array format (multiple rows)');\n} \n// M√©todo 2: Respuesta con .values (formato com√∫n)\nelse if (contactedUsersData.values && Array.isArray(contactedUsersData.values)) {\n  contactedUsers = contactedUsersData.values;\n  console.log('üîç DEBUG - Using .values format');\n} \n// M√©todo 3: Respuesta con .data\nelse if (contactedUsersData.data && Array.isArray(contactedUsersData.data)) {\n  contactedUsers = contactedUsersData.data;\n  console.log('üîç DEBUG - Using .data format');\n}\n// M√âTODO 4 CORREGIDO: Manejar objetos √∫nicos vs m√∫ltiples\nelse if (typeof contactedUsersData === 'object' && contactedUsersData !== null) {\n  // CR√çTICO: Verificar si es UN SOLO objeto con comment_id (1 fila)\n  if (contactedUsersData.comment_id || contactedUsersData.username) {\n    contactedUsers = [contactedUsersData];\n    console.log('üîç DEBUG - Converting single object to array (1 row)');\n  } \n  // Si es un objeto pero SIN comment_id directo, puede ser m√∫ltiples objetos\n  else {\n    // Convertir a array pero tambi√©n verificar si los valores son objetos\n    const values = Object.values(contactedUsersData);\n    \n    // Si los valores son objetos con comment_id, son m√∫ltiples filas\n    if (values.length > 0 && typeof values[0] === 'object' && values[0]?.comment_id) {\n      contactedUsers = values;\n      console.log('üîç DEBUG - Converting object values to array (multiple rows from object)');\n    } else {\n      contactedUsers = values;\n      console.log('üîç DEBUG - Converting object values to array (unknown format)');\n    }\n  }\n}\n\n// DEBUGGING EXTRA: Mostrar qu√© tipo de datos recibimos\nconsole.log('üîç DEBUG - Raw data analysis:');\nconsole.log('  - Is Array:', Array.isArray(contactedUsersData));\nconsole.log('  - Type:', typeof contactedUsersData);\nconsole.log('  - Has comment_id:', !!contactedUsersData?.comment_id);\nconsole.log('  - Object keys:', contactedUsersData ? Object.keys(contactedUsersData) : 'null');\n\nconsole.log('üîç DEBUG - Final contacted users array length:', contactedUsers.length);\nconsole.log('üîç DEBUG - Final contacted users array:', JSON.stringify(contactedUsers, null, 2));\n\n// Print first few rows to see the structure\nif (contactedUsers.length > 0) {\n  console.log('üîç DEBUG - First 5 rows structure:');\n  contactedUsers.slice(0, 5).forEach((row, index) => {\n    console.log(`  Row ${index}:`, JSON.stringify(row, null, 2));\n    console.log(`  Row ${index} type:`, typeof row);\n    console.log(`  Row ${index} keys:`, Object.keys(row || {}));\n  });\n}\n\n// FUNCI√ìN PARA NORMALIZAR COMMENT IDs (cr√≠tico para n√∫meros largos)\nfunction normalizeCommentId(id) {\n  if (!id || id === null || id === undefined) return null;\n  \n  // Convertir a string y limpiar espacios\n  let cleanId = String(id).trim();\n  \n  // Si es vac√≠o o es un header, retornar null\n  if (cleanId === '' || cleanId === 'comment_id') return null;\n  \n  // IMPORTANTE: Manejar n√∫meros largos como strings para evitar problemas de precisi√≥n\n  // Los comment IDs de Instagram son n√∫meros muy largos que pueden perder precisi√≥n\n  return cleanId;\n}\n\n// Create a set of already contacted comment IDs\nconst contactedCommentIds = new Set();\n\ncontactedUsers.forEach((row, index) => {\n  let commentId = null;\n  \n  console.log(`üîç DEBUG - Processing row ${index}:`, JSON.stringify(row, null, 2));\n  \n  // Skip header row if it exists\n  if (typeof row === 'object' && row !== null && !Array.isArray(row)) {\n    // Skip if this looks like a header row\n    if (row.comment_id === 'comment_id' || row.username === 'username') {\n      console.log(`‚ö†Ô∏è Skipping header row ${index}`);\n      return;\n    }\n    \n    // Handle object format (when Google Sheets returns objects)\n    commentId = row.comment_id || row.commentId || row['comment_id'] || row['commentId'];\n    console.log(`üîç DEBUG - Object format, raw comment_id: '${commentId}' (type: ${typeof commentId})`);\n  } \n  // Handle array format (when Google Sheets returns arrays)\n  else if (Array.isArray(row)) {\n    // Skip if this looks like a header row\n    if (row[0] === 'comment_id' || row[1] === 'username') {\n      console.log(`‚ö†Ô∏è Skipping header array row ${index}`);\n      return;\n    }\n    \n    // comment_id is in Column A (index 0)\n    commentId = row[0];\n    console.log(`üîç DEBUG - Array format, raw comment_id: '${commentId}' (type: ${typeof commentId})`);\n  }\n  \n  // Normalize and validate comment ID\n  const normalizedId = normalizeCommentId(commentId);\n  if (normalizedId) {\n    contactedCommentIds.add(normalizedId);\n    console.log(`‚úÖ Added contacted comment ID: '${normalizedId}' (length: ${normalizedId.length})`);\n  } else {\n    console.log(`‚ö†Ô∏è Row ${index} has no valid comment_id:`, commentId);\n  }\n});\n\nconsole.log('üîç DEBUG - Total contacted comment IDs found:', contactedCommentIds.size);\nconsole.log('üîç DEBUG - Contacted comment IDs list:', Array.from(contactedCommentIds));\n\n// Filter new comments - exclude already contacted ones\nconst newComments = comments.filter(comment => {\n  const rawCommentId = comment.id;\n  const normalizedCommentId = normalizeCommentId(rawCommentId);\n  \n  if (!normalizedCommentId) {\n    console.log(`‚ö†Ô∏è Invalid comment ID found: ${rawCommentId}`);\n    return false;\n  }\n  \n  const isAlreadyContacted = contactedCommentIds.has(normalizedCommentId);\n  \n  console.log(`üîç DEBUG - Checking comment ID: '${normalizedCommentId}' (raw: ${rawCommentId}, type: ${typeof rawCommentId}), Already contacted: ${isAlreadyContacted}`);\n  \n  // Debug: Show all contacted IDs for comparison\n  if (isAlreadyContacted) {\n    console.log(`üîç DEBUG - Comment ID '${normalizedCommentId}' found in contacted list`);\n  } else {\n    console.log(`üîç DEBUG - Comment ID '${normalizedCommentId}' NOT found in contacted list`);\n    console.log(`üîç DEBUG - All contacted IDs: [${Array.from(contactedCommentIds).join(', ')}]`);\n  }\n  \n  return !isAlreadyContacted;\n});\n\nconsole.log('üîç DEBUG - New comments after filter:', newComments.length);\n\n// Log the filtering results with emojis\nconsole.log(`üìä Total comments retrieved: ${comments.length}`);\nconsole.log(`‚úÖ Already contacted comments: ${contactedCommentIds.size}`);\nconsole.log(`üÜï New comments to process: ${newComments.length}`);\n\n// Log details of new comments\nnewComments.forEach((comment, index) => {\n  console.log(`üÜï New comment ${index + 1}: ID='${comment.id}', User='${comment.user?.username || 'unknown'}', Text='${comment.text?.substring(0, 50) || 'no text'}...'`);\n});\n\nif (newComments.length === 0) {\n  console.log('üò¥ No new comments found. Waiting for next check...');\n  console.log('üîÑ Workflow will continue monitoring in 15 minutes...');\n  \n  // Return a special object to indicate no processing needed\n  return [{\n    json: {\n      noNewComments: true,\n      summary: `üìä Monitoring complete - Found ${comments.length} total comments, ${contactedCommentIds.size} already contacted, 0 new comments to process`,\n      timestamp: new Date().toISOString(),\n      status: 'no_new_comments'\n    }\n  }];\n}\n\n// Transform each new comment into a separate item for processing\nreturn newComments.map(comment => ({\n  json: {\n    commentId: normalizeCommentId(comment.id),\n    commentText: comment.text,\n    userId: comment.user?.id || 'unknown',\n    username: comment.user?.username || 'unknown',\n    timestamp: comment.timestamp || new Date().toISOString(),\n    replyMessage: $('Configure Post & Message').first().json.replyMessage,\n    postUrl: $('Configure Post & Message').first().json.postUrl,\n    profileUsername: $('Configure Post & Message').first().json.profileUsername\n  }\n}));"
        },
        "typeVersion": 2,
        "alwaysOutputData": true
      },
      {
        "id": "13ad0cdd-7da6-4e57-98e8-28dae0916ed4",
        "name": "Check If Has New Comments",
        "type": "n8n-nodes-base.if",
        "position": [
          -540,
          220
        ],
        "parameters": {
          "options": {
            "ignoreCase": true,
            "looseTypeValidation": true
          },
          "conditions": {
            "options": {
              "version": 1,
              "leftValue": "",
              "caseSensitive": false,
              "typeValidation": "loose"
            },
            "combinator": "or",
            "conditions": [
              {
                "id": "has_new_comments",
                "operator": {
                  "type": "boolean",
                  "operation": "notEqual"
                },
                "leftValue": "={{ $json.noNewComments }}",
                "rightValue": true
              },
              {
                "id": "f38ffd12-c4b2-4971-944c-b983ff3541fa",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ !$json.noNewComments }}",
                "rightValue": "true"
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "f20e9a90-f8db-4f42-acdb-1e99295a0a0c",
        "name": "Send Reply to Comment",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -340,
          120
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/uploadposts/comments/reply",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"platform\": \"instagram\",\n  \"user\": \"{{ $json.profileUsername }}\",\n  \"comment_id\": \"{{ $json.commentId }}\",\n  \"message\": \"{{ $json.replyMessage }}\"\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "peX0mDODPePtl6Vb",
            "name": "upload-post vitor "
          }
        },
        "typeVersion": 4.1
      },
      {
        "id": "7e4c9bd5-973f-4a15-941d-239ae9581bd8",
        "name": "Check Reply Success",
        "type": "n8n-nodes-base.if",
        "position": [
          -180,
          20
        ],
        "parameters": {
          "options": {
            "ignoreCase": true,
            "looseTypeValidation": true
          },
          "conditions": {
            "options": {
              "version": 1,
              "leftValue": "",
              "caseSensitive": false,
              "typeValidation": "loose"
            },
            "combinator": "or",
            "conditions": [
              {
                "id": "success_check",
                "operator": {
                  "type": "boolean",
                  "operation": "equal"
                },
                "leftValue": "={{ $json.success }}",
                "rightValue": true
              },
              {
                "id": "15c2064a-8fbd-446e-8d36-29852df64def",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.success }}",
                "rightValue": "=true"
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "40146447-62b1-4c97-87f6-44db758b4c8d",
        "name": "Record Contacted User",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          40,
          -60
        ],
        "parameters": {
          "columns": {
            "value": {
              "post_url": "={{ $('Filter New Comments').item.json.postUrl }}",
              "username": "={{ $('Filter New Comments').item.json.username }}",
              "timestamp": "={{ $('Filter New Comments').item.json.timestamp }}",
              "comment_id": "={{ $('Filter New Comments').item.json.commentId }}",
              "message_sent": "={{ $('Filter New Comments').item.json.replyMessage }}"
            },
            "schema": [
              {
                "id": "comment_id",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "comment_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "username",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "message_sent",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "message_sent",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "timestamp",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "timestamp",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "post_url",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "post_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SNZYngGfvIxZJ6VAiwD9Keuj6DugbijLH59vyK4L298/edit#gid=0",
            "cachedResultName": "Hoja 1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1SNZYngGfvIxZJ6VAiwD9Keuj6DugbijLH59vyK4L298",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SNZYngGfvIxZJ6VAiwD9Keuj6DugbijLH59vyK4L298/edit?usp=drivesdk",
            "cachedResultName": "respuestas a post de instagram"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "3IOU2VjBnR4hGohx",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4
      },
      {
        "id": "730bb698-62e4-4944-83c3-982864140daf",
        "name": "Log Failed Reply",
        "type": "n8n-nodes-base.code",
        "position": [
          40,
          100
        ],
        "parameters": {
          "jsCode": "// Log failed replies for debugging\nconst failedReply = {\n  userId: $('Filter New Comments').item.json.userId,\n  username: $('Filter New Comments').item.json.username,\n  commentId: $('Filter New Comments').item.json.commentId,\n  error: $json.error || 'Unknown error',\n  timestamp: new Date().toISOString()\n};\n\nconsole.log('‚ùå Failed to send reply:', failedReply);\n\nreturn [{ json: failedReply }];"
        },
        "typeVersion": 2
      },
      {
        "id": "c87fe62f-9024-4827-8c56-65075e00fb23",
        "name": "Generate Summary",
        "type": "n8n-nodes-base.code",
        "position": [
          260,
          240
        ],
        "parameters": {
          "jsCode": "// Summary of the monitoring session with proper error handling\nlet totalComments = 0;\nlet newComments = 0;\nlet successfulReplies = 0;\nlet failedReplies = 0;\nlet monitoredPostUrl = '';\n\ntry {\n  // Get total comments (handle if node wasn't executed)\n  const getPostCommentsData = $('Get Post Comments').first();\n  totalComments = getPostCommentsData?.json?.comments?.length || 0;\n} catch (error) {\n  console.log('‚ö†Ô∏è Could not get total comments data:', error.message);\n  totalComments = 0;\n}\n\ntry {\n  // Get new comments (handle if node wasn't executed)\n  const filterNewCommentsData = $('Filter New Comments').all();\n  newComments = filterNewCommentsData?.length || 0;\n} catch (error) {\n  console.log('‚ö†Ô∏è Could not get new comments data:', error.message);\n  newComments = 0;\n}\n\ntry {\n  // Get successful replies (handle if node wasn't executed)\n  const recordContactedData = $('Record Contacted User').all();\n  successfulReplies = recordContactedData?.length || 0;\n} catch (error) {\n  console.log('‚ö†Ô∏è Could not get successful replies data:', error.message);\n  successfulReplies = 0;\n}\n\ntry {\n  // Get failed replies (handle if node wasn't executed)\n  const logFailedData = $('Log Failed Reply').all();\n  failedReplies = logFailedData?.length || 0;\n} catch (error) {\n  console.log('‚ö†Ô∏è Could not get failed replies data:', error.message);\n  failedReplies = 0;\n}\n\ntry {\n  // Get monitored post URL\n  const configData = $('Configure Post & Message').first();\n  monitoredPostUrl = configData?.json?.postUrl || 'Unknown URL';\n} catch (error) {\n  console.log('‚ö†Ô∏è Could not get post URL:', error.message);\n  monitoredPostUrl = 'Unknown URL';\n}\n\nconst summary = {\n  totalComments,\n  newComments,\n  successfulReplies,\n  failedReplies,\n  monitoredPostUrl,\n  timestamp: new Date().toISOString(),\n  status: 'completed'\n};\n\nconsole.log('üìà Monitoring Summary:', JSON.stringify(summary, null, 2));\n\n// Generate appropriate emoji and message\nconst emoji = successfulReplies > 0 ? 'üéâ' : failedReplies > 0 ? '‚ö†Ô∏è' : totalComments > 0 ? 'üëÄ' : 'üò¥';\nlet message = `${emoji} Monitoring cycle complete!`;\n\nif (totalComments > 0) {\n  message += ` Found ${totalComments} total comments`;\n  \n  if (newComments > 0) {\n    message += `, ${newComments} new comments`;\n    \n    if (successfulReplies > 0) {\n      message += `, sent ${successfulReplies} replies successfully`;\n    }\n    \n    if (failedReplies > 0) {\n      message += `, ${failedReplies} failed`;\n    }\n  } else {\n    message += ', no new comments to process';\n  }\n} else {\n  message += ' No comments found or error retrieving comments';\n}\n\nconsole.log(message);\nconsole.log('‚è∞ Next check in 15 minutes...');\nconsole.log('üîÑ Workflow will continue monitoring...');\n\nreturn [{\n  json: {\n    summary,\n    message,\n    continueMonitoring: true\n  }\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "1ae9c8df-41b4-42e5-9df9-691fb9b6f2ad",
        "name": "Get Post Comments",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -920,
          220
        ],
        "parameters": {
          "url": "=https://api.upload-post.com/api/uploadposts/comments",
          "options": {
            "response": {
              "response": {
                "responseFormat": "json"
              }
            }
          },
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "platform",
                "value": "instagram"
              },
              {
                "name": "user",
                "value": "={{ $('Configure Post & Message').item.json.profileUsername }}"
              },
              {
                "name": "post_url",
                "value": "={{ $('Configure Post & Message').item.json.postUrl }}"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "peX0mDODPePtl6Vb",
            "name": "upload-post vitor "
          }
        },
        "typeVersion": 4.1
      },
      {
        "id": "08822705-3afd-4ea4-8d9e-8874d989507c",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -1520,
          340
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "minutes",
                "minutesInterval": 15
              }
            ]
          }
        },
        "typeVersion": 1.2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "d68f95d6-0596-4d0e-8aa7-498bab2097bc",
    "connections": {
      "Log Failed Reply": {
        "main": [
          [
            {
              "node": "Generate Summary",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Configure Post & Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Start Monitoring": {
        "main": [
          [
            {
              "node": "Configure Post & Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Post Comments": {
        "main": [
          [
            {
              "node": "Filter New Comments",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Reply Success": {
        "main": [
          [
            {
              "node": "Record Contacted User",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Log Failed Reply",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter New Comments": {
        "main": [
          [
            {
              "node": "Check If Has New Comments",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Contacted Users": {
        "main": [
          [
            {
              "node": "Get Post Comments",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Record Contacted User": {
        "main": [
          [
            {
              "node": "Generate Summary",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Reply to Comment": {
        "main": [
          [
            {
              "node": "Check Reply Success",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Configure Post & Message": {
        "main": [
          [
            {
              "node": "Read Contacted Users",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check If Has New Comments": {
        "main": [
          [
            {
              "node": "Send Reply to Comment",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Generate Summary",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "5mGRqFpu73QguZPC",
    "meta": {
      "instanceId": "06b3271522ae4bedcb94de9dac3219d19e1a4e5fcd0a448a4abc68198b391077",
      "templateCredsSetupCompleted": true
    },
    "name": "ocr Telegram - SAP",
    "tags": [],
    "nodes": [
      {
        "id": "026397ff-3b84-49f4-adf1-d4e8bef01e38",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          1620,
          100
        ],
        "webhookId": "76b9bf12-3264-40e5-94dc-676f3954f41c",
        "parameters": {
          "amount": 3
        },
        "typeVersion": 1.1
      },
      {
        "id": "7c032e9c-edc3-4b23-89d5-66e092b37857",
        "name": "Basic LLM Chain",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          1840,
          -100
        ],
        "parameters": {
          "text": "={{ $json.markdown }}",
          "batching": {},
          "messages": {
            "messageValues": [
              {
                "message": "Eres un asistente experto en extracci√≥n y procesamiento de datos de documentos especializado en identificar con precisi√≥n los detalles claves de una factura"
              },
              {
                "type": "HumanMessagePromptTemplate",
                "message": "=Tu tarea: Extraer de cualquier texto de factura los siguientes campos, devolviendo los datos en un JSON estructurado y con m√°xima precisi√≥n:\n\nCampos a extraer:\nnombre_proveedor: Nombre del proveedor.\n\nruc_proveedor: RUC del proveedor.\n\ndireccion_proveedor: Direcci√≥n del proveedor.\n\nnumero_factura: N√∫mero de factura.\n\nfecha_emision: Fecha de emisi√≥n de la factura (formato YYYY-MM-DD).\n\ndetalle_productos: Lista de l√≠neas de detalle de los productos o servicios facturados. Cada l√≠nea incluir√°:\n\ncodigo\n\ndescripcion\n\ncantidad\n\nprecio\n\nsubtotal\n\nsubtotal_factura: Subtotal general de la factura.\n\ndescuento_factura: Descuento total de la factura.\n\ntotal_neto: Total neto de la factura.\n\nFormato de salida esperado:\nSi alg√∫n campo no existe, deber√° devolverse como null.\nDevuelve siempre el JSON con los nombres exactos de las claves.\n\nEjemplo de salida esperado:\n\n{\n  \"nombre_proveedor\": \"Blockies Corporation\",\n  \"ruc_proveedor\": \"78787878-7\",\n  \"direccion_proveedor\": \"AV. DE LAS ARTES NORTE NRO. 310 (ESPALDA RAMBLA DE JAVIER PRADO) LIMA - LIMA - SAN BORJA\",\n  \"numero_factura\": \"00003\",\n  \"fecha_emision\": \"2025-04-15\",\n  \"detalle_productos\": [\n    {\n      \"codigo\": \"srv001\",\n      \"descripcion\": \"Servicio de Alquiler de Montacargas\",\n      \"cantidad\": 1,\n      \"precio\": 35.00,\n      \"subtotal\": 35.00\n    }\n  ],\n  \"subtotal_factura\": 35.00,\n  \"descuento_factura\": 0.00,\n  \"total_neto\": 35.00\n}\nInstrucciones adicionales:\nNo resumas, no expliques, no a√±adas comentarios, solo responde con el JSON.\n\nSi existen varias l√≠neas de productos, incluir todas dentro del array \"detalle_productos\".\n\nNo redondees importes, extrae exactamente el valor mostrado.\n\nLas fechas deben estar siempre en formato YYYY-MM-DD."
              }
            ]
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "036c0443-0224-4a2f-9a9a-c7d9feebbdc3",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1840,
          80
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "0af0d3fb-6b87-44b4-8fe8-3c992c74a10d",
        "name": "No Operation, do nothing",
        "type": "n8n-nodes-base.noOp",
        "position": [
          760,
          820
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "a9201f0b-e504-45c2-ade0-86004ba5e323",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          2280,
          -100
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "output.detalle_productos"
        },
        "typeVersion": 1
      },
      {
        "id": "8a189ae2-64d4-459b-a8fd-81b4423cf135",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          2240,
          540
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3.2
      },
      {
        "id": "b13a0de4-a00e-4b38-8b12-fa9c2b1825d9",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -140,
          460
        ],
        "parameters": {
          "width": 3720,
          "height": 560,
          "content": "## Waiting for an answer on telegram"
        },
        "typeVersion": 1
      },
      {
        "id": "4aa3c30a-4a2c-4168-866d-4e1b8a3651f5",
        "name": "Callback Waiting Answer",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -40,
          640
        ],
        "webhookId": "56b0ca20-2362-4658-b2b8-692b0303ae0c",
        "parameters": {
          "updates": [
            "callback_query"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "d7ed9EHZ1GiHews4",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "8b49790e-fc03-4a1b-944c-139e383a0a46",
        "name": "Answer?",
        "type": "n8n-nodes-base.switch",
        "position": [
          300,
          640
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "SI",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "c3ae2bff-a96d-4f42-b0b3-e04f8ef372d1",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.callback_query.data }}",
                      "rightValue": "respuesta_si"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "NO",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "59ccf0b4-bb12-4c10-b289-354be138f96c",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.callback_query.data }}",
                      "rightValue": "respuesta_no"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "a958d830-0608-4d9b-a14d-922869c9fbd3",
        "name": "Connect to SAP",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          760,
          520
        ],
        "parameters": {
          "url": "={{ $vars.url_sap }}Login",
          "method": "POST",
          "options": {
            "allowUnauthorizedCerts": true
          },
          "jsonBody": "={\n       \"UserName\": \"{{ $vars.user_sap }}\",\n       \"Password\": \"{{ $vars.password_sap }}\",\n       \"CompanyDB\": \"{{ $vars.company_db }}\"\n}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.2,
        "alwaysOutputData": false
      },
      {
        "id": "ec4c8074-6aa8-4f89-812c-3d6305a10d60",
        "name": "Get Header",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1160,
          520
        ],
        "parameters": {
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "",
            "cachedResultUrl": "",
            "cachedResultName": ""
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "dWCmToHbrXSRjlDB",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "5e290a19-236a-4baa-9093-1b32f486b058",
        "name": "Get Row Details",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1560,
          680
        ],
        "parameters": {
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "",
            "cachedResultUrl": "",
            "cachedResultName": ""
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "dWCmToHbrXSRjlDB",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6,
        "alwaysOutputData": false
      },
      {
        "id": "42edf631-ee30-4b6f-b10b-fa53ee148c26",
        "name": "Generate DocumentLines",
        "type": "n8n-nodes-base.code",
        "position": [
          1880,
          680
        ],
        "parameters": {
          "jsCode": "const items = $input.all();  // capturamos todos los items que entran\nconst DocumentLines = [];\n\nfor (let i = 0; i < items.length; i++) {\n  const item = items[i].json;\n\n  DocumentLines.push({\n    ItemCode: item.c√≥digo,\n    Quantity: item.cantidad,\n    UnitPrice: item.precio\n  });\n}\n\nreturn [{ DocumentLines }];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "d9d54a86-50e7-469a-88a2-c5860459bf99",
        "name": "Create JSON",
        "type": "n8n-nodes-base.code",
        "position": [
          2580,
          540
        ],
        "parameters": {
          "jsCode": "const item = $json;\n\n// Construimos el objeto final para SAP\nreturn [{\n  DocDate: item.fecha_emision,\n  DocDueDate: item.fecha_emision,\n  CardCode: item.ruc_proveedor,\n  DocumentLines: item.DocumentLines\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "dfbd5b4b-a545-4062-bfdb-1d383c8277f6",
        "name": "POST PurchaseInvoices",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2980,
          540
        ],
        "parameters": {
          "url": "={{ $vars.url_sap }}PurchaseInvoices",
          "body": "={{ JSON.stringify($json) }}",
          "method": "POST",
          "options": {
            "allowUnauthorizedCerts": true
          },
          "sendBody": true,
          "contentType": "raw",
          "sendHeaders": true,
          "rawContentType": "application/json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Cookie",
                "value": "=B1SESSION={{ $('Connect to SAP').item.json.SessionId }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "ec33a3bf-2632-4f49-b0c8-4fe1284c90df",
        "name": "PurchaseInvoices created",
        "type": "n8n-nodes-base.telegram",
        "position": [
          3360,
          540
        ],
        "webhookId": "a3f4bedb-06da-446e-8a1a-a2666b511152",
        "parameters": {
          "text": "=PurchaseInvoice {{ $json.DocEntry }} creada en SAP correctamente",
          "chatId": "={{ $('Callback Waiting Answer').item.json.callback_query.message.chat.id }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "d7ed9EHZ1GiHews4",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "311d3616-3ebf-439f-8d6f-f5aa18e89bc6",
        "name": "Trigger Receive Message",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          0,
          0
        ],
        "webhookId": "5af23994-f45e-4b53-8bc0-edfee56e962c",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "c01eb2e3-7aa8-4a4c-897f-4414816fa459",
        "name": "Capture Telegram Data",
        "type": "n8n-nodes-base.set",
        "position": [
          260,
          0
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b6e43e6c-452f-4747-b17c-2de6191fb0f0",
                "name": "message.chat.id",
                "type": "number",
                "value": "={{ $json.message.chat.id }}"
              },
              {
                "id": "a82f3829-5ce1-4a94-b7e0-a1449f7a3da6",
                "name": "message.chat",
                "type": "object",
                "value": "={{ $json.message.chat }}"
              },
              {
                "id": "619ffe10-2bea-4bda-a356-501562628bc5",
                "name": "telegram.file_id",
                "type": "string",
                "value": "={{ $json.message.document.file_id }}"
              },
              {
                "id": "afbbdb8a-47e8-4b33-8f81-91989d1121af",
                "name": "message.caption",
                "type": "string",
                "value": "={{ $('Trigger Receive Message').item.json.message.caption }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "bacef005-e65c-4894-aa0b-8ef34033daac",
        "name": "File Received",
        "type": "n8n-nodes-base.telegram",
        "position": [
          500,
          0
        ],
        "webhookId": "39a7a3e0-95ba-400f-9c3b-58bfc70b5fb3",
        "parameters": {
          "text": "Hemos recibido tu documento y lo estamos procesando...",
          "chatId": "={{ $json.message.chat.id }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "d7ed9EHZ1GiHews4",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "01bae880-e0d1-449f-b459-94b7a56b3adb",
        "name": "Download File",
        "type": "n8n-nodes-base.telegram",
        "position": [
          720,
          0
        ],
        "webhookId": "1393ba90-f818-4d06-88b9-806d1542abea",
        "parameters": {
          "fileId": "={{ $('Capture Telegram Data').item.json.telegram.file_id }}",
          "resource": "file"
        },
        "credentials": {
          "telegramApi": {
            "id": "d7ed9EHZ1GiHews4",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "86e1b80a-302d-4010-a740-ce916f8f74df",
        "name": "Upload File LlamaIndex",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          940,
          0
        ],
        "parameters": {
          "url": "https://api.cloud.llamaindex.ai/api/v1/parsing/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "file",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "=Bearer {{ $vars.llamaindex_apikey }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "92f93bbd-3192-40aa-b81f-bf5165e3dc35",
        "name": "Validate Status LlamaIndex",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1180,
          0
        ],
        "parameters": {
          "url": "=https://api.cloud.llamaindex.ai/api/v1/parsing/job/{{ $json.id }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "=Bearer {{ $vars.llamaindex_apikey }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "4914e5d3-ec4e-4c96-b6c1-6f2ede2b5b38",
        "name": "Status?",
        "type": "n8n-nodes-base.switch",
        "position": [
          1400,
          0
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "SUCCESS",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "7005abbb-4094-4dde-9cc5-b973fe54a09e",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.status }}",
                      "rightValue": "SUCCESS"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "PENDING",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "b4bdda84-6e9d-44c9-a85c-fd87d7427765",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.status }}",
                      "rightValue": "PENDING"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "d2c19099-01c7-4547-aa3e-944c16009aaf",
        "name": "Get Results LlamaIndex",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1620,
          -100
        ],
        "parameters": {
          "url": "=https://api.cloud.llamaindex.ai/api/v1/parsing/job/{{ $json.id }}/result/markdown",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "=Bearer {{ $vars.llamaindex_apikey }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "c0ba5071-56b6-45c0-b0ad-bb87b8c543ca",
        "name": "Structured Output Parser (Example)",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2060,
          60
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"nombre_proveedor\": \"Blockies Corporation\",\n  \"ruc_proveedor\": \"78787878-7\",\n  \"direccion_proveedor\": \"AV. DE LAS ARTES NORTE NRO. 310 (ESPALDA RAMBLA DE JAVIER PRADO) LIMA - LIMA - SAN BORJA\",\n  \"numero_factura\": \"00003\",\n  \"fecha_emision\": \"2025-04-15\",\n  \"detalle_productos\": [\n    {\n      \"codigo\": \"srv001\",\n      \"descripcion\": \"Servicio de Alquiler de Montacargas\",\n      \"cantidad\": 1,\n      \"precio\": 35.00,\n      \"subtotal\": 35.00\n    }\n  ],\n  \"subtotal_factura\": 35.00,\n  \"descuento_factura\": 0.00,\n  \"total_neto\": 35.00\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "f62a9650-a966-4efa-a9ec-ee166e4e3881",
        "name": "Detail",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2480,
          80
        ],
        "parameters": {
          "columns": {
            "value": {
              "precio": "={{ $('Split Out').item.json.precio }}",
              "c√≥digo": "={{ $('Split Out').item.json.codigo }}",
              "cantidad": "={{ $('Split Out').item.json.cantidad }}",
              "subtotal": "={{ $('Split Out').item.json.subtotal }}",
              "descripcion": "={{ $('Split Out').item.json.descripcion }}",
              "numero_factura": "={{ $('Basic LLM Chain').item.json.output.numero_factura }}"
            },
            "schema": [
              {
                "id": "numero_factura",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "numero_factura",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "c√≥digo",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "c√≥digo",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "descripcion",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "descripcion",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "cantidad",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "cantidad",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "precio",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "precio",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "subtotal",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "subtotal",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "ec718e9d-d729-4493-8439-78cf63394e28",
        "name": "Header",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2620,
          -100
        ],
        "parameters": {
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "dWCmToHbrXSRjlDB",
            "name": "Google Sheets account"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.6
      },
      {
        "id": "d30ac579-8f31-471f-89d6-e27b6b99a4f3",
        "name": "¬øUpload to SAP?",
        "type": "n8n-nodes-base.telegram",
        "position": [
          2900,
          -100
        ],
        "webhookId": "f327fe60-a943-4b8b-8413-8caf56d4657d",
        "parameters": {
          "text": "=¬øQuieres enviar los datos a SAP?",
          "chatId": "={{ $('Capture Telegram Data').item.json.message.chat.id }}",
          "replyMarkup": "inlineKeyboard",
          "inlineKeyboard": {
            "rows": [
              {
                "row": {
                  "buttons": [
                    {
                      "text": "Si",
                      "additionalFields": {
                        "callback_data": "respuesta_si"
                      }
                    },
                    {
                      "text": "No",
                      "additionalFields": {
                        "callback_data": "respuesta_no"
                      }
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "d7ed9EHZ1GiHews4",
            "name": "Telegram account"
          }
        },
        "executeOnce": true,
        "typeVersion": 1.2
      },
      {
        "id": "e80fa814-502a-4af1-8c3f-8b35c65ed0eb",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -120,
          -180
        ],
        "parameters": {
          "color": 7,
          "width": 3280,
          "height": 540,
          "content": "## Send data and OCR with LlamaIndex\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "c7b1fdbb-20e4-48aa-b67a-7da7ceee2fa7",
    "connections": {
      "Wait": {
        "main": [
          [
            {
              "node": "Validate Status LlamaIndex",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "Create JSON",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Detail": {
        "main": [
          [
            {
              "node": "Header",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Header": {
        "main": [
          [
            {
              "node": "¬øUpload to SAP?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Answer?": {
        "main": [
          [
            {
              "node": "Connect to SAP",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "No Operation, do nothing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Status?": {
        "main": [
          [
            {
              "node": "Get Results LlamaIndex",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Detail",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Header": {
        "main": [
          [
            {
              "node": "Get Row Details",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create JSON": {
        "main": [
          [
            {
              "node": "POST PurchaseInvoices",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download File": {
        "main": [
          [
            {
              "node": "Upload File LlamaIndex",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "File Received": {
        "main": [
          [
            {
              "node": "Download File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Connect to SAP": {
        "main": [
          [
            {
              "node": "Get Header",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Basic LLM Chain": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Row Details": {
        "main": [
          [
            {
              "node": "Generate DocumentLines",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "¬øUpload to SAP?": {
        "main": [
          []
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Basic LLM Chain",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Capture Telegram Data": {
        "main": [
          [
            {
              "node": "File Received",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "POST PurchaseInvoices": {
        "main": [
          [
            {
              "node": "PurchaseInvoices created",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate DocumentLines": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Get Results LlamaIndex": {
        "main": [
          [
            {
              "node": "Basic LLM Chain",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload File LlamaIndex": {
        "main": [
          [
            {
              "node": "Validate Status LlamaIndex",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Callback Waiting Answer": {
        "main": [
          [
            {
              "node": "Answer?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger Receive Message": {
        "main": [
          [
            {
              "node": "Capture Telegram Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Validate Status LlamaIndex": {
        "main": [
          [
            {
              "node": "Status?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser (Example)": {
        "ai_outputParser": [
          [
            {
              "node": "Basic LLM Chain",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "name": "Apply to Jobs from Excel and Track Application Status",
    "tags": [
      {
        "id": "job-automation",
        "name": "Job Automation",
        "createdAt": "2025-01-15T00:00:00.000Z",
        "updatedAt": "2025-01-15T00:00:00.000Z"
      }
    ],
    "nodes": [
      {
        "id": "template-overview",
        "name": "üìã Template Overview",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          160
        ],
        "parameters": {
          "color": 4,
          "width": 389,
          "height": 464,
          "content": "## üéØ Job Application Automation System\n\n**What it does:**\n- Reads job listings from Google Sheets\n- Automatically applies to jobs with personalized cover letters\n- Tracks application status every 2 days\n- Sends email notifications for updates\n- Maintains complete application history\n\n**Who's it for:**\n- Job seekers wanting to automate repetitive applications\n- Recruiters managing bulk applications\n- Career coaches tracking client progress\n\n**Requirements:**\n- Google Sheets with job data\n- Gmail account for notifications\n- Resume stored online (Google Drive recommended)\n- Job platform API access (LinkedIn, Indeed)\n\n**Setup Instructions:**\n1. Create Google Sheet with required columns\n2. Configure your spreadsheet ID in 'Configuration' node\n3. Set up Google Sheets and Gmail credentials\n4. Update email addresses in notification nodes\n5. Test with 1-2 jobs before full automation\n\n**‚ö†Ô∏è Important:** Replace mock HTTP requests with actual job platform APIs. Current implementation is for demonstration purposes."
        },
        "typeVersion": 1
      },
      {
        "id": "sheet-structure",
        "name": "üìä Sheet Structure",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          820,
          160
        ],
        "parameters": {
          "color": 7,
          "width": 295,
          "height": 284,
          "content": "## üìä Excel Sheet Structure\n\nRequired columns:\n- Job_ID: Unique identifier\n- Company: Company name\n- Position: Job title\n- Status: Not Applied, Applied, etc.\n- Applied_Date: Application date\n- Last_Checked: Last status check\n- Application_ID: Platform reference\n- Notes: Additional info\n- Job_URL: Direct job link\n- Priority: High, Medium, Low"
        },
        "typeVersion": 1
      },
      {
        "id": "setup-notes",
        "name": "‚öôÔ∏è Setup Notes",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1180,
          160
        ],
        "parameters": {
          "color": 6,
          "width": 295,
          "height": 224,
          "content": "## üîß Configuration Setup\n\n1. Replace 'YOUR_GOOGLE_SHEET_ID' with actual ID\n2. Add your resume URL (Google Drive link)\n3. Customize cover letter template\n4. Update email addresses\n\n**Security Note:** Never hardcode API keys!\nUse n8n's credential store for all auth."
        },
        "typeVersion": 1
      },
      {
        "id": "daily-trigger",
        "name": "üïò Daily Application Trigger",
        "type": "n8n-nodes-base.cron",
        "position": [
          240,
          480
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "cronExpression",
                "expression": "0 9 * * 1-5"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "configuration",
        "name": "‚öôÔ∏è Configuration",
        "type": "n8n-nodes-base.set",
        "position": [
          460,
          480
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "spreadsheet-id",
                "name": "spreadsheetId",
                "type": "string",
                "value": "REPLACE_WITH_YOUR_GOOGLE_SHEET_ID"
              },
              {
                "id": "resume-url",
                "name": "resumeUrl",
                "type": "string",
                "value": "https://drive.google.com/file/d/YOUR_RESUME_ID/view"
              },
              {
                "id": "cover-letter",
                "name": "coverLetterTemplate",
                "type": "string",
                "value": "Dear Hiring Manager,\n\nI am excited to apply for the {{position}} role at {{company}}. With my experience in software development and {{skills}}, I believe I would be a valuable addition to your team.\n\nI am particularly drawn to {{company}} because of your innovation in the tech industry. I would love to contribute to your continued success.\n\nBest regards,\nYour Name"
              },
              {
                "id": "user-email",
                "name": "userEmail",
                "type": "string",
                "value": "your-email@example.com"
              }
            ]
          }
        },
        "typeVersion": 3
      },
      {
        "id": "read-jobs",
        "name": "üìñ Read Jobs Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          680,
          480
        ],
        "parameters": {
          "range": "A:J",
          "keyRow": 1,
          "dataMode": "autoMapInputData",
          "sheetName": "Jobs",
          "documentId": "={{ $json.spreadsheetId }}",
          "requestMethod": "GET",
          "authentication": "oAuth2"
        },
        "typeVersion": 4
      },
      {
        "id": "filter-pending",
        "name": "üéØ Filter Pending Applications",
        "type": "n8n-nodes-base.filter",
        "position": [
          900,
          480
        ],
        "parameters": {
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "not-applied",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.Status }}",
                "rightValue": "Not Applied"
              },
              {
                "id": "has-url",
                "operator": {
                  "type": "string",
                  "operation": "isNotEmpty"
                },
                "leftValue": "={{ $json.Job_URL }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "split-jobs",
        "name": "üîÑ Process Jobs One by One",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          1120,
          480
        ],
        "parameters": {
          "options": {
            "reset": false
          },
          "batchSize": 1
        },
        "typeVersion": 3
      },
      {
        "id": "prepare-data",
        "name": "üìù Prepare Application Data",
        "type": "n8n-nodes-base.set",
        "position": [
          1340,
          480
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "job-platform",
                "name": "platform",
                "type": "string",
                "value": "={{ $json.Job_URL.includes('linkedin.com') ? 'linkedin' : $json.Job_URL.includes('indeed.com') ? 'indeed' : 'generic' }}"
              },
              {
                "id": "personalized-cover",
                "name": "personalizedCoverLetter",
                "type": "string",
                "value": "={{ $('Configuration').first().json.coverLetterTemplate.replace('{{position}}', $json.Position).replace('{{company}}', $json.Company).replace('{{skills}}', 'relevant technical skills') }}"
              },
              {
                "id": "application-date",
                "name": "applicationDate",
                "type": "string",
                "value": "={{ $now.format('yyyy-MM-dd') }}"
              },
              {
                "id": "resume-url",
                "name": "resumeUrl",
                "type": "string",
                "value": "={{ $('Configuration').first().json.resumeUrl }}"
              }
            ]
          }
        },
        "typeVersion": 3
      },
      {
        "id": "platform-router",
        "name": "üîÄ Route by Platform",
        "type": "n8n-nodes-base.switch",
        "position": [
          1560,
          480
        ],
        "parameters": {
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "linkedin-check",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.platform }}",
                "rightValue": "linkedin"
              }
            ]
          }
        },
        "typeVersion": 3
      },
      {
        "id": "linkedin-apply",
        "name": "üíº Apply via LinkedIn",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1780,
          380
        ],
        "parameters": {
          "url": "https://api.linkedin.com/v2/jobs/applications",
          "options": {
            "retry": {
              "enabled": true,
              "maxTries": 3
            },
            "timeout": 30000
          },
          "sendBody": true,
          "sendHeaders": true,
          "requestMethod": "POST",
          "authentication": "predefinedCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.Job_ID }}"
              },
              {
                "name": "coverLetter",
                "value": "={{ $json.personalizedCoverLetter }}"
              },
              {
                "name": "resumeUrl",
                "value": "={{ $json.resumeUrl }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "nodeCredentialType": "linkedInOAuth2Api"
        },
        "typeVersion": 4
      },
      {
        "id": "indeed-apply",
        "name": "üîç Apply via Indeed",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1780,
          580
        ],
        "parameters": {
          "url": "https://api.indeed.com/ads/applications",
          "options": {
            "retry": {
              "enabled": true,
              "maxTries": 3
            },
            "timeout": 30000
          },
          "sendBody": true,
          "sendHeaders": true,
          "requestMethod": "POST",
          "authentication": "predefinedCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobkey",
                "value": "={{ $json.Job_ID }}"
              },
              {
                "name": "message",
                "value": "={{ $json.personalizedCoverLetter }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "nodeCredentialType": "indeedApi"
        },
        "typeVersion": 4
      },
      {
        "id": "process-result",
        "name": "üìä Process Application Result",
        "type": "n8n-nodes-base.set",
        "position": [
          2000,
          480
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "application-status",
                "name": "applicationStatus",
                "type": "string",
                "value": "={{ $json.statusCode >= 200 && $json.statusCode < 300 ? 'Applied' : 'Failed' }}"
              },
              {
                "id": "app-id",
                "name": "applicationId",
                "type": "string",
                "value": "={{ $json.body?.applicationId || $json.body?.id || 'AUTO_' + $now.format('yyyyMMddHHmmss') }}"
              },
              {
                "id": "status-notes",
                "name": "statusNotes",
                "type": "string",
                "value": "={{ $json.statusCode >= 200 && $json.statusCode < 300 ? 'Application submitted successfully via ' + $('Prepare Application Data').first().json.platform : 'Application failed: ' + $json.statusCode }}"
              },
              {
                "id": "job-data",
                "name": "originalJobData",
                "type": "object",
                "value": "={{ $('Prepare Application Data').first().json }}"
              }
            ]
          }
        },
        "typeVersion": 3
      },
      {
        "id": "update-status",
        "name": "üìù Update Job Status",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2220,
          480
        ],
        "parameters": {
          "range": "D{{ $json.originalJobData.row_index }}:H{{ $json.originalJobData.row_index }}",
          "keyRow": 1,
          "values": {
            "values": [
              [
                "={{ $json.applicationStatus }}",
                "={{ $json.originalJobData.applicationDate }}",
                "={{ $json.originalJobData.applicationDate }}",
                "={{ $json.applicationId }}",
                "={{ $json.statusNotes }}"
              ]
            ]
          },
          "dataMode": "autoMapInputData",
          "sheetName": "Jobs",
          "documentId": "={{ $('Configuration').first().json.spreadsheetId }}",
          "requestMethod": "UPDATE",
          "authentication": "oAuth2",
          "valueInputMode": "raw"
        },
        "typeVersion": 4
      },
      {
        "id": "send-notification",
        "name": "üìß Send Application Notification",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2440,
          480
        ],
        "parameters": {
          "email": "={{ $('Configuration').first().json.userEmail }}",
          "message": "<h3>Application Status Update</h3>\n<p><strong>Company:</strong> {{ $json.originalJobData.Company }}</p>\n<p><strong>Position:</strong> {{ $json.originalJobData.Position }}</p>\n<p><strong>Status:</strong> {{ $json.applicationStatus }}</p>\n<p><strong>Date:</strong> {{ $json.originalJobData.applicationDate }}</p>\n<p><strong>Platform:</strong> {{ $json.originalJobData.platform }}</p>\n<p><strong>Notes:</strong> {{ $json.statusNotes }}</p>\n<p><strong>Application ID:</strong> {{ $json.applicationId }}</p>",
          "subject": "Job Application: {{ $json.originalJobData.Company }} - {{ $json.originalJobData.Position }}",
          "operation": "sendEmail",
          "emailFormat": "html"
        },
        "typeVersion": 2
      },
      {
        "id": "status-tracking-info",
        "name": "üìä Status Tracking Info",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          740
        ],
        "parameters": {
          "color": 7,
          "width": 329,
          "height": 204,
          "content": "## üìà Status Tracking Workflow\n\nThis section runs every 2 days to:\n- Check status of applied jobs\n- Update the spreadsheet\n- Send notifications for changes\n\n**Note:** Replace mock status checks with actual API calls to job platforms for real status updates."
        },
        "typeVersion": 1
      },
      {
        "id": "status-trigger",
        "name": "üïê Status Check Trigger",
        "type": "n8n-nodes-base.cron",
        "position": [
          240,
          980
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "cronExpression",
                "expression": "0 10 */2 * *"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "read-applied",
        "name": "üìñ Read Applied Jobs",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          460,
          980
        ],
        "parameters": {
          "range": "A:J",
          "keyRow": 1,
          "dataMode": "autoMapInputData",
          "sheetName": "Jobs",
          "documentId": "={{ $('Configuration').first().json.spreadsheetId }}",
          "requestMethod": "GET",
          "authentication": "oAuth2"
        },
        "typeVersion": 4
      },
      {
        "id": "filter-applied",
        "name": "üéØ Filter Applied Jobs",
        "type": "n8n-nodes-base.filter",
        "position": [
          680,
          980
        ],
        "parameters": {
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "applied-filter",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.Status }}",
                "rightValue": "Applied"
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "split-status",
        "name": "üîÑ Check Status One by One",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          900,
          980
        ],
        "parameters": {
          "options": {
            "reset": false
          },
          "batchSize": 1
        },
        "typeVersion": 3
      },
      {
        "id": "mock-status-check",
        "name": "üîç Mock Status Check",
        "type": "n8n-nodes-base.set",
        "position": [
          1120,
          980
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "mock-status",
                "name": "newStatus",
                "type": "string",
                "value": "={{ ['Applied', 'Under Review', 'Interview Scheduled', 'Rejected'][Math.floor(Math.random() * 4)] }}"
              },
              {
                "id": "check-date",
                "name": "checkDate",
                "type": "string",
                "value": "={{ $now.format('yyyy-MM-dd') }}"
              },
              {
                "id": "status-notes",
                "name": "statusNotes",
                "type": "string",
                "value": "Status checked automatically via API"
              }
            ]
          }
        },
        "typeVersion": 3
      },
      {
        "id": "status-changed",
        "name": "üîÑ Check if Status Changed",
        "type": "n8n-nodes-base.if",
        "position": [
          1340,
          980
        ],
        "parameters": {
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "status-changed",
                "operator": {
                  "type": "string",
                  "operation": "notEquals"
                },
                "leftValue": "={{ $json.Status }}",
                "rightValue": "={{ $json.newStatus }}"
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "update-changed",
        "name": "üìù Update Changed Status",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1560,
          980
        ],
        "parameters": {
          "range": "D{{ $json.row_index }}:F{{ $json.row_index }}",
          "keyRow": 1,
          "values": {
            "values": [
              [
                "={{ $json.newStatus }}",
                "={{ $json.Applied_Date }}",
                "={{ $json.checkDate }}"
              ]
            ]
          },
          "dataMode": "autoMapInputData",
          "sheetName": "Jobs",
          "documentId": "={{ $('Configuration').first().json.spreadsheetId }}",
          "requestMethod": "UPDATE",
          "authentication": "oAuth2",
          "valueInputMode": "raw"
        },
        "typeVersion": 4
      },
      {
        "id": "send-status-update",
        "name": "üìß Send Status Update",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1780,
          980
        ],
        "parameters": {
          "email": "={{ $('Configuration').first().json.userEmail }}",
          "message": "<h3>Application Status Changed</h3>\n<p><strong>Company:</strong> {{ $json.Company }}</p>\n<p><strong>Position:</strong> {{ $json.Position }}</p>\n<p><strong>Previous Status:</strong> {{ $json.Status }}</p>\n<p><strong>New Status:</strong> {{ $json.newStatus }}</p>\n<p><strong>Last Checked:</strong> {{ $json.checkDate }}</p>\n<p><strong>Notes:</strong> {{ $json.statusNotes }}</p>",
          "subject": "Status Update: {{ $json.Company }} - {{ $json.Position }}",
          "operation": "sendEmail",
          "emailFormat": "html"
        },
        "typeVersion": 2
      }
    ],
    "settings": {
      "executionOrder": "v1"
    },
    "updatedAt": "2025-01-15T00:00:00.000Z",
    "versionId": "1",
    "staticData": null,
    "connections": {
      "‚öôÔ∏è Configuration": {
        "main": [
          [
            {
              "node": "üìñ Read Jobs Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìñ Read Jobs Sheet": {
        "main": [
          [
            {
              "node": "üéØ Filter Pending Applications",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîç Apply via Indeed": {
        "main": [
          [
            {
              "node": "üìä Process Application Result",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìñ Read Applied Jobs": {
        "main": [
          [
            {
              "node": "üéØ Filter Applied Jobs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìù Update Job Status": {
        "main": [
          [
            {
              "node": "üìß Send Application Notification",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîÄ Route by Platform": {
        "main": [
          [
            {
              "node": "üíº Apply via LinkedIn",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "üîç Apply via Indeed",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîç Mock Status Check": {
        "main": [
          [
            {
              "node": "üîÑ Check if Status Changed",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üíº Apply via LinkedIn": {
        "main": [
          [
            {
              "node": "üìä Process Application Result",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üéØ Filter Applied Jobs": {
        "main": [
          [
            {
              "node": "üîÑ Check Status One by One",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üïê Status Check Trigger": {
        "main": [
          [
            {
              "node": "üìñ Read Applied Jobs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìù Update Changed Status": {
        "main": [
          [
            {
              "node": "üìß Send Status Update",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîÑ Check Status One by One": {
        "main": [
          [
            {
              "node": "üîç Mock Status Check",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîÑ Check if Status Changed": {
        "main": [
          [
            {
              "node": "üìù Update Changed Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üîÑ Process Jobs One by One": {
        "main": [
          [
            {
              "node": "üìù Prepare Application Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìù Prepare Application Data": {
        "main": [
          [
            {
              "node": "üîÄ Route by Platform",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üïò Daily Application Trigger": {
        "main": [
          [
            {
              "node": "‚öôÔ∏è Configuration",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üìä Process Application Result": {
        "main": [
          [
            {
              "node": "üìù Update Job Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üéØ Filter Pending Applications": {
        "main": [
          [
            {
              "node": "üîÑ Process Jobs One by One",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "triggerCount": 2
  },
  {
    "id": "Q4LhFRDraaQuorBs",
    "meta": {
      "instanceId": "84ad02d6104594179f43f1ce9cfe3a81637b2faedb57dafcb9e649b7542988db",
      "templateCredsSetupCompleted": true
    },
    "name": "Upwork Job Aggregator & Notifier",
    "tags": [],
    "nodes": [
      {
        "id": "834d0a42-1398-4cd4-aaf3-b1164e00b4a8",
        "name": "Daily Upwork Job Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          0,
          0
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 9
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a0d54dfe-fc68-4020-b2ed-d191a57d5897",
        "name": "Fetch Upwork Jobs (Apify)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          220,
          0
        ],
        "parameters": {
          "url": "https://api.apify.com/v2/actor-tasks/<YOUR_TASK_ID>/run-sync-get-dataset-items?token=<YOUR_API_TOKEN>",
          "method": "POST",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "a9812fc7-0fa5-492a-91aa-392d0c8ee43b",
        "name": "Format Job Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          440,
          0
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "24bd782a-a34f-4b98-8d8f-21763181677b",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              },
              {
                "id": "ee879b3d-339a-44c2-9e11-f653edab2e7f",
                "name": "url",
                "type": "string",
                "value": "={{ $json.url }}"
              },
              {
                "id": "b5ff7975-667b-4997-ac8f-acbe9a3b3b85",
                "name": "description",
                "type": "string",
                "value": "={{ $json.description }}"
              },
              {
                "id": "29051fc3-e4f8-4e39-a024-d7b943271acc",
                "name": "budget",
                "type": "string",
                "value": "={{ $json.budget }}"
              },
              {
                "id": "a6492128-a58a-4735-b427-12265f81da3a",
                "name": "datePosted",
                "type": "string",
                "value": "={{ $json.datePosted }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "a996aa35-8f0d-4e1a-997b-4aadd402f65c",
        "name": "Log Jobs to Google Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          740,
          0
        ],
        "parameters": {
          "columns": {
            "value": {
              "url": "={{ $json.url }}",
              "title": "={{ $json.title }}",
              "budget": "={{ $json.budget }}",
              "datePosted": "={{ $json.datePosted }}",
              "description": "={{ $json.description }}"
            },
            "schema": [
              {
                "id": "title",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "url",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "description",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "budget",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "budget",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "datePosted",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "datePosted",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1dEU6uMB4ehiGXjIExjtFQHvUjANRODawKMBGKDaTcEc/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1dEU6uMB4ehiGXjIExjtFQHvUjANRODawKMBGKDaTcEc",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1dEU6uMB4ehiGXjIExjtFQHvUjANRODawKMBGKDaTcEc/edit?usp=drivesdk",
            "cachedResultName": "Upwork Scraper"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "v021NCWuTwSSSXPP",
            "name": "Google Sheets account 2"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "e0cd68e5-4d6d-479a-8a48-1faccc9f3ff7",
        "name": "Summarize Job Listings",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          960,
          0
        ],
        "parameters": {
          "text": "=Provide a summary of the upwork jobs. It should be in email format\n\nTitle: {{ $json.title }}\nURL: {{ $json.url }}\nDescription:{{ $json.description }}\nBudget:{{ $json.budget }}\nDate posted: {{ $json.datePosted }}",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "30002e32-6046-4e5c-a27f-a0d58f380ae9",
        "name": "Send Job Summary Email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1500,
          0
        ],
        "webhookId": "6937d724-5ede-4c56-83fd-fde84496eabd",
        "parameters": {
          "sendTo": "shahkar.genai@gmail.com",
          "message": "={{ $json.output.Summary }}",
          "options": {},
          "subject": "={{ $json.output.subject }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YMHjS2nJsRGP7svY",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "a1fb5d66-b780-4b6b-96be-3391b6196301",
        "name": "OpenAI Job Summarizer",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          900,
          260
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "wYwTjEv45IzlAOAu",
            "name": "OpenAi account 2"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "f79a7336-80fc-4832-862b-51d0d737d5a3",
        "name": "Parse Summary Output",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1160,
          260
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"subject\": \"Upwork Job Opportunity: Webflow Expert Needed for Portfolio Website\",\n  \"Summary\": \"The client is seeking a designer with strong experience in Webflow to create a responsive and elegant portfolio site.\"\n}\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "85465ead-0a06-455c-9308-866c092d8ef5",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          -560
        ],
        "parameters": {
          "color": 3,
          "width": 640,
          "height": 760,
          "content": "### üîÅ **Section 1: Job Fetch & Preparation**\n\nüì¶ **Group Name**: `üì• Fetch & Prepare Upwork Jobs`\n\n#### ‚úÖ **Included Nodes:**\n\n1. `üïí Daily Upwork Job Trigger`\n2. `üåê Fetch Upwork Jobs (Apify)`\n3. `üõ†Ô∏è Format Job Fields`\n\n#### üìã **What this group does:**\n\nThis group is responsible for automatically triggering the job search, pulling fresh job data from Upwork (via Apify), and formatting that data into a clean, structured format.\n\n#### üìå **Highlights:**\n\n* Uses Apify‚Äôs `run-sync-get-dataset-items` to ensure you get fresh job results in one go.\n* Ensures only the required fields (like title, URL, budget) are passed forward.\n* Keeps your data clean and minimal for logging and summarization.\n\n---"
        },
        "typeVersion": 1
      },
      {
        "id": "3699ba73-75ee-4bf2-91eb-8d0d05143321",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          680,
          -620
        ],
        "parameters": {
          "color": 5,
          "width": 620,
          "height": 1040,
          "content": "### üìä **Section 2: Data Logging & Summary Generation**\n\nüì¶ **Group Name**: `üßæ Log & Summarize Jobs`\n\n#### ‚úÖ **Included Nodes:**\n\n1. `üìà Log Jobs to Google Sheet`\n2. `ü§ñ Summarize Job Listings`\n\n   * `üß† OpenAI Job Summarizer`\n   * `üìÑ Parse Summary Output`\n\n#### üìã **What this group does:**\n\nThis group handles the dual responsibility of:\n\n* Persistently logging all job entries to a **Google Sheet**\n* Generating a human-friendly **natural language summary** of the fetched jobs using the OpenAI model and parsing the result into clean output\n\n#### üí° **Why this matters:**\n\n* Keeps historical records in Sheets ‚úÖ\n* Makes email digest more meaningful and less overwhelming for the reader üß†\n\n---\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "2289feb5-9ab1-4dbb-a77e-f4742f0f341d",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1400,
          -420
        ],
        "parameters": {
          "color": 6,
          "width": 340,
          "height": 600,
          "content": "## üì§ **Section 3: Job Summary Notification**\n\nüì¶ **Group Name**: `‚úâÔ∏è Notify via Email`\n\n#### ‚úÖ **Included Node:**\n\n1. `üìß Send Job Summary Email`\n\n#### üìã **What this group does:**\n\nSends a **summary email** to the desired recipient(s) with the content generated by the AI agent.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "95727922-4856-4481-acff-519638ac5d23",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1520,
          -560
        ],
        "parameters": {
          "color": 4,
          "width": 1300,
          "height": 320,
          "content": "=======================================\n            WORKFLOW ASSISTANCE\n=======================================\nFor any questions or support, please contact:\n    Yaron@nofluff.online\n\nExplore more tips and tutorials here:\n   - YouTube: https://www.youtube.com/@YaronBeen/videos\n   - LinkedIn: https://www.linkedin.com/in/yaronbeen/\n=======================================\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c161b105-70a6-431a-91e2-9031ccba8fe4",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1520,
          -220
        ],
        "parameters": {
          "color": 4,
          "width": 1289,
          "height": 3058,
          "content": "# ‚úÖ n8n Automation: \"Upwork Job Aggregator & Notifier\"\n\n> **Purpose**: Automatically fetch job postings from Upwork with specific keywords, save them in Google Sheets, summarize them using AI, and email the results daily (or at any interval you want).\n\n---\n\n## üß± HIGH-LEVEL OVERVIEW\n\n| Feature         | Description                                          |\n| --------------- | ---------------------------------------------------- |\n| üïê Trigger      | Scheduled (e.g., every 6 hours)                      |\n| üåê Source       | [Apify](https://apify.com) actor for Upwork scraping |\n| üìÑ Storage      | Google Sheets                                        |\n| üß† Summary      | OpenAI model with structured output                  |\n| üì¨ Notification | Gmail with formatted job summary                     |\n\n---\n\n## üß† GROUP 1: üì• Fetch & Prepare Upwork Jobs\n\n### üü¢ Nodes:\n\n1. `üïí Daily Upwork Job Trigger`\n\n   * **Type**: Cron Trigger\n   * **Purpose**: Runs the flow automatically at your set interval (e.g., every 6 hours or daily)\n\n2. `üåê Fetch Upwork Jobs (Apify)`\n\n   * **Type**: HTTP Request\n   * **Method**: POST\n   * **URL**: `https://api.apify.com/v2/actor-tasks/<TASK_ID>/run-sync-get-dataset-items?token=<API_TOKEN>`\n   * **Purpose**: Calls your Apify Upwork Scraper task to get the latest job listings\n   * **Output**: JSON array of job objects\n\n3. `üõ†Ô∏è Format Job Fields`\n\n   * **Type**: Edit Fields (Set or Function Node)\n   * **Purpose**: Extracts needed job fields like `title`, `url`, `description`, `budget`, and `datePosted`\n   * **Reason**: Makes data uniform for Sheet storage and AI summary\n\n---\n\n## üìä GROUP 2: üßæ Log & Summarize Jobs\n\n### üü¢ Nodes:\n\n4. `üìà Log Jobs to Google Sheet`\n\n   * **Type**: Google Sheets ‚Üí Append Sheet\n   * **Sheet Setup**: Must have headers like `Title`, `URL`, `Description`, `Budget`, `Date`\n   * **Purpose**: Appends each new job as a row in the sheet for historical tracking\n\n5. `ü§ñ Summarize Job Listings` (AI Agent node group)\n\n   * **Type**: Tools Agent (LangChain / OpenAI Integration)\n   * **Connected Sub-Nodes**:\n\n     * `üß† OpenAI Job Summarizer` (OpenAI Chat Model)\n\n       * **Prompt** example:\n\n         ```\n         You are an assistant summarizing freelance job postings. Summarize each job in 1-2 lines. Include title, budget, and a short description.\n         ```\n     * `üìÑ Parse Summary Output` (Structured Output Parser)\n\n       * **Purpose**: Converts the AI response into structured n8n items\n   * **Input**: Job data from Google Sheets\n   * **Output**: A clear, natural language summary of all jobs\n\n---\n\n## üì§ GROUP 3: ‚úâÔ∏è Notify via Email\n\n### üü¢ Node:\n\n6. `üìß Send Job Summary Email`\n\n   * **Type**: Gmail ‚Üí Send Message\n\n   * **Authentication**: Google OAuth2\n\n   * **To**: Yourself or your team\n\n   * **Subject**: `\"üöÄ New Upwork Jobs Found!\"`\n\n   * **Body**:\n\n     ```\n     Hello,\n\n     Here‚Äôs a summary of the latest Upwork jobs matching your criteria:\n\n     {{summary from AI}}\n\n     ‚ûï View full job list here: [Google Sheet Link]\n\n     Best,  \n     Your Automation Bot ü§ñ\n     ```\n\n   * **Error Handling**: Add an IF node to prevent email if no jobs were returned (optional)\n\n---\n\n## üóÇ Suggested Color-Coded Groups in n8n:\n\n| Group                          | Nodes                                | Color     | Description                     |\n| ------------------------------ | ------------------------------------ | --------- | ------------------------------- |\n| üì• Fetch & Prepare Upwork Jobs | Trigger, HTTP Request, Format Fields | üü¢ Green  | Gets data and prepares it       |\n| üßæ Log & Summarize Jobs        | Google Sheets, AI Agent, Parser      | üü° Yellow | Logs + creates smart summaries  |\n| ‚úâÔ∏è Notify via Email            | Gmail                                | üî¥ Red    | Notifies you with clean summary |\n\n---\n\n## üöÄ ADVANTAGES\n\n‚úÖ Completely automated\n‚úÖ Saves all job history\n‚úÖ AI-enhanced summaries\n‚úÖ Instant email alerts\n‚úÖ Easy to expand or customize\n\n---\n\n## üß© Bonus Enhancements (Optional)\n\n| Idea                      | Description                                                   |\n| ------------------------- | ------------------------------------------------------------- |\n| üîç Add keyword filters    | Add filters before saving to Sheets (e.g., only ‚ÄúReact‚Äù jobs) |\n| üïµÔ∏è‚Äç‚ôÇÔ∏è Prevent duplicates | Store job IDs and check before saving                         |\n| üì£ Add Slack alerts       | Add Slack node for team notification                          |\n| üìä Dashboard              | Build Google Data Studio report over the Sheet                |\n\n---\n\n\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {
      "Fetch Upwork Jobs (Apify)": [
        {
          "json": {
            "url": "https://www.upwork.com/job/Looking-Webflow-Expert-Build-Portfolio-Website_~01abcd123456efghij",
            "title": "Looking for a Webflow Expert to Build a Portfolio Website",
            "budget": "$300",
            "datePosted": "2025-06-03T08:45:00Z",
            "description": "Need a designer with strong Webflow experience to create a responsive and elegant portfolio site."
          }
        },
        {
          "json": {
            "url": "https://www.upwork.com/job/React-Developer-Needed-SaaS-Dashboard_~0123abcd4567efghij",
            "title": "React Developer Needed for SaaS Dashboard",
            "budget": "$500",
            "datePosted": "2025-06-03T06:30:00Z",
            "description": "Looking for an experienced React developer to work on our SaaS product dashboard UI. Experience with Tailwind is a plus."
          }
        },
        {
          "json": {
            "url": "https://www.upwork.com/job/Copywriter-Landing-Page-Finance_~0a1b2c3d4e5f67890",
            "title": "Copywriter for Landing Page Content (Finance Industry)",
            "budget": "$150",
            "datePosted": "2025-06-02T21:15:00Z",
            "description": "We need SEO-optimized copy for a fintech landing page. Prior experience in finance writing preferred."
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "8c929fc6-2198-4adf-89c3-ff0a2b296fdd",
    "connections": {
      "Format Job Fields": {
        "main": [
          [
            {
              "node": "Log Jobs to Google Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Summary Output": {
        "ai_outputParser": [
          [
            {
              "node": "Summarize Job Listings",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Job Summarizer": {
        "ai_languageModel": [
          [
            {
              "node": "Summarize Job Listings",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Summarize Job Listings": {
        "main": [
          [
            {
              "node": "Send Job Summary Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Daily Upwork Job Trigger": {
        "main": [
          [
            {
              "node": "Fetch Upwork Jobs (Apify)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Log Jobs to Google Sheet": {
        "main": [
          [
            {
              "node": "Summarize Job Listings",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Upwork Jobs (Apify)": {
        "main": [
          [
            {
              "node": "Format Job Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "93f396852104089b8670e7494b0f3668b420464668ae4a8c1d6b4b5799f8e3ef",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "0fa7eed1-0e6d-4370-bb11-2500e93c2ef0",
        "name": "JotForm Trigger",
        "type": "n8n-nodes-base.jotFormTrigger",
        "position": [
          -1024,
          256
        ],
        "webhookId": "c18ee2e4-2ebf-4058-a167-e71b8a6d1ff0",
        "parameters": {
          "form": "252801824783057"
        },
        "credentials": {
          "jotFormApi": {
            "id": "I2Xm5wbkEW1qEJC5",
            "name": "JotForm account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "0c107533-b8d0-4dc8-a073-7138a7288146",
        "name": "Append or update row in sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -800,
          256
        ],
        "parameters": {
          "columns": {
            "value": {
              "Full Name": "={{ $json['Full Name'].first }} {{ $json['Full Name'].last }}",
              "client type": "={{ $json['I am a...'] }}",
              "Phone Number": "={{ $json['Phone Number'].full }}",
              "Brief Message": "={{ $json['Brief Message'] }}",
              "Email Address": "={{ $json['Email Address'] }}",
              "Legal Service of Interest": "={{ $json['Legal Service of Interest'] }}",
              "How Did You Hear About Us?": "={{ $json['How Did You Hear About Us?'] }}"
            },
            "schema": [
              {
                "id": "Full Name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Full Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email Address",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Email Address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Phone Number",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Phone Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "client type",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "client type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Legal Service of Interest",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Legal Service of Interest",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Brief Message",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Brief Message",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "How Did You Hear About Us?",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "How Did You Hear About Us?",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Email Address"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1invngp2z_3ZMe_Qcs5XioDkAs50DSXT-Pl4ibPLXyA0/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1invngp2z_3ZMe_Qcs5XioDkAs50DSXT-Pl4ibPLXyA0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1invngp2z_3ZMe_Qcs5XioDkAs50DSXT-Pl4ibPLXyA0/edit?usp=drivesdk",
            "cachedResultName": "Law Client Enquiries"
          },
          "authentication": "serviceAccount"
        },
        "credentials": {
          "googleApi": {
            "id": "mYRmmCMyWcLawmcE",
            "name": "Google Service Account account"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "69795336-f1ce-4ce8-b7fc-4379418cb83e",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -528,
          256
        ],
        "parameters": {
          "text": "=<prompt>\n    <persona>\n        <name>Alex</name>\n        <role>Expert, friendly, and efficient legal intake assistant</role>\n        <company>VTR Law Firm</company>\n    </persona>\n\n    <client_info>\n        <name>{{ $json[\"Full Name\"] }}</name>\n        <service_interest>{{ $json[\"Legal Service of Interest\"] }}</service_interest>\n        <message>{{ $json[\"Brief Message\"] }}</message>\n    </client_info>\n\n    <task>\n        Draft a concise, professional, and welcoming WhatsApp message to the potential client using their submitted information.\n    </task>\n\n    <instructions>\n        <message_structure>\n            <item>Greet the client by their first name.</item>\n            <item>Thank them for contacting VTR Law Firm regarding their interest in the specified service.</item>\n            <item>Briefly acknowledge their message to show you've read it.</item>\n            <item>Inform them that the next step is a *complimentary consultation* to discuss their matter in more detail.</item>\n            <item>Provide a clear call to action to schedule the meeting using this link: https://calendly.com/vtr-law-firm/consultation</item>\n            <item>Sign off professionally with your name and the firm's name.</item>\n        </message_structure>\n    </instructions>\n\n    <output_constraints>\n        <rule>The output must be formatted as a single, average-sized WhatsApp message.</rule>\n        <rule>Use asterisks (*) for bolding key phrases.</rule>\n        <rule>Do not include the client's phone number or email address in your response.</rule>\n        <rule>Generate only the WhatsApp message text itself.</rule>\n    </output_constraints>\n\n    <example>\n        <description>Based on the instructions and sample data, the generated message should look like this.</description>\n        <output_message>\nHi Abhi,\n\nThank you for contacting VTR Law Firm about your query related to Business Law. I've reviewed the message you sent regarding the situation with your partner.\n\nThe best next step is to schedule a *complimentary, no-obligation consultation* with one of our legal experts to discuss this in more detail.\n\nYou can schedule a call with our legal executive by replying your available times\n\nWe look forward to speaking with you.\n\nBest regards,\nAlex | VTR Law Firm\n        </output_message>\n    </example>\n</prompt>",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "95a55ce6-3967-4a6b-ba11-57ba9c9d0998",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -528,
          528
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "googlePalmApi": {
            "id": "qsaK3VMNWQDWLweQ",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b06b2984-c342-4db7-a46b-06679b0080db",
        "name": "WhatsApp Trigger",
        "type": "n8n-nodes-base.whatsAppTrigger",
        "position": [
          240,
          320
        ],
        "webhookId": "685f1ed2-ffac-460b-b2eb-b29891e539d4",
        "parameters": {
          "options": {
            "messageStatusUpdates": [
              "delivered"
            ]
          },
          "updates": [
            "messages"
          ]
        },
        "credentials": {
          "whatsAppTriggerApi": {
            "id": "iXRwfmH8WHEurWCh",
            "name": "WhatsApp OAuth account"
          }
        },
        "executeOnce": true,
        "typeVersion": 1
      },
      {
        "id": "a715deb0-e11f-46df-b4ae-1cb4c214c183",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          496,
          320
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "c2380501-f59a-4075-b335-8ae3b7f64788",
                "operator": {
                  "type": "string",
                  "operation": "empty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.messages[0].text.body }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "e157f8f8-f9da-4f03-baa3-114b199d36e0",
        "name": "GET MANY EVENTS OF DAY THE USER ASKED",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          976,
          544
        ],
        "parameters": {
          "options": {},
          "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}",
          "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}",
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "venkibvb5192@gmail.com",
            "cachedResultName": "venkibvb5192@gmail.com"
          },
          "operation": "getAll",
          "returnAll": true
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "UMXPrV71iWBRBbyc",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "a4b80f3b-caf8-40c7-b787-c090b5010755",
        "name": "Create an event",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          1136,
          544
        ],
        "parameters": {
          "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}",
          "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}",
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "venkibvb5192@gmail.com",
            "cachedResultName": "venkibvb5192@gmail.com"
          },
          "additionalFields": {
            "summary": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Summary', ``, 'string') }}",
            "attendees": [
              "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('attendees0_Attendees', ``, 'string') }}"
            ],
            "description": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', ``, 'string') }}",
            "sendUpdates": "all",
            "guestsCanInviteOthers": true
          }
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "UMXPrV71iWBRBbyc",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "937a57e5-4e9e-4302-99a7-e38ff770e453",
        "name": "Google Gemini Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          656,
          544
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "googlePalmApi": {
            "id": "qsaK3VMNWQDWLweQ",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ed687b20-55af-41a3-b815-0044bf238692",
        "name": "AI Agent1",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          912,
          336
        ],
        "parameters": {
          "text": "=<prompt>\n    <persona>\n        <name>Alex</name>\n        <role>Professional and friendly legal scheduling assistant</role>\n        <company>VTR Law Associates</company>\n    </persona>\n\n    <context>\n        <timestamp>\n            The current date and time is {{ $now.toFormat(\"DDDD, HH:mm:ss ZZZZ\") }}. You must use this information only to correctly interpret relative time requests from the user (like \"tomorrow,\" \"next Tuesday,\" or \"in two hours\").\n        </timestamp>\n    </context>\n\n    <instructions>\n        <task>\n            When a user wants to schedule a legal consultation, follow these steps precisely. Use the provided tools and context to answer the user's question.\n        </task>\n        \n        <procedure>\n            <step n=\"1\">\n                <description>Find User Details: First, use the 'Know about the user enquiry' tool to find the user's requirement details, such as their email address and the reason for their legal enquiry.</description>\n                <tool>Know about the user enquiry</tool>\n            </step>\n            \n            <step n=\"2\">\n                <description>Gather Missing Details: Ask the user for their preferred date and time for the consultation. If you could not find the user's email address in the previous step, politely ask for it now for the calendar invitation.</description>\n            </step>\n            \n            <step n=\"3\">\n                <description>Check Availability: Use the 'GET MANY EVENTS OF DAY THE USER ASKED' tool to check for existing events on the user's requested date.</description>\n                <tool>GET MANY EVENTS OF DAY THE USER ASKED</tool>\n            </step>\n            \n            <step n=\"4\">\n                <description>Handle the Outcome based on availability:</description>\n                <condition case=\"time available\">\n                    <action>Use the 'Create an event' tool. Set the event title to \"Legal Consultation - VTR Law Associates\" and add the user's email as an attendee.</action>\n                    <action>Confirm with the user that the consultation is successfully booked.</action>\n                    <tool>Create an event</tool>\n                </condition>\n                <condition case=\"time unavailable\">\n                    <action>Do not create an event.</action>\n                    <action>Inform the user that the requested time is booked and suggest specific alternative times based on the availability you found.</action>\n                </condition>\n            </step>\n        </procedure>\n        \n        <general_instruction>Handle greetings naturally without needing the context.</general_instruction>\n    </instructions>\n\n    <user_input>\n        <message>{{ $json.messages[0].text.body }}</message>\n    </user_input>\n\n    <output_format>\n        <style>WhatsApp</style>\n        <rules>\n            <rule>Use italics for emphasis.</rule>\n            <rule>Use bold for key points.</rule>\n            <rule>Use bullet lists (‚Ä¢) for lists.</rule>\n            <rule>Keep responses short, clear, and conversational.</rule>\n            <rule>Avoid markdown headers or code blocks.</rule>\n        </rules>\n    </output_format>\n\n    <constraints>\n        <fallback>\n            If the answer cannot be found in the context, reply: \"I'm sorry, my primary role is to schedule consultations. I don't have the information to answer that question.\"\n        </fallback>\n    </constraints>\n</prompt>",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "6cda0580-9e50-4406-a794-2d9315498f0e",
        "name": "Postgres Chat Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
        "position": [
          816,
          544
        ],
        "parameters": {
          "sessionKey": "={{ $('If').item.json.contacts[0].wa_id }}",
          "sessionIdType": "customKey"
        },
        "credentials": {
          "postgres": {
            "id": "B6Q3ACzgMJ6GYv3R",
            "name": "Postgres account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "4891245b-9402-44b6-8632-d6f1053a8f54",
        "name": "Know about the user enquiry",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          1296,
          544
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "Phone Number"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1invngp2z_3ZMe_Qcs5XioDkAs50DSXT-Pl4ibPLXyA0/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1invngp2z_3ZMe_Qcs5XioDkAs50DSXT-Pl4ibPLXyA0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1invngp2z_3ZMe_Qcs5XioDkAs50DSXT-Pl4ibPLXyA0/edit?usp=drivesdk",
            "cachedResultName": "Law Client Enquiries"
          },
          "authentication": "serviceAccount"
        },
        "credentials": {
          "googleApi": {
            "id": "mYRmmCMyWcLawmcE",
            "name": "Google Service Account account"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "3021dcef-b9ef-4a87-abe6-992081b72600",
        "name": "Send message",
        "type": "n8n-nodes-base.whatsApp",
        "position": [
          -144,
          256
        ],
        "webhookId": "a823ba47-31b2-47e6-9668-9441566daa04",
        "parameters": {
          "textBody": "={{ $json.output }}",
          "operation": "send",
          "phoneNumberId": "838262432698376",
          "additionalFields": {},
          "recipientPhoneNumber": "={{ $('Append or update row in sheet').item.json['Phone Number'] }}"
        },
        "credentials": {
          "whatsAppApi": {
            "id": "fGqaO9SAj11hcCzx",
            "name": "WhatsApp account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "6aad2ba5-1451-4150-b28a-f760061e8341",
        "name": "Send message1",
        "type": "n8n-nodes-base.whatsApp",
        "position": [
          1424,
          336
        ],
        "webhookId": "2b88030b-0e59-4b3a-8a97-0d1c81695f5b",
        "parameters": {
          "textBody": "={{ $json.output }}",
          "operation": "send",
          "phoneNumberId": "838262432698376",
          "additionalFields": {},
          "recipientPhoneNumber": "={{ $('WhatsApp Trigger').item.json.contacts[0].wa_id }}"
        },
        "credentials": {
          "whatsAppApi": {
            "id": "fGqaO9SAj11hcCzx",
            "name": "WhatsApp account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b90257f8-e8c0-4c63-9713-6052a9785d8f",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1072,
          -352
        ],
        "parameters": {
          "width": 1136,
          "height": 1056,
          "content": "## Part A: New Lead Intake & Welcome Message\n\nThis flow triggers when a potential client fills out your JotForm. It saves their data and sends an immediate welcome message.\n\n* **1. JotForm Trigger** üì•\n    * **Function**: This node is the starting point. It actively listens for new submissions on your specific JotForm. When someone hits 'submit', this node wakes up and grabs all the information they entered.\n\n* **2. Append or update row in sheet** üìù\n    * **Function**: This node acts as your record-keeper. It takes the data from the JotForm and adds it as a new row in your \"Law Client Enquiries\" Google Sheet. If an entry with the same email already exists, it simply updates that row with the new information.\n\n* **3. AI Agent** ü§ñ\n    * **Function**: This is the message writer. It takes the client's name and service of interest from the previous step and uses a pre-written prompt to craft a personalized, professional welcome message.\n\n* **4. Google Gemini Chat Model** üß†\n    * **Function**: This is the \"brain\" that powers the AI Agent. The agent sends its prompt and the client's info to this model, and Gemini generates the actual text for the WhatsApp message.\n\n* **5. Send message (WhatsApp)** üì≤\n    * **Function**: This node sends the final message. It takes the text generated by the AI and delivers it as a WhatsApp message to the phone number the client provided in the form.\n\n***\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b7acce1b-992f-42bc-b9f7-4ee7670b412e",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          192,
          -336
        ],
        "parameters": {
          "width": 1456,
          "height": 1056,
          "content": "\n## Part B: AI-Powered Appointment Scheduling\n\nThis flow activates when the client replies to the welcome message. An AI agent then chats with them to book a consultation.\n\n* **1. WhatsApp Trigger** üí¨\n    * **Function**: This node listens for incoming WhatsApp messages. When a client replies to your business number, it kicks off the scheduling conversation.\n\n* **2. If** ü§î\n    * **Function**: A simple checkpoint. It checks if the incoming message has text. If it's an empty message or just a delivery receipt, the workflow stops. If there is text, it proceeds.\n\n* **3. AI Agent1** üë©‚Äçüíº\n    * **Function**: This is your AI scheduling assistant, \"Alex\". It manages the back-and-forth conversation with the client to find a suitable meeting time. It uses a set of \"tools\" to perform actions like checking your calendar.\n\n* **4. Postgres Chat Memory** üíæ\n    * **Function**: This node gives the AI a memory. It saves the conversation history for each client, so if the chat is long, the AI can remember what was discussed previously.\n\n* **5. The AI's Tools (What it can do)** üõ†Ô∏è\n    * **Know about the user enquiry (Sheets Tool)**: Allows the AI to look up the client's original submission details from the Google Sheet using their phone number.\n    * **GET MANY EVENTS... (Calendar Tool)**: Allows the AI to check your Google Calendar for existing appointments on a date the client requests.\n    * **Create an event (Calendar Tool)**: Allows the AI to book the appointment directly on your Google Calendar once a time is confirmed.\n\n* **6. Send message1 (WhatsApp)** üó£Ô∏è\n    * **Function**: This node sends the AI's conversational replies back to the client. This could be a confirmation (\"You're all booked!\"), a question (\"Is 3 PM tomorrow okay?\"), or a suggestion for an alternative time."
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "If": {
        "main": [
          [],
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Send message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          [
            {
              "node": "Send message1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send message": {
        "main": [
          []
        ]
      },
      "Create an event": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "JotForm Trigger": {
        "main": [
          [
            {
              "node": "Append or update row in sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "WhatsApp Trigger": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres Chat Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Know about the user enquiry": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Append or update row in sheet": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GET MANY EVENTS OF DAY THE USER ASKED": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "name": "LinkedIn AI Content Automation - Agentic Vibe",
    "nodes": [
      {
        "id": "7f5f9934-7ab8-43e9-a4cb-1583740a2e36",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -840,
          640
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "hours",
                "hoursInterval": 6
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "928e2771-ec9f-48ff-b34e-9c3ab9c4a828",
        "name": "Content topic generator2",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -500,
          640
        ],
        "parameters": {
          "text": "You are a Content Researcher Assistant at Agentic Vibe, an AI-first automation agency helping solopreneurs, creators, and digital-first founders grow their online presence ‚Äî especially on LinkedIn ‚Äî through scalable, hands-free content systems.\n\nYour task is to generate high-value content topics that align with our brand pillars and resonate deeply with our audience. These topics will later be expanded into posts by another agent.\n\nüîç What to Focus On:\nGenerate content topics (not full content) based on these strategic themes:\n\nAI for Content Creation & Workflow Automation\n\nLinkedIn Automation Tools, Tactics & Growth Strategies\n\nSolopreneur Productivity Hacks Using AI & Automation\n\nSystems Thinking for Scaling Personal Brands\n\nThe Future of Work, Creators, and Automated Influence\n\nNo-Code Tools for Content & Lead Gen Automation\n\n‚úÖ Your Output Per Topic:\nFor each idea, generate the following:\n\nTopic Title or Core Idea (1 line)\n\nShort Rationale (1‚Äì2 sentences on why this topic matters)\n\nSuggested Angle or Hook (1 LinkedIn-style framing or contrarian take)\n\nüí° Style Guide:\nKeep ideas insightful, actionable, and future-minded\n\nFavor founder-style energy: confident, sharp, and slightly contrarian when it adds value\n\nAvoid hype or jargon ‚Äî focus on clarity, systemized insight, and utility",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2
      },
      {
        "id": "10577345-0f96-42bf-a5db-7f9f205f7359",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -500,
          880
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "YOUR_OPENAI_CREDENTIAL_ID",
            "name": "OpenAI API"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c7094a20-a96a-4db8-9ee4-95f86de800ac",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          -320,
          860
        ],
        "parameters": {
          "jsonSchemaExample": "[{\n \"title\": \"AI as Your First Content Hire: Why Founders Shouldn't Wait to Outsource Creation\",\n            \"rationale\": \"Most solopreneurs delay content scaling because they think hiring a ghostwriter is the next step ‚Äî but AI can handle 80% with proper systems. This shifts content from a creative bottleneck to a scalable growth lever.\",\n            \"hook\": \"Ghostwriters are outdated. Train GPT once, and it ships LinkedIn gold in your voice daily. Welcome to hands-free thought leadership.\"\n          }]"
        },
        "typeVersion": 1.2
      },
      {
        "id": "84b30f40-e7fa-4c46-9a82-39bbd2becfe0",
        "name": "Content creator",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          -80,
          640
        ],
        "parameters": {
          "text": "=You are a linkedin content creator and copywriter. Given the title {{ $json.output[0].title }}, the rationale {{ $json.output[0].rationale }}, suggested hook. Generate text content for a linkedin post. Also describe a suitable image for the post.",
          "batching": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "6fdea8df-7cb4-4418-8dab-e5faa9e76b6b",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -80,
          820
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "YOUR_OPENAI_CREDENTIAL_ID",
            "name": "OpenAI API"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "cc1e5e3c-31de-4d1b-948b-89165fbc9769",
        "name": "Structured Output Parser1",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          80,
          820
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"post title\": \"Exciting New Feature Launch üöÄ\",\n  \"post content\": \"After months of collaboration, testing, and fine-tuning, we're thrilled to introduce our latest product feature: Smart Insights. It helps users uncover meaningful patterns in their data with just a few clicks. This wouldn't have been possible without our incredible team and supportive community. We're excited for what's next ‚Äî and we'd love your feedback!\",\n  \"image description\": \"A laptop screen showcasing the new Smart Insights dashboard with colorful charts and graphs, surrounded by a team clapping in the background.\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "2ae88f2a-031c-41c3-bbb9-f1555d94863a",
        "name": "OpenAI",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          420,
          460
        ],
        "parameters": {
          "prompt": "=Generate an image for a linkedin post this is the description: {{ $json.output['image description'] }} .The images should be realistic for linkedin.",
          "options": {},
          "resource": "image"
        },
        "credentials": {
          "openAiApi": {
            "id": "YOUR_OPENAI_CREDENTIAL_ID",
            "name": "OpenAI API"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "f3901b98-cfe4-4d48-9e35-59161cbcfdd9",
        "name": "Hashtag generator /SEO",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          420,
          900
        ],
        "parameters": {
          "text": "=You are an SEO specialist for LinkedIn. Your task is to generate highly relevant and effective hashtags for the following post. Consider the post's content, target audience, and current LinkedIn trends to maximize visibility and engagement.\n\n<post_title>{{ $json.output['post title'] }}</post_title>\n<post_content>{{ $json.output['post content'] }}</post_content>\n\nPlease generate:\n1. **3-5 broad, high-volume hashtags** (e.g., #AI, #Marketing, #Business)\n2. **3-5 niche-specific hashtags** that are directly relevant to the post's core topic (e.g., #SocialMediaAutomation, #ContentCreationAI, #LinkedInMarketingTips)\n3. **1-2 trending/topical hashtags** if applicable (e.g., #FutureOfWork, #DigitalTransformation)\n\nPresent them as a comma-separated list.",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2
      },
      {
        "id": "f3d91646-6d7b-4270-85bc-0e4684bbd0d0",
        "name": "OpenAI Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          420,
          1100
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "YOUR_OPENAI_CREDENTIAL_ID",
            "name": "OpenAI API"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "692b1c2e-bdc7-474e-859e-204970f512a6",
        "name": "Structured Output Parser2",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          600,
          1100
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"post title\": \"Exciting New Feature Launch üöÄ\",\n  \"post content\": \"After months of collaboration, testing, and fine-tuning, we're thrilled to introduce our latest product feature: Smart Insights. It helps users uncover meaningful patterns in their data with just a few clicks. This wouldn't have been possible without our incredible team and supportive community. We're excited for what's next ‚Äî and we'd love your feedback!\",\n  \"image description\": \"A laptop screen showcasing the new Smart Insights dashboard with colorful charts and graphs, surrounded by a team clapping in the background.\",\n\"Hashtags\":[\"#AI\",\"#Automation\"]\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "f667d091-72aa-4bea-9648-4563a75265ff",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          780,
          640
        ],
        "parameters": {},
        "typeVersion": 3.2
      },
      {
        "id": "7c3a37b7-3227-43a7-86fb-c39e885570bf",
        "name": "LinkedIn",
        "type": "n8n-nodes-base.linkedIn",
        "position": [
          1060,
          620
        ],
        "parameters": {
          "postAs": "organization",
          "additionalFields": {},
          "shareMediaCategory": "IMAGE"
        },
        "credentials": {
          "linkedInOAuth2Api": {
            "id": "YOUR_LINKEDIN_CREDENTIAL_ID",
            "name": "LinkedIn OAuth2 API"
          }
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "settings": {
      "executionOrder": "v1"
    },
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "LinkedIn",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Content creator": {
        "main": [
          [
            {
              "node": "OpenAI",
              "type": "main",
              "index": 0
            },
            {
              "node": "Hashtag generator /SEO",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Content topic generator2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Content topic generator2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Content creator",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Hashtag generator /SEO",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Hashtag generator /SEO": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Content topic generator2": {
        "main": [
          [
            {
              "node": "Content creator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Content topic generator2",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "Content creator",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser2": {
        "ai_outputParser": [
          [
            {
              "node": "Hashtag generator /SEO",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "IOWmWdoiFYtZFoQ7",
    "meta": {
      "instanceId": "dd69efaf8212c74ad206700d104739d3329588a6f3f8381a46a481f34c9cc281",
      "templateCredsSetupCompleted": true
    },
    "name": "Auto Meeting Record, Transcribe & Email Summaries with Vexa & Llama AI",
    "tags": [],
    "nodes": [
      {
        "id": "1e744c15-6d1e-4cf6-b0fc-9a076a28f99d",
        "name": "Start Meeting Trigger\t",
        "type": "n8n-nodes-base.googleCalendarTrigger",
        "position": [
          -80,
          100
        ],
        "parameters": {
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "eventStarted",
          "calendarId": {
            "__rl": true,
            "mode": "id",
            "value": "abc@gmail.com"
          }
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "6ldLmzzYtaqng4pw",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d887b73f-bae7-4ce7-b1dd-428e020eec59",
        "name": "Launch Vexa Bot for Meeting\t",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          140,
          100
        ],
        "parameters": {
          "url": "https://gateway.dev.vexa.ai/bots",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "platform",
                "value": "google_meet"
              },
              {
                "name": "native_meeting_id",
                "value": "={{ $json.conferenceData.conferenceId }}"
              },
              {
                "name": "language",
                "value": "en"
              },
              {
                "name": "bot_name",
                "value": "Oneclick Bot"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "X-API-Key",
                "value": "your_api_key_here"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "88c87165-2cf6-4e6a-95fb-414477d4c9a2",
        "name": "End Meeting Trigger\t",
        "type": "n8n-nodes-base.googleCalendarTrigger",
        "position": [
          -80,
          460
        ],
        "parameters": {
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "eventStarted",
          "calendarId": {
            "__rl": true,
            "mode": "id",
            "value": "abc@gmail.com"
          }
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "6ldLmzzYtaqng4pw",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9193cf99-82ea-4cb2-a83b-d6e6543dc378",
        "name": "Stop Vexa Bot\t",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          140,
          460
        ],
        "parameters": {
          "url": "=https://gateway.dev.vexa.ai/bots/google_meet/{{ $json.conferenceData.conferenceId }}",
          "method": "DELETE",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "X-API-Key",
                "value": "your_api_key_here"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "21dbb664-4085-4a2a-8cf3-e4767f517d9d",
        "name": "Fetch Meeting Audio File\t",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          360,
          360
        ],
        "parameters": {
          "url": "=https://gateway.dev.vexa.ai/meeting_audio/google_meet/{{ $('End Meeting Trigger\t').item.json.conferenceData }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "X-API-Key",
                "value": "your_api_key_here"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "83e8a00e-874f-4447-addc-89101095a993",
        "name": "Transcribe Meeting Audio\t",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          380,
          600
        ],
        "parameters": {
          "url": "=https://gateway.dev.vexa.ai/transcripts/google_meet/{{ $('End Meeting Trigger\t').item.json.conferenceData.conferenceId }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "X-API-Key",
                "value": "your_api_key_here"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "defad130-6fbd-4cd6-8e35-deebabd6011f",
        "name": "Prepare Transcript for AI\t",
        "type": "n8n-nodes-base.set",
        "position": [
          580,
          560
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "62f25d35-d8cc-48f8-997d-97ff90368635",
                "name": "text",
                "type": "string",
                "value": "={{ $json.segments }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "b4cded44-b3e1-41b4-b994-a5dcf26a65ec",
        "name": "Generate Meeting Summary\t",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          800,
          560
        ],
        "parameters": {
          "text": "=Provide a concise summary of following texts in nested bullets, using quotes only when absolutely essential for clarity. Start output directly with the response.\n\n\n{{ $json.text }}",
          "promptType": "define"
        },
        "typeVersion": 1.6
      },
      {
        "id": "efebad1b-5ebe-4491-a9e6-a0b9838815eb",
        "name": "AI Model",
        "type": "@n8n/n8n-nodes-langchain.lmOllama",
        "position": [
          888,
          780
        ],
        "parameters": {
          "model": "llama3.2-16000:latest",
          "options": {}
        },
        "credentials": {
          "ollamaApi": {
            "id": "h9CEBFmYALm3FvZf",
            "name": "Ollama account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5c21a138-e2ed-4e2e-a4c2-6ddf65e85625",
        "name": "Send email",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          1176,
          560
        ],
        "webhookId": "38db2e20-637d-4740-af3b-f3c0f50d1e4d",
        "parameters": {
          "text": "={{ $json.output }}",
          "options": {},
          "subject": "Meeting Summary",
          "toEmail": "abc@gamil.com",
          "fromEmail": "xyz@gamil.com",
          "emailFormat": "text"
        },
        "credentials": {
          "smtp": {
            "id": "G1kyF8cSWTZ4vouN",
            "name": "SMTP -test"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "b59c01ba-f3e6-4485-bf96-684aa21a6973",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1106,
          460
        ],
        "parameters": {
          "height": 260,
          "content": "Sends the generated meeting summary to specified recipients via email, using configured SMTP settings"
        },
        "typeVersion": 1
      },
      {
        "id": "db5a2b78-d7d0-4aa9-af65-db586650977b",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -210,
          0
        ],
        "parameters": {
          "width": 300,
          "height": 260,
          "content": "Initiates workflow when meeting begins, triggered by eventStarted signal from the meeting platform. Configure with Google Meet webhook and API credentials"
        },
        "typeVersion": 1
      },
      {
        "id": "3403ed43-201d-4ede-a736-eaaa3d6bf97b",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          120,
          0
        ],
        "parameters": {
          "color": 3,
          "height": 260,
          "content": "Starts the Vexa Bot recording process using the configured API credentials or webhook"
        },
        "typeVersion": 1
      },
      {
        "id": "da19f45e-4dd3-4f78-95a6-0c0f0af63182",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -340,
          360
        ],
        "parameters": {
          "color": 5,
          "width": 400,
          "height": 260,
          "content": "Detects meeting end event and triggers next step to stop recording. Configure with Google Meet webhook for eventEnded and fix authentication (e.g., verify client credentials)"
        },
        "typeVersion": 1
      },
      {
        "id": "b5bcf708-5175-440f-9028-c959ce2d5117",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          70,
          360
        ],
        "parameters": {
          "color": 4,
          "height": 260,
          "content": "Halts the Vexa Bot recording and prepares the audio file for further processing."
        },
        "typeVersion": 1
      },
      {
        "id": "9fd34341-9e6f-428d-bf7a-058ae1881a77",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          270,
          320
        ],
        "parameters": {
          "width": 280,
          "height": 200,
          "content": "Retrieves the recorded audio file from Vexa Bot for transcription."
        },
        "typeVersion": 1
      },
      {
        "id": "d73efff1-507a-401a-b151-44b36fffefac",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          320,
          500
        ],
        "parameters": {
          "color": 6,
          "width": 180,
          "height": 260,
          "content": "Converts the fetched audio file into text using the connected AI model."
        },
        "typeVersion": 1
      },
      {
        "id": "6bc285e7-5512-4719-ae44-f07f240826a3",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          560,
          440
        ],
        "parameters": {
          "color": 4,
          "width": 160,
          "height": 340,
          "content": "Formats the transcribed text for input into the AI model for summary generation."
        },
        "typeVersion": 1
      },
      {
        "id": "4b4ae666-3280-465c-aa4c-2011aec87247",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          780,
          420
        ],
        "parameters": {
          "color": 3,
          "height": 420,
          "content": "Creates a concise summary from the transcribed text using the AI model."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "f7d7eaa4-9e40-4d89-9095-6a881320a158",
    "connections": {
      "AI Model": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Meeting Summary\t",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Stop Vexa Bot\t": {
        "main": [
          [
            {
              "node": "Fetch Meeting Audio File\t",
              "type": "main",
              "index": 0
            },
            {
              "node": "Transcribe Meeting Audio\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "End Meeting Trigger\t": {
        "main": [
          [
            {
              "node": "Stop Vexa Bot\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Start Meeting Trigger\t": {
        "main": [
          [
            {
              "node": "Launch Vexa Bot for Meeting\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Meeting Audio File\t": {
        "main": [
          []
        ]
      },
      "Generate Meeting Summary\t": {
        "main": [
          [
            {
              "node": "Send email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Transcribe Meeting Audio\t": {
        "main": [
          [
            {
              "node": "Prepare Transcript for AI\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Transcript for AI\t": {
        "main": [
          [
            {
              "node": "Generate Meeting Summary\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "Lv9oRZsJbywQxyXP",
    "meta": {
      "instanceId": "9f809bfc8e0071859d9ccaa58634646aca57d10a441308f02247b17f59745849",
      "templateCredsSetupCompleted": true
    },
    "name": "Smart Lead Welcomer (Dental)",
    "tags": [],
    "nodes": [
      {
        "id": "b00450c4-4bf7-4d87-a2c4-dbdf3afc5638",
        "name": "Google Sheets Trigger",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          -16,
          48
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 951804608,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/",
            "cachedResultName": "Form responses 1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1RLC2D_t-NYuhbKD8WV-EPh_INH7idEVhslXNbP2-jSE",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/",
            "cachedResultName": " Smart Lead Welcomer (Dental)"
          }
        },
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "qvsa0BnEaLwjU6Lh",
            "name": "Google Sheets Trigger account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "873655e8-0f44-4583-9314-42b8493c41e0",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          256,
          48
        ],
        "webhookId": "30f51dc4-6154-4fa0-93df-7c543ff814cc",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "7fe90709-0b71-413d-a580-28f97b8cb483",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -816,
          -528
        ],
        "parameters": {
          "color": 6,
          "width": 464,
          "height": 240,
          "content": "## ‚ö†Ô∏è The Problem\n**Dental clinics lose many new leads.\n\nPatients submit forms (teeth whitening, Invisalign, implants, etc.) but:\n\nThey only get a generic thank-you (not engaging).\n\nBy the time the clinic calls, many never respond.\n\nThis means lost revenue + cold leads."
        },
        "typeVersion": 1
      },
      {
        "id": "4c2bd99e-ed16-4e45-b35f-faa07191f274",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          528,
          48
        ],
        "parameters": {
          "text": "=Patient Details:\n- Full Name: {{$json[\"Full Name\"]}}\n- Email: {{$json[\"Email\"]}}\n- Treatment Interest: {{ $json[' What are you most interested in?'] }}\n- Dental Concern: {{$json[\"What‚Äôs your main dental concern right now? (e.g., yellow teeth, missing tooth, crooked smile)\"]}}\n- Contact Method: {{ $json[' What‚Äôs the best way to reach you?'] }}\n- Contact Time: {{$json[\"What‚Äôs the best time to reach you?\"]}}\n",
          "options": {
            "systemMessage": "=You are a friendly and professional dental clinic assistant for SmileBright Dental. \nYour task is to write a short, warm, and engaging welcome email based on the patient's form inputs. \nTailor the email to their treatment choice, mentioning it positively (e.g., Teeth Whitening ‚Üí ‚ú® brighter smile, Invisalign ‚Üí üòÅ confident smile, Dental Implants ‚Üí ü¶∑ restored smile). \nUse their main dental concern for personalization. \nEncourage them to book an appointment and include their preferred contact method and time. \nKeep the tone enthusiastic, professional, and concise. \n\n‚ö†Ô∏è Important: Return the output as a complete **HTML email** with:\n- A subject line in `<title>` at the top (for the email subject)\n- An `<h1>` or `<h2>` for greeting\n- Paragraphs `<p>` for the body\n- Emojis to make it friendly\n- A clear clickable call-to-action button (`<a href=\"https://wa.me/...\" style=\"...\">Book Appointment</a>`)\n\nDo not return JSON or plain text. Only valid HTML.\n"
          },
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "800070a1-e597-4e9e-a648-76c2e7360e0d",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          496,
          -144
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-3.5-turbo",
            "cachedResultName": "gpt-3.5-turbo"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "vmQTqXXemcWXRkNn",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "d4667734-2bd0-4a0d-a35f-cf286ea976d0",
        "name": "Think",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          736,
          -144
        ],
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "697650aa-7639-49ba-a49a-c1bd04186d46",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          624,
          -144
        ],
        "parameters": {
          "sessionKey": "={{ $('Google Sheets Trigger').item.json['Email address'] }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "ac13787d-2893-4572-bcb9-d6632008d4e4",
        "name": "Send a message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          944,
          -48
        ],
        "webhookId": "03cbe0e0-d50c-4efd-9537-0866d747c9f7",
        "parameters": {
          "sendTo": "={{ $('Google Sheets Trigger').item.json.Email }}",
          "message": "={{ $json.output }}",
          "options": {
            "appendAttribution": false
          },
          "subject": "=Welcome to SmileBright Dental"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "rzn4lBZG4p6mgmwc",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "b79c7074-b933-495f-9475-6192f40c6284",
        "name": "Send a message1",
        "type": "n8n-nodes-base.gmail",
        "position": [
          960,
          160
        ],
        "webhookId": "109a4b14-f43d-4da1-9a1b-b3d57cdcd30d",
        "parameters": {
          "sendTo": "n8nagency.online@gmail.com",
          "message": "=A new patient lead has arrived üéâ  Name:{{ $('Google Sheets Trigger').item.json['Full Name'] }}  Email:{{ $('Google Sheets Trigger').item.json['Email address'] }} Phone: {{ $('Google Sheets Trigger').item.json['Phone no'] }}Treatment Interest: {{ $('Google Sheets Trigger').item.json[' What are you most interested in?'] }}Dental Concern:{{ $('Google Sheets Trigger').item.json['What‚Äôs your main dental concern right now? (e.g., yellow teeth, missing tooth, crooked smile)'] }}\nPlease follow up with them on {{ $('Google Sheets Trigger').item.json[' What‚Äôs the best way to reach you?'] }} in the{{ $('Google Sheets Trigger').item.json['What‚Äôs the best time to reach you?'] }}",
          "options": {
            "appendAttribution": false
          },
          "subject": "=New Lead  {{ $('Google Sheets Trigger').item.json['Full Name'] }}",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "rzn4lBZG4p6mgmwc",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "6d27638f-ce3d-48b7-98ea-b4ea5c1b45f6",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -224,
          -80
        ],
        "parameters": {
          "width": 512,
          "height": 128,
          "content": "##  Trigger\n‚ö° Fires when a new patient submits the form.\nform is: https://docs.google.com/forms/u/0/d/e/1FAIpQLSevL3LaoKWTLuekELB0Mrp6k5jVh5WZockkdv0Lefn1_YjtXg/formResponse"
        },
        "typeVersion": 1
      },
      {
        "id": "fd709424-75ff-4c66-950f-4753471428aa",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -192,
          208
        ],
        "parameters": {
          "color": 3,
          "width": 304,
          "height": 192,
          "content": "## üìä Save every lead for clinic records."
        },
        "typeVersion": 1
      },
      {
        "id": "4de5d999-378f-45f4-80fb-bc1b0d84643b",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          432,
          -288
        ],
        "parameters": {
          "color": 5,
          "width": 432,
          "height": 592,
          "content": "## AI AGENT \nü§ñ Generate friendly, personalized welcome message."
        },
        "typeVersion": 1
      },
      {
        "id": "b4a45166-fe5e-46b2-95b0-e6841986908e",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1152,
          -64
        ],
        "parameters": {
          "color": 7,
          "content": "## Patient Notification\n \n**SEND** üìß personalized welcome email ,appointment notification,immediately."
        },
        "typeVersion": 1
      },
      {
        "id": "f5247169-9177-47d0-984d-29b2afca881b",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1152,
          192
        ],
        "parameters": {
          "color": 7,
          "content": "## Dentist Notification\n \n**SEND** üìß personalized welcome email ,appointment notification,immediately."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "b7e9eecf-b28b-49d8-97cb-10a7a33931f8",
    "connections": {
      "Wait": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Think": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Send a message1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Send a message1": {
        "main": [
          [
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets Trigger": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "d1786ab0d745a7498abf13a9c2cdabb1374c006e889b79eef64ce0386b8f8a41"
    },
    "nodes": [
      {
        "id": "59b4e37b-f52f-415a-bb6f-7a249984ec3a",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          3280,
          840
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "MGwGMKEkdcjzlYCw",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "d9d53795-da16-4921-9c50-a4ce036b564f",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          3500,
          840
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"invoice_number\": \"\",\n  \"invoice_date\": \"\",\n  \"due_date\": \"\",\n  \"vendor_name\": \"\",\n  \"total_amount\": \"\",\n  \"currency\": \"\",\n  \"items\": [\n    {\n      \"description\": \"\",\n      \"amount\": \"\"\n    }\n  ],\n  \"tax\": \"\",\n  \"category\": \"\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "69406dc2-fb14-40bd-a24b-5fa28aaa338c",
        "name": "Invoice Folder Monitor",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          2620,
          420
        ],
        "parameters": {
          "event": "fileCreated",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "id",
            "value": "1KJ4fvXcKVMGJunsKvPYf8PkX5K9SVwFk"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "SEUhrgz30NMJS3cH",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ab3bbd35-7d81-482e-a9f6-242c7b98cd49",
        "name": "Download Invoice PDF",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          2820,
          420
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {},
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "SEUhrgz30NMJS3cH",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "fc5a0c82-a1e9-468d-a2a5-0f8e7291f1d9",
        "name": "Invoice Parser AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          3300,
          640
        ],
        "parameters": {
          "text": "=You are an intelligent invoice parser. I will give you raw text extracted from a PDF invoice. \n\n========================\nSTART OF RAW INVOICE TEXT\n\n{{ $json.text }}\n\nEND OF RAW INVOICE TEXT\n========================\n\nYour job is to:\n\n1. Extract key information from the invoice such as:\n   - invoice_number\n   - invoice_date\n   - due_date (if available)\n   - vendor_name\n   - total_amount\n   - currency (e.g., USD, IDR, etc.)\n   - items (as a list of item descriptions and their amounts)\n   - tax (if available)\n\n2. Detect the invoice **category**, such as:\n   - Utilities\n   - Office Supplies\n   - Travel\n   - Software\n   - Food & Beverage\n   - Others (if unknown)\n\n3. Return the result in this exact JSON format:\n\n```json\n{\n  \"invoice_number\": \"\",\n  \"invoice_date\": \"\",\n  \"due_date\": \"\",\n  \"vendor_name\": \"\",\n  \"total_amount\": \"\",\n  \"currency\": \"\",\n  \"items\": [\n    {\n      \"description\": \"\",\n      \"amount\": \"\"\n    }\n  ],\n  \"tax\": \"\",\n  \"category\": \"\"\n}\n",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "bb0a4401-9feb-4240-a62f-ad90c6c642a1",
        "name": "Insert Invoice Data",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          4180,
          640
        ],
        "parameters": {
          "columns": {
            "value": {
              "Tax": "={{ $('Invoice Parser AI Agent').item.json.output.tax }}",
              "Items": "={{ $('Invoice Parser AI Agent').item.json.output.items }}",
              "Approved": "={{ $json.data['Approve Invoice?'] }}",
              "Category": "={{ $('Invoice Parser AI Agent').item.json.output.category }}",
              "Currency": "={{ $('Invoice Parser AI Agent').item.json.output.currency }}",
              "Due Date": "={{ $('Invoice Parser AI Agent').item.json.output.due_date }}",
              "Reviewed By": "={{ $json.data['Reviewed By'] }}",
              "Vendor Name": "={{ $('Invoice Parser AI Agent').item.json.output.vendor_name }}",
              "Invoice Date": "={{ $('Invoice Parser AI Agent').item.json.output.invoice_date }}",
              "Total Amount": "={{ $('Invoice Parser AI Agent').item.json.output.total_amount }}",
              "Approval Notes": "={{ $json.data['Approval Notes'] }}",
              "Invoice Number": "={{ $('Invoice Parser AI Agent').item.json.output.invoice_number }}"
            },
            "schema": [
              {
                "id": "Invoice Number",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Invoice Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Invoice Date",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Invoice Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Due Date",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Due Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Vendor Name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Vendor Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Total Amount",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Total Amount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Currency",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Currency",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Items",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Items",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Tax",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Tax",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Category",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Category",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Approved",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Approved",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Approval Notes",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Approval Notes",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Reviewed By",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Reviewed By",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ueJfN5dFTXY3_AdvnYUL5_RjV9YwSFvbxwA_ivtqnJk/edit#gid=0",
            "cachedResultName": "Invoices"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1ueJfN5dFTXY3_AdvnYUL5_RjV9YwSFvbxwA_ivtqnJk",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ueJfN5dFTXY3_AdvnYUL5_RjV9YwSFvbxwA_ivtqnJk/edit?usp=drivesdk",
            "cachedResultName": "Copy of PDF Invoice Parser - n8n template"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "ypmzFxQFfAacuVVC",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "d1980b52-aa0a-479b-892f-9e81abfb35f6",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2260,
          420
        ],
        "parameters": {
          "color": 4,
          "width": 280,
          "height": 600,
          "content": "## SETUP REQUIRED\n**Author:** [Billy Christi](https://n8n.io/creators/billy/)\n\n**Copy the Google Sheet template here**:  \nüëâ [PDF Invoice Parser with Approval Workflow ‚Äì Google Sheet Template](https://docs.google.com/spreadsheets/d/1ueJfN5dFTXY3_AdvnYUL5_RjV9YwSFvbxwA_ivtqnJk/edit?gid=0#gid=0)\n\nGoogle Sheets Structure:\nSheet: \"Invoices\"\n‚Ä¢ Column A: Invoice Number  \n‚Ä¢ Column B: Invoice Date  \n‚Ä¢ Column C: Due Date  \n‚Ä¢ Column D: Vendor Name  \n‚Ä¢ Column E: Total Amount  \n‚Ä¢ Column F: Currency  \n‚Ä¢ Column G: Items  \n‚Ä¢ Column H: Tax  \n‚Ä¢ Column I: Category  \n‚Ä¢ Column J: Approved\n‚Ä¢ Column K: Approval Notes\n‚Ä¢ Column L: Reviewed By\n\nRequired Credentials:\n‚Ä¢ Google Drive Credential  \n‚Ä¢ Gmail Credential \n‚Ä¢ Google Sheets Credential \n‚Ä¢ OpenAI API Key (GPT-4)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "858e3989-352d-4d73-a299-394b73780d59",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2600,
          1060
        ],
        "parameters": {
          "color": 5,
          "width": 700,
          "height": 560,
          "content": "## üßæ Automated PDF Invoice Processing & Approval Flow using OpenAI and Google Sheets\n\nWhat This Template Does:\n\n- Monitors **Google Drive**, **Gmail**, and a **web form** for incoming PDF invoices  \n- Automatically downloads and extracts raw text from PDF attachments  \n- Uses **GPT-4o-mini** to intelligently parse invoice data (invoice number, vendor, date, amount, tax, items, etc.)  \n- Categorizes invoices into types such as *Utilities, Travel, Office Supplies, Food & Beverage, Others*  \n- Sends a dynamic **approval request email** with an embedded decision form (Yes/No, reviewer name, notes)  \n- Stores both approved and rejected invoice data into **Google Sheets** for recordkeeping  \n- Sends rejection notifications to the finance team for follow-up  \n- Provides a complete, automated approval pipeline with human oversight  \n- Includes a structured JSON schema for consistent and error-free AI output  \n- Polls input sources every minute to ensure timely and responsive processing  \n- Ideal for businesses seeking to **automate their invoice approval and bookkeeping workflows** with AI\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9fa12368-2a78-4a94-9eec-4fcbfe2f0254",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3340,
          1060
        ],
        "parameters": {
          "color": 5,
          "width": 620,
          "height": 620,
          "content": "## üìã WORKFLOW PROCESS OVERVIEW\n\n1. **Invoice Collection**  \nInvoices are captured through three triggers: new PDFs in a Google Drive folder, incoming Gmail messages with PDF attachments, or direct uploads via a web form.\n\n2. **File Handling**  \nIf uploaded via Drive, the PDF is downloaded using its file ID; if via Gmail or form, the PDF is already available as binary data.\n\n3. **Text Extraction**  \nThe system extracts raw text from the PDF using the appropriate method based on its source (Drive, Email, or Form).\n\n4. **AI Data Parsing**  \nGPT-4 processes the extracted text into structured JSON, identifying invoice details like vendor, date, amount, and categorizing the invoice.\n\n5. **Approval Request**  \nAn email is sent to the reviewer with an approval form asking for a Yes/No decision along with optional notes.\n\n6. **Decision Routing**  \nIf approved, the data moves forward for storage; if rejected, a notification is sent to the finance team.\n\n7. **Save Invoice Data**  \nAll extracted and reviewed invoice data is saved into a Google Sheet, maintaining a full record of each invoice and its status.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "0aeca259-2a98-48c3-a892-94bf7eac802a",
        "name": "Send Invoice for Approval",
        "type": "n8n-nodes-base.gmail",
        "position": [
          3640,
          640
        ],
        "webhookId": "a23938a4-fc6c-4445-8dee-17e501e92e06",
        "parameters": {
          "sendTo": "replace_with_approver_email@yopmail.com",
          "message": "=A new invoice has been submitted and requires your review and approval:",
          "options": {},
          "subject": "=[Action Required] Invoice Approval Request ‚Äì {{ $json.output.vendor_name }}",
          "operation": "sendAndWait",
          "formFields": {
            "values": [
              {
                "fieldType": "dropdown",
                "fieldLabel": "Approve Invoice?",
                "fieldOptions": {
                  "values": [
                    {
                      "option": "Yes"
                    },
                    {
                      "option": "No"
                    }
                  ]
                },
                "requiredField": true
              },
              {
                "fieldLabel": "Reviewed By",
                "requiredField": true
              },
              {
                "fieldType": "textarea",
                "fieldLabel": "Approval Notes"
              }
            ]
          },
          "responseType": "customForm"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "sWl7FFMkEUYBj0zM",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "2224840e-b38b-4375-9726-4355db099d6c",
        "name": "Monitor Email Attachments",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          2820,
          640
        ],
        "parameters": {
          "simple": false,
          "filters": {},
          "options": {
            "downloadAttachments": true,
            "dataPropertyAttachmentsPrefixName": "attachment_"
          },
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "sWl7FFMkEUYBj0zM",
            "name": "Gmail account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "f4ff8acd-d3a0-45c4-89eb-5d32c2311cf0",
        "name": "Upload Invoice (PDF) Form",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          2820,
          840
        ],
        "webhookId": "e033bea9-70e8-41e2-aea4-1b95714ea257",
        "parameters": {
          "options": {},
          "formTitle": "Upload Invoice (PDF)",
          "formFields": {
            "values": [
              {
                "fieldType": "file",
                "fieldLabel": "Upload",
                "multipleFiles": false,
                "requiredField": true,
                "acceptFileTypes": ".pdf"
              }
            ]
          },
          "formDescription": "Upload your invoice PDF using this form."
        },
        "typeVersion": 2.2
      },
      {
        "id": "c2c7545e-344e-480d-8ff7-c14a275460cb",
        "name": "Extract Text from Drive PDF",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          3020,
          420
        ],
        "parameters": {
          "options": {},
          "operation": "pdf"
        },
        "typeVersion": 1
      },
      {
        "id": "51b5bedc-ac31-4e31-a854-89d63c8fe410",
        "name": "Extract Text from Email PDF",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          3020,
          640
        ],
        "parameters": {
          "options": {},
          "operation": "pdf",
          "binaryPropertyName": "attachment_0"
        },
        "typeVersion": 1
      },
      {
        "id": "aca28461-3f7b-4530-aaec-a61bb402895b",
        "name": "Extract Text from Form PDF",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          3020,
          840
        ],
        "parameters": {
          "options": {},
          "operation": "pdf",
          "binaryPropertyName": "Upload"
        },
        "typeVersion": 1
      },
      {
        "id": "189f7e81-1391-4baa-baa1-63419f92cccb",
        "name": "Check Approval Decision",
        "type": "n8n-nodes-base.if",
        "position": [
          3900,
          640
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "451bfdfc-f645-4e3c-91cc-895558f45b11",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.data['Approve Invoice?'] }}",
                "rightValue": "Yes"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "24d89a38-91cc-429d-af6a-8616d67c1e03",
        "name": "Send Rejection Alert",
        "type": "n8n-nodes-base.gmail",
        "position": [
          4040,
          900
        ],
        "webhookId": "1c33c42a-0d8e-466f-a424-faba306c56af",
        "parameters": {
          "sendTo": "finance_team@yopmail.com",
          "message": "=Hi Finance Team,\n\nAn invoice from {{ $('Invoice Parser AI Agent').item.json.output.vendor_name }} has been disapproved during the approval process.\n\nReviewed By: {{ $('Send Invoice for Approval').item.json.data['Reviewed By'] }}\nApproval Notes: {{ $('Send Invoice for Approval').item.json.data['Approval Notes'] }}\n\nPlease review and follow up as needed.\n\nThank you,\nAutomated Invoice System\n\n",
          "options": {
            "appendAttribution": false
          },
          "subject": "=[Alert] Invoice Disapproved ‚Äì {{ $('Invoice Parser AI Agent').item.json.output.vendor_name }}",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "sWl7FFMkEUYBj0zM",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "5a2f9411-4233-4173-8541-53ba13de6268",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          4400,
          340
        ],
        "parameters": {
          "color": 4,
          "width": 380,
          "height": 760,
          "content": "# üëã Hi, I‚Äôm Billy\n![My Photo](https://i.ibb.co/Gvn63Bzc/Billy-Christi-AI-Automation.jpg)\nI help businesses build **n8n workflows** & **AI automation projects**.  \nNeed help with n8n or AI Automation projects? \nContact me and let‚Äôs build your automation together.\n\nüì© **Email:** billychartanto@gmail.com  \nü§ù **n8n Creator:** [n8n.io/creators/billy](https://n8n.io/creators/billy/)\nüåê **My n8n Projects:** [billychristi.com/n8n](https://www.billychristi.com/n8n)  \n\n\n\n---\nüí° Feel free to get in touch if you‚Äôd like help on your next automation project or if you have any feedback or thoughts to share.\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {
      "Invoice Parser AI Agent": [
        {
          "output": {
            "tax": "8.50",
            "items": [
              {
                "amount": "85.00",
                "description": "Web Design - This is a sample description..."
              }
            ],
            "category": "Others",
            "currency": "USD",
            "due_date": "January 31, 2016",
            "vendor_name": "DEMO - Sliced Invoices",
            "invoice_date": "January 25, 2016",
            "total_amount": "93.50",
            "invoice_number": "INV-3337"
          }
        }
      ],
      "Send Invoice for Approval": [
        {
          "data": {
            "Reviewed By": "jack",
            "Approval Notes": "notes approval",
            "Approve Invoice?": "Yes"
          }
        }
      ]
    },
    "connections": {
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Invoice Parser AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Download Invoice PDF": {
        "main": [
          [
            {
              "node": "Extract Text from Drive PDF",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Rejection Alert": {
        "main": [
          [
            {
              "node": "Insert Invoice Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Invoice Folder Monitor": {
        "main": [
          [
            {
              "node": "Download Invoice PDF",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Approval Decision": {
        "main": [
          [
            {
              "node": "Insert Invoice Data",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send Rejection Alert",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Invoice Parser AI Agent": {
        "main": [
          [
            {
              "node": "Send Invoice for Approval",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Invoice Parser AI Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Monitor Email Attachments": {
        "main": [
          [
            {
              "node": "Extract Text from Email PDF",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Invoice for Approval": {
        "main": [
          [
            {
              "node": "Check Approval Decision",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Invoice (PDF) Form": {
        "main": [
          [
            {
              "node": "Extract Text from Form PDF",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Text from Form PDF": {
        "main": [
          [
            {
              "node": "Invoice Parser AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Text from Drive PDF": {
        "main": [
          [
            {
              "node": "Invoice Parser AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Text from Email PDF": {
        "main": [
          [
            {
              "node": "Invoice Parser AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "nLUMdYYEjggDRthb",
    "meta": {
      "instanceId": "8f0fd7c1a0033c2fb0bbd085ee2e931912ace7a1ffe6b3ccacfd5d810111ba3e",
      "templateCredsSetupCompleted": true
    },
    "name": "{Template} Mirai MailFlow - Gumroad personalised autoreply copy",
    "tags": [],
    "nodes": [
      {
        "id": "f6bbafa7-a682-4714-9bd5-ca8f5e6d20fd",
        "name": "Gmail Trigger",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          0,
          0
        ],
        "parameters": {
          "filters": {
            "q": "New sale of "
          },
          "pollTimes": {
            "item": [
              {
                "mode": "everyHour"
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Dysf400ueT7m4uQ3",
            "name": "Gmail account 2"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "c8c48cc8-1b6a-4d53-a486-c4f30054deff",
        "name": "Create a database page",
        "type": "n8n-nodes-base.notion",
        "position": [
          1008,
          -16
        ],
        "parameters": {
          "options": {},
          "resource": "databasePage",
          "databaseId": {
            "__rl": true,
            "mode": "list",
            "value": "2c411b7d-dc06-80fc-87e9-db7d5c714c1e",
            "cachedResultUrl": "https://www.notion.so/2c411b7ddc0680fc87e9db7d5c714c1e",
            "cachedResultName": "Gumroad Leads"
          },
          "propertiesUi": {
            "propertyValues": [
              {
                "key": "Name|title",
                "title": "={{ $('Code in JavaScript').item.json.name }}"
              },
              {
                "key": "email|rich_text",
                "textContent": "={{ $('Code in JavaScript').item.json.email }}"
              },
              {
                "key": "Product|rich_text",
                "textContent": "={{ $('Code in JavaScript').item.json.product }}"
              },
              {
                "key": "Purchase Date|rich_text",
                "textContent": "={{ $('Code in JavaScript').item.json.purchaseDate }}"
              },
              {
                "key": "Quantity|rich_text",
                "textContent": "={{ $('Code in JavaScript').item.json.quantity }}"
              },
              {
                "key": "UniqueKey|rich_text",
                "textContent": "={{ $('Code in JavaScript').item.json.uniqueKey }}"
              }
            ]
          }
        },
        "credentials": {
          "notionApi": {
            "id": "dtZmVu8dU0VWMNqv",
            "name": "Notion account 2"
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "a09a6310-d570-4e65-81aa-cc7ae72996d6",
        "name": "Code in JavaScript",
        "type": "n8n-nodes-base.code",
        "position": [
          240,
          0
        ],
        "parameters": {
          "jsCode": "// Robust Gumroad email parser for n8n Code node\n// Normalise whitespace so fields that are on same line still parse correctly.\nconst raw = ($json.snippet || \"\");\nconst text = raw.replace(/\\s+/g, \" \").trim() + \" \"; // collapse whitespace and add trailing space\n\nfunction find(pattern, fallback = \"\") {\n  const m = text.match(pattern);\n  return m ? m[1].trim() : fallback;\n}\n\n// Product: words after $price until a dash, \"View\", \"Email\", \"Quantity\", or known keyword\nlet product = find(/\\$\\d+\\s+([A-Za-z0-9][A-Za-z0-9\\s\\-\\+&]*?)(?=\\s+(?:-|View|Email|Quantity|Product|Referrer|Name|UTM|$))/i);\nif (product) product = product.replace(/\\s+(?:Order|Product price)$/i, \"\").trim();\n\n// Name: accept Customer X Email, Name X next-keyword, Buyer X, or Name at end.\n// Works for multi-word names and when name is last field.\nlet name = \"\";\nconst namePatterns = [\n  /Customer\\s+(.+?)(?=\\s+(?:Email|Quantity|UTM|Referrer|Product|Name|$))/i,\n  /Name\\s+(.+?)(?=\\s+(?:Product|Email|Quantity|Referrer|UTM|$))/i,\n  /Buyer\\s+(.+?)(?=\\s+(?:Email|Quantity|Referrer|Product|UTM|$))/i,\n];\nfor (const p of namePatterns) {\n  const m = text.match(p);\n  if (m && m[1]) { name = m[1].trim(); break; }\n}\n\n// Email, Quantity, Referrer (stop at next keyword)\nconst email = find(/Email\\s+([^\\s]+)/i);\nconst quantity = find(/Quantity\\s+(\\d+)/i);\nlet referrer = find(/Referrer\\s+(.+?)(?=\\s+(?:Name|Email|Quantity|Product|UTM|$))/i);\n\n// purchaseDate from Gmail internalDate if present\nlet purchaseDate = \"\";\nif ($json.internalDate) {\n  purchaseDate = new Date(Number($json.internalDate)).toISOString();\n}\n\n// unique key: fallbacks to avoid undefined\nconst uniqueKey = `${email || \"no-email\"}-${product || \"no-product\"}-${purchaseDate || \"no-date\"}`;\n\nreturn [\n  {\n    json: {\n      product: product || \"\",\n      name: name || \"\",\n      email: email || \"\",\n      quantity: quantity || \"\",\n      referrer: referrer || \"\",\n      purchaseDate,\n      uniqueKey\n    }\n  }\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "cf3b7bec-90ec-4861-956c-cf981792bad7",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1280,
          -16
        ],
        "parameters": {
          "text": "=You are an email writing assistant. Write a short, warm, professional, and emotionally positive email to a customer who has just purchased one of my digital products on Gumroad.\n\nUse the following customer details:\n- Name: {{ $json.name }}\n- Product Purchased: {{ $json.property_product }}\n\nWrite the email as if it is coming directly from me (Paul). The tone should be:\n- friendly but professional\n- genuinely appreciative\n- concise (5‚Äì7 sentences max)\n- emotionally positive and reassuring\n- no unnecessary marketing fluff\n\nInclude:\n- a warm thank-you for their purchase from Gumroad \n- a sentence appreciating their trust  \n- a brief one-line description of what the product helps with  \n- reassurance that they can reach me anytime for help  \n- a positive closing note wishing them success with the product  \n\nDo NOT include subject lines unless I ask separately.\nReturn only the email body in clean paragraph form.",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 3
      },
      {
        "id": "cc162afe-bcb7-472e-8bf1-f6927e3740e7",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1280,
          256
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "googlePalmApi": {
            "id": "Hjzbsf2jbJG0RN75",
            "name": "Google Gemini(PaLM) Api account 2"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8e9de348-c81b-4719-a4c7-f357638f5599",
        "name": "Send a message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1648,
          -16
        ],
        "webhookId": "093a6f85-cd54-496a-a355-cdb71b92d908",
        "parameters": {
          "sendTo": "={{ $('Code in JavaScript').item.json.email }}",
          "message": "={{ $json.output }}",
          "options": {
            "appendAttribution": false
          },
          "subject": "Thank you for supporting my work ‚ù§Ô∏è",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Dysf400ueT7m4uQ3",
            "name": "Gmail account 2"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "b6afd0bb-e744-49e1-abbb-06018be0d6e1",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          688,
          0
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "41dd1ae9-c8bb-4e72-9148-3702cb72297f",
                "operator": {
                  "type": "number",
                  "operation": "equals"
                },
                "leftValue": "={{ Object.keys($json).length }}",
                "rightValue": 0
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "e49a189b-319f-4d44-afc4-1a4e346ca01a",
        "name": "Stop and Error",
        "type": "n8n-nodes-base.stopAndError",
        "notes": "Error when duplictes is detected.",
        "position": [
          880,
          240
        ],
        "parameters": {
          "errorMessage": "The Data already exsists"
        },
        "notesInFlow": true,
        "typeVersion": 1
      },
      {
        "id": "cbfb4691-8738-4fc7-b1c4-6d8359fdb6ce",
        "name": "Get many database pages",
        "type": "n8n-nodes-base.notion",
        "position": [
          464,
          0
        ],
        "parameters": {
          "simple": false,
          "filters": {
            "conditions": [
              {
                "key": "UniqueKey|rich_text",
                "condition": "equals",
                "richTextValue": "={{ $json.uniqueKey }}"
              }
            ]
          },
          "options": {},
          "resource": "databasePage",
          "operation": "getAll",
          "databaseId": {
            "__rl": true,
            "mode": "list",
            "value": "2c411b7d-dc06-80fc-87e9-db7d5c714c1e",
            "cachedResultUrl": "https://www.notion.so/2c411b7ddc0680fc87e9db7d5c714c1e",
            "cachedResultName": "Gumroad Leads"
          },
          "filterType": "manual"
        },
        "credentials": {
          "notionApi": {
            "id": "dtZmVu8dU0VWMNqv",
            "name": "Notion account 2"
          }
        },
        "notesInFlow": false,
        "typeVersion": 2.2,
        "alwaysOutputData": true
      },
      {
        "id": "f07a92a1-f032-490d-be55-19b6fadb4bdd",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -64,
          -336
        ],
        "parameters": {
          "color": 7,
          "width": 432,
          "height": 512,
          "content": "## Request Authentication\nListens for Gumroad purchase emails and extracts buyer and product information.\n\n### Action Required\nAuthenticate Gmail\nEnsure Gumroad purchase emails are received in this inbox"
        },
        "typeVersion": 1
      },
      {
        "id": "59bc2cc5-a46e-481c-9130-08624ef95410",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          -336
        ],
        "parameters": {
          "color": 7,
          "width": 432,
          "height": 512,
          "content": "## Customer Lookup\n\nChecks the Notion database for existing customers and stops execution if a duplicate is found.\n\n## Action Required\n- Connect your Notion account\n- Select the correct customer database\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9d46503d-783a-4359-ad67-130673589713",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1248,
          -336
        ],
        "parameters": {
          "color": 7,
          "width": 544,
          "height": 512,
          "content": "## AI Reply & Delivery\nGenerates a personalized thank-you email using AI and sends it to the buyer automatically.\n\n### Outcome\n- Instant post-purchase engagement\n- Professional buyer experience\n- Fully automated workflow completion"
        },
        "typeVersion": 1
      },
      {
        "id": "1639dd58-ddcd-4734-b0da-86a92104b461",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          880,
          -336
        ],
        "parameters": {
          "color": 7,
          "width": 288,
          "height": 512,
          "content": "## Create Customer Record\n\nCreates a new customer record in Notion for first-time buyers.\n\n### What it stores:\n- Buyer details\n- Product purchased\n- Purchase value\n- Timestamp"
        },
        "typeVersion": 1
      },
      {
        "id": "b1493b9a-309f-4859-94cb-48c50b970f42",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -912,
          -240
        ],
        "parameters": {
          "width": 576,
          "height": 320,
          "content": "# Mirai MailFlow\nThis workflow automates post-purchase communication for Gumroad creators.\n\nWhen a Gumroad purchase email arrives in Gmail, the workflow extracts buyer and product details, checks for duplicate customers, stores the purchase in Notion, and sends a personalized thank-you email using AI.\n\nSetup requires connecting Gmail, Notion, and an AI model.\nWorks on cloud and self-hosted n8n. Setup takes ~5‚Äì10 minutes."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "9eaa6b02-7bb3-4810-89a2-9b377ae87c7e",
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "Create a database page",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Stop and Error",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail Trigger": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send a message": {
        "main": [
          []
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "Get many database pages",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create a database page": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get many database pages": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "vMvm0kfL6V7u4bPO",
    "meta": {
      "instanceId": "089a426694e95c86fd56db3433ae1586d34120d3ffcad01bcaa9ff768b7f5853",
      "templateCredsSetupCompleted": true
    },
    "name": "Client Responder IG/TG",
    "tags": [],
    "nodes": [
      {
        "id": "be329d21-b0fb-49a4-92ed-651f2297890c",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -340,
          220
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-3.5-turbo",
            "cachedResultName": "gpt-3.5-turbo"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "sSgwqUMSiCdMlx5r",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "aadcdcde-c6b2-4815-8088-4f310f4d0065",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          780,
          200
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4",
            "cachedResultName": "gpt-4"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "sSgwqUMSiCdMlx5r",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "760e2d6c-b121-4de8-bcf9-b117d2a771bc",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -700,
          -340
        ],
        "parameters": {
          "color": 3,
          "width": 2060,
          "height": 860,
          "content": "Workflow Node Descriptions:\nReceive Request: \"üì• Incoming customer message\"\nParse Request AI: \"ü§ñ Extract brand/model/size from text\"\nExtract Data: \"üìä Process JSON output\"\nProduct Database: \"üìã Load all products from inventory\"\nFilter Products: \"üîç Find matching items only\"\nAI Manager: \"üí¨ Generate friendly response\"\nSend Response: \"üì§ Deliver result to customer\""
        },
        "typeVersion": 1
      },
      {
        "id": "e89e72bb-c8ad-406c-a9a5-1297ae4974c9",
        "name": "Receive Request",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -600,
          0
        ],
        "webhookId": "753f3fe9-b17b-4431-81c2-a011044768d0",
        "parameters": {
          "path": "/shoe-orders",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "f0ee0564-5a40-4174-a80f-8c74d2d7e878",
        "name": "Parse Request AI",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          -360,
          0
        ],
        "parameters": {
          "text": "={{ $('Receive Request').first().json.body.message }}",
          "batching": {},
          "messages": {
            "messageValues": [
              {
                "type": "=SystemMessagePromptTemplate",
                "message": "=Extract shoe details from customer inquiry: brand name, model name, size, and color. Return only valid JSON format: {\"brand\": \"\", \"model\": \"\", \"size\": \"\", \"color\": \"\"}\n\nExamples:\n- \"Do you have Nike Air Max size 40?\" ‚Üí {\"brand\": \"Nike\", \"model\": \"Air Max\", \"size\": \"40\", \"color\": \"\"}\n- \"Looking for white Adidas size 38\" ‚Üí {\"brand\": \"Adidas\", \"model\": \"\", \"size\": \"38\", \"color\": \"white\"}\n\nCustomer message: {{ $json.message }}"
              }
            ]
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "8805f637-67ed-40e7-97c2-02bb84da2f2d",
        "name": "Extract Data",
        "type": "n8n-nodes-base.code",
        "position": [
          80,
          0
        ],
        "parameters": {
          "jsCode": "const input = $input.first().json;\nconst parsedData = JSON.parse(input.text);\n\nreturn [{\n  json: {\n    brand: parsedData.brand || \"\",\n    model: parsedData.model || \"\",\n    size: parsedData.size || \"\",\n    color: parsedData.color || \"\"\n  }\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "690c3190-4732-475a-8fad-00faa6897bf9",
        "name": "Product Database",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          300,
          0
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1AczF58510i-QEppNi_UnzgqqfX0ickNJZjFW2Bu-6mI/edit#gid=0",
            "cachedResultName": "–õ–∏—Å—Ç1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1AczF58510i-QEppNi_UnzgqqfX0ickNJZjFW2Bu-6mI",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1AczF58510i-QEppNi_UnzgqqfX0ickNJZjFW2Bu-6mI/edit?usp=drivesdk",
            "cachedResultName": "In Stock"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "up4mnfP28XT5t6r6",
            "name": "Google Sheets account 2"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "3da1277f-e726-4818-8ff6-e7e888d353ab",
        "name": "Filter Products",
        "type": "n8n-nodes-base.code",
        "position": [
          540,
          0
        ],
        "parameters": {
          "jsCode": "const allItems = $input.all();\nconst search = $('Extract Data').first().json;\n\nconst filtered = allItems.filter(item => {\n  const brandMatch = item.json.Brand?.toString()?.toLowerCase() === search.brand?.toLowerCase();\n  const modelMatch = search.model ? item.json.Model?.toString()?.toLowerCase().includes(search.model?.toLowerCase()) : true;\n  const sizeMatch = item.json.Size?.toString() === search.size;\n  const colorMatch = search.color ? item.json.Color?.toString()?.toLowerCase().includes(search.color?.toLowerCase()) : true;\n  \n  return brandMatch && modelMatch && sizeMatch && colorMatch;\n});\n\nreturn filtered;"
        },
        "typeVersion": 2
      },
      {
        "id": "37324505-d063-4d2a-9c2e-d195b54357eb",
        "name": "AI Manager",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          740,
          0
        ],
        "parameters": {
          "text": "={{ $('Receive Request').first().json.body.message }}",
          "batching": {},
          "messages": {
            "messageValues": [
              {
                "type": "=SystemMessagePromptTemplate",
                "message": "=You are a friendly shoe store assistant. Based on the product data below, generate a helpful response about availability, pricing, and stock.\n\nProduct data: {{ JSON.stringify($input.all()) }}\n\nResponse style: Friendly, helpful, and informative. Include price, stock quantity, and suggest alternatives if item is out of stock."
              }
            ]
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "d2e5c074-c68a-489c-8503-51cbda2bc267",
        "name": "Send Response",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          1140,
          0
        ],
        "parameters": {
          "options": {},
          "respondWith": "text",
          "responseBody": "={{ $json.text }}"
        },
        "typeVersion": 1.3
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "aa3fd2f1-d011-4c19-ab53-b2e3405a1c5c",
    "connections": {
      "AI Manager": {
        "main": [
          [
            {
              "node": "Send Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Data": {
        "main": [
          [
            {
              "node": "Product Database",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter Products": {
        "main": [
          [
            {
              "node": "AI Manager",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Receive Request": {
        "main": [
          [
            {
              "node": "Parse Request AI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Request AI": {
        "main": [
          [
            {
              "node": "Extract Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Product Database": {
        "main": [
          [
            {
              "node": "Filter Products",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Parse Request AI",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Manager",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "EOJfPcM9PPWI1Rmp",
    "meta": {
      "instanceId": "3aaeb6eaba3494bbdbe57e25fa3d02783cfbc460b1e823f7b741cf26edc7ca3d",
      "templateCredsSetupCompleted": true
    },
    "name": "Automated Research Report Generation with OpenAI, Wikipedia, Google Search, and Gmail/Telegram",
    "tags": [],
    "nodes": [
      {
        "id": "46c09535-cd6b-481c-b520-67ecb4aad812",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          776,
          -100
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "WLM64KJjQFXGWGWi",
            "name": "OpenAi account N8N"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "574ec863-e557-4196-b1b9-5c275a7de73a",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          896,
          -100
        ],
        "parameters": {
          "sessionKey": "={{ $json.output.searchQueries }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "661349c2-7bb1-4c95-af8f-3a108a619c84",
        "name": "Search News",
        "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
        "position": [
          1016,
          -100
        ],
        "parameters": {
          "url": "=https://newsapi.org/v2/everything?q={{ encodeURIComponent($input.cleanedQuery) }}&apiKey=\"YOURAPIKEY\"",
          "sendQuery": true,
          "parametersQuery": {
            "values": [
              {
                "name": "q"
              },
              {
                "name": "pageSize",
                "value": "3",
                "valueProvider": "fieldValue"
              },
              {
                "name": "sortBy",
                "value": "publishedAt",
                "valueProvider": "fieldValue"
              },
              {
                "name": "language",
                "value": "en",
                "valueProvider": "fieldValue"
              }
            ]
          },
          "toolDescription": "Fetches recent news articles",
          "optimizeResponse": true
        },
        "typeVersion": 1.1
      },
      {
        "id": "6d43251f-db88-45fa-be65-de368d4db408",
        "name": "Wikipedia",
        "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
        "position": [
          1136,
          -100
        ],
        "parameters": {
          "url": "=https://en.wikipedia.org/w/api.php?action=query&format=json&prop=extracts&exintro&explaintext&titles={{ $input.query ? encodeURIComponent($input.query) : encodeURIComponent($json.refined_query) }}\n\n",
          "sendQuery": true,
          "parametersQuery": {
            "values": [
              {
                "name": "action",
                "valueProvider": "modelOptional"
              },
              {
                "name": "prop",
                "value": "extracts",
                "valueProvider": "fieldValue"
              }
            ]
          },
          "toolDescription": "Fetches structured data from Wikipedia",
          "optimizeResponse": true
        },
        "typeVersion": 1.1
      },
      {
        "id": "c94b1446-82bf-47c8-8f5d-c5da9a43a7e7",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          380,
          -80
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "WLM64KJjQFXGWGWi",
            "name": "OpenAi account N8N"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "834efc04-b05f-4ddc-a8d9-b93d9c4e099a",
        "name": "Query Refiner",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          400,
          -320
        ],
        "parameters": {
          "text": "=You are a query generation expert. Based on the refined query provided, generate exactly 5 related search queries that can help broaden the research scope. Each query should focus on a different aspect of the topic (e.g., applications, challenges, recent developments, specific domains, case studies). The output must match the following JSON schema:\n{\n  \"topic\": \"The refined query\",\n  \"searchQueries\": [\"query1\", \"query2\", \"query3\", \"query4\", \"query5\"]\n}\n\nRefined Query: {{ $json.cleanedQuery}}\nExamples:\n- Refined Query: \"current trends in artificial intelligence 2025\"\n  Output: {\n    \"topic\": \"current trends in artificial intelligence 2025\",\n    \"searchQueries\": [\n      \"AI applications in healthcare 2025\",\n      \"ethical challenges of artificial intelligence 2025\",\n      \"recent developments in generative AI 2025\",\n      \"AI trends in education 2025\",\n      \"AI startup funding trends 2025\"\n    ]\n  }\n- Refined Query: \"artificial intelligence applications in healthcare diagnostics and treatment\"\n  Output: {\n    \"topic\": \"artificial intelligence applications in healthcare diagnostics and treatment\",\n    \"searchQueries\": [\n      \"AI in medical diagnostics 2025\",\n      \"artificial intelligence for personalized treatment plans\",\n      \"challenges of AI in healthcare diagnostics\",\n      \"recent studies on AI in healthcare\",\n      \"AI healthcare diagnostics case studies\"\n    ]\n  }",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.8
      },
      {
        "id": "1f83e2d8-23ee-46e2-998a-b644ea0fff3c",
        "name": "Research AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          900,
          -320
        ],
        "parameters": {
          "text": "=Perform research on the topic \n\"{{ $json.output.topic }}\"\"\n\n\nusing the following search queries: {{ $json.output.searchQueries.join(\",\") }}\n\n",
          "options": {
            "systemMessage": "=You are a research assistant named \"ResearchBot\". Your role is to perform thorough and comprehensive research based on the topic and search queries provided. Follow these steps to gather data:\n- Search the web for general information using the provided topic and queries, focusing on recent trends, developments, and applications (2024-2025).\n- Search Wikipedia for foundational knowledge about the topic to provide context.\n- Search for recent news articles (from 2024-2025) to identify current developments, announcements, and trends.\n- Search Google Scholar for academic papers (from 2020-2025) to gather scholarly insights and research findings.\n- Summarize and aggregate all findings into a structured JSON format.\n- Ensure all data is directly relevant to the topic:  {{ $json.output.topic }}.\nReturn the research findings as a raw JSON object with the following structure:\n{\n  \"introduction\": \"A detailed 4-6 sentence introduction to the topic, providing context, significance, and a brief overview of current trends.\",\n  \"summary\": \"A comprehensive 6-8 sentence summary of the key findings, covering trends, challenges, opportunities, and notable applications.\",\n  \"key_findings\": [\"A list of 8-12 specific key points or trends, each as a concise sentence. This must always be an array with at least 8 items.\"],\n  \"news_highlights\": [\"A list of 4-6 recent news headlines with sources (from 2024-2025), each in the format 'Headline - Source, Year'. This must always be an array with at least 4 items.\"],\n  \"scholarly_insights\": [\"A list of 4-6 insights from academic papers with sources (from 2020-2025), each in the format 'Insight (Author et al., Year, Journal)'. This must always be an array with at least 4 items.\"],\n  \"wikipedia_summary\": \"A detailed 4-6 sentence summary of foundational knowledge from Wikipedia, providing background and historical context on the topic.\",\n  \"sources\": [\"A list of all source URLs (at least 8-12 unique, relevant sources, including web articles, news, and academic papers). This must always be an array with at least 8 items.\"]\n}\nIf insufficient data is found for any field, perform additional searches using variations of the topic and queries to meet the minimum requirements. For example:\n- For news, search for terms like \"[topic] 2025 news\", \"[topic] recent developments\", or \"[topic] industry trends\".\n- For scholarly insights, search for \"[topic] machine learning 2020-2025\", \"[topic] applications research\", or \"[topic] ethical concerns\".\n- For sources, ensure a mix of web articles, news, and academic papers.\nDo NOT include irrelevant information or sources. Do NOT wrap the JSON in a string, an \"output\" field, or any Markdown formatting (e.g., ```json). Return only the raw JSON object.\n\n\nTopic: {{ $json.output.topic }}\nSearch Queries: {{ $json.output.searchQueries }}"
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "a53cfaac-425a-4558-a661-1042cb63599d",
        "name": "Google Search Web",
        "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
        "position": [
          1256,
          -100
        ],
        "parameters": {
          "url": "=https://www.googleapis.com/customsearch/v1?key=\"YOURAPIKEY\"={{ encodeURIComponent($input.query) }}",
          "sendQuery": true,
          "parametersQuery": {
            "values": [
              {
                "name": "num",
                "value": "5",
                "valueProvider": "fieldValue"
              }
            ]
          },
          "toolDescription": "Searches the web for a given query using Google Custom Search API",
          "optimizeResponse": true
        },
        "typeVersion": 1.1
      },
      {
        "id": "27548bf6-7f86-4e38-befb-3ad55c4d6c46",
        "name": "SerpApi",
        "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
        "position": [
          1376,
          -100
        ],
        "parameters": {
          "url": "=https://serpapi.com/search?engine=google_scholar&q={{ encodeURIComponent( $json.refined_query ) }}&api_key=\"YOURAPIKEY\"",
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "parametersQuery": {
            "values": [
              {
                "name": "num",
                "value": "3",
                "valueProvider": "fieldValue"
              }
            ]
          },
          "toolDescription": "Searches Google Scholar for academic papers",
          "optimizeResponse": true,
          "nodeCredentialType": "serpApi"
        },
        "credentials": {
          "serpApi": {
            "id": "9LoJ3XtPiLBGUI5W",
            "name": "SerpAPI account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "51c1b9be-a3e1-4a93-bb5c-bbde5919de0c",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          580,
          -80
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"output\": {\n    \"topic\": \"the best ai models 2025\",\n    \"searchQueries\": [\n      \"best AI models 2025 natural language processing\",\n      \"top AI models 2025 computer vision\",\n      \"best AI models 2025 generative AI\",\n      \"recent advancements in AI models 2025 news\",\n      \"scholarly research on AI models 2020-2025\",\n      \"ethical concerns in AI models 2025\",\n      \"AI models 2025 applications in healthcare\",\n      \"AI models 2025 trends in automation\"\n    ]\n  }\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "2d30f75e-baa0-4dd3-a0f9-cb74d7272d08",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1500,
          -320
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": " introduction, summary, key_findings, news_highlights, scholarly_insights, wikipedia_summary, sources"
        },
        "typeVersion": 1
      },
      {
        "id": "b89d5c35-64c4-4e8c-b432-c2219aba8acc",
        "name": "Input Validation",
        "type": "n8n-nodes-base.code",
        "position": [
          180,
          -320
        ],
        "parameters": {
          "jsCode": "// Validate input and prepare for processing\nconst query = $input.all()[0].json.query;\n\nif (!query || query.trim().length < 3) {\n  throw new Error('Research query must be at least 3 characters long');\n}\n\nreturn {\n  json: {\n    originalQuery: query,\n    cleanedQuery: query.trim().toLowerCase(),\n    timestamp: new Date().toISOString()\n  }\n};"
        },
        "typeVersion": 2
      },
      {
        "id": "e34f9b0e-a9ca-4011-bfee-c7845c68942b",
        "name": "Parse Research Output",
        "type": "n8n-nodes-base.code",
        "position": [
          1300,
          -320
        ],
        "parameters": {
          "jsCode": "// Get the output string from the Research AI Agent\nconst outputString = $input.first().json.output;\n\n// Parse the string into a JSON object\nconst parsedOutput = JSON.parse(outputString);\n\n// Return the parsed JSON as a single item\nreturn [{\n  json: parsedOutput\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "f4e6e449-1c56-4500-9701-623620360c83",
        "name": "Merge Split Items",
        "type": "n8n-nodes-base.code",
        "position": [
          1700,
          -320
        ],
        "parameters": {
          "jsCode": "const mergedItem = {\n  key_findings: [],\n  news_highlights: [],\n  scholarly_insights: [],\n  sources: []\n};\n\n$input.all().forEach(item => {\n  const data = item.json;\n\n  if (data.introduction) mergedItem.introduction = data.introduction;\n  if (data.summary) mergedItem.summary = data.summary;\n  if (data.wikipedia_summary) mergedItem.wikipedia_summary = data.wikipedia_summary;\n\n  if (data.key_findings) {\n    const findingsToAdd = Array.isArray(data.key_findings) ? data.key_findings : [data.key_findings];\n    mergedItem.key_findings = mergedItem.key_findings.concat(findingsToAdd);\n  }\n  if (data.news_highlights) {\n    const highlightsToAdd = Array.isArray(data.news_highlights) ? data.news_highlights : [data.news_highlights];\n    mergedItem.news_highlights = mergedItem.news_highlights.concat(highlightsToAdd);\n  }\n  if (data.scholarly_insights) {\n    const insightsToAdd = Array.isArray(data.scholarly_insights) ? data.scholarly_insights : [data.scholarly_insights];\n    mergedItem.scholarly_insights = mergedItem.scholarly_insights.concat(insightsToAdd);\n  }\n  if (data.sources) {\n    const sourcesToAdd = Array.isArray(data.sources) ? data.sources : [data.sources];\n    mergedItem.sources = mergedItem.sources.concat(sourcesToAdd);\n  }\n});\n\nreturn [{ json: mergedItem }];"
        },
        "typeVersion": 2
      },
      {
        "id": "e63a3f5d-dba7-4fc4-afa0-150e63aedbac",
        "name": "Store Research Metadata",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2100,
          -720
        ],
        "parameters": {
          "columns": {
            "value": {
              "Topic": "={{ $json.topic }}",
              "Sources": "={{ $json.sources }}",
              "Timestamp": "={{ $json.timestamp }}",
              "Search Queries": "={{ $json.searchQueries }}"
            },
            "schema": [
              {
                "id": "Topic",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Topic",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Search Queries",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Search Queries",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Sources",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Sources",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Timestamp",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Timestamp",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/196eJesF2ke3AQjoWvave51m6FltAyBFj5pvVW7wIsUA/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "196eJesF2ke3AQjoWvave51m6FltAyBFj5pvVW7wIsUA",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/196eJesF2ke3AQjoWvave51m6FltAyBFj5pvVW7wIsUA/edit?usp=drivesdk",
            "cachedResultName": "Research AI Agent Records"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "PRTItuUGXlUOvF9a",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "2501bc98-a1b4-473b-b4ac-7fd78efcb6be",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1080,
          -1200
        ],
        "parameters": {
          "color": 6,
          "width": 2900,
          "height": 1600,
          "content": "# üìã Research Report Workflow üß†üíª\n\nThis workflow generates a professional PDF research report on a given topic, sends it via Telegram, and emailsüöÄ\n\n\n---\n\n## üîç **Query Refiner**\n- **What it does**: Refines the input topic for better readability. üßπ\n- **Input**: Topic from the HTTP Request (e.g., \"the best ai models 2025\").\n- **Output**: Formatted topic (e.g., \"The Best AI Models 2025\").\n- **‚ú® Detail**: Capitalizes words and ensures \"AI\" is uppercase.\n\n---\n\n## üìä **Aggregate Research Data**\n- **What it does**: Collects research data for the topic. üìö\n- **Input**: Refined topic.\n- **Output**: Research data (introduction, summary, key findings, etc.) with a timestamp.\n- **‚è∞ Note**: The timestamp is used to date the report.\n\n---\n\n## üîó **Merge Split Items**\n- **What it does**: Combines and organizes research data into sections. üóÇÔ∏è\n- **Input**: Data from Aggregate Research Data.\n- **Output**: Structured JSON with sections like `introduction`, `key_findings`, `sources`.\n- **üìë Purpose**: Prepares data for the PDF report.\n\n---\n\n## üìù **Generate PDF HTML**\n- **What it does**: Creates an HTML template for the PDF report. üñ•Ô∏è\n- **Input**: Refined topic and research data.\n- **Output**: HTML content, file name (e.g., `research-report-the-best-ai-models-2025-2025-04-09.pdf`), and formatted date.\n- **üé® Features**:\n  - Professional styling (Helvetica, Georgia fonts, deep blue accents).\n  - Sections: Cover page, introduction, summary, key findings, etc.\n  - Escapes special characters to prevent HTML errors.\n- **‚è≥ Timestamp Fix**: Stores `rawTimestamp` and `formattedDate` (e.g., \"April 9, 2025\").\n\n---\n\n## üìÑ **Convert HTML to PDF (PDFShift)**\n- **What it does**: Converts the HTML to a PDF using the PDFShift API. üñ®Ô∏è\n- **Input**: HTML content from the previous node.\n- **Output**: JSON response with a URL to the generated PDF.\n- **üîë Requirement**: Needs a valid PDFShift API key.\n- **‚ö†Ô∏è Note**: Outputs a URL, not the PDF binary data.\n\n---\n\n## ‚¨áÔ∏è **Download PDF**\n- **What it does**: Downloads the PDF from the URL provided by PDFShift. üì•\n- **Input**: PDF URL from the Convert HTML to PDF node.\n- **Output**: Binary PDF data (MIME type: `application/pdf`, ~98 KB).\n- **üìõ File Name**: Uses the file name from the previous node (e.g., `research-report-the-best-ai-models-2025-2025-04-09.pdf`).\n\n---\n\n## üì± **Gmail/Telegram**\n- **What it does**: Sends the PDF to a Gmail/Telegram chat. üí¨\n- **Input**: PDF binary data and metadata (topic, formatted date).\n- **Output**: Sends the PDF as a document to the specified chat.\n- **üìù Caption**:"
        },
        "typeVersion": 1
      },
      {
        "id": "b2219fba-c5e5-4c0e-abf2-04a8ef60b795",
        "name": "Generate PDF HTML",
        "type": "n8n-nodes-base.code",
        "position": [
          2120,
          -320
        ],
        "parameters": {
          "jsCode": "// Function to escape HTML special characters\nfunction escapeHtml(unsafe) {\n  if (typeof unsafe !== 'string') return unsafe;\n  return unsafe\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#039;\");\n}\n\n// Get topic from Query Refiner\nconst queryRefinerData = $('Query Refiner').first().json;\nconsole.log('Debugging queryRefinerData:', JSON.stringify(queryRefinerData, null, 2));\nconst topicRaw = queryRefinerData.output?.topic || 'Untitled';\nconst topic = topicRaw.split(' ').map(word => {\n  if (word.toLowerCase() === 'ai') return 'AI';\n  return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();\n}).join(' ');\n\n// Get timestamp from Aggregate Research Data\nconst aggregateData = $input.first().json;\nconsole.log('Debugging aggregateData:', JSON.stringify(aggregateData, null, 2));\n\n// Validate and parse the timestamp\nlet rawTimestamp = aggregateData.timestamp;\nif (!rawTimestamp || isNaN(new Date(rawTimestamp))) {\n  rawTimestamp = new Date().toISOString(); // Fallback to current date if invalid\n}\nconst formattedDate = new Date(rawTimestamp).toLocaleDateString('en-US', {\n  year: 'numeric',\n  month: 'long',\n  day: 'numeric'\n});\nconsole.log('Raw timestamp:', rawTimestamp);\nconsole.log('Formatted date:', formattedDate);\n\n// Get the aggregated research data from Merge Split Items\nconst mergeSplitItems = $('Merge Split Items').first().json;\nconsole.log('Data from Merge Split Items:', JSON.stringify(mergeSplitItems, null, 2));\n\n// Use data from Merge Split Items\nconst data = {\n  topic: topic,\n  rawTimestamp: rawTimestamp, // Store the raw timestamp\n  formattedDate: formattedDate, // Store the formatted date\n  introduction: mergeSplitItems.introduction,\n  summary: mergeSplitItems.summary,\n  key_findings: mergeSplitItems.key_findings,\n  news_highlights: mergeSplitItems.news_highlights,\n  scholarly_insights: mergeSplitItems.scholarly_insights,\n  wikipedia_summary: mergeSplitItems.wikipedia_summary,\n  sources: mergeSplitItems.sources\n};\n\n// Ensure array fields are arrays, default to empty array if not\nconst keyFindings = Array.isArray(data.key_findings) ? data.key_findings : [];\nconst newsHighlights = Array.isArray(data.news_highlights) ? data.news_highlights : [];\nconst scholarlyInsights = Array.isArray(data.scholarly_insights) ? data.scholarly_insights : [];\nconst sources = Array.isArray(data.sources) ? data.sources : [];\n\n// Define the file name based on the topic\nconst fileName = `research-report-${(data.topic || 'untitled').replace(/\\s+/g, '-').toLowerCase()}-${new Date().toISOString().split('T')[0]}.pdf`;\n\n// Create an HTML template for the PDF with enhanced styling\nconst htmlContent = `\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Research Report: ${escapeHtml(data.topic)}</title>\n  <style>\n    @page {\n      size: A4;\n      margin: 0;\n      @top-center {\n        content: \"Research Report: ${escapeHtml(data.topic)}\";\n        font-family: 'Helvetica', sans-serif;\n        font-size: 10pt;\n        color: #666;\n      }\n      @bottom-right {\n        content: counter(page);\n        font-family: 'Helvetica', sans-serif;\n        font-size: 10pt;\n        color: #666;\n      }\n    }\n    body {\n      font-family: 'Helvetica', 'Arial', sans-serif;\n      margin: 0;\n      padding: 0;\n      color: #333;\n      line-height: 1.6;\n      font-size: 12pt;\n    }\n    .page-break {\n      page-break-before: always;\n    }\n    .container {\n      width: 90%;\n      max-width: 800px;\n      margin: 0 auto;\n      padding: 40px 30px;\n      background-color: #fff;\n    }\n    /* Cover Page */\n    .cover-page {\n      text-align: center;\n      padding: 100px 30px;\n      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);\n      height: 100vh;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      box-sizing: border-box;\n    }\n    .cover-page h1 {\n      font-family: 'Georgia', serif;\n      font-size: 40pt;\n      font-weight: bold;\n      color: #1a3c5e;\n      margin: 0;\n      text-transform: uppercase;\n      letter-spacing: 2px;\n    }\n    .cover-page p {\n      font-size: 14pt;\n      color: #555;\n      margin: 20px 0;\n      font-style: italic;\n    }\n    /* Header */\n    .header {\n      border-bottom: 2px solid #1a3c5e;\n      padding: 15px 0;\n      text-align: center;\n      margin-bottom: 30px;\n    }\n    .header h1 {\n      font-family: 'Georgia', serif;\n      font-size: 24pt;\n      font-weight: bold;\n      color: #1a3c5e;\n      margin: 0;\n      text-transform: uppercase;\n    }\n    .header p {\n      font-size: 10pt;\n      color: #666;\n      margin: 5px 0 0;\n      font-style: italic;\n    }\n    /* Sections */\n    .section {\n      margin: 40px 0;\n      padding-bottom: 20px;\n      border-bottom: 1px solid #e0e0e0;\n    }\n    .section:last-child {\n      border-bottom: none;\n    }\n    .section h2 {\n      font-family: 'Georgia', serif;\n      font-size: 18pt;\n      font-weight: bold;\n      color: #1a3c5e;\n      margin-bottom: 15px;\n      position: relative;\n    }\n    .section h2::after {\n      content: '';\n      position: absolute;\n      left: 0;\n      bottom: -5px;\n      width: 50px;\n      height: 2px;\n      background-color: #1a3c5e;\n    }\n    .section p {\n      font-size: 12pt;\n      margin: 0 0 15px;\n      color: #444;\n    }\n    .section ul {\n      margin: 0;\n      padding-left: 20px;\n    }\n    .section li {\n      font-size: 12pt;\n      margin: 10px 0;\n      color: #444;\n    }\n    /* Highlighted Key Findings */\n    .key-finding-highlight {\n      background-color: #f0f5fa;\n      padding: 15px;\n      border-left: 4px solid #1a3c5e;\n      margin: 10px 0;\n      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n      border-radius: 4px;\n    }\n    .key-finding-highlight span {\n      font-weight: bold;\n      color: #1a3c5e;\n    }\n    /* Sources */\n    .sources ol {\n      margin: 0;\n      padding-left: 20px;\n    }\n    .sources li {\n      font-size: 11pt;\n      margin: 8px 0;\n      word-break: break-all;\n    }\n    .sources a {\n      color: #1a73e8;\n      text-decoration: none;\n    }\n    .sources a:hover {\n      text-decoration: underline;\n    }\n    /* Footer */\n    .footer {\n      text-align: center;\n      font-size: 10pt;\n      color: #666;\n      padding: 20px 0;\n      border-top: 1px solid #e0e0e0;\n      margin-top: 40px;\n      font-style: italic;\n    }\n  </style>\n</head>\n<body>\n  <!-- Cover Page -->\n  <div class=\"cover-page\">\n    <h1>Research Report: ${escapeHtml(data.topic)}</h1>\n    <p>Generated on: ${escapeHtml(data.formattedDate)}</p>\n  </div>\n\n  <!-- Main Content -->\n  <div class=\"page-break\"></div>\n  <div class=\"container\">\n    <div class=\"header\">\n      <h1>Research Report: ${escapeHtml(data.topic)}</h1>\n      <p>Generated on: ${escapeHtml(data.formattedDate)}</p>\n    </div>\n\n    <div class=\"section\" id=\"introduction\">\n      <h2>Introduction</h2>\n      <p>${escapeHtml(data.introduction) || 'No introduction available.'}</p>\n    </div>\n\n    <div class=\"section\" id=\"summary\">\n      <h2>Summary</h2>\n      <p>${escapeHtml(data.summary) || 'No summary available.'}</p>\n    </div>\n\n    <div class=\"section\" id=\"key-findings\">\n      <h2>Key Findings</h2>\n      <ul>\n        ${keyFindings.length > 0 ? keyFindings.map((finding, index) => {\n          if (index < 3) {\n            return `<li class=\"key-finding-highlight\"><span>${escapeHtml(finding)}</span></li>`;\n          }\n          return `<li>${escapeHtml(finding)}</li>`;\n        }).join('') : '<li>No key findings available.</li>'}\n      </ul>\n    </div>\n\n    <div class=\"section\" id=\"news-highlights\">\n      <h2>News Highlights</h2>\n      <ul>\n        ${newsHighlights.length > 0 ? newsHighlights.map(highlight => `<li>${escapeHtml(highlight)}</li>`).join('') : '<li>No news highlights available.</li>'}\n      </ul>\n    </div>\n\n    <div class=\"section\" id=\"scholarly-insights\">\n      <h2>Scholarly Insights</h2>\n      <ul>\n        ${scholarlyInsights.length > 0 ? scholarlyInsights.map(insight => `<li>${escapeHtml(insight)}</li>`).join('') : '<li>No scholarly insights available.</li>'}\n      </ul>\n    </div>\n\n    <div class=\"section\" id=\"wikipedia-summary\">\n      <h2>Wikipedia Summary</h2>\n      <p>${escapeHtml(data.wikipedia_summary) || 'No Wikipedia summary available.'}</p>\n    </div>\n\n    <div class=\"section sources\" id=\"sources\">\n      <h2>Sources</h2>\n      <ol>\n        ${sources.length > 0 ? sources.map(source => `<li><a href=\"${escapeHtml(source)}\" target=\"_blank\">${escapeHtml(source)}</a></li>`).join('') : '<li>No sources available.</li>'}\n      </ol>\n    </div>\n\n    <div class=\"footer\">\n      <p>Generated by ResearchBot | ¬© 2025</p>\n    </div>\n  </div>\n</body>\n</html>\n`;\n\n// Return the HTML content and file name\nreturn [{\n  json: {\n    htmlContent: htmlContent,\n    fileName: fileName,\n    topic: data.topic,\n    rawTimestamp: data.rawTimestamp,\n    formattedDate: data.formattedDate\n  }\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "e43bd216-af6a-43a4-9432-c092e34b83ba",
        "name": "Convert HTML to PDF",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2300,
          -320
        ],
        "parameters": {
          "url": "https://api.pdfshift.io/v3/convert/pdf",
          "method": "POST",
          "options": {
            "response": {
              "response": {}
            }
          },
          "sendBody": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "=source",
                "value": "={{ $json.htmlContent }}"
              },
              {
                "name": "landscape",
                "value": "false"
              },
              {
                "name": "use_print",
                "value": "false"
              },
              {
                "name": "filename",
                "value": "={{ $json.fileName }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "authorization",
                "value": "Basic YXBpOnNrX2VhNDVmY2YxN2E1NjMxY2I1ZmQxZGVmNjJmZTY3Y2JiYjM3MjQ2N2M="
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "fef45c7d-578b-4202-b804-db4de8a3ab5f",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          1900,
          -320
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData"
        },
        "typeVersion": 1
      },
      {
        "id": "3d942072-ad3f-4d9a-a5f4-48df2d1644b4",
        "name": "Download PDF",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2500,
          -320
        ],
        "parameters": {
          "url": "={{ $json.url }}",
          "options": {
            "response": {
              "response": {}
            }
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "5763bd13-f98a-4983-b61d-72efad31f488",
        "name": "Send Research to Gmail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2820,
          0
        ],
        "webhookId": "ef2f7336-e7d4-4476-a65e-951d92138f0b",
        "parameters": {
          "sendTo": "example@gmail.com",
          "message": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Research Report: {{ $('Generate PDF HTML').item.json.topic }}</title>\n  <style>\n    body {\n      font-family: 'Arial', sans-serif;\n      color: #333;\n      line-height: 1.6;\n      background-color: #f4f4f4;\n      margin: 0;\n      padding: 0;\n    }\n    .container {\n      max-width: 600px;\n      margin: 20px auto;\n      background-color: #ffffff;\n      padding: 30px;\n      border-radius: 8px;\n      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n    }\n    .header {\n      text-align: center;\n      border-bottom: 2px solid #1a3c5e;\n      padding-bottom: 15px;\n      margin-bottom: 20px;\n    }\n    .header h1 {\n      font-size: 24px;\n      color: #1a3c5e;\n      margin: 0;\n    }\n    .content p {\n      font-size: 16px;\n      margin: 0 0 15px;\n    }\n    .content p strong {\n      color: #1a3c5e;\n    }\n    .content a {\n      color: #1a73e8;\n      text-decoration: none;\n    }\n    .content a:hover {\n      text-decoration: underline;\n    }\n    .signature {\n      margin-top: 20px;\n      font-size: 14px;\n      color: #666;\n      border-top: 1px solid #e0e0e0;\n      padding-top: 15px;\n    }\n    .signature p {\n      margin: 5px 0;\n    }\n    .footer {\n      text-align: center;\n      font-size: 12px;\n      color: #999;\n      margin-top: 20px;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"header\">\n      <h1>Research Report: {{ $('Generate PDF HTML').item.json.topic }}</h1>\n    </div>\n    <div class=\"content\">\n      <p>Dear Immanuel,</p>\n      <p>I hope this email finds you well. I am pleased to share with you a comprehensive research report on \"<strong>\n{{ $('Generate PDF HTML').item.json.topic }}</strong>\", generated on <strong>{{ $('Generate PDF HTML').item.json.formattedDate }}</strong>.</p>\n      <p>This report provides an in-depth analysis, including a detailed introduction, summary, key findings, news highlights, scholarly insights, and a Wikipedia summary, all supported by credible sources. It is designed to offer valuable insights and actionable information to support your research, decision-making, or project needs.</p>\n      <p>Please find the report attached as a PDF for your review. Should you have any questions, require further details, or wish to discuss the findings, feel free to reach out‚ÄîI‚Äôd be happy to assist.</p>\n      <p>Thank you for your interest, and I look forward to your feedback.</p>\n    </div>\n    <div class=\"signature\">\n      <p>Best regards,</p>\n      <p>Immanuel</p>\n    \n    </div>\n    <div class=\"footer\">\n      <p>Generated by Em | ¬© 2025</p>\n    </div>\n  </div>\n</body>\n</html>\n\n\n\n\n\n\n\n\n\n",
          "options": {
            "attachmentsUi": {
              "attachmentsBinary": [
                {}
              ]
            },
            "appendAttribution": false
          },
          "subject": "=Research Report: {{ $('Query Refiner').first().json.output.topic.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()).join(' ') }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "EGZrlZO8SHs37XwL",
            "name": "Gmail Email "
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "438acbf5-5609-4c89-8448-c248e5d9bcaf",
        "name": "When clicking ‚ÄòTest workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -40,
          -220
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "9545380e-e0aa-405c-9230-eb89354b6775",
        "name": "Send PDF",
        "type": "n8n-nodes-base.telegram",
        "position": [
          2800,
          -340
        ],
        "webhookId": "1b2f4bf7-8838-48db-ae75-e50c2a18b815",
        "parameters": {
          "chatId": "1274041539",
          "operation": "sendDocument",
          "binaryData": true,
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "0BctZPpJYxRsKfET",
            "name": "Telegram Airbnb A"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "0c0e336e-12f7-4fa2-b375-c3fcc6630f7e",
        "name": "Executed by Main AI Agent",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          -40,
          -420
        ],
        "parameters": {
          "inputSource": "passthrough"
        },
        "typeVersion": 1.1
      },
      {
        "id": "c12851da-98dd-4785-8dc2-844bedfd5f1e",
        "name": "Search Folder",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          2500,
          -720
        ],
        "parameters": {
          "filter": {},
          "options": {},
          "resource": "fileFolder",
          "queryString": "=name='Research Reports'"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "9wskupj06ArN8KFy",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "c8f7d2db-f5b2-4e6d-8c43-2d37e5a9306a",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          2700,
          -720
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "14231a0f-aae8-4e31-af03-b7a1da1cbc3d",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $node[\"Google Drive\"].json.length > 0 }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      }
    ],
    "active": false,
    "pinData": {
      "When clicking ‚ÄòTest workflow‚Äô": [
        {
          "json": {
            "query": "Facts about Thailand"
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "e51160d8-0107-48ec-ad91-54843134df2c",
    "connections": {
      "SerpApi": {
        "ai_tool": [
          [
            {
              "node": "Research AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Store Research Metadata",
              "type": "main",
              "index": 0
            },
            {
              "node": "Generate PDF HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Merge Split Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wikipedia": {
        "ai_tool": [
          [
            {
              "node": "Research AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Search News": {
        "ai_tool": [
          [
            {
              "node": "Research AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Download PDF": {
        "main": [
          [
            {
              "node": "Send Research to Gmail",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send PDF",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Query Refiner": {
        "main": [
          [
            {
              "node": "Research AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search Folder": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Research AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Input Validation": {
        "main": [
          [
            {
              "node": "Query Refiner",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate PDF HTML": {
        "main": [
          [
            {
              "node": "Convert HTML to PDF",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Search Web": {
        "ai_tool": [
          [
            {
              "node": "Research AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Merge Split Items": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Research AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Research AI Agent": {
        "main": [
          [
            {
              "node": "Parse Research Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Query Refiner",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Convert HTML to PDF": {
        "main": [
          [
            {
              "node": "Download PDF",
              "type": "main",
              "index": 0
            },
            {
              "node": "Search Folder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Research Output": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Research to Gmail": {
        "main": [
          []
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Query Refiner",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Executed by Main AI Agent": {
        "main": [
          []
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Input Validation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "s5rkGHiTGnf7F9PT",
    "meta": {
      "instanceId": "dd69efaf8212c74ad206700d104739d3329588a6f3f8381a46a481f34c9cc281",
      "templateCredsSetupCompleted": true
    },
    "name": "Restaurant Virtual Receptionist & Table Booking with VAPI and n8n",
    "tags": [],
    "nodes": [
      {
        "id": "aa3b9f79-7923-47df-87d8-72ceaa3f0127",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -580,
          -380
        ],
        "parameters": {
          "width": 420,
          "height": 200,
          "content": "üìù Description\n\nHandles incoming calls for the restaurant using VAPI to collect user details (name, booking time, number of people), checks table availability in a PostgreSQL database via n8n, books the table if available, sends confirmation to VAPI, and provides hotel service details via VAPI.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "0cc6d135-9098-4be1-8de3-fe027653d3d9",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -100,
          20
        ],
        "parameters": {
          "color": 3,
          "width": 780,
          "height": 280,
          "content": "                             üü¢ Availability Check Flow\n"
        },
        "typeVersion": 1
      },
      {
        "id": "511c9929-3614-4d09-b1b6-27c14ce304a7",
        "name": "Query Table Availability (Postgres)",
        "type": "n8n-nodes-base.postgres",
        "position": [
          220,
          100
        ],
        "parameters": {
          "table": {
            "__rl": true,
            "mode": "name",
            "value": "table_id"
          },
          "schema": {
            "__rl": true,
            "mode": "list",
            "value": "public"
          },
          "options": {},
          "operation": "select"
        },
        "credentials": {
          "postgres": {
            "id": "4Y4qEFGqF2krfRHZ",
            "name": "Postgres-test"
          }
        },
        "typeVersion": 2.6
      },
      {
        "id": "08671a05-f26e-477a-80ab-b6885e10dfd6",
        "name": "Respond: Availability Status (VAPI)",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          440,
          100
        ],
        "parameters": {
          "options": {},
          "respondWith": "json",
          "responseBody": "={\n    \"results\": [\n        {\n            \"toolCallId\": \"{{ $('Trigger: Booking Request (VAPI)\t').item.json.body.message.toolCalls[0].id }}\",\n            \"result\":  \"{{ $json.available }}\"\n        }\n    ]\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "3efaa272-9bdb-4db1-bb63-94ffca5a161e",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -100,
          -260
        ],
        "parameters": {
          "color": 4,
          "width": 780,
          "height": 280,
          "content": "                                 üîµ Booking Flow\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "0fbfd74a-e2a4-4666-9055-c5d588ad6cff",
        "name": "Trigger: Booking Request (VAPI)\t",
        "type": "n8n-nodes-base.webhook",
        "position": [
          0,
          100
        ],
        "webhookId": "027f0f14-93f4-42ff-90a7-715f23316a86",
        "parameters": {
          "path": "027f0f14-93f4-42ff-90a7-715f23316a86",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "13d32034-198f-4429-9515-f71275ff2333",
        "name": "Upsert Booking in Postgres\t",
        "type": "n8n-nodes-base.postgres",
        "position": [
          220,
          -160
        ],
        "parameters": {
          "table": {
            "__rl": true,
            "mode": "name",
            "value": "table_id"
          },
          "schema": {
            "__rl": true,
            "mode": "list",
            "value": "public"
          },
          "columns": {
            "value": {},
            "schema": [],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "upsert"
        },
        "credentials": {
          "postgres": {
            "id": "4Y4qEFGqF2krfRHZ",
            "name": "Postgres-test"
          }
        },
        "typeVersion": 2.6
      },
      {
        "id": "16c88128-1e44-42df-bbd3-2cd7b1c2e6b0",
        "name": "Respond: Booking Confirmation (VAPI)\t",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          440,
          -160
        ],
        "parameters": {
          "options": {},
          "respondWith": "json",
          "responseBody": "={\n    \"results\": [\n        {\n            \"toolCallId\": \"{{ $('Trigger: Booking Request (VAPI)\t1').item.json.body.message.toolCalls[0].id }}\",\n            \"result\": \"{{ $json.status }}\"\n        }\n    ]\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "ee35e567-9de8-4518-a66f-0d168a973544",
        "name": "Trigger: Booking Request (VAPI)\t1",
        "type": "n8n-nodes-base.webhook",
        "position": [
          0,
          -160
        ],
        "webhookId": "2f7eff83-2e85-45ee-b544-7f889ca3ad07",
        "parameters": {
          "path": "2f7eff83-2e85-45ee-b544-7f889ca3ad07",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "timezone": "Asia/Kolkata",
      "callerPolicy": "workflowsFromSameOwner",
      "executionOrder": "v1"
    },
    "versionId": "50da786a-d8c6-4453-9bbe-835b7b673c43",
    "connections": {
      "Upsert Booking in Postgres\t": {
        "main": [
          [
            {
              "node": "Respond: Booking Confirmation (VAPI)\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger: Booking Request (VAPI)\t": {
        "main": [
          [
            {
              "node": "Query Table Availability (Postgres)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger: Booking Request (VAPI)\t1": {
        "main": [
          [
            {
              "node": "Upsert Booking in Postgres\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Query Table Availability (Postgres)": {
        "main": [
          [
            {
              "node": "Respond: Availability Status (VAPI)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "HQsEQI9dgnQXbgkF",
    "meta": {
      "instanceId": "8443f10082278c46aa5cf3acf8ff0f70061a2c58bce76efac814b16290845177",
      "templateCredsSetupCompleted": true
    },
    "name": "Lead Nurture Drop-off Detector",
    "tags": [],
    "nodes": [
      {
        "id": "5f8b2f26-9f5d-40be-baad-51f65e9eb357",
        "name": "When clicking ‚ÄòExecute workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -832,
          -16
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "c014b22a-fc48-4f32-94e2-72e7ce3cf3f9",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -656,
          -400
        ],
        "parameters": {
          "height": 352,
          "content": "## Node Name: Fetch Contacts from HighLevel\n**Action**: Retrieves all contacts from the HighLevel CRM.\n**Description**:\nThis node connects to the HighLevel API using OAuth credentials and fetches all contacts. It pulls data such as contact names, email addresses, and other related metadata to be processed in subsequent steps.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "2fa119c2-8252-480e-b7b6-964e04100266",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -384,
          176
        ],
        "parameters": {
          "height": 272,
          "content": "## Node Name: Validate Deal Fetch Success\n**Action**: Validates if the deal fetch was successful or not.\n**Description**:\nThis node checks whether the fetched data (deal or contact) exists. If the data is invalid or missing, it logs an error or redirects to error handling.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "7c00102b-0b79-498a-b8ec-e1b9f2488392",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -48,
          608
        ],
        "parameters": {
          "height": 336,
          "content": "## Node Name: Log Errors in Google Sheets\n**Action**: Logs any errors encountered during data fetching or validation.\n**Description**:\nThis node logs any errors or issues that occur during the fetching or validation steps into a Google Sheet for auditing and future reference. It ensures that all issues are recorded for troubleshooting.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "65e796c2-8e01-4009-b900-c523a669657a",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -48,
          -400
        ],
        "parameters": {
          "height": 352,
          "content": "## Node Name: Filter Contacts with No Response\n**Action**: Filters contacts who have not responded in the last 24 hours.\n**Description**:\nThis node processes the input contacts and filters out those who have not replied to recent communications within the last 24 hours. It calculates the time difference and selects only contacts who have been inactive for a specified period.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "d1f3ba19-cfb4-4845-b628-cff0f4238c65",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          224,
          144
        ],
        "parameters": {
          "height": 336,
          "content": "## Node Name: Get Most Recent Contact\n**Action**: Retrieves the most recent contact based on the last updated date.\n**Description**:\nThis node sorts the contacts by their most recent update and selects the one with the latest activity. It also calculates the number of hours since the last update and formats it for easy communication.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "723f4c58-76e0-4cf2-ae04-88c3820e7d15",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          464,
          -352
        ],
        "parameters": {
          "height": 320,
          "content": "## Node Name: Send Follow-Up Email to Contact\n**Action**: Sends a follow-up email to a contact.\n**Description**:\nThis node sends a personalized follow-up email to the selected contact. The email asks for confirmation and offers help in case the contact has any further questions or concerns.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8ee4227f-f4b3-4bcb-a154-cf316050baef",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          720,
          160
        ],
        "parameters": {
          "height": 304,
          "content": "## Node Name: Wait for 24 Hours Before Next Action\n**Action**: Pauses the workflow for 24 hours before continuing.\n**Description**:\nThis node introduces a 24-hour delay in the workflow. It is typically used when waiting for a response or allowing some time before the next step in the automation process is triggered.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "f1211abc-1883-4c50-b75c-0a835a549ae5",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          912,
          -432
        ],
        "parameters": {
          "height": 368,
          "content": "## Node Name: Retrieve Email Thread for Response\n**Action**: Fetches the email thread based on the provided thread ID.\n**Description**:\nThis node retrieves the most recent email thread from Gmail using the thread ID. It's used for checking if the contact has responded and fetching the necessary email data for processing.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "796c98f8-270a-46e7-8f95-4b35ebce2a4d",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1152,
          144
        ],
        "parameters": {
          "height": 384,
          "content": "## Node Name: Check If Contact Responded with 'Yes'\n**Action**: Evaluates if the email response contains the word \"yes\".\n**Description**:\nThis node checks the email response content for the keyword \"yes\". If found, it signals that the contact has replied positively, triggering the appropriate follow-up action.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "01d082d9-9575-4287-af57-ec6f7b85e5e0",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1456,
          304
        ],
        "parameters": {
          "height": 400,
          "content": "## Node Name: Notify Sales Team in Slack if No Response\n**Action**: Sends a notification to Slack if no response has been received from the contact.\n**Description**:\nIf no response has been received from the contact, this node notifies the sales team via Slack. It includes relevant details such as the contact's email and follow-up status, so the team can take the next steps.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b7874a2b-ce74-4492-8623-37d0689dfbf8",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1440,
          -640
        ],
        "parameters": {
          "height": 384,
          "content": "## Node Name: Notify Sales Team in Slack if Response Received\n**Action**: Sends a notification to Slack if a response is received from the contact.\n**Description**:\nIf the contact responds positively (i.e., the email contains \"yes\"), this node notifies the sales team in Slack, highlighting the response and providing further details for the next action.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9e35ac7e-8c3c-4821-bbba-a5b5fbf3f8c8",
        "name": "Fetch Contacts from HighLevel",
        "type": "n8n-nodes-base.highLevel",
        "position": [
          -576,
          -16
        ],
        "parameters": {
          "filters": {},
          "options": {},
          "operation": "getAll",
          "requestOptions": {}
        },
        "credentials": {
          "highLevelOAuth2Api": {
            "id": "5QWHSi134dLIBEsC",
            "name": "HighLevel account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "7fdab81f-d78c-4ed3-887b-d28092afde3a",
        "name": "Validate Deal Fetch Success",
        "type": "n8n-nodes-base.if",
        "position": [
          -304,
          -16
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "e2adb005-2b3c-4d1e-8445-442df1fe925a",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.id }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "8ef5a95b-518d-42e9-9cf1-d0f84232f8e0",
        "name": "Log Errors in Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          16,
          416
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "error_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "error_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "error",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "error",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "error_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1338537721,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Uldk_4BxWbdZTDZxFUeohIfeBmGHHqVEl9Ogb0l6R8Y/edit#gid=1338537721",
            "cachedResultName": "error log sheet"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1Uldk_4BxWbdZTDZxFUeohIfeBmGHHqVEl9Ogb0l6R8Y",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Uldk_4BxWbdZTDZxFUeohIfeBmGHHqVEl9Ogb0l6R8Y/edit?usp=drivesdk",
            "cachedResultName": "Interviewer Brief Pack "
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "kpPEOLCGn963qpoh",
            "name": "automations@techdome.ai"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "6285af42-d462-460d-90dc-853899d8486d",
        "name": "Filter Contacts with No Response",
        "type": "n8n-nodes-base.code",
        "position": [
          32,
          -16
        ],
        "parameters": {
          "jsCode": "// Get all contacts from the input\nconst contacts = $input.all().map(item => item.json);\n\n// Get the current date and time\nconst now = new Date();\n\n// Filter contacts with no response in the last 24 hours\nconst contactsWithNoResponse = contacts.filter(contact => {\n  const lastResponseTime = new Date(contact.dateUpdated);\n\n  // Calculate the time difference in hours\n  const timeDiff = now - lastResponseTime; \n  const timeDiffInHours = timeDiff / (1000 * 60 * 60);\n\n  // Check if no response in the last 24 hours\n  return timeDiffInHours >= 24; \n});\n\n// Return the filtered contacts as separate items\nreturn contactsWithNoResponse.map(contact => ({\n  json: contact\n}));"
        },
        "typeVersion": 2
      },
      {
        "id": "971be9a4-415a-4fca-8a70-ed7d528f4d72",
        "name": "Get Most Recent Contact",
        "type": "n8n-nodes-base.code",
        "position": [
          288,
          -16
        ],
        "parameters": {
          "jsCode": "// Get all contacts from the input\nconst contacts = $input.all().map(item => item.json);\n\n// Sort contacts by dateUpdated (most recent first)\nconst sortedContacts = contacts.sort((a, b) => {\n  return new Date(b.dateUpdated) - new Date(a.dateUpdated);\n});\n\n// Get the most recent contact\nconst mostRecentContact = sortedContacts[0];\n\n// Calculate hours ago\nconst now = new Date();\nconst lastUpdated = new Date(mostRecentContact.dateUpdated);\nconst timeDiff = now - lastUpdated;\nconst hoursAgo = Math.floor(timeDiff / (1000 * 60 * 60));\n\n// Format the output\nconst formattedOutput = `${mostRecentContact.contactName} (${mostRecentContact.email || 'no email'}) - \\`dateUpdated: \"${mostRecentContact.dateUpdated}\"\\`\n* That's ~${hoursAgo} hours ago ‚úÖ`;\n\n// Return the formatted output\nreturn [\n  {\n    json: {\n      mostRecentContact: mostRecentContact,\n      formattedOutput: formattedOutput,\n      hoursAgo: hoursAgo,\n      contactName: mostRecentContact.contactName,\n      email: mostRecentContact.email,\n      dateUpdated: mostRecentContact.dateUpdated\n    }\n  }\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "e70e4622-1756-4e65-a5a2-13ba657be75f",
        "name": "Send Follow-Up Email to Contact",
        "type": "n8n-nodes-base.gmail",
        "position": [
          544,
          -16
        ],
        "webhookId": "0c82c299-6938-42ed-bda6-5007d79af34f",
        "parameters": {
          "sendTo": "=newscctv22@gmail.com",
          "message": "=<p>Hi {{ $json.firstName || $json.contactName }},</p>\n\n<p>I hope this email finds you well!</p>\n\n<p>I wanted to follow up with you as I noticed we haven't heard back from you in the last {{ $json.hoursAgo }} hours (since {{ $json.dateUpdated }}).</p>\n\n<p>Just checking in to see if you had any questions or if there's anything I can help you with?</p>\n\n<p>Looking forward to hearing from you! Replay to \" yes \" to confirm your Availability</p>\n\n<p>Best regards,<br>\nYour Team</p>",
          "options": {},
          "subject": "=Just Checking In - {{ $json.contactName }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "RchiXdmY8WaQhOSJ",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "a41f8e94-b84f-45e4-a968-f3f865b0ec09",
        "name": "Wait for 24 Hours Before Next Action",
        "type": "n8n-nodes-base.wait",
        "position": [
          784,
          -16
        ],
        "webhookId": "7475fece-4562-46b3-a702-7a5c5fe88266",
        "parameters": {
          "amount": 42
        },
        "typeVersion": 1
      },
      {
        "id": "cfe934cb-4747-4162-a4c0-e130d013e172",
        "name": "Retrieve Email Thread for Response",
        "type": "n8n-nodes-base.gmail",
        "position": [
          992,
          -16
        ],
        "webhookId": "ffb3a844-8c8b-4f17-a6e9-98e0371f4214",
        "parameters": {
          "options": {},
          "resource": "thread",
          "threadId": "={{ $json.threadId }}",
          "operation": "get"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "RchiXdmY8WaQhOSJ",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "f9c94301-54c7-40e8-b5c0-75146fa7dab1",
        "name": "Check If Contact Responded with 'Yes'",
        "type": "n8n-nodes-base.if",
        "position": [
          1200,
          -16
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "4a6d1310-29be-4559-8bea-afe8fe0f0f30",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $json.messages[1].snippet }}",
                "rightValue": "yes"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "d254c041-3f7e-4c12-9df5-7a996c97f938",
        "name": "Notify Sales Team in Slack if No Response",
        "type": "n8n-nodes-base.slack",
        "position": [
          1520,
          128
        ],
        "webhookId": "ddaa7632-9e35-4bd3-82d6-572d5cae84cc",
        "parameters": {
          "text": "=‚ö†Ô∏è *No Response Yet - Follow-up Sent*\n\n*Contact:* {{ $json.messages[0].Subject.replace('Just Checking In - ', '') }}\n*Email:* {{ $json.messages[0].To }}\n\n*Follow-up Sent:* {{ new Date($json.messages[0].internalDate).toLocaleString() }}\n*Message:* {{ $json.messages[0].snippet }}\n\n‚è≥ Waiting for response... Consider next follow-up action.",
          "user": {
            "__rl": true,
            "mode": "list",
            "value": "U09HMPVD466",
            "cachedResultName": "newscctv22"
          },
          "select": "user",
          "otherOptions": {}
        },
        "credentials": {
          "slackApi": {
            "id": "rNqvWj9TfChPVRYY",
            "name": "Slack account vivek"
          }
        },
        "typeVersion": 2.3
      },
      {
        "id": "a1659ee2-859a-4540-9470-3d0b5a464dbe",
        "name": "Notify Sales Team in Slack if Response Received",
        "type": "n8n-nodes-base.slack",
        "position": [
          1520,
          -224
        ],
        "webhookId": "ddaa7632-9e35-4bd3-82d6-572d5cae84cc",
        "parameters": {
          "text": "=üéâ *Great News! We Got a Response!*\n\n*Contact:* {{ $json.messages[0].Subject.replace('Just Checking In - ', '') }}\n*Email:* {{ $json.messages[0].To }}\n\n*Their Response:*\n> {{ $json.messages[1].snippet }}\n‚úÖ Follow-up was successful! Time to take next action.",
          "user": {
            "__rl": true,
            "mode": "list",
            "value": "U09HMPVD466",
            "cachedResultName": "newscctv22"
          },
          "select": "user",
          "otherOptions": {}
        },
        "credentials": {
          "slackApi": {
            "id": "rNqvWj9TfChPVRYY",
            "name": "Slack account vivek"
          }
        },
        "typeVersion": 2.3
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "6b99bb1c-a693-4c09-abd4-9bd98bb6cb3e",
    "connections": {
      "Get Most Recent Contact": {
        "main": [
          [
            {
              "node": "Send Follow-Up Email to Contact",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Validate Deal Fetch Success": {
        "main": [
          [
            {
              "node": "Filter Contacts with No Response",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Log Errors in Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Contacts from HighLevel": {
        "main": [
          [
            {
              "node": "Validate Deal Fetch Success",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Follow-Up Email to Contact": {
        "main": [
          [
            {
              "node": "Wait for 24 Hours Before Next Action",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter Contacts with No Response": {
        "main": [
          [
            {
              "node": "Get Most Recent Contact",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Retrieve Email Thread for Response": {
        "main": [
          [
            {
              "node": "Check If Contact Responded with 'Yes'",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for 24 Hours Before Next Action": {
        "main": [
          [
            {
              "node": "Retrieve Email Thread for Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòExecute workflow‚Äô": {
        "main": [
          [
            {
              "node": "Fetch Contacts from HighLevel",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check If Contact Responded with 'Yes'": {
        "main": [
          [
            {
              "node": "Notify Sales Team in Slack if Response Received",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Notify Sales Team in Slack if No Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "10DIaOOdZ9QBUom9",
    "meta": {
      "instanceId": "8443f10082278c46aa5cf3acf8ff0f70061a2c58bce76efac814b16290845177",
      "templateCredsSetupCompleted": true
    },
    "name": "Sales Rep Performance Tracker",
    "tags": [],
    "nodes": [
      {
        "id": "e4b514d1-ceed-4308-bf24-a94abc9a01fc",
        "name": "When clicking ‚ÄòExecute workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -736,
          -128
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "78510025-3729-4ff7-8349-a26ef82e1db1",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -544,
          -688
        ],
        "parameters": {
          "height": 528,
          "content": "## üì¶ Fetch All Deals from HighLevel CRM\n**Action:**  \n- Retrieves all opportunities (deals) from the connected HighLevel CRM.  \n\n**Description:**  \n- Uses `getAll` operation to pull unlimited deal records.  \n- Captures key fields for performance tracking:  \n  - Deal name, stage, assigned rep, value, client/company name, and update date.  \n- Provides the raw dataset for later data cleaning and aggregation.  \n- Ensures every deal is included for accurate sales metrics.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b92239c9-9f54-4efc-9e9c-874bf8f66759",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -256,
          32
        ],
        "parameters": {
          "height": 384,
          "content": "## üîç Validate Deal Fetch Success (IF Node)\n**Action:**  \nChecks if the fetched deal records contain valid IDs.  \n\n**Description:**  \nActs as a validation gate to ensure data integrity.  \nIf `deal_id` is present ‚Üí continue to processing.  \nIf missing or empty ‚Üí trigger the error logging branch.  \nPrevents downstream errors by stopping invalid data early.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "5e0496ef-bb97-44fa-8df4-ed773f3e7eb9",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          64,
          496
        ],
        "parameters": {
          "height": 448,
          "content": "## üö® Log Fetch or Validation Errors (Error Handling Node)\n**Action:**  \nAppends failed records or errors into a Google Sheets error log.  \n\n**Description:**  \nLogs all failed deal records for manual review or debugging.  \nEach log includes `error_id` and `error` details for traceability.  \nProvides a centralized view of all CRM fetch or data validation issues.  \nHelps maintain clean and reliable automation flow.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8f2b9f85-8750-4d8b-bba2-cb240a4954fe",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1056,
          400
        ],
        "parameters": {
          "height": 432,
          "content": "## üß† GPT-4o Model Configuration\n**Action:**  \n- Configures GPT-4o (Azure OpenAI) model for language generation.  \n\n**Description:**  \n- Defines system role for generating short, friendly, motivational messages.  \n- Ensures tone consistency and optimized token usage.  \n- Connects to downstream LangChain AI Agent node for contextual outputs.  \n- Enables scalable and automated message generation via OpenAI.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "db313017-c7f5-4671-b994-c56e75d006ae",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          672,
          -912
        ],
        "parameters": {
          "height": 544,
          "content": "## üßæ Generate Notion Performance Dashboard\n**Action:**  \n- Creates a personalized performance page for each rep in Notion.  \n\n**Description:**  \n- Generates a Notion page titled ‚Äú{rep_id} - Sales Rep Performance Tracker‚Äù.  \n- Includes performance stats, motivational summary, and leaderboard context:  \n  - Total deals, total value, deals won, average value.  \n- Explains business value: transparent visibility ‚Üí healthy competition.  \n- Refreshes daily for up-to-date tracking and motivation.  \n"
        },
        "typeVersion": 1
      },
      {
        "id": "08277d6f-c97f-46dd-ace1-8dc01a2ef297",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          624,
          176
        ],
        "parameters": {
          "height": 416,
          "content": "## ‚öôÔ∏è Transform Data for AI Input\n**Action:**  \n- Prepares formatted JSON data for AI-based Slack message generation.  \n\n**Description:**  \n- Collects summarized data per rep and flattens it for GPT input.  \n- Returns each record as an individual AI-friendly item.  \n- Ensures smooth handoff to GPT node for text generation.  \n- Critical for maintaining consistency between stats and motivational messages.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9518f7ae-ea95-44e1-af79-291151d1124a",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1168,
          -624
        ],
        "parameters": {
          "height": 544,
          "content": "## ü§ñ AI-Generated Motivational Slack Messages\n**Action:**  \n- Uses GPT-4o via LangChain to create custom Slack messages per rep.  \n\n**Description:**  \n- Takes summarized performance data and crafts 2‚Äì3 line motivational blurbs.  \n- Includes emojis üéØüî•üí™ for energy and tone.  \n- Mentions rep_id and highlights achievements positively.  \n- Keeps output concise for Slack readability.  \n- Human-like, encouraging messages improve team morale and competition.  \n"
        },
        "typeVersion": 1
      },
      {
        "id": "e052b33a-3d29-4eb1-aa8a-f497c121d9d1",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1472,
          192
        ],
        "parameters": {
          "height": 464,
          "content": "## üí¨ Notify Sales Team in Slack\n**Action:**  \n- Sends AI-generated motivational summaries to the Slack channel or user.  \n\n**Description:**  \n- Posts formatted messages directly in Slack via Slack API.  \n- Targets specific user or sales channel for transparency.  \n- Reinforces accountability and recognition.  \n- Builds engagement and team motivation with daily leaderboard updates.  \n"
        },
        "typeVersion": 1
      },
      {
        "id": "6956ad52-fc95-43b7-8194-fd952b56aea9",
        "name": "Fetch All Deals from HighLevel CRM",
        "type": "n8n-nodes-base.highLevel",
        "position": [
          -464,
          -128
        ],
        "parameters": {
          "filters": {},
          "resource": "opportunity",
          "operation": "getAll",
          "requestOptions": {}
        },
        "credentials": {
          "highLevelOAuth2Api": {
            "id": "5QWHSi134dLIBEsC",
            "name": "HighLevel account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "bad87d8a-9bf2-4194-995f-2619a222975f",
        "name": " Validate Deal Fetch Success",
        "type": "n8n-nodes-base.if",
        "position": [
          -192,
          -128
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "e2adb005-2b3c-4d1e-8445-442df1fe925a",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.id }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "8c390668-b627-4943-8d4a-adc0c6f84cd9",
        "name": " Log Fetch or Validation Errors ",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          128,
          320
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "error_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "error_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "error",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "error",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "error_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1338537721,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Uldk_4BxWbdZTDZxFUeohIfeBmGHHqVEl9Ogb0l6R8Y/edit#gid=1338537721",
            "cachedResultName": "error log sheet"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1Uldk_4BxWbdZTDZxFUeohIfeBmGHHqVEl9Ogb0l6R8Y",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Uldk_4BxWbdZTDZxFUeohIfeBmGHHqVEl9Ogb0l6R8Y/edit?usp=drivesdk",
            "cachedResultName": "Interviewer Brief Pack "
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "kpPEOLCGn963qpoh",
            "name": "automations@techdome.ai"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "616feb11-a8c0-4955-9202-ed1a12e34208",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          32,
          -704
        ],
        "parameters": {
          "height": 544,
          "content": "## üßπ Clean & Structure Deal Data\n**Action:**  \n- Transforms raw CRM data into clean, structured records.  \n\n**Description:**  \n- Extracts and normalizes key fields into a consistent schema:  \n  - Deal ID, Rep ID, Client Name, Status, Stage ID, Value, Updated At.  \n- Removes nulls and handles missing data (e.g., ‚ÄúUnassigned‚Äù, ‚ÄúUnknown‚Äù).  \n- Prepares the dataset for further analysis and grouping by rep.  \n- Simplifies the JSON format for easy downstream processing.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c205c167-2333-43a9-a80b-43ebd068559d",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          304,
          -672
        ],
        "parameters": {
          "height": 512,
          "content": "## üìä Summarize Sales by Representative\n**Action:**  \n- Aggregates deal-level data into performance summaries per sales rep.  \n\n**Description:**  \n- Groups deals by `rep_id` and computes:  \n  - Total deals handled  \n  - Total deal value  \n  - Total won deals  \n  - Average deal value per rep  \n- Provides a summarized dataset for leaderboard and performance visualization.  \n- Enables tracking of who‚Äôs closing deals effectively and who needs support.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "eda6d196-9842-46f0-b077-31ab9ccd40fd",
        "name": "Clean & Structure Deal Data",
        "type": "n8n-nodes-base.code",
        "position": [
          128,
          -128
        ],
        "parameters": {
          "jsCode": "const deals = $input.all().map(i => i.json);\n\nconst cleaned = deals.map(d => ({\n  deal_id: d.id,\n  deal_name: d.name,\n  rep_id: d.assignedTo || \"Unassigned\",\n  status: d.status,\n  stage_id: d.pipelineStageId,\n  value: d.monetaryValue || 0,\n  client_name: d.relations?.[0]?.contactName || \"Unknown\",\n  company_name: d.relations?.[0]?.companyName || \"\",\n  updated_at: d.updatedAt\n}));\n\nreturn cleaned.map(c => ({ json: c }));\n"
        },
        "typeVersion": 2
      },
      {
        "id": "de0e86ce-8d99-40bb-8e9a-a25773785f72",
        "name": " Summarize Sales by Representative",
        "type": "n8n-nodes-base.code",
        "position": [
          368,
          -128
        ],
        "parameters": {
          "jsCode": "const deals = $input.all().map(i => i.json);\n\n// Object to hold totals per rep\nconst summary = {};\n\nfor (const d of deals) {\n  const rep = d.rep_id || \"Unassigned\";\n  if (!summary[rep]) {\n    summary[rep] = {\n      rep_id: rep,\n      total_deals: 0,\n      total_value: 0,\n      won_deals: 0,\n    };\n  }\n\n  summary[rep].total_deals += 1;\n  summary[rep].total_value += d.value || 0;\n\n  // If your GHL marks won deals as 'won' or similar\n  if (d.status && d.status.toLowerCase().includes(\"won\")) {\n    summary[rep].won_deals += 1;\n  }\n}\n\n// Convert to array for output\nreturn Object.values(summary).map(rep => ({\n  json: {\n    rep_id: rep.rep_id,\n    total_deals: rep.total_deals,\n    total_value: rep.total_value,\n    won_deals: rep.won_deals,\n    avg_value: rep.total_value / rep.total_deals,\n  },\n}));\n"
        },
        "typeVersion": 2
      },
      {
        "id": "4014211b-b50d-46d2-a0dc-dba3e3bb7766",
        "name": "Generate Notion Performance Dashboard",
        "type": "n8n-nodes-base.notion",
        "position": [
          752,
          -336
        ],
        "parameters": {
          "title": "={{ $json[\"rep_id\"] }} - Sales Rep Performance Tracker\n",
          "pageId": {
            "__rl": true,
            "mode": "id",
            "value": "265802b91fa080f69fffd0fc1daffe3d"
          },
          "simple": false,
          "blockUi": {
            "blockValues": [
              {
                "text": {
                  "text": [
                    {
                      "text": "={{ $json[\"rep_id\"] }} - Sales Rep Performance Tracker\n",
                      "annotationUi": {}
                    }
                  ]
                },
                "type": "heading_1",
                "richText": true
              },
              {
                "textContent": "=üëã Hello {{$json[\"rep_id\"]}}, here‚Äôs your latest performance update! üéâ  \n\n**Sales Rep Performance Tracker**  \nüîé **Problem:** No visibility into which rep is actually performing well.  \n‚úÖ **Solution:** Track your daily performance, updated every midnight.\n\nHere‚Äôs your performance summary for today:  \n- üìä **Total Deals:** {{$json[\"total_deals\"]}}  \n- üí∞ **Total Value:** {{$json[\"total_value\"]}}  \n- üèÜ **Deals Won:** {{$json[\"won_deals\"]}}  \n- üìà **Average Deal Value:** {{$json[\"avg_value\"]}}\n\nüìÖ **Next Update:** The leaderboard will be refreshed every day at midnight to show your ranking alongside your peers.  \n\n**Value:** Transparent performance insights ‚Üí healthy competition ‚Üí better accountability.  \n\nKeep up the great work and aim for the top! üöÄ  \nStatus: *Ongoing* |"
              }
            ]
          },
          "options": {}
        },
        "credentials": {
          "notionApi": {
            "id": "iDjtgSTYG9ECVBtT",
            "name": "Notion account 2"
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "4c6b43f1-6397-46df-b4e2-880fb400dcb9",
        "name": " Transform Data for AI Input",
        "type": "n8n-nodes-base.code",
        "position": [
          704,
          0
        ],
        "parameters": {
          "jsCode": "// Collect all incoming data\nconst allData = items.map(item => item.json);\n\n// Transform and flatten the structure\nconst formattedData = allData.map(item => ({\n  rep_id: item.rep_id,\n  total_deals: item.total_deals,\n  total_value: item.total_value,\n  won_deals: item.won_deals,\n  avg_value: item.avg_value\n}));\n\n// Return each record as a separate item (AI node-friendly)\nreturn formattedData.map(data => ({ json: data }));\n"
        },
        "typeVersion": 2
      },
      {
        "id": "891ba41f-f222-4a41-b557-14808b3fabc4",
        "name": "GPT-4o Model Configuration",
        "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
        "position": [
          1072,
          224
        ],
        "parameters": {
          "model": "gpt-4o",
          "options": {}
        },
        "credentials": {
          "azureOpenAiApi": {
            "id": "C3WzT18XqF8OdVM6",
            "name": "Azure Open AI account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e676ef5c-e9f9-4b2b-b6b7-8a52b8b91179",
        "name": " AI-Generated Motivational Slack Messages",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1088,
          0
        ],
        "parameters": {
          "text": "=Generate a motivational Slack message for the following sales reps based on their performance data:\n\n{{JSON.stringify($json)}}\n\nFormat it like this:\n- Use emojis üéØüî•üí™ for motivation\n- Mention each rep_id and highlight their performance briefly\n- Keep it under 2‚Äì3 lines per rep\n",
          "options": {
            "systemMessage": "=You are a motivational message generator for a sales team. \nYou will receive sales rep data including total deals, total value, won deals, and average deal value.\nUse this data to create short, positive, and personalized motivational messages suitable for posting in Slack. \nKeep it friendly, energetic, and relevant to the rep‚Äôs performance.\n"
          },
          "promptType": "define"
        },
        "typeVersion": 2.1
      },
      {
        "id": "45ff779d-dc4e-4a83-bcfc-5197aecdc91f",
        "name": "Notify Sales Team in Slack",
        "type": "n8n-nodes-base.slack",
        "position": [
          1520,
          0
        ],
        "webhookId": "ddaa7632-9e35-4bd3-82d6-572d5cae84cc",
        "parameters": {
          "text": "={{ $json.output }}",
          "user": {
            "__rl": true,
            "mode": "list",
            "value": "U09HMPVD466",
            "cachedResultName": "newscctv22"
          },
          "select": "user",
          "otherOptions": {}
        },
        "credentials": {
          "slackApi": {
            "id": "rNqvWj9TfChPVRYY",
            "name": "Slack account vivek"
          }
        },
        "typeVersion": 2.3
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "d7102749-1f49-4575-a6cc-b80eb1664bbe",
    "connections": {
      "GPT-4o Model Configuration": {
        "ai_languageModel": [
          [
            {
              "node": " AI-Generated Motivational Slack Messages",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Clean & Structure Deal Data": {
        "main": [
          [
            {
              "node": " Summarize Sales by Representative",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Transform Data for AI Input": {
        "main": [
          [
            {
              "node": " AI-Generated Motivational Slack Messages",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Validate Deal Fetch Success": {
        "main": [
          [
            {
              "node": "Clean & Structure Deal Data",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": " Log Fetch or Validation Errors ",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Summarize Sales by Representative": {
        "main": [
          [
            {
              "node": "Generate Notion Performance Dashboard",
              "type": "main",
              "index": 0
            },
            {
              "node": " Transform Data for AI Input",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch All Deals from HighLevel CRM": {
        "main": [
          [
            {
              "node": " Validate Deal Fetch Success",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòExecute workflow‚Äô": {
        "main": [
          [
            {
              "node": "Fetch All Deals from HighLevel CRM",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " AI-Generated Motivational Slack Messages": {
        "main": [
          [
            {
              "node": "Notify Sales Team in Slack",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "0KZs18Ti2KXKoLIr",
    "meta": {
      "instanceId": "31e69f7f4a77bf465b805824e303232f0227212ae922d12133a0f96ffeab4fef",
      "templateCredsSetupCompleted": true
    },
    "name": "‚ú®ü©∑Automated Social Media Content Publishing Factory + System Prompt Composition",
    "tags": [],
    "nodes": [
      {
        "id": "74fb48a6-1acd-4693-9b8e-39b36c5649a9",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -520,
          -2080
        ],
        "webhookId": "faddb40a-7048-4398-a0f9-d239a19c32ce",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "09f4a998-2d69-4683-9251-2694a77efeba",
        "name": "Sticky Note20",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -600,
          -1720
        ],
        "parameters": {
          "color": 7,
          "height": 240,
          "content": "## LLM"
        },
        "typeVersion": 1
      },
      {
        "id": "03b93e0b-a917-41f6-b99e-5a27ad07cd3e",
        "name": "Sticky Note21",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -600,
          -1460
        ],
        "parameters": {
          "color": 7,
          "height": 240,
          "content": "## Chat Memory"
        },
        "typeVersion": 1
      },
      {
        "id": "b6c61fe5-a519-4bdb-8641-3149362fbb54",
        "name": "Sticky Note22",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -620,
          -2160
        ],
        "parameters": {
          "color": 4,
          "width": 300,
          "height": 280,
          "content": "## üëçStart Here"
        },
        "typeVersion": 1
      },
      {
        "id": "2cf0448a-76de-4b2c-a200-953d47e29a52",
        "name": "Sticky Note32",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1980,
          -2000
        ],
        "parameters": {
          "color": 2,
          "width": 340,
          "height": 420,
          "content": "## Social Media Publishing Router"
        },
        "typeVersion": 1
      },
      {
        "id": "dff757e6-8ef4-4479-a9f8-71cb814fb8ef",
        "name": "Sticky Note33",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -300,
          -1640
        ],
        "parameters": {
          "color": 6,
          "height": 240,
          "content": "## 1Ô∏è‚É£ X - Twitter"
        },
        "typeVersion": 1
      },
      {
        "id": "fda64627-952a-4be9-b4c5-799d8c7801ad",
        "name": "X-Twiter",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          -220,
          -1540
        ],
        "parameters": {
          "name": "create_x_twitter_posts_tool",
          "fields": {
            "values": [
              {
                "name": "route",
                "stringValue": "=xtwitter"
              },
              {
                "name": "user_prompt",
                "stringValue": "={{ $('When chat message received').item.json.chatInput }}"
              }
            ]
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Use this tool to create XTwitter posts",
          "jsonSchemaExample": ""
        },
        "typeVersion": 1.2
      },
      {
        "id": "5023b0b3-468b-4cbb-829c-e06aaf822b99",
        "name": "Sticky Note34",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -40,
          -1640
        ],
        "parameters": {
          "color": 6,
          "height": 240,
          "content": "## 2Ô∏è‚É£ Instagram"
        },
        "typeVersion": 1
      },
      {
        "id": "781df8c5-0b06-42a4-bbe9-6948ae345599",
        "name": "Instagram",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          40,
          -1540
        ],
        "parameters": {
          "name": "create_instagram_posts_tool",
          "fields": {
            "values": [
              {
                "name": "route",
                "stringValue": "=instagram"
              },
              {
                "name": "user_prompt",
                "stringValue": "={{ $('When chat message received').item.json.chatInput }}"
              }
            ]
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Use this tool to create Instagram posts",
          "jsonSchemaExample": ""
        },
        "typeVersion": 1.2
      },
      {
        "id": "8687d1ff-06ee-44c7-a26e-f08da72bbd15",
        "name": "Window Buffer Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          -520,
          -1360
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "30cbcc50-e19b-43ea-8f0a-5e2021dc5e48",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          -700,
          -560
        ],
        "parameters": {
          "workflowInputs": {
            "values": [
              {
                "name": "user_prompt"
              },
              {
                "name": "route"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "0b9b7f07-d603-4890-96b0-f815feb38185",
        "name": "Sticky Note35",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          220,
          -1640
        ],
        "parameters": {
          "color": 6,
          "height": 240,
          "content": "## 3Ô∏è‚É£ Facebook"
        },
        "typeVersion": 1
      },
      {
        "id": "12b17b82-8f98-4d80-9b49-aa9860827e01",
        "name": "Sticky Note36",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          480,
          -1640
        ],
        "parameters": {
          "color": 6,
          "height": 240,
          "content": "## 4Ô∏è‚É£ LinkedIn"
        },
        "typeVersion": 1
      },
      {
        "id": "71dc9ccf-3691-4c0d-b53b-f3ff10f382a9",
        "name": "Facebook",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          300,
          -1540
        ],
        "parameters": {
          "name": "create_facebook_posts_tool",
          "fields": {
            "values": [
              {
                "name": "route",
                "stringValue": "=facebook"
              },
              {
                "name": "user_prompt",
                "stringValue": "={{ $('When chat message received').item.json.chatInput }}"
              }
            ]
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Use this tool to create Facebook posts",
          "jsonSchemaExample": ""
        },
        "typeVersion": 1.2
      },
      {
        "id": "f953cd87-88a8-451f-841e-78227949b64d",
        "name": "LinkedIn",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          560,
          -1540
        ],
        "parameters": {
          "name": "create_linkedin_posts_tool",
          "fields": {
            "values": [
              {
                "name": "route",
                "stringValue": "=linkedin"
              },
              {
                "name": "user_prompt",
                "stringValue": "={{ $('When chat message received').item.json.chatInput }}"
              }
            ]
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Use this tool to create LinkedIn posts",
          "jsonSchemaExample": ""
        },
        "typeVersion": 1.2
      },
      {
        "id": "97b6829d-6c9d-410a-8fa0-d89d884fd76e",
        "name": "Sticky Note37",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -40,
          -1380
        ],
        "parameters": {
          "color": 6,
          "height": 240,
          "content": "## 5Ô∏è‚É£Threads"
        },
        "typeVersion": 1
      },
      {
        "id": "463259f7-71b4-492f-b05a-d1a958917d5c",
        "name": "Sticky Note38",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          220,
          -1380
        ],
        "parameters": {
          "color": 6,
          "height": 240,
          "content": "## 6Ô∏è‚É£YouTube Shorts"
        },
        "typeVersion": 1
      },
      {
        "id": "0cd9003b-8eeb-4e4a-9f1f-5f6b611d5194",
        "name": "Short",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          40,
          -1280
        ],
        "parameters": {
          "name": "create_threads_posts_tool",
          "fields": {
            "values": [
              {
                "name": "route",
                "stringValue": "=threads"
              },
              {
                "name": "user_prompt",
                "stringValue": "={{ $('When chat message received').item.json.chatInput }}"
              }
            ]
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Use this tool to create Threads posts",
          "jsonSchemaExample": ""
        },
        "typeVersion": 1.2
      },
      {
        "id": "54c2bf4b-8053-4e9d-beb4-570db66f9bd4",
        "name": "YouTube Short",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          300,
          -1280
        ],
        "parameters": {
          "name": "create_youtube_short_tool",
          "fields": {
            "values": [
              {
                "name": "route",
                "stringValue": "=youtube_short"
              },
              {
                "name": "user_prompt",
                "stringValue": "={{ $('When chat message received').item.json.chatInput }}"
              },
              {
                "name": "llm",
                "stringValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Value', ``, 'string') }}"
              }
            ]
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Use this tool to create a YouTube short",
          "jsonSchemaExample": ""
        },
        "typeVersion": 1.2
      },
      {
        "id": "a72c3242-3a8b-444f-9623-fbcb0b47a817",
        "name": "Sticky Note18",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -340,
          -1720
        ],
        "parameters": {
          "color": 7,
          "width": 1100,
          "height": 620,
          "content": "## Social Media Agent Tools"
        },
        "typeVersion": 1
      },
      {
        "id": "586a33ae-3546-4b31-9235-9a8fcfd28598",
        "name": "Sticky Note25",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -500,
          -940
        ],
        "parameters": {
          "color": 6,
          "width": 3520,
          "height": 820,
          "content": "# üè≠Social Media Content Factory"
        },
        "typeVersion": 1
      },
      {
        "id": "153da903-fcd3-4694-aaa4-bef2b300d158",
        "name": "pollinations.ai1",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueErrorOutput",
        "maxTries": 5,
        "position": [
          1440,
          -560
        ],
        "parameters": {
          "url": "=https://image.pollinations.ai/prompt/{{ $json.output.common_schema.image_suggestion.replaceAll(' ','-').replaceAll(',','').replaceAll('.','').slice(0,100) }}",
          "options": {}
        },
        "retryOnFail": true,
        "typeVersion": 4.2
      },
      {
        "id": "6c114f0b-1395-4fe6-8de7-0b3d0d9fd6b2",
        "name": "Sticky Note26",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1340,
          -720
        ],
        "parameters": {
          "color": 7,
          "width": 300,
          "height": 340,
          "content": "## Create Post Image\nhttps://pollinations.ai/\nhttps://image.pollinations.ai/prompt/[your image description]\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "e196ea9b-f5d0-4fa6-a3d9-bea2f98fd872",
        "name": "Save Image to imgbb.com",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1760,
          -680
        ],
        "parameters": {
          "url": "https://api.imgbb.com/1/upload",
          "method": "POST",
          "options": {
            "redirect": {
              "redirect": {}
            }
          },
          "sendBody": true,
          "sendQuery": true,
          "contentType": "multipart-form-data",
          "bodyParameters": {
            "parameters": [
              {
                "name": "image",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          },
          "queryParameters": {
            "parameters": [
              {
                "name": "expiration",
                "value": "0"
              },
              {
                "name": "key",
                "value": "={{ $env.IMGBB_API_KEY}} "
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "225e34be-26ee-40d7-88d6-e866420e083a",
        "name": "Sticky Note41",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1980,
          -2280
        ],
        "parameters": {
          "width": 340,
          "height": 180,
          "content": "üí°Notes\n\nUpdate all Social Media Platform Credentials as required.\n\nAdjust parameters and content for each platform to suit your needs."
        },
        "typeVersion": 1
      },
      {
        "id": "2f48f19d-92c1-478a-b7fa-3fc3b1100993",
        "name": "Sticky Note42",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1240,
          -1760
        ],
        "parameters": {
          "color": 4,
          "width": 400,
          "height": 360,
          "content": "# üëç Approve Content Before Proceeding"
        },
        "typeVersion": 1
      },
      {
        "id": "ce4e9f3c-801a-478e-8ffc-008c5e7d4e49",
        "name": "Gmail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2640,
          -780
        ],
        "webhookId": "cfc2a53d-14a7-47e1-8385-c0b0792d9843",
        "parameters": {
          "sendTo": "={{ $env.TELEGRAM_CHAT_ID }}",
          "message": "={{ $json.output }}",
          "options": {
            "appendAttribution": false
          },
          "subject": "=Social Media Content - {{ $('Social Content').item.json.output.title }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "1xpVDEQ1yx8gV022",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "31ee0735-c863-476c-9c4a-41b50ae9c61a",
        "name": "Social Media Schema",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          -320,
          -700
        ],
        "parameters": {
          "operation": "get",
          "documentURL": "=12345"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "YWEHuG28zOt532MQ",
            "name": "Google Docs account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "18cfde4e-2637-496c-acca-070bdb84c2ba",
        "name": "Social Media System Prompt",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          -320,
          -420
        ],
        "parameters": {
          "operation": "get",
          "documentURL": "=12345"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "YWEHuG28zOt532MQ",
            "name": "Google Docs account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "383ce472-ccf8-47fb-aa36-5b8aacbcd64f",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -440,
          -840
        ],
        "parameters": {
          "color": 7,
          "width": 1120,
          "height": 640,
          "content": "## Prompt & Schema Composition from External Sources"
        },
        "typeVersion": 1
      },
      {
        "id": "8d2a2a64-bbaa-4692-94ed-2f541d0d40ca",
        "name": "gpt-40-mini",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2320,
          -600
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "gpt-4o-mini"
          },
          "options": {
            "responseFormat": "text"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6e5faa4d-25a1-4dbe-998e-3255ed181ac5",
        "name": "Instagram Image",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          2440,
          -1940
        ],
        "parameters": {
          "url": "https://graph.facebook.com/v20.0/[your-unique-id]/media",
          "method": "POST",
          "options": {},
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "image_url",
                "value": "={{ $json.output.social_image.medium.url }}"
              },
              {
                "name": "caption",
                "value": "={{ $json.output.caption }}"
              }
            ]
          },
          "nodeCredentialType": "facebookGraphApi"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "PzDfmiwB7GPtmSaP",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "958793c8-7a74-498f-ac75-256232469fbc",
        "name": "X Post",
        "type": "n8n-nodes-base.twitter",
        "onError": "continueRegularOutput",
        "position": [
          2640,
          -2180
        ],
        "parameters": {
          "text": "={{ $json.data.social_content.schema.post }}",
          "additionalFields": {}
        },
        "credentials": {
          "twitterOAuth2Api": {
            "id": "wRDruLTCqjQ7C5jq",
            "name": "X account"
          }
        },
        "typeVersion": 2,
        "alwaysOutputData": true
      },
      {
        "id": "1f04a4b5-e97d-4574-abdb-270265da77fa",
        "name": "Instragram Post",
        "type": "n8n-nodes-base.facebookGraphApi",
        "onError": "continueRegularOutput",
        "position": [
          2640,
          -2000
        ],
        "parameters": {
          "edge": "media_publish",
          "node": "[your-unique-id]",
          "options": {
            "queryParameters": {
              "parameter": [
                {
                  "name": "creation_id",
                  "value": "={{ $json.id }}"
                },
                {
                  "name": "caption",
                  "value": "={{ $('Social Media Publishing Router').item.json.output.caption }}"
                }
              ]
            }
          },
          "graphApiVersion": "v20.0",
          "httpRequestMethod": "POST"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "PzDfmiwB7GPtmSaP",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "92a917ff-d20d-4bbc-be8f-00e17be83ea2",
        "name": "Facebook Post",
        "type": "n8n-nodes-base.facebookGraphApi",
        "onError": "continueRegularOutput",
        "position": [
          2640,
          -1820
        ],
        "parameters": {
          "edge": "photos",
          "node": "[your-unique-id]",
          "options": {
            "queryParameters": {
              "parameter": [
                {
                  "name": "message",
                  "value": "={{ $json.output.post }}\n\n{{ $json.output.call_to_action }}\n"
                }
              ]
            }
          },
          "sendBinaryData": true,
          "graphApiVersion": "v20.0",
          "httpRequestMethod": "POST",
          "binaryPropertyName": "data"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "PzDfmiwB7GPtmSaP",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "6c80332d-1aaf-4f3a-91fd-58c25f20ee0c",
        "name": "LinkedIn Post",
        "type": "n8n-nodes-base.linkedIn",
        "onError": "continueRegularOutput",
        "position": [
          2640,
          -1640
        ],
        "parameters": {
          "text": "={{ $json.data.social_content.schema.post }}\n{{ $json.data.social_content.schema.call_to_action }}\n{{ $json.data.social_content.common_schema.hashtags }}\n",
          "postAs": "organization",
          "organization": "12345678",
          "additionalFields": {},
          "binaryPropertyName": "=data",
          "shareMediaCategory": "IMAGE"
        },
        "credentials": {
          "linkedInOAuth2Api": {
            "id": "WMm6pzAEgNd4wJdO",
            "name": "LinkedIn account"
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "f9d80261-8543-4a12-969c-eecd58513ef2",
        "name": "Gmail User for Approval",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1380,
          -1600
        ],
        "webhookId": "abfae12d-ddcf-4981-ad33-bb7a8cc115a2",
        "parameters": {
          "sendTo": "={{ $env.TELEGRAM_CHAT_ID }}",
          "message": "={{ $json.output }}",
          "options": {
            "limitWaitTime": {
              "values": {
                "resumeUnit": "minutes",
                "resumeAmount": 45
              }
            }
          },
          "subject": "=üî•FOR APPROVALüî• {{$('Extract as JSON').item.json.data.social_content.root_schema.name  }}",
          "operation": "sendAndWait",
          "approvalOptions": {
            "values": {
              "approvalType": "double"
            }
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "1xpVDEQ1yx8gV022",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "97c2dec9-9e1e-4a42-9538-8a37392114e6",
        "name": "Get Social Post Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1640,
          -1340
        ],
        "parameters": {
          "url": "={{ $('Extract as JSON').item.json.data.social_image.medium.url }}",
          "options": {}
        },
        "retryOnFail": true,
        "typeVersion": 4.2
      },
      {
        "id": "b5b6b7b9-d275-4c1a-a3c5-195b13be1538",
        "name": "gpt-40-mini1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          860,
          -1420
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "gpt-4o-mini"
          },
          "options": {
            "responseFormat": "text"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "0b5b8237-9e34-44b7-82d9-372a12c67546",
        "name": "gpt-4o-mini",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          780,
          -360
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "gpt-4o-mini"
          },
          "options": {
            "responseFormat": "json_object"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "df61bbeb-1432-434b-9993-18362dba097f",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1840,
          -1220
        ],
        "parameters": {
          "color": 5,
          "width": 760,
          "height": 1540,
          "content": "<system>\nYou are a specialized content creation AI for social media platforms.\nYour primary function is generating platform-optimized social media content across various platforms including LinkedIn, Instagram, Facebook, Twitter (X), Threads, and YouTube Shorts. Each piece of content must:\nMatch the specific platform's audience expectations and algorithm preferences\nShowcase relevant expertise in your field\nDeliver actionable insights for your target audience\nDrive meaningful engagement through value-driven content\nOBJECTIVES:\nCreate platform-specific content following each platform's best practices\nImplement strategic hashtag usage combining general and trending tags\nDesign content that encourages user interaction and community building\nMaintain consistent brand voice while adapting to platform requirements\nIncorporate data-driven insights to maximize content performance\nOUTPUT REQUIREMENTS:\nDeliver content in valid JSON format according to the platform-specific schema\nInclude all required fields as specified in the schema\nOmit any explanatory text or code fencing in your response\nTailor content specifically to the platform indicated in the user's request\nFor each content request, adapt your output based on the platform guidelines.  Never provide URLS for video or image suggestions and only describe the suggestion.\n</system>\n\n\n<rules>\nOnly provide final response in valid JSON for the appropriate social platform\nNever include any preamble or further explanation\nAlways remove any ``` ```json\n</rules>\n\n\n<linkedin>\n**Style**: Professional and insightful.\n**Tone**: Business-oriented; focus on automation use cases, industry insights, and community impact.\n**Content Length**: 3-4 sentences; concise but detailed.\n**Hashtags**: #Innovation #Automation #WorkflowSolutions #DigitalTransformation #Leadership\n**Call to Action (CTA)**: Encourage comments or visits to workflows.diy's website for more insights.\n</linkedin>\n\n<instagram>\n**Style**: Visual storytelling with creative captions.\n**Tone**: Inspirational and engaging; use emojis for relatability.\n**Content Length**: 2-3 sentences paired with eye-catching visuals (e.g., infographics or workflow demos).\n**Visuals**: Showcase milestones (e.g., new workflow launches), tutorials, or product highlights.\n**CTA**: Use phrases like \"Swipe to learn more,\" \"Tag your team,\" or \"Check out the link below!\"\n**Link Placement**: Add the provided link before hashtags; if no link is provided, use \"Visit our website: https://example.com\"\n**Hashtags**: #AutomationLife #TechInnovation #WorkflowTips #Programming #Engineering\n</instagram>\n\n<facebook>\n**Style**: Friendly and community-focused.\n**Tone**: Relatable; highlight user success stories or company achievements in automation.\n**Content Length**: 2-3 sentences; conversational yet professional.\n**Hashtags**: #SmallBusinessAutomation #Entrepreneurship #Leadership #WorkflowInnovation\n**CTA**: Encourage likes, shares, comments (e.g., \"What's your favorite automation tip?\").\n</facebook>\n\n<xtwitter>\n**Style**: Concise and impactful.\n**Tone**: Crisp and engaging; spark curiosity in 150 characters or less.\n**Hashtags**: #WorkflowTrends #AIWorkflows #AutomationTips #NoCodeSolutions\n**CTA**: Drive quick engagement through retweets or replies (e.g., \"What's your go-to n8n workflow?\").\n</xtwitter>\n\n<threads>\n**Style**: Conversational and community-driven posts.\n**Tone**: Casual yet informative; encourage discussions around automation trends or innovations.\n**Content Length**: 1-2 short paragraphs with a question or thought-provoking statement at the end.\n**Hashtags**: Similar to Instagram but tailored for trending Threads topics related to automation.\n</threads>\n\n<youtube_short>\n**Style**: Short-form video content showcasing quick workflow tutorials or use cases.\n**Tone**: Authoritative yet approachable; establish workflows.diy as a leader in n8n automation solutions.\n**Content Length**:\n  Tutorials/Reviews (long-form): 5-10 minutes\n  Shorts/Highlights (short-form): Under 1 minute\n**CTA**: Encourage subscriptions, likes, comments (e.g., \"Subscribe for more workflow tips!\").\n</youtube_short>\n\n\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "ddf3d7d3-0218-4ba0-b990-34a6220a53fa",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1060,
          -1220
        ],
        "parameters": {
          "color": 3,
          "height": 1540,
          "content": "<common>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"hashtags\": {\n            \"type\": \"array\",\n            \"items\": {\n                \"type\": \"string\"\n            }\n        },\n        \"image_suggestion\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</common>\n\n<root>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"name\": {\n            \"type\": \"string\"\n        },\n        \"description\": {\n            \"type\": \"string\"\n        },\n        \"additional_notes\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</root>\n\n<linkedin>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"post\": {\n            \"type\": \"string\"\n        },\n        \"call_to_action\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</linkedin>\n\n<instagram>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"caption\": {\n            \"type\": \"string\"\n        },\n        \"emojis\": {\n            \"type\": \"array\",\n            \"items\": {\n                \"type\": \"string\"\n            }\n        },\n        \"call_to_action\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</instagram>\n\n<facebook>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"post\": {\n            \"type\": \"string\"\n        },\n        \"call_to_action\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</facebook>\n\n<xtwitter>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"video_suggestion\": {\n            \"type\": \"string\"\n        },\n        \"post\": {\n            \"type\": \"string\"\n        },\n        \"character_limit\": {\n            \"type\": \"integer\"\n        }\n    }\n}\n</xtwitter>\n\n<threads>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"text_post\": {\n            \"type\": \"string\"\n        },\n        \"call_to_action\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</threads>\n\n<youtube_short>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"video_suggestion\": {\n            \"type\": \"string\"\n        },\n        \"title\": {\n            \"type\": \"string\"\n        },\n        \"description\": {\n            \"type\": \"string\"\n        },\n        \"call_to_action\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</youtube_short>\n\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "72b378bd-6035-45da-8c76-ddd897d107c7",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -400,
          -480
        ],
        "parameters": {
          "color": 5,
          "width": 260,
          "height": 240,
          "content": "### üëàSystem Prompt"
        },
        "typeVersion": 1
      },
      {
        "id": "ba60e52d-722a-4f07-86b4-f4ea64cb2bab",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -400,
          -760
        ],
        "parameters": {
          "color": 3,
          "width": 260,
          "height": 240,
          "content": "### üëàSocial Media Schema"
        },
        "typeVersion": 1
      },
      {
        "id": "bc1ff038-26ad-44d6-94d1-2c1f72a9bf87",
        "name": "Schema",
        "type": "n8n-nodes-base.set",
        "position": [
          -60,
          -700
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "9d6d41f2-7216-4659-af34-7215298494d9",
                "name": "schema",
                "type": "string",
                "value": "={{ $json.content }}"
              },
              {
                "id": "7d8c85f5-3f4a-4d72-bef0-0957c6ce82a4",
                "name": "platform",
                "type": "string",
                "value": "={{ $('When Executed by Another Workflow').item.json.route }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "777d231c-f69c-4b48-bec5-6674175703bc",
        "name": "System Prompt",
        "type": "n8n-nodes-base.set",
        "position": [
          -60,
          -420
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "5f789b37-b021-4cd4-b359-fdfbb9b71c2b",
                "name": "system_prompt_doc_id",
                "type": "string",
                "value": "={{ $json.documentId }}"
              },
              {
                "id": "daac5758-38ad-4afe-966b-a9b4b89691b2",
                "name": "system_prompt",
                "type": "string",
                "value": "={{ $json.content }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "3813a552-cf99-49ca-9617-7eaac56f6819",
        "name": "Parse Schema",
        "type": "n8n-nodes-base.code",
        "position": [
          140,
          -700
        ],
        "parameters": {
          "jsCode": "// Get the input data from previous node\nconst inputData = $input.first().json;\nconst xmlString = inputData.schema;\n\nconsole.log(inputData)\n\n// Function to extract content between XML tags with better regex handling\nfunction extractFromXmlTags(xmlString, tagName) {\n  const regex = new RegExp(`<${tagName}>(.*?)<\\/${tagName}>`, 'gs');\n  const match = regex.exec(xmlString);\n  return match ? match[1].trim() : null;\n}\n\n// Get the platform from the input or use a default\nconst platform = inputData.platform;\n\n// Extract the content from the specified tag\nconst extractedContent = extractFromXmlTags(xmlString, platform);\nconst rootContent = extractFromXmlTags(xmlString, 'root');\nconst commonContent = extractFromXmlTags(xmlString, 'common');\n\njsonData = JSON.parse(extractedContent);\nrootSchema = JSON.parse(rootContent);\ncommonSchema = JSON.parse(commonContent);\n\n// Return the result\nreturn {\n  json: {\n    schema: jsonData,\n    root_schema: rootSchema,\n    common_schema: commonSchema\n  }\n};\n"
        },
        "typeVersion": 2
      },
      {
        "id": "c55da4a1-91f8-4d17-ad73-730013a99231",
        "name": "Parse System Prompt",
        "type": "n8n-nodes-base.code",
        "position": [
          140,
          -420
        ],
        "parameters": {
          "jsCode": "// Get the input data from previous node\nconst inputData = $input.first().json;\nconst xmlString = inputData.system_prompt;\n\n// Function to extract all content between XML tags\nfunction extractAllXmlTags(xmlString) {\n  // Create a result object to store tag contents\n  const result = {};\n  \n  // Regular expression to find all XML tags and their content\n  // This regex matches opening tag, content, and closing tag\n  const tagRegex = /<([^>\\/]+)>([\\s\\S]*?)<\\/\\1>/g;\n  \n  // Find all matches\n  let match;\n  while ((match = tagRegex.exec(xmlString)) !== null) {\n    const tagName = match[1].trim();\n    const content = match[2].trim();\n    \n    // Store the content with the tag name as the key\n    result[tagName] = content;\n  }\n  \n  return result;\n}\n\n// Extract all XML tags and their content\nconst extractedTags = extractAllXmlTags(xmlString);\n\n// Return the result as a JSON object\nreturn {\n  json: {\n    system_config: extractedTags\n  }\n};\n"
        },
        "typeVersion": 2
      },
      {
        "id": "1767c787-943b-43d6-86cb-3fb60eaf878e",
        "name": "Compose Prompt & Schema",
        "type": "n8n-nodes-base.set",
        "position": [
          520,
          -560
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "9216ad1c-a281-4c94-835d-e20507ef0cb5",
                "name": "route",
                "type": "string",
                "value": "={{ $json.route }}"
              },
              {
                "id": "e6ca5cdf-5139-4db7-b065-ee52028216c5",
                "name": "user_prompt",
                "type": "string",
                "value": "={{ $json.user_prompt }}"
              },
              {
                "id": "2927cd6f-c351-49df-954b-9f87b0338c58",
                "name": "system_config.system",
                "type": "string",
                "value": "={{ $json.system_config.system }}"
              },
              {
                "id": "829b1519-9ffa-44d7-8caa-455e15b30614",
                "name": "system_config.rules",
                "type": "string",
                "value": "={{ $json.system_config.rules }}"
              },
              {
                "id": "b44472ba-6e98-448b-bad6-e02da8b32b0a",
                "name": "={{ $json.route }}",
                "type": "string",
                "value": "={{ $json.system_config[$json.route.toLowerCase()] }}"
              },
              {
                "id": "a96e8c30-1d44-4e23-9ef4-95d7303ea41e",
                "name": "root_schema",
                "type": "object",
                "value": "={{ $json.root_schema }}"
              },
              {
                "id": "6cb68192-10f3-496d-88ca-289ee0c19940",
                "name": "common_schema",
                "type": "object",
                "value": "={{ $json.common_schema }}"
              },
              {
                "id": "8f9b85f0-abaa-46c2-ba98-897f6a677105",
                "name": "schema",
                "type": "object",
                "value": "={{ $json.schema }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "b7d78f57-ee83-4e03-ada6-fd6e2048c272",
        "name": "Social Media Content Creator",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          800,
          -560
        ],
        "parameters": {
          "text": "=Social Media Platform: {{ $json.route }}\nUser Prompt: {{ $json.user_prompt }}\n",
          "options": {
            "systemMessage": "={{ $json.system_config.system }}\n\n<tools>\nYou have been provided with an internet search tool.  Use this tool to find relavent information about the users request before responding.  Todays date is: {{ $now }}\n</tools>\n\n<rules>\n{{ $json.system_config.rules }}\n- Output must conform to provided JSON schema\n</rules>\n\nFollow this Output JSON Schema:\n{\n  root_schema: {{ $json.root_schema.toJsonString() }},\n  common_schema: {{ $json.common_schema.toJsonString()}},\n  schema: {{  $json.schema.toJsonString() }}\n}"
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "35469698-0eb5-4238-85d1-c67ccbacf2cb",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1880,
          -1400
        ],
        "parameters": {
          "color": 7,
          "width": 1100,
          "height": 1760,
          "content": "# External System Prompt and Schema"
        },
        "typeVersion": 1
      },
      {
        "id": "12b55edd-ff51-423b-a153-96a8a2a09678",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2380,
          -2280
        ],
        "parameters": {
          "color": 6,
          "width": 700,
          "height": 1240,
          "content": "# üìÑ Publish to Social Media "
        },
        "typeVersion": 1
      },
      {
        "id": "78cd8af0-c10c-4bf5-8420-63061e7687bc",
        "name": "Merge Prompts and Schema",
        "type": "n8n-nodes-base.merge",
        "position": [
          340,
          -560
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition",
          "numberInputs": 3
        },
        "typeVersion": 3
      },
      {
        "id": "e7a62296-729b-45df-bd15-002ccaae2fa0",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          720,
          -680
        ],
        "parameters": {
          "width": 400,
          "height": 480,
          "content": "## Social Media Content Creator"
        },
        "typeVersion": 1
      },
      {
        "id": "f6cb5a95-4047-4e41-a635-a73681fe6d8b",
        "name": "Social Content",
        "type": "n8n-nodes-base.set",
        "position": [
          1180,
          -560
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "8c318996-aa79-4970-b8d7-33ae1931c8c6",
                "name": "output",
                "type": "object",
                "value": "={{ $json.output }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "148df311-24db-4243-bc62-1a51579720d7",
        "name": "Save Image to Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1760,
          -480
        ],
        "parameters": {
          "name": "={{ $json.output.root_schema.name.replaceAll(' ','-').replaceAll(',','').replaceAll('.','') }}",
          "driveId": {
            "__rl": true,
            "mode": "id",
            "value": "=My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "id",
            "value": "=12345"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "UhdXGYLTAJbsa0xX",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "f84ab889-d193-4d9a-8e8b-4f35805edaa4",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          1980,
          -560
        ],
        "parameters": {
          "mode": "combine",
          "options": {
            "includeUnpaired": true
          },
          "combineBy": "combineByPosition",
          "numberInputs": 3
        },
        "typeVersion": 3
      },
      {
        "id": "ca43646b-ca79-4ff6-ac02-da4f668e7aeb",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2200,
          -880
        ],
        "parameters": {
          "color": 7,
          "width": 660,
          "height": 420,
          "content": "## Send Social Media Image and Post Contents to Gmail\n(optional)"
        },
        "typeVersion": 1
      },
      {
        "id": "cf7bda38-260f-42c0-b60a-6a93181712de",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2120,
          -420
        ],
        "parameters": {
          "color": 7,
          "width": 840,
          "height": 260,
          "content": "## Prepare Social Media Post and Save to Google Drive"
        },
        "typeVersion": 1
      },
      {
        "id": "13cafb9c-5f04-4193-8f0e-0384f68d5e45",
        "name": "Save Social Post to Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          2560,
          -340
        ],
        "parameters": {
          "name": "={{ $json.response.google_drive_image.id }}",
          "content": "={{ $json.response.toJsonString() }}",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "id",
            "value": "= 12345"
          },
          "operation": "createFromText"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "UhdXGYLTAJbsa0xX",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "2bdecf8d-e180-4795-92c2-6158adf71daf",
        "name": "Google Drive Image Meta",
        "type": "n8n-nodes-base.set",
        "position": [
          2200,
          -340
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "769d86e6-3764-4023-8932-f25f7d4fe34a",
                "name": "id",
                "type": "string",
                "value": "={{ $json.id }}"
              },
              {
                "id": "4ccae0cc-d246-477c-9e94-3be461134d01",
                "name": "webContentLink",
                "type": "string",
                "value": "={{ $json.webContentLink }}"
              },
              {
                "id": "74e22694-c7e6-4598-8e87-8ea6ae00144e",
                "name": "webViewLink",
                "type": "string",
                "value": "={{ $json.webViewLink }}"
              },
              {
                "id": "e8eedbbf-7d42-475b-a748-0afbe8b730da",
                "name": "thumbnailLink",
                "type": "string",
                "value": "={{ $json.thumbnailLink }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "d6e4902a-af19-45a4-8253-432135e17998",
        "name": "Social Post JSON",
        "type": "n8n-nodes-base.set",
        "position": [
          2380,
          -340
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b705af39-d286-4461-956c-d963ea151734",
                "name": "response",
                "type": "object",
                "value": "={ \n  \"route\": \"{{ $('When Executed by Another Workflow').item.json.route }}\",\n \"social_image\": {{ $('Merge').item.json.data.toJsonString()  }},\n  \"social_content\": {{ $('Social Content').item.json.output.toJsonString() }},\n  \"google_drive_image\": {{ $json.toJsonString() }}\n}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "b35623e6-9ddc-4091-905f-7b485efc5d60",
        "name": "Respond with Google Drive Id",
        "type": "n8n-nodes-base.set",
        "position": [
          2740,
          -340
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "ad353ca7-059a-4108-88b9-fb92720a34fe",
                "name": "response",
                "type": "string",
                "value": "={{ $json.id }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "410c3924-1011-480d-874c-a395c243f4c6",
        "name": "Telegram Success Message (Optional)",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1760,
          -880
        ],
        "webhookId": "93342863-02c0-42ee-98c3-a2ec72b3bf12",
        "parameters": {
          "text": "Image created successfully",
          "chatId": "={{ $env.TELEGRAM_CHAT_ID }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "pAIFhguJlkO3c7aQ",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "eba8445d-55da-43e2-b2aa-4822168a70ea",
        "name": "Telegram Error Message (Optional)",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1760,
          -300
        ],
        "webhookId": "93342863-02c0-42ee-98c3-a2ec72b3bf12",
        "parameters": {
          "text": "Error creating image (Debugging)",
          "chatId": "={{ $env.TELEGRAM_CHAT_ID }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "pAIFhguJlkO3c7aQ",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "af2c4945-0dac-4398-b8ad-329066eefedd",
        "name": "Social Media Publishing Router",
        "type": "n8n-nodes-base.switch",
        "position": [
          2080,
          -1900
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "1Ô∏è‚É£X-Twitter",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.data.route }}",
                      "rightValue": "xtwitter"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": " 2Ô∏è‚É£Instagram",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "86d44336-bab7-422f-9266-fcb513252d19",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.data.route }}",
                      "rightValue": "instagram"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": " 3Ô∏è‚É£Facebook",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "29f37628-6381-46af-babb-74bf00b4a849",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.data.route }}",
                      "rightValue": "facebook"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "4Ô∏è‚É£Linkedin",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "fdb7c8aa-4108-43f6-8f6b-71cd8f383d2a",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.data.route }}",
                      "rightValue": "=linkedin"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "5Ô∏è‚É£Threads",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "956baedd-4a0b-4e41-b85c-ef2c84332bdc",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.data.route }}",
                      "rightValue": "threads"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "6Ô∏è‚É£YouTube Short",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "4d690442-197c-4ff9-b176-b55dfabaecc9",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.data.route }}",
                      "rightValue": "youtube_short"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "682ee752-8e7f-4ee5-b617-88d7c1f7d4e7",
        "name": "Prepare Email Contents",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          880,
          -1600
        ],
        "parameters": {
          "text": "=Use the HTML template and populate [fields] as required from this: {{ $json.data.social_content.toJsonString() }}\n-----\nOnly output HTML without code block tags, preamble or further explanation in the format provided.\n\n## HTML Template\n<table style=\"max-width:640px;min-width:320px;width:100%;border-collapse:collapse;font-family:Arial,sans-serif;margin:20px auto\">\n    <tbody>\n        <tr>\n            <td colspan=\"2\" style=\"background-color:#ffffff;padding:15px;text-align:left\">\n                <img src=\"{{ $json.data.google_drive_image.thumbnailLink }}\" alt=\"{{ $json.data.social_content.root_schema.name }}\" style=\"max-width:100%;height:auto;\">\n            </td>\n        </tr>\n        <tr>\n            <td colspan=\"2\" style=\"background-color:#efefef;padding:15px;font-size:20px;text-align:left;font-weight:bold\">\n                {{ $json.data.social_content.root_schema.name }}\n            </td>\n        </tr>\n        <tr>\n            <td style=\"background-color:#f9f9f9;padding:15px;width:30%;text-align:left\"><strong>[label_1]:</strong></td>\n            <td style=\"background-color:#f9f9f9;padding:15px;text-align:left\">[content_1]</td>\n        </tr>\n        <tr>\n            <td style=\"background-color:#f1f1f1;padding:15px;text-align:left\"><strong>[label_2]:</strong></td>\n            <td style=\"background-color:#f1f1f1;padding:15px;text-align:left\">[content_2]</td>\n        </tr>\n\n        [continue the pattern ...]\n\n        <tr>\n            <td colspan=\"2\" style=\"background-color:#efefef;padding:15px;text-align:left\">\n                <strong>[footer_label]:</strong> [footer_content]\n            </td>\n        </tr>\n    </tbody>\n</table>\n\n",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "eeab0159-cb24-4653-ba14-461740c8753c",
        "name": "Is Approved?",
        "type": "n8n-nodes-base.if",
        "position": [
          1380,
          -1340
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "313cec9b-aad5-4f9c-a209-afe83af53df0",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.data.approved }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "dbe7cd63-9ec0-46cd-9255-8c1dc738847d",
        "name": "File Id",
        "type": "n8n-nodes-base.set",
        "position": [
          1200,
          -2080
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "efb1c03b-8465-443d-a442-b76b8cd86a73",
                "name": "output",
                "type": "object",
                "value": "={{ $json.output }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "cdb01e90-c54c-4ae4-87e2-75a3baec2295",
        "name": "Get Social Post from Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1380,
          -2080
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.output.response }}"
          },
          "options": {},
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "UhdXGYLTAJbsa0xX",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "aea6ec59-fcf4-4b5a-9fbc-86d9eb834388",
        "name": "Extract as JSON",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          1560,
          -2080
        ],
        "parameters": {
          "options": {},
          "operation": "fromJson"
        },
        "typeVersion": 1
      },
      {
        "id": "70ccf82d-3871-40cd-8dc0-961e36acd070",
        "name": "Merge Image and Post Contents",
        "type": "n8n-nodes-base.merge",
        "position": [
          1820,
          -1840
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "077f7110-215f-4ccf-8546-41d21c1105ad",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2540,
          -1460
        ],
        "parameters": {
          "width": 320,
          "height": 380,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "650a4191-6ed6-4868-b433-f44a0ddf959b",
        "name": "Implement Threads Here",
        "type": "n8n-nodes-base.noOp",
        "position": [
          2640,
          -1420
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "59651d51-92ce-42e5-a9c7-4faa18526ef2",
        "name": "Implement YouTube Shorts Here",
        "type": "n8n-nodes-base.noOp",
        "position": [
          2640,
          -1260
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "7cb931d5-d890-4ea6-9fca-84b934dd911c",
        "name": "X Response",
        "type": "n8n-nodes-base.set",
        "position": [
          2840,
          -2180
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "4015bb20-da3b-4781-ab8c-46f4d826138e",
                "name": "output",
                "type": "string",
                "value": "={{ $('Social Media Publishing Router').item.json.data.route }}\n\n{{ $('Social Media Publishing Router').item.json.data.social_content.root_schema.name }}\n\n{{ $('Social Media Publishing Router').item.json.data.social_content.schema.post }}\n\n![{{ $('Social Media Publishing Router').item.json.data.social_content.root_schema.name }}]({{ $('Social Media Publishing Router').item.json.data.social_image.thumb.url }})"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "90c4faa3-3376-41d1-83e7-0c4c2bc03de5",
        "name": "Instagram Response",
        "type": "n8n-nodes-base.set",
        "position": [
          2840,
          -2000
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "da8fe7e3-e74d-46b6-91eb-1bf4432b73b0",
                "name": "output",
                "type": "string",
                "value": "={{ $('Social Media Publishing Router').item.json.data.route }}  \n{{ $('Social Media Publishing Router').item.json.data.social_content.root_schema.name }}\n{{ $('Social Media Publishing Router').item.json.data.social_content.schema.caption }}\n![{{ $('Social Media Publishing Router').item.json.data.social_content.root_schema.name }}]({{ $('Social Media Publishing Router').item.json.data.social_image.thumb.url }})"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "de57e2c7-acac-4268-a535-e90f00548956",
        "name": "Facebook Response",
        "type": "n8n-nodes-base.set",
        "position": [
          2840,
          -1820
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e349e314-2967-456f-856a-85727bdf94f3",
                "name": "output",
                "type": "string",
                "value": "={{ $('Social Media Publishing Router').item.json.data.route }}\n\n{{ $('Social Media Publishing Router').item.json.data.social_content.root_schema.name }}\n\n{{ $('Social Media Publishing Router').item.json.data.social_content.schema.post }}\n\n![{{ $('Social Media Publishing Router').item.json.data.social_content.root_schema.name }}]({{ $('Social Media Publishing Router').item.json.data.social_image.thumb.url }})"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "030e8933-0eae-4e6c-956d-dce0e702b163",
        "name": "LinkedIn Response",
        "type": "n8n-nodes-base.set",
        "position": [
          2840,
          -1640
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "88404fde-a41b-4da5-bbdb-0e41b879a52c",
                "name": "output",
                "type": "string",
                "value": "={{ $('Social Media Publishing Router').item.json.data.route }}\n\n{{ $('Social Media Publishing Router').item.json.data.social_content.root_schema.name }}\n\n{{ $('Social Media Publishing Router').item.json.data.social_content.schema.post }}\n\n![{{ $('Social Media Publishing Router').item.json.data.social_content.root_schema.name }}]({{ $('Social Media Publishing Router').item.json.data.social_image.thumb.url }})\n"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "d48b6b3a-9410-4012-85bf-f70b4e91eccb",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1060,
          -1300
        ],
        "parameters": {
          "color": 3,
          "height": 80,
          "content": "## Social Media Schema"
        },
        "typeVersion": 1
      },
      {
        "id": "e3ef0a13-42ca-4021-aeb5-2230f4ac7eac",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1840,
          -1300
        ],
        "parameters": {
          "color": 5,
          "width": 760,
          "height": 80,
          "content": "## System Prompt"
        },
        "typeVersion": 1
      },
      {
        "id": "11457221-fa5e-41f4-93a5-bb3eea3f02a9",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -120,
          -2200
        ],
        "parameters": {
          "width": 620,
          "height": 320,
          "content": "# Social Media Router Agent"
        },
        "typeVersion": 1
      },
      {
        "id": "f40e9cde-1810-4471-9751-6da724a06f6c",
        "name": "ü§ñSocial Media Router Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          60,
          -2080
        ],
        "parameters": {
          "text": "=You are a helpful assistant that uses the provided tools.  Respond with a valid JSON object.\n\nUser prompt:  {{ $json.chatInput }}",
          "options": {
            "systemMessage": "## RULES\n- You do not answer the users questions directly and your sole purpose is to call the appropriate tool to and provide the verbatim response.\n\n## TOOLS\n- create_x_twitter_posts_tool: Use this tool to create X-Twitter posts\n- create_instagram_posts_tool: Use this tool to create Instagram posts\n- create_facebook_posts_tool: Use this tool to create Facebook posts\n- create_linkedin_posts_tool: Use this tool to create LinkedIn posts\n- create_threads_posts_tool: Use this tool to create Threads posts\n- create_youtube_short_tool: Use this tool to create a YouTube short\n\n\n"
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "e6715ea6-f70d-427b-bf3d-499ed8040140",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          800,
          -1720
        ],
        "parameters": {
          "width": 400,
          "height": 440,
          "content": "## Prepare Email Approval Contents as HTML"
        },
        "typeVersion": 1
      },
      {
        "id": "cbb2a190-8aad-4e09-9d5c-a43dbcb32184",
        "name": "SerpAPI",
        "type": "@n8n/n8n-nodes-langchain.toolSerpApi",
        "position": [
          980,
          -360
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "serpApi": {
            "id": "DfdkTTaZtPp0iHYv",
            "name": "SerpAPI account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "58da1f9e-caa4-4ea2-8b02-3e734758af80",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -500,
          -120
        ],
        "parameters": {
          "color": 7,
          "width": 3520,
          "height": 680,
          "content": "# üí´Features & Benefits"
        },
        "typeVersion": 1
      },
      {
        "id": "e65c6e37-0523-4e7d-b634-d3499aef5516",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -440,
          -40
        ],
        "parameters": {
          "color": 7,
          "width": 680,
          "height": 280,
          "content": "## 1Ô∏è‚É£System Prompt Composition from External Source\nCentralized prompt management: Store and update system prompts in Google Docs for easy team collaboration\n\n- Consistent brand voice: Ensure all generated content maintains consistent tone and style across platforms\n\n- Flexible customization: Quickly modify prompts without changing workflow code\n\n- Version control: Track changes to prompts over time with Google Docs revision history\n\n- Role-specific access: Control who can edit core prompts while allowing broader viewing access\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b7ccbaa4-3c33-4f32-a72d-fb693b9c63d6",
        "name": "Sticky Note17",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -440,
          260
        ],
        "parameters": {
          "color": 7,
          "width": 680,
          "height": 260,
          "content": "## 2Ô∏è‚É£Output Schema Composition from External Source\n- Structured content generation: Enforce consistent JSON output formats for each platform\n\n- Platform-specific optimization: Tailor content structure to each social network's requirements\n\n- Reduced errors: Validate content against schemas before publishing\n\n- Easy updates: Modify schemas as platform requirements change without workflow modifications\n\n- Standardized metadata: Ensure all required fields are included for each platform"
        },
        "typeVersion": 1
      },
      {
        "id": "b36e874a-a893-439d-bd29-524ea567b695",
        "name": "Sticky Note19",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          720,
          -40
        ],
        "parameters": {
          "color": 7,
          "width": 400,
          "height": 520,
          "content": "## 4Ô∏è‚É£ Dynamic Social Media Content Creator Agent with Web Search Tool to Match Social Post and Platform Schema\n\n- Real-time research: Incorporate current events and trending topics into content\n\n- Fact-checking: Verify information before publishing to maintain credibility\n\n- Competitive analysis: Reference industry trends and competitor content\n\n- Contextual relevance: Create content that responds to current market conditions\n\n- Enhanced engagement: Generate content that aligns with trending conversations"
        },
        "typeVersion": 1
      },
      {
        "id": "d57e47d1-e95e-45b6-95cf-a8952320da35",
        "name": "Sticky Note23",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1160,
          -40
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 520,
          "content": "## 5Ô∏è‚É£ Dynamic Image Creation to Match Social Post & Platform Schema\n\n- Visual consistency: Generate platform-optimized images that match content themes\n\n- Automated alt text: Create accessibility-compliant image descriptions\n\n- Multi-format output: Generate images in various dimensions for different platforms\n\n- Brand compliance: Ensure all visuals align with brand guidelines\n\n- Reduced design bottlenecks: Eliminate waiting for custom graphics for each post"
        },
        "typeVersion": 1
      },
      {
        "id": "4323fd33-f2ff-434a-bd44-0ecb59fc4962",
        "name": "Sticky Note24",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1520,
          -40
        ],
        "parameters": {
          "color": 7,
          "width": 300,
          "height": 520,
          "content": "## 6Ô∏è‚É£ Image Archiving to Multiple Cloud Services for Future Use\n\n- Redundant storage: Prevent content loss with multi-location backups\n\n-Searchable repository: Build a library of past content for reference and reuse\n\n- Asset tracking: Maintain records of which images were used for which campaigns\n\n- Compliance documentation: Keep records of published content for regulatory purposes\n\n- Resource optimization: Reuse successful visual assets for future campaigns"
        },
        "typeVersion": 1
      },
      {
        "id": "e0dc7e2a-275f-4389-973a-e0d92af6de6c",
        "name": "Sticky Note27",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1840,
          -40
        ],
        "parameters": {
          "color": 7,
          "width": 260,
          "height": 520,
          "content": "## 7Ô∏è‚É£ Telegram Messaging for Workflow Status \n\n- Real-time notifications: Get immediate alerts about workflow execution\n\n- Error tracking: Quickly identify and address failures in the content pipeline\n\n- Team coordination: Keep stakeholders informed of content progress\n\n- Audit trail: Maintain records of when content was created and published\n\n- Remote monitoring: Track workflow execution from mobile devices"
        },
        "typeVersion": 1
      },
      {
        "id": "0d9940df-faad-4adc-a79f-4b89f2f2d16e",
        "name": "Sticky Note28",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2120,
          -40
        ],
        "parameters": {
          "color": 7,
          "width": 840,
          "height": 280,
          "content": "## 8Ô∏è‚É£ Optional Workflow Reporting to Gmail in with Structured HTML Content\n- Executive summaries: Provide management with clean, formatted reports\n\n- Content approval: Enable stakeholders to review content before publishing\n\n- Performance tracking: Document content metrics in standardized formats\n\n- Schedule adherence: Monitor if content is being published according to plan\n\n- Resource allocation: Track time and effort spent on different content types"
        },
        "typeVersion": 1
      },
      {
        "id": "febb3aa7-d0ed-422a-b115-33863889a152",
        "name": "Sticky Note29",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2120,
          260
        ],
        "parameters": {
          "color": 7,
          "width": 840,
          "height": 260,
          "content": "## 9Ô∏è‚É£ Social Post Archiving to Google Drive for Future Use\n- Content library: Build a searchable repository of all published content\n\n- Performance correlation: Connect content with its performance metrics\n\n- Compliance records: Maintain documentation of published materials\n\n- Content repurposing: Easily find and adapt past successful content\n\n- Campaign documentation: Group related content for campaign analysis"
        },
        "typeVersion": 1
      },
      {
        "id": "697fab77-d1bb-41d8-8683-193230471721",
        "name": "Sticky Note30",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          260,
          -40
        ],
        "parameters": {
          "width": 420,
          "height": 960,
          "content": "## 3Ô∏è‚É£Dynamic System Prompt and Platform Schema Composition based on User Prompt using External Sources\n- Centralized prompt management: Store all system prompts in a single external source for easier maintenance and updates\n\n- Platform-specific optimization: Automatically tailor content to each platform's unique requirements and audience expectations\n\n- Consistent brand voice: Ensure all generated content maintains your brand's tone and messaging guidelines across platforms\n\n- Reduced technical debt: Modify prompts and schemas without changing workflow code or redeploying applications\n\n- Collaborative improvement: Enable marketing teams to refine prompts without developer intervention\n\n- Version control: Track changes to prompts and schemas over time with document revision history\n\n- A/B testing capability: Easily test different prompt variations to optimize content performance\n\n- Scalable content strategy: Add support for new platforms by simply creating new prompt and schema documents\n\n- Dynamic adaptation: Respond to platform algorithm changes by quickly updating external prompt documents\n\n- Knowledge preservation: Maintain institutional knowledge about effective platform-specific content strategies\n\n- Reduced onboarding time: New team members can understand content requirements by reviewing documented prompts\n\n- Compliance management: Ensure all generated content follows legal and brand guidelines by centralizing rules"
        },
        "typeVersion": 1
      },
      {
        "id": "11ba3bef-7036-416b-a63d-a82cf7cbe30f",
        "name": "Prepare Social Media Email Contents",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2300,
          -780
        ],
        "parameters": {
          "text": "=Use the HTML template and populate [fields] as required from this: {{ $('pollinations.ai1').item.json.output.toJsonString() }}\n-----\nOnly output HTML without code block tags, preamble or further explanation in the format provided.\n\n## HTML Template\n<table style=\"max-width:640px;min-width:320px;width:100%;border-collapse:collapse;font-family:Arial,sans-serif;margin:20px auto\">\n    <tbody>\n        <tr>\n            <td colspan=\"2\" style=\"background-color:#ffffff;padding:15px;text-align:left\">\n                <img src=\"{{ $json.thumbnailLink }}\" alt=\"{{ $json.output.root_schema.name }}\" style=\"max-width:100%;height:auto;\">\n            </td>\n        </tr>\n        <tr>\n            <td colspan=\"2\" style=\"background-color:#efefef;padding:15px;font-size:20px;text-align:left;font-weight:bold\">\n                {{ $json.output.root_schema.name  }}\n            </td>\n        </tr>\n        <tr>\n            <td style=\"background-color:#f9f9f9;padding:15px;width:30%;text-align:left\"><strong>Platform:</strong></td>\n            <td style=\"background-color:#f9f9f9;padding:15px;text-align:left\">{{ $('Compose Prompt & Schema').item.json.route }}</td>\n        </tr>\n        <tr>\n            <td style=\"background-color:#f9f9f9;padding:15px;width:30%;text-align:left\"><strong>[label_1]:</strong></td>\n            <td style=\"background-color:#f9f9f9;padding:15px;text-align:left\">[content_1]</td>\n        </tr>\n        <tr>\n            <td style=\"background-color:#f1f1f1;padding:15px;text-align:left\"><strong>[label_2]:</strong></td>\n            <td style=\"background-color:#f1f1f1;padding:15px;text-align:left\">[content_2]</td>\n        </tr>\n\n        [continue the pattern ...]\n\n        <tr>\n            <td colspan=\"2\" style=\"background-color:#efefef;padding:15px;text-align:left\">\n                <strong>[footer_label]:</strong> [footer_content]\n            </td>\n        </tr>\n    </tbody>\n</table>\n\n",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "1dc19a25-ff27-4582-a574-279831f7bc28",
        "name": "Sticky Note43",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -760,
          -340
        ],
        "parameters": {
          "height": 500,
          "content": "üí°Notes\n\n- Create Google Doc for the Social Media Schema and copy the provided schema.\n\n- Update the Google Doc ID in the Social Media Schema node.\n\n- Create Google Doc for the Social Media System Prompt and copy the provided System Prompt.\n\n- Update the Google Doc ID in the Social Media System Prompt node.\n\n\n\nAdjust system prompt and platform specific prompts to suit your needs."
        },
        "typeVersion": 1
      },
      {
        "id": "6b1d2ad9-9ad8-4a33-ab7d-430f96dc317c",
        "name": "Sticky Note44",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1340,
          -360
        ],
        "parameters": {
          "width": 300,
          "content": "üí°Notes\n\nReplace pollinations.ai with any online image generation service that produces an image file you can download."
        },
        "typeVersion": 1
      },
      {
        "id": "e7c2d9ba-6b9a-404f-a84d-8e90e4c5f4bb",
        "name": "Sticky Note45",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          720,
          -840
        ],
        "parameters": {
          "width": 400,
          "height": 140,
          "content": "üí°Notes\n\nReplace Chat model with other LLMs and test out the results.  Add more tools or try other web search tools to suit your use case."
        },
        "typeVersion": 1
      },
      {
        "id": "00204106-dd0f-46d5-89c8-60fd92f1388e",
        "name": "gpt-4o",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -520,
          -1620
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "gpt-4o"
          },
          "options": {
            "responseFormat": "json_object"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      }
    ],
    "active": false,
    "pinData": {
      "Social Media Schema": [
        {
          "json": {
            "content": "<common>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"hashtags\": {\n            \"type\": \"array\",\n            \"items\": {\n                \"type\": \"string\"\n            }\n        },\n        \"image_suggestion\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</common>\n\n<root>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"name\": {\n            \"type\": \"string\"\n        },\n        \"description\": {\n            \"type\": \"string\"\n        },\n        \"additional_notes\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</root>\n\n<linkedin>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"post\": {\n            \"type\": \"string\"\n        },\n        \"call_to_action\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</linkedin>\n\n<instagram>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"caption\": {\n            \"type\": \"string\"\n        },\n        \"emojis\": {\n            \"type\": \"array\",\n            \"items\": {\n                \"type\": \"string\"\n            }\n        },\n        \"call_to_action\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</instagram>\n\n<facebook>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"post\": {\n            \"type\": \"string\"\n        },\n        \"call_to_action\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</facebook>\n\n<xtwitter>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"video_suggestion\": {\n            \"type\": \"string\"\n        },\n        \"post\": {\n            \"type\": \"string\"\n        },\n        \"character_limit\": {\n            \"type\": \"integer\"\n        }\n    }\n}\n</xtwitter>\n\n<threads>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"text_post\": {\n            \"type\": \"string\"\n        },\n        \"call_to_action\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</threads>\n\n<youtube_short>\n{\n    \"type\": \"object\",\n    \"properties\": {\n        \"video_suggestion\": {\n            \"type\": \"string\"\n        },\n        \"title\": {\n            \"type\": \"string\"\n        },\n        \"description\": {\n            \"type\": \"string\"\n        },\n        \"call_to_action\": {\n            \"type\": \"string\"\n        }\n    }\n}\n</youtube_short>\n\n\n\n",
            "documentId": "[your-doc-id-here]"
          }
        }
      ],
      "Social Media System Prompt": [
        {
          "json": {
            "content": "<system>\nYou are a specialized content creation AI for social media platforms.\nYour primary function is generating platform-optimized social media content across various platforms including LinkedIn, Instagram, Facebook, Twitter (X), Threads, and YouTube Shorts. Each piece of content must:\nMatch the specific platform's audience expectations and algorithm preferences\nShowcase relevant expertise in your field\nDeliver actionable insights for your target audience\nDrive meaningful engagement through value-driven content\nOBJECTIVES:\nCreate platform-specific content following each platform's best practices\nImplement strategic hashtag usage combining general and trending tags\nDesign content that encourages user interaction and community building\nMaintain consistent brand voice while adapting to platform requirements\nIncorporate data-driven insights to maximize content performance\nOUTPUT REQUIREMENTS:\nDeliver content in valid JSON format according to the platform-specific schema\nInclude all required fields as specified in the schema\nOmit any explanatory text or code fencing in your response\nTailor content specifically to the platform indicated in the user's request\nFor each content request, adapt your output based on the platform guidelines and ensure it aligns with your organization's mission and values.  Never provide URLS for video or image suggestions and only describe the suggestion.\n</system>\n\n\n<rules>\n- Only provide final response in valid JSON for the appropriate social platform\n- Never include any preamble or further explanation\n- Always remove any ``` ```json\n</rules>\n\n\n<linkedin>\n**Style**: Professional and insightful.\n**Tone**: Business-oriented; focus on automation use cases, industry insights, and community impact.\n**Content Length**: 3-4 sentences; concise but detailed.\n**Hashtags**: #Innovation #Automation #WorkflowSolutions #DigitalTransformation #Leadership\n**Call to Action (CTA)**: Encourage comments or visits to workflows.diy's website for more insights.\n</linkedin>\n\n<instagram>\n**Style**: Visual storytelling with creative captions.\n**Tone**: Inspirational and engaging; use emojis for relatability.\n**Content Length**: 2-3 sentences paired with eye-catching visuals (e.g., infographics or workflow demos).\n**Visuals**: Showcase milestones (e.g., new workflow launches), tutorials, or product highlights.\n**CTA**: Use phrases like \"Swipe to learn more,\" \"Tag your team,\" or \"Check out the link below!\"\n**Link Placement**: Add the provided link before hashtags; if no link is provided, use \"Visit our website: https://workflows.diy.\"\n**Hashtags**: #AutomationLife #TechInnovation #WorkflowTips #Programming #Engineering\n</instagram>\n\n<facebook>\n**Style**: Friendly and community-focused.\n**Tone**: Relatable; highlight user success stories or company achievements in automation.\n**Content Length**: 2-3 sentences; conversational yet professional.\n**Hashtags**: #SmallBusinessAutomation #Entrepreneurship #Leadership #WorkflowInnovation\n**CTA**: Encourage likes, shares, comments (e.g., \"What's your favorite automation tip?\").\n</facebook>\n\n<xtwitter>\n**Style**: Concise and impactful.\n**Tone**: Crisp and engaging; spark curiosity in 150 characters or less.\n**Hashtags**: #WorkflowTrends #AIWorkflows #AutomationTips #NoCodeSolutions\n**CTA**: Drive quick engagement through retweets or replies (e.g., \"What's your go-to n8n workflow?\").\n</xtwitter>\n\n<threads>\n**Style**: Conversational and community-driven posts.\n**Tone**: Casual yet informative; encourage discussions around automation trends or innovations.\n**Content Length**: 1-2 short paragraphs with a question or thought-provoking statement at the end.\n**Hashtags**: Similar to Instagram but tailored for trending Threads topics related to automation.\n</threads>\n\n<youtube_short>\n**Style**: Short-form video content showcasing quick workflow tutorials or use cases.\n**Tone**: Authoritative yet approachable; establish workflows.diy as a leader in n8n automation solutions.\n**Content Length**:\n  - Tutorials/Reviews (long-form): 5-10 minutes\n  - Shorts/Highlights (short-form): Under 1 minute\n**CTA**: Encourage subscriptions, likes, comments (e.g., \"Subscribe for more workflow tips!\").\n</youtube_short>\n\n\n\n",
            "documentId": "[your-doc-id-here]"
          }
        }
      ],
      "When Executed by Another Workflow": [
        {
          "json": {
            "route": "instagram",
            "user_prompt": "i need an instagram post about using n8n to transform business automation with reference to a related historical fact and example"
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "110ac387-48e7-4ed2-98d6-0e3ddbb34063",
    "connections": {
      "Gmail": {
        "main": [
          []
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "Prepare Social Media Email Contents",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Drive Image Meta",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Short": {
        "ai_tool": [
          [
            {
              "node": "ü§ñSocial Media Router Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Schema": {
        "main": [
          [
            {
              "node": "Parse Schema",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "X Post": {
        "main": [
          [
            {
              "node": "X Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "gpt-4o": {
        "ai_languageModel": [
          [
            {
              "node": "ü§ñSocial Media Router Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "File Id": {
        "main": [
          [
            {
              "node": "Get Social Post from Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "SerpAPI": {
        "ai_tool": [
          [
            {
              "node": "Social Media Content Creator",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Facebook": {
        "ai_tool": [
          [
            {
              "node": "ü§ñSocial Media Router Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "LinkedIn": {
        "ai_tool": [
          [
            {
              "node": "ü§ñSocial Media Router Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "X-Twiter": {
        "ai_tool": [
          [
            {
              "node": "ü§ñSocial Media Router Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Instagram": {
        "ai_tool": [
          [
            {
              "node": "ü§ñSocial Media Router Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "gpt-40-mini": {
        "ai_languageModel": [
          [
            {
              "node": "Prepare Social Media Email Contents",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "gpt-4o-mini": {
        "ai_languageModel": [
          [
            {
              "node": "Social Media Content Creator",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Is Approved?": {
        "main": [
          [
            {
              "node": "Get Social Post Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Schema": {
        "main": [
          [
            {
              "node": "Merge Prompts and Schema",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "gpt-40-mini1": {
        "ai_languageModel": [
          [
            {
              "node": "Prepare Email Contents",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Facebook Post": {
        "main": [
          [
            {
              "node": "Facebook Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "LinkedIn Post": {
        "main": [
          [
            {
              "node": "LinkedIn Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "System Prompt": {
        "main": [
          [
            {
              "node": "Parse System Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "YouTube Short": {
        "ai_tool": [
          [
            {
              "node": "ü§ñSocial Media Router Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Social Content": {
        "main": [
          [
            {
              "node": "pollinations.ai1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract as JSON": {
        "main": [
          [
            {
              "node": "Merge Image and Post Contents",
              "type": "main",
              "index": 0
            },
            {
              "node": "Prepare Email Contents",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Instagram Image": {
        "main": [
          [
            {
              "node": "Instragram Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Instragram Post": {
        "main": [
          [
            {
              "node": "Instagram Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Social Post JSON": {
        "main": [
          [
            {
              "node": "Save Social Post to Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "pollinations.ai1": {
        "main": [
          [
            {
              "node": "Telegram Success Message (Optional)",
              "type": "main",
              "index": 0
            },
            {
              "node": "Save Image to imgbb.com",
              "type": "main",
              "index": 0
            },
            {
              "node": "Save Image to Google Drive",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ],
          [
            {
              "node": "Telegram Error Message (Optional)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse System Prompt": {
        "main": [
          [
            {
              "node": "Merge Prompts and Schema",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Social Media Schema": {
        "main": [
          [
            {
              "node": "Schema",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Window Buffer Memory": {
        "ai_memory": [
          [
            {
              "node": "ü§ñSocial Media Router Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Get Social Post Image": {
        "main": [
          [
            {
              "node": "Merge Image and Post Contents",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Prepare Email Contents": {
        "main": [
          [
            {
              "node": "Gmail User for Approval",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Compose Prompt & Schema": {
        "main": [
          [
            {
              "node": "Social Media Content Creator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail User for Approval": {
        "main": [
          [
            {
              "node": "Is Approved?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Drive Image Meta": {
        "main": [
          [
            {
              "node": "Social Post JSON",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Image to imgbb.com": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge Prompts and Schema": {
        "main": [
          [
            {
              "node": "Compose Prompt & Schema",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Image to Google Drive": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Social Media System Prompt": {
        "main": [
          [
            {
              "node": "System Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "ü§ñSocial Media Router Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Social Media Content Creator": {
        "main": [
          [
            {
              "node": "Social Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge Image and Post Contents": {
        "main": [
          [
            {
              "node": "Social Media Publishing Router",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ü§ñSocial Media Router Agent": {
        "main": [
          [
            {
              "node": "File Id",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Social Media Publishing Router": {
        "main": [
          [
            {
              "node": "X Post",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Instagram Image",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Facebook Post",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "LinkedIn Post",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Implement Threads Here",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Implement YouTube Shorts Here",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Social Post to Google Drive": {
        "main": [
          [
            {
              "node": "Respond with Google Drive Id",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Social Post from Google Drive": {
        "main": [
          [
            {
              "node": "Extract as JSON",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "Social Media System Prompt",
              "type": "main",
              "index": 0
            },
            {
              "node": "Social Media Schema",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge Prompts and Schema",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Prepare Social Media Email Contents": {
        "main": [
          [
            {
              "node": "Gmail",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "76LqncXo7HU6frDp",
    "meta": {
      "instanceId": "dd69efaf8212c74ad206700d104739d3329588a6f3f8381a46a481f34c9cc281",
      "templateCredsSetupCompleted": true
    },
    "name": "Send Tour Payment Reminders with Payment Links",
    "tags": [],
    "nodes": [
      {
        "id": "33b5aa5a-20c2-4394-8136-427abc8fb678",
        "name": "Prepare WhatsApp Reminder",
        "type": "n8n-nodes-base.code",
        "position": [
          720,
          336
        ],
        "parameters": {
          "jsCode": "const tourData = $input.first().json;\n\nconst whatsappMessage = `‚úàÔ∏è *Tour Payment Reminder*\\n\\nDear ${tourData.travelerName},\\n\\nüí∞ Payment for *${tourData.tourName}*\\nüíµ Amount Due: $${tourData.amountDue}\\nüìÖ Tour Date: ${tourData.tourDate}\\n‚è∞ ${tourData.daysRemaining} days remaining\\n\\nüîó *Pay Now:* ${tourData.paymentLink}\\n\\n_Please complete the payment before the tour to secure your booking._\\n\\nTravel Agency`;\n\nreturn [{\n  json: {\n    phone: tourData.phone,\n    message: whatsappMessage,\n    travelerName: tourData.travelerName,\n    tourName: tourData.tourName,\n    paymentLink: tourData.paymentLink\n  }\n}];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "a8e0a132-88d4-4f04-9fe9-f2d2efe8cb89",
        "name": "Update Reminder Status",
        "type": "n8n-nodes-base.microsoftExcel",
        "position": [
          1168,
          336
        ],
        "parameters": {
          "options": {},
          "dataMode": "autoMap",
          "resource": "worksheet",
          "workbook": {
            "__rl": true,
            "mode": "id",
            "value": "=fee-records-workbook"
          },
          "operation": "update",
          "worksheet": {
            "__rl": true,
            "mode": "id",
            "value": "=345yhhgt43wedf"
          },
          "columnToMatchOn": "=name"
        },
        "credentials": {
          "microsoftExcelOAuth2Api": {
            "id": "jevPChvDpEJk6W9v",
            "name": "Microsoft Excel account - test"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "030b1fe5-b3e6-4243-8902-35f7c2b77c93",
        "name": "Read Pending Travel Payment",
        "type": "n8n-nodes-base.microsoftExcel",
        "position": [
          272,
          336
        ],
        "parameters": {
          "filters": {
            "fields": [
              {
                "value": "Pending",
                "column": "Status"
              }
            ]
          },
          "resource": "worksheet",
          "workbook": {
            "__rl": true,
            "mode": "id",
            "value": "=nhjiko987uyhn"
          }
        },
        "credentials": {
          "microsoftExcelOAuth2Api": {
            "id": "jevPChvDpEJk6W9v",
            "name": "Microsoft Excel account - test"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "2e32c9a2-2415-4efd-913f-c050c70e68d0",
        "name": "Daily Payment Check - 7 AM",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          48,
          336
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 7
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "dd933644-7cb7-4f7a-a46e-c607f53373ba",
        "name": "Process Payment Reminders",
        "type": "n8n-nodes-base.code",
        "position": [
          496,
          336
        ],
        "parameters": {
          "jsCode": "const currentDate = new Date();\nconst reminderDate = new Date();\nreminderDate.setDate(currentDate.getDate() + 3); // Remind 3 days before tour/payment\n\nconst tourRecords = $input.all(); // All tour booking records\nconst reminders = [];\n\nfor (const record of tourRecords) {\n  const tourData = record.json;\n  const tourDate = new Date(tourData.tourDate); // Tour start date\n  \n  if (tourDate <= reminderDate && tourDate > currentDate) {\n    const paymentLink = `https://payments.travelplatform.com/pay?traveler=${tourData.travelerId}&amount=${tourData.amountDue}&ref=${tourData.bookingId}`;\n    \n    reminders.push({\n      travelerName: tourData.travelerName,\n      email: tourData.email,\n      phone: tourData.phone,\n      tourName: tourData.tourName,\n      amountDue: tourData.amountDue,\n      tourDate: tourData.tourDate,\n      bookingId: tourData.bookingId,\n      paymentLink: paymentLink,\n      daysRemaining: Math.ceil((tourDate - currentDate) / (1000 * 60 * 60 * 24))\n    });\n  }\n}\n\nreturn reminders.map(item => ({ json: item }));\n"
        },
        "typeVersion": 2
      },
      {
        "id": "64d6d6f9-e19c-4d13-a13f-301f3d22aadc",
        "name": "Send Email Reminder",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          944,
          560
        ],
        "webhookId": "0f88b663-53bd-4ce5-8258-ec93880780fe",
        "parameters": {
          "text": "={{$json.body}}",
          "options": {},
          "subject": "={{$json.subject}}",
          "toEmail": "={{$json.to}}",
          "fromEmail": "tour@gmail.com",
          "emailFormat": "text"
        },
        "credentials": {
          "smtp": {
            "id": "G1kyF8cSWTZ4vouN",
            "name": "SMTP -test"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "d32a00bb-ce08-46b8-9f99-74a85c1b21de",
        "name": "Daily Payment Check - 7 PM",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          48,
          560
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 19
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "5fe702d0-d962-4079-8a34-db870a2dc713",
        "name": "Check Pending Payment",
        "type": "n8n-nodes-base.microsoftExcel",
        "position": [
          272,
          560
        ],
        "parameters": {
          "filters": {
            "fields": [
              {
                "value": "Pending",
                "column": "Status"
              }
            ]
          },
          "resource": "worksheet",
          "workbook": {
            "__rl": true,
            "mode": "id",
            "value": "=nhjiko987uyhn"
          }
        },
        "credentials": {
          "microsoftExcelOAuth2Api": {
            "id": "jevPChvDpEJk6W9v",
            "name": "Microsoft Excel account - test"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "e9624483-19b9-4008-88b7-281545886494",
        "name": "Create Payment Reminders",
        "type": "n8n-nodes-base.code",
        "position": [
          496,
          560
        ],
        "parameters": {
          "jsCode": "const currentDate = new Date();\nconst reminderDate = new Date();\nreminderDate.setDate(currentDate.getDate() + 3); // Remind 3 days before tour/payment\n\nconst tourRecords = $input.all(); // All tour booking records\nconst reminders = [];\n\nfor (const record of tourRecords) {\n  const tourData = record.json;\n  const tourDate = new Date(tourData.tourDate); // Tour start date\n  \n  if (tourDate <= reminderDate && tourDate > currentDate) {\n    const paymentLink = `https://payments.travelplatform.com/pay?traveler=${tourData.travelerId}&amount=${tourData.amountDue}&ref=${tourData.bookingId}`;\n    \n    reminders.push({\n      travelerName: tourData.travelerName,\n      email: tourData.email,\n      phone: tourData.phone,\n      tourName: tourData.tourName,\n      amountDue: tourData.amountDue,\n      tourDate: tourData.tourDate,\n      bookingId: tourData.bookingId,\n      paymentLink: paymentLink,\n      daysRemaining: Math.ceil((tourDate - currentDate) / (1000 * 60 * 60 * 24))\n    });\n  }\n}\n\nreturn reminders.map(item => ({ json: item }));\n"
        },
        "typeVersion": 2
      },
      {
        "id": "2a2c09fa-9d44-43e9-96cc-cad33f8fb39f",
        "name": "Make Reminder For Email",
        "type": "n8n-nodes-base.code",
        "position": [
          720,
          560
        ],
        "parameters": {
          "jsCode": "const tourData = $input.first().json;\n\nconst email = `‚úàÔ∏è *Tour Payment Reminder*\\n\\nDear ${tourData.travelerName},\\n\\nüí∞ Payment for *${tourData.tourName}*\\nüíµ Amount Due: $${tourData.amountDue}\\nüìÖ Tour Date: ${tourData.tourDate}\\n‚è∞ ${tourData.daysRemaining} days remaining\\n\\nüîó *Pay Now:* ${tourData.paymentLink}\\n\\n_Please complete the payment before the tour to secure your booking._\\n\\nTravel Agency`;\n\nreturn [{\n  json: {\n    phone: tourData.phone,\n    message: email,\n    travelerName: tourData.travelerName,\n    tourName: tourData.tourName,\n    paymentLink: tourData.paymentLink\n  }\n}];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "fae21a72-36cf-478d-9906-4d97d0e4469c",
        "name": "Send Message",
        "type": "n8n-nodes-base.whatsApp",
        "position": [
          944,
          336
        ],
        "webhookId": "6ca3982e-1f7a-46f5-a731-4d3dc40266bf",
        "parameters": {
          "textBody": "={{$json.body}}",
          "operation": "send",
          "phoneNumberId": "=+919388776655",
          "additionalFields": {},
          "recipientPhoneNumber": "={{$json.toforwp}}"
        },
        "credentials": {
          "whatsAppApi": {
            "id": "b0PxTDPdWzznWnfG",
            "name": "WhatsApp-test "
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e4b973e6-1cb5-4fe0-91a6-72ae9d262747",
        "name": "Update Status Of Reminder",
        "type": "n8n-nodes-base.microsoftExcel",
        "position": [
          1168,
          560
        ],
        "parameters": {
          "options": {},
          "dataMode": "autoMap",
          "resource": "worksheet",
          "workbook": {
            "__rl": true,
            "mode": "id",
            "value": "=fee-records-workbook"
          },
          "operation": "update",
          "worksheet": {
            "__rl": true,
            "mode": "id",
            "value": "=345yhhgt43wedf"
          },
          "columnToMatchOn": "=name"
        },
        "credentials": {
          "microsoftExcelOAuth2Api": {
            "id": "jevPChvDpEJk6W9v",
            "name": "Microsoft Excel account - test"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "80be7c99-ff21-4c7a-9576-0d03ba231628",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          368,
          -176
        ],
        "parameters": {
          "color": 4,
          "width": 608,
          "height": 192,
          "content": "## üöÄ Key Features\n- ‚è∞ Scheduled Daily Execution ‚Äì Fully automated at 7 AM and 7 PM  \n- üßÆ Due-Date Filtering ‚Äì Only targets payments due in the next 3 days  \n- üí¨ Multi-Channel Notifications ‚Äì Sends reminders via both Email and WhatsApp  \n- üîó Secure Payment Links ‚Äì Auto-generated for each traveler  \n- üîÑ Reminder Tracking ‚Äì Prevents duplicate reminders by updating status  "
        },
        "typeVersion": 1
      },
      {
        "id": "5411a3c8-b897-46f5-a71d-3d154738ceb1",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          368,
          -400
        ],
        "parameters": {
          "color": 3,
          "width": 608,
          "height": 192,
          "content": "## Description:\n\nThis workflow automatically notifies travelers about their pending trip payments and provides secure payment links through Email and WhatsApp. It runs twice daily (at 7 AM and 7 PM) to ensure timely reminders before the due date. Designed for travel agencies, it simplifies payment tracking, reduces manual follow-up, and ensures every traveler receives personalized reminders with real-time payment status updates."
        },
        "typeVersion": 1
      },
      {
        "id": "cb85e01a-051c-4d26-b6f7-d2fb8bf43708",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1072,
          -336
        ],
        "parameters": {
          "color": 5,
          "width": 608,
          "height": 288,
          "content": "## Purpose:\n\nThis workflow ensures automated, accurate, and timely payment reminders, helping travel agencies:\n\n- Maintain smooth cash flow\n\n- Minimize overdue payments\n\n- Provide a professional and automated customer communication experience"
        },
        "typeVersion": 1
      },
      {
        "id": "7dd63f3c-14bd-4a6c-b4f5-0c5be5a57546",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -448,
          32
        ],
        "parameters": {
          "width": 784,
          "height": 432,
          "content": "## Morning Flow (7 AM)\n\n- Daily Payment Check ‚Äì 7 AM:\nScheduled trigger initiates the process.\n\n- Read Pending Travel Payment:\nReads all pending payment records from the Google Sheet.\n\n- Process Payment Reminders:\nFilters records based on due date and payment status.\n\n- Prepare WhatsApp Reminder:\nFormats personalized message content with traveler name, amount, due date, and secure payment link.\n\n- Send Message:\nSends the WhatsApp message automatically.\n\n- Update Reminder Status:\nUpdates the record in the Google Sheet as ‚ÄúReminder Sent‚Äù."
        },
        "typeVersion": 1
      },
      {
        "id": "8a167f62-bc36-4940-9a14-fcedb0696c64",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -448,
          544
        ],
        "parameters": {
          "color": 6,
          "width": 784,
          "height": 432,
          "content": "## Evening Flow (7 PM)\n\n- Daily Payment Check ‚Äì 7 PM:\nScheduled trigger for the evening run.\n\n- Check Pending Payment:\nReads pending payment data again to catch newly added records.\n\n- Create Payment Reminders:\nFilters and prepares records for reminder generation.\n\n- Make Reminder For Email:\nCreates customized email content for each traveler.\n\n- Send Email Reminder:\nSends the email reminders with payment details and link.\n\n- Update Status Of Reminder:\nUpdates the traveler‚Äôs record to avoid duplicate notifications."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "ad02aa2c-8239-46d8-9be1-0508458f6ac1",
    "connections": {
      "Send Message": {
        "main": [
          [
            {
              "node": "Update Reminder Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Email Reminder": {
        "main": [
          [
            {
              "node": "Update Status Of Reminder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Pending Payment": {
        "main": [
          [
            {
              "node": "Create Payment Reminders",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Make Reminder For Email": {
        "main": [
          [
            {
              "node": "Send Email Reminder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Payment Reminders": {
        "main": [
          [
            {
              "node": "Make Reminder For Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare WhatsApp Reminder": {
        "main": [
          [
            {
              "node": "Send Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Process Payment Reminders": {
        "main": [
          [
            {
              "node": "Prepare WhatsApp Reminder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Daily Payment Check - 7 AM": {
        "main": [
          [
            {
              "node": "Read Pending Travel Payment",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Daily Payment Check - 7 PM": {
        "main": [
          [
            {
              "node": "Check Pending Payment",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Pending Travel Payment": {
        "main": [
          [
            {
              "node": "Process Payment Reminders",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "vmo7vbtthypEoBXC",
    "meta": {
      "instanceId": "740c1df6d3b1b6ea8a9d2223701f6904173f9e3cf7381cd181644b043420ba09"
    },
    "name": "AI Automated X (Twitter) post publisher- Build your personal brand",
    "tags": [],
    "nodes": [
      {
        "id": "ad01801d-b508-4bc9-bbd5-3927c199c2a6",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1620,
          820
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "d2iBjQ0eOMCYOYLG",
            "name": "OpenAi TEST API"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "bae17025-e1ab-41c3-ae2e-c600cac67605",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          1760,
          820
        ],
        "parameters": {
          "sessionKey": "1784315684",
          "sessionIdType": "customKey",
          "contextWindowLength": 25
        },
        "typeVersion": 1.3
      },
      {
        "id": "182833e2-dbca-4f27-adb8-8e440f5aea53",
        "name": "Get_Brand_Brief",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          1900,
          820
        ],
        "parameters": {
          "name": "Get_Brand_Brief",
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "NannfIKD8dUY1iOW",
            "cachedResultName": "Get Brand Brief"
          },
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "5aaf4e5d-8448-4ab8-a447-056d08746003",
        "name": "Get_Content_Fedback",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          2060,
          820
        ],
        "parameters": {
          "name": "Get_Content_Fedback",
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "xdg5KIv5xSaMXBAD",
            "cachedResultName": "Get Content Fedback"
          },
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "525bd859-2d75-4cc1-8589-b0b86916f8c6",
        "name": "AI Content creator",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1800,
          560
        ],
        "parameters": {
          "text": "=Avalible idea for post:\n{{ $json['Post Idea'] }}",
          "options": {
            "maxIterations": 10,
            "systemMessage": "=You are a viral post creator for [YOUR NAME] as personal brand. Use the below steps to create content.\n\nSteps who alwas you must do :\n\n1.Always start by getting the brand brief using the Get_Brand_Brief tool.\n\n2.Create a post on the requested topic that aligns with the brand brief.\n\n3.Get feedback and a score on the post you created in step 2 by using the Get_Content_Feedback tool.\n\n4.If the score is below 0.7, use the feedback from step 3 to refine the post, then repeat steps 3 and 4.\n\n5. Check if this post was createed before usinmg history data form google sheets (Check History), if post was already publish find another  post.\n\n6.The final output should be the approved post.\n\nAlways go for all steps, don't skip any steps. always check post in use of get_content fedback  to check if poist is ok.\n\n\nMaintain a spartan tone of voice. Include emojis where necessary. Be confident, and conversational, creative and funny.This is for Twitter, keep responses 3 sentences maximum. Be offensive and controversial. Always output only lowercase letters. Do not be grammatically correct."
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "0a9670d5-81a4-447e-8e66-e2400ab90e5c",
        "name": "Discord confirm",
        "type": "n8n-nodes-base.discord",
        "position": [
          5680,
          520
        ],
        "webhookId": "4189ef95-876e-4d7c-aea4-89c2a63f852b",
        "parameters": {
          "content": "=Post Send üòç:\n{{ $json.output }}",
          "guildId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "options": {},
          "resource": "message",
          "channelId": {
            "__rl": true,
            "mode": "list",
            "value": "1359075430514167838",
            "cachedResultUrl": "https://discord.com/channels/1241749058217971885/1359075430514167838",
            "cachedResultName": "n8n-post-approval"
          }
        },
        "credentials": {
          "discordBotApi": {
            "id": "Y0I6czAZgnJ8lNoy",
            "name": "Discord Bot TEST"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "034438dd-a001-4a06-87c5-f2a803c7092c",
        "name": "If2",
        "type": "n8n-nodes-base.if",
        "position": [
          4000,
          480
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "86fa3efe-22c2-4689-a89d-3dc8559491c3",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.data.approved }}",
                "rightValue": "true"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "0fe8cc50-a6a8-4c96-b6d0-b80af87c2bde",
        "name": "If1",
        "type": "n8n-nodes-base.if",
        "position": [
          3860,
          680
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "f78093f8-1c7f-486e-bd7a-9095ac16a801",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $('Try Again ').item.json.data.approved }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "9afdf3aa-486d-4240-be87-1917140f696e",
        "name": "Get Brief",
        "type": "n8n-nodes-base.executeWorkflow",
        "position": [
          540,
          560
        ],
        "parameters": {
          "options": {},
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "NannfIKD8dUY1iOW",
            "cachedResultName": "Get Brand Brief"
          },
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "bd92b0a5-445f-4144-b7ef-aeb0efbffe37",
        "name": "Edit Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          1060,
          560
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a5e0b3f6-a9b2-458d-83fd-ccef132fcc9f",
                "name": "Post Idea",
                "type": "array",
                "value": "={{ $json.output.suggestions }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "884baeb8-5840-4e06-a93b-d2fd5164500a",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          880,
          760
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"suggestions\": [\n    \"Create a post about AI in e-commerce.\",\n    \"Create a post about AI-powered sales tools.\"\n  ]\n}\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "5a64cbd2-ffd0-4699-b69c-032f49f821e0",
        "name": "Idea creator",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          700,
          560
        ],
        "parameters": {
          "text": "=You are a professional content writer. Create 10 topic suggestions that align with the provided brand brief.\n\nJSON output format:\n\n{\n  \"suggestions\": [\n    \"Create a post about [...]\",\n    ...\n  ]\n}\n\nBrand brief:\n{{ $json.content }}",
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.6
      },
      {
        "id": "7f959c08-0eb2-42a7-a736-04379cda4da7",
        "name": "When clicking ‚ÄòTest workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          160,
          540
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "f35cad4a-ebc7-4957-81c7-79ffe4c875cc",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          300
        ],
        "parameters": {
          "color": 4,
          "width": 880,
          "height": 760,
          "content": "# Idea creator\n## AI Agent who finds relevant ideas for posts on social media. He finds ideas with help of the brand brief.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "11bca216-111e-49a7-8bf1-5b5a7135a6d6",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1420,
          300
        ],
        "parameters": {
          "color": 4,
          "width": 1000,
          "height": 760,
          "content": "# Content creator\n## Writes the first draft of a post based on the brand brief, with feedback on which post will fit best.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b89b28e9-cbfb-45ab-b227-4d630bf72dcf",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2660,
          780
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "d2iBjQ0eOMCYOYLG",
            "name": "OpenAi TEST API"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c7fb63b2-aa90-4cd8-9967-bb117580aa56",
        "name": "Simple Memory1",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          2820,
          780
        ],
        "parameters": {
          "sessionKey": "45323465",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "a19e6ecf-736a-4d04-94d3-d3f93f0e60e7",
        "name": "Check History",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          2240,
          820
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0/edit#gid=0",
            "cachedResultName": "History"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0/edit?usp=drivesdk",
            "cachedResultName": "Content Creator for X"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "KLhK6ohp33cu17MF",
            "name": "Google Sheets TEST"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "2cbeefd8-2276-42f7-8a43-0705d6482210",
        "name": "Check Examples",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          3120,
          780
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 193556585,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0/edit#gid=193556585",
            "cachedResultName": "Examples"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0/edit?usp=drivesdk",
            "cachedResultName": "Content Creator for X"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "KLhK6ohp33cu17MF",
            "name": "Google Sheets TEST"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "8f4b55ce-1124-442b-9eb4-d1cbeafe42f1",
        "name": "Rewriter",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2840,
          560
        ],
        "parameters": {
          "text": "=Rewrite this post to my style:  {{ $json.output }}",
          "options": {
            "systemMessage": "=You are a viral post Rewriter for [YOUR NAME] as personal brand. Your task is rewrite existing post to his style of speaking and his style of writing. Use the below steps to create content.\n\nSteps who alwas you must do :\n\n1.Anylayze first draw on post in user prompt.\n2.Get Examples form tools  Get_Examples(google sheets) of already writing post,a nd anylaze style of speaking and writing.\n3.Rewrite post with all previus data, match style of user, be a lilt e clever and non to schematic.\n4.The final output should be the approved post.\n\nAlways go for all steps, don't skip any steps. always check post in use of get_content fedback  to check if poist is ok.\n\n\nMaintain a spartan tone of voice. Include emojis where necessary. Be confident, and conversational, creative and funny.This is for Twitter, keep responses 3 sentences maximum. Be offensive and controversial. Always output only lowercase letters. Do not be grammatically correct.\n\n"
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "79825dd7-874c-47ae-b106-c0baec9cd4ea",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2560,
          300
        ],
        "parameters": {
          "color": 4,
          "width": 900,
          "height": 780,
          "content": "# Rewriter\n## This agent rewrites posts to match your style using examples from a Google Sheet.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3d59febf-dca4-47e7-8dfa-9d14c4efb8fa",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3560,
          300
        ],
        "parameters": {
          "color": 5,
          "width": 840,
          "height": 780,
          "content": "# Additional approval\n## Sends the post for approval in a Discord server, or you can use Telgram‚Äîwhichever you prefer. This step is optional.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "dab4e350-684d-44d4-8640-730938a7ee1e",
        "name": "Send post for approval",
        "type": "n8n-nodes-base.discord",
        "position": [
          3720,
          480
        ],
        "webhookId": "be56d68f-4420-4429-806a-e498c305c367",
        "parameters": {
          "guildId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "message": "=Aprove this post:\n{{ $json.output }}",
          "options": {},
          "resource": "message",
          "channelId": {
            "__rl": true,
            "mode": "list",
            "value": "1359075430514167838",
            "cachedResultUrl": "https://discord.com/channels/1241749058217971885/1359075430514167838",
            "cachedResultName": "n8n-post-approval"
          },
          "operation": "sendAndWait",
          "approvalOptions": {
            "values": {
              "approvalType": "double"
            }
          }
        },
        "credentials": {
          "discordBotApi": {
            "id": "Y0I6czAZgnJ8lNoy",
            "name": "Discord Bot TEST"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "cb3e9feb-4c39-4a1e-b666-d8830d1788f6",
        "name": "Try Again ",
        "type": "n8n-nodes-base.discord",
        "position": [
          3660,
          680
        ],
        "webhookId": "be56d68f-4420-4429-806a-e498c305c367",
        "parameters": {
          "guildId": {
            "__rl": true,
            "mode": "list",
            "value": "1241749058217971885",
            "cachedResultUrl": "https://discord.com/channels/1241749058217971885",
            "cachedResultName": "Dark Dynasty"
          },
          "message": "=Try Again ?",
          "options": {},
          "resource": "message",
          "channelId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "operation": "sendAndWait",
          "approvalOptions": {
            "values": {
              "approvalType": "double",
              "approveLabel": "‚úì Try",
              "disapproveLabel": "‚úó Stop"
            }
          }
        },
        "credentials": {
          "discordBotApi": {
            "id": "Y0I6czAZgnJ8lNoy",
            "name": "Discord Bot TEST"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "dd1d7d66-52ea-4037-96e2-8fd156812e67",
        "name": "End of work",
        "type": "n8n-nodes-base.discord",
        "position": [
          3980,
          840
        ],
        "webhookId": "a8499d3f-6d92-4537-b363-aa1d65969aaf",
        "parameters": {
          "content": "End of workflow.",
          "guildId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "options": {},
          "resource": "message",
          "channelId": {
            "__rl": true,
            "mode": "list",
            "value": "1359075430514167838",
            "cachedResultUrl": "https://discord.com/channels/1241749058217971885/1359075430514167838",
            "cachedResultName": "n8n-post-approval"
          }
        },
        "credentials": {
          "discordBotApi": {
            "id": "Y0I6czAZgnJ8lNoy",
            "name": "Discord Bot TEST"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "dd50213b-9b50-4806-b690-d331991df4ce",
        "name": "Confirm of next try",
        "type": "n8n-nodes-base.discord",
        "position": [
          4220,
          680
        ],
        "webhookId": "d943a4a0-c959-4bb3-be34-bf00dcc8d01a",
        "parameters": {
          "content": "Let's try Again",
          "guildId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "options": {},
          "resource": "message",
          "channelId": {
            "__rl": true,
            "mode": "list",
            "value": "1359075430514167838",
            "cachedResultUrl": "https://discord.com/channels/1241749058217971885/1359075430514167838",
            "cachedResultName": "n8n-post-approval"
          }
        },
        "credentials": {
          "discordBotApi": {
            "id": "Y0I6czAZgnJ8lNoy",
            "name": "Discord Bot TEST"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "7d3f3496-0a0b-412f-b954-bad4190cb8a8",
        "name": "Post on X",
        "type": "n8n-nodes-base.twitter",
        "position": [
          4700,
          600
        ],
        "parameters": {
          "text": "={{ $('Rewriter').item.json.output }}",
          "additionalFields": {}
        },
        "credentials": {
          "twitterOAuth2Api": {
            "id": "6F5Tc5ZpvVG1X3YA",
            "name": "XTEST"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "c9a69661-f7a7-472a-b68c-7f6b2f915374",
        "name": "Update history",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          5240,
          640
        ],
        "parameters": {
          "columns": {
            "value": {
              "Post": "={{ $('AI Content creator').item.json.output }}",
              "Time": "={{ $now }}",
              "Published": "TRUE"
            },
            "schema": [
              {
                "id": "Post",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Post",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Time",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Published",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Published",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0/edit#gid=0",
            "cachedResultName": "History"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0/edit?usp=drivesdk",
            "cachedResultName": "Content Creator for X"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "KLhK6ohp33cu17MF",
            "name": "Google Sheets TEST"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "4f1ef715-9e77-4aef-8955-5d81f97d489d",
        "name": "Add post to examples",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          5220,
          420
        ],
        "parameters": {
          "columns": {
            "value": {
              "Examples": "={{ $('AI Content creator').item.json.output }}"
            },
            "schema": [
              {
                "id": "Examples",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Examples",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Examples"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 193556585,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0/edit#gid=193556585",
            "cachedResultName": "Examples"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1fe1JuLiHgjOQxFC95knZRLAh4y1gv3dF_HmE_cpgxE0/edit?usp=drivesdk",
            "cachedResultName": "Content Creator for X"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "KLhK6ohp33cu17MF",
            "name": "Google Sheets TEST"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "62756c10-91f6-4748-a683-362b55b49948",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          4520,
          300
        ],
        "parameters": {
          "color": 5,
          "width": 480,
          "height": 780,
          "content": "# Post On X(Twitter)"
        },
        "typeVersion": 1
      },
      {
        "id": "13ced8cd-4128-41df-bd4a-ae2beaee7cb9",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          5080,
          300
        ],
        "parameters": {
          "color": 5,
          "width": 420,
          "height": 780,
          "content": "# Update History and Examples"
        },
        "typeVersion": 1
      },
      {
        "id": "0dd893d3-7341-4d9a-81ad-09d3f9b2dee8",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          5540,
          300
        ],
        "parameters": {
          "color": 5,
          "width": 360,
          "height": 780,
          "content": "# Confirm of End Workflow"
        },
        "typeVersion": 1
      },
      {
        "id": "966a3c48-78dc-458a-8afb-cbf952943b53",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          960,
          1580
        ],
        "parameters": {
          "inputSource": "passthrough"
        },
        "typeVersion": 1.1
      },
      {
        "id": "36290365-e2d8-4ead-adf2-4382699a80b0",
        "name": "Notion",
        "type": "n8n-nodes-base.notion",
        "position": [
          1180,
          1580
        ],
        "parameters": {
          "blockId": {
            "__rl": true,
            "mode": "url",
            "value": "[YOUR URL]"
          },
          "resource": "block",
          "operation": "getAll",
          "returnAll": true
        },
        "credentials": {
          "notionApi": {
            "id": "xAvGok2FLHbk10Zf",
            "name": "Notion TEST"
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "63902c08-9bfd-4c78-94d9-fabb92d7b948",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          1400,
          1580
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "content"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "0739a1b3-6e20-4a01-9fd2-32e843d78695",
        "name": "Edit Fields1",
        "type": "n8n-nodes-base.set",
        "position": [
          1620,
          1580
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "827e1eab-4db9-4943-ae9e-f4a52b91342a",
                "name": "content",
                "type": "string",
                "value": "={{ $json.content.join() }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "6865e2f7-2099-456d-81f6-ab471c7ed44d",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          1300
        ],
        "parameters": {
          "color": 2,
          "width": 1620,
          "height": 820,
          "content": "# Sub Workflow Get Brand Brief\n## Move to a separate workflow, add the trigger \"When Executed by Another Workflow\", and connect it to the main workflow \"AI Content Creator\".\n"
        },
        "typeVersion": 1
      },
      {
        "id": "1971f2ca-55af-4e28-9af5-fdc00f5a0c80",
        "name": "Get brand brief",
        "type": "n8n-nodes-base.executeWorkflow",
        "position": [
          3200,
          1640
        ],
        "parameters": {
          "options": {},
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "NannfIKD8dUY1iOW",
            "cachedResultName": "Get Brand Brief"
          },
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "7bca5b92-66cd-45ff-9fd4-377ad5055f6c",
        "name": "OpenAI",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          3400,
          1640
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "role": "system",
                "content": "=#RULES\nYou are tasked with evaluating a piece of content written for [YOUR NAME]. Your role is to assess how well the post aligns with ≈Åukasz personal brand, using the below brief as your guide.\n\nPlease analyze the post based on the following criteria:\n\nDoes the post have unwanted artifacts like \"Let's try again\" or \"Here's a new post\"?\n\nDoes the content reflect ≈Åuaksz core values, voice, and style as described in the brief?\n\nDoes it engage ≈Åuaksz target audience as described in the brief?\n\nDoes it emphasize ≈Åuaksz expertise and domain authority as described in the brief?\n\nIs the tone, messaging, and approach consistent with the brief's objectives and positioning?\n\nAfter evaluation, output a score between 0 and 1, representing the alignment between the post and the brand brief. The score should be output in the following JSON format:\n\n\n{\n  \"description\": \"[short description here]\",\n  \"score\": [insert score here]\n}\n\n\n#Brand Brief:\n{{ $json.content }}"
              },
              {
                "content": "={{ $('When Executed by Another Workflow').item.json.query }}"
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "d2iBjQ0eOMCYOYLG",
            "name": "OpenAi TEST API"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "b1116a8f-457e-4227-8f6c-ccd6f84ef0d9",
        "name": "Edit Fields2",
        "type": "n8n-nodes-base.set",
        "position": [
          3780,
          1640
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "fee5f699-a3a7-431e-9d87-b6a0477ba3c8",
                "name": "feedback",
                "type": "string",
                "value": "={{ $json.message.content.description }}"
              },
              {
                "id": "47c14c4f-aefa-4fd4-b94e-64aaeba38b5a",
                "name": "score",
                "type": "number",
                "value": "={{ $json.message.content.score }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "5ec7bc40-fe22-423f-86e9-7701b4faf35e",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2840,
          1320
        ],
        "parameters": {
          "color": 2,
          "width": 1660,
          "height": 800,
          "content": "# Sub Workflow Get Content Feedback\n## Move to a separate workflow, add the trigger \"When Executed by Another Workflow\", and connect it to the main workflow \"AI Content Creator\".\n"
        },
        "typeVersion": 1
      },
      {
        "id": "be9bbe69-6543-4c3d-8cb2-235078fab28e",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 6080,
          "height": 1200,
          "content": "# Main workflow"
        },
        "typeVersion": 1
      },
      {
        "id": "6f224827-8c2b-4b78-9a9f-0ac024af5404",
        "name": "OpenAI Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          680,
          780
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "d2iBjQ0eOMCYOYLG",
            "name": "OpenAi TEST API"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "907c004c-ea40-47de-a315-db88b2f44bd4",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          4760,
          1280
        ],
        "parameters": {
          "color": 3,
          "width": 1220,
          "height": 1020,
          "content": "# ‚úÖ AI X Post Creator ‚Äì Quick Start Guide\n\nThis workflow automatically generates viral posts for your personal brand on X (Twitter).  \nIt creates a content idea based on your brand brief, writes a short post, evaluates the post‚Äôs alignment with your tone, checks if it was published before (via Google Sheets), rewrites if needed, sends it for approval on Discord, publishes to X, and updates history logs.\n\n---\n\n## üîß What You Need to Replace\n\n| Placeholder              | Where to Update                                                       |\n|--------------------------|------------------------------------------------------------------------|\n| **[YOUR NAME]**          | Prompt nodes: `AI Content creator`, `Rewriter`, `OpenAI`              |\n| **[YOUR URL]**           | Node: `Notion` (if you use Notion for brief)                          |\n| **OpenAi API**           | All `OpenAI` nodes ‚Äì add your actual OpenAI credentials               |\n| **Google Sheets **       | All Google Sheets nodes ‚Äì connect your real spreadsheet               |\n| **Discord Bot **         | Discord nodes ‚Äì replace with your bot token & correct channel IDs     |\n| **X**                    | Twitter node ‚Äì add your real X (Twitter) OAuth2 credentials           |\n| **Get Brand Brief**      | Sub-workflow ID ‚Äì must return brand brief as text                     |\n| **Get Content Feedback** | Sub-workflow ID ‚Äì must return post evaluation in JSON (score + notes) |\n\n---\n\n## üß© Required Subworkflows\n\n### 1. **Get Brand Brief**  \nCreate a sub-workflow that returns a brand tone/voice as a single `text` field.\n\n### 2. **Get Content Feedback**  \nCreate another sub-workflow that takes a post and brand brief, then returns:\n\n```json\n{\n  \"description\": \"Short evaluation of the post\",\n  \"score\": 0.0 ‚Äì 1.0\n}\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "272d7ee9-672f-482d-b77a-9ccd6bc7ee84",
    "connections": {
      "If1": {
        "main": [
          [
            {
              "node": "Confirm of next try",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "End of work",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "Post on X",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Try Again ",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Notion": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI": {
        "main": [
          [
            {
              "node": "Edit Fields2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Rewriter": {
        "main": [
          [
            {
              "node": "Send post for approval",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Brief": {
        "main": [
          [
            {
              "node": "Idea creator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Post on X": {
        "main": [
          [
            {
              "node": "Add post to examples",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Try Again ": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "AI Content creator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Idea creator": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check History": {
        "ai_tool": [
          [
            {
              "node": "AI Content creator",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Content creator",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Check Examples": {
        "ai_tool": [
          [
            {
              "node": "Rewriter",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "Rewriter",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Update history": {
        "main": [
          [
            {
              "node": "Discord confirm",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get brand brief": {
        "main": [
          [
            {
              "node": "OpenAI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get_Brand_Brief": {
        "ai_tool": [
          [
            {
              "node": "AI Content creator",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Content creator",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "AI Content creator": {
        "main": [
          [
            {
              "node": "Rewriter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Rewriter",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Idea creator",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Confirm of next try": {
        "main": [
          [
            {
              "node": "AI Content creator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get_Content_Fedback": {
        "ai_tool": [
          [
            {
              "node": "AI Content creator",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Add post to examples": {
        "main": [
          [
            {
              "node": "Update history",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send post for approval": {
        "main": [
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Idea creator",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "Notion",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Get Brief",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "4a11afdb3c52fd098e3eae9fad4b39fdf1bbcde142f596adda46c795e366b326"
    },
    "nodes": [
      {
        "id": "17ca0437-6101-4277-9ed2-e37e6b92df02",
        "name": "When clicking 'Test workflow'",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -160,
          280
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "d3dd600a-2ab5-4d52-92ef-ab3f29dd1790",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          260,
          400
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "c29d58a2-243b-41ab-99c6-f8a8c92219cf",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          460,
          400
        ],
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"message\": {\n      \"type\": \"string\"\n    },\n    \"mail_object\": {\n      \"type\": \"string\"\n    }\n  }\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "3cb31448-5bc3-47c2-a119-d9e33a464d1f",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -160,
          80
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "18b243a5-db1f-4a27-a8a1-3a7c74135d6d",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          580,
          20
        ],
        "parameters": {
          "width": 260,
          "height": 120,
          "content": "## ElevenlabsAPI key\n**Click** to get your Elevenlabs  API key. [Elevenlabs](https://try.elevenlabs.io/text-audio)"
        },
        "typeVersion": 1
      },
      {
        "id": "62a9bd08-27f8-45a8-9eb4-30950500a36f",
        "name": "Change filename",
        "type": "n8n-nodes-base.code",
        "position": [
          880,
          180
        ],
        "parameters": {
          "jsCode": "/*\n * Filename: addFileName.js\n * Purpose: Add a file name to binary data in an n8n workflow using mail_object from input\n */\n\nconst mailObject = $input.first().json.output.mail_object;\nconst fileName = `${mailObject}.mp3`;\n\nreturn items.map(item => {\n  if (item.binary && item.binary.data) {\n    item.binary.data.fileName = fileName;\n  }\n  return item;\n});"
        },
        "typeVersion": 2
      },
      {
        "id": "41043058-ca06-4c3a-8b7d-597e2941d92b",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1020,
          20
        ],
        "parameters": {
          "width": 300,
          "height": 120,
          "content": "## Gmail API Credentials  \n**Click here** to view the [documentation](https://docs.n8n.io/integrations/builtin/credentials/google/) and configure your access permissions for the Google Gmail API."
        },
        "typeVersion": 1
      },
      {
        "id": "3475e3ae-439d-4245-8994-4444266a67e3",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "width": 300,
          "height": 140,
          "content": "## Calendar API Credentials  \n**Click here** to view the [documentation](https://docs.n8n.io/integrations/builtin/credentials/google/) and configure your access permissions for the Google Calendar API."
        },
        "typeVersion": 1
      },
      {
        "id": "7784fc2d-3e64-40f0-990f-965fba4ad67c",
        "name": "Generate Voice Reminder",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          660,
          180
        ],
        "parameters": {
          "url": "https://api.elevenlabs.io/v1/text-to-speech/JBFqnCBsd6RMkjVDRZzb",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "text",
                "value": "={{ $json.output.message }}"
              },
              {
                "name": "model_id",
                "value": "eleven_multilingual_v2"
              }
            ]
          },
          "genericAuthType": "httpCustomAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "output_format",
                "value": "mp3_22050_32"
              }
            ]
          }
        },
        "notesInFlow": true,
        "retryOnFail": true,
        "typeVersion": 4.2
      },
      {
        "id": "a2081f29-493b-43c0-bad5-1b273d5db527",
        "name": "Send Voice Reminder",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1100,
          180
        ],
        "webhookId": "5ba2c8cb-84f1-4363-8410-b8d138286c3a",
        "parameters": {
          "sendTo": "={{ $('Get Appointments').item.json.attendees[0].email }}",
          "message": "=üëá Information for tomorrow üó£Ô∏è",
          "options": {
            "senderName": "John Carpenter",
            "attachmentsUi": {
              "attachmentsBinary": [
                {}
              ]
            },
            "appendAttribution": false
          },
          "subject": "={{ $('create message').item.json.output.mail_object }}"
        },
        "typeVersion": 2.1
      },
      {
        "id": "dd3bf7b2-f951-452a-8912-47ceace50cc0",
        "name": "create message",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          280,
          180
        ],
        "parameters": {
          "text": "=name: {{ $json.summary }}\ntime: {{ $json.start.dateTime }}\naddress: {{ $json.location }}\nToday's date: {{ $now }}",
          "messages": {
            "messageValues": [
              {
                "message": "=You are an assistant. You will create a structured message in JSON.\n\n**\nmessage:\nGenerate a voice script reminder for a real estate appointment. The message should be clear, professional, and engaging.\n\nIt must include:\n1. The recipient's name.\n2. The date and time of the appointment, expressed naturally (e.g., at noon, quarter past noon, half past three, quarter to five).\n3. The complete address of the property, expressed naturally (e.g., 12 Baker Street in London, Madison Avenue in New York, 5 Oakwood Drive in Los Angeles).\n4. A mention of the sender: Mr. John Carpenter from Super Agency.\n5. A confirmation sentence or an invitation to contact if needed.\n\nInput variables:\n‚Ä¢ Recipient's name (prefixed with Mr. or Ms.)\n‚Ä¢ Time: Appointment time\n‚Ä¢ Address: Complete property address (only the street, number, and city; not the postal code)\n\nThe tone should be cordial and professional, suitable for an automated voice message.\n\nExample expected output: \"Hello Mrs. Richard, this is Mr. John Carpenter from Super Immo Agency.\nI am reminding you of your appointment scheduled for tomorrow at 8:15, at 63 Taverniers Road in Talence. If you have any questions or need to reschedule, please do not hesitate to contact me. See you tomorrow and have a great day!\"\n\n**\nmail_object: a very short email subject\nExample: Your appointment reminder for tomorrow"
              }
            ]
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.5
      },
      {
        "id": "63806db8-6814-4fe4-ba2e-80511273ee51",
        "name": "Get Appointments",
        "type": "n8n-nodes-base.googleCalendar",
        "position": [
          60,
          180
        ],
        "parameters": {
          "limit": 2,
          "options": {},
          "timeMax": "={{ $now.plus({ day: 2 }) }}",
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "mymail@gmail.com",
            "cachedResultName": "mymail@gmail.com"
          },
          "operation": "getAll"
        },
        "typeVersion": 1.3
      }
    ],
    "pinData": {},
    "connections": {
      "create message": {
        "main": [
          [
            {
              "node": "Generate Voice Reminder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Change filename": {
        "main": [
          [
            {
              "node": "Send Voice Reminder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Appointments": {
        "main": [
          [
            {
              "node": "create message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Get Appointments",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "create message",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Generate Voice Reminder": {
        "main": [
          [
            {
              "node": "Change filename",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "create message",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "When clicking 'Test workflow'": {
        "main": [
          [
            {
              "node": "Get Appointments",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "swaWgPkq0xW1Jk0o",
    "meta": {
      "instanceId": "615d41e094941c09198b8ce125ed214047535a66e1c0b3e0cb2d688b4f5c9651"
    },
    "name": "Automated Web Scraping: email a CSV, save to Google Sheets & Microsoft Excel",
    "tags": [],
    "nodes": [
      {
        "id": "c3ef40df-084e-435c-9a11-3aa0a2f94f36",
        "name": "When clicking \"Test workflow\"",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          380,
          540
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "e0583472-a450-4582-83bc-84a014bea543",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1040,
          540
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "books"
        },
        "typeVersion": 1
      },
      {
        "id": "f9cbdb05-c249-4ccb-b3c5-f2eb8861f811",
        "name": "Convert to CSV File",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          1820,
          540
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "1ecb45ee-659e-42a9-919d-6a3ebed0b836",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1620,
          100
        ],
        "parameters": {
          "height": 184.90255200662574,
          "content": "### You need to setup Microsoft Azure credentials with Microsoft Graph permissions."
        },
        "typeVersion": 1
      },
      {
        "id": "1d4bcfad-feae-4317-9012-7e03a6203d91",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1900,
          100
        ],
        "parameters": {
          "height": 183.1237982918667,
          "content": "### Unlike Google Sheets where we did not need to have a certain format, here we need to create the column headers, otherwise the appending to the sheet won't work."
        },
        "typeVersion": 1
      },
      {
        "id": "4248ddb3-11c0-41e3-be81-ce4ec92923ee",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2020,
          740
        ],
        "parameters": {
          "height": 135.09744799337426,
          "content": "### For these steps to work you will need to have Drive, Sheets and Gmail APIs enabled in your Google Cloud Account"
        },
        "typeVersion": 1
      },
      {
        "id": "d17174fe-8015-453a-b439-43eb3245d7cb",
        "name": "Extract all books from the page",
        "type": "n8n-nodes-base.html",
        "position": [
          820,
          540
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {
                "key": "books",
                "cssSelector": ".row > li",
                "returnArray": true,
                "returnValue": "html"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "5de66b0a-9138-42e3-857a-3060c71776a9",
        "name": "Sort by price",
        "type": "n8n-nodes-base.sort",
        "position": [
          1480,
          540
        ],
        "parameters": {
          "options": {},
          "sortFieldsUi": {
            "sortField": [
              {
                "order": "descending",
                "fieldName": "price"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b8c539ce-292c-4b67-83b2-b397cfc5bb97",
        "name": "Extract individual book price",
        "type": "n8n-nodes-base.html",
        "position": [
          1260,
          540
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "dataPropertyName": "books",
          "extractionValues": {
            "values": [
              {
                "key": "title",
                "attribute": "title",
                "cssSelector": "h3 > a",
                "returnValue": "attribute"
              },
              {
                "key": "price",
                "cssSelector": ".price_color"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "b8aa573d-5b63-4669-900f-bcc915b6ad41",
        "name": "Save to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1820,
          760
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "price",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "price",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "autoMapInputData",
            "matchingColumns": []
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zyiRT7iIlfzZiskC9vDVoAFnW_UNMVXX0-ESVU1yYxY/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1zyiRT7iIlfzZiskC9vDVoAFnW_UNMVXX0-ESVU1yYxY",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zyiRT7iIlfzZiskC9vDVoAFnW_UNMVXX0-ESVU1yYxY/edit?usp=drivesdk",
            "cachedResultName": "Scraped Data"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "MMrGJCEKCWIb8jPE",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "97bdbc85-84b3-4463-9b98-5d40b80a3a1a",
        "name": "Save to Microsoft Excel 365",
        "type": "n8n-nodes-base.microsoftExcel",
        "position": [
          1820,
          320
        ],
        "parameters": {
          "options": {},
          "dataMode": "autoMap",
          "resource": "worksheet",
          "workbook": {
            "__rl": true,
            "mode": "id",
            "value": "=EA8A73F11507ECE9!24392"
          },
          "operation": "append",
          "worksheet": {
            "__rl": true,
            "mode": "list",
            "value": "{00000000-0001-0000-0000-000000000000}",
            "cachedResultName": "Sheet1"
          }
        },
        "credentials": {
          "microsoftExcelOAuth2Api": {
            "id": "oSGTo5qjZHVXYiuB",
            "name": "Microsoft Excel account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "4078dc06-0497-4579-a6f4-8c314307aab8",
        "name": "Send CSV via e-mail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2040,
          540
        ],
        "parameters": {
          "sendTo": "constact@mihai.ltd",
          "message": "Hey, here's the scraped data from the online bookstore!",
          "options": {
            "attachmentsUi": {
              "attachmentsBinary": [
                {}
              ]
            }
          },
          "subject": "bookstore csv"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "18u7JrVfJgM0fhOv",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "8ddca560-8da7-4090-b865-0523f95ca463",
        "name": "Fetch website content",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          600,
          540
        ],
        "parameters": {
          "url": "http://books.toscrape.com",
          "options": {
            "allowUnauthorizedCerts": true
          }
        },
        "typeVersion": 4.1
      },
      {
        "id": "450020e6-9f43-4652-be13-25cb5eb3584c",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          360,
          60
        ],
        "parameters": {
          "width": 579,
          "height": 297,
          "content": "## Automated Web Scraping: email a CSV, save to Google Sheets & Microsoft Excel\n\nSet-up steps:\n1. Change the website to scrape in the \"Fetch website content\" node\n2. Configure Microsoft Azure credentials with Microsoft Graph permissions (required for the Save to Microsoft Excel 365 node)\n3. Configure Google Cloud credentials with access to Google Drive, Google Sheets and Gmail APIs (the latter is required for the Send CSV via e-mail node)."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "27818544-3070-4201-917d-83739ce75339",
    "connections": {
      "Split Out": {
        "main": [
          [
            {
              "node": "Extract individual book price",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Sort by price": {
        "main": [
          [
            {
              "node": "Save to Microsoft Excel 365",
              "type": "main",
              "index": 0
            },
            {
              "node": "Convert to CSV File",
              "type": "main",
              "index": 0
            },
            {
              "node": "Save to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to CSV File": {
        "main": [
          [
            {
              "node": "Send CSV via e-mail",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch website content": {
        "main": [
          [
            {
              "node": "Extract all books from the page",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract individual book price": {
        "main": [
          [
            {
              "node": "Sort by price",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking \"Test workflow\"": {
        "main": [
          [
            {
              "node": "Fetch website content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract all books from the page": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "cb9a1e5321767b6316634728341237e564b2587ab15b74ca0a89eb02a53484d6",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "992f8f2a-7ee2-4270-8610-6bfb87b60edf",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -848,
          32
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "fc63a6b3-60a9-4449-9d32-d24b812c2adc",
        "name": "Get Specific Customer Data",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -624,
          48
        ],
        "parameters": {
          "url": "=https://your_shopify_domain/admin/api/2025-07/orders.json?customer_id={{ $json.customer.id }}&status=any",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "X-Shopify-Access-Token",
                "value": "your_shop_access-token"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f95da48b-e758-46c7-af74-2018af4cac30",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -1040,
          32
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "orders"
        },
        "typeVersion": 1
      },
      {
        "id": "66fa9744-d204-41a9-8b0a-5a623badaaae",
        "name": "Get All Cancelled Order",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -1248,
          32
        ],
        "parameters": {
          "url": "https://your_shopify_domain/admin/api/2025-07/orders.json?customer_id=&status=cancelled",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "X-Shopify-Access-Token",
                "value": "your_shop_access-token"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "43fb6336-dbf8-4a88-acfc-59dd3c5812e9",
        "name": "Get Product name with re-order llink",
        "type": "n8n-nodes-base.code",
        "position": [
          -416,
          48
        ],
        "parameters": {
          "jsCode": "const data = items[0].json.orders;\n\nif (!Array.isArray(data)) {\n  throw new Error(\"Orders not found or not an array\");\n}\n\nconst customersMap = {};\n\ndata.forEach((order) => {\n  const customer = order.customer || {};\n  const customerId = customer.id || null;\n  if (!customerId) return;\n\n  if (!customersMap[customerId]) {\n    const phone = customer.phone || (customer.default_address && customer.default_address.phone) || \"N/A\";\n    const name = [customer.first_name, customer.last_name].filter(Boolean).join(\" \") || \"N/A\";\n\n    customersMap[customerId] = {\n      customerId: customerId,\n      name: name,\n      email: customer.email || \"N/A\",\n      phone: phone,\n      totalSpent: 0,\n      products: {},\n      lastOrderLink: order.order_status_url || \"N/A\",\n    };\n  } else {\n    customersMap[customerId].lastOrderLink = order.order_status_url || customersMap[customerId].lastOrderLink;\n  }\n\n  customersMap[customerId].totalSpent += parseFloat(order.current_total_price || \"0\");\n\n  if (Array.isArray(order.line_items)) {\n    order.line_items.forEach((item) => {\n      if (item.name && item.id) {\n        if (!customersMap[customerId].products[item.id]) {\n          customersMap[customerId].products[item.id] = {\n            productName: item.name,\n            quantity: 0,\n          };\n        }\n        customersMap[customerId].products[item.id].quantity += item.quantity || 1;\n      }\n    });\n  }\n});\n\nconst result = Object.values(customersMap).map((customer) => ({\n  json: {\n    customerId: customer.customerId,\n    name: customer.name,\n    email: customer.email,\n    phone: customer.phone,\n    re_order_link: customer.lastOrderLink,\n    totalSpent: customer.totalSpent.toFixed(2),\n    productsBought: Object.entries(customer.products).map(\n      ([productId, productData]) => ({\n        productId: productId,\n        productName: productData.productName,\n        quantity: productData.quantity,\n      }),\n    ),\n  },\n}));\n\nreturn result;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "300043d5-8f43-4818-a590-43421fd8aac8",
        "name": "Get customer info",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -224,
          48
        ],
        "parameters": {
          "url": "=https://your_shopify_domain/admin/api/2025-07/customers/{{ $json.customerId }}.json ",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "X-Shopify-Access-Token",
                "value": "your_shop_access-token"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "dd349ea5-87e6-4286-9733-b6120d35e46d",
        "name": "Get Customer Total Spent",
        "type": "n8n-nodes-base.code",
        "position": [
          -48,
          48
        ],
        "parameters": {
          "jsCode": "const data = items[0].json.customer;\n\nif (!data || typeof data !== \"object\") {\n  throw new Error(\"Customer data not found or invalid format\");\n}\n\nconst customers = Array.isArray(data) ? data : [data];\n\nreturn customers\n  .filter((customer) => {\n    const totalSpent = parseFloat(customer.total_spent || '0.00');\n    return totalSpent > 0;\n  })\n  .map((customer) => {\n    const address = customer.default_address || {};\n\n    return {\n      json: {\n        customerId: customer.id || null,\n        customerName: `${customer.first_name || ''} ${customer.last_name || ''}`.trim(),\n        email: customer.email || 'N/A',\n        phone: customer.phone || address.phone || 'N/A',\n        totalSpent: customer.total_spent || '0.00',\n        ordersCount: customer.orders_count || 0,\n        address: address.address1 || 'N/A',\n        city: address.city || 'N/A',\n        country: address.country || 'N/A',\n        createdAt: customer.created_at || null,\n        updatedAt: customer.updated_at || null,\n        state: customer.state || 'N/A'\n      }\n    };\n  });\n"
        },
        "typeVersion": 2
      },
      {
        "id": "1cd4b46f-8bcb-4524-9d86-b3c822a3fad7",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -1424,
          32
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "029cce6b-37c6-44d7-9340-f8141ad9f549",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          464,
          48
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "fd4cdb60-0120-4928-86b2-22d8ca3bea02",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.exists }}",
                "rightValue": true
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "fd47c64f-60d9-4b9f-92e9-9014a2d83b3d",
        "name": "Rapiwa (verify number)",
        "type": "n8n-nodes-rapiwa.rapiwa",
        "position": [
          288,
          48
        ],
        "parameters": {
          "number": "={{ $json.phone }}",
          "operation": "verifyWhatsAppNumber"
        },
        "credentials": {
          "rapiwaApi": {
            "id": "ge5WDOaDo4d1hBpU",
            "name": "Rapiwa (Shakil)"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8e53fb88-71f4-43ed-845e-08c1fce09bcd",
        "name": "Rapiwa (sent message)",
        "type": "n8n-nodes-rapiwa.rapiwa",
        "position": [
          688,
          -80
        ],
        "parameters": {
          "number": "={{ $json.jid }}",
          "message": "=Hi {{ $('Get Product name with re-order llink').item.json.name }}\n\nWe noticed you cancelled your recent order!\nIf you‚Äôd like to try again, you can reorder the same product using the link below:\n\nüëâ {{ $('Get Product name with re-order llink').item.json.re_order_link }}\n\nUse code *REORDER5* to get *5%* off your next purchase üéÅ\n\nThank you for shopping with us!\n‚ÄîSpaGreen Creative Team\n"
        },
        "credentials": {
          "rapiwaApi": {
            "id": "ge5WDOaDo4d1hBpU",
            "name": "Rapiwa (Shakil)"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "fac6b716-c4c2-4f8c-afd4-c231bc7acb0e",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          224,
          -320
        ],
        "parameters": {
          "width": 848,
          "height": 640,
          "content": "### 1. Check valid whatsapp number Using Rapiwa\n- Purpose: Verify WhatsApp registration via Rapiwa API.\n### 3. Rapiwa Sender\n- Purpose: Send personalized WhatsApp messages for verified numbers.\n### 4. Store State of Rows in Verified & Sent\n- Document: references a Google spreadsheet ID (example ID in the node configuration).\n### 5. Store State of Rows in Unverified & Not Sent\n- Purpose: Write a row for numbers that are not registered on WhatsApp.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "887aef29-03ac-47c3-bdec-58766185a08e",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          928,
          144
        ],
        "webhookId": "6c474e54-eb3c-4fcd-b455-948322cd0121",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "c326b1bf-5eb5-492d-8f6e-aa297c9caf8b",
        "name": "Store State of Rows in Verified & Sent",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          928,
          -80
        ],
        "parameters": {
          "columns": {
            "value": {
              "name": "={{ $('Get Product name with re-order llink').item.json.name }}",
              "coupon": "REORDER5",
              "number": "={{ $('Get Product name with re-order llink').item.json.phone }}",
              "status": "sent",
              "validity": "verified",
              "item link": "={{ $('Get Product name with re-order llink').item.json.re_order_link }}",
              "item name": "={{ $('Get Product name with re-order llink').item.json.productsBought[0].productName }}"
            },
            "schema": [
              {
                "id": "name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "number",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "item name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "item name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "coupon",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "coupon",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "item link",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "item link",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "total price",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "total price",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "validity",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "validity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1nvrxINR5Cch5SChGydf62W6PcDdTmdDnlqBif6iTgLU/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1nvrxINR5Cch5SChGydf62W6PcDdTmdDnlqBif6iTgLU",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1nvrxINR5Cch5SChGydf62W6PcDdTmdDnlqBif6iTgLU/edit?usp=drivesdk",
            "cachedResultName": "Shopify - Send WhatsApp upsell recommendation"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "gFH3Wjq6yYqSEAei",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "59c8637b-478b-424f-863d-f72ea2fe4193",
        "name": "Store State of Rows in Unverified & Not Sent",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          688,
          144
        ],
        "parameters": {
          "columns": {
            "value": {
              "name": "={{ $('Get Product name with re-order llink').item.json.name }}",
              "coupon": "REORDER5",
              "number": "={{ $('Get Product name with re-order llink').item.json.phone }}",
              "status": "sent",
              "validity": "unverified",
              "item link": "={{ $('Get Product name with re-order llink').item.json.re_order_link }}",
              "item name": "={{ $('Get Product name with re-order llink').item.json.productsBought[0].productName }}"
            },
            "schema": [
              {
                "id": "name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "number",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "item name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "item name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "coupon",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "coupon",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "item link",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "item link",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "total price",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "total price",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "validity",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "validity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1nvrxINR5Cch5SChGydf62W6PcDdTmdDnlqBif6iTgLU/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1nvrxINR5Cch5SChGydf62W6PcDdTmdDnlqBif6iTgLU",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1nvrxINR5Cch5SChGydf62W6PcDdTmdDnlqBif6iTgLU/edit?usp=drivesdk",
            "cachedResultName": "Shopify - Send WhatsApp upsell recommendation"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "gFH3Wjq6yYqSEAei",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "adb18364-ac4b-406e-a038-388155b29102",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1424,
          320
        ],
        "parameters": {
          "width": 1072,
          "height": 752,
          "content": "# Send WhatsApp Upsell Recommendation Message for Shopify\n## Overview\n- **Fetch cancelled orders** on a schedule\n- **Collect customer and product details**\n- **Verify the customer‚Äôs WhatsApp number** using Rapiwa\n- **Send a personalized recovery message** with a discount code\n- **Save on Google sheet** (sent, delivered, not sent, not verified)\n\n\n## Workflow Steps\n### 2. Get All Cancelled Order\n- **Purpose**: Retrieves all cancelled orders from Shopify\n- **API Endpoint**: `https://your_shopify_domain/admin/api/2025-07/orders.json?customer_id=&status=cancelled`\n### 5. Get Specific Customer Data\n- **Purpose**: Retrieves all orders for each customer\n- **API Endpoint**: `https://your_shopify_domain/admin/api/2025-07/orders.json?customer_id={{ $json.customer.id }}&status=any`\n### 6. Get Customer Info\n- **Purpose**: Fetches detailed customer profile information\n- **API Endpoint**: `https://your_shopify_domain/admin/api/2025-07/customers/{{ $json.customerId }}.json`\n\n## Google Sheet Required Columns\n**A Google Sheet formatted like this** ‚û§ [sample](https://docs.google.com/spreadsheets/d/1nvrxINR5Cch5SChGydf62W6PcDdTmdDnlqBif6iTgLU/edit?usp=sharing)\n\n## Useful Links\n- **Install Rapiwa**: [How to install Rapiwa](https://www.npmjs.com/package/n8n-nodes-rapiwa)\n- **Shopify API Documentation**: [https://shopify.dev/docs/admin-api](https://shopify.dev/docs/admin-api)\n- **Rapiwa Dashboard**: [https://app.rapiwa.com](https://app.rapiwa.com/login)\n- **Rapiwa Documentation**: [https://docs.rapiwa.com](https://docs.rapiwa.com/)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "cf075f6e-2fe0-4e07-acfd-d95957d35af7",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1296,
          -112
        ],
        "parameters": {
          "width": 208,
          "height": 304,
          "content": "### **Get All Cancelled Order**\n* **Purpose:** Fetches all cancelled orders from the Shopify store.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9e179cf5-7d2b-4809-b4b6-eb6abc94d97e",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -96,
          -80
        ],
        "parameters": {
          "width": 304,
          "height": 272,
          "content": "### **Get Customer Total Spent**\n**Purpose:** Filters out customers who have **spent 0** (keeps only those who made purchases).\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "5ae248e2-ef7d-4b0b-8ddd-9b8a5d16e9bc",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -704,
          -144
        ],
        "parameters": {
          "width": 432,
          "height": 336,
          "content": "### 5. **Get Specific Customer Data**\n* **Purpose:** Fetches all orders for a **specific customer** using their `customer_id`.\n\n\n### 6. **Get Product Name with Re-order Link**\n* **Purpose:** classify orders for each customer and extracts useful details.\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "Rapiwa (sent message)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Store State of Rows in Unverified & Not Sent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Get Specific Customer Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Get All Cancelled Order",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get customer info": {
        "main": [
          [
            {
              "node": "Get Customer Total Spent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Rapiwa (sent message)": {
        "main": [
          [
            {
              "node": "Store State of Rows in Verified & Sent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Rapiwa (verify number)": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get All Cancelled Order": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Customer Total Spent": {
        "main": [
          [
            {
              "node": "Rapiwa (verify number)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Specific Customer Data": {
        "main": [
          [
            {
              "node": "Get Product name with re-order llink",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Product name with re-order llink": {
        "main": [
          [
            {
              "node": "Get customer info",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Store State of Rows in Verified & Sent": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Store State of Rows in Unverified & Not Sent": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "wVvNaEO8lG0lIMzU",
    "meta": {
      "instanceId": "cb9a1e5321767b6316634728341237e564b2587ab15b74ca0a89eb02a53484d6",
      "templateCredsSetupCompleted": true
    },
    "name": "Automated WhatsApp Welcome Messages for Sales Leads with Google Sheets & Rapiwa",
    "tags": [],
    "nodes": [
      {
        "id": "0550f462-b916-47d3-bebf-b505da01a7fd",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2736,
          -880
        ],
        "parameters": {
          "color": 4,
          "width": 1040,
          "height": 1728,
          "content": "# Automated WhatsApp Welcome Messages for Sales Leads with Google Sheets & Rapiwa\n\n## What does this workflow do?\nThis n8n automation helps you send personalized WhatsApp messages to your leads, directly from a Google Sheet. It checks for new leads, verifies their WhatsApp numbers, sends a welcome message, and updates your sheet‚Äîall automatically, every 5 minutes.\n\n---\n\n## How it works (Step by Step)\n1. **Scheduled Runs:**  \n   The workflow runs itself every 5 minutes (you can change this if you want).\n2. **Fetch Leads:**  \n   It looks for new leads in your Google Sheet that are marked for messaging.\n3. **Clean & Validate Numbers:**  \n   Each WhatsApp number is cleaned (removes spaces/symbols) and checked to make sure it‚Äôs real and active.\n4. **Send Messages:**  \n   If the number is valid, a personalized WhatsApp message is sent using the Rapiwa API.\n5. **Update Status:**  \n   The Google Sheet is updated to show which messages were sent successfully and which weren‚Äôt.\n6. **Safe Batching:**  \n   Only up to 60 leads are processed at a time, with a 5-second pause between each message to avoid being blocked.\n7. **Repeat:**  \n   The cycle repeats, so new leads are always picked up.\n\n---\n\n## What you need\n- **A Google Sheet** set up like [this sample](https://docs.google.com/spreadsheets/d/1amkVSIXrhOkf86YDYaddOcAamhUC4DlvFiSg3cpAH78/edit?usp=sharing)\n- **Google Sheets OAuth2 credentials** connected to n8n\n- **A valid Rapiwa Bearer YOUR_TOKEN_HERE**\n- **WhatsApp Account** (Personal or Business)\n- Your Google Sheet should have these columns:\n  - `WhatsApp No`\n  - `name ` (note: there‚Äôs a space at the end‚Äîmatch exactly)\n  - `row_number`\n  - `status`, `check`, `validity`\n\n---\n\n## Example Google Sheet\n\n| name            | number        | email             | time                        | check   | validity   | status    |\n|-----------------|--------------|-------------------|-----------------------------|---------|------------|-----------|\n| Shakil Ahammed  | 8801322827753| admin@gmail.com   | September 14th 2025, 10:34  | checked | verified   | sent      |\n| Shakil Ahammed  | 8801322827754| admin@gmail.com   | September 14th 2025, 10:34  | checked | unverified | not sent  |\n\n> **Note:** The `name` column must have a space at the end: `name `\n\n---\n\n## Tips for Best Results\n- Keep your Google Sheet tidy and use data validation if possible.\n- Always use international phone number format.\n- If you get blocked by Rapiwa, try increasing the wait time or lowering the batch size.\n- Make sure you have a `row_number` column (can be auto-generated).\n\n---\n\n## Want to customize?\n- Log errors to a separate sheet\n- Get email notifications for failed messages\n- Send PDFs or images via Rapiwa\n- Personalize messages with more fields\n\n---\n\n## Why use this?\nThis workflow is perfect for automating lead engagement, order confirmations, or onboarding messages. It saves you time and effort by handling WhatsApp messaging for you, using your Google Sheet as the source of truth.\n\n> **Built for non-official WhatsApp API workflows using n8n and Rapiwa.**"
        },
        "typeVersion": 1
      },
      {
        "id": "0841f0a0-7042-4049-8642-6d40987fc607",
        "name": "Fetch All Pending Queries for Messaging1",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -1072,
          -496
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "check"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1amkVSIXrhOkf86YDYaddOcAamhUC4DlvFiSg3cpAH78/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1amkVSIXrhOkf86YDYaddOcAamhUC4DlvFiSg3cpAH78",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1amkVSIXrhOkf86YDYaddOcAamhUC4DlvFiSg3cpAH78/edit?usp=drivesdk",
            "cachedResultName": "Sales - Send welcome message"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "gFH3Wjq6yYqSEAei",
            "name": "Google Sheets"
          }
        },
        "notesInFlow": false,
        "retryOnFail": false,
        "typeVersion": 4.6
      },
      {
        "id": "27263025-0d11-4e6b-bf84-df8e3269cd24",
        "name": "Limit1",
        "type": "n8n-nodes-base.limit",
        "position": [
          -656,
          -496
        ],
        "parameters": {
          "maxItems": 60
        },
        "typeVersion": 1
      },
      {
        "id": "ed57db8c-6127-454f-b7a1-b65a77877e7b",
        "name": "Clean WhatsApp Number1",
        "type": "n8n-nodes-base.code",
        "position": [
          16,
          -480
        ],
        "parameters": {
          "jsCode": "const items = $input.all();\n\nconst updatedItems = items.map((item) => {\n  let waNo = item?.json[\"WhatsApp No\"];\n\n  // Convert to string safely\n  let waNoStr = \"\";\n  if (typeof waNo === 'string') {\n    waNoStr = waNo;\n  } else if (waNo !== undefined && waNo !== null) {\n    waNoStr = String(waNo);\n  }\n\n  // Remove all non-digit characters\n  const cleanedNumber = waNoStr.replace(/\\D/g, \"\");\n\n  // Assign cleaned number as a string\n  item.json[\"WhatsApp No\"] = cleanedNumber;\n\n  return item;\n});\n\nreturn updatedItems;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "7e100ddc-107e-4059-90cb-b4cef3d5c3a7",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -416,
          -496
        ],
        "parameters": {
          "options": {}
        },
        "executeOnce": false,
        "typeVersion": 3
      },
      {
        "id": "da9deff5-b797-4997-a2e2-5923f09f7c18",
        "name": "Send Message Using Rapiwa1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          816,
          -128
        ],
        "parameters": {
          "url": "=https://app.rapiwa.com/api/send-message",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "number",
                "value": "={{ $json.data.phone }}"
              },
              {
                "name": "message_type",
                "value": "text"
              },
              {
                "name": "message",
                "value": "=Hi *{{ $('Clean WhatsApp Number1').item.json['name '] }}*,\nThanks for purchasing from *Spagreen Creative*. Your product purchase has been confirmed.\nWe truly appreciate your trust in our products. If you have any questions, feel free to message us here anytime!\n‚Äì Team *Spagreen Creative*"
              }
            ]
          },
          "genericAuthType": "httpBearerAuth"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "jnaHCyYia9OAFozh",
            "name": "Rapiwa Bearer YOUR_TOKEN_HERE"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "ae5bfcf0-f1c5-41a5-ad48-2f0cc94faa3c",
        "name": "Update rows: not sent & unverified1",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          816,
          80
        ],
        "parameters": {
          "columns": {
            "value": {
              "check": "checked",
              "status": "not sent",
              "validity": "unverified",
              "row_number": "={{ $('Loop Over Items').item.json.row_number }}"
            },
            "schema": [
              {
                "id": "name ",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name ",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "number",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "time",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "check",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "check",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "validity",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "validity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1amkVSIXrhOkf86YDYaddOcAamhUC4DlvFiSg3cpAH78/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1amkVSIXrhOkf86YDYaddOcAamhUC4DlvFiSg3cpAH78",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1amkVSIXrhOkf86YDYaddOcAamhUC4DlvFiSg3cpAH78/edit?usp=drivesdk",
            "cachedResultName": "Sales - Send welcome message"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "gFH3Wjq6yYqSEAei",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "fc1b5295-dda0-43ee-a275-32f55b969cb4",
        "name": "Update rows: sent & verified1",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1040,
          -128
        ],
        "parameters": {
          "columns": {
            "value": {
              "check": "checked",
              "status": "sent",
              "validity": "verified",
              "row_number": "={{ $('Loop Over Items').item.json.row_number }}"
            },
            "schema": [
              {
                "id": "name ",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name ",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "number",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "time",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "check",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "check",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "validity",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "validity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1amkVSIXrhOkf86YDYaddOcAamhUC4DlvFiSg3cpAH78/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1amkVSIXrhOkf86YDYaddOcAamhUC4DlvFiSg3cpAH78",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1amkVSIXrhOkf86YDYaddOcAamhUC4DlvFiSg3cpAH78/edit?usp=drivesdk",
            "cachedResultName": "Sales - Send welcome message"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "gFH3Wjq6yYqSEAei",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "524c6411-7826-4ef0-a723-e6fa741758b9",
        "name": "Wait1",
        "type": "n8n-nodes-base.wait",
        "position": [
          1040,
          80
        ],
        "webhookId": "6c474e54-eb3c-4fcd-b455-948322cd0121",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "1f9f9e50-4934-4184-b4dd-b4aa3d2351ac",
        "name": "Check valid whatsapp number Using Rapiwa1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          224,
          -480
        ],
        "parameters": {
          "url": "=https://app.rapiwa.com/api/verify-whatsapp",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "number",
                "value": "={{ String($json.number) }}"
              }
            ]
          },
          "genericAuthType": "httpBearerAuth"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "jnaHCyYia9OAFozh",
            "name": "Rapiwa Bearer YOUR_TOKEN_HERE"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "31c3193f-ac56-4ae8-8221-06ef827f00ee",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1600,
          -896
        ],
        "parameters": {
          "width": 320,
          "height": 720,
          "content": "## Workflow Schedule\nThis workflow runs automatically every 5 minutes. You can adjust the interval if you want messages to go out more or less frequently. This ensures your leads are always contacted on time, without any manual effort."
        },
        "typeVersion": 1
      },
      {
        "id": "f1ed589d-493c-4a62-9fb3-5bbf0f83b0a5",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1248,
          -896
        ],
        "parameters": {
          "color": 2,
          "width": 448,
          "height": 944,
          "content": "## Google Sheets Connection\nThis step fetches all leads from your Google Sheet that are marked for messaging (where the `check` column is filled). Make sure your Document ID and Sheet GID are correct. Only the leads you want to contact are selected, giving you full control.\n\n- **Node:** Fetch All Pending Queries for Messaging\n- Reads rows from your Google Sheet where the `check` column is filled.\n- Make sure the correct Document ID and Sheet GID are set.\n- Only leads marked for messaging are fetched."
        },
        "typeVersion": 1
      },
      {
        "id": "83a91565-e5b4-4551-a8b7-6407ce030c6b",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -768,
          -896
        ],
        "parameters": {
          "color": 6,
          "width": 608,
          "height": 1232,
          "content": "## Limit and Process Leads\nTo keep things running smoothly, the workflow processes up to 60 leads at a time. You can change this limit as needed. Each lead is handled one by one, so every contact gets the right message and your system stays fast.\n\n- **Node:** Limit\n  - Only processes up to 60 leads per cycle to avoid overloading or hitting API limits.\n  - You can adjust this number as needed.\n- **Node:** Loop Over Items1\n  - Goes through each lead one by one for processing."
        },
        "typeVersion": 1
      },
      {
        "id": "5f158c59-9cb4-4c43-9705-8cb6843baef8",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -128,
          -896
        ],
        "parameters": {
          "color": 5,
          "width": 560,
          "height": 1232,
          "content": "## Clean and Verify WhatsApp Numbers\nBefore sending messages, each WhatsApp number is cleaned (removing spaces and symbols) and checked to make sure it‚Äôs a real, active WhatsApp account. Only valid numbers will get a message, so you don‚Äôt waste time or credits.\n\n- **Node:** Clean WhatsApp Number\n  - Removes any spaces or symbols from phone numbers so they work with the API.\n- **Node:** Check valid whatsapp number Using Rapiwa\n  - Checks if the WhatsApp number is real and can receive messages.\n  - Only valid numbers will get a message."
        },
        "typeVersion": 1
      },
      {
        "id": "30aea538-f33c-4e6e-ae4a-8295cc455f0f",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          464,
          -896
        ],
        "parameters": {
          "color": 4,
          "width": 848,
          "height": 1232,
          "content": "## Message Sending & Status Update\nIf a WhatsApp number is valid, the workflow sends a personalized message and updates the sheet to show it was sent. If not, it marks the row as not sent and unverified. Each message is sent with a 5-second pause to avoid being blocked. The Google Sheet is always updated, so you know which leads were contacted.\n\n- **Node:** If\n  - Checks if the WhatsApp number is valid.\n  - If valid: sends the message.\n  - If not valid: marks the row as \"not sent\" and \"unverified\".\n- **Node:** Send Message Using Rapiwa\n  - Sends a personalized WhatsApp message using the name from your sheet.\n- **Node:** Update rows: sent & verified\n  - Marks successful messages as \"sent\" and \"verified\".\n- **Node:** Update rows: not sent & unverified\n  - Marks failed messages as \"not sent\" and \"unverified\".\n- **Node:** Wait\n  - Waits 5 seconds between each message to avoid being blocked by WhatsApp or the API."
        },
        "typeVersion": 1
      },
      {
        "id": "20ec8ec0-ef20-40fe-9f97-8f11c201eb71",
        "name": "Trigger Every 5 Minute1",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -1504,
          -496
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "minutes"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "769eb9a9-5afb-42f3-8b79-26dbb824902d",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          560,
          0
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "3ab8725a-9268-45fd-b91c-0e055fe6fa7c",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.data.exists }}",
                "rightValue": "=\"true\""
              }
            ]
          }
        },
        "typeVersion": 2.2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "40f6da2f-5153-49a9-b19a-c0365573c1ef",
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "Send Message Using Rapiwa1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Update rows: not sent & unverified1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit1": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Clean WhatsApp Number1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Clean WhatsApp Number1": {
        "main": [
          [
            {
              "node": "Check valid whatsapp number Using Rapiwa1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger Every 5 Minute1": {
        "main": [
          [
            {
              "node": "Fetch All Pending Queries for Messaging1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Message Using Rapiwa1": {
        "main": [
          [
            {
              "node": "Update rows: sent & verified1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update rows: sent & verified1": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update rows: not sent & unverified1": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch All Pending Queries for Messaging1": {
        "main": [
          [
            {
              "node": "Limit1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check valid whatsapp number Using Rapiwa1": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "sezfOd4PU3efRizo",
    "meta": {
      "instanceId": "70da30c32dfca2c8fe2d688fa1f6bf834f1145a963b1dca87ba81a3c249f0060"
    },
    "name": "Zoho Inventory to Supabase",
    "tags": [],
    "nodes": [
      {
        "id": "a3eaaf09-eb05-4181-a196-ab80b2b1cc64",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1000,
          -60
        ],
        "parameters": {
          "width": 620,
          "height": 460,
          "content": "## Automated Zoho Inventory to Supabase Data Migration Workflow\n\nThis n8n workflow automates the process of migrating product data from Zoho Inventory to a Supabase table, ensuring seamless, scheduled updates and organized data management. Key features include:\n\t‚Ä¢\tAutomated Scheduling: Runs on a set schedule to keep Supabase tables in sync with Zoho Inventory.\n\t‚Ä¢\tSecure API Integration: Uses Zoho‚Äôs OAuth2.0 for secure access token generation and API requests.\n\t‚Ä¢\tComprehensive Data Retrieval: Fetches all listed items from Zoho Inventory, including detailed product attributes and stock information.\n\t‚Ä¢\tData Structuring: Splits and organizes retrieved data for efficient migration.\n\t‚Ä¢\tDirect Supabase Migration: Maps and transfers relevant fields‚Äîsuch as product IDs, names, variants, attributes, and stock levels‚Äîdirectly into your Supabase database.\n\t‚Ä¢\tScalable & Reliable: Easily adapts to growing product catalogs and ensures consistent, up-to-date inventory records.\n\nIdeal for businesses looking to automate their inventory data pipeline between Zoho and Supabase, reducing manual work and minimizing errors."
        },
        "typeVersion": 1
      },
      {
        "id": "111cf5b9-cf9e-4a1a-9120-f2938207fac5",
        "name": "Scheduled Trigger1",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -100,
          80
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "24a43bf2-fd13-4c2a-9c8b-45687aa136ed",
        "name": "POST to Zoho API for Access Token1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          120,
          80
        ],
        "parameters": {
          "url": "https://accounts.zoho.in/oauth/v2/token",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "form-urlencoded",
          "bodyParameters": {
            "parameters": [
              {
                "name": "refresh_token",
                "value": "your refresh token here"
              },
              {
                "name": "client_id",
                "value": "your client id here"
              },
              {
                "name": "client_secret",
                "value": "your client secret here"
              },
              {
                "name": "grant_type",
                "value": "refresh_token"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "6f450435-efb3-4ee7-bfe2-3950018c05f0",
        "name": "GET to Zoho Inventory for Listed Items1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          340,
          80
        ],
        "parameters": {
          "url": "https://www.zohoapis.in/inventory/v1/items",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "organization_id",
                "value": "your organization id here"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Zoho-oauthtoken {{ $json.access_token }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "433dba2c-a9a9-4c8b-af95-c884cdff3f62",
        "name": "Split for better organisation1",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          560,
          80
        ],
        "parameters": {
          "include": "allOtherFields",
          "options": {},
          "fieldToSplitOut": "items"
        },
        "typeVersion": 1
      },
      {
        "id": "b96e2231-06f7-4b7a-8d6e-5c734ecafb79",
        "name": "Migrating to Supabase Table1",
        "type": "n8n-nodes-base.supabase",
        "notes": "https://docs.google.com/spreadsheets/d/1lm2cYalIe3mt8w7XZf7ZGeAxjksRst_EddW4uJ2SOV8/edit?usp=sharing",
        "position": [
          780,
          80
        ],
        "parameters": {
          "tableId": "Fairy Frills",
          "fieldsUi": {
            "fieldValues": [
              {
                "fieldId": "Product ID",
                "fieldValue": "={{ $json.items.group_id }}"
              },
              {
                "fieldId": "Product Name",
                "fieldValue": "={{ $json.items.group_name }}"
              },
              {
                "fieldId": "Brand",
                "fieldValue": "={{ $json.items.brand }}"
              },
              {
                "fieldId": "Variant ID",
                "fieldValue": "={{ $json.items.item_id }}"
              },
              {
                "fieldId": "Is Returnable Item",
                "fieldValue": "={{ $json.items.is_returnable }}"
              },
              {
                "fieldId": "AttributeName1",
                "fieldValue": "={{ $json.items.attribute_name1 }}"
              },
              {
                "fieldId": "AttributeType1",
                "fieldValue": "={{ $json.items.attribute_type1 }}"
              },
              {
                "fieldId": "AttributeName2",
                "fieldValue": "={{ $json.items.attribute_name2 }}"
              },
              {
                "fieldId": "AttributeType2",
                "fieldValue": "={{ $json.items.attribute_type2 }}"
              },
              {
                "fieldId": "AttributeName3",
                "fieldValue": "={{ $json.items.attribute_name3 }}"
              },
              {
                "fieldId": "AttributeType3",
                "fieldValue": "={{ $json.items.attribute_type3 }}"
              },
              {
                "fieldId": "Tags",
                "fieldValue": "={{ $json.items.tags }}"
              },
              {
                "fieldId": "Unit",
                "fieldValue": "={{ $json.items.unit }}"
              },
              {
                "fieldId": "Item Type",
                "fieldValue": "={{ $json.items.item_type }}"
              },
              {
                "fieldId": "Variant Name",
                "fieldValue": "={{ $json.items.item_name }}"
              },
              {
                "fieldId": "SKU",
                "fieldValue": "={{ $json.items.sku }}"
              },
              {
                "fieldId": "AttributeOptionData2",
                "fieldValue": "={{ $json.items.attribute_option_data2 }}"
              },
              {
                "fieldId": "AttributeOptionData3",
                "fieldValue": "={{ $json.items.attribute_option_data3 }}"
              },
              {
                "fieldId": "Stock On Hand",
                "fieldValue": "={{ $json.items.stock_on_hand }}"
              },
              {
                "fieldId": "UPC",
                "fieldValue": "={{ $json.items.upc }}"
              },
              {
                "fieldId": "EAN",
                "fieldValue": "={{ $json.items.ean }}"
              },
              {
                "fieldId": "ISBN",
                "fieldValue": "={{ $json.items.isbn }}"
              },
              {
                "fieldId": "Status",
                "fieldValue": "={{ $json.items.status }}"
              },
              {
                "fieldId": "Part Number",
                "fieldValue": "={{ $json.items.part_number }}"
              },
              {
                "fieldId": "Reorder Level",
                "fieldValue": "={{ $json.items.reorder_level }}"
              },
              {
                "fieldId": "Dimension Unit",
                "fieldValue": "={{ $json.items.dimension_unit }}"
              },
              {
                "fieldId": "Weight Unit",
                "fieldValue": "={{ $json.items.weight_unit }}"
              },
              {
                "fieldId": "Created Time",
                "fieldValue": "={{ $json.items.created_time }}"
              }
            ]
          }
        },
        "credentials": {
          "supabaseApi": {
            "id": "A2vjLZKMUskp6mtp",
            "name": "Supabase account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "83553668-5a8e-465f-9893-bd20d4391d00",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -20,
          300
        ],
        "parameters": {
          "color": 5,
          "width": 360,
          "height": 200,
          "content": "## POST for Access Token\n- Go to Zoho API Console\n- Create a self client with the scope ZohoInventory.items.READ\n- Get Refresh Token, Client ID, and Client Secret\n- This node is using the Refresh Token to create an Access Token for later use"
        },
        "typeVersion": 1
      },
      {
        "id": "f4cbe976-520f-4dd7-ab78-080754bd3750",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          220,
          -160
        ],
        "parameters": {
          "color": 4,
          "width": 360,
          "height": 200,
          "content": "## GET Items from Zoho Inventory\n- Find your organization ID from Zoho Commerce URL\n- This node gets all the items from Zoho Inventory"
        },
        "typeVersion": 1
      },
      {
        "id": "3f452ab6-7e20-49d1-93fb-c72b0acfc26b",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          420,
          300
        ],
        "parameters": {
          "color": 3,
          "width": 360,
          "height": 200,
          "content": "## Split Node\n- This node splits the list for better organization of the flow\n"
        },
        "typeVersion": 1
      },
      {
        "id": "758314fa-3684-41e1-b1ce-adaf960afd9c",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          -160
        ],
        "parameters": {
          "color": 2,
          "width": 360,
          "height": 200,
          "content": "## Migrate to Supabase\n- Sending product information to Supabase Table\n- Find URL in the Notes for Table Coloumns\n- Make a Copy of the Google Sheet, and Import it to your Supabase Project from Table Editor"
        },
        "typeVersion": 1
      },
      {
        "id": "10d1ee56-7fd0-4493-849c-a3b4e8d88f33",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -220,
          -160
        ],
        "parameters": {
          "color": 7,
          "width": 360,
          "height": 200,
          "content": "## Scheduled Trigger 1\n- Use this trigger for scheduling the workflow at regular intervals \n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "d5c8959d-9406-456f-9271-59f0f63b83b1",
    "connections": {
      "Scheduled Trigger1": {
        "main": [
          [
            {
              "node": "POST to Zoho API for Access Token1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split for better organisation1": {
        "main": [
          [
            {
              "node": "Migrating to Supabase Table1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "POST to Zoho API for Access Token1": {
        "main": [
          [
            {
              "node": "GET to Zoho Inventory for Listed Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GET to Zoho Inventory for Listed Items1": {
        "main": [
          [
            {
              "node": "Split for better organisation1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "name": "AI Gmail: Prioritize What You Should Read",
    "nodes": [
      {
        "id": "9f0e4edb-32cc-45bf-96d8-91d76506b9e7",
        "name": "Edit Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          -816,
          0
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e8fecc44-bfcf-42cd-a82d-b2963d8f4c94",
                "name": "id",
                "type": "string",
                "value": "={{ $json.id }}"
              },
              {
                "id": "4967158d-b4ee-41b4-a945-d19462d08886",
                "name": "text",
                "type": "string",
                "value": "={{ $json.text ? $json.text : $json.html}}"
              },
              {
                "id": "48cf009c-69ea-48aa-9de8-d53039aca4a5",
                "name": "from",
                "type": "string",
                "value": "={{ $json.from.value[0].name }}"
              },
              {
                "id": "cfd63044-5e92-44c3-ad28-16118c1b83cb",
                "name": "threadId",
                "type": "string",
                "value": "={{ $json.threadId }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "90c625c4-8b88-40a0-8ff1-293b5950aa85",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "onError": "continueRegularOutput",
        "position": [
          -592,
          0
        ],
        "parameters": {
          "text": "=You are a strict JSON generator.\n\nAnalyze the following email content and classify it into one of the following categories:\n\n- \"Action\" ‚Üí bills, inquiries, reply needed, or require my attention.\n- \"Informational\" ‚Üí updates, shipping, delivery alerts, social media updates or messages. \n- \"Spam\" ‚Üí promotional or marketing emails.\n- \"Receipt\" ‚Üí receipts of purchases or subscriptions.\n\nSummary: Extract the most important information of the email into 1 sentence, not more than 4000 characters. \n\nReturn your response in a JSON object, **only using** this exact format (this is an example ‚Äî follow this structure exactly):\n{ \"label\": \"<one of the 4 categories>\", \"summary\": \"<Summary>\", \"id\": {{ $json.id }}, \"threadId\": {{ $json.threadId }} }\n\nExample output (follow this exact style):\n{ \"label\": \"Informational\", \"summary\": \"Your Apple Magic Keyboard has shipped and will arrive June 28.\", \"id\": \"abc123\" }\n\nRules:\n- Do NOT return markdown (no triple backticks, no ```json)\n- Use double quotes for keys and string values\n- Do NOT include explanations, extra text, or formatting\n- Return ONLY the one-line function call above, replacing values as needed and using the exact format above.\n\nReview your response to ensure you meet the rules before you generate the output. \n\n\nid: {{ $json.id }}\nthreadId: {{ $json.threadId }}\n\nEmail content:\n{{ $json.text }}\n",
          "options": {},
          "promptType": "define"
        },
        "retryOnFail": true,
        "typeVersion": 2,
        "alwaysOutputData": true
      },
      {
        "id": "75af6c6b-9706-42ed-985a-a763ea3e3473",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          -336,
          224
        ],
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"label\": { \"type\": \"string\" },\n    \"summary\": { \"type\": \"string\" },\n    \"id\": { \"type\": \"string\" },\n    \"threadId\": { \"type\": \"string\" }\n  },\n  \"required\": [\"label\", \"id\"]\n}\n"
        },
        "typeVersion": 1.3
      },
      {
        "id": "d6d8026a-1b11-40e4-8d30-94d4a7287848",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -1264,
          0
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "hours"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "464eae52-c683-43ff-8a4f-25d3acba5a93",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -592,
          224
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "gpt-4o"
          },
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "954ce5bb-495c-459c-981c-3bcdb0066308",
        "name": "Get All Unread Messages",
        "type": "n8n-nodes-base.gmail",
        "position": [
          -1040,
          0
        ],
        "webhookId": "59626731-064c-469a-ab85-a95df2480031",
        "parameters": {
          "simple": false,
          "filters": {
            "readStatus": "unread"
          },
          "options": {},
          "operation": "getAll",
          "returnAll": true
        },
        "typeVersion": 2.1
      },
      {
        "id": "f71f88be-77aa-4dbb-bbdc-607ebfc3ddc7",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          -128,
          -32
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Action",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "7822ad3b-3f0a-4e7e-8f3c-96641f2e2d4a",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.output.label }}",
                      "rightValue": "Action"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Informational",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "a076e618-a956-4ea7-a253-67e90a008495",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.output.label }}",
                      "rightValue": "Informational"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Receipt",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "873953c5-db09-450c-b5ed-59f695bfc9af",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.output.label }}",
                      "rightValue": "Receipt"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {
            "fallbackOutput": "extra"
          }
        },
        "typeVersion": 3.2
      },
      {
        "id": "16c60f51-2387-4f43-92d5-ada08840b97e",
        "name": "OpenAI Fall Back Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -464,
          224
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-3.5-turbo",
            "cachedResultName": "gpt-3.5-turbo"
          },
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "29f90ac4-d629-493c-a825-98c72bd77399",
        "name": "Delete email",
        "type": "n8n-nodes-base.gmail",
        "onError": "continueRegularOutput",
        "position": [
          96,
          288
        ],
        "webhookId": "3466588b-86a6-4072-8879-11997f48e1d4",
        "parameters": {
          "resource": "thread",
          "threadId": "={{ $json.output.threadId }}",
          "operation": "delete"
        },
        "typeVersion": 2.1
      },
      {
        "id": "90629ef6-75ba-499b-a27d-b47bde3deadb",
        "name": "Mark email as read",
        "type": "n8n-nodes-base.gmail",
        "position": [
          432,
          -64
        ],
        "webhookId": "f3131e67-dfdb-40d8-9199-bb79069b0c33",
        "parameters": {
          "messageId": "={{ $json.id }}",
          "operation": "markAsRead"
        },
        "typeVersion": 2.1
      },
      {
        "id": "8ed659e1-293c-49d2-ad24-0bb8d0fe30ec",
        "name": "Add label \"Receipt\" to email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          96,
          96
        ],
        "webhookId": "89f06cdb-8ae8-4e84-93ec-00c48d2cecfe",
        "parameters": {
          "labelIds": [
            "Label_3361902760602362460"
          ],
          "messageId": "={{ $json.output.id }}",
          "operation": "addLabels"
        },
        "typeVersion": 2.1
      },
      {
        "id": "42fa8db1-b003-415b-bf06-9f18b9823faa",
        "name": "Add label \"Action\" to email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          96,
          -288
        ],
        "webhookId": "d3bf8de1-aa15-47d2-9c7b-6be8d3b4468f",
        "parameters": {
          "labelIds": [
            "Label_4190586288433010009",
            "IMPORTANT"
          ],
          "messageId": "={{ $json.output.id }}",
          "operation": "addLabels"
        },
        "typeVersion": 2.1
      },
      {
        "id": "690d7e73-c97e-467b-aafe-e4acb552f188",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1320,
          -144
        ],
        "parameters": {
          "color": 5,
          "width": 208,
          "height": 304,
          "content": "### üí° Schedule Trigger\nThis runs every hour. You can change the interval here depending on how often you want your Gmail to be processed."
        },
        "typeVersion": 1
      },
      {
        "id": "967d2796-e9ce-4dfa-90cb-948d1b573185",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1312,
          256
        ],
        "parameters": {
          "width": 304,
          "height": 224,
          "content": "### ‚ö†Ô∏è Setup Required\n- Connect your Gmail account using OAuth2. \n- Add your OpenAI API Key under ‚ÄúAPI Credentials‚Äù.\n- Create these labels in your Gmail: Action, Informational, Spam and Receipt"
        },
        "typeVersion": 1
      },
      {
        "id": "06f7f246-155b-4b2d-86c0-0ecb86e84d3c",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -640,
          -160
        ],
        "parameters": {
          "color": 5,
          "width": 432,
          "height": 320,
          "content": "### üí° Customize Classification Logic\nYou can change the prompt to match your context. For example, tell the AI to detect more labels like `Meeting`, `Newsletter`, etc."
        },
        "typeVersion": 1
      },
      {
        "id": "61d814b5-f734-43a1-a588-c4722a0fd60c",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -200,
          -160
        ],
        "parameters": {
          "color": 5,
          "height": 352,
          "content": "### üí° Add More Labels\nWant to detect  `Meeting`, `Newsletter`, etc?\nAdd more conditions here and route them to different Gmail actions."
        },
        "typeVersion": 1
      },
      {
        "id": "011af85b-feb4-495d-8382-c42fdc5ff7c4",
        "name": "Add label \"Informational\" to email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          96,
          -96
        ],
        "webhookId": "d3bf8de1-aa15-47d2-9c7b-6be8d3b4468f",
        "parameters": {
          "labelIds": [
            "Label_4104611383523107189"
          ],
          "messageId": "={{ $json.output.id }}",
          "operation": "addLabels"
        },
        "typeVersion": 2.1
      }
    ],
    "connections": {
      "Switch": {
        "main": [
          [
            {
              "node": "Add label \"Action\" to email",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Add label \"Informational\" to email",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Add label \"Receipt\" to email",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Delete email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Delete email": {
        "main": [
          []
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Get All Unread Messages",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Fall Back Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Get All Unread Messages": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Add label \"Action\" to email": {
        "main": [
          [
            {
              "node": "Mark email as read",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add label \"Receipt\" to email": {
        "main": [
          [
            {
              "node": "Mark email as read",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add label \"Informational\" to email": {
        "main": [
          [
            {
              "node": "Mark email as read",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "cbc2ee05-3bb9-4064-ac26-fed7241e673f",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -460,
          0
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 6
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4a18dea4-9eda-4b8e-9d0c-fff9793802c5",
        "name": "Get Past Events",
        "type": "n8n-nodes-base.googleCalendar",
        "position": [
          -280,
          0
        ],
        "parameters": {
          "options": {},
          "timeMax": "={{ $now.minus({ day: 2 }) }}",
          "timeMin": "={{ $now.minus({ day: 4 }) }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "<your-calendar>"
          },
          "operation": "getAll"
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "kWMxmDbMDDJoYFVK",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "df2ef6d0-5fcb-43c5-8ba9-2d094dffb4e1",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          200,
          40
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "bedc77ad-f0c9-47ae-9609-48ceda47a224",
        "name": "Flag to Follow Up",
        "type": "n8n-nodes-base.set",
        "position": [
          580,
          200
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "={{\n{\n  ...$('Loop Over Items').first().json,\n  followUp: $json.isEmpty()\n}\n}}",
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "b332ca5d-45d5-4a79-a028-baa1728aea78",
        "name": "Only Follow Ups",
        "type": "n8n-nodes-base.filter",
        "position": [
          400,
          40
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "73f38d1b-75c6-4372-8e81-a2db61b045a8",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "1b8a6510-f1c5-4969-a68d-143874b5737d",
        "name": "Get Emails Since",
        "type": "n8n-nodes-base.gmail",
        "position": [
          400,
          200
        ],
        "webhookId": "08fbccff-cce6-461a-b040-f5a74920c803",
        "parameters": {
          "limit": 1,
          "filters": {
            "q": "=(from:{{ $json.attendees.find(attendee => !attendee.self)?.email }} OR to:{{ $json.attendees.find(attendee => !attendee.self)?.email }})",
            "receivedAfter": "={{ $json.end.dateTime }}"
          },
          "resource": "thread"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1,
        "alwaysOutputData": true
      },
      {
        "id": "4ce7ac3f-bad8-4822-b166-fd164d733734",
        "name": "Output",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1140,
          220
        ],
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"slots\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"start\": { \"type\": \"string\" },\n          \"end\": { \"type\": \"string\" }\n        }\n      }\n    }\n  }\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "a22c5b78-d213-4e37-b2c6-f3d1dac96858",
        "name": "Availability",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          1020,
          220
        ],
        "parameters": {
          "options": {
            "timezone": {
              "__rl": true,
              "mode": "id",
              "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Timezone', ``, 'string') }}",
              "__regex": "([-+/_a-zA-Z0-9]*)"
            }
          },
          "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End_Time', ``, 'string') }}",
          "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start_Time', ``, 'string') }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "<your-calendar>"
          },
          "resource": "calendar"
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "kWMxmDbMDDJoYFVK",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "690c79d3-cf0e-4d15-9419-dafb7d86025b",
        "name": "Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          900,
          220
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4e9d23c0-f9a0-4e71-b1b8-1011313942ba",
        "name": "Meeting Availability Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          920,
          40
        ],
        "parameters": {
          "text": "=### Details of the previous call as following\ntitle: {{ $json.summary }}\ndate: {{ $json.start.dateTime }} {{ $json.start.timeZone }}\nduration: {{ DateTime.fromISO($json.end.dateTime).diffTo(DateTime.fromISO($json.start.dateTime), 'minutes') }} minutes",
          "options": {
            "systemMessage": "=You are a calendar availability assistant. Analyse the previous meeting and help me find a similar available slot for the next meeting.\n* take into consideration the day, time of day and duration of the previous meeting and try to set the same or similar for the next\n* next meeting should be in the future.\n* return a list of available slots so that I can forward them to the user.\n\nToday's date is {{ $now }}."
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "851728bf-7f94-4434-9dc6-23569544cdb7",
        "name": "Generate Message",
        "type": "n8n-nodes-base.set",
        "position": [
          1260,
          40
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "cf09c95c-f25e-4fd7-bade-a0feaeaffb3b",
                "name": "message",
                "type": "string",
                "value": "=Hey, just noticed there wasn't a follow-up email to {{ $('Only Follow Ups').item.json.attendees.find(x => !x.self).email }} after your last call a few days ago.\n\nHere's are a few available slots to book the next call.\n{{\n$json.output.slots\n  .filter(slot => !DateTime.fromISO(slot.start).isWeekend())\n  .map(slot => `* ${DateTime.fromISO(slot.start).format('cccc, DDD @ hh:mm')} - ${DateTime.fromISO(slot.end).format('hh:mm')}`)\n.join('\\n')\n}}\n\nLet me know which I should book or let me know if it's okay to dismiss."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "7e45eddc-8c34-402a-86a2-ed89ff463095",
        "name": "Meetings",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          2360,
          240
        ],
        "parameters": {
          "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}",
          "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "<your-calendar>"
          },
          "additionalFields": {
            "summary": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Summary', ``, 'string') }}",
            "description": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', ``, 'string') }}"
          }
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "kWMxmDbMDDJoYFVK",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "74618cf0-1fe5-4abb-ba38-6818162ce826",
        "name": "Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2180,
          240
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "790cc7ee-fe1b-434f-8736-38952bffbb85",
        "name": "Meeting Booking Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2180,
          60
        ],
        "parameters": {
          "text": "={{ $json.data.text }}",
          "options": {
            "systemMessage": "=You are a meeting booking agent. Your task is to book the meeting requested if confirmed by the user or otherwise do nothing if the user wants to disregard. No need to ask for further approval.\n\nAI: {{ $('Generate Message').first().json.message }}"
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "7ed171b2-08ee-49b0-9f9b-b4943549b2f6",
        "name": "Mark as Seen",
        "type": "n8n-nodes-base.removeDuplicates",
        "position": [
          -100,
          0
        ],
        "parameters": {
          "options": {},
          "operation": "removeItemsSeenInPreviousExecutions",
          "dedupeValue": "={{ $json.id }}"
        },
        "typeVersion": 2
      },
      {
        "id": "c8198538-4e02-429d-9fef-4cc2cb0bb7d0",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -540,
          -200
        ],
        "parameters": {
          "color": 7,
          "width": 620,
          "height": 420,
          "content": "## 1. Get Recent Meetings\n[Learn more about the GCalendar node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlecalendar)\n\nFor this template, a scheduled trigger is set to fire every morning to pull in past meetings from 2-3 days ago. A \"Remove Duplicates\" node ensures we don't double process events more than once between runs."
        },
        "typeVersion": 1
      },
      {
        "id": "ef4888e2-249f-4501-a731-4dc8886dfa1a",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          100,
          -160
        ],
        "parameters": {
          "color": 7,
          "width": 680,
          "height": 600,
          "content": "## 2. Check If Any Messages Since\n[Read more about the Gmail node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.gmail)\n\nNext, we want to check if there has been any messages/contact between the lead and the user since the meeting ended. Where there is not, it could be a good opportunity to remind the user to reengage the lead as to not lose them."
        },
        "typeVersion": 1
      },
      {
        "id": "d9ccc4d5-2ccb-4f85-ada1-6a6fc5374ff2",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          800,
          -160
        ],
        "parameters": {
          "color": 7,
          "width": 620,
          "height": 580,
          "content": "## 3. Suggest Availability For Next Call\n[Read more about AI Agents](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent/)\n\nOnce filtered for applicable leads, we can use an AI Agent to suggest another meeting slot for them. An AI Agent can analyse the previous meeting details and use that information to suggest a similar date and time."
        },
        "typeVersion": 1
      },
      {
        "id": "851b15f6-ea6a-4d30-a45b-f9ed087a37fa",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1440,
          -200
        ],
        "parameters": {
          "color": 7,
          "width": 540,
          "height": 520,
          "content": "## 4. Get Human Approval\n[Learn more about n8n's Human-in-the-loop features](https://docs.n8n.io/advanced-ai/examples/human-fallback/)\n\nOf course, we don't want the AI to actually book the meeting unless the user confirms it is something he/she wants to do and the best way to confirm is just to ask the user directly! Thanks for n8n's Human-in-the-loop feature, we can achieve this with a number of messaging protocols.\n\nHere, we're using the Gmail node's **Send-and-wait-for-approval** mode. This will send an email to the user and give them a textbox to tell our agent what they want to do next."
        },
        "typeVersion": 1
      },
      {
        "id": "725b187f-d59b-4a7d-bf11-6265a4c995ed",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2000,
          -160
        ],
        "parameters": {
          "color": 7,
          "width": 640,
          "height": 560,
          "content": "## 5. Book the meeting If Accepted\n[Learn more about the AI Agent node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent/)\n\nFinally, the response from the user combined with the suggested availability slots are given to another AI agent which can book meetings. If the user accepted and confirmed a date, this agent will book the meeting on behalf of the user. If the user declined, then the agent takes no action."
        },
        "typeVersion": 1
      },
      {
        "id": "ae59a45a-01e9-42be-99da-f75ed90f881b",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1000,
          -700
        ],
        "parameters": {
          "width": 420,
          "height": 980,
          "content": "## Try it out!\n### This n8n template extends the idea of sales leads follow-up reminders by having an AI agent suggest and book the next call or message to reengage the prospect.\n\nWhat makes this template practical for use is that it uses the Human-in-the-loop approach to wait for a user's approval before actually making the booking. Without, this could be annoying for both the user and the recipient!\n\n### How it works\n* A scheduled trigger checks your google calendar for sales meetings which happened a few days ago.\n* For each event, gmail search is used to figure out if a follow-up message has been sent or received from the other party since the meeting. If none, we want to remind ourselves to reengage the lead.\n* For leads applicable for follow-up, we first get an AI Agent to find available meeting slots in the calendar.\n* These slots and reminder are sent to the user via send-and-approval mode of the gmail node. The user replies in natural language either picking a slot, suggesting an entirely new slot or declines the request.\n* When accepted, another AI Agent books the meeting in the calendar with the proposed dates and lead.\n\n### How to use\n* Update all calendar nodes (+subnodes) to point to the right calendar. If this is a shared-purpose calendar, you may need to either filter or create a new calendar.\n* Update the gmail nodes to point to the right accounts.\n\n### Customising the template\n* Not using Google? Swap out for Microsoft or otherwise.\n* Try swapping out or adding in additional send-for-approval methods such as telegram or whatsapp.\n\n### Need Help?\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!"
        },
        "typeVersion": 1
      },
      {
        "id": "46ef7220-49ea-4dfc-8e4c-ce7da5119daf",
        "name": "Send for Human Approval",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1660,
          80
        ],
        "webhookId": "76b88312-1c54-482e-abdd-e699159577f0",
        "parameters": {
          "sendTo": "=<your-email-here>",
          "message": "={{ $json.message }}",
          "options": {},
          "subject": "=Book a follow-up meeting with {{ $('Only Follow Ups').item.json.attendees.find(x => !x.self).email }}?",
          "operation": "sendAndWait",
          "responseType": "freeText"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      }
    ],
    "pinData": {},
    "connections": {
      "Model": {
        "ai_languageModel": [
          [
            {
              "node": "Meeting Availability Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Meeting Booking Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Output": {
        "ai_outputParser": [
          [
            {
              "node": "Meeting Availability Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Meetings": {
        "ai_tool": [
          [
            {
              "node": "Meeting Booking Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Availability": {
        "ai_tool": [
          [
            {
              "node": "Meeting Availability Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Mark as Seen": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Past Events": {
        "main": [
          [
            {
              "node": "Mark as Seen",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Only Follow Ups",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Get Emails Since",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Only Follow Ups": {
        "main": [
          [
            {
              "node": "Meeting Availability Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Message": {
        "main": [
          [
            {
              "node": "Send for Human Approval",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Emails Since": {
        "main": [
          [
            {
              "node": "Flag to Follow Up",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Get Past Events",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Flag to Follow Up": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send for Human Approval": {
        "main": [
          [
            {
              "node": "Meeting Booking Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Meeting Availability Agent": {
        "main": [
          [
            {
              "node": "Generate Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "e634e668fe1fc93a75c4f2a7fc0dad807ca318b79654157eadb9578496acbc76",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "30da4d86-83ef-4226-ad2e-d73f531bd4ed",
        "name": "When clicking ‚ÄòTest workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          0,
          100
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "bd57625d-03f2-48b3-94b5-2653214682eb",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          700,
          -280
        ],
        "parameters": {
          "height": 440,
          "content": "## Filtering orders for fulfillment üëá\nFilter the valid orders for programatically fulfillments\n\n- you exclusively sell digital downloads or digital gift cards\n- you use fulfillment services for all your products\n"
        },
        "typeVersion": 1
      },
      {
        "id": "5928c16f-b842-42e3-9c81-ac9b796d22ff",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          1060,
          0
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "4509fb4e-fed0-4424-94a2-55d1c56a5d5a",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1320,
          -180
        ],
        "parameters": {
          "height": 340,
          "content": "## Get fulfillment orders üëá\n[Retrieves a list of fulfillment orders for a specific order.](https://shopify.dev/docs/api/admin-rest/2025-01/resources/fulfillmentorder#get-orders-order-id-fulfillment-orders)\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "76e16b42-01a3-4c88-a64b-a408b4bb9f40",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          0,
          -160
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "1835c0d1-c7d3-4db6-b898-d604c8df7ad1",
        "name": "Filter Orders",
        "type": "n8n-nodes-base.filter",
        "position": [
          760,
          0
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "3fdde26b-82ef-42f1-ba36-d4fe667f8866",
                "operator": {
                  "type": "number",
                  "operation": "gt"
                },
                "leftValue": "={{ (new Date().getTime() - new Date($json.created_at).getTime()) / (1000 * 60 * 60) }}\n",
                "rightValue": 24
              }
            ]
          },
          "looseTypeValidation": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "977c3b8d-e3a9-4146-bc4c-e06e67f26a9e",
        "name": "Get Fulfillment Orders",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1380,
          20
        ],
        "parameters": {
          "url": "=https://{{ $('Set Global').item.json['store-id'] }}.myshopify.com/admin/api/2025-01/orders/{{ $json.id }}/fulfillment_orders.json",
          "options": {},
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "shopifyAccessTokenApi"
        },
        "credentials": {
          "shopifyAccessTokenApi": {
            "id": "vtyKGPLLdjc7MLea",
            "name": "Shopify Access Token account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "cf4c99c4-882c-4706-9cb9-8c154549545b",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          240,
          -180
        ],
        "parameters": {
          "width": 232,
          "height": 346,
          "content": "## Edit this node üëá\n\nGet your store ID and replace in the GET url"
        },
        "typeVersion": 1
      },
      {
        "id": "3a33e89b-ecf5-4be1-b3e4-9c20c00c7c1c",
        "name": "Set Global",
        "type": "n8n-nodes-base.set",
        "position": [
          300,
          0
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "78289fb1-8a1a-46a2-973e-f5f2a7309993",
                "name": "store-id",
                "type": "string",
                "value": "{store-id}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "68dffeba-705c-42b5-851e-893964a51176",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1680,
          -180
        ],
        "parameters": {
          "width": 232,
          "height": 346,
          "content": "## Create fulfillment  üëá\n\n[Creates a fulfillment for one or many fulfillment orders](https://shopify.dev/docs/api/admin-rest/2025-04/resources/fulfillment#post-fulfillments)\n- `notify_customer` to send notifications to customer"
        },
        "typeVersion": 1
      },
      {
        "id": "24137672-00d7-4fa0-9238-f2dca7900adf",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -440,
          -300
        ],
        "parameters": {
          "width": 372,
          "height": 546,
          "content": "## Shopify Fulfillment Automation with n8n\nShopify store owners who want to automate the fulfillment process, whether for entire orders or specific products (like personalization items). However, the challenge lies in retrieving the [Fulfillment Order ID](https://shopify.dev/docs/api/admin-rest/2025-01/resources/fulfillmentorder#get-orders-order-id-fulfillment-orders) (not [Order ID](https://shopify.dev/docs/api/admin-rest/2025-01/resources/order#get-orders-order-id?fields=id,line-items,name,total-price))‚Äîa crucial piece needed to trigger fulfillment.\n\nThis n8n workflow can:\n\n- Get all unfulfilled orders from Shopify store.\n\n- Retrieve the Fulfillment Order ID (using the \"List Fulfillment Orders\" action).\n\n- Create a fulfillment request (using \"Mark fulfillment orders as fulfilled\").\n\n- Handle edge cases, like partially fulfilled orders or errors in API responses.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "bfb340f2-1fb6-4be7-823a-d24d6d8361be",
        "name": "Get all Unfulfilled orders",
        "type": "n8n-nodes-base.shopify",
        "position": [
          540,
          0
        ],
        "parameters": {
          "options": {
            "fulfillmentStatus": "unfulfilled"
          },
          "operation": "getAll",
          "returnAll": true,
          "authentication": "accessToken"
        },
        "credentials": {
          "shopifyAccessTokenApi": {
            "id": "vtyKGPLLdjc7MLea",
            "name": "Shopify Access Token account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8350fcaf-1bf8-4af1-a716-816b19a4b892",
        "name": "Mark fulfillment orders as fulfilled",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1740,
          20
        ],
        "parameters": {
          "url": "=https://{{ $('Set Global').item.json['store-id'] }}.myshopify.com/admin/api/2025-01/fulfillments.json",
          "method": "POST",
          "options": {},
          "jsonBody": "={\"fulfillment\":{\"line_items_by_fulfillment_order\":[{\"fulfillment_order_id\":{{ $json.fulfillment_orders[0].id }}}],\"notify_customer\":true}}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "shopifyAccessTokenApi"
        },
        "credentials": {
          "shopifyAccessTokenApi": {
            "id": "vtyKGPLLdjc7MLea",
            "name": "Shopify Access Token account"
          }
        },
        "typeVersion": 4.2
      }
    ],
    "pinData": {},
    "connections": {
      "Set Global": {
        "main": [
          [
            {
              "node": "Get all Unfulfilled orders",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter Orders": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Get Fulfillment Orders",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Set Global",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Fulfillment Orders": {
        "main": [
          [
            {
              "node": "Mark fulfillment orders as fulfilled",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get all Unfulfilled orders": {
        "main": [
          [
            {
              "node": "Filter Orders",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Set Global",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Mark fulfillment orders as fulfilled": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "nodes": [
      {
        "id": "b1afd02d-6edf-4540-bf32-09d87cb8a27b",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          320,
          220
        ],
        "parameters": {
          "color": 5,
          "width": 379,
          "height": 80,
          "content": "### üë®‚Äçüé§ Setup\n1. Add your Gmail creds"
        },
        "typeVersion": 1
      },
      {
        "id": "3481e6c3-7706-4c7f-8ca6-c96f76d82021",
        "name": "At midnight every work day",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          400,
          340
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "cronExpression",
                "expression": "0 0 * * 1-5"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "3c74e4fd-e919-4acb-8092-658f2e71513b",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          520
        ],
        "parameters": {
          "color": 7,
          "width": 202,
          "height": 100,
          "content": "üëÜ Set your schedule. I use this for work emails. For personal emails, I run this daily."
        },
        "typeVersion": 1
      },
      {
        "id": "de421702-d012-4ea1-826e-1a4756ff4856",
        "name": "Get all emails in the last day",
        "type": "n8n-nodes-base.gmail",
        "position": [
          620,
          340
        ],
        "parameters": {
          "filters": {
            "q": "label:inbox",
            "receivedBefore": "={{ $now.minus({days: 1}) }}"
          },
          "resource": "thread",
          "returnAll": true
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "8",
            "name": "Work Gmail account"
          }
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "ef43b756-5f9c-4c8d-830a-8ccb71562618",
        "name": "Get the thread of each email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          840,
          340
        ],
        "parameters": {
          "options": {},
          "resource": "thread",
          "threadId": "={{ $json.id }}",
          "operation": "get"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "8",
            "name": "Work Gmail account"
          }
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "bfc3b7e1-651a-4eb5-8882-b21d120d982b",
        "name": "Keep only starred emails in inbox",
        "type": "n8n-nodes-base.filter",
        "position": [
          1060,
          340
        ],
        "parameters": {
          "conditions": {
            "boolean": [
              {
                "value1": "={{ JSON.stringify($json.messages).includes('STARRED') }}"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "3d8145dc-577d-4e9b-83a7-fdf06afa1b96",
        "name": "for each message in the thread",
        "type": "n8n-nodes-base.itemLists",
        "position": [
          1480,
          520
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "messages"
        },
        "typeVersion": 2
      },
      {
        "id": "1a9083a8-ffd2-403e-bf53-9b9eee87ff5b",
        "name": "Archive message (remove from inbox)",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1700,
          520
        ],
        "parameters": {
          "labelIds": "=INBOX",
          "messageId": "={{ $json.id }}",
          "operation": "removeLabels"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "8",
            "name": "Work Gmail account"
          }
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "c51240d0-88cb-461b-82ba-929a2d8a9dde",
        "name": "Archive thread  (remove from inbox)",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1340,
          300
        ],
        "parameters": {
          "labelIds": "=INBOX",
          "resource": "thread",
          "threadId": "={{ $json.id }}",
          "operation": "removeLabels"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "8",
            "name": "Work Gmail account"
          }
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "3ca7074f-c912-456c-92e4-08cac8833471",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1060,
          520
        ],
        "parameters": {
          "color": 7,
          "width": 202,
          "height": 100,
          "content": "‚≠ê Keep starred emails in inbox.. Archive everything else!"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "At midnight every work day": {
        "main": [
          [
            {
              "node": "Get all emails in the last day",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get the thread of each email": {
        "main": [
          [
            {
              "node": "Keep only starred emails in inbox",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get all emails in the last day": {
        "main": [
          [
            {
              "node": "Get the thread of each email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "for each message in the thread": {
        "main": [
          [
            {
              "node": "Archive message (remove from inbox)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Keep only starred emails in inbox": {
        "main": [
          [
            {
              "node": "Archive thread  (remove from inbox)",
              "type": "main",
              "index": 0
            },
            {
              "node": "for each message in the thread",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "m8gr0YZgCx5Qrsia",
    "meta": {
      "instanceId": "b795c85ef5703ecdc784a39956949c45a099b0c52b9adbeeed744965b5aed696",
      "templateCredsSetupCompleted": true
    },
    "name": "(G) - Email Classification",
    "tags": [],
    "nodes": [
      {
        "id": "0226578d-4741-42f2-8a7b-c750f75be78d",
        "name": "Gmail Trigger",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          0,
          0
        ],
        "parameters": {
          "simple": false,
          "filters": {},
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YNdPYS7HyXbJjy7l",
            "name": "Gmail account (jkp@kajonkietsuksa.ac.th)"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "48d0ee27-d4d6-4db4-843c-d9c18b934945",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          220,
          320
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash-001"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "ZK3aD9k31PG9XVBd",
            "name": "Guitar's Gemini (babystoreroom@gmail.com)"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d7e8bed4-cadc-41e3-b793-cc8affb177cc",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "disabled": true,
        "position": [
          1420,
          60
        ],
        "parameters": {
          "text": "=Here's the email context: {{ $('Classification Agent').item.json.text }}",
          "options": {
            "systemMessage": "You are my personal assistant for Kajonkietsuksa School.\nYour role is to help me with any work-related tasks.\nOne of your main responsibilities is to write professional and polite reply emails whenever I receive an email in my inbox. Act as me, don't include something like \"here's a potential reply email or other\"\n\nWhen writing a reply email:\n\nStart by acknowledging the sender's message.\n\nAnswer their questions or address their requests clearly and directly.\n\nMaintain a polite, professional, and helpful tone.\n\nKeep the language simple and easy to understand.\n\nIf additional action is required from me, mention that I will get back to them soon.\n\nAlways end the email with a courteous closing line, such as \"Thank you\" or \"Best regards.\"\n\nKeep your writing style consistent with a warm yet formal communication style that reflects the reputation of Kajonkietsuksa School.\n\n"
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "3b5cabb7-346f-4b69-b3f4-c61e78e2d8c7",
        "name": "Groq Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
        "disabled": true,
        "position": [
          1440,
          180
        ],
        "parameters": {
          "model": "meta-llama/llama-4-scout-17b-16e-instruct",
          "options": {}
        },
        "credentials": {
          "groqApi": {
            "id": "ssFnosV0K9CllUnY",
            "name": "(G) Groq account (jkp@kajonkietsuksa.ac.th)"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "43984fb2-7a26-4e13-95ee-c29f0d9f2f24",
        "name": "Gmail3",
        "type": "n8n-nodes-base.gmail",
        "disabled": true,
        "position": [
          1780,
          60
        ],
        "webhookId": "64df877a-5475-447d-860b-b62d4418d841",
        "parameters": {
          "message": "={{ $json.output }}",
          "options": {},
          "subject": "=Re: {{ $('Gmail Trigger').item.json.headers.subject }}",
          "resource": "draft"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YNdPYS7HyXbJjy7l",
            "name": "Gmail account (jkp@kajonkietsuksa.ac.th)"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "c269ec5e-f882-4458-ab52-46b719731309",
        "name": "Classification Agent",
        "type": "@n8n/n8n-nodes-langchain.textClassifier",
        "position": [
          240,
          0
        ],
        "parameters": {
          "options": {
            "systemPromptTemplate": "Please classify the text provided by the user into one of the following categories: {categories}, and use the provided formatting instructions below. Don't explain, and only output the json."
          },
          "inputText": "={{ $json.text || $json.html }}",
          "categories": {
            "categories": [
              {
                "category": "High Priority",
                "description": "Emails requiring immediate attention or action, typically from key stakeholders, clients, or decision-makers. These emails often contain time-sensitive requests, deadlines, or escalated issues. Keywords: urgent, ASAP, immediate, deadline, action required, high priority"
              },
              {
                "category": "KS Work Related",
                "description": "Anything related to my school or education. Keyword: Kajonkietsuksa School, Kajonkietsuksa, School"
              },
              {
                "category": "Promotion",
                "description": "Anything related to updating on promotions. Keywords: newsletter, promotion, offer, sale, campaign, marketing, launch"
              },
              {
                "category": "Other",
                "description": "If you don't know what category is this email."
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "17be38df-c225-4d19-81ec-e205ff4b9f3c",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          60,
          260
        ],
        "parameters": {
          "color": 4,
          "width": 300,
          "height": 80,
          "content": "### 2) Change to your desire LLMs"
        },
        "typeVersion": 1
      },
      {
        "id": "3e8ac267-c2ac-49cb-ad53-536510faa1a4",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          -60
        ],
        "parameters": {
          "color": 4,
          "content": "### 1) Change to your gmail's credential"
        },
        "typeVersion": 1
      },
      {
        "id": "f5e2c92d-3335-4ed0-915e-f7edeb0b5a92",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          220,
          -380
        ],
        "parameters": {
          "color": 4,
          "width": 340,
          "content": "### 3) Login to your gmail inbox\n* Create a label with \"+\" icon\n* Change the color of your choice"
        },
        "typeVersion": 1
      },
      {
        "id": "4a8a7424-f9dd-42b1-b803-5d0dbe076956",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          220,
          -160
        ],
        "parameters": {
          "color": 4,
          "width": 320,
          "content": "### 4) Agent instruction\n* Input the category name that you just created in gmail.\n* Description = Tell agent about how should it classify your email. Keywords can be useful to let your agent classify the email context."
        },
        "typeVersion": 1
      },
      {
        "id": "24c7ef4e-7a68-4240-980b-02b994300084",
        "name": "Add Label Promotion",
        "type": "n8n-nodes-base.gmail",
        "position": [
          700,
          200
        ],
        "webhookId": "4e089f5f-58ea-4c8d-8870-3d155a81f0b7",
        "parameters": {
          "labelIds": [
            "Label_4917715854276709190"
          ],
          "messageId": "={{ $json.id }}",
          "operation": "addLabels"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YNdPYS7HyXbJjy7l",
            "name": "Gmail account (jkp@kajonkietsuksa.ac.th)"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "759f8cbe-4674-49e5-a52b-2acf208ffb22",
        "name": "Add Label (KS Work Related)",
        "type": "n8n-nodes-base.gmail",
        "position": [
          700,
          0
        ],
        "webhookId": "4e089f5f-58ea-4c8d-8870-3d155a81f0b7",
        "parameters": {
          "labelIds": [
            "Label_4956837555783205638"
          ],
          "messageId": "={{ $json.id }}",
          "operation": "addLabels"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YNdPYS7HyXbJjy7l",
            "name": "Gmail account (jkp@kajonkietsuksa.ac.th)"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "d07fe962-16c0-401a-b194-5ce7e6ad9746",
        "name": "Add Label (High Priority)",
        "type": "n8n-nodes-base.gmail",
        "position": [
          700,
          -200
        ],
        "webhookId": "4e089f5f-58ea-4c8d-8870-3d155a81f0b7",
        "parameters": {
          "labelIds": [
            "Label_3750994713301985229"
          ],
          "messageId": "={{ $json.id }}",
          "operation": "addLabels"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YNdPYS7HyXbJjy7l",
            "name": "Gmail account (jkp@kajonkietsuksa.ac.th)"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "7d0c9bd5-6150-4afa-9344-8bb3c1a6b01c",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          660,
          -320
        ],
        "parameters": {
          "color": 4,
          "width": 320,
          "content": "### 5) Add Label Nodes\n* In this option \"Label Names or IDs\" -> Select the category to match with the Classification Agent Node."
        },
        "typeVersion": 1
      },
      {
        "id": "d57ecacb-a479-4bf7-b9b4-b9e14e30dcd7",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          980,
          60
        ],
        "parameters": {
          "color": 4,
          "width": 220,
          "content": "### 6) Add-on\n* You can add more category of your choice!"
        },
        "typeVersion": 1
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "c94df4ec-be75-449f-82fa-4e1f8878104a",
    "connections": {
      "AI Agent": {
        "main": [
          [
            {
              "node": "Gmail3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail Trigger": {
        "main": [
          [
            {
              "node": "Classification Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Groq Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Classification Agent": {
        "main": [
          [
            {
              "node": "Add Label (High Priority)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Add Label (KS Work Related)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Add Label Promotion",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Classification Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Add Label (KS Work Related)": {
        "main": [
          []
        ]
      }
    }
  },
  {
    "id": "DzNTc1Td148ti7RU",
    "meta": {
      "instanceId": "e76981884963d13b9deb7bc5a6b15daf6838937e1dd529f22f2c146d8b79cae4",
      "templateCredsSetupCompleted": true
    },
    "name": "Automatically delete SPAM emails",
    "tags": [
      {
        "id": "yjDYtffFaPyJlYcC",
        "name": "template",
        "createdAt": "2025-05-21T14:11:32.813Z",
        "updatedAt": "2025-05-21T14:11:32.813Z"
      }
    ],
    "nodes": [
      {
        "id": "a4fa3e50-5b63-4e69-97eb-534b1170ebab",
        "name": "Trigger at Sunday midnight",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -260,
          -20
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "weeks"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "286e5c34-18ab-46da-b184-cfabf796b21d",
        "name": "Delete SPAM emails",
        "type": "n8n-nodes-base.gmail",
        "position": [
          160,
          -20
        ],
        "webhookId": "46b0fe0f-cc00-4994-8364-9048c888e9ef",
        "parameters": {
          "messageId": "={{ $json.id }}",
          "operation": "delete"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "yz4iqcG5X1s5wlgS",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "b755451e-7fc3-4c3b-b669-69d700c38fa4",
        "name": "Get all SPAM emails",
        "type": "n8n-nodes-base.gmail",
        "position": [
          -60,
          -20
        ],
        "webhookId": "c47419de-278c-40d1-a5da-c9414d3f89c6",
        "parameters": {
          "filters": {
            "labelIds": [
              "SPAM"
            ]
          },
          "operation": "getAll",
          "returnAll": true
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "yz4iqcG5X1s5wlgS",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "cc3c9d36-a26e-47cb-bb74-3a1027b996cd",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -580,
          -260
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 200,
          "content": "## Automatically delete your SPAM emails on frequent basis\n\nThis automation will run repeatedly at a particular time to delete all your SPAM emails\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "86749abf-16c8-4406-9394-b22a384b4e89",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -280,
          140
        ],
        "parameters": {
          "color": 7,
          "width": 150,
          "height": 200,
          "content": "## :point_up: UPDATE ME\nSelect when to trigger the workflow"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "f47d2f29-89d0-4719-a47b-55b43e84466b",
    "connections": {
      "Get all SPAM emails": {
        "main": [
          [
            {
              "node": "Delete SPAM emails",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger at Sunday midnight": {
        "main": [
          [
            {
              "node": "Get all SPAM emails",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "nodes": [
      {
        "id": "3890c4a4-0649-457f-9dd7-1e688f4a0024",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          320,
          160
        ],
        "parameters": {
          "color": 5,
          "width": 731,
          "height": 210.61602497398542,
          "content": "### üë®‚Äçüé§ Setup\n1. Add you **MadKudu**, **Hunter**, and **Gmail** credentials \n2. Setup your **HubSpot** Oauth2 creds using [n8n docs](https://docs.n8n.io/integrations/builtin/trigger-nodes/n8n-nodes-base.hubspottrigger/)\n3. Set the email content and subject\n4. Click the Test Workflow button, enter your email and check the Slack channel\n5. Activate the workflow and use the form trigger production URL to collect your leads in a smart way "
        },
        "typeVersion": 1
      },
      {
        "id": "77a064c2-852b-4526-aa8b-9a25d3a56844",
        "name": "n8n Form Trigger",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          380,
          420
        ],
        "webhookId": "09f63412-7c4a-4752-93cd-ff1c87774226",
        "parameters": {
          "path": "0bf8840f-1cc4-46a9-86af-a3fa8da80608",
          "options": {},
          "formTitle": "Contact us",
          "formFields": {
            "values": [
              {
                "fieldLabel": "What's your business email?"
              }
            ]
          },
          "formDescription": "We'll get back to you soon"
        },
        "typeVersion": 2
      },
      {
        "id": "9e0ea519-0022-4b9b-853a-6d627f2d427b",
        "name": "Check if the email is valid",
        "type": "n8n-nodes-base.if",
        "position": [
          800,
          420
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "54d84c8a-63ee-40ed-8fb2-301fff0194ba",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.status }}",
                "rightValue": "valid"
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "431c30eb-f9c8-4487-b75c-ee5fcf51a401",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          560
        ],
        "parameters": {
          "color": 7,
          "width": 162,
          "height": 139,
          "content": "üëÜ You can exchange this with any form you like (*e.g. Typeform, Google forms, Survey Monkey...*)"
        },
        "typeVersion": 1
      },
      {
        "id": "eed9a59d-f0a7-4c0c-a36d-1258580f4fac",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1360,
          500
        ],
        "parameters": {
          "color": 7,
          "width": 162,
          "height": 84,
          "content": "üëÜ Adjust the fit as you see necessary"
        },
        "typeVersion": 1
      },
      {
        "id": "e57ed336-8c89-453a-8632-1ea6ec6c5617",
        "name": "Email is not valid, do nothing",
        "type": "n8n-nodes-base.noOp",
        "position": [
          1140,
          560
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "7588462f-7e6c-4273-bead-9ae3d362e341",
        "name": "Score lead with MadKudu",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1140,
          320
        ],
        "parameters": {
          "url": "=https://api.madkudu.com/v1/persons?email={{ $json.email }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "71W5Bt9g1G9GOhVL",
            "name": "MadKudu Lead score"
          }
        },
        "typeVersion": 4.1
      },
      {
        "id": "eac6b41d-fe4f-4cf4-92f5-6a00dcb68c4d",
        "name": "Verify email with Hunter",
        "type": "n8n-nodes-base.hunter",
        "position": [
          600,
          420
        ],
        "parameters": {
          "email": "={{ $json['What\\'s your business email?'] }}",
          "operation": "emailVerifier"
        },
        "credentials": {
          "hunterApi": {
            "id": "ecwmdHFSBU5GGnV1",
            "name": "Hunter account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "51c86cbb-2a43-4ced-9787-6c95db62f390",
        "name": "Not interesting enough",
        "type": "n8n-nodes-base.noOp",
        "position": [
          1660,
          460
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "9f0daa67-6685-44b5-a802-8b70f8b91985",
        "name": "if customer fit score > 60",
        "type": "n8n-nodes-base.if",
        "position": [
          1380,
          320
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "c23d7b34-a4ae-421f-bd7a-6a3ebb05aafe",
                "operator": {
                  "type": "number",
                  "operation": "gt"
                },
                "leftValue": "={{ $json.properties.customer_fit.score }}",
                "rightValue": 60
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "57bf0a97-bf58-43cc-8ab5-e3f298eac5f6",
        "name": "Send outreach email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2100,
          120
        ],
        "parameters": {
          "sendTo": "={{ $json.to }}",
          "message": "={{ $json.html }}",
          "options": {
            "senderName": "Mutasem from n8n",
            "appendAttribution": false
          },
          "subject": "={{ $json.subject }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "rd2agqPeJBD2377h",
            "name": "Work Gmail"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "a93ee7c1-4b77-45ed-9eb8-2757fbeb2b78",
        "name": "Set keys",
        "type": "n8n-nodes-base.set",
        "position": [
          1840,
          260
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "f3ecc873-2d60-4f2d-bc40-81f9379c725b",
                "name": "html",
                "type": "string",
                "value": "=Hello,\n\nThank you for filling out our form. We are excited to be able to help you.\n\nFeel free to schedle a 30-minute call with me here: www.calendly.com/schedule/mutasem\n\nCheers,\n\nMutasem"
              },
              {
                "id": "9f4f5b68-984b-415e-a110-a35ded22dd41",
                "name": "subject",
                "type": "string",
                "value": "Why n8n?"
              },
              {
                "id": "5362aa67-f3fa-4a6e-b6e8-4c50cc7a3192",
                "name": "to",
                "type": "string",
                "value": "={{ $json.properties.email.value }}"
              },
              {
                "id": "ec4ccaef-374f-4fbc-9dda-3b743a00a146",
                "name": "id",
                "type": "number",
                "value": "={{ $json.vid }}"
              }
            ]
          }
        },
        "typeVersion": 3.3
      },
      {
        "id": "f04e7151-b4c9-4294-8e3e-24830e601d6b",
        "name": "Record engagement in HubSpot",
        "type": "n8n-nodes-base.hubspot",
        "position": [
          2100,
          420
        ],
        "parameters": {
          "type": "email",
          "metadata": {
            "html": "={{ $json.html }}",
            "subject": "={{ $json.subject }}",
            "toEmail": [
              "={{ $json.to }}"
            ],
            "firstName": "Mutasem",
            "fromEmail": "mutasem@n8n.io"
          },
          "resource": "engagement",
          "authentication": "oAuth2",
          "additionalFields": {
            "associations": {
              "contactIds": "={{ $json.id }}"
            }
          }
        },
        "credentials": {
          "hubspotOAuth2Api": {
            "id": "Gxwfj6z9NwaEC3P5",
            "name": "HubSpot account 3"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "92bd62d3-7180-4da6-a52b-31048b48b983",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1820,
          160
        ],
        "parameters": {
          "color": 7,
          "width": 162,
          "height": 84,
          "content": "üëáüèΩ  Change the content here"
        },
        "typeVersion": 1
      },
      {
        "id": "cab7bcd9-67af-4cf0-988d-fb2b37b3db8f",
        "name": "HubSpot",
        "type": "n8n-nodes-base.hubspot",
        "position": [
          1620,
          180
        ],
        "parameters": {
          "email": "={{ $json.email }}",
          "options": {},
          "authentication": "oAuth2",
          "additionalFields": {}
        },
        "credentials": {
          "hubspotOAuth2Api": {
            "id": "Gxwfj6z9NwaEC3P5",
            "name": "HubSpot account 3"
          }
        },
        "typeVersion": 2
      }
    ],
    "pinData": {
      "n8n Form Trigger": [
        {
          "formMode": "test",
          "submittedAt": "2024-02-22T13:59:54.709Z",
          "What's your business email?": "jan@n8n.io"
        }
      ]
    },
    "connections": {
      "HubSpot": {
        "main": [
          [
            {
              "node": "Set keys",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set keys": {
        "main": [
          [
            {
              "node": "Send outreach email",
              "type": "main",
              "index": 0
            },
            {
              "node": "Record engagement in HubSpot",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "n8n Form Trigger": {
        "main": [
          [
            {
              "node": "Verify email with Hunter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Score lead with MadKudu": {
        "main": [
          [
            {
              "node": "if customer fit score > 60",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Verify email with Hunter": {
        "main": [
          [
            {
              "node": "Check if the email is valid",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "if customer fit score > 60": {
        "main": [
          [
            {
              "node": "HubSpot",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Not interesting enough",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check if the email is valid": {
        "main": [
          [
            {
              "node": "Score lead with MadKudu",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Email is not valid, do nothing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "AuwhspweKSACE1WQ",
    "meta": {
      "instanceId": "d868e3d040e7bda892c81b17cf446053ea25d2556fcef89cbe19dd61a3e876e9"
    },
    "name": "YouTube to X Post- AlexK1919",
    "tags": [
      {
        "id": "QsH2EXuw2e7YCv0K",
        "name": "OpenAI",
        "createdAt": "2024-11-15T04:05:20.872Z",
        "updatedAt": "2024-11-15T04:05:20.872Z"
      },
      {
        "id": "igCGAN1PI4iVpikM",
        "name": "YouTube",
        "createdAt": "2024-11-21T18:59:47.189Z",
        "updatedAt": "2024-11-21T18:59:47.189Z"
      },
      {
        "id": "nxU3PfnwjUr2YUdo",
        "name": "X",
        "createdAt": "2024-11-21T18:59:49.170Z",
        "updatedAt": "2024-11-21T18:59:49.170Z"
      }
    ],
    "nodes": [
      {
        "id": "6aef04f2-b744-4749-99bd-4ad8aa21ad09",
        "name": "Post to X",
        "type": "n8n-nodes-base.twitter",
        "position": [
          1400,
          100
        ],
        "parameters": {
          "text": "={{ $('Verify character limit constraints').item.json.message.content.post }}",
          "additionalFields": {}
        },
        "credentials": {
          "twitterOAuth2Api": {
            "id": "0VkIx1OfmRAYb4Az",
            "name": "Alex Kim X account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "827ab988-786a-490e-8831-cfee3851a9ac",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -560,
          -100
        ],
        "parameters": {
          "color": 4,
          "width": 450,
          "height": 970,
          "content": "## Fetch the latest YouTube video and dedupe\n\nEnter your YouTube Channel ID in the \"Channel ID\" field of this node. You can find your [Channel ID here](https://youtube.com/account_advanced)."
        },
        "typeVersion": 1
      },
      {
        "id": "8e99c377-7d14-473b-a6e4-a190702ad8a9",
        "name": "Fetch Latest Videos",
        "type": "n8n-nodes-base.youTube",
        "position": [
          -500,
          100
        ],
        "parameters": {
          "limit": 2,
          "filters": {
            "channelId": "UC3JB8Cnync-WCDYKwOYSQUg",
            "publishedAfter": "={{ new Date(new Date().getTime() - 1200 * 60000).toISOString() }}"
          },
          "options": {},
          "resource": "video"
        },
        "credentials": {
          "youTubeOAuth2Api": {
            "id": "xwcVTsTddECg5vyd",
            "name": "AlexK1919 YouTube account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c9ea0b72-2293-4aab-84b4-5e6599f5e04d",
        "name": "Calculator",
        "type": "@n8n/n8n-nodes-langchain.toolCalculator",
        "position": [
          0,
          300
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "e81decde-6a60-4ea0-a3ff-64cbdccc1f88",
        "name": "Wikipedia",
        "type": "@n8n/n8n-nodes-langchain.toolWikipedia",
        "position": [
          120,
          300
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "870a58ba-6d0f-42e5-ad07-040b8d81e780",
        "name": "Check Every 2 Hours",
        "type": "n8n-nodes-base.scheduleTrigger",
        "disabled": true,
        "position": [
          -900,
          100
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "hours",
                "hoursInterval": 2,
                "triggerAtMinute": "={{ Math.floor(Math.random() * 60) }}"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4af4e893-7c94-4a73-9d88-1426be8725f7",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          -100
        ],
        "parameters": {
          "color": 4,
          "width": 637,
          "height": 969,
          "content": "## Validate: Is Post under 240 characters?\nIf the generated tweet does not meet length constraints, regenerate it."
        },
        "typeVersion": 1
      },
      {
        "id": "8c4f51cd-3e25-4d45-a677-1bf27277c2f8",
        "name": "Calculator2",
        "type": "@n8n/n8n-nodes-langchain.toolCalculator",
        "position": [
          680,
          240
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "2eff94c8-5ab8-4fba-8480-39d34077784c",
        "name": "GS - Add Tweet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1120,
          100
        ],
        "parameters": {
          "columns": {
            "value": {
              "xid": "={{ Math.random().toString(36).substr(2, 12) }}",
              "date": "={{ new Date().toISOString().split('T')[0] }}",
              "post": "={{ $json.message.content.post }}",
              "time": "={{ new Date().toLocaleTimeString('en-US', { hour12: false }) }}",
              "status": "Post written",
              "channel": "X"
            },
            "schema": [
              {
                "id": "xid",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "xid",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "time",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "channel",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "channel",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "post",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "post",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "image_url",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "image_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "video_url",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "video_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": []
          },
          "options": {
            "useAppend": true
          },
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ql9TGAzZCSdSqrHvkZLcsBPoNMAjNpPVsELkumP2heM/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1Ql9TGAzZCSdSqrHvkZLcsBPoNMAjNpPVsELkumP2heM",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ql9TGAzZCSdSqrHvkZLcsBPoNMAjNpPVsELkumP2heM/edit?usp=drivesdk",
            "cachedResultName": "AlexK1919 Social Posts"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "IpY8N9VFCXJLC1hv",
            "name": "AlexK1919 Google Sheets account"
          }
        },
        "typeVersion": 4.3
      },
      {
        "id": "21f25b2d-e9d3-46df-a2c9-53f3a8c14b8b",
        "name": "GS - Update Tweet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1400,
          300
        ],
        "parameters": {
          "columns": {
            "value": {
              "xid": "={{ $('GS - Add Tweet').item.json.xid }}",
              "date": "={{ new Date().toISOString().split('T')[0] }}",
              "post": "={{ $json.text }}",
              "time": "={{ new Date().toLocaleTimeString('en-US', { hour12: false }) }}",
              "status": "Posted to X",
              "channel": "X",
              "post_url": "=https://twitter.com/alexkim/status/{{ $json.id }}"
            },
            "schema": [
              {
                "id": "xid",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "xid",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "time",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "channel",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "channel",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "post",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "post",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "post_url",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "post_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "image_url",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "image_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "video_url",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "video_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "xid"
            ]
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ql9TGAzZCSdSqrHvkZLcsBPoNMAjNpPVsELkumP2heM/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1Ql9TGAzZCSdSqrHvkZLcsBPoNMAjNpPVsELkumP2heM",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ql9TGAzZCSdSqrHvkZLcsBPoNMAjNpPVsELkumP2heM/edit?usp=drivesdk",
            "cachedResultName": "AlexK1919 Social Posts"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "IpY8N9VFCXJLC1hv",
            "name": "AlexK1919 Google Sheets account"
          }
        },
        "typeVersion": 4.3
      },
      {
        "id": "8ce4484b-a7fd-4988-8240-e9c09a4a00be",
        "name": "When clicking \"Test workflow\"",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -900,
          300
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "24f9bc85-8892-4418-8ab6-ef73986adc79",
        "name": "Discord",
        "type": "n8n-nodes-base.discord",
        "position": [
          1680,
          100
        ],
        "parameters": {
          "content": "=New X Post:\n{{ $('GS - Add Tweet Again').item.json.Content }}\n\n{{ $json.URL }} ",
          "options": {},
          "authentication": "webhook"
        },
        "typeVersion": 2
      },
      {
        "id": "3526581f-7b71-4396-a3a3-4c676cf1c69b",
        "name": "Remove Duplicates",
        "type": "n8n-nodes-base.removeDuplicates",
        "position": [
          -500,
          300
        ],
        "parameters": {
          "options": {
            "scope": "workflow",
            "historySize": 10000
          },
          "operation": "removeItemsSeenInPreviousExecutions",
          "dedupeValue": "={{ $json.id.videoId }}"
        },
        "typeVersion": 2
      },
      {
        "id": "c152651f-12d3-4766-8b4b-43f93b7b06ee",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          -100
        ],
        "parameters": {
          "color": 4,
          "width": 390,
          "height": 970,
          "content": "## Generate X Post"
        },
        "typeVersion": 1
      },
      {
        "id": "af1dd938-81f9-464a-865a-2a89882bae90",
        "name": "Generate X Post",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          0,
          100
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Write an engaging post about my latest YouTube video for X (Twitter) of no more than 220 characters in length. Link to the video at https://youtu.be/{{ $('Set Fields').first().json.id.videoId }} use this title and description:  {{ $('Set Fields').first().json.snippet.title }} {{ $('Set Fields').first().json.snippet.description }}. If there is no description available, use your best guess as to the context of the video. Make sure the YouTube link is at the end of the content."
              },
              {
                "role": "assistant",
                "content": "Be witty. Humanize the content. No emojis."
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "ysxujEYFiY5ozRTS",
            "name": "AlexK OpenAi Key"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "a522b20c-9cb1-47ec-ab26-d7a444154a51",
        "name": "Set Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          -300,
          100
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "c2e2eecd-ca73-40c9-a364-4713030ab451",
                "name": "id.videoId",
                "type": "string",
                "value": "={{ $json.id.videoId }}"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "82139047-3ed5-4cc3-9e7e-9567e2f51c20",
        "name": "Wikipedia1",
        "type": "@n8n/n8n-nodes-langchain.toolWikipedia",
        "position": [
          800,
          240
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "6ad77986-f18f-44f0-aff6-fe77282bf55a",
        "name": "Rewrite X Post to 220 Characters",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          680,
          40
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Rewrite the content so it is less than 220 characters long in total length. Content:  {{ $('Generate X Post').item.json.message.content.post }}\nMake sure the YouTube Link is at the end of the content."
              },
              {
                "role": "assistant",
                "content": "Be witty. Humanize the content. No emojis."
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "ysxujEYFiY5ozRTS",
            "name": "AlexK OpenAi Key"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "e55adf1f-8d1d-4bb6-aa6a-89459fd81773",
        "name": "Verify character limit constraints",
        "type": "n8n-nodes-base.if",
        "position": [
          440,
          100
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 1,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "0a6ebbb6-4b14-4c7e-9390-215e32921663",
                "operator": {
                  "type": "number",
                  "operation": "gt"
                },
                "leftValue": "={{ $json.message.content.post.length }}",
                "rightValue": 280
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "00beb197-aed5-472d-9515-9f0002cc22ae",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1060,
          -100
        ],
        "parameters": {
          "color": 4,
          "width": 230,
          "height": 970,
          "content": "## Add to Google Sheet"
        },
        "typeVersion": 1
      },
      {
        "id": "f871304f-b39f-46ee-8b22-5f0050eb2b8e",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1340,
          -100
        ],
        "parameters": {
          "color": 4,
          "width": 230,
          "height": 970,
          "content": "## Post to X and update Google Sheet with Post Link"
        },
        "typeVersion": 1
      },
      {
        "id": "c4d0c37b-658d-4208-9d94-39d27c7d7f36",
        "name": "Slack",
        "type": "n8n-nodes-base.slack",
        "position": [
          1680,
          300
        ],
        "webhookId": "f2269822-19a4-43a4-9a91-06bc69d183b4",
        "parameters": {
          "otherOptions": {}
        },
        "typeVersion": 2.2
      },
      {
        "id": "6caf1d2d-49d2-4b28-9f23-04389bdaa079",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1620,
          -100
        ],
        "parameters": {
          "color": 5,
          "width": 230,
          "height": 970,
          "content": "## Optional functions"
        },
        "typeVersion": 1
      },
      {
        "id": "c5528fc1-0416-4295-bdaa-12441099f037",
        "name": "Gmail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1680,
          500
        ],
        "webhookId": "3404c1a8-9118-48aa-ba03-e9e436f5a7a6",
        "parameters": {
          "options": {}
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "7eQtesjR8Fht0INE",
            "name": "AlexK1919 Gmail"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "e9ac1049-9b87-47a5-8fd1-333cc8c77664",
        "name": "Set Final Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          680,
          440
        ],
        "parameters": {
          "options": {},
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "955d51f0-3de9-41f7-a92f-8e7bf9e4d53c",
        "name": "If Array is empty?",
        "type": "n8n-nodes-base.if",
        "position": [
          -300,
          300
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "adfea7c7-ed64-4e1e-a9c3-dc5e33aa1147",
                "operator": {
                  "type": "array",
                  "operation": "empty",
                  "singleValue": true
                },
                "leftValue": "={{ $('Remove Duplicates').all() }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "c088bbe1-2008-4473-9874-dc5595f082b7",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1000,
          -100
        ],
        "parameters": {
          "color": 5,
          "width": 390,
          "height": 970,
          "content": "# Use AI to Promote Your Latest YouTube Video on X"
        },
        "typeVersion": 1
      },
      {
        "id": "03adde36-d864-486a-9190-2e7d27b9f3f2",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1300,
          -100
        ],
        "parameters": {
          "color": 6,
          "width": 250,
          "height": 970,
          "content": "# AlexK1919 \n![Alex Kim](https://media.licdn.com/dms/image/v2/D5603AQFOYMkqCPl6Sw/profile-displayphoto-shrink_400_400/profile-displayphoto-shrink_400_400/0/1718309808352?e=1736985600&v=beta&t=pQKm7lQfUU1ytuC2Gq1PRxNY-XmROFWbo-BjzUPxWOs)\n\n#### I‚Äôm Alex Kim, an AI-Native Workflow Automation Architect Building Solutions to Optimize your Personal and Professional Life.\n\n### About Me\nhttps://beacons.ai/alexk1919\n\n### Products Used \n[OpenAI](https://openai.com)\n[X](https://x.com/)\n[YouTube](https://youtube.com/)\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "5661b96c-9838-4af3-8570-3098acec0bff",
    "connections": {
      "Post to X": {
        "main": [
          [
            {
              "node": "GS - Update Tweet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wikipedia": {
        "ai_tool": [
          [
            {
              "node": "Generate X Post",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Calculator": {
        "ai_tool": [
          [
            {
              "node": "Generate X Post",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Set Fields": {
        "main": [
          [
            {
              "node": "Remove Duplicates",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wikipedia1": {
        "ai_tool": [
          [
            {
              "node": "Rewrite X Post to 220 Characters",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Calculator2": {
        "ai_tool": [
          [
            {
              "node": "Rewrite X Post to 220 Characters",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "GS - Add Tweet": {
        "main": [
          [
            {
              "node": "Post to X",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate X Post": {
        "main": [
          [
            {
              "node": "Verify character limit constraints",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Final Fields": {
        "main": [
          [
            {
              "node": "GS - Add Tweet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GS - Update Tweet": {
        "main": [
          []
        ]
      },
      "Remove Duplicates": {
        "main": [
          [
            {
              "node": "If Array is empty?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If Array is empty?": {
        "main": [
          [],
          [
            {
              "node": "Generate X Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Every 2 Hours": {
        "main": [
          []
        ]
      },
      "Fetch Latest Videos": {
        "main": [
          [
            {
              "node": "Set Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking \"Test workflow\"": {
        "main": [
          [
            {
              "node": "Fetch Latest Videos",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Rewrite X Post to 220 Characters": {
        "main": [
          [
            {
              "node": "Verify character limit constraints",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Verify character limit constraints": {
        "main": [
          [
            {
              "node": "Rewrite X Post to 220 Characters",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Set Final Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "im2OjuCOBEsjN0Bs",
    "meta": {
      "instanceId": "ac2da03b571df9a735ad2de1e61d5f202359008d03eb1b0f3a16081cfda79307"
    },
    "name": "Sync Beex leads to HubSpot copy",
    "tags": [],
    "nodes": [
      {
        "id": "9797c1ac-6392-4f62-873b-f312d7021f6a",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "width": 528,
          "height": 1088,
          "content": "## Sync Beex Leads to HubSpot\n\n> **Disclaimer:** This workflow requires the community node `n8n-nodes-beex`\n\n### Overview\n\nThis workflow listens for **lead creation and update events** from Beex via a webhook and synchronizes them with **HubSpot contacts**.\n\n### How It Works\n\n1. **Trigger**: The workflow is initiated by a lead creation or update event from the Beex node\n2. **Data Transformation**: The `data` payload from the Beex Trigger is converted into a flat JSON structure to simplify field handling\n3. **Email Validation**: The workflow verifies that the lead contains a  non-null email address\n4. **Field Mapping**: Fields are mapped (via drag and drop) from the Beex payload to HubSpot contact properties\n5. **Event Routing**: Based on the Beex event type, the workflow routes to the appropriate branch:\n   - `CREATE`\n   - `UPDATE`\n6. **HTTP Execution**: The corresponding HTTP request is executed:\n   - **POST** to create a new contact in HubSpot\n   - **PUT** to update an existing contact in HubSpot\n   - Both operations use the same JSON body structure, differing only in endpoint and HTTP method\n\n### Usage\n\n- Use the community trigger node from `n8n-nodes-beex`\n- Configure 'Event Types' in the Beex Trigger\n- When mapping fields for create/update operations, ensure that:\n  - The email field is valid (non-null)\n  - Each mapped field name matches an existing HubSpot contact property (default or custom)\n\n### Requirements\n\n- **HubSpot Account** with an App Token (typically from a custom app)\n  - The app must have **read** and **write** permissions for **Contact/Customer** objects\n- **Beex Account** with permission to generate leads\n- Valid Beex **Bearer YOUR_TOKEN_HERE** (`YOUR_TOKEN_HERE`) configured in the Beex Trigger node"
        },
        "typeVersion": 1
      },
      {
        "id": "4ba61631-2c1c-4ce8-b97f-beb5b0ee5667",
        "name": "Routing",
        "type": "n8n-nodes-base.switch",
        "notes": "Create/Update",
        "position": [
          1600,
          528
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "CREATE",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "bf8b6a85-4550-48a0-b97a-7d6db561f20a",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ \n  $('Beex Trigger').item.json.event \n}}",
                      "rightValue": "contact_create"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "UPDATE",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "6fefe4f7-364b-455d-b3a5-9df48585ec3a",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ \n  $('Beex Trigger').item.json.event \n}}",
                      "rightValue": "contact_update"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "notesInFlow": true,
        "typeVersion": 3.3
      },
      {
        "id": "3e4110d9-50a3-45b0-b927-5ac56be2ff26",
        "name": "Update Contact",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "HubSpot",
        "position": [
          1824,
          624
        ],
        "parameters": {
          "url": "=https://api.hubapi.com/crm/v3/objects/contacts/{{ $json.email }}",
          "method": "PATCH",
          "options": {},
          "jsonBody": "={\"properties\": {{ $json.toJsonString() }}}",
          "sendBody": true,
          "sendQuery": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "idProperty",
                "value": "email"
              }
            ]
          },
          "nodeCredentialType": "hubspotAppToken"
        },
        "credentials": {
          "hubspotAppToken": {
            "id": "53cpTGJUn2I8F1oi",
            "name": "HubSpot account - MasterClass"
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "c4fba358-7d67-4b12-8bdc-10bdbaaf5629",
        "name": "¬øEmail Null?",
        "type": "n8n-nodes-base.filter",
        "notes": "Filter",
        "position": [
          1168,
          528
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "fcd1cc2b-f7c4-4510-a9af-5014c6b78444",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.email }}",
                "rightValue": ""
              },
              {
                "id": "1fd401e8-7d43-46a0-a09b-d9ffa70cda55",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.email }}",
                "rightValue": ""
              }
            ]
          }
        },
        "notesInFlow": true,
        "typeVersion": 2.2
      },
      {
        "id": "b0486c6a-6dd6-47e6-b24c-a6e3b0f79ae7",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1504,
          304
        ],
        "parameters": {
          "color": 7,
          "width": 528,
          "height": 480,
          "content": "## HTTP Requests (Routing + Create/Update)"
        },
        "typeVersion": 1
      },
      {
        "id": "4c944d2c-88ad-4894-9043-76bab5a45da5",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          624,
          304
        ],
        "parameters": {
          "color": 7,
          "width": 496,
          "height": 480,
          "content": "## Trigger Node (Beex Trigger + Format)\n- Link the webhook **URL** on the Beex platform\n- We convert the input data into flat JSON.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c9825a97-ddb9-41ac-b783-1f3db9fc58cd",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1120,
          304
        ],
        "parameters": {
          "color": 5,
          "width": 384,
          "height": 480,
          "content": "## Filter and Set Fields\n- Leads without an email address are filtered out.\n- The fields to be configured must have the same name as the properties in HubSpot."
        },
        "typeVersion": 1
      },
      {
        "id": "cbf52c75-156e-49a8-bb93-9f24b5898487",
        "name": "Create Contact",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "HubSpot",
        "position": [
          1824,
          432
        ],
        "parameters": {
          "url": "=https://api.hubapi.com/crm/v3/objects/contacts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\"properties\": {{ $json.toJsonString() }}}",
          "sendBody": true,
          "sendQuery": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {}
            ]
          },
          "nodeCredentialType": "hubspotAppToken"
        },
        "credentials": {
          "hubspotAppToken": {
            "id": "53cpTGJUn2I8F1oi",
            "name": "HubSpot account - MasterClass"
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "a290b1cb-5767-4509-a21f-e5529318eb3b",
        "name": "Beex Trigger",
        "type": "n8n-nodes-beex.beexTrigger",
        "notes": "Create/Update",
        "position": [
          704,
          528
        ],
        "webhookId": "4fdcdedf-b523-4619-bc31-0c6c6131ffc8",
        "parameters": {
          "eventTypes": [
            "contact_create",
            "contact_update"
          ]
        },
        "credentials": {
          "beexApi": {
            "id": "FD0b01gi27wrryXq",
            "name": "TokenApp Beex account"
          }
        },
        "notesInFlow": true,
        "typeVersion": 1
      },
      {
        "id": "4af24a23-2a25-46a9-a4a7-07489e91f1fe",
        "name": "Format",
        "type": "n8n-nodes-base.code",
        "notes": "JavaScript",
        "position": [
          928,
          528
        ],
        "parameters": {
          "jsCode": "const data = $json.data;\nconst generalDates = data.general_dates;\nconst customFields = data.custom_fields;\n\n\nconst flatDates = {};\nconst flatFields = {};\n\nfor (const [key, obj] of Object.entries(generalDates)) {\n  flatDates[key] = obj.value;\n}\n\nfor (const [key, obj] of Object.entries(customFields)) {\n  flatFields[obj.title] = obj.value;\n}\n\n\nreturn {\n  email: data.email,\n  portfolio_id: data.portfolio.id,\n  portfolio_name: data.portfolio.name,\n  ...flatDates,\n  ...flatFields\n};\n"
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "3289fc09-5bb3-4ec1-bc24-600888d396ab",
        "name": "Set Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          1360,
          528
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "039a4910-05c7-439f-9407-4a8c61110072",
                "name": "firstname",
                "type": "string",
                "value": "={{ $json.first_name }}"
              },
              {
                "id": "15d28009-0862-4bcc-859f-d63db7acc819",
                "name": "lastname",
                "type": "string",
                "value": "={{ $json.paternal_surname }} {{ $json.maternal_surname }}"
              },
              {
                "id": "e2403a2a-6569-4b86-9627-423f0db09198",
                "name": "email",
                "type": "string",
                "value": "={{ $json.email }}"
              },
              {
                "id": "cd29acd0-0a4d-493c-873f-29dd488b6e1c",
                "name": "hubspot_custom_field",
                "type": "string",
                "value": "={{ $json.hubspot_custom_field }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "d81812c2-c4a9-4491-9661-9f29a73ad675",
    "connections": {
      "Format": {
        "main": [
          [
            {
              "node": "¬øEmail Null?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Routing": {
        "main": [
          [
            {
              "node": "Create Contact",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Update Contact",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Fields": {
        "main": [
          [
            {
              "node": "Routing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Beex Trigger": {
        "main": [
          [
            {
              "node": "Format",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "¬øEmail Null?": {
        "main": [
          [
            {
              "node": "Set Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "nodes": [
      {
        "id": "2a41e2da-19f7-4c31-ab93-3a534db3179e",
        "name": "Gmail Trigger",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          -360,
          -260
        ],
        "parameters": {
          "filters": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyX",
                "unit": "minutes",
                "value": 5
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "10LJ3tXKoUfexiKU",
            "name": "Gmail account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a25e0e42-8eab-49c5-a553-797da40eb623",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -220,
          -60
        ],
        "parameters": {
          "options": {
            "maxTokens": 4096
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "qR44iMsUYcLrhdR0",
            "name": "OpenAi account"
          }
        },
        "notesInFlow": false,
        "typeVersion": 1
      },
      {
        "id": "cf437748-a0df-42a2-b1ca-f93162d85bfe",
        "name": "Gmail - read labels",
        "type": "n8n-nodes-base.gmailTool",
        "position": [
          80,
          -40
        ],
        "webhookId": "d8ec9401-a9ff-4fe2-9c1e-5a8036cd96c9",
        "parameters": {
          "resource": "label",
          "returnAll": true,
          "descriptionType": "manual",
          "toolDescription": "Tool to read all existing gmail labels"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "10LJ3tXKoUfexiKU",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "152f1970-7a1f-4977-9c21-64b69242d3a9",
        "name": "Gmail - get message",
        "type": "n8n-nodes-base.gmailTool",
        "position": [
          260,
          -40
        ],
        "webhookId": "d8ec9401-a9ff-4fe2-9c1e-5a8036cd96c9",
        "parameters": {
          "messageId": "={{ $fromAI('gmail_message_id', 'id of the gmail message, like 1944fdc33f544369', 'string') }}",
          "operation": "get",
          "descriptionType": "manual",
          "toolDescription": "Tool to read a specific message based on the message ID"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "10LJ3tXKoUfexiKU",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "ae09cedc-9675-4080-bcdc-3d6c4e4bc490",
        "name": "Gmail - add label to message",
        "type": "n8n-nodes-base.gmailTool",
        "position": [
          460,
          -40
        ],
        "webhookId": "7a87b026-1c6e-40e1-a062-aefdd1af1585",
        "parameters": {
          "labelIds": "={{ $fromAI('gmail_categories', 'array of label ids') }}",
          "messageId": "={{ $fromAI('gmail_message_id') }}",
          "operation": "addLabels",
          "descriptionType": "manual",
          "toolDescription": "Tool to add label to message"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "10LJ3tXKoUfexiKU",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "be4a92ab-d3ab-451b-8655-172851f68628",
        "name": "Gmail - create label",
        "type": "n8n-nodes-base.gmailTool",
        "position": [
          640,
          -40
        ],
        "webhookId": "d8ec9401-a9ff-4fe2-9c1e-5a8036cd96c9",
        "parameters": {
          "name": "={{ $fromAI('new_label_name', 'new label name', 'string' ) }} ",
          "options": {},
          "resource": "label",
          "operation": "create",
          "descriptionType": "manual",
          "toolDescription": "Tool to create a new label, only use if label does not already exist"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "10LJ3tXKoUfexiKU",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "a40466d2-2fe3-4a97-98fe-b14cc38cc141",
        "name": "Gmail labelling agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "Objective:\nAutomatically categorize incoming emails based on existing Gmail labels or create a new label if none match.\n\nTools:\n- Get message\n- Read all labels\n- Create label\n- Assign label to message\n\nInstructions:\n\nLabel Matching:\n\nAnalyze the email's subject, sender, recipient, keywords, and content.\nCompare with existing Gmail labels to find the most relevant match.\nLabel Assignment:\n\nAssign the email to the most appropriate existing label.`\nRemove the inbox label if the email is of less importance (like ads, promotions, aka \"Reclame\"), keep normal and important emails in the inbox.\nIf no suitable label exists, create a new label based on the existing labels. Try reusing existing labels as much as possible. Always create a label as a sublabel, if no label applies, if the main label already exists, create the new label under the existing label, if no main label exists, create the label AI and create the new label under this label.\nLabel Creation:\n\nEnsure new labels align with the structure of existing ones, including capitalization, delimiters, and prefixes.\nExamples:\n\nIf the email subject is \"Project Alpha Update,\" assign to [Project Alpha] if it exists.\nFor \"New Vendor Inquiry,\" create \"Vendor Inquiry\" if no relevant label exists.\nOutcome:\nEmails are consistently categorized under the appropriate or newly created labels, maintaining Gmail's organizational structure.",
        "onError": "continueErrorOutput",
        "position": [
          -60,
          -260
        ],
        "parameters": {
          "text": "=Label the email based on the details below:\n{{ JSON.stringify($json) }}",
          "options": {
            "maxIterations": 5,
            "systemMessage": "Objective:\nAutomatically categorize incoming emails based on existing Gmail labels or create a new label if none match.\n\nTools:\n- Get message\n- Read all labels\n- Create label\n- Assign label to message\n\nInstructions:\n\nLabel Matching:\n\nAnalyze the email's subject, sender, recipient, keywords, and content.\nCompare with existing Gmail labels to find the most relevant match.\nLabel Assignment:\n\nAssign the email to the most appropriate existing label.`\nRemove the inbox label if the email is of less importance (like ads, promotions, aka \"Reclame\"), keep normal and important emails in the inbox.\nIf no suitable label exists, create a new label based on the existing labels. Try reusing existing labels as much as possible. Always create a label as a sublabel, if no label applies, if the main label already exists, create the new label under the existing label, if no main label exists, create the label AI and create the new label under this label.\nLabel Creation:\n\nEnsure new labels align with the structure of existing ones, including capitalization, delimiters, and prefixes.\nExamples:\n\nIf the email subject is \"Project Alpha Update,\" assign to [Project Alpha] if it exists.\nFor \"New Vendor Inquiry,\" create \"Vendor Inquiry\" if no relevant label exists.\nOutcome:\nEmails are consistently categorized under the appropriate or newly created labels, maintaining Gmail's organizational structure."
          },
          "promptType": "define"
        },
        "notesInFlow": true,
        "retryOnFail": false,
        "typeVersion": 1.7
      },
      {
        "id": "6b514df4-761c-4072-abf8-d572ee4b8030",
        "name": "Window Buffer Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          -60,
          -40
        ],
        "parameters": {
          "sessionKey": "={{ $json.id }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "f06717ed-00d7-4a99-a78c-53217a0067e7",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          -220,
          -260
        ],
        "webhookId": "2066b863-4526-40cf-90aa-82229895a73c",
        "parameters": {
          "amount": 1
        },
        "typeVersion": 1.1
      },
      {
        "id": "f6084fc3-2b6b-488f-b212-f179435e1a63",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -640,
          -300
        ],
        "parameters": {
          "content": "## Gmail trigger\nPoll Gmail every x minutes, trigger when a new email is received.\n\n- Gmail API"
        },
        "typeVersion": 1
      },
      {
        "id": "5ede55a4-52ae-48c0-969e-afa45d19f2f0",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          -960
        ],
        "parameters": {
          "width": 780,
          "height": 840,
          "content": "## Gmail labelling agent\n- Read the message\n- Read existing labels\n- Create a new label if needed\n- Assign label to message\n\n----\n\nObjective:\nAutomatically categorize incoming emails based on existing Gmail labels or create a new label if none match.\n\nTools:\n- Get message\n- Read all labels\n- Create label\n- Assign label to message\n\nInstructions:\n\nLabel Matching:\n\nAnalyze the email's subject, sender, recipient, keywords, and content.\nCompare with existing Gmail labels to find the most relevant match.\nLabel Assignment:\n\nAssign the email to the most appropriate existing label.`\nRemove the inbox label if the email is of less importance (like ads, promotions, aka \"Reclame\"), keep normal and important emails in the inbox.\nIf no suitable label exists, create a new label based on the existing labels. Try reusing existing labels as much as possible. Always create a label as a sublabel, if no label applies, if the main label already exists, create the new label under the existing label, if no main label exists, create the label AI and create the new label under this label.\nLabel Creation:\n\nEnsure new labels align with the structure of existing ones, including capitalization, delimiters, and prefixes.\nExamples:\n\nIf the email subject is \"Project Alpha Update,\" assign to [Project Alpha] if it exists.\nFor \"New Vendor Inquiry,\" create \"Vendor Inquiry\" if no relevant label exists.\nOutcome:\nEmails are consistently categorized under the appropriate or newly created labels, maintaining Gmail's organizational structure."
        },
        "typeVersion": 1
      },
      {
        "id": "7c8bb6de-b729-4c8e-90c2-641d173ed3dd",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          160,
          160
        ],
        "parameters": {
          "width": 440,
          "content": "## Gmail API\n- Add credentials "
        },
        "typeVersion": 1
      },
      {
        "id": "e9d05013-9546-426f-bdc7-45199dbfc72a",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -580,
          80
        ],
        "parameters": {
          "width": 440,
          "content": "## OpenAI\n- Add credentials "
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Wait": {
        "main": [
          [
            {
              "node": "Gmail labelling agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail Trigger": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Gmail labelling agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Gmail - get message": {
        "ai_tool": [
          [
            {
              "node": "Gmail labelling agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Gmail - read labels": {
        "ai_tool": [
          [
            {
              "node": "Gmail labelling agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Gmail - create label": {
        "ai_tool": [
          [
            {
              "node": "Gmail labelling agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Window Buffer Memory": {
        "ai_memory": [
          [
            {
              "node": "Gmail labelling agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Gmail - add label to message": {
        "ai_tool": [
          [
            {
              "node": "Gmail labelling agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "nodes": [
      {
        "id": "3bc2f88b-c14e-4ee5-84ce-dc16a54aa12b",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          -580,
          320
        ],
        "parameters": {
          "options": {
            "splitCode": "markdown"
          },
          "chunkOverlap": 50
        },
        "typeVersion": 1
      },
      {
        "id": "6bd91468-17db-4918-a232-87fb295a30c2",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1240,
          -140
        ],
        "parameters": {
          "color": 7,
          "width": 978.0454109366399,
          "height": 806.6556079800943,
          "content": "### Load data into database\nFetch file from Google Drive, split it into chunks and insert into Pinecone index"
        },
        "typeVersion": 1
      },
      {
        "id": "3af4e8e9-0503-470e-b449-4551191fb405",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          -160
        ],
        "parameters": {
          "color": 7,
          "width": 795.4336844920119,
          "height": 849.4411596574598,
          "content": "### Chat with database\nEmbed the incoming chat message and use it retrieve relevant chunks from the vector store. These are passed to the model to formulate an answer "
        },
        "typeVersion": 1
      },
      {
        "id": "6f94ec58-4fca-40ee-a1a0-012998093589",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          -580,
          200
        ],
        "parameters": {
          "options": {},
          "dataType": "binary"
        },
        "typeVersion": 1
      },
      {
        "id": "3e145342-458d-4222-a707-9fee78e91c4d",
        "name": "Question and Answer Chain",
        "type": "@n8n/n8n-nodes-langchain.chainRetrievalQa",
        "position": [
          60,
          -20
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "7f2b288a-a002-4cd3-93c0-b2a0e491699c",
        "name": "Vector Store Retriever",
        "type": "@n8n/n8n-nodes-langchain.retrieverVectorStore",
        "position": [
          240,
          200
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "ca930ba7-b45d-47d8-9f36-9db3a25ee77a",
        "name": "When clicking 'Test Workflow' button",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -1420,
          -20
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "90782052-5df2-4f1e-84fc-c47095a81852",
        "name": "When clicking 'Chat' button below",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -140,
          -20
        ],
        "webhookId": "066b342b-f2b6-401e-b560-12f5d23b6103",
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "712dc9d3-af2d-4436-9315-78f66f748b91",
        "name": "Read/Write Files from Disk",
        "type": "n8n-nodes-base.readWriteFile",
        "position": [
          -1200,
          -20
        ],
        "parameters": {
          "options": {},
          "fileSelector": "/tmp/external_data/news.txt"
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "1cd768c1-fcc0-480a-8b33-fbe714788b32",
        "name": "In-Memory Vector Store1",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
        "position": [
          240,
          380
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "2393e667-7e4f-4392-9a7e-b2b4d74d46e8",
        "name": "In-Memory Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
        "position": [
          -980,
          -20
        ],
        "parameters": {
          "mode": "insert",
          "clearStore": true
        },
        "typeVersion": 1
      },
      {
        "id": "e53f51f3-04f3-46ef-aebd-e0b32b415101",
        "name": "Embeddings Cohere",
        "type": "@n8n/n8n-nodes-langchain.embeddingsCohere",
        "position": [
          -940,
          300
        ],
        "parameters": {
          "modelName": "embed-multilingual-v3.0"
        },
        "credentials": {
          "cohereApi": {
            "id": "rXh87ikYuJfDKuCk",
            "name": "CohereApi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "cf1333b6-b69b-4ff1-bfc3-d3d579585efb",
        "name": "Groq Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
        "notes": "‰ΩøÁî®ÁπÅÈ´î‰∏≠Êñá",
        "position": [
          100,
          220
        ],
        "parameters": {
          "model": "llama-3.3-70b-versatile",
          "options": {}
        },
        "credentials": {
          "groqApi": {
            "id": "dznjL979E8j0L4Zc",
            "name": "Groq account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e49cfb2e-5eca-4b43-973d-4bf7285b5d94",
        "name": "Embeddings Cohere1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsCohere",
        "position": [
          340,
          560
        ],
        "parameters": {
          "modelName": "embed-multilingual-v3.0"
        },
        "credentials": {
          "cohereApi": {
            "id": "rXh87ikYuJfDKuCk",
            "name": "CohereApi account"
          }
        },
        "typeVersion": 1
      }
    ],
    "connections": {
      "Groq Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Question and Answer Chain",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings Cohere": {
        "ai_embedding": [
          [
            {
              "node": "In-Memory Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings Cohere1": {
        "ai_embedding": [
          [
            {
              "node": "In-Memory Vector Store1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "In-Memory Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Vector Store Retriever": {
        "ai_retriever": [
          [
            {
              "node": "Question and Answer Chain",
              "type": "ai_retriever",
              "index": 0
            }
          ]
        ]
      },
      "In-Memory Vector Store1": {
        "ai_vectorStore": [
          [
            {
              "node": "Vector Store Retriever",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk": {
        "main": [
          [
            {
              "node": "In-Memory Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "When clicking 'Chat' button below": {
        "main": [
          [
            {
              "node": "Question and Answer Chain",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking 'Test Workflow' button": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "90f9a6ef38ec632934192a5de51518245cd649d4287258dedc9971969910cdb7"
    },
    "nodes": [
      {
        "id": "2969fa79-33b8-4bb4-9dd7-5212f66b413a",
        "name": "Insufficient data response",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          1060,
          1000
        ],
        "parameters": {
          "options": {
            "responseCode": 400,
            "responseHeaders": {
              "entries": [
                {
                  "name": "bad_request",
                  "value": "User data provided is insufficient to book a meeting. Get complete data from user and try to book the meeting again."
                }
              ]
            }
          },
          "respondWith": "text",
          "responseBody": "User data provided is insufficient to book a meeting. Get complete data from user and try to book the meeting again."
        },
        "typeVersion": 1.1
      },
      {
        "id": "c0a19ef9-9184-43f7-aad8-9c1fa3f0184b",
        "name": "Success response",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          1240,
          680
        ],
        "parameters": {
          "options": {
            "responseCode": 200
          },
          "respondWith": "text",
          "responseBody": "=Meeting booked for {{ $('Switch').item.json.body.start }}"
        },
        "typeVersion": 1.1
      },
      {
        "id": "4e7c6af1-bddf-4ea0-ad9a-e1921d53414c",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          840,
          840
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Book meeting",
                "conditions": {
                  "options": {
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "operator": {
                        "type": "boolean",
                        "operation": "true",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.body.attendee_name && $json.body.start && $json.body.attendee_phone && $json.body.attendee_email && $json.body.attendee_company && $json.body.notes ? true : false }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Insufficient data",
                "conditions": {
                  "options": {
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "44b01bcd-81b0-4d03-a11b-4481132b2ce1",
                      "operator": {
                        "type": "boolean",
                        "operation": "false",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.body.attendee_name && $json.body.start && $json.body.attendee_phone && $json.body.attendee_email && $json.body.attendee_company && $json.body.notes ? true : false }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.1
      },
      {
        "id": "267a71ac-8769-4db4-9017-97b3dd83141f",
        "name": "Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          660,
          840
        ],
        "webhookId": "44f259b3-3676-4c6f-a245-a34a5762eba1",
        "parameters": {
          "path": "validate-booking-1234-abcd",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode",
          "authentication": "headerAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "someId",
            "name": "someName"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "dac5a66e-5fad-4637-8640-29bc88f53038",
        "name": "Create booking",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1060,
          680
        ],
        "parameters": {
          "url": "https://api.cal.com/v2/bookings",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"attendee\": {\n    \"language\": \"en\",\n    \"name\": \"{{ $json.body.attendee_name }}\",\n    \"timeZone\": \"{{ $json.body.attendee_timezone }}\",\n    \"email\": \"{{ $json.body.attendee_email }}\",\n    \"phoneNumber\": \"{{ $json.body.attendee_phone }}\"\n  },\n  \"start\": \"{{ $json.body.start }}\",\n  \"eventTypeId\": {{ $json.body.eventTypeId }},\n  \"bookingFieldsResponses\": {\n    \"phone\": \"{{ $json.body.attendee_phone }}\",\n    \"company\": \"{{ $json.body.attendee_company }}\",\n    \"notes\": \"{{ $json.body.notes }}\"\n  }\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer YOUR_TOKEN_HERE"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "cal-api-version",
                "value": "2024-08-13"
              }
            ]
          }
        },
        "typeVersion": 4.2
      }
    ],
    "pinData": {
      "Webhook": [
        {
          "body": {
            "notes": "Discovery call to find synergies.",
            "start": "2025-07-07T13:30:00Z",
            "eventTypeId": 123456,
            "attendee_name": "Some Guy",
            "attendee_email": "someguy@example.com",
            "attendee_phone": "+12125551234",
            "attendee_company": "Example Inc",
            "attendee_timezone": "America/New_York"
          },
          "query": {},
          "params": {},
          "headers": {
            "host": "127.0.0.1:5678",
            "accept": "*/*",
            "secret": "mySecretFrom11Labs",
            "connection": "close",
            "user-agent": "Python/3.12 aiohttp/3.11.16",
            "content-type": "application/json",
            "content-length": "285",
            "accept-encoding": "gzip, deflate",
            "x-forwarded-for": "12.34.56.78"
          },
          "executionMode": "production"
        }
      ],
      "Create booking": [
        {
          "code": 1,
          "name": "First item"
        }
      ],
      "Success response": [
        {
          "code": 1,
          "name": "First item"
        }
      ],
      "Insufficient data response": [
        {
          "body": {
            "notes": "Discovery call to find synergies.",
            "start": "2025-07-08T13:00:00.000Z",
            "eventTypeId": 903650,
            "attendee_name": "",
            "attendee_email": "",
            "attendee_phone": "",
            "attendee_company": ""
          },
          "query": {},
          "params": {},
          "headers": {
            "host": "127.0.0.1:5678",
            "accept": "*/*",
            "secret": "mySecretFrom11Labs",
            "connection": "close",
            "user-agent": "Python/3.12 aiohttp/3.11.16",
            "content-type": "application/json",
            "content-length": "233",
            "accept-encoding": "gzip, deflate",
            "x-forwarded-for": "12.34.56.78"
          },
          "executionMode": "test"
        }
      ]
    },
    "connections": {
      "Switch": {
        "main": [
          [
            {
              "node": "Create booking",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Insufficient data response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create booking": {
        "main": [
          [
            {
              "node": "Success response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "074f90e2bb5206c5f405a8aac6551497c72005283a5405fb08207b1b3a78c2b8",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "e39a0b25-53ce-4ac0-9c93-7750b8e6105b",
        "name": "Knowledge Base Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          220,
          0
        ],
        "parameters": {
          "text": "={{ $json.message.text }}",
          "options": {
            "systemMessage": "You are the AI assistant for a company specializing in advanced technology solutions. Your task is to help internal users by consulting the official product documentation for the company‚Äôs platforms.\n\nAvailable References:\n\nproductDocs: Step-by-step guides, technical configurations, and official manuals from the developer documentation.\n\nfeedbackPositive: Previous responses rated positively by users, useful as examples for generating high-quality answers.\n\nfeedbackNegative: Previous responses rated negatively by users. Use this tool to avoid making similar mistakes in your replies.\n\nCurrently, there are no use cases or update history documented in the available materials.\n\nBehavior Rules\n\nSearch & Response:\n\nAlways consult the official documentation first using the productDocs tool.\n\nAlso search feedbackPositive for highly rated previous responses to similar questions.\n\nCheck feedbackNegative to see if similar answers were poorly rated, and avoid repeating those mistakes.\n\nIf multiple tools return relevant results, combine the information to provide the best answer. If only one tool returns relevant content, use that as your source.\n\nRespond directly and clearly, explaining exactly how to perform the requested task.\n\nDo not filter by category unless the user explicitly asks.\n\nLanguage (Strict Per-Message Rule):\n\nDetect the language of each incoming message individually.\n\nRespond in the same language as the most recent message.\n\nDo not use the language of previous messages or conversation history to decide the language.\n\nLinks (Not Allowed):\n\nNever provide links, even if the user requests them.\n\nIf a user asks for a link, respond with:\n‚ÄúI cannot provide links. If you need specific information, let me know and I will help with the details.‚Äù\n\nResponse Style:\n\nUse a professional, direct, and human tone.\n\nKeep responses between 2 and 4 lines unless the user asks for more detail.\n\nDo not make up information that isn‚Äôt in MongoDB.\n\nIf your answer contains numbered steps or lists, always number them sequentially (1, 2, 3...) without skipping or repeating numbers, even if the original content uses a different numbering style."
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "775b7991-88f3-4959-a068-3fb2b667567e",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          200,
          180
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cJRah9hGPQ7eX4jd",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4c2e0ea6-f5d0-4d5b-a065-606b2dc2cff5",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          440,
          460
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cJRah9hGPQ7eX4jd",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "2f813af6-3432-4201-93d0-ff503013642e",
        "name": "Document Section Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          580,
          -340
        ],
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "doc_id",
                  "value": "={{ $json.documentId }}"
                }
              ]
            }
          },
          "jsonData": "={{ $json.content }}",
          "jsonMode": "expressionData"
        },
        "typeVersion": 1
      },
      {
        "id": "c6386d7b-f3cb-4884-9477-a69e9743e6c6",
        "name": "Document Chunker",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          560,
          -220
        ],
        "parameters": {
          "options": {
            "splitCode": "markdown"
          },
          "chunkSize": 3000,
          "chunkOverlap": 200
        },
        "typeVersion": 1
      },
      {
        "id": "4ff1a843-5e1c-4a23-bdf3-2fdc91ba7032",
        "name": "OpenAI Embeddings Generator",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          440,
          -340
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cJRah9hGPQ7eX4jd",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "64624ed6-cbb2-43c1-b348-df92f26d8efe",
        "name": "Google Docs Importer",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          220,
          -520
        ],
        "parameters": {
          "operation": "get",
          "documentURL": "https://docs.google.com/document/d/1gvgp71e9edob8WLqFIYCdzC7kUq3pLO37VKb-a-vVW4/edit?tab=t.0"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "FNXMwqMf7vl1WUFj",
            "name": "Google Docs account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "09c262ab-ba89-429c-b8a8-41c3ae79d97c",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -420,
          -500
        ],
        "parameters": {
          "color": 5,
          "content": "Run this workflow manually to import and index Google Docs product documentation into MongoDB with vector embeddings for fast search."
        },
        "typeVersion": 1
      },
      {
        "id": "f309ff4a-194f-413a-b8f5-d8210cb5e0c6",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -420,
          40
        ],
        "parameters": {
          "color": 4,
          "height": 180,
          "content": "This workflow uses retrieval-augmented generation (RAG) to answer user questions by searching the MongoDB vector store and generating AI responses enhanced with Telegram-based RLHF feedback."
        },
        "typeVersion": 1
      },
      {
        "id": "caf481b3-7a19-40df-b5fb-52e74a8edd73",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1800,
          -480
        ],
        "parameters": {
          "width": 520,
          "height": 1040,
          "content": "Documentation Search Index\n\n{\n  \"mappings\": {\n    \"dynamic\": false,\n    \"fields\": {\n      \"_id\": {\n        \"type\": \"string\"\n      },\n      \"text\": {\n        \"type\": \"string\"\n      },\n      \"embedding\": {\n        \"type\": \"knnVector\",\n        \"dimensions\": 1536,\n        \"similarity\": \"cosine\"\n      },\n      \"source\": {\n        \"type\": \"string\"\n      },\n      \"doc_id\": {\n        \"type\": \"string\"\n      }\n    }\n  }\n}\n\n\nFeedback Search Index\n\n{\n  \"mappings\": {\n    \"dynamic\": false,\n    \"fields\": {\n      \"prompt\": {\n        \"type\": \"string\"\n      },\n      \"response\": {\n        \"type\": \"string\"\n      },\n      \"text\": {\n        \"type\": \"string\"\n      },\n      \"embedding\": {\n        \"type\": \"knnVector\",\n        \"dimensions\": 1536,\n        \"similarity\": \"cosine\"\n      },\n      \"feedback\": {\n        \"type\": \"token\"\n      }\n    }\n  }\n}\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8a3abf9e-6f3f-47cf-b9ec-bb9da9835e5c",
        "name": "When clicking \"Execute Workflow\"",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          0,
          -520
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "4235ba8c-d671-40b8-b3a4-d7cccac36d54",
        "name": "MongoDB Chat Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryMongoDbChat",
        "position": [
          320,
          180
        ],
        "parameters": {
          "sessionKey": "={{ $('Receive Message on Telegram').item.json.message.chat.id }}",
          "sessionIdType": "customKey",
          "collectionName": "n8n-template-chat-history"
        },
        "credentials": {
          "mongoDb": {
            "id": "7riubYENUDZsmjyK",
            "name": "MongoDB account 2"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "000e272a-3f19-4c17-86b5-07505eba2c3b",
        "name": "Embeddings OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          160,
          440
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cJRah9hGPQ7eX4jd",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "dca02c04-2921-4982-83a3-6b2f6fb32663",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          1400,
          180
        ],
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "prompt",
                  "value": "={{ $json.prompt }}"
                },
                {
                  "name": "response",
                  "value": "={{ $json.response }}"
                },
                {
                  "name": "feedback",
                  "value": "={{ $json.feedback }}"
                }
              ]
            }
          },
          "jsonData": "={{ $json.text }}",
          "jsonMode": "expressionData"
        },
        "typeVersion": 1
      },
      {
        "id": "757073e3-f8b5-42b5-ab02-d310d5f6e8a4",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          1380,
          300
        ],
        "parameters": {
          "options": {},
          "chunkSize": 4000
        },
        "typeVersion": 1
      },
      {
        "id": "588ef94b-9723-440a-ac13-d97d744ae26d",
        "name": "Embeddings OpenAI3",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          320,
          720
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cJRah9hGPQ7eX4jd",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "355654d8-95e2-4337-9b1f-af2a08573f08",
        "name": "Search Positive Interactions",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreMongoDBAtlas",
        "position": [
          160,
          320
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "feedback",
                  "value": "positive"
                }
              ]
            }
          },
          "toolName": "feedbackPositive",
          "mongoCollection": {
            "__rl": true,
            "mode": "list",
            "value": "n8n-template-feedback",
            "cachedResultName": "n8n-template-feedback"
          },
          "toolDescription": "Retrieve previous examples of similar questions that were rated positively by users. Use this tool before responding to improve your answer based on those approved examples.",
          "vectorIndexName": "template-feedback-search"
        },
        "credentials": {
          "mongoDb": {
            "id": "7riubYENUDZsmjyK",
            "name": "MongoDB account 2"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "84a95dfb-6cc4-4a18-be40-6fa201073750",
        "name": "Search Documentation",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreMongoDBAtlas",
        "position": [
          440,
          320
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {},
          "toolName": "productDocs",
          "mongoCollection": {
            "__rl": true,
            "mode": "list",
            "value": "n8n-template",
            "cachedResultName": "n8n-template"
          },
          "toolDescription": "retreive documentation",
          "vectorIndexName": "data_index"
        },
        "credentials": {
          "mongoDb": {
            "id": "7riubYENUDZsmjyK",
            "name": "MongoDB account 2"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "f2001c81-081b-4417-8349-3db459c0f191",
        "name": "Search Negative Interactions",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreMongoDBAtlas",
        "position": [
          240,
          580
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "feedback",
                  "value": "negative"
                }
              ]
            }
          },
          "toolName": "feedbackNegative",
          "mongoCollection": {
            "__rl": true,
            "mode": "list",
            "value": "n8n-template-feedback",
            "cachedResultName": "n8n-template-feedback"
          },
          "toolDescription": "Retrieve previous examples of similar questions that were rated negatively by users. Use this tool before responding to avoid generating answers similar to those that did not work well in the past.",
          "vectorIndexName": "template-feedback-search"
        },
        "credentials": {
          "mongoDb": {
            "id": "7riubYENUDZsmjyK",
            "name": "MongoDB account 2"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "1a0de194-3508-4d21-b1a2-35c3b4a998c1",
        "name": "Receive Message on Telegram",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          0,
          0
        ],
        "webhookId": "fff1b90c-59ce-406b-a7f0-08953c90c0ce",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "wb9guorEXe6W5V8C",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "92458560-feb5-40df-b52a-ec1c5156829d",
        "name": "Send Message on Telegram, Wait for Feedback",
        "type": "n8n-nodes-base.telegram",
        "position": [
          600,
          0
        ],
        "webhookId": "ed8fc221-70ad-47df-b70e-6667c580553b",
        "parameters": {
          "chatId": "={{ $('Receive Message on Telegram').item.json.message.chat.id }}",
          "message": "={{ $json.output }}",
          "options": {
            "appendAttribution": false
          },
          "operation": "sendAndWait",
          "approvalOptions": {
            "values": {
              "approvalType": "double"
            }
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "wb9guorEXe6W5V8C",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ef40200d-5f19-4199-8ae3-9f2e0f52ac1b",
        "name": "Map feedback data",
        "type": "n8n-nodes-base.code",
        "position": [
          820,
          0
        ],
        "parameters": {
          "jsCode": "let response;\n\nif ($input.first().json.data.approved) {\n  response = \"positive\"\n} \nelse {\n  response = \"negative\"\n}\n\nreturn {\n  feedback: response\n}\n"
        },
        "typeVersion": 2
      },
      {
        "id": "d688073c-9a97-4b39-9640-c368cccf3491",
        "name": "Set feedback fields for collection storage",
        "type": "n8n-nodes-base.set",
        "position": [
          1040,
          0
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "prompt",
                "value": "={{ $('Receive Message on Telegram').item.json.message.text }}"
              },
              {
                "name": "response",
                "value": "={{ $('Knowledge Base Agent').item.json.output }}"
              },
              {
                "name": "text",
                "value": "=Prompt: {{ $('Receive Message on Telegram').item.json.message.text }}. Completion: {{ $('Knowledge Base Agent').item.json.output }}"
              },
              {
                "name": "feedback",
                "value": "={{ $json.feedback }}"
              }
            ]
          },
          "options": {},
          "keepOnlySet": true
        },
        "typeVersion": 1
      },
      {
        "id": "9907480f-3e5d-4240-adbb-790be2d68496",
        "name": "Submit embedded chat feedback",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreMongoDBAtlas",
        "position": [
          1260,
          0
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "mongoCollection": {
            "__rl": true,
            "mode": "list",
            "value": "n8n-template-feedback",
            "cachedResultName": "n8n-template-feedback"
          },
          "vectorIndexName": "template-feedback-search",
          "embeddingBatchSize": 1
        },
        "credentials": {
          "mongoDb": {
            "id": "7riubYENUDZsmjyK",
            "name": "MongoDB account 2"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "1a470ad3-845a-4890-b103-65a21b1940de",
        "name": "OpenAI Embeddings Generator1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          1260,
          180
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cJRah9hGPQ7eX4jd",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "fdc22256-f014-4ed0-8781-1abb20134b1a",
        "name": "MongoDB Documentation Inserter",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreMongoDBAtlas",
        "position": [
          440,
          -520
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "mongoCollection": {
            "__rl": true,
            "mode": "list",
            "value": "n8n-template",
            "cachedResultName": "n8n-template"
          },
          "vectorIndexName": "data_index"
        },
        "credentials": {
          "mongoDb": {
            "id": "7riubYENUDZsmjyK",
            "name": "MongoDB account 2"
          }
        },
        "typeVersion": 1.1
      }
    ],
    "pinData": {},
    "connections": {
      "Document Chunker": {
        "ai_textSplitter": [
          [
            {
              "node": "Document Section Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Search Documentation",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Map feedback data": {
        "main": [
          [
            {
              "node": "Set feedback fields for collection storage",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Knowledge Base Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "Search Positive Interactions",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI3": {
        "ai_embedding": [
          [
            {
              "node": "Search Negative Interactions",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Submit embedded chat feedback",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "MongoDB Chat Memory": {
        "ai_memory": [
          [
            {
              "node": "Knowledge Base Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Docs Importer": {
        "main": [
          [
            {
              "node": "MongoDB Documentation Inserter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Knowledge Base Agent": {
        "main": [
          [
            {
              "node": "Send Message on Telegram, Wait for Feedback",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search Documentation": {
        "ai_tool": [
          [
            {
              "node": "Knowledge Base Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Document Section Loader": {
        "ai_document": [
          [
            {
              "node": "MongoDB Documentation Inserter",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Embeddings Generator": {
        "ai_embedding": [
          [
            {
              "node": "MongoDB Documentation Inserter",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Receive Message on Telegram": {
        "main": [
          [
            {
              "node": "Knowledge Base Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Embeddings Generator1": {
        "ai_embedding": [
          [
            {
              "node": "Submit embedded chat feedback",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Search Negative Interactions": {
        "ai_tool": [
          [
            {
              "node": "Knowledge Base Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Search Positive Interactions": {
        "ai_tool": [
          [
            {
              "node": "Knowledge Base Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "MongoDB Documentation Inserter": {
        "main": [
          []
        ]
      },
      "When clicking \"Execute Workflow\"": {
        "main": [
          [
            {
              "node": "Google Docs Importer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Set feedback fields for collection storage": {
        "main": [
          [
            {
              "node": "Submit embedded chat feedback",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Message on Telegram, Wait for Feedback": {
        "main": [
          [
            {
              "node": "Map feedback data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "MMDt8lGtac2oU8nI",
    "meta": {
      "instanceId": "a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462",
      "templateCredsSetupCompleted": true
    },
    "name": "Build a Chatbot, Voice Agent and Phone Agent with Voiceflow, Google Calendar and RAG",
    "tags": [],
    "nodes": [
      {
        "id": "20605948-5277-4fd7-9ba0-63f645bf2dcc",
        "name": "n8n_order",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -340,
          -140
        ],
        "webhookId": "9ff7a394-5b4b-4790-a96b-c41c4ba27fa5",
        "parameters": {
          "path": "9ff7a394-5b4b-4790-a96b-c41c4ba27fa5",
          "options": {},
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "9ef7971e-f679-4d5e-b347-3238d51a06d6",
        "name": "Google Calendar",
        "type": "n8n-nodes-base.googleCalendar",
        "position": [
          300,
          280
        ],
        "parameters": {
          "end": "={{ $json.output.end }}",
          "start": "={{ $json.output.start }}",
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "info@n3w.it",
            "cachedResultName": "info@n3w.it"
          },
          "additionalFields": {
            "summary": "=Event title with {{ $('n8n_appointment').item.json.query.Email }}",
            "description": "Event description"
          }
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "8RFK3u13g2PJEGa9",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "17b9f162-c4a3-43ec-b640-a68ebc67b0c9",
        "name": "OpenAI Chat Model3",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -120,
          480
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "4zwP0MSr8zkNvvV9",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "5b40db3c-6c98-4fea-9c3b-98ba7e13bc30",
        "name": "Concert start date",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          -80,
          280
        ],
        "parameters": {
          "text": "=Convert this date to a compatible format for Google Calendar APIs for the start date, and for the end date add 1 hour to the start date.\n\nHere is the start date:\n{{ $json.query.Appointment_date }}",
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.6
      },
      {
        "id": "8931d21a-7c30-40ae-b0b0-1f5f6868b3a3",
        "name": "n8n_appointment",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -340,
          280
        ],
        "webhookId": "f5edfe92-649b-40da-ab35-f818ccb55ad4",
        "parameters": {
          "path": "f5edfe92-649b-40da-ab35-f818ccb55ad4",
          "options": {},
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "fa3e66ca-de09-496b-be14-483b33386e07",
        "name": "Retrive Qdrant Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
        "position": [
          20,
          1280
        ],
        "parameters": {
          "options": {},
          "qdrantCollection": {
            "__rl": true,
            "mode": "list",
            "value": "scarperia",
            "cachedResultName": "scarperia"
          }
        },
        "credentials": {
          "qdrantApi": {
            "id": "iyQ6MQiVaF3VMBmt",
            "name": "QdrantApi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ea7be112-1949-47b7-b68b-ae2f3a7b1b71",
        "name": "Embeddings OpenAI2",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          -20,
          1460
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "4zwP0MSr8zkNvvV9",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e61ff57f-a109-41e0-87f3-522b1fa78dd6",
        "name": "RAG",
        "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
        "position": [
          180,
          1080
        ],
        "parameters": {
          "name": "company_data",
          "description": "Retrive data about company knowledge from vector store"
        },
        "typeVersion": 1
      },
      {
        "id": "fce158b8-73a3-42c1-baf3-9f2ae979fe15",
        "name": "OpenAI Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -20,
          1080
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "4zwP0MSr8zkNvvV9",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e2bcfa68-3642-4e49-89cb-e08faade984c",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          340,
          1300
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "4zwP0MSr8zkNvvV9",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "2a79c66c-040b-4ca2-ad91-a0683d0d2996",
        "name": "Retrive Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          60,
          860
        ],
        "parameters": {
          "text": "={{ $json.query.Question }}",
          "agent": "conversationalAgent",
          "options": {
            "systemMessage": "You are an AI-powered assistant for an electronics store. Your primary goal is to assist customers by providing accurate and helpful information about products, troubleshooting tips, and general support. Use the provided knowledge base (retrieved documents) to answer questions with precision and professionalism.\n\n**Guidelines**:\n1. **Product Information**:\n   - Provide detailed descriptions of products, including specifications, features, and compatibility.\n   - Highlight key selling points and differences between similar products.\n   - Mention availability, pricing, and promotions if applicable.\n\n2. **Technical Support**:\n   - Offer step-by-step troubleshooting guides for common issues.\n   - Suggest solutions for setup, installation, or configuration problems.\n   - If the issue is complex, recommend contacting the store‚Äôs support team for further assistance.\n\n3. **Customer Service**:\n   - Respond politely and professionally to all inquiries.\n   - If a question is unclear, ask for clarification to provide the best possible answer.\n   - For order-related questions (e.g., status, returns, or cancellations), guide customers on how to proceed using the store‚Äôs systems.\n\n4. **Knowledge Base Usage**:\n   - Always reference the provided knowledge base (retrieved documents) to ensure accuracy.\n   - If the knowledge base does not contain relevant information, inform the customer and suggest alternative resources or actions.\n\n5. **Tone and Style**:\n   - Use a friendly, approachable, and professional tone.\n   - Avoid technical jargon unless the customer demonstrates familiarity with the topic.\n   - Keep responses concise but informative.\n\n**Example Interactions**:\n1. **Product Inquiry**:\n   - Customer: \"What‚Äôs the difference between the XYZ Smartwatch and the ABC Smartwatch?\"\n   - AI: \"The XYZ Smartwatch features a longer battery life (up to 7 days) and built-in GPS, while the ABC Smartwatch has a brighter AMOLED display and supports wireless charging. Both are compatible with iOS and Android devices. Would you like more details on either product?\"\n\n2. **Technical Support**:\n   - Customer: \"My wireless router isn‚Äôt connecting to the internet.\"\n   - AI: \"Please try the following steps: 1) Restart your router and modem. 2) Ensure all cables are securely connected. 3) Check if the router‚Äôs LED indicators show a stable connection. If the issue persists, you may need to reset the router to factory settings. Would you like a detailed guide for resetting your router?\"\n\n3. **Customer Service**:\n   - Customer: \"How do I return a defective product?\"\n   - AI: \"To return a defective product, please visit our Returns Portal on our website and enter your order number. You‚Äôll receive a return label and instructions. If you need further assistance, our support team is available at support@electronicsstore.com.\"\n\n**Limitations**:\n- If the question is outside the scope of the knowledge base or requires human intervention, inform the customer and provide contact details for the appropriate department.\n- Do not provide speculative or unverified information. Always rely on the knowledge base or direct the customer to official resources."
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "be516c9c-d2fb-4dea-9a3b-9674be5ea689",
        "name": "n8n_rag",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -360,
          860
        ],
        "webhookId": "edb1e894-1210-4902-a34f-a014bbdad8d8",
        "parameters": {
          "path": "edb1e894-1210-4902-a34f-a014bbdad8d8",
          "options": {},
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "2412721d-7353-4a27-8068-5c90872c7a51",
        "name": "Tracking response",
        "type": "n8n-nodes-base.set",
        "position": [
          360,
          -140
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "86f332ff-7b89-4dd4-8df9-06c081625d33",
                "name": "text",
                "type": "string",
                "value": "=Your order status is: {{ $json.status }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "4965d781-1452-42c9-8a84-baacb5abe97f",
        "name": "Calendar response",
        "type": "n8n-nodes-base.set",
        "position": [
          500,
          280
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "0fe6fe50-9263-479a-ab01-ca1d15ce2412",
                "name": "text",
                "type": "string",
                "value": "L'evento √® stato creato con successo"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "5311be28-2878-41ce-a70f-4e4aebcea0f9",
        "name": "Webhook tracking response",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          700,
          -140
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "84d8558f-e6fd-400e-ae2e-0b5fec309561",
        "name": "API URL Tracking",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          20,
          -140
        ],
        "parameters": {
          "url": "URL_TRACKING",
          "options": {},
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "Order number",
                "value": "={{ $json.Order_number }}"
              },
              {
                "name": "Email",
                "value": "={{ $json.Order_number }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "32eb8645-c56e-4db4-8870-f28161cba048",
        "name": "Webhook calendar response",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          700,
          280
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "72e7f085-d1e7-4967-aaa5-161ff0e83c06",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          140,
          480
        ],
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n\t\"type\": \"object\",\n\t\"properties\": {\n\t\t\"start\": {\n\t\t\t\"type\": \"string\"\n\t\t},\n\t\t\"end\": {\n\t\t\t\"type\": \"string\"\n\t\t}\n\t}\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "3822b875-73f0-4700-8fc4-e4d3285f593a",
        "name": "Webhook RAG response",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          700,
          860
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "0b43f63b-3c00-4db4-8b28-9938add9fdbe",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1100,
          -1320
        ],
        "parameters": {
          "width": 1140,
          "height": 2200,
          "content": "# STEP 6 - VOICEFLOW\n\n- Register on [Voiceflow](https://www.voiceflow.com/) \n- Create the workflow as shown in the following image\n![image](https://i.postimg.cc/3rSPwMn2/langflow.png)\n- There are 3 \"Captures\":\n-- n8n_order\n-- n8n_appointment\n-- n8n_rag\n- Add in the created functions the url of the corresponding n8n Webhook trigger node\n- Test your Agent\n- Get your projectID\n- In the Widget section choose Chat or Voice and copy the installation script\n![image](https://i.postimg.cc/855gyTZP/voiceflow-agent.png)\n![image](https://i.postimg.cc/5Nn4Sk43/voiceflow-agent2.png)\n\nPS. You can import a Twilio number to assign it to your agent for becoming a Phone Agent\n![image](https://i.postimg.cc/cLymTTFv/voiceflow-agent3.png)\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "589165c8-920d-40e3-8e28-50e94dd37555",
        "name": "When clicking ‚ÄòTest workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -380,
          -1120
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "74c314bb-c445-42f8-8f9d-2ab646486044",
        "name": "Qdrant Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
        "position": [
          600,
          -1000
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "qdrantCollection": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "qdrantApi": {
            "id": "iyQ6MQiVaF3VMBmt",
            "name": "QdrantApi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "01c05ac3-ac5c-4f1a-a756-db8de4a30e56",
        "name": "Create collection",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -80,
          -1260
        ],
        "parameters": {
          "url": "https://QDRANTURL/collections/COLLECTION",
          "method": "POST",
          "options": {},
          "jsonBody": "{\n  \"filter\": {}\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "qhny6r5ql9wwotpn",
            "name": "Qdrant API (Hetzner)"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "2d7adb45-aae7-4617-b1d1-5a23f3eb3b20",
        "name": "Refresh collection",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -80,
          -1000
        ],
        "parameters": {
          "url": "https://QDRANTURL/collections/COLLECTION/points/delete",
          "method": "POST",
          "options": {},
          "jsonBody": "{\n  \"filter\": {}\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "qhny6r5ql9wwotpn",
            "name": "Qdrant API (Hetzner)"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "5e406bd7-8a93-4db2-8d3d-e92e8c9f4f01",
        "name": "Get folder",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          140,
          -1000
        ],
        "parameters": {
          "filter": {
            "driveId": {
              "__rl": true,
              "mode": "list",
              "value": "My Drive",
              "cachedResultUrl": "https://drive.google.com/drive/my-drive",
              "cachedResultName": "My Drive"
            },
            "folderId": {
              "__rl": true,
              "mode": "id",
              "value": "=test-whatsapp"
            }
          },
          "options": {},
          "resource": "fileFolder"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "HEy5EuZkgPZVEa9w",
            "name": "Google Drive account (n3w.it)"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "f1f883fb-c9d1-42e6-98c2-791ed85e959f",
        "name": "Download Files",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          360,
          -1000
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {
            "googleFileConversion": {
              "conversion": {
                "docsToFormat": "text/plain"
              }
            }
          },
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "HEy5EuZkgPZVEa9w",
            "name": "Google Drive account (n3w.it)"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "5fd88e03-3638-4d38-8df4-246e4a5f2bda",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          580,
          -800
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "4zwP0MSr8zkNvvV9",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "3740a841-e272-44f9-b76d-51fb90137fd3",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          760,
          -800
        ],
        "parameters": {
          "options": {},
          "dataType": "binary"
        },
        "typeVersion": 1
      },
      {
        "id": "075d1038-d1fd-4527-8eda-961f20c7869a",
        "name": "Token Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterTokenSplitter",
        "position": [
          760,
          -600
        ],
        "parameters": {
          "chunkSize": 300,
          "chunkOverlap": 30
        },
        "typeVersion": 1
      },
      {
        "id": "57cc8eaf-26b3-480f-ab5d-c8646519cfa3",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          120,
          -1320
        ],
        "parameters": {
          "color": 6,
          "width": 880,
          "height": 220,
          "content": "# STEP 1\n\n## Create Qdrant Collection\nChange:\n- QDRANTURL\n- COLLECTION"
        },
        "typeVersion": 1
      },
      {
        "id": "70bc0676-c0ea-4de8-8659-bfb8b0ea653f",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -100,
          -1060
        ],
        "parameters": {
          "color": 4,
          "width": 620,
          "height": 400,
          "content": "# STEP 2\n\n\n\n\n\n\n\n\n\n\n\n\n## Documents vectorization with Qdrant and Google Drive\nChange:\n- QDRANTURL\n- COLLECTION"
        },
        "typeVersion": 1
      },
      {
        "id": "411c4f55-ae41-49b5-a821-df1a3d8fefec",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -380,
          660
        ],
        "parameters": {
          "color": 5,
          "width": 1220,
          "content": "# STEP 5\nIf required retrive the informations by RAG system"
        },
        "typeVersion": 1
      },
      {
        "id": "49d1fe78-4c38-4508-84c3-3a571ad9a2b0",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -360,
          -360
        ],
        "parameters": {
          "color": 5,
          "width": 1220,
          "content": "# STEP 3\nIf required retrive the informations by Order system\n- Set your API URL Tracking service"
        },
        "typeVersion": 1
      },
      {
        "id": "23d42754-0126-4b3a-91b0-b489ef83b36c",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -360,
          80
        ],
        "parameters": {
          "color": 5,
          "width": 1220,
          "content": "# STEP 4\nIf required retrive the informations by Appointment system"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "20a19983-4edb-4179-a2d2-e2f53d0daf85",
    "connections": {
      "RAG": {
        "ai_tool": [
          [
            {
              "node": "Retrive Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "n8n_rag": {
        "main": [
          [
            {
              "node": "Retrive Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "n8n_order": {
        "main": [
          [
            {
              "node": "API URL Tracking",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get folder": {
        "main": [
          [
            {
              "node": "Download Files",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Retrive Agent": {
        "main": [
          [
            {
              "node": "Webhook RAG response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Files": {
        "main": [
          [
            {
              "node": "Qdrant Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Token Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Google Calendar": {
        "main": [
          [
            {
              "node": "Calendar response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "n8n_appointment": {
        "main": [
          [
            {
              "node": "Concert start date",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "API URL Tracking": {
        "main": [
          [
            {
              "node": "Tracking response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Calendar response": {
        "main": [
          [
            {
              "node": "Webhook calendar response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Qdrant Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Tracking response": {
        "main": [
          [
            {
              "node": "Webhook tracking response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Concert start date": {
        "main": [
          [
            {
              "node": "Google Calendar",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI2": {
        "ai_embedding": [
          [
            {
              "node": "Retrive Qdrant Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "RAG",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Retrive Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "Concert start date",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Refresh collection": {
        "main": [
          [
            {
              "node": "Get folder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Qdrant Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Concert start date",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Retrive Qdrant Vector Store": {
        "ai_vectorStore": [
          [
            {
              "node": "RAG",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Create collection",
              "type": "main",
              "index": 0
            },
            {
              "node": "Refresh collection",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "e4680277d6b9c8b80748f71c2c1d0f9a640576175738ea2675967f762eeaf9df"
    },
    "nodes": [
      {
        "id": "4f90c351-3a27-4cef-8165-84b81f339462",
        "name": "Mistral Cloud Chat Model4",
        "type": "@n8n/n8n-nodes-langchain.lmChatMistralCloud",
        "position": [
          -416,
          544
        ],
        "parameters": {
          "model": "mistral-medium-latest",
          "options": {
            "temperature": 0.7
          }
        },
        "typeVersion": 1
      },
      {
        "id": "02d5fb5f-8410-4d2a-9dc6-9a4e3964fa84",
        "name": "Simple Memory1",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          -112,
          560
        ],
        "parameters": {
          "contextWindowLength": 15
        },
        "typeVersion": 1.3
      },
      {
        "id": "d09cc06a-b1a5-4d19-90c3-0c58add13b4f",
        "name": "Calculator1",
        "type": "@n8n/n8n-nodes-langchain.toolCalculator",
        "position": [
          160,
          560
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "ce7fb065-c77e-4b31-b98c-ac18abe4d983",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -1952,
          176
        ],
        "webhookId": "5112884c-f913-4d4d-8571-4605936a74ba",
        "parameters": {
          "public": true,
          "options": {},
          "initialMessages": "hi this is cost estimate agent"
        },
        "typeVersion": 1.3
      },
      {
        "id": "54e74d07-150d-440f-a53e-9995baa5cff1",
        "name": "Send a message in Gmail",
        "type": "n8n-nodes-base.gmailTool",
        "position": [
          352,
          544
        ],
        "webhookId": "4d1e82d4-fb8c-4e2a-bb99-a8650a13f4a5",
        "parameters": {
          "sendTo": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}",
          "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
          "options": {},
          "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "GjmgJcRU3g4v3mEv",
            "name": "Gmail account 5"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "eb045f4b-b2e3-477c-8559-8398a886ca16",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2064,
          -32
        ],
        "parameters": {
          "color": 7,
          "width": 256,
          "height": 464,
          "content": "## Input endpoints\nWebhook and chat trigger receive user queries from website or n8n chat UI.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "f868877e-a47e-4366-9800-424072efbdc9",
        "name": "ai agent cost estimate",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          96,
          176
        ],
        "parameters": {
          "text": "={{ $json.chatInput }}",
          "options": {
            "systemMessage": "=# Persona  \nYou are a helpful, intelligent **AI Cost Estimation & Catalog Assistant** for the **Fabrics & Surfaces** brand.  \nYou guide users ‚Äî whether they upload a document, reference an existing order, or start fresh ‚Äî through a smooth, conversational process to extract, confirm, and calculate costs.  \nYour role: stay proactive, transparent, and supportive from start to finish.\n\n---\n\n## Core Purpose\n- Help users estimate or verify costs for **fabrics** and **tiles**.  \n- Work seamlessly with both **OCR data (stored in Supabase)** and **manual user inputs**.  \n- Extract or retrieve structured data (vendor, line items, quantities, rates, totals).  \n- Perform **step-by-step cost calculations** using MATERIAL_COSTS and PROCESSING_COSTS.  \n- Confirm results conversationally and provide a clear cost summary.  \n- Escalate to human support through **Gmail** when required.\n\n---\n\n## Primary Duties\n1. **Detect Input Source**\n   - If OCR data exists in Supabase ‚Üí retrieve, summarize, and confirm with user before calculating.  \n   - If the user uploads a new document ‚Üí parse it via OCR, save to Supabase, then confirm details.  \n   - If no data exists ‚Üí guide the user step-by-step to collect inputs interactively.\n\n2. **Conversational Confirmation**\n   - Always confirm material, dimensions, and quantity before final computation.  \n   - Ask only for missing or unclear data.  \n   - Rephrase numeric or technical values clearly (‚ÄúYou entered 150 cm width and 10 m length ‚Äî correct?‚Äù).\n\n3. **Computation**\n   - Use Calculator for all cost logic.  \n   - Apply formulas transparently (MATERIAL_COSTS, PROCESSING_COSTS).  \n   - Show each stage: base cost ‚Üí add-ons ‚Üí taxes ‚Üí total.  \n   - Handle GSM ‚Üî sqm and mm ‚Üî sqm conversions automatically.\n\n4. **Output**\n   - Display itemized breakdown + total cost.  \n   - Include assumptions or substitutions if applied.  \n   - Offer next steps: **Save Quote**, **Email via Gmail**, or **Modify Inputs**.\n\n---\n\n## Conversation Flow\n1. **Greeting:**  \n   ‚ÄúHi! I can help you estimate fabric or tile costs, review invoices, or create a new quote.  \n   Would you like me to use stored data, upload a bill, or start a new estimate?‚Äù\n2. **Flow continues** depending on source:  \n   - *Stored Data*: Retrieve ‚Üí summarize ‚Üí confirm ‚Üí calculate ‚Üí show results.  \n   - *New Upload*: OCR extract ‚Üí confirm ‚Üí calculate ‚Üí show results.  \n   - *Manual Entry*: Ask specs step-by-step ‚Üí confirm ‚Üí calculate ‚Üí show results.\n3. **Always guide and explain:** never skip user interaction, even if data is complete.  \n\n---\n\n## Cost Rules\n\n### Fabric (per m or sqm)\n| Material | Base ‚Ç¨/m | Add-ons ‚Ç¨/m |\n|-----------|-----------|-------------|\n| Cotton | 2.5 | Printing 1.2 ¬∑ Hemming 0.5 |\n| Polyester | 2.0 | Coating 1.8 |\n| Linen | 6.0 | ‚Äì |\n| Silk | 20.0 | ‚Äì |\n| Wool | 10.0 | ‚Äì |\n\nFormula:  \n`sqm = (width_cm / 100) √ó length_m`  \n`total = sqm √ó (base_rate + add_ons) + misc_costs`\n\n---\n\n### Tile (per sqm)\n| Type | ‚Ç¨/sqm | Add-ons ‚Ç¨/sqm |\n|-------|-------|---------------|\n| Ceramic | 8 | Glaze 2.5 |\n| Porcelain | 15 | Rectify 1.0 |\n| Stone | 30 | Seal 2.0 |\n\nFormula:  \n`area = pieces √ó (L_mm √ó W_mm / 1e6)`  \n`total = area √ó (base + add_ons) + 10 (packaging)`\n\n---\n\n## Behavior\n- Always behave as a conversational guide, not just a calculator.  \n- Confirm, clarify, and educate users while computing results.  \n- If OCR data is present: use it, but still engage in dialogue.  \n- If OCR data is missing: guide user through completion.  \n- Automatically handle GSM, sqm, and area conversions.  \n- Clearly state any assumptions or corrections made.  \n- If the user asks for help or escalation ‚Üí send a Gmail message summarizing context and results.  \n- Maintain a calm, precise, and professional tone throughout.\n\n---\n\n**End of prompt**\n",
            "returnIntermediateSteps": false
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "85b0230d-f7ce-43d1-b482-6468a25f1cc4",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          64
        ],
        "parameters": {
          "color": 7,
          "width": 544,
          "height": 288,
          "content": "## AI Agent\nGuides users through the cost estimation form for fabrics and tiles and runs calculations.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "dcc5f3ad-3a88-4fed-9d15-3d798d8eb46a",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          64,
          432
        ],
        "parameters": {
          "color": 7,
          "width": 448,
          "height": 256,
          "content": "## Tools: Calculator & Gmail\nCalculator: performs numeric calculations. Gmail: sends quotes or escalations to support.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "660ec177-6b8f-4591-a9e2-8be6edc8eedd",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2624,
          16
        ],
        "parameters": {
          "width": 416,
          "height": 624,
          "content": "## Cost Estimate Agent ‚Äî Overview\n\n## How it works\n- Scans uploaded bills or receipts using OCR.  \n- Extracts key details like items, quantities, and prices.  \n- Calculates total cost and tax automatically.  \n- Estimates prices for fabrics and tiles based on size, finish, and material.  \n- Saves all parsed and computed data in Supabase.  \n- even  if no ocr data is present this  chat agent guide users through forms, show product info, and suggest alternatives.  \n- Core flow: **OCR ‚Üí Parse / user query ‚Üí Calculate ‚Üí Store ‚Üí Chat.**\n\n## Setup steps\n1. Add Google Drive (or other storage) and Supabase credentials.  \n2. Connect OCR and parsing nodes to handle PDF / image uploads.  \n3. Review material and processing cost tables in the calculator node; adjust values for your currency.  \n4. Test by uploading a sample invoice or selecting a fabric / tile in chat mode.  \n5. Verify results are written to the Supabase table, then enable the webhook or chat trigger for live use.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "d41425c9-72a5-47e6-b1d4-00ee48725736",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -224,
          464
        ],
        "parameters": {
          "color": 7,
          "height": 192,
          "content": "### Memory \nStores short-term session context so the agent can recall prior user inputs "
        },
        "typeVersion": 1
      },
      {
        "id": "caa00085-20b6-46f4-84b5-61e9da0e0423",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -544,
          464
        ],
        "parameters": {
          "color": 7,
          "width": 272,
          "height": 192,
          "content": "## Mistral Model\nHandles conversation logic for the cost estimation agent. "
        },
        "typeVersion": 1
      },
      {
        "id": "897a43ec-b434-41cd-aa4b-713bf05fa406",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -1440,
          96
        ],
        "parameters": {
          "options": {
            "includeBinary": true,
            "destinationFieldName": "data"
          },
          "fieldToSplitOut": "$binary"
        },
        "typeVersion": 1
      },
      {
        "id": "0c8127b4-405d-452f-9874-e05e684d764d",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          -176,
          144
        ],
        "parameters": {},
        "typeVersion": 3.1
      },
      {
        "id": "d6099fc1-790e-4bc1-8cb3-ebdc2ab488eb",
        "name": "CHECK IF BINARY FILE IS PRESENT OR NOT",
        "type": "n8n-nodes-base.if",
        "position": [
          -1664,
          160
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "463448a5-b323-4682-8674-24bee0df163b",
                "operator": {
                  "type": "array",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.files }}",
                "rightValue": ""
              }
            ]
          },
          "looseTypeValidation": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "fde26d6a-7a41-443e-9973-f0d2c68ffde3",
        "name": "NORMALIZE binary file",
        "type": "n8n-nodes-base.code",
        "position": [
          -1216,
          96
        ],
        "parameters": {
          "jsCode": "return items.map(item => {\n  const binaryKeys = Object.keys(item.binary || {});\n  const firstKey = binaryKeys[0];\n\n  if (!firstKey) {\n    return item;\n  }\n\n  return {\n    json: item.json,\n    binary: {\n      data: item.binary[firstKey]\n    }\n  };\n});\n"
        },
        "typeVersion": 2
      },
      {
        "id": "bae39571-4a46-40a3-8a5e-f8fd977cf72d",
        "name": "OCR (ANY OCR API )",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -736,
          -256
        ],
        "parameters": {
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "bodyParameters": {
            "parameters": [
              {
                "name": "mode",
                "value": "single"
              },
              {
                "name": "output_type",
                "value": "jsonl"
              },
              {
                "name": "include_images",
                "value": "false"
              },
              {
                "name": "files",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "5296f45c-fe21-4b06-adea-63bb93ece610",
        "name": "STORE OCR OUTPUT",
        "type": "n8n-nodes-base.supabase",
        "position": [
          -320,
          80
        ],
        "parameters": {
          "tableId": "temp_table",
          "fieldsUi": {
            "fieldValues": [
              {
                "fieldId": "session_id",
                "fieldValue": "={{ $('When chat message received').item.json.sessionId }}"
              },
              {
                "fieldId": "file",
                "fieldValue": "={{ $json.data[0].parseJson().blocks }}"
              },
              {
                "fieldId": "file_name",
                "fieldValue": "={{ $json.data[0].parseJson().source }}"
              }
            ]
          }
        },
        "credentials": {
          "supabaseApi": {
            "id": "9dYMIwoCFFwT3ZmR",
            "name": "Supabase account 6 ayan"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d580dab1-84ca-4e21-8d51-d451cd6851f8",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -784,
          -352
        ],
        "parameters": {
          "color": 7,
          "width": 192,
          "height": 272,
          "content": "### use any ocr(mistral or own hosted ocr)"
        },
        "typeVersion": 1
      },
      {
        "id": "a1e5e3cc-e235-48c8-be61-babcd43dadc9",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1280,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 224,
          "height": 272,
          "content": "## normalize binary file name "
        },
        "typeVersion": 1
      },
      {
        "id": "c6fac97d-7110-4cf7-911d-10a03fe4a2b4",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -352,
          -16
        ],
        "parameters": {
          "color": 7,
          "width": 160,
          "height": 288,
          "content": "### store ocr output in supbase"
        },
        "typeVersion": 1
      },
      {
        "id": "822d5178-03f4-4553-bf53-83eb05f26cd8",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1728,
          48
        ],
        "parameters": {
          "color": 7,
          "height": 256,
          "content": "## check if user query have binary file or not ?"
        },
        "typeVersion": 1
      },
      {
        "id": "a577dfab-3f20-47bd-be7b-64c1cf0f85ec",
        "name": "Supabase Get",
        "type": "n8n-nodes-base.supabaseTool",
        "position": [
          720,
          528
        ],
        "parameters": {
          "filters": {
            "conditions": [
              {
                "keyName": "session_id",
                "keyValue": "={{ $('When chat message received').item.json.sessionId }}",
                "condition": "eq"
              }
            ]
          },
          "tableId": "temp_table",
          "operation": "getAll"
        },
        "credentials": {
          "supabaseApi": {
            "id": "9dYMIwoCFFwT3ZmR",
            "name": "Supabase account 6 ayan"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "50fe88db-002a-49b6-a124-270a5e7d43ec",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          592,
          432
        ],
        "parameters": {
          "color": 7,
          "width": 272,
          "height": 240,
          "content": "## get ocr output from supbase"
        },
        "typeVersion": 1
      },
      {
        "id": "15d4bfb8-d049-422c-8541-3bf7aaacedf7",
        "name": "Mistral Upload",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -1008,
          96
        ],
        "parameters": {
          "url": "https://api.mistral.ai/v1/files",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "predefinedCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "purpose",
                "value": "ocr"
              },
              {
                "name": "file",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          },
          "nodeCredentialType": "mistralCloudApi"
        },
        "credentials": {
          "mistralCloudApi": {
            "id": "k9FknrnRcIKYNX7T",
            "name": "Mistral Cloud account 2 dbt rn"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "9de46179-9b2d-4aca-8b4c-c3b8938e7646",
        "name": "Mistral Signed URL",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -768,
          96
        ],
        "parameters": {
          "url": "=https://api.mistral.ai/v1/files/{{ $json.id }}/url",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "expiry",
                "value": "24"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Accept",
                "value": "application/json"
              }
            ]
          },
          "nodeCredentialType": "mistralCloudApi"
        },
        "credentials": {
          "mistralCloudApi": {
            "id": "k9FknrnRcIKYNX7T",
            "name": "Mistral Cloud account 2 dbt rn"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "49df803d-8805-483b-8598-a616c589edb2",
        "name": "Mistral DOC OCR",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -560,
          96
        ],
        "parameters": {
          "url": "https://api.mistral.ai/v1/ocr",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"document_url\",\n    \"document_url\": \"{{ $json.url }}\"\n  },\n  \"include_image_base64\": true\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "mistralCloudApi"
        },
        "credentials": {
          "mistralCloudApi": {
            "id": "k9FknrnRcIKYNX7T",
            "name": "Mistral Cloud account 2 dbt rn"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "db0b917c-8843-4061-a88f-d3263ec1d4b0",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1040,
          -64
        ],
        "parameters": {
          "color": 7,
          "width": 608,
          "height": 320,
          "content": "## MISTRAL OCR\n [OCR Guide](https://mistral.ai/news/mistral-ocr)\n1. UPLOAD FILE\n2. GET SIGNED URL\n3. GET EXTRACT DATA AFTER USING MISTRAL OCR"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "ai agent cost estimate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "NORMALIZE binary file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Calculator1": {
        "ai_tool": [
          [
            {
              "node": "ai agent cost estimate",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Supabase Get": {
        "ai_tool": [
          [
            {
              "node": "ai agent cost estimate",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Mistral Upload": {
        "main": [
          [
            {
              "node": "Mistral Signed URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "ai agent cost estimate",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Mistral DOC OCR": {
        "main": [
          [
            {
              "node": "STORE OCR OUTPUT",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "STORE OCR OUTPUT": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Mistral Signed URL": {
        "main": [
          [
            {
              "node": "Mistral DOC OCR",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OCR (ANY OCR API )": {
        "main": [
          []
        ]
      },
      "NORMALIZE binary file": {
        "main": [
          [
            {
              "node": "Mistral Upload",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send a message in Gmail": {
        "ai_tool": [
          [
            {
              "node": "ai agent cost estimate",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Mistral Cloud Chat Model4": {
        "ai_languageModel": [
          [
            {
              "node": "ai agent cost estimate",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "CHECK IF BINARY FILE IS PRESENT OR NOT",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "CHECK IF BINARY FILE IS PRESENT OR NOT": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "e409ea34548a2afe2dffba31130cd1cf2e98ebe2afaeed2a63caf2a0582d1da0",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "26bd501a-d449-4bbf-aa25-a02e5cca7964",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -768,
          320
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "2916c373-0c6b-4315-a14d-481d674a324f",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          944,
          -1200
        ],
        "parameters": {
          "options": {},
          "jsonData": "={{ $json.documentation }}",
          "jsonMode": "expressionData",
          "textSplittingMode": "custom"
        },
        "typeVersion": 1.1
      },
      {
        "id": "8b411025-ad1f-4656-84d7-902ced049923",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          1040,
          -992
        ],
        "parameters": {
          "options": {
            "splitCode": "markdown"
          },
          "chunkSize": 1500,
          "chunkOverlap": 200
        },
        "typeVersion": 1
      },
      {
        "id": "4855516e-4a0d-4881-8dc4-592cf8b133a9",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Remove Duplicate Documentation Content",
        "type": "n8n-nodes-base.removeDuplicates",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          320,
          -1424
        ],
        "parameters": {
          "options": {
            "scope": "node",
            "historySize": 10000
          },
          "operation": "removeItemsSeenInPreviousExecutions",
          "dedupeValue": "={{ $json.documentation }}"
        },
        "typeVersion": 2
      },
      {
        "id": "a33a791a-e328-46fc-890e-e18649ab2231",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Only Keep Doc Paths",
        "type": "n8n-nodes-base.filter",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          448,
          -2192
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "52b8b89a-30cd-4a0d-a428-e5d341bcebbf",
                "operator": {
                  "type": "string",
                  "operation": "endsWith"
                },
                "leftValue": "={{ $json.link }}",
                "rightValue": "/"
              },
              {
                "id": "d8019c4e-e1a1-43ec-93a8-dac3d8c083b6",
                "operator": {
                  "type": "string",
                  "operation": "notStartsWith"
                },
                "leftValue": "={{ $json.link }}",
                "rightValue": "https://"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "b07b416b-f5cd-439a-b935-ce58c2a2f180",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Clean Documentation",
        "type": "n8n-nodes-base.set",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -112,
          -1424
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "5ed964a6-5200-454c-b983-f3dc7c8c7a48",
                "name": "documentation",
                "type": "string",
                "value": "={{ $json.data.replace(/([^#\\n]+)\\s*#/g, '# $1').trim().replace(/^\\s*https?:\\/\\/\\S+\\s*/, '') }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "4198449e-feb7-43f2-be23-e8581ff9fd98",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Gemini 2.5 Flash",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1120,
          320
        ],
        "parameters": {
          "options": {
            "temperature": 0
          }
        },
        "credentials": {
          "googlePalmApi": {
            "id": "AXawYbABK5aZbGBE",
            "name": "IA2S"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e1bad122-5df4-4018-8b50-fc67f70b55b7",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Get All n8n Documentation Links",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -704,
          -2192
        ],
        "parameters": {
          "url": "https://docs.n8n.io/",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "626cf083-8ae3-4e28-96d2-92b01f6d36cd",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Extract Links from HTML",
        "type": "n8n-nodes-base.html",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -416,
          -2192
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {
                "key": "links",
                "attribute": "href",
                "cssSelector": "a",
                "returnArray": true,
                "returnValue": "attribute"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e980ad18-7857-4603-8e01-9a98520dd874",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Split Out Links",
        "type": "n8n-nodes-base.splitOut",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -80,
          -2192
        ],
        "parameters": {
          "options": {
            "destinationFieldName": "link"
          },
          "fieldToSplitOut": "links"
        },
        "typeVersion": 1
      },
      {
        "id": "2b441068-ead3-4114-baca-f26f95c2c2eb",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Remove Duplicate Links",
        "type": "n8n-nodes-base.removeDuplicates",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          224,
          -2192
        ],
        "parameters": {
          "compare": "selectedFields",
          "options": {},
          "fieldsToCompare": "link"
        },
        "typeVersion": 2
      },
      {
        "id": "a9196d50-2a7a-4733-b6e4-2cb03a5cda46",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Add Documentation Page to Vector Store",
        "type": "n8n-nodes-base.executeWorkflow",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          960,
          -2160
        ],
        "parameters": {
          "options": {
            "waitForSubWorkflow": true
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "workflowInputs": {
            "value": {},
            "schema": [
              {
                "id": "path",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "path",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "data"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          }
        },
        "typeVersion": 1.2,
        "alwaysOutputData": true
      },
      {
        "id": "1c772047-a2f9-427a-b090-dbf00a257c9c",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Get Documentation Page",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "onError": "continueErrorOutput",
        "position": [
          -640,
          -1424
        ],
        "parameters": {
          "url": "=https://docs.n8n.io/{{ $json.link }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "d7cd75ad-e76d-45c7-8791-e6b9cf0e2106",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Extract Documentation Content",
        "type": "n8n-nodes-base.html",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -336,
          -1424
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {
                "key": "data",
                "cssSelector": "article",
                "skipSelectors": "img, footer, form"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "5ac3f64f-0340-4a98-bace-1c156021a919",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Gemini Query Embedding",
        "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -400,
          512
        ],
        "parameters": {},
        "credentials": {
          "googlePalmApi": {
            "id": "AXawYbABK5aZbGBE",
            "name": "IA2S"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "cbcc6097-c4a7-45d4-a852-5ab69d8f1e14",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Gemini Chunk Embedding",
        "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          816,
          -1200
        ],
        "parameters": {},
        "credentials": {
          "googlePalmApi": {
            "id": "AXawYbABK5aZbGBE",
            "name": "IA2S"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ba1f2848-bd94-4180-8edd-38150cda7f0b",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1296,
          -2544
        ],
        "parameters": {
          "color": 7,
          "width": 2640,
          "height": 1760,
          "content": "## Part 1: Building the Knowledge Base (The Library)\n\n**Goal:** To read all n8n documentation, break it into small pieces, and store it in n8n's **in-memory vector store**.\n**Action:** You only need to run this part **ONCE** per n8n session by clicking the \"Execute workflow\" button on the `Start Indexing` trigger.\n**Time:** This will take several minutes to complete (~15 to 20).\n\n**Important:** The in-memory store is not permanent. If you restart n8n, you must run this indexing flow again to rebuild the knowledge base."
        },
        "typeVersion": 1
      },
      {
        "id": "3cda1636-2dfd-46c0-8d82-d072e7be673e",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Loop Over Documentation Pages",
        "type": "n8n-nodes-base.splitInBatches",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          736,
          -2192
        ],
        "parameters": {
          "options": {},
          "batchSize": 10
        },
        "typeVersion": 3
      },
      {
        "id": "ffa9c491-00d0-4c70-8a59-64f627b6468f",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2256,
          -2864
        ],
        "parameters": {
          "color": 6,
          "width": 1064,
          "height": 296,
          "content": "# Tutorial: Build an AI Expert with RAG\n\nWelcome! This workflow teaches you **RAG (Retrieval-Augmented Generation)** using n8n's built-in tools.\n\n**The Goal:** To create an AI chatbot that is an expert on a specific topic (the n8n docs) and *never* makes up answers.\n\n**It has two parts:**\n1.  **TOP FLOW (Indexing):** You run this once manually to build the AI's knowledge base. It reads the n8n docs and stores them in n8n's **in-memory vector store**.\n2.  **BOTTOM FLOW (Chat):** This is the live chatbot. It retrieves relevant info from the knowledge base to answer your questions accurately."
        },
        "typeVersion": 1
      },
      {
        "id": "6f33666c-868b-4032-99c6-9844a809a587",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2256,
          -2544
        ],
        "parameters": {
          "color": 7,
          "width": 924,
          "height": 1392,
          "content": "# Workflow Setup"
        },
        "typeVersion": 1
      },
      {
        "id": "6b8d3bba-6a47-4dc6-b970-219a35863782",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "n8n Docs AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -752,
          -288
        ],
        "parameters": {
          "options": {
            "systemMessage": "=<role>\nYou are a specialized AI assistant, an expert in n8n's official documentation. Your sole mission is to help users by providing accurate and factual information extracted exclusively from this documentation. You are meticulous, factual, and never deviate from your knowledge scope.\n</role>\n\n<instructions>\n<goal>\nYour primary goal is to provide precise and factual answers to user questions about the n8n automation platform, based **exclusively** on the excerpts from the official documentation provided in the context.\n</goal>\n\n<context>\nYou operate according to a RAG (Retrieval-Augmented Generation) model. For each user question, use the appropriate tool to retrieve the necessary information from the n8n documentation's vector database.\n\n**Mandatory rules:**\n\n1.  **Single source of truth:** Your answer MUST be entirely and solely derived from the information present in the provided documentation.\n2.  **Accuracy and implicit citation:** Base your answer as literally as possible on the documentation text. Rephrase for clarity and conciseness, but do not add any information not found there. Act as if the documentation is your only knowledge in the world.\n3.  **Do not mention the process:** Never mention your tool or the fact that you are a RAG system in your answer to the user. Respond as an expert who directly consults their documentation.\n</context>\n\n<output_format>\n*   **Clarity:** Provide a clear, concise, and direct answer.\n*   **Structuring:** If the context contains steps, lists, or code examples, use Markdown syntax to format them legibly (bullet points, numbered lists, code blocks for code snippets, JSON, etc.).\n*   **Tone:** Adopt a professional, helpful, and confident tone, that of a technical n8n expert.\n</output_format>\n</instructions>"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "6a7912bb-20a6-44bc-ab08-7a1e227797ab",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -800,
          -2400
        ],
        "parameters": {
          "color": 7,
          "width": 288,
          "height": 400,
          "content": "### Step 1.1: Find All the 'Books'\n\n**What it does:** This node visits the main n8n documentation page.\n**Analogy:** We're asking the library's front desk for a complete list of every single book they have."
        },
        "typeVersion": 1
      },
      {
        "id": "a094ca81-3cb1-42b3-bcce-202da80ac5ea",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -496,
          -2400
        ],
        "parameters": {
          "color": 7,
          "width": 272,
          "height": 400,
          "content": "### Step 1.2: Read the List of Books\n\n**What it does:** It takes the HTML from the previous step and extracts every single link (`<a>` tag).\n**Analogy:** We're reading the list from the front desk and pulling out just the titles of the books (the links)."
        },
        "typeVersion": 1
      },
      {
        "id": "d3c9c411-34fb-4f5e-a46e-a1cfb5130f53",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -208,
          -2400
        ],
        "parameters": {
          "color": 7,
          "width": 336,
          "height": 400,
          "content": "### Step 1.3: Process One Book at a Time\n\n**What it does:** It takes the big list of links and turns each link into a separate item for n8n to process.\n**Analogy:** Instead of trying to read all the books at once, we're creating a separate to-do item for each book."
        },
        "typeVersion": 1
      },
      {
        "id": "0cec3147-5420-4f89-8dd9-b49462e6a631",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          144,
          -2400
        ],
        "parameters": {
          "color": 7,
          "width": 480,
          "height": 400,
          "content": "### Step 1.4: Tidy Up the To-Do List\n\n**What it does:** First, it removes any duplicate links. Then, it filters out any links that don't point to an actual documentation page (e.g., links to the homepage or external sites).\n**Analogy:** We're throwing away duplicate to-do items and any notes that aren't actually books."
        },
        "typeVersion": 1
      },
      {
        "id": "abf15718-553e-4226-8e85-28a7e2864c34",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          640,
          -2400
        ],
        "parameters": {
          "color": 4,
          "width": 512,
          "height": 464,
          "content": "### Step 1.5: The Librarian's Reading Loop\n\n**What it does:** This is the engine of the indexing process. It takes our clean list of pages and processes them one by one. The `Execute Workflow` node calls the \"sub-workflow\" below for each and every page.\n**Analogy:** This loop tells our librarian to pick up one book (link) at a time and go through the full process of reading and indexing it."
        },
        "typeVersion": 1
      },
      {
        "id": "162390aa-5dfa-4e2d-ad27-59bd00eea840",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -736,
          -1632
        ],
        "parameters": {
          "color": 7,
          "width": 288,
          "height": 384,
          "content": "### Step 1.5.1: Read a Single Page\n\n**What it does:** This node takes a single URL from the loop and fetches the HTML content of that page.\n**Analogy:** The librarian opens one book to the first page."
        },
        "typeVersion": 1
      },
      {
        "id": "c516a2da-d6c1-4da7-8a30-4540af69c2f0",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1264,
          -1776
        ],
        "parameters": {
          "color": 5,
          "width": 512,
          "height": 528,
          "content": "### Why Use a Sub-Workflow?\n\nThe main reason is **memory management**.\n\nProcessing a single web page, especially creating vector embeddings for all its chunks, uses a lot of memory (RAM). The n8n documentation has over 1,000 pages. If we tried to process all of them in a single, linear run, the memory usage would build up with each page and would likely crash your n8n instance.\n\nWhen a sub-workflow finishes its run for one item (one page), n8n **clears out the memory** (RAM) it used before starting the next one.\n\nBy using a sub-workflow, we process pages one-by-one in a memory-efficient loop, making the entire indexing process stable and reliable, even on a massive scale."
        },
        "typeVersion": 1
      },
      {
        "id": "c2474781-cffe-48e5-a8c3-c19b30821ab6",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -432,
          -1632
        ],
        "parameters": {
          "color": 7,
          "width": 512,
          "height": 384,
          "content": "### Step 1.5.2: Get the Good Stuff\n\n**What it does:** It extracts only the main text from the article on the page, ignoring menus, footers, and images. Then, it cleans up the formatting.\n**Analogy:** The librarian tears out only the useful pages from the book and cleans up any smudges or messy handwriting."
        },
        "typeVersion": 1
      },
      {
        "id": "70fbb1bd-1cfd-47ed-ad46-48f1d7ee9194",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          96,
          -1856
        ],
        "parameters": {
          "color": 5,
          "width": 544,
          "height": 608,
          "content": "### Step 1.5.3: Avoid Re-reading\n\n**What it does:** It checks if we have already processed this exact page content in a previous run. If so, it stops here to save time and resources.\n**Analogy:** The librarian checks their \"already read\" pile to avoid reading the same book twice.\n\n**A Powerful Feature Explained:**\n\nUsually, the \"Remove Duplicates\" node only looks at the items in the *current* execution. But here, it's set to **\"Remove items seen in previous executions.\"**\n\nThis is incredibly powerful in a sub-workflow. Even though our sub-workflow only sees one page at a time, this node has a long-term memory. It remembers every single page it has *ever* processed across all previous runs.\n\nThis makes the workflow robust. You can run the indexing process again and again to update the knowledge base with new documentation, and it will never waste resources re-processing old pages or creating duplicate chunks in the in-memory store."
        },
        "typeVersion": 1
      },
      {
        "id": "88930b6a-5ffb-428b-bdb3-689cda2f78d8",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          656,
          -1856
        ],
        "parameters": {
          "color": 6,
          "width": 656,
          "height": 1040,
          "content": "### Step 1.5.4: Create & Store the 'Magic Index Cards'\n\nThis is the most important step of indexing!\n\n1.  **`Recursive Character Text Splitter`:** The text is broken down into small, overlapping paragraphs (\"chunks\").\n    *   **Analogy:** The librarian breaks the book down into small, meaningful paragraphs. This is vital for finding very specific answers later.\n\n2.  **`Gemini Chunk Embedding`:** An AI model converts each chunk of text into a list of numbers (a \"vector\" or \"embedding\").\n    *   **Analogy:** The librarian uses a 'magic pen' to turn each paragraph into a unique set of numbers. Paragraphs with similar meanings get similar numbers.\n\n3.  **`Simple Vector Store (Insert)`:** The original text chunk and its new vector are saved together in n8n's in-memory vector store.\n    *   **Analogy:** The librarian files the original paragraph along with its magic number on an index card and puts it in a special filing cabinet (the in-memory vector store).\n    *   **The `Memory Key`** in this node acts as a label for the filing cabinet, ensuring the chat flow can find it later."
        },
        "typeVersion": 1
      },
      {
        "id": "cb9f3d2c-6eaf-4b6e-aa7f-d0662bc35740",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1296,
          -752
        ],
        "parameters": {
          "color": 7,
          "width": 1200,
          "height": 1456,
          "content": "## Part 2: The Chatbot (Talking to the Expert Librarian)\n\n**Goal:** To provide an interface where a user can ask a question, have the system find relevant information from the knowledge base, and get an accurate, AI-generated answer.\n**Action:** After running the Indexing flow, **Activate** this workflow. Then, open the `When chat message received` node and use its Public URL to chat."
        },
        "typeVersion": 1
      },
      {
        "id": "ae93c028-a7d2-4d05-b3a7-9789dd4211f9",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note17",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1264,
          -592
        ],
        "parameters": {
          "color": 4,
          "width": 368,
          "height": 448,
          "content": "### The Front Desk: Ask Your Question Here\n\n**What it does:** This is the public-facing chat interface. When you send a message here, the entire RAG process begins.\n\n**Action:**\n1.  **Activate** the entire workflow.\n2.  To test directly inside n8n, click the **\"Open Chat\"** button in this node's parameter panel.\n3.  To chat publicly, copy the **Public URL** from this node and open it in a new browser tab."
        },
        "typeVersion": 1
      },
      {
        "id": "d180b0ca-dd3b-40bb-8595-c178f74011e6",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note18",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -880,
          -480
        ],
        "parameters": {
          "color": 5,
          "width": 560,
          "height": 400,
          "content": "### The Brains: The Expert Librarian\n\n**What it does:** This is the AI agent that orchestrates the entire response. It understands your question, decides which tools to use, and formulates the final answer.\n**System Prompt:** Its instructions (in the System Message) are very strict: **\"Only use the provided documents to answer. Do not make things up.\"**"
        },
        "typeVersion": 1
      },
      {
        "id": "42d81e12-bfc9-4b9b-bb8a-40249e163bbb",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note19",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1264,
          -128
        ],
        "parameters": {
          "color": 7,
          "width": 368,
          "height": 592,
          "content": "### The 'Synthesizer' & 'Strategist'\n\n**What it does:** This is the Large Language Model (LLM). It has two critical jobs:\n\n1.  **The Strategist:** Based on your question and the conversation history, it decides *what information to look for* in the knowledge base (the library).\n2.  **The Synthesizer:** After getting the relevant documents, it generates the final, human-readable answer based *only* on that context.\n\n\n**Analogy:** This is the part of the librarian's brain that first decides which section of the library to search, and then reads the specific index cards to write a clear, helpful response.\n\nThe model used here is **Gemini 2.5 Flash**."
        },
        "typeVersion": 1
      },
      {
        "id": "567ecaf4-e42a-4275-bc39-ad7217b4a173",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note20",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -880,
          -64
        ],
        "parameters": {
          "color": 7,
          "width": 288,
          "height": 528,
          "content": "### Short-Term Memory\n\n**What it does:** This node stores the last few messages of your conversation.\n**Analogy:** This helps the librarian remember what you just talked about, so you can ask follow-up questions without having to repeat yourself."
        },
        "typeVersion": 1
      },
      {
        "id": "120f0062-4e6c-4cac-92ab-51cd7b55e892",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note21",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -576,
          -64
        ],
        "parameters": {
          "color": 6,
          "width": 448,
          "height": 736,
          "content": "### The Tool: The 'Magic Filing Cabinet' Retriever\n\nThis is the \"Retrieval\" part of RAG. When the agent gets your question, it uses this tool to find the most relevant information.\n\n1.  **`Gemini Query Embedding`:** Your question is converted into its own 'magic number' (vector).\n\n2.  **`Official n8n Documentation (Vector Store Retrieve)`:** It searches the in-memory vector store for the document chunks with the most similar 'magic numbers' to your question's number.\n\n\n**Analogy:** The librarian takes your question, finds the most relevant index cards from the filing cabinet, and hands them over to the 'Synthesizer' to formulate the answer."
        },
        "typeVersion": 1
      },
      {
        "id": "b83a63ac-403f-4717-ae8a-6756e42f4b3e",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Start Indexing",
        "type": "n8n-nodes-base.manualTrigger",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -944,
          -2192
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "1271281d-ab81-4039-96a3-0bc42024d6f8",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "RAG Chatbot",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1104,
          -288
        ],
        "webhookId": "285e5d0b-ffcf-44e8-a80c-0683966b78a4",
        "parameters": {
          "public": true,
          "options": {
            "title": "",
            "subtitle": "",
            "customCss": "/* === THEME OVERRIDE: n8n Glass & Glow (Revised) === */\n\n/*\n  This theme is built upon the default n8n chat CSS variables.\n  We'll use your desired branding and layout, and then add\n  the \"glass\" effect using a semi-transparent background\n  and a backdrop-filter on the main window class.\n*/\n\n:root {\n  /* --- 1. CORE BRANDING & FONTS --- */\n  /* Your choices for font and primary color are applied here. */\n  --chat--font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  --chat--color-primary: #EA4B71; /* n8n Red */\n  --chat--color-primary-shade-50: #D93A60;\n  --chat--color-primary-shade-100: #C82A50;\n  --chat--color-secondary: #20b69e; /* Kept default secondary for things like file uploads */\n  --chat--color-secondary-shade-50: #1ca08a;\n  --chat--color-white: #ffffff;\n  --chat--color-light: #f2f4f8;\n  --chat--color-dark: #1F2937; /* Darker, more modern text color */\n  --chat--color-disabled: #9CA3AF;\n  --chat--color-typing: #404040;\n\n  /* --- 2. WINDOW & LAYOUT --- */\n  /* Your dimensions and rounded corners. The actual glass effect is handled in the class override below. */\n  --chat--window--width: 430px;\n  --chat--window--height: 80vh;\n  --chat--window--border-radius: 16px;\n  --chat--window--border: 1px solid rgba(255, 255, 255, 0.3);\n  --chat--spacing: 1rem; /* 16px base spacing */\n  --chat--window--z-index: 9999;\n  --chat--window--bottom: var(--chat--spacing);\n  --chat--window--right: var(--chat--spacing);\n  --chat--window--margin-bottom: var(--chat--spacing);\n\n  /* --- 3. GLASSMORPHISM BACKGROUNDS --- */\n  /* We make the main sections transparent to let the glass window show through. */\n  --chat--header--background: transparent;\n  --chat--body--background: transparent;\n  --chat--footer--background: transparent;\n\n  /* --- 4. HEADER STYLING (REMOVED) --- */\n  /* The header is removed by setting its height, padding, and border to 0/none. */\n  --chat--header-height: 0;\n  --chat--header--padding: 0;\n  --chat--header--border-bottom: none;\n  /* The rest of the header variables are now irrelevant. */\n  --chat--header--color: var(--chat--color-dark);\n  --chat--heading--font-size: 1.5rem;\n  --chat--subtitle--font-size: 0.875rem;\n  --chat--subtitle--line-height: 1.4;\n  --chat--close--button--color-hover: var(--chat--color-primary);\n\n  /* --- 5. MESSAGE BUBBLES --- */\n  --chat--message--font-size: 0.875rem;\n  --chat--message--padding: 12px 16px;\n  --chat--message--border-radius: 12px;\n  --chat--message-line-height: 1.6;\n  --chat--message--margin-bottom: calc(var(--chat--spacing) * 0.75);\n  /* Adjusted padding: Top is 0, sides and bottom use the base spacing. */\n  --chat--messages-list--padding: 0 var(--chat--spacing) var(--chat--spacing);\n  --chat--message--bot--background: var(--chat--color-white);\n  --chat--message--bot--color: #111827;\n  --chat--message--bot--border: none;\n  --chat--message--user--background: var(--chat--color-primary);\n  --chat--message--user--color: var(--chat--color-white);\n  --chat--message--user--border: none;\n\n  /* --- 6. INPUT AREA --- */\n  --chat--textarea--height: 50px;\n  --chat--textarea--max-height: 10rem;\n  --chat--input--font-size: 0.9rem;\n  --chat--input--border: 0;\n  --chat--input--border-radius: 12px; /* Rounded input field */\n  --chat--input--padding: 12px 16px;\n  --chat--input--background: rgba(255, 255, 255, 0.5); /* Semi-transparent input */\n  --chat--input--text-color: #111827;\n  --chat--input--line-height: 1.5;\n  --chat--input--border-active: 0;\n\n  /* --- 7. SEND & FILE BUTTONS --- */\n  --chat--input--send--button--background: transparent;\n  --chat--input--send--button--color: var(--chat--color-primary);\n  --chat--input--send--button--background-hover: transparent;\n  --chat--input--send--button--color-hover: var(--chat--color-primary-shade-50);\n  --chat--input--file--button--background: transparent;\n  --chat--input--file--button--color: var(--chat--color-secondary);\n  --chat--input--file--button--background-hover: transparent;\n  --chat--input--file--button--color-hover: var(--chat--color-secondary-shade-50);\n\n  /* --- 8. TOGGLE BUTTON & OTHERS --- */\n  /* Using your primary brand color for the main toggle button */\n  --chat--toggle--size: 64px;\n  --chat--toggle--width: var(--chat--toggle--size);\n  --chat--toggle--height: var(--chat--toggle--size);\n  --chat--toggle--border-radius: 50%;\n  --chat--toggle--background: var(--chat--color-primary);\n  --chat--toggle--hover--background: var(--chat--color-primary-shade-50);\n  --chat--toggle--active--background: var(--chat--color-primary-shade-100);\n  --chat--toggle--color: var(--chat--color-white);\n}\n\n/* === CLASS OVERRIDES === */\n/*\n  These are essential for effects that CSS variables can't control,\n  like the glass blur, shadows, and max-height.\n*/\n\n.chat-window {\n  /* This is the magic for the glass effect! */\n  background-color: rgba(249, 243, 245, 0.6); /* A semi-transparent background color */\n  backdrop-filter: blur(20px);\n  -webkit-backdrop-filter: blur(20px); /* For Safari compatibility */\n\n  /* A subtle shadow helps lift the window off the page */\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);\n\n  /* Here we apply the max-height you wanted */\n  max-height: 750px;\n}\n\n/* Add top margin to the first message only for initial spacing */\n.chat-messages-list .chat-message:first-child {\n  margin-top: var(--chat--spacing);\n}\n\n/* Make user messages slightly wider for better balance */\n.chat-message.is-user {\n\tmax-width: 70%;\n}\n\n.chat-message.is-bot {\n\tmax-width: 80%;\n}\n\n/* Add a subtle glow to messages on hover */\n.chat-message {\n    transition: transform 0.2s ease, box-shadow 0.2s ease;\n}\n.chat-message:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 0 25px 0 rgba(234, 75, 113, 0.2);\n}\n\n/* === PAGE BACKGROUND === */\n/* Your dotted background to simulate the n8n canvas. Perfect as is! */\nbody {\n    background-color: #FDFBFF;\n    background-image:\n        radial-gradient(circle at 1px 1px, rgba(0,0,0,0.07) 1px, transparent 0),\n        linear-gradient(135deg, #F9F3F5 0%, #EFF3FB 100%);\n    background-size: 25px 25px, 100% 100%;\n}",
            "inputPlaceholder": "Type your n8n related question.."
          },
          "initialMessages": "Hello! I'm an AI assistant trained on the official n8n documentation.\nYou can ask me anything about n8n nodes, workflows, or concepts. For example:\n\"How does the IF node work?\"\n\"What is a sub-workflow?\""
        },
        "typeVersion": 1.1
      },
      {
        "id": "2ff38f0f-91ef-45c0-a419-ffeffe9bfea3",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2224,
          -1504
        ],
        "parameters": {
          "width": 624,
          "height": 320,
          "content": "## Setup Step 4: Chat with Your Expert!\n\nCongratulations, the knowledge base is built! Now it's time to ask the expert a question.\n\n**Action:**\n1.  **Activate** the entire workflow using the toggle switch at the top of the screen.\n2.  Open the **`RAG Chatbot`** chat trigger node (bottom-left).\n3.  To chat:\n    *   Copy its **Public URL** and open it in a new browser tab.\n    *   OR, click the **\"Open Chat\"** button in the node's panel to test it directly inside n8n.\n\n\n**Try asking:** \"How does the IF node work?\" or \"What is a sub-workflow?\""
        },
        "typeVersion": 1
      },
      {
        "id": "a42e96aa-a212-4fd8-b3f5-b70738428112",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note24",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2224,
          -2464
        ],
        "parameters": {
          "width": 656,
          "height": 272,
          "content": "## Setup Step 1: Connect Your Google AI Credentials\n\nThis workflow uses Google's Gemini models for generating embeddings and chat responses. You'll need a Google AI API key.\n\n**Action:**\n1.  Go to any of the Gemini nodes (e.g., **`Gemini 2.5 Flash`**).\n2.  Click the **Credential** dropdown and select **`+ Create New Credential`**.\n3.  In the window that opens, paste your **Google AI API Key**.\n4.  Click **Save**. Your new credential will be created and automatically selected for this node."
        },
        "typeVersion": 1
      },
      {
        "id": "22d91015-7d89-4f1c-bd30-cc1387cc24a3",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note27",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2224,
          -2176
        ],
        "parameters": {
          "width": 864,
          "height": 304,
          "content": "## Setup Step 2: Apply Credentials to All Gemini Nodes\n\nYour new Google AI credential is now saved. Let's make sure all the other Gemini nodes are using it.\n\n**Action:**\nGo to the remaining Gemini nodes on the canvas. Your new credential will now be available in their **Credential** dropdown lists. Simply select it for each one.\n\n**Nodes to check:**\n*   `Gemini 2.5 Flash`\n*   `Gemini Chunk Embedding`\n*   `Gemini Query Embedding`"
        },
        "typeVersion": 1
      },
      {
        "id": "497629d6-8b1b-4ab8-9e37-98d21da5fdc2",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note28",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2224,
          -1856
        ],
        "parameters": {
          "width": 784,
          "height": 336,
          "content": "## Setup Step 3: Build the Knowledge Base (Indexing)\n\nThis is the one-time step where the AI \"reads\" all the documentation.\n\n**Action:**\n1.  Find the **`Start Indexing`** manual trigger node at the top-left of the canvas.\n2.  Click its **\"Execute workflow\"** button.\n\n\n**‚ö†Ô∏è IMPORTANT:**\n*   **Be Patient!** This process will take **15-20 minutes** to scrape, process, and store the entire n8n documentation in memory.\n*   **The knowledge base is temporary.** It is stored in n8n's memory and will be **erased if you restart your n8n instance**. If that happens, you must run this indexing step again."
        },
        "typeVersion": 1
      },
      {
        "id": "7ab75be6-6cc7-4306-8f84-b101855cb65d",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Ingest Web Page",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -944,
          -1424
        ],
        "parameters": {
          "inputSource": "passthrough"
        },
        "typeVersion": 1.1
      },
      {
        "id": "0ca1e86a-a43a-4d5b-8fbf-7240151e82ff",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note29",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -64,
          -752
        ],
        "parameters": {
          "color": 3,
          "width": 544,
          "height": 768,
          "content": "## Was this helpful? Let me know!\n\nI really hope this template helped you understand RAG better. Your feedback is incredibly valuable and helps me create better resources for the n8n community.\n\n### **Share Your Thoughts & Ideas**\n\nWhether you have a suggestion, found a typo, or just want to say thanks, I'd love to hear from you!\nHere's a simple n8n form built for this purpose:\n\n#### ‚û°Ô∏è **[Click here to give feedback](https://api.ia2s.app/form/templates/feedback?template=n8n%20Simple%20RAG)**\n\n### **Ready to Build Something Great?**\n\nIf you're looking to take your n8n skills or business automation to the next level, I can help.\n\n**üéì n8n Coaching:** Want to become an n8n pro? I offer one-on-one coaching sessions to help you master workflows, tackle specific problems, and build with confidence.\n#### ‚û°Ô∏è **[Book a Coaching Session](https://api.ia2s.app/form/templates/coaching?template=n8n%20Simple%20RAG)**\n\n**üíº n8n Consulting:** Have a complex project, an integration challenge, or need a custom workflow built for your business? Let's work together to create a powerful automation solution.\n#### ‚û°Ô∏è **[Inquire About Consulting Services](https://api.ia2s.app/form/templates/consulting?template=n8n%20Simple%20RAG)**\n\n---\n\nHappy Automating!\nLucas Peyrin"
        },
        "typeVersion": 1
      },
      {
        "id": "6e3fc66d-e12e-4ef3-81c8-a205be1c26a0",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          512,
          -752
        ],
        "parameters": {
          "color": 2,
          "width": 832,
          "height": 544,
          "content": "## Video Tutorial\n\nA full video tutorial about RAG will be shown here in a future version of this template !"
        },
        "typeVersion": 1
      },
      {
        "id": "85ff7226-9931-41d7-9ca5-c9a6f153fe26",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Simple Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          848,
          -1424
        ],
        "parameters": {
          "mode": "insert",
          "memoryKey": {
            "__rl": true,
            "mode": "id",
            "value": "n8n_documentation_vector_store"
          },
          "embeddingBatchSize": 30
        },
        "typeVersion": 1.3
      },
      {
        "id": "e11b64ae-32ce-4fde-aba8-bbf6744b9edd",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Official n8n Documentation",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -496,
          320
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "topK": 10,
          "memoryKey": {
            "__rl": true,
            "mode": "id",
            "value": "=n8n_documentation_vector_store"
          },
          "toolDescription": "Get related chunks of the official n8n documentation.",
          "includeDocumentMetadata": false
        },
        "typeVersion": 1.3
      }
    ],
    "pinData": {
      "Ingest Web Page": [
        {
          "link": "integrations/builtin/core-nodes/n8n-nodes-base.comparedatasets/"
        }
      ]
    },
    "connections": {
      "RAG Chatbot": {
        "main": [
          [
            {
              "node": "n8n Docs AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "n8n Docs AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Start Indexing": {
        "main": [
          [
            {
              "node": "Get All n8n Documentation Links",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Ingest Web Page": {
        "main": [
          [
            {
              "node": "Get Documentation Page",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out Links": {
        "main": [
          [
            {
              "node": "Remove Duplicate Links",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini 2.5 Flash": {
        "ai_languageModel": [
          [
            {
              "node": "n8n Docs AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Clean Documentation": {
        "main": [
          [
            {
              "node": "Remove Duplicate Documentation Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Simple Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Only Keep Doc Paths": {
        "main": [
          [
            {
              "node": "Loop Over Documentation Pages",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Chunk Embedding": {
        "ai_embedding": [
          [
            {
              "node": "Simple Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Query Embedding": {
        "ai_embedding": [
          [
            {
              "node": "Official n8n Documentation",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Get Documentation Page": {
        "main": [
          [
            {
              "node": "Extract Documentation Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Remove Duplicate Links": {
        "main": [
          [
            {
              "node": "Only Keep Doc Paths",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Links from HTML": {
        "main": [
          [
            {
              "node": "Split Out Links",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Official n8n Documentation": {
        "ai_tool": [
          [
            {
              "node": "n8n Docs AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Extract Documentation Content": {
        "main": [
          [
            {
              "node": "Clean Documentation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Documentation Pages": {
        "main": [
          [],
          [
            {
              "node": "Add Documentation Page to Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get All n8n Documentation Links": {
        "main": [
          [
            {
              "node": "Extract Links from HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Add Documentation Page to Vector Store": {
        "main": [
          [
            {
              "node": "Loop Over Documentation Pages",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Remove Duplicate Documentation Content": {
        "main": [
          [
            {
              "node": "Simple Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "074f90e2bb5206c5f405a8aac6551497c72005283a5405fb08207b1b3a78c2b8",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "5cb0a836-f9a1-4f92-9326-cd82a392d0da",
        "name": "Knowledge Base Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          220,
          0
        ],
        "parameters": {
          "text": "={{ $json.chatInput }}",
          "options": {
            "systemMessage": "You are the AI assistant for an internal support team at a technology company specializing in advanced software solutions. Your task is to assist internal users by consulting the official product documentation stored in the company‚Äôs knowledge base.\n\nAvailable references:\n\nproductDocs: Step-by-step guides, technical configurations, and official manuals extracted from the product‚Äôs documentation.\n\nBehavior rules for answering questions:\nAlways consult the official product documentation first using the productDocs tool.\n\nRespond clearly and directly, explaining how to do what is requested.\n\nDo not filter by category unless explicitly asked by the user.\n\nDetect the language of each incoming message individually and respond in that language. Do not use prior conversation language or history to decide the response language.\n\nNever provide links, even if requested. If a user asks for a link, reply:\n‚ÄúI cannot provide links. If you need specific information, please let me know and I will help with the details.‚Äù\n\nUse a professional, direct, and human tone.\n\nKeep answers between 2 and 4 lines unless the user requests more detail.\n\nDo not invent information that is not in the knowledge base.\n\nIf you give numbered steps or lists, number them sequentially (1, 2, 3...) without skipping or repeating numbers, even if the source content uses different numbering."
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "56e6fb75-6a97-4466-9e7f-70710c2740d7",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          60,
          240
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cJRah9hGPQ7eX4jd",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e352c32e-7108-4a0d-b081-b2532d96d092",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          680,
          380
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cJRah9hGPQ7eX4jd",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "74bbfb00-1a00-4131-a291-bce5b79628b4",
        "name": "When clicking \"Execute Workflow\"",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -60,
          -420
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "f720a4b0-6239-4a0b-bb61-1e43f78f8e40",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          320,
          220
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "94561d61-4a01-48b6-b114-dc4d47546ff3",
        "name": "MongoDB Vector Search",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreMongoDBAtlas",
        "position": [
          560,
          220
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {},
          "toolName": "productDocs",
          "mongoCollection": {
            "__rl": true,
            "mode": "list",
            "value": "n8n-template",
            "cachedResultName": "n8n-template"
          },
          "toolDescription": "retreive documentation",
          "vectorIndexName": "data_index"
        },
        "credentials": {
          "mongoDb": {
            "id": "7riubYENUDZsmjyK",
            "name": "MongoDB account 2"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "c473c33d-5681-4f3a-ac36-0d3012e7251f",
        "name": "Document Section Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          740,
          -260
        ],
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "doc_id",
                  "value": "={{ $json.documentId }}"
                }
              ]
            }
          },
          "jsonData": "={{ $json.content }}",
          "jsonMode": "expressionData"
        },
        "typeVersion": 1
      },
      {
        "id": "321222cb-1daf-4be2-a6ca-1a03d24f670f",
        "name": "Document Chunker",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          860,
          -100
        ],
        "parameters": {
          "options": {
            "splitCode": "markdown"
          },
          "chunkSize": 3000,
          "chunkOverlap": 200
        },
        "typeVersion": 1
      },
      {
        "id": "716519f5-cec1-4bfe-afbe-614fc23e74b5",
        "name": "MongoDB Vector Store Inserter",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreMongoDBAtlas",
        "position": [
          540,
          -420
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "mongoCollection": {
            "__rl": true,
            "mode": "list",
            "value": "n8n-template",
            "cachedResultName": "n8n-template"
          },
          "vectorIndexName": "data_index"
        },
        "credentials": {
          "mongoDb": {
            "id": "7riubYENUDZsmjyK",
            "name": "MongoDB account 2"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "a49c19fc-f5f5-4381-b6ba-1bfc12b96135",
        "name": "OpenAI Embeddings Generator",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          480,
          -180
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cJRah9hGPQ7eX4jd",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6de724d5-2941-4e72-af8b-302ca2cf2ca0",
        "name": "Google Docs Importer",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          200,
          -420
        ],
        "parameters": {
          "operation": "get",
          "documentURL": "https://docs.google.com/document/d/1gvgp71e9edob8WLqFIYCdzC7kUq3pLO37VKb-a-vVW4/edit?tab=t.0"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "FNXMwqMf7vl1WUFj",
            "name": "Google Docs account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "4f30bb21-72f0-4d13-b610-2ec218ad31b1",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -420,
          -440
        ],
        "parameters": {
          "color": 5,
          "content": "Run this workflow manually to import and index Google Docs product documentation into MongoDB with vector embeddings for fast search."
        },
        "typeVersion": 1
      },
      {
        "id": "25fd33d5-041b-4f01-a46b-1bacabd88376",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          40,
          0
        ],
        "webhookId": "427ead97-647d-49c7-82d7-e76b40664fd1",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "f1f3fadd-d5e6-45df-b810-1616531dffcb",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -420,
          40
        ],
        "parameters": {
          "color": 4,
          "content": "This workflow uses retrieval-augmented generation (RAG) to answer user questions by searching the MongoDB vector store and generating AI responses with context."
        },
        "typeVersion": 1
      },
      {
        "id": "39eee95c-b332-4ae4-bde9-aaf0fe5e0546",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1060,
          -380
        ],
        "parameters": {
          "height": 520,
          "content": "Search Index Example \n\n{\n  \"mappings\": {\n    \"dynamic\": false,\n    \"fields\": {\n      \"_id\": {\n        \"type\": \"string\"\n      },\n      \"text\": {\n        \"type\": \"string\"\n      },\n      \"embedding\": {\n        \"type\": \"knnVector\",\n        \"dimensions\": 1536,\n        \"similarity\": \"cosine\"\n      },\n      \"source\": {\n        \"type\": \"string\"\n      },\n      \"doc_id\": {\n        \"type\": \"string\"\n      }\n    }\n  }\n}\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Knowledge Base Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Document Chunker": {
        "ai_textSplitter": [
          [
            {
              "node": "Document Section Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "MongoDB Vector Search",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Knowledge Base Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Docs Importer": {
        "main": [
          [
            {
              "node": "MongoDB Vector Store Inserter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Knowledge Base Agent": {
        "main": [
          []
        ]
      },
      "MongoDB Vector Search": {
        "ai_tool": [
          [
            {
              "node": "Knowledge Base Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Document Section Loader": {
        "ai_document": [
          [
            {
              "node": "MongoDB Vector Store Inserter",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Knowledge Base Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Embeddings Generator": {
        "ai_embedding": [
          [
            {
              "node": "MongoDB Vector Store Inserter",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "When clicking \"Execute Workflow\"": {
        "main": [
          [
            {
              "node": "Google Docs Importer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "pDhufDfHS9qRgtLf",
    "meta": {
      "instanceId": "fa52a98dd39f67760c7540fff8a0dd5306d89f766551eb7a7c84b5f43eb33d4c",
      "templateCredsSetupCompleted": true
    },
    "name": "Simple RAG",
    "tags": [],
    "nodes": [
      {
        "id": "93cd13c5-12ad-4c9c-aac7-1886a1d24470",
        "name": "On form submission",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          0,
          0
        ],
        "webhookId": "cab3dda4-3b49-4f05-a2c1-915ae4c62017",
        "parameters": {
          "options": {},
          "formTitle": "Upload RAG PDF",
          "formFields": {
            "values": [
              {
                "fieldType": "file",
                "fieldLabel": "File",
                "multipleFiles": false,
                "requiredField": true,
                "acceptFileTypes": ".pdf"
              }
            ]
          },
          "formDescription": "Upload RAG PDF"
        },
        "typeVersion": 2.2
      },
      {
        "id": "13fe2ba5-a24d-4198-8509-882eb4c08e1a",
        "name": "Pinecone Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "position": [
          320,
          0
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "n8n",
            "cachedResultName": "n8n"
          }
        },
        "credentials": {
          "pineconeApi": {
            "id": "VP5fhue9NYRkdlCj",
            "name": "PineconeApi account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "aa3d1481-3da7-4ae1-9857-c64a71e28443",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          920,
          460
        ],
        "parameters": {
          "options": {
            "dimensions": 1024
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "y8sLJ2LzZL2c7SGi",
            "name": "OpenAI Webinar"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "17350e15-5b99-493d-acd2-9f44fd661b09",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          440,
          220
        ],
        "parameters": {
          "options": {},
          "dataType": "binary",
          "textSplittingMode": "custom"
        },
        "typeVersion": 1.1
      },
      {
        "id": "8199713d-cad8-4d17-937c-1b3b604b95ea",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          520,
          440
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "fcaf5178-4694-4e20-ac62-8da3c1c8279e",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          -80
        ],
        "parameters": {
          "width": 880,
          "height": 680,
          "content": "## Insert Data to Pinecone"
        },
        "typeVersion": 1
      },
      {
        "id": "e094ded2-c2e9-4139-b6d0-df086f2e2049",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1440,
          80
        ],
        "parameters": {
          "options": {
            "systemMessage": "Hanya jawab berdasarkan data yang ada di tools \"VectorDB\". Kalau data disitu gak ada, jawab saja kamu tidak tahu."
          }
        },
        "typeVersion": 2
      },
      {
        "id": "015d2a82-3c3d-4604-bbbf-7df57dd24269",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          1200,
          80
        ],
        "webhookId": "c1f8d15b-e096-47f8-922e-a7484ebbc25c",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "a1b26946-9a3f-4aa2-a723-f91e196943cf",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1280,
          300
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1",
            "cachedResultName": "gpt-4.1"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "y8sLJ2LzZL2c7SGi",
            "name": "OpenAI Webinar"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6beecd5e-a8fc-4e69-8fbc-a0e0e90c4aa6",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          1480,
          300
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "02b1aa4f-a291-4f2c-b6d9-0290d6b563ae",
        "name": "VectorDB",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "position": [
          1640,
          300
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "topK": 20,
          "options": {},
          "useReranker": true,
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "n8n",
            "cachedResultName": "n8n"
          },
          "toolDescription": "Ambil data dari vector database untuk knowledgebase"
        },
        "credentials": {
          "pineconeApi": {
            "id": "VP5fhue9NYRkdlCj",
            "name": "PineconeApi account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "bada58fc-73f4-431f-9702-e742a75ce2c3",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1100,
          -80
        ],
        "parameters": {
          "color": 5,
          "width": 860,
          "height": 680,
          "content": "## Chat AI Agent"
        },
        "typeVersion": 1
      },
      {
        "id": "2e572866-dcf7-492f-aebe-35b12bc6b27d",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          840,
          300
        ],
        "parameters": {
          "color": 4,
          "height": 300,
          "content": "## Embedding Model"
        },
        "typeVersion": 1
      },
      {
        "id": "6dcbbf3a-3acd-4170-9f79-c2441da18979",
        "name": "Reranker Cohere",
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "position": [
          1740,
          480
        ],
        "parameters": {},
        "credentials": {
          "cohereApi": {
            "id": "yDA2nh2ZZXkR9tcq",
            "name": "Cohere API Trial"
          }
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "6b1d46bd-ed09-4a25-a95e-fa5a3e2950f7",
    "connections": {
      "VectorDB": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere": {
        "ai_reranker": [
          [
            {
              "node": "VectorDB",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "ai_embedding",
              "index": 0
            },
            {
              "node": "VectorDB",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "On form submission": {
        "main": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store": {
        "main": [
          []
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "KhUd3rHKtZAImiXZ",
    "meta": {
      "instanceId": "9219ebc7795bea866f70aa3d977d54417fdf06c41944be95e20cfb60f992db19",
      "templateCredsSetupCompleted": true
    },
    "name": "Personal Assistant MCP server",
    "tags": [],
    "nodes": [
      {
        "id": "f27f3d00-8019-401f-a1c4-5c9754ca5d7e",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -220,
          -60
        ],
        "webhookId": "989c3a79-5a0c-4ca1-a542-55e060816121",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "49e4bd69-141f-47ae-bb97-f03a92e56131",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -80,
          140
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-pro-preview-05-06"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "MF12DwQJWL1egyiN",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "aaa58803-52ad-439b-8876-05a84fc63eaf",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          120,
          140
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "5c49309e-054c-4097-b8c3-1bf0b10539ec",
        "name": "MCP Server Trigger",
        "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
        "position": [
          20,
          340
        ],
        "webhookId": "b37ab045-0b99-4d57-af44-6ae1e9ac6381",
        "parameters": {
          "path": "b37ab045-0b99-4d57-af44-6ae1e9ac6381"
        },
        "typeVersion": 1
      },
      {
        "id": "24e5ee35-c53c-4e82-9d79-d48d9220d7ac",
        "name": "MCP Client",
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "position": [
          480,
          140
        ],
        "parameters": {
          "sseEndpoint": "<set-your-url-here>"
        },
        "typeVersion": 1
      },
      {
        "id": "24d7de59-9db2-43e8-ad2a-923bbfc9877b",
        "name": "Create event",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          820,
          380
        ],
        "parameters": {
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "hello@1node.ai",
            "cachedResultName": "hello@1node.ai"
          },
          "additionalFields": {}
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "UfvyikkM1kt4EcMl",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "54a2e041-8c5c-40bb-ae6b-1494b8a5a198",
        "name": "Update event",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          580,
          720
        ],
        "parameters": {
          "eventId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Event_ID', ``, 'string') }}",
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "hello@1node.ai",
            "cachedResultName": "hello@1node.ai"
          },
          "operation": "update",
          "updateFields": {}
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "UfvyikkM1kt4EcMl",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "7bebda2e-711f-478b-8ba3-36306b1ffb49",
        "name": "Draft email",
        "type": "n8n-nodes-base.gmailTool",
        "position": [
          260,
          780
        ],
        "webhookId": "4e76cb3d-4239-4030-a23a-544029535f70",
        "parameters": {
          "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', `Sign off as \"Your name, company name\"`, 'string') }}",
          "options": {},
          "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}",
          "resource": "draft"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "q3P6IybvNdDiPZ52",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "26538db2-f3af-47a8-b97e-2afa7d9ea05d",
        "name": "Personal Assistant",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          40,
          -60
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.9
      },
      {
        "id": "04c5d14f-a80d-4113-b3ff-a6ee1ab3917e",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          920,
          280
        ],
        "parameters": {
          "color": 5,
          "width": 560,
          "height": 620,
          "content": "# Calendar nodes\n\nYou could order your agent to create a new event in your Google Calendar, find a specific event, get multiple events or update an event's details. \n\n**The true power of these nodes regarding Email, CRM and Calendar remains in combining multiple into one set of instructions**.\n\n## Examples:\n\n- Find the contact for Jhon for A. Corp and send him an email asking saying that you have scheduled the meeting for next Wednesday at 9AM. Draft an email to remind him of the details and the topic of discussion being the weekly update call and the main company bottlenecks.\n- Update the contact details for Jhon since he changed his email and company to B corp and john[at]bcorpfakeemail[dot]com and please update me about my upcoming meetings with him next month.\n- Send me a summary for all my meetings today. Draft one email for each different person that I'll meet with today, reminding them about today's meeting\n"
        },
        "typeVersion": 1
      },
      {
        "id": "0de610d2-20bf-4fd4-b93e-60b082d22e56",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          700
        ],
        "parameters": {
          "color": 3,
          "width": 460,
          "height": 500,
          "content": "# Email nodes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nYour AI Agent will be able to search through your email inbox to find specific email content for you. Based on this records you can fetch information quickly and order to draft responses to review later.\n\n## Examples:\n\n- hey what were the last 5 emails sent to Jon from X corp? \n- Draft an email with these details to Jon sharing I can't make it today and propose a new time for 9AM tomorrow. "
        },
        "typeVersion": 1
      },
      {
        "id": "e084e23e-473b-4798-a39c-00529ef9e827",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -720,
          360
        ],
        "parameters": {
          "color": 4,
          "width": 660,
          "height": 480,
          "content": "# CRM nodes\n\nWith these node operations your \nAI agent will be able to do the following:\n\n- Add a new row with contact data\n- Find a row and its details in the table\n- Update a value or group of values\n\n\n## Examples:\n\n- Add a new contact data with Rick as first name\n his cell is +1 XXX XXX XXXX. \nI will tell you the email later on.\n- Can you tell me the details and email for Jon Doe?\n I want to send him an email reminder.\n- Update Rick's email to rick[at]someemail[dot]com from X corp. please."
        },
        "typeVersion": 1
      },
      {
        "id": "dc9dcee5-35ec-4ea3-8c67-21c277705dec",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          360,
          -220
        ],
        "parameters": {
          "width": 480,
          "height": 480,
          "content": "## MCP Client\n\nPaste your MCP client URL from the MCP server trigger node.\n\nCustomize your output node to receive the workflow completion notifications (eg. Telegram, Gmail) from your personal assistant"
        },
        "typeVersion": 1
      },
      {
        "id": "1764e9cd-7fc1-46e7-bc97-33d4b81d5141",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          520,
          280
        ],
        "parameters": {
          "color": 5,
          "width": 400,
          "height": 620,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "b4dda81f-fa22-43ec-a841-7b924b8884e8",
        "name": "Add new row",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          -340,
          440
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1JDoEkNqk1c_TrIht2n1XF-jmIWpk48DP3NUaNbhcFV8/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1JDoEkNqk1c_TrIht2n1XF-jmIWpk48DP3NUaNbhcFV8",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1JDoEkNqk1c_TrIht2n1XF-jmIWpk48DP3NUaNbhcFV8/edit?usp=drivesdk",
            "cachedResultName": "Contacts"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "twZdLFsI3kTnqtpG",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "e3bc61e0-1d95-4554-b7ba-f76c3f105339",
        "name": "Find row",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          -280,
          580
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1JDoEkNqk1c_TrIht2n1XF-jmIWpk48DP3NUaNbhcFV8/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1JDoEkNqk1c_TrIht2n1XF-jmIWpk48DP3NUaNbhcFV8",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1JDoEkNqk1c_TrIht2n1XF-jmIWpk48DP3NUaNbhcFV8/edit?usp=drivesdk",
            "cachedResultName": "Contacts"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "twZdLFsI3kTnqtpG",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "461469da-c47a-486f-98c2-71fcc9abc235",
        "name": "Update row",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          -180,
          680
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1JDoEkNqk1c_TrIht2n1XF-jmIWpk48DP3NUaNbhcFV8/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1JDoEkNqk1c_TrIht2n1XF-jmIWpk48DP3NUaNbhcFV8",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1JDoEkNqk1c_TrIht2n1XF-jmIWpk48DP3NUaNbhcFV8/edit?usp=drivesdk",
            "cachedResultName": "Contacts"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "twZdLFsI3kTnqtpG",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "01c0ba70-c1b1-454f-9b4e-0727c8280ace",
        "name": "Find emails",
        "type": "n8n-nodes-base.gmailTool",
        "position": [
          120,
          780
        ],
        "webhookId": "b36e3112-52b1-4e03-a2d3-74d5d4705891",
        "parameters": {
          "filters": {},
          "operation": "getAll",
          "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "q3P6IybvNdDiPZ52",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "40efd312-032f-496b-8485-a6a49001aa75",
        "name": "Find single event",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          760,
          520
        ],
        "parameters": {
          "eventId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Event_ID', ``, 'string') }}",
          "options": {},
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "hello@1node.ai",
            "cachedResultName": "hello@1node.ai"
          },
          "operation": "get"
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "UfvyikkM1kt4EcMl",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "8ac5c33e-f4fb-4627-98d5-b66838db3037",
        "name": "Find multiple events",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          680,
          620
        ],
        "parameters": {
          "limit": 10,
          "options": {},
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "hello@1node.ai",
            "cachedResultName": "hello@1node.ai"
          },
          "operation": "getAll"
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "UfvyikkM1kt4EcMl",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "99536a4c-8e1b-4b7e-9a2a-8baa404499fe",
    "connections": {
      "Find row": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "MCP Client": {
        "ai_tool": [
          [
            {
              "node": "Personal Assistant",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Update row": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Add new row": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Draft email": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Find emails": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create event": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Update event": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Personal Assistant",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Find single event": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Find multiple events": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Personal Assistant",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Personal Assistant",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "wQ7y8grS10XllodU",
    "meta": {
      "instanceId": "9219ebc7795bea866f70aa3d977d54417fdf06c41944be95e20cfb60f992db19",
      "templateCredsSetupCompleted": true
    },
    "name": "pipedrive mcp",
    "tags": [],
    "nodes": [
      {
        "id": "bc8b95d8-467c-4ad3-8b20-8c8cf246b012",
        "name": "On new message",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -240,
          -140
        ],
        "webhookId": "31e8c191-91b8-4df2-889e-8ab59eeaab92",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "LQR5obzFLK65n5Vn",
            "name": "pipedrive mcp bot"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "629e67ec-305d-4544-82be-7da75af5086e",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          0,
          -140
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.9
      },
      {
        "id": "34754420-6058-4b9c-9924-ea937bf77e24",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          100,
          80
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "630f983c-b6b2-4c60-8474-c9657eee065b",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -60,
          80
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-pro-preview-05-06"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "MF12DwQJWL1egyiN",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "fd7e83d1-27b6-424c-b632-d8a5b65577a7",
        "name": "MCP Client",
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "position": [
          400,
          260
        ],
        "parameters": {
          "sseEndpoint": "your-MCP-url-here"
        },
        "typeVersion": 1
      },
      {
        "id": "9961f536-96d9-4a45-910b-4572e2e807ee",
        "name": "MCP Server Trigger",
        "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
        "position": [
          -140,
          380
        ],
        "webhookId": "154b1d16-5a33-42d3-b657-2cd45a3d23b9",
        "parameters": {
          "path": "pipedrive-mcp-demo"
        },
        "typeVersion": 1
      },
      {
        "id": "f76545a8-94cb-4170-a187-3f24cb1ea497",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -920,
          160
        ],
        "parameters": {
          "color": 4,
          "width": 220,
          "height": 940,
          "content": "# Deals\n"
        },
        "typeVersion": 1
      },
      {
        "id": "1f89ed2a-e011-418d-8178-11bdfe6c5d6b",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -620,
          160
        ],
        "parameters": {
          "color": 4,
          "height": 920,
          "content": "# Leads\n"
        },
        "typeVersion": 1
      },
      {
        "id": "52fcc0e7-e248-4bc8-98ba-78339177e659",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -280,
          640
        ],
        "parameters": {
          "color": 4,
          "width": 360,
          "height": 440,
          "content": "# Persons\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9fafdb21-5f29-4b0d-9c1e-2a7096998692",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          260,
          620
        ],
        "parameters": {
          "color": 4,
          "width": 380,
          "height": 500,
          "content": "# Organizations\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3be7d19b-f0d0-4020-b7b9-ec74d97317bd",
        "name": "Create Organization Deal",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -860,
          260
        ],
        "parameters": {
          "title": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Title', ``, 'string') }}",
          "org_id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Organization_ID', ``, 'number') }}",
          "authentication": "oAuth2",
          "additionalFields": {}
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e326dc90-df81-46b5-884a-3cc894be6ee3",
        "name": "Create Person Deal",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -860,
          440
        ],
        "parameters": {
          "title": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Title', ``, 'string') }}",
          "person_id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Person_ID', ``, 'number') }}",
          "associateWith": "person",
          "authentication": "oAuth2",
          "additionalFields": {}
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "886529d1-f88e-441e-9c52-4983a1fcd1f7",
        "name": "Update Deal",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -860,
          760
        ],
        "parameters": {
          "dealId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Deal_ID', ``, 'number') }}",
          "operation": "update",
          "updateFields": {
            "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Value', ``, 'number') }}",
            "lost_reason": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Lost_Reason', ``, 'string') }}",
            "probability": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Probability', ``, 'number') }}"
          },
          "authentication": "oAuth2"
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d39ed3b7-3312-450a-b839-80e09b9eaa05",
        "name": "Search & Return Deals",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -860,
          920
        ],
        "parameters": {
          "term": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Term', ``, 'string') }}",
          "operation": "search",
          "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}",
          "authentication": "oAuth2",
          "additionalFields": {}
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "db2eb0eb-5836-4d89-83ab-bc82ad550649",
        "name": "Create Person Lead",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -560,
          420
        ],
        "parameters": {
          "title": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Title', ``, 'string') }}",
          "resource": "lead",
          "person_id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Person_ID', ``, 'number') }}",
          "associateWith": "person",
          "authentication": "oAuth2",
          "additionalFields": {}
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "fe9ccc72-33d2-4876-b0fd-1df1552463c1",
        "name": "Get Lead",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -560,
          580
        ],
        "parameters": {
          "leadId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Lead_ID', ``, 'string') }}",
          "resource": "lead",
          "operation": "get",
          "authentication": "oAuth2"
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ffd60843-e218-4065-9573-df77deb3f9d5",
        "name": "Get Deal",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -860,
          600
        ],
        "parameters": {
          "dealId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Deal_ID', ``, 'number') }}",
          "operation": "get",
          "authentication": "oAuth2",
          "resolveProperties": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Resolve_Properties', ``, 'boolean') }}"
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "f89b9505-d98d-4ba0-9c63-92d967f2c079",
        "name": "Update Lead",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -560,
          760
        ],
        "parameters": {
          "leadId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Lead_ID', ``, 'string') }}",
          "resource": "lead",
          "operation": "update",
          "updateFields": {},
          "authentication": "oAuth2"
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5def7b19-2c74-4446-adf7-a029c8d1105d",
        "name": "Return Many Leads",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -560,
          920
        ],
        "parameters": {
          "filters": {},
          "resource": "lead",
          "operation": "getAll",
          "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}",
          "authentication": "oAuth2"
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d93c7451-0e0b-4ac4-977c-ab58059d02cf",
        "name": "Create Person",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -240,
          740
        ],
        "parameters": {
          "name": "=",
          "resource": "person",
          "authentication": "oAuth2",
          "additionalFields": {
            "email": [
              "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('email0_Email', ``, 'string') }}"
            ]
          }
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9276b99a-2eb6-4db0-83b7-49da716ab603",
        "name": "Get Person",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -80,
          740
        ],
        "parameters": {
          "personId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Person_ID', ``, 'number') }}",
          "resource": "person",
          "operation": "get",
          "authentication": "oAuth2"
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "df5b28c5-0c95-47df-a6d2-8acb33c94e7a",
        "name": "Search Person",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -80,
          920
        ],
        "parameters": {
          "term": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Term', ``, 'string') }}",
          "resource": "person",
          "operation": "search",
          "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}",
          "authentication": "oAuth2",
          "additionalFields": {}
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b26798fe-c5d8-4095-a2ad-ef9d73a6c5c8",
        "name": "Update Person",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -240,
          920
        ],
        "parameters": {
          "personId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Person_ID', ``, 'number') }}",
          "resource": "person",
          "operation": "update",
          "updateFields": {},
          "authentication": "oAuth2"
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c45b77da-6a1c-482b-a2af-4758be227bbb",
        "name": "Create Organization",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          320,
          720
        ],
        "parameters": {
          "name": "=",
          "resource": "organization",
          "authentication": "oAuth2",
          "additionalFields": {}
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8eab17f1-dfc7-4db6-a01a-69198396f9f4",
        "name": "Get Organization Data",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          500,
          720
        ],
        "parameters": {
          "resource": "organization",
          "operation": "get",
          "authentication": "oAuth2",
          "organizationId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Organization_ID', ``, 'number') }}"
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "922388c1-a4d4-4a28-b392-37426e83105f",
        "name": "Search & Return Organizations",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          320,
          940
        ],
        "parameters": {
          "term": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Term', ``, 'string') }}",
          "resource": "organization",
          "operation": "search",
          "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}",
          "authentication": "oAuth2",
          "additionalFields": {}
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "1ae56aac-b2ad-4d2a-b7e9-294ba6e06a51",
        "name": "Update an Organization",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          500,
          940
        ],
        "parameters": {
          "resource": "organization",
          "operation": "update",
          "updateFields": {},
          "authentication": "oAuth2",
          "organizationId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Organization_ID', ``, 'number') }}"
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5738bb7b-e040-48fc-8c4f-652ad3e86140",
        "name": "Create Organization Lead",
        "type": "n8n-nodes-base.pipedriveTool",
        "position": [
          -560,
          260
        ],
        "parameters": {
          "title": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Title', ``, 'string') }}",
          "resource": "lead",
          "authentication": "oAuth2",
          "organization_id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Organization_ID', ``, 'number') }}",
          "additionalFields": {}
        },
        "credentials": {
          "pipedriveOAuth2Api": {
            "id": "qbWdzfaKpYgLuGSk",
            "name": "Pipedrive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "3482a78b-ea8a-4cc6-9043-714641bdd237",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          300,
          -340
        ],
        "parameters": {
          "width": 340,
          "height": 380,
          "content": "# Customize output\n \nSet your email in the \"**To**\" field to receive the execution summary. \n\nChange the output workflow by plugging your desired tools."
        },
        "typeVersion": 1
      },
      {
        "id": "f5cbef56-0db4-402e-aed1-a4274f01bc3b",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -920,
          -460
        ],
        "parameters": {
          "width": 600,
          "height": 560,
          "content": "# Overview \n\nThe following workflow and AI agent allows you to interact with a telegram bot to read, update, and insert data into your Sales CRM, in this case Pipedrive, and receive a summary of the actions executed in your email.\n\n## Set up requirements\n- [Pipedrive account](https://aff.trypipedrive.com/gfq51z688ekq) and a private app with the required permissions you wish you grant\n- Telegram bot\n- Enabled Gmail API\n- An MCP server\n\n## Benefits\nSome sales teams and top level managers spend hours weekly inserting data, retrieving results, and updating specific fields. Such workflow automation allows them to interact with their CRM in natural language to get data and make the necessary changes in seconds.\n\nNeed help implementing such a system for your organization in other CRM tools? Contact us at [1 Node](https://1node.ai)"
        },
        "typeVersion": 1
      },
      {
        "id": "af672696-08ed-4efa-8bf1-aad884daa370",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          300,
          100
        ],
        "parameters": {
          "width": 340,
          "height": 300,
          "content": "# MCP Client \n\nPaste the MCP URL from the **MCP Server Trigger** node below"
        },
        "typeVersion": 1
      },
      {
        "id": "48f10873-c397-448c-823d-902f24243336",
        "name": "Send summary",
        "type": "n8n-nodes-base.gmail",
        "position": [
          360,
          -140
        ],
        "webhookId": "c3f1ba3f-6bdb-42ab-b2e0-af02dd58ada9",
        "parameters": {
          "sendTo": "youremailhere",
          "message": "={{ $json.output }}",
          "options": {},
          "subject": "=Pipedrive AI Agent run",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "q3P6IybvNdDiPZ52",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "6118c192-8cf1-47da-86b9-73970b9da8e9",
    "connections": {
      "AI Agent": {
        "main": [
          [
            {
              "node": "Send summary",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Deal": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Get Lead": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Get Person": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "MCP Client": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Update Deal": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Update Lead": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create Person": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Search Person": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Update Person": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "On new message": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Return Many Leads": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create Person Deal": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create Person Lead": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create Organization": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Get Organization Data": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Search & Return Deals": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Update an Organization": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create Organization Deal": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create Organization Lead": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Search & Return Organizations": {
        "ai_tool": [
          [
            {
              "node": "MCP Server Trigger",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "muEszdmquRYSUdM9",
    "meta": {
      "instanceId": "a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462",
      "templateCredsSetupCompleted": true
    },
    "name": "Pipedream's MCP server",
    "tags": [],
    "nodes": [
      {
        "id": "d498ed94-65f4-4560-a186-ba324506f73f",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          16,
          -64
        ],
        "webhookId": "79dae454-ccf5-4129-8197-f79bf5add978",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "866a327c-22a2-4a3a-8993-75ae9e836c71",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          240,
          -64
        ],
        "parameters": {
          "options": {
            "systemMessage": "You are a helpful assistant"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "457b6172-4519-4bf9-aa84-44dbf14befb6",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          112,
          144
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "TefveNaDaMERl1hY",
            "name": "OpenAi account (Eure)"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "cd652804-a75c-4efd-b197-92810f94bb5f",
        "name": "Calendly",
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "position": [
          400,
          144
        ],
        "parameters": {
          "sseEndpoint": "https://mcp.pipedream.net/xxx/calendly_v2"
        },
        "typeVersion": 1
      },
      {
        "id": "ae996f82-1e34-486a-af82-2fdcfe32c3d9",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          256,
          144
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "4465fc4e-68b0-456d-828a-bff296038a34",
        "name": "Gmail",
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "position": [
          512,
          144
        ],
        "parameters": {
          "sseEndpoint": "https://mcp.pipedream.net/xxx/gmail"
        },
        "typeVersion": 1
      },
      {
        "id": "32e919f8-6e73-4aa3-9148-93f920930f3b",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -352,
          -768
        ],
        "parameters": {
          "width": 624,
          "height": 656,
          "content": "## Pipedream's MCP server\n\nAdd 2,700+ APIs and 10,000+ tools to your AI assistant for free. Connect your accounts securely and revoke access at any time.\n\n![image](https://n3wstorage.b-cdn.net/n3witalia/pipedream_1.png)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "79a54171-4f68-418c-8ad2-b30e2ed23fe5",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          288,
          -768
        ],
        "parameters": {
          "width": 624,
          "height": 656,
          "content": "### How to work\n\n- Sign up on [Pipedream](https://mcp.pipedream.com/)\n- Manage your MCP server and connected accounts\n- Copy and paste your MCP Server URL https://mcp.pipedream.net/xxx/{app_slug} into the MCP SSE Endpoint node in n8n.\n\nExample:\n- https://mcp.pipedream.net/xxx/calendly_v2 for Calendly\n- https://mcp.pipedream.net/xxx/calendly_v2 for Gmail\n\n\n![image](https://n3wstorage.b-cdn.net/n3witalia/pipedream_2.png)"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "d75b30d2-ecdf-4ac7-8d4b-72c5961c7a7c",
    "connections": {
      "Gmail": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Calendly": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "STzi96JfL52BUuQD",
    "meta": {
      "instanceId": "2a26454b0172ffcb8d70ba77c235b1209f92cd71bf06c79ba609c7173b416d68",
      "templateCredsSetupCompleted": true
    },
    "name": "AI Voice Chat Agent with ElevenLabs and InfraNodus Graph RAG Knowledge",
    "tags": [
      {
        "id": "66wgFoDi9Xjl74M3",
        "name": "Support",
        "createdAt": "2025-05-21T17:06:32.355Z",
        "updatedAt": "2025-05-21T17:06:32.355Z"
      },
      {
        "id": "9QurS5Kb1CkCYrnG",
        "name": "Product",
        "createdAt": "2025-05-21T17:06:29.704Z",
        "updatedAt": "2025-05-21T17:06:29.704Z"
      },
      {
        "id": "IzYV3Gv55x1h73cK",
        "name": "Ideation",
        "createdAt": "2025-05-20T14:53:20.662Z",
        "updatedAt": "2025-05-20T14:53:20.662Z"
      },
      {
        "id": "aECLdyckoPZ29skg",
        "name": "Writing",
        "createdAt": "2025-05-20T14:53:23.085Z",
        "updatedAt": "2025-05-20T14:53:23.085Z"
      },
      {
        "id": "ciIq4giMNXaJiyiQ",
        "name": "Thinking Tools",
        "createdAt": "2025-05-20T14:53:17.515Z",
        "updatedAt": "2025-05-20T14:53:17.515Z"
      },
      {
        "id": "hCzs9EJfBuD0RxuX",
        "name": "Other",
        "createdAt": "2025-05-21T17:06:34.674Z",
        "updatedAt": "2025-05-21T17:06:34.674Z"
      },
      {
        "id": "sJk9cUvmMU8FkJXv",
        "name": "AI",
        "createdAt": "2025-05-20T13:16:15.636Z",
        "updatedAt": "2025-05-20T13:16:15.636Z"
      }
    ],
    "nodes": [
      {
        "id": "b17450bf-5c34-43b9-a7cb-1e8d48a90e5e",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          840,
          260
        ],
        "parameters": {
          "width": 200,
          "height": 740,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Expert #1\n\nAdd your InfraNodus graph here via the HTTP node using its name in the `body.name` field.\n\nDescribe what the expert does in the Description of the tool. You can use auto-generated Graph RAG summary from InfraNodus > Graph > Project Notes\n\n![Book Screenshot](https://i.ibb.co/rfxsJ4MV/circadian-special-agents-manual.png)"
        },
        "typeVersion": 1
      },
      {
        "id": "8d41bb1b-ff2d-43bf-b9aa-be41a824a568",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1060,
          260
        ],
        "parameters": {
          "width": 200,
          "height": 740,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Expert #2\n\nAdd your InfraNodus graph here via the HTTP node using its name in the `body.name` field.\n\nDescribe what the expert does in the Description of the tool. You can use auto-generated Graph RAG summary from InfraNodus > Graph > Project Notes\n\n![waves into patterns screen](https://i.ibb.co/1tDJSgVq/circadian-waves-into-patterns.png)"
        },
        "typeVersion": 1
      },
      {
        "id": "3092328a-8b99-4086-9be8-20157a48d706",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1280,
          260
        ],
        "parameters": {
          "width": 200,
          "height": 640,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Expert #3\n\nYou can add more experts here. Just make to give them descriptive names, so the agent knows which one to connect to when it has a question. \n\n![flow and notion image](https://i.ibb.co/prLbFG0w/circadian-the-flow-and-notion.png)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8165ec0a-ac24-4e3e-8240-162a3ef6e47e",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          620,
          260
        ],
        "parameters": {
          "width": 200,
          "height": 540,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Chat Memory\n\nWe use the Simple Memory node to track the conversation's context so that the user can refer to previous messages as they converse with the model."
        },
        "typeVersion": 1
      },
      {
        "id": "333d860c-615f-441d-a7ab-53e867cd5503",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          420,
          -360
        ],
        "parameters": {
          "width": 460,
          "height": 500,
          "content": "## 2. AI Agent Workflow\n\n### Chooses which tool (expert) to use, depending on the user's message. Then receives the responses and synthesizes the final answer.\n\nMake sure you describe the tools available well both in the Agent's System Prompt and in the tools' descriptions. "
        },
        "typeVersion": 1
      },
      {
        "id": "9f7a3cc4-99c6-4179-b3ce-7bff999cf77b",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          40
        ],
        "parameters": {
          "height": 580,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## 1. Chat Trigger\n\nThe conversation will be triggered when you send a message via a webhook from your Elevenlabs AI Conversational agent. \n\n### üö® SEE THE NOTE AND THE LINK BELOW ON SETTING UP YOUR ELEVENLABS AGENT"
        },
        "typeVersion": 1
      },
      {
        "id": "c3fd90e8-3451-4c17-92c7-ca6c1e3305c6",
        "name": "OpenAI Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "disabled": true,
        "position": [
          400,
          540
        ],
        "parameters": {
          "model": "gpt-4o",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "07wFa8Wa4mMRCHAj",
            "name": "OpenAi account 2"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "2e049f32-5d79-4a46-8c99-6a5a9c583c4f",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          680,
          300
        ],
        "parameters": {
          "sessionKey": "={{ $json.body.sessionId }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "68137659-df1d-4a23-83f8-42a03189077b",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          980,
          -360
        ],
        "parameters": {
          "width": 260,
          "height": 500,
          "content": "## 3. Respond to the User\n\nOnce the response is generated, send it back to the user's chat in Telegram."
        },
        "typeVersion": 1
      },
      {
        "id": "e7ffd4c6-d725-4ac0-8aa9-09f52d9a1cb4",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          520,
          -20
        ],
        "parameters": {
          "text": "={{ $json.body.prompt }}",
          "options": {
            "systemMessage": "You are well-versed on Dmitry Paranyushkin's books through the tools you have access to. When you receive a user's query, assess which tools you have access to, decide on the tools to access (minimum 1, maximum 3), modify the query to better suit each tool's context, and send the request to the tool. \n\nIMPORTANT: Always access at least one of the tools and use the response to get the best possible answer.\n\nWhen you're generating a response, combine perspectives where they fit and point out discrepancies when they exist."
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "6b1bff98-cdac-4a80-a5e5-a89def6a767b",
        "name": "Waves into Patterns Book Expert",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          1120,
          300
        ],
        "parameters": {
          "url": "https://infranodus.com/api/v1/graphAndAdvice?doNotSave=true&addStats=true&optimize=develop&includeGraph=false&includeGraphSummary=true&includeStatements=true",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "name",
                "value": "waves_into_patterns"
              },
              {
                "name": "prompt",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters1_Value', `User's request adjusted to suit this context`, 'string') }}"
              },
              {
                "name": "requestMode",
                "value": "response"
              },
              {
                "name": "aiTopics",
                "value": "true"
              }
            ]
          },
          "genericAuthType": "httpBearerAuth",
          "toolDescription": "Make a request to The Waves into Patterns book which is well-versed in the questions of natural cycles, variability, fractal states, dynamics, and nonequilibrium stability. Including the following topics:\n\n<MainTopics>: \n1. System Influence: scale influence multiple \n2. Pattern Dynamics: pattern variability fractal \n3. Change Balance: dynamic wave time \n4. Center Transformation: center cycle dominant \n5. Growth Stages: growth exploration period \n6. Long Strategy: term state long \n7. Seasonal Relations: moon summer natural \n8. Flow Connection: exist breaking exploring \n</MainTopics>"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "kg0rA5r8siL8LbrU",
            "name": "InfraNodus Circadian API Key"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "d8df1709-8c55-4336-8dde-5fa8769c3a91",
        "name": "Special Agent's Manual Book Expert",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          900,
          300
        ],
        "parameters": {
          "url": "https://infranodus.com/api/v1/graphAndAdvice?doNotSave=true&addStats=true&optimize=develop&includeGraph=false&includeGraphSummary=true&includeStatements=true",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "name",
                "value": "special_agents_manual"
              },
              {
                "name": "prompt",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters1_Value', `User's request adjusted to suit this context`, 'string') }}"
              },
              {
                "name": "requestMode",
                "value": "response"
              },
              {
                "name": "aiTopics",
                "value": "true"
              }
            ]
          },
          "genericAuthType": "httpBearerAuth",
          "toolDescription": "Make a request to The Special Agent's Manual book which is well-versed in the questions of human agency, speciality, infiltration and tension dynamics, strategies, identities, finding the special in you as well as the following topics:\n\n<MainTopics>: \n1. Agent Activation: agent special activation \n2. System Dynamics: system body operating \n3. Order Flow: action time order \n4. Creative Process: create identity entity \n5. Movement Patterns: movement wave breathing \n6. Incoming Impact: incoming impulse impact \n7. Fiction Venture: fiction high risk \n8. Social Framework: preset possibility level \n</MainTopics>"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "kg0rA5r8siL8LbrU",
            "name": "InfraNodus Circadian API Key"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "85a11f6a-c154-43ea-a294-3fe367d13ad0",
        "name": "The Flow and the Notion Book",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          1340,
          300
        ],
        "parameters": {
          "url": "https://infranodus.com/api/v1/graphAndAdvice?doNotSave=true&addStats=true&optimize=develop&includeGraph=false&includeGraphSummary=true&includeStatements=true",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "name",
                "value": "the_flow_and_notion"
              },
              {
                "name": "prompt",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters1_Value', `User's request adjusted to suit this context`, 'string') }}"
              },
              {
                "name": "requestMode",
                "value": "response"
              },
              {
                "name": "aiTopics",
                "value": "true"
              }
            ]
          },
          "genericAuthType": "httpBearerAuth",
          "toolDescription": "The Flow and the Notion book which is well-versed in the questions of creating with someone, dreaming, making new shapes, dissipating ideas, art, and life. Including the following topics:\n\n<MainTopics>: \n1. Shape Dynamics: shape outline concentric \n2. Time Alignment: long practice time \n3. Man's Journey: bow man candle \n4. Notion Flow: image flow paranyushkin \n5. Essence Realization: process essence essential \n6. Life Choices: slave thing trace \n7. Wave Patterns: found light movement \n8. Synchrony Mediation: book circadian word \n9. Complete Vision: multiple synchrony mediate \n10. Instruction Guide: full \ninstruction foreword : instruction foreword \n</MainTopics>"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "kg0rA5r8siL8LbrU",
            "name": "InfraNodus Circadian API Key"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "90c32931-3e1c-4c93-8cbb-7c8e7dfa2269",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1500,
          260
        ],
        "parameters": {
          "width": 200,
          "height": 640,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Expert #4\n\nYou can add more experts here. Just make to give them descriptive names, so the agent knows which one to connect to when it has a question. \n\n![infranodus graph](https://i.ibb.co/hRqxn8JN/circadian-conversation-book.png)"
        },
        "typeVersion": 1
      },
      {
        "id": "d392f193-328d-46b5-bd85-a6db97ca0a58",
        "name": "The Polysingularity Letters Book",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          1540,
          300
        ],
        "parameters": {
          "url": "https://infranodus.com/api/v1/graphAndAdvice?doNotSave=true&addStats=true&optimize=develop&includeGraph=false&includeGraphSummary=true&includeStatements=true",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "name",
                "value": "polysingularity_letters"
              },
              {
                "name": "prompt",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters1_Value', `User's request adjusted to suit this context`, 'string') }}"
              },
              {
                "name": "requestMode",
                "value": "response"
              },
              {
                "name": "aiTopics",
                "value": "true"
              }
            ]
          },
          "genericAuthType": "httpBearerAuth",
          "toolDescription": "The Polysingularity Letters book which is well-versed in the questions of polysingularity, multiplicity, networks, networking, art, and creative approach. And also these topics:\n\n<MainTopics>: \n1. Community Dynamics: network community connected \n2. Global Equilibrium: state global change \n3. Polysingular Practice: polysingularity thinking exist \n4. Temporal Relations: time moment thing \n5. Consciousness Source: social cognition view \n6. Meaning Creation: make orthodox meaning \n7. Dmitry Connections: post dmitry minute \n8. Linguistic Variations: wa √´ ww \n</MainTopics>"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "6lSuuSDajZrvI2GM",
            "name": "InfraNodus API Key"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "56f27d69-5091-4a0e-abc9-49fea9a863b3",
        "name": "Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          60,
          60
        ],
        "webhookId": "171bf9a6-1390-4195-bd6b-ff3df2e27d1c",
        "parameters": {
          "path": "171bf9a6-1390-4195-bd6b-ff3df2e27d1c",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "8b7a6506-4220-476e-8d94-fa62315ab807",
        "name": "Respond to Webhook",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          1060,
          -20
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "0ac0d3d2-75b9-4173-a45a-56a0fe55892d",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -820,
          680
        ],
        "parameters": {
          "color": 3,
          "width": 1060,
          "height": 980,
          "content": "## Setting up ElevenLabs Conversational AI Agent\n\n### You will need to connect the Webhook trigger above to the Conversational AI agent of ElevenLabs. Then you can use their agent (and website widget) to converse with the experts in this workflow. Read the full tutorial at [ElevenLabs AI voice agent setup guide](https://support.noduslabs.com/hc/en-us/articles/20318967066396-How-to-Build-a-Text-Voice-AI-Agent-Chatbot-with-n8n-Elevenlabs-and-InfraNodus)\n\n1. Create an account at [https://elevenlabs.io/](https://elevenlabs.io/)\n\n2. Go to the **Conversational AI** section in the menu\n\n3. Go to **Agent > Create New Agent > Use Blank Template**\n\n4. In the **System Prompt** of the agent put the following text modified to relate to your content:\n\n```\nYou are well-versed on ... through the tools you have access to.\n1) When you receive a user's message, first answer something like \"I am consulting my knowledge and will respond soon\" or \"let me think about it and i'll get back to you\" or any other similar in meaning phrase\n2) Then forward the user's message, without any changes, to the knowledge_base tool.\n3) When you receive a response from the knowledge_base use this answer to respond to the user, use exactly the answer you received to respond.\nIMPORTANT: make the response more suitable for the conversational format making it more succint and shorter but maintaining all the specifics.\n```\n\n5. IMPORTANT: keep the reference to the `knowledge_base` tool above to let the ElevenLabs agent know that it's exactly that tool it needs to be using to access the knowledge. Replace `...` with your content. \n\n6. In the **Tools section** of the Agent's setup, click **Create a new tool**\n\n7. The name of the tool should be: **`knowledge_base`** (as you're referring to it in the system prompt)\n\n8. In the tool's description put in: \"A knowledge base on ....\" (replace ... with your topic)\n\n9. Choose the **POST method** and in the URL put the Webhook link from the n8n workflow you created in the Step 3 above. E.g. https://infranodus.app.n8n.cloud/webhook/your_hook_url\n\n10. Scroll to the **Body Parameters** and add the following parameters that will be submitted with the POST request:\n\na.  Identifier: `prompt`, Value type: LLM prompt, Description: The user's message. \n*You will use this value in the **AI Agent** node.*\n\nb. Identifier: `sessionId`, Value type: Dynamic variable, Variable name: system__conversation_id\n*You will use this in the **Chat Memory** node to keep the history of the interaction.*\n\n10. Save the tool, save the agent\n\n11. Run the test in ElevenLabs\n\n12. Check the n8n workflow logs (from Step 3) to see if the execution went well "
        },
        "typeVersion": 1
      },
      {
        "id": "2f279f0d-fdd2-493a-b416-6c70ab06b31a",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -820,
          -360
        ],
        "parameters": {
          "color": 5,
          "width": 740,
          "height": 980,
          "content": "# AI Voice Agent that Chats to Your Experts (e.g. Books, Articles, etc)\n\n## Uses InfraNodus Knowledge Graphs as Experts (AI Agent tools)\n\n## Uses ElevenLabs for voice chat functionality\n\n## Uses an orchestrating AI Agent in n8n to choose the expert based on the query\n\n[Detailed tutorial](https://support.noduslabs.com/hc/en-us/articles/20318967066396-How-to-Build-a-Text-Voice-AI-Agent-Chatbot-with-n8n-Elevenlabs-and-InfraNodus)\n\n[Video Tutorial](https://www.youtube.com/watch?v=07-HZZQs5h0)\n\n\n[![Video tutorial](https://img.youtube.com/vi/07-HZZQs5h0/sddefault.jpg)](https://www.youtube.com/watch?v=07-HZZQs5h0)"
        },
        "typeVersion": 1
      },
      {
        "id": "49d05baa-50fe-4931-87f8-22726eb868fa",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          400,
          340
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-flash-preview-04-17"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "ivswOFTY8MYDbj5b",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "3ffc401d-df30-44ad-a3c3-b6b3ee75f59f",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          340,
          260
        ],
        "parameters": {
          "width": 200,
          "height": 660,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## LLM to Use\n\nGoogle Flash Pro models are much faster than OpenAI. However, OpenAI can be more precise in function (expert) calling."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "9dd619b8-9071-4d7d-8b5a-fb30b570671f",
    "connections": {
      "Webhook": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Respond to Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Model": {
        "ai_languageModel": [
          []
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "The Flow and the Notion Book": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Waves into Patterns Book Expert": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "The Polysingularity Letters Book": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Special Agent's Manual Book Expert": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "sgcKe5gsmJFdEAe3",
    "meta": {
      "instanceId": "be3e0177f1eeda5879f300082f54531dfa9819a5d7441e94ea64b32f8b1fd49c",
      "templateCredsSetupCompleted": true
    },
    "name": "ai-trend-email-alerter-weaviate",
    "tags": [],
    "nodes": [
      {
        "id": "d36fdcbc-4add-46b5-a440-af07d1b81d56",
        "name": "Weaviate Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreWeaviate",
        "position": [
          3440,
          752
        ],
        "parameters": {
          "mode": "insert",
          "options": {
            "textKey": "summary"
          },
          "weaviateCollection": {
            "__rl": true,
            "mode": "id",
            "value": "ArxivArticles"
          }
        },
        "credentials": {
          "weaviateApi": {
            "id": "qiTSL6FfsPCZLyUv",
            "name": "Weaviate Credentials account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "04f15082-cb14-46b2-8e92-e2926e7de128",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          3440,
          1072
        ],
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "arxiv_id",
                  "value": "={{ $('Remove Fields').item.json.id }}"
                },
                {
                  "name": "published",
                  "value": "={{ $('Remove Fields').item.json.published }}"
                },
                {
                  "name": "author",
                  "value": "={{ $('Remove Fields').item.json.author }}"
                },
                {
                  "name": "title",
                  "value": "={{ $('Remove Fields').item.json.title }}"
                },
                {
                  "name": "category",
                  "value": "={{ $('Remove Fields').item.json.category }}"
                },
                {
                  "name": "primary_topic",
                  "value": "={{ $('Remove Fields').item.json.primary_topic }}"
                },
                {
                  "name": "=secondary_topics",
                  "value": "={{ $('Remove Fields').item.json.secondary_topics }}"
                },
                {
                  "name": "potential_impact",
                  "value": "={{ $('Remove Fields').item.json.potential_impact }}"
                }
              ]
            }
          },
          "jsonData": "={{ $('Remove Fields').item.json.summary }}",
          "jsonMode": "expressionData"
        },
        "typeVersion": 1
      },
      {
        "id": "ff6e5918-4b72-4902-828b-aa6e39fdd378",
        "name": "Query arXiv",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          528,
          752
        ],
        "parameters": {
          "url": "=https://export.arxiv.org/api/query?search_query=cat:cs.LG+OR+cat:stat.ML&sortBy=submittedDate&sortOrder=descending&start=0&max_results=10&last_update_date_from={{ $('Date & Time').item.json.startDate.toDateTime().toFormat(\"yyyyMMdd\") }}\n",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "33c6d11a-6b27-4297-8fe5-08260f474871",
        "name": "Convert XML to JSON",
        "type": "n8n-nodes-base.xml",
        "position": [
          832,
          752
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "fe135a0c-1976-444f-bd65-9d26d6e969ef",
        "name": "Remove Duplicates",
        "type": "n8n-nodes-base.removeDuplicates",
        "position": [
          1424,
          752
        ],
        "parameters": {
          "compare": "={{ $json.id }}",
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "1082f1b2-94de-4ea5-83a6-83242d065233",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          976,
          2368
        ],
        "parameters": {
          "sessionKey": "sessionId",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "780950ec-78b6-4c84-814c-03c3c6881b2c",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          3328,
          1072
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "v6dOwJXW6XXHxHQw",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "119e0896-430f-4019-8fe6-8677cd0e9289",
        "name": "OpenRouter Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          816,
          2368
        ],
        "parameters": {
          "model": "anthropic/claude-3.7-sonnet",
          "options": {
            "temperature": 2
          }
        },
        "credentials": {
          "openRouterApi": {
            "id": "V30JHJHSU29vq3Zj",
            "name": "OpenRouter account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "0270ad87-f27a-491a-bb95-7983cb1b4d80",
        "name": "Weaviate Vector Store1",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreWeaviate",
        "position": [
          80,
          2288
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {},
          "toolName": "ArxivPapers",
          "toolDescription": "This tool allows you to query the Weaviate Vector Store1 to retrieve arXiv article titles, summary and other metadata to be used as the sole data source performing a trend analysis. You must query the database to get information for the trend analysis.",
          "weaviateCollection": {
            "__rl": true,
            "mode": "id",
            "value": "ArxivArticles"
          }
        },
        "credentials": {
          "weaviateApi": {
            "id": "qiTSL6FfsPCZLyUv",
            "name": "Weaviate Credentials account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "780c692e-3444-4293-aeee-70241d151011",
        "name": "Embeddings OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          64,
          2432
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "v6dOwJXW6XXHxHQw",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "798c5bdc-f46a-45d2-8692-8875efd9cb6e",
        "name": "Date & Time",
        "type": "n8n-nodes-base.dateTime",
        "position": [
          240,
          752
        ],
        "parameters": {
          "options": {},
          "duration": 7,
          "magnitude": "={{ $json.currentDate }}",
          "operation": "subtractFromDate",
          "outputFieldName": "startDate"
        },
        "typeVersion": 2
      },
      {
        "id": "56d6ff4b-3ae0-4450-b899-9773e83ce896",
        "name": "Markdown",
        "type": "n8n-nodes-base.markdown",
        "position": [
          1088,
          1584
        ],
        "parameters": {
          "mode": "markdownToHtml",
          "options": {
            "simplifiedAutoLink": true
          },
          "markdown": "={{ $json.output.body }}",
          "destinationKey": "=data"
        },
        "typeVersion": 1
      },
      {
        "id": "d62c633e-d6d2-4d0e-9645-a909ae4a0efa",
        "name": "Recursive Character Text Splitter1",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          3552,
          1184
        ],
        "parameters": {
          "options": {},
          "chunkSize": 2000
        },
        "typeVersion": 1
      },
      {
        "id": "c2040ff2-808d-4f6e-8682-06f2aad3cf8b",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1136,
          2368
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"subject\":\"...\",\n  \"body\":\"...\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "5d07a9fd-ff2a-4536-aa13-171e4eeeac42",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -128,
          752
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "daysInterval": 7
              },
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "913e8a25-32af-4c2c-943c-58ab2563accd",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          560
        ],
        "parameters": {
          "color": 5,
          "width": 380,
          "height": 340,
          "content": "## 1. Specify date range for weekly automation\n1. Calculate today's date\n2. Calculate dates for the last week based on today"
        },
        "typeVersion": 1
      },
      {
        "id": "704752b7-75cf-40d8-9b31-fc8e43ab18b2",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          560
        ],
        "parameters": {
          "color": 5,
          "width": 360,
          "height": 452,
          "content": "## 2. Fetch weekly articles from arXiv.\nFetch ML article abstracts by querying the free arXiv API.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe number of maximum papers returned is set by default to 200. You can change this by editing `max_results` in the query node."
        },
        "typeVersion": 1
      },
      {
        "id": "9529c98c-a28c-4512-a076-9e304d82125a",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          784,
          560
        ],
        "parameters": {
          "color": 5,
          "width": 820,
          "height": 420,
          "content": "## 3. Pre-process data\n1. Convert XML response to JSON.\n2. Split results by article ID.\n3. Format data for Weaviate.\n4. Remove any duplicates, if they exist.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSpecifically, we are merging fields that have multiple entries, like `author`, and `category` into an Array of strings and adding datetime formatting to the publication date."
        },
        "typeVersion": 1
      },
      {
        "id": "57c8762e-5afd-4a9c-b3d0-61fbd863bc36",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3104,
          560
        ],
        "parameters": {
          "color": 5,
          "width": 840,
          "height": 380,
          "content": "## 6. Create a new Weaviate collection in existing cloud cluster\n1. Connect to your Weaviate Cloud or local credentials.\n2. Set `Operation Mode` to `Insert Documents`.\n3. To insert new data into a **new** `Weaviate Collection`, select `By ID` and give your collection a name in SnakeCase format.\n4. To insert data into an **existing** `Weaviate Collection`, select `From List` and choose your existing collection from the drop down menu.\n\n\n    \n\n\n\n\n\n\n\n\n\n5. Under `Options`, click `Add Option` and select `Text Key`. This is the field for which embeddings will be generated. In this example, we are embedding the `summary` field in our data, as this is the abstract text for the articles."
        },
        "typeVersion": 1
      },
      {
        "id": "b0e70958-64a7-4b5f-ae7e-e6350757eb49",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3264,
          960
        ],
        "parameters": {
          "color": 5,
          "width": 560,
          "height": 580,
          "content": "## 7. Configure components for embeddings\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n__Embeddings Node__\n1. Select your embedding provider and model connect it to your credentials.\n  \n__Data Loader__\n2. The `Type of Data` we're loading is `JSON`.\n3. If you are including metadata (we are), set `Mode` to `Load Specific Data`.\n4. The `Data` field represents the data we want to generate embeddings for.\n5. Under `Options` we define our metadata schema.\n\n__Text Splitter__\n6. We're using the Recursive Character Text Splitter and setting our `Chunk Size` to `2000` to get one chunk per abstract (but feel free to experiment!)"
        },
        "typeVersion": 1
      },
      {
        "id": "3b505c27-caa0-4f25-8121-90d39b9a63b3",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3968,
          560
        ],
        "parameters": {
          "color": 5,
          "width": 700,
          "height": 340,
          "content": "## 8. Confirm that articles have been uploaded.\nThese steps serve as verification that the new weekly articles have been successfully uploaded into Weaviate before proceeding to run the AI Agent node. The list of articles will generate a static `session_id` that serves as that verification.\n1. Get a list of all the arXiv ID's just uploaded into Weaviate.\n2. Generate a static `session_id` that will serve as a trigger for the AI Agent node."
        },
        "typeVersion": 1
      },
      {
        "id": "64098a08-06fd-4981-9d46-6efe61e01f81",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          32,
          1392
        ],
        "parameters": {
          "color": 6,
          "width": 660,
          "height": 500,
          "content": "## 1. Configure the AI Agent node with Weaviate as a _TOOL_\n1. Set  `Source for Prompt (User Message)` to `Define below`.\n2. In `Prompt (User Message)`, give a short explanation of the retrieval and analysis tasks to be performed.\n3. Under `Options`, click `Add Option` to add the `System Message`, also known as the system prompt. Provide specific instructions for the agent, including:\n\n\n\n\n\n\n\n\n\n\n\n\n\n* Instructions to query the Weaviate vector store\n* Explanation and schema of data in Weaviate\n* Instructions on how to determine trends\n* Specified output format\n* Example of real output\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "24a428b0-8ee2-4e0d-9c36-c0934bcc13d3",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          32,
          1920
        ],
        "parameters": {
          "color": 6,
          "width": 500,
          "height": 640,
          "content": "## 3. Configure Weaviate Vector Store\n1. Select the same credentials (cloud or local) to connect with as earlier.\n2. Set `Operation Mode` to `Retrieve Documents as Tool for AI Agent`.\n3. Add a `Description` to the tool that tells the LLM how to use the Weaviate vector store. **This description is very important! A poor tool description can result in the agent not using the tool. A good description includes, what the tools allows the agent to do and what the agent should do with the tool. You can be forceful in your tone, here.**\n4. Connect to existing vector store by selecting `By ID` and type in the same collection name as above: `ArxivArticles`.\n5. Turn on `Include Metadata`, as publication dates, titles, and arXiv URLs are all critical to the agent's response.\n6. Select OpenAI as the embedding provider for the query."
        },
        "typeVersion": 1
      },
      {
        "id": "3af4b9b8-5929-4bff-af3f-7a200d29ea34",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          544,
          1920
        ],
        "parameters": {
          "color": 6,
          "width": 744,
          "height": 640,
          "content": "## 4. Add model, memory, and output parser\n1. We're using the OpenRouter Chat Model node so that we can use Google Gemini for the agent.\n2. Add simple (short-term) memory to the agent, setting `Session ID` to `Define Below` and `Key` to `sessionId` (which is our static session ID because we are only using short-term memory and not storing the agent output for future use.\n3. Add the `Structured Output Parser` node and set `Schema Type` to `Generate from JSON Example`.\n4. In `JSON Example`, we define the format of the output for the agent, which will be a subject line and body text for the resulting summary email we want to generate:\n\n```\n{\n  \"subject\": \"...\",\n  \"body\": \"...\"\n}\n```"
        },
        "typeVersion": 1
      },
      {
        "id": "bc738a22-4e2d-4710-88ee-1186bb29b759",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          704,
          1392
        ],
        "parameters": {
          "color": 6,
          "width": 600,
          "height": 400,
          "content": "## 2. Post-process agent response\n1. Use the `Edit Fields` node to add an expression that replaces \"\\n\\n\" in the agent's response with actual page breaks (so that it can be properly parsed as markdown text).\n2. Add the `Markdown to HTML` node to convert the body text of the email to HTML. \n3. We give the output a name in `Destination Key`.\n4. Add the option for `Automatic Linking to URLs`."
        },
        "typeVersion": 1
      },
      {
        "id": "afc29ee4-c944-4c49-abef-6356a84975f9",
        "name": "Sticky Note17",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1328,
          1392
        ],
        "parameters": {
          "color": 6,
          "width": 520,
          "height": 400,
          "content": "## 5. Send the output as an email!\n1. Select your `STMP Account` credential.\n2. Set the `Subject` equal to the subject key `{{ $json.output.subject }}`.\n3. Set `Email Format` to `HTML`.\n4. Set `HTML` to `{{ $json.data }}` (the post-processed body text)."
        },
        "typeVersion": 1
      },
      {
        "id": "fc89c7eb-a1b2-4692-aed4-b075cbb6793b",
        "name": "Sticky Note18",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          400
        ],
        "parameters": {
          "color": 5,
          "width": 1600,
          "height": 140,
          "content": "# Part 1: Fetch, clean, enrich and insert arXiv abstracts into Weaviate\nIn the first part of this workflow, we activate a `Schedule Trigger` to fetch AI and ML abstracts (along with their metadata like article title, authors, publication date, etc.) on a weekly basis. We clean the data and then enrich it with a LLM that will predict label it with topic categories and predict each article's potential impact in the field. Finally, we upload the enriched and cleaned data into a Weaviate collection and verify that the data has been uploaded."
        },
        "typeVersion": 1
      },
      {
        "id": "1f244dc1-f564-4a01-b582-49484c3e7d63",
        "name": "Sticky Note19",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          32,
          1232
        ],
        "parameters": {
          "color": 6,
          "width": 1580,
          "height": 140,
          "content": "# Part 2: Use agentic RAG to identify research trends and send them in an email\nIn this part of the workflow, we configure an AI Agent node to work with Weaviate as a tool. The entire embedded collection of embedded article abstracts, along with their metadata, are at the disposal of the agent. We instruct the agent to use Weaviate as a tool, describe available input data, and give directions for how to identify trends and structure the summary email. We clean up the data and then send it off via email."
        },
        "typeVersion": 1
      },
      {
        "id": "75d64ce1-57c6-4b0f-80e4-66dbe8488397",
        "name": "OpenRouter Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          1952,
          1088
        ],
        "parameters": {
          "model": "anthropic/claude-3.7-sonnet",
          "options": {}
        },
        "credentials": {
          "openRouterApi": {
            "id": "V30JHJHSU29vq3Zj",
            "name": "OpenRouter account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "901c7f80-f856-4d90-8046-8b6fe2e45056",
        "name": "Structured Output Parser1",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2224,
          1088
        ],
        "parameters": {
          "autoFix": true,
          "jsonSchemaExample": "{\n\t\"primary_category\": \"LLM Fine-tuning\",\n\t\"secondary_categories\": [\"Parameter-Efficient Fine-tuning (PEFT)\", \"Data-centric AI\"],\n    \"potential_impact\": 1\n}"
        },
        "typeVersion": 1.3
      },
      {
        "id": "dbea7aee-5dae-457e-8b5c-343d18188fb0",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          2704,
          752
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3.2
      },
      {
        "id": "5df76f3f-0a71-4999-a85f-375c680fe073",
        "name": "OpenRouter Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          2288,
          1232
        ],
        "parameters": {
          "model": "anthropic/claude-3.7-sonnet",
          "options": {}
        },
        "credentials": {
          "openRouterApi": {
            "id": "V30JHJHSU29vq3Zj",
            "name": "OpenRouter account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "0bfa6914-5450-494a-9c1b-cccd58ae4d4c",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1632,
          560
        ],
        "parameters": {
          "color": 5,
          "width": 980,
          "height": 460,
          "content": "## 4. Enrich arXiv articles with topic classifications and potential impact predictions \n1. Set  `Source for Prompt (User Message)` to `Define below`.\n2. In `Prompt (User Message)`, give a short explanation of the classification task and point the agent towards the article title and abstract and fields.\n3. Under `Options`, click `Add Option` to add the `System Message`, also known as the system prompt. Enter specific instructions for making the classifications, including defining our categories:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n * `primary_category`: (string) The single most relevant primary category for the paper out of a list of pre-defined topics.\n * `secondary_categories`: (array of strings) Up to two additional relevant secondary categories.\n * `potential_impact`: (integer) An integer score from 1 to 5 representing how impactful the research conclusions may be in the field at large.\n* Make sure that `Require Specific Output Format` is enabled."
        },
        "typeVersion": 1
      },
      {
        "id": "aab2d979-238c-450d-9d3f-0ff085f90730",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1920,
          1040
        ],
        "parameters": {
          "color": 5,
          "width": 592,
          "height": 380,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nChoose your models for the agent and structured output parser (we use `claude-3.7-sonnet`)."
        },
        "typeVersion": 1
      },
      {
        "id": "dade3fcb-63c5-4c34-8287-9270a7758960",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2624,
          560
        ],
        "parameters": {
          "color": 5,
          "width": 460,
          "height": 340,
          "content": "## 5. Post-process enriched data\n1. Merge the output from AI agent with the existing article data.\n2. Get rid of the redundant `\"output\"` field in the JSON."
        },
        "typeVersion": 1
      },
      {
        "id": "7e3b842d-aba8-41a8-95ec-94917017998d",
        "name": "Get Current Date",
        "type": "n8n-nodes-base.dateTime",
        "position": [
          48,
          752
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "1356f9bc-87eb-4f69-871c-0bdc1591e2c9",
        "name": "Split Results",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1024,
          752
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "feed.entry"
        },
        "typeVersion": 1
      },
      {
        "id": "6f37e9bb-e5c0-493a-905d-87b55b874f49",
        "name": "Prep Data for Weaviate",
        "type": "n8n-nodes-base.set",
        "position": [
          1232,
          752
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "428846a4-8555-48cc-aded-bb0beb5fb123",
                "name": "id",
                "type": "string",
                "value": "={{ $json.id }}"
              },
              {
                "id": "40614d42-547f-48d6-8fde-4d94b7a4963c",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              },
              {
                "id": "1bcd0610-3a4a-4ee8-aa78-673319282cf5",
                "name": "summary",
                "type": "string",
                "value": "={{ $json.summary }}"
              },
              {
                "id": "d49b5557-9379-4132-b2c4-cf155aca7428",
                "name": "author",
                "type": "string",
                "value": "={{\n  Array.isArray($json.author)\n    ? $json.author.map(author => author.name)\n    : ($json.author && $json.author.name ? [$json.author.name] : [])\n}}"
              },
              {
                "id": "ed8d5a76-bc40-4fa7-9f19-61f2a3429f1d",
                "name": "published",
                "type": "string",
                "value": "={{ new Date($json.published).toISOString() }}"
              },
              {
                "id": "6e6fbfb5-d2bb-474f-9885-d65438c8b271",
                "name": "category",
                "type": "string",
                "value": "={{   Array.isArray($json.category)     ? $json.category.map(category => category.term)     : ($json.category && $json.category.term ? [$json.category.term] : []) }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "69af1ed4-0a73-4179-aff2-d78253e7921a",
        "name": "Enrich Articles with Topic Classification",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "onError": "continueErrorOutput",
        "position": [
          1984,
          752
        ],
        "parameters": {
          "text": "=Classify the following arXiv papers:\n\n```json\nTitle: {{ $json.title }}\nAbstract: {{ $json.summary }}",
          "options": {
            "systemMessage": "=You are an expert AI agent designed to classify academic research papers. Your task is to analyze the provided arXiv paper data and categorize it based on its content.\n\nInput Data Schema:\nThe input data will be a JSON object with the following structure:\n\n{\n  \"title\": \"string\",\n  \"summary\": \"string\"\n}\n\nYou MUST respond with a JSON object containing the following fields:\n\n\"primary_category\": (string) The single most relevant primary category for the paper. You MUST choose one category from the following predefined list. Do NOT use any category not on this list.\n\n\"secondary_categories\": (array of strings) Up to two additional relevant secondary categories. These are optional; if no secondary categories apply, provide an empty array []. If chosen, they MUST also be from the predefined list.\n\n\"potential_impact\": (integer) An integer score from 1 to 5, judging the paper's potential impact based on these criteria:\n\n1: Papers with no new existing information or limited results.\n\n2: Papers with minor incremental contributions or limited novelty.\n\n3: Papers with solid contributions, good results, and clear utility, but not groundbreaking.\n\n4: Papers with significant advancements, novel approaches, or strong potential to influence the field.\n\n5: Papers that are potential game-changers, representing paradigm shifts, or opening entirely new research directions.\n\nPredefined Categories and Definitions:\n\nFoundation Models: Models trained on broad data at scale, designed to be adaptable to a wide range of downstream tasks (e.g., large language models, large vision models, multi-modal models).\n\nLLM Fine-tuning: Techniques and methodologies for adapting pre-trained Large Language Models (LLMs) to specific tasks or datasets.\n\nParameter-Efficient Fine-tuning (PEFT): Methods that enable efficient adaptation of large pre-trained models to new tasks with minimal computational cost, by updating only a small subset of parameters (e.g., LoRA, Prompt Tuning).\n\nRetrieval-Augmented Generation (RAG): Architectures or systems that combine generative models (like LLMs) with information retrieval mechanisms to enhance the factual accuracy and relevance of generated outputs by referencing external knowledge bases.\n\nModel Quantization: Techniques for reducing the precision of model parameters (e.g., from float32 to int8) to decrease model size, memory footprint, and computational requirements, often for efficient deployment on edge devices.\n\nAgentic AI / AI Agents: Systems designed for autonomous decision-making, planning, and action in dynamic environments, often involving reasoning, memory, and tool use.\n\nMultimodality: Models capable of processing, understanding, and generating content across multiple data types or modalities (e.g., text and images, audio and video).\n\nReinforcement Learning: A paradigm where an agent learns to make decisions by performing actions in an environment to maximize a cumulative reward, often through trial and error.\n\nComputer Vision (Specific Techniques): Papers focusing on particular computer vision tasks or methodologies that are not primarily about foundation models (e.g., 3D reconstruction, object detection, image segmentation, pose estimation).\n\nNatural Language Processing (Specific Techniques): Papers focusing on particular NLP tasks or methodologies that are not primarily about foundation models or LLM fine-tuning (e.g., text summarization, machine translation, sentiment analysis, named entity recognition).\n\nEthical AI / AI Safety: Research addressing the societal implications of AI, including fairness, bias detection and mitigation, interpretability, transparency, privacy, and alignment with human values.\n\nEfficient AI / AI Optimization: Techniques aimed at improving the computational efficiency, speed, or resource usage of AI models beyond just quantization, including architecture search, inference optimization, and hardware-aware design.\n\nData-centric AI: Approaches that prioritize improving the quality, quantity, and organization of data used to train AI models, rather than solely focusing on model architecture improvements.\n\nOther: A catch-all category for articles that don't fall into one of the classes mentioned above.\n\nFocus solely on the content of the paper's title, summary, and categories to make your classification. Do NOT include any conversational text or explanations in your response, only the JSON object."
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "36068ba8-4e86-403c-b6a6-7fe55af58a95",
        "name": "Remove Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          2912,
          752
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "bd542bdd-d919-4688-a34d-395dd003e832",
                "name": "id",
                "type": "string",
                "value": "={{ $json.id }}"
              },
              {
                "id": "714d07a2-0c05-4d12-bba4-b37ca21c6521",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              },
              {
                "id": "ec2e4ccb-70ec-4d12-8d5b-8b5359b93315",
                "name": "summary",
                "type": "string",
                "value": "={{ $json.summary }}"
              },
              {
                "id": "acae59b4-d167-42e5-8f07-f799d2cefcdf",
                "name": "author",
                "type": "string",
                "value": "={{ $json.author }}"
              },
              {
                "id": "0b74d264-c314-4522-9e7e-37d6a13e4247",
                "name": "published",
                "type": "string",
                "value": "={{ $json.published }}"
              },
              {
                "id": "e6f4a0a9-8b6c-47ab-9abb-29d530c21f2c",
                "name": "category",
                "type": "string",
                "value": "={{ $json.category }}"
              },
              {
                "id": "a808ca6a-6847-4730-a0ed-2b1dbdb5ad8a",
                "name": "primary_topic",
                "type": "string",
                "value": "={{ $json.output.primary_category }}"
              },
              {
                "id": "4f82732d-4f67-4047-bd67-6c00dd1c9a80",
                "name": "secondary_topics",
                "type": "string",
                "value": "={{ $json.output.secondary_categories }}"
              },
              {
                "id": "322c2946-8a90-451a-b484-bc1da68fb178",
                "name": "potential_impact",
                "type": "number",
                "value": "={{ parseFloat($json.output.potential_impact) }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "af99113b-8804-47bf-a74d-2265f63b97e1",
        "name": "Aggregate Uploaded arXiv IDs",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          4112,
          752
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "metadata.arxiv_id"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "92511b85-b11d-4fd7-9985-326051db472a",
        "name": "Add Static sessionId",
        "type": "n8n-nodes-base.set",
        "position": [
          4400,
          752
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "dea40507-a706-4792-b0b4-673d655ec877",
                "name": "sessionId",
                "type": "string",
                "value": "static_id"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "f7e31525-1ac9-4adc-b4c6-9159e1b96e6e",
        "name": "Agentic RAG for Trend Analysis",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          48,
          1584
        ],
        "parameters": {
          "text": "=Please provide a summarized trend analysis using the articles stored in the Weaviate vector store.",
          "options": {
            "systemMessage": "=**CRITICAL: YOUR FINAL RESPONSE MUST CONTAIN ABSOLUTELY NO MARKDOWN CODE FENCES (```JSON) OR ANY OTHER TEXT OUTSIDE THE PURE JSON OBJECT. IMMEDIATELY PROVIDE THE JSON.**\n\nYou are an expert AI and Machine Learning research analyst, specifically tasked with synthesizing weekly trends from arXiv publications. Your goal is to generate a concise, approachable, and easy-to-read email summary for a general audience interested in the latest developments in AI and ML. You must use the Weaviate Vector Store1 and perform a proper vector search to retrieve the data. If you were unable to retrieve data, please repeatedly try again until you can. Do not hallucinate, do not make anything up, do not rely on your memory.\n\n**Input Data:**\nYou will receive an array of JSON objects, where each object represents a single AI/ML article published on arXiv in the last week. You MUST analyze this entire collection of articles to identify key trends and notable research. Each article object has the following fields:\n- `arxiv_id`: The FULL arXiv URL of the article. (e.g. \"http://arxiv.org/abs/2507.02863v1\")\n- `title`: The title of the article.\n- `main_findings`: The main findings of the paper.\n- `primary_topic`: The primary topic assigned to the article (e.g., \"Language Model Evaluation\").\n- `secondary_topics`: A list of secondary topics assigned to the article (e.g., [\"Generative AI\", \"Natural Language Processing\"]).\n- `paper_quality`: A numerical score from 1 (very poor) to 5 (excellent quality), representing the predicted research quality.\n- `potential_impact`: A numerical score from 1 (not important) to 5 (potential paradigm shift, huge game-changer), representing the predicted impact on the field.\n\nYou will also recieve an array of JSONs with article counts by primary topic. Incorporate this into your trend anaylsis by focusing on topics with the most number of publications. Use this to guide the rest of the analysis\n\n**Trend Identification and Selection Rules:**\n- **Get article counts by `primary_topic`:** First, perform an aggregate query in the Weaviate vector store to get the counts of articles published by `primary_topic`. Use these counts to inform the rest of your analysis, focusing on the most-published topics. \n- **Identify Key Trends:** Group papers by `primary_topic` and `secondary_topics`. Prioritize trends with a higher number of associated papers, or papers with higher `potential_impact` or `paper_quality` scores.\n- **Select Representative Papers for Citation:** For each trend you summarize, choose 1-2 representative papers. These should ideally be the highest `potential_impact` or `paper_quality` papers relevant to that trend from the provided input data.\n- **Infer Future Outlook:** Based on the collective summaries and topics of the provided articles, infer and summarize likely future research directions.\n\n**Output Format (Strict JSON):**\nYour entire response MUST be **only** a valid JSON object.\n- **DO NOT include any Markdown code fences (```json) or any other text before or after the JSON object.**\n- The JSON object MUST contain exactly two top-level keys: \"subject\" and \"body\".\n- The value for \"subject\" MUST be a single string. It MUST always start with \"‚ú® ML Weekly Update:\" and the rest should be a succinct summary of the report's top trends for the week.\n- The value for \"body\" MUST be a single string representing the full email content in Markdown format. Use `\\\\n` for newlines within the body string. All double quotes within string values MUST be escaped as `\\\"`.\n- You must cite all of your conclusions with the matching `arxiv_id` for the paper. Cite the in markdown format so that the user can click on a word related to the paper which is linked to the `arxiv_id`.\n\nHere is an example of a citation:\n...including [MOTIF](http://arxiv.org/abs/2507.02851v1) which enables modular thinking beyond context limitations\n\nUse ONLY data from the `arxiv_id` field for citations. Do NOT create an arXiv_id spontaneously.\n\nExample JSON Output (strictly adhere to this format):\n```json\n{\n  \"subject\": \"‚ú® ML Weekly Update: BERT gets an upgrade, new PEFT techniques, and ML for radiology\",\n  \"body\": \"Rest of email in markdown format here.\"\n}\n\nFollow this format strictly for the email, giving the body output in markdown format:\n\nHey there,\n\nHere's a quick rundown of the key trends in Machine Learning research from the past week.\n\n## üí´ Key Research Trends This Week\nA one-sentence summary of the main trends covered in the report.\n* Bullet 1: A specific trend explained in 1 sentence or less, with the corresponding `arxiv_id` from the input report.\n* Bullet 2: A specific trend explained in 1 sentence or less, with the corresponding `arxiv_id` from the input report.\n* Bullet 3: A specific trend explained in 1 sentence or less, with the corresponding `arxiv_id` from the input report.\n** Write a maximum of 3 bullet points **\n\n## üîÆ Future Research Directions\nA one-sentence summary of future research directions from the report.\n* Bullet 1: A specific prediction explained in 1 sentence or less.\n* Bullet 2: A specific prediction explained in 1 sentence or less.\n* Bullet 3: A specific prediction explained in 1 sentence or less.\n** Write a maximum of 3 bullet points **\n\nGive a one sentence summary of the email. Then follow it with some short tips on what to look for in terms of new developments over the coming week.\n\nUntil next week,\n\nArchi üßëüèΩ‚Äçüî¨"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "bb101516-818c-48e5-87d8-1a9f98d0f3a2",
        "name": "Post Process Data",
        "type": "n8n-nodes-base.set",
        "position": [
          832,
          1584
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "42cf92c6-730d-4abf-a578-480f71e220da",
                "name": "subject",
                "type": "string",
                "value": "={{ $json.output.subject }}"
              },
              {
                "id": "c1f254e2-8333-431e-a6f1-0efa38f4fd3b",
                "name": "output.body",
                "type": "string",
                "value": "={{ $json.output.body.replace(/\\\\n/g, '\\n') }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "f5f96c9f-08ad-4707-a24e-d3c518218778",
        "name": "Send email",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          1520,
          1584
        ],
        "webhookId": "2fc3d54c-6de7-4f75-aa5d-f8cf90a4d1c4",
        "parameters": {
          "html": "={{ $json.data }}",
          "options": {},
          "subject": "={{ $json.subject }}"
        },
        "credentials": {
          "smtp": {
            "id": "isYLskFLHSByAySn",
            "name": "SMTP account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "e61ea149-eae7-43bc-a308-f791ea408dec",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "color": 4,
          "width": 1600,
          "height": 380,
          "content": "# Build a Weekly AI Trend Alerter with arXiv and Weaviate\n\nüßëüèΩ‚Äçüî¨ Ditch the endless scroll for AI trends. Meet Archi, your personal AI trend scout that hits you up once a week with everyone you need to know.\n\nThis workflow scrapes AI and machine learning article abstracts from [arxiv](arxiv.org), enriches them with topic categories using a LLM, and embeds them in a [Weaviate](Weaviate) vector store. The vector store is then used as a tool for agentic RAG to write a concise, easy-to-read summary of the week in research.\n\n## Prerequisites\n1.  **An existing Weaviate cluster.** You can view instructions for setting up a **local cluster** with Docker [here](https://weaviate.io/developers/weaviate/installation/docker-compose#starter-docker-compose-file) or a **Weaviate Cloud** cluster [here](https://weaviate.io/developers/wcs/quickstart).\n2.  **API keys** to generate embeddings and power chat models. We use a combination of [OpenRouter](https://openrouter.ai/) and [OpenAI](https://openai.com/) Feel free to switch out the models as you like.\n3.  **An email address with STMP privileges**. This is the address the email will come from. In this demo we use a personal Gmail address. You can create a new credential to link a `STMP Account` using these [instructions](https://docs.n8n.io/integrations/builtin/credentials/sendemail/).\n4.  **Self-hosted n8n instance.** See this [video](https://www.youtube.com/watch?v=kq5bmrjPPAY&t=108s) for how to get set up in just three minutes.\n  \n\nüíö Sign up [here](https://console.weaviate.cloud/?utm_source=recipe&utm_campaign=n8n&utm_content=n8n_arxiv_template) for a 14-day free trial of Weaviate Cloud (no credit card required)."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "3e8d7c33-fa94-4fa0-a338-d4b106a9a8e3",
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Remove Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Markdown": {
        "main": [
          [
            {
              "node": "Send email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Date & Time": {
        "main": [
          [
            {
              "node": "Query arXiv",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Query arXiv": {
        "main": [
          [
            {
              "node": "Convert XML to JSON",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Remove Fields": {
        "main": [
          [
            {
              "node": "Weaviate Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Agentic RAG for Trend Analysis",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Split Results": {
        "main": [
          [
            {
              "node": "Prep Data for Weaviate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Current Date": {
        "main": [
          [
            {
              "node": "Date & Time",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Get Current Date",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Weaviate Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Post Process Data": {
        "main": [
          [
            {
              "node": "Markdown",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Remove Duplicates": {
        "main": [
          [
            {
              "node": "Enrich Articles with Topic Classification",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "Weaviate Vector Store1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Convert XML to JSON": {
        "main": [
          [
            {
              "node": "Split Results",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Weaviate Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Add Static sessionId": {
        "main": [
          [
            {
              "node": "Agentic RAG for Trend Analysis",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Agentic RAG for Trend Analysis",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Weaviate Vector Store": {
        "main": [
          [
            {
              "node": "Aggregate Uploaded arXiv IDs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Enrich Articles with Topic Classification",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Structured Output Parser1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Prep Data for Weaviate": {
        "main": [
          [
            {
              "node": "Remove Duplicates",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Weaviate Vector Store1": {
        "ai_tool": [
          [
            {
              "node": "Agentic RAG for Trend Analysis",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Agentic RAG for Trend Analysis",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "Enrich Articles with Topic Classification",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate Uploaded arXiv IDs": {
        "main": [
          [
            {
              "node": "Add Static sessionId",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Agentic RAG for Trend Analysis": {
        "main": [
          [
            {
              "node": "Post Process Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter1": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Enrich Articles with Topic Classification": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "e7ccf4281d5afb175c79c02db95b45f15d5b53862cb6bc357c5e5bc26567f35c",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "ac90ca65-d732-4358-873a-1275a373bc51",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          160,
          0
        ],
        "webhookId": "87d0712c-9ce3-4f5d-a715-8a1f5f1574c6",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "9ba4a3b5-5f26-4fe5-a6bd-0ba642d606dd",
        "name": "Postgres Chat Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
        "position": [
          416,
          352
        ],
        "parameters": {},
        "credentials": {
          "postgres": {
            "id": "44lwBYXMr6Vx0Fmq",
            "name": "Postgres account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "46afb445-8969-4589-8168-6371859c33cd",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          1136,
          560
        ],
        "parameters": {
          "options": {
            "dimensions": 1536
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "OQJASLp1qn1StvpI",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "3afefc1e-e9ca-48ca-be50-288da37e3ac3",
        "name": "Reranker Cohere",
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "position": [
          1296,
          560
        ],
        "parameters": {},
        "credentials": {
          "cohereApi": {
            "id": "PCdrjFiCsNkbtU2E",
            "name": "CohereApi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c4773b42-0af6-40d0-8700-f13e35c7d446",
        "name": "Anthropic Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          240,
          352
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "claude-sonnet-4-20250514",
            "cachedResultName": "Claude 4 Sonnet"
          },
          "options": {}
        },
        "credentials": {
          "anthropicApi": {
            "id": "k6Lnp9bVLzT5z85i",
            "name": "Anthropic account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "98588524-2d9d-473f-b3be-94cc6cd2ccce",
        "name": "structured data",
        "type": "n8n-nodes-base.postgresTool",
        "position": [
          848,
          416
        ],
        "parameters": {
          "table": {
            "__rl": true,
            "mode": "name",
            "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Table', ``, 'string') }}"
          },
          "schema": {
            "__rl": true,
            "mode": "list",
            "value": "public"
          },
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "Keyword",
                "type": "string",
                "display": true,
                "required": true,
                "displayName": "Keyword",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Avg monthly searches",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Avg monthly searches",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Competition",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Competition",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Competition indexed value",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Competition indexed value",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Low range bid",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Low range bid",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "High range bid",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "High range bid",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Score",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Score",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Base score",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Base score",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "cpc median",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "cpc median",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "n chars",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "n chars",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "relevance bonus",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "relevance bonus",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Scored?",
                "type": "boolean",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Scored?",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Primary used",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Primary used",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Secondary used?",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Secondary used?",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "credentials": {
          "postgres": {
            "id": "44lwBYXMr6Vx0Fmq",
            "name": "Postgres account"
          }
        },
        "typeVersion": 2.6
      },
      {
        "id": "fab6ed46-4d14-4c88-9bce-4e013ef4ac54",
        "name": "General knowledge",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          1168,
          400
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {},
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "danelfin",
            "cachedResultName": "danelfin"
          },
          "useReranker": true,
          "toolDescription": "Acces information About (YOUR COMPANY)"
        },
        "credentials": {
          "supabaseApi": {
            "id": "4TXwWjRCifw2A3yw",
            "name": "Supabase tm"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "42e3436f-8f91-4ef0-a110-8ed6c8476758",
        "name": "When clicking ‚ÄòExecute workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          144,
          -688
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "40f20edf-04f5-42b3-9bbb-05bb649909bf",
        "name": "Download file",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          352,
          -688
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "list",
            "value": "1B10ODCBzQixzx1wxfA1Nsrnz8a8o2vzV",
            "cachedResultUrl": "https://drive.google.com/file/d/1B10ODCBzQixzx1wxfA1Nsrnz8a8o2vzV/view?usp=drivesdk",
            "cachedResultName": "1.0.zip"
          },
          "options": {},
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "ZLXSLAtUFlQgPXhb",
            "name": "Google Drive account 2"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "40f0eb51-de45-49bc-b05d-23bc5876e936",
        "name": "Default Data Loader1",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          704,
          -464
        ],
        "parameters": {
          "options": {},
          "dataType": "binary",
          "textSplittingMode": "custom"
        },
        "typeVersion": 1.1
      },
      {
        "id": "de72b0ca-7f48-46dd-9220-f2406ee8070c",
        "name": "Recursive Character Text Splitter1",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          784,
          -256
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "fd2df44b-12e9-40f2-a0e7-29e914c101bf",
        "name": "Add to Supabase Vector DB",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          592,
          -688
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "danelfin",
            "cachedResultName": "danelfin"
          }
        },
        "credentials": {
          "supabaseApi": {
            "id": "4TXwWjRCifw2A3yw",
            "name": "Supabase tm"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "c6831a2b-cbb5-4912-8974-b82f8775d4e7",
        "name": "Embeddings OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          576,
          -464
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "OQJASLp1qn1StvpI",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "eb4b1d52-5b49-42d1-b65d-881c23d549da",
        "name": "Think",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          576,
          352
        ],
        "parameters": {
          "description": "Use the tool to think about the user query and the actual data extracted."
        },
        "typeVersion": 1
      },
      {
        "id": "425e6a03-b840-44d3-bd9e-b414f4dcfa8f",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1664,
          -48
        ],
        "parameters": {
          "color": 5,
          "width": 380,
          "height": 100,
          "content": "### Always Authenticate Your Server!\nBefore going to production, it's always advised to enable authentication on your MCP server trigger."
        },
        "typeVersion": 1
      },
      {
        "id": "1f269b19-3bb3-4bc4-9eb5-e46b8a50bf77",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          2112,
          448
        ],
        "parameters": {
          "workflowInputs": {
            "values": [
              {
                "name": "operation"
              },
              {
                "name": "folderId"
              },
              {
                "name": "fileId"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "9d2d569d-366a-47a8-8919-8ee100bbe11d",
        "name": "Google Drive MCP Server",
        "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
        "position": [
          1712,
          64
        ],
        "webhookId": "a289c719-fb71-4b08-97c6-79d12645dc7e",
        "parameters": {
          "path": "a289c719-fb71-4b08-97c6-79d12645dc7e"
        },
        "typeVersion": 1
      },
      {
        "id": "bd3b79b3-3080-4e72-8091-5baaa1f17388",
        "name": "Download File1",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          2464,
          448
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.fileId }}"
          },
          "options": {
            "googleFileConversion": {
              "conversion": {
                "docsToFormat": "text/plain",
                "slidesToFormat": "application/pdf"
              }
            }
          },
          "operation": "download"
        },
        "typeVersion": 3
      },
      {
        "id": "c6e7ed75-10b7-4be6-b398-0c5172daf9f9",
        "name": "FileType",
        "type": "n8n-nodes-base.switch",
        "position": [
          2656,
          400
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "pdf",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "7b6958ce-d553-4379-a5d6-743f39b342d0",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $binary.data.mimeType }}",
                      "rightValue": "application/pdf"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "csv",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "d0816a37-ac06-49e3-8d63-17fcd061e33f",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $binary.data.mimeType }}",
                      "rightValue": "text/csv"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "image",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "589540e1-1439-41e3-ba89-b27f5e936190",
                      "operator": {
                        "type": "boolean",
                        "operation": "true",
                        "singleValue": true
                      },
                      "leftValue": "={{\n[\n  'image/jpeg',\n  'image/jpg',\n  'image/png',\n  'image/gif'\n].some(mimeType => $binary.data.mimeType === mimeType)\n}}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "audio",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "b8fc61a1-6057-4db3-960e-b8ddcbdd0f31",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $binary.data.mimeType }}",
                      "rightValue": "audio"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "video",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "959d65a6-372f-4978-b2d1-f28aa1e372c6",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $binary.data.mimeType }}",
                      "rightValue": "video"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "af4a67ae-e328-4aa8-80fe-104ef97db2e0",
        "name": "Operation",
        "type": "n8n-nodes-base.switch",
        "position": [
          2288,
          448
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "ReadFile",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "b03bb746-dc4e-469c-b8e6-a34c0aa8d0a6",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.operation }}",
                      "rightValue": "readFile"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "9097988d-c8a4-47d3-a202-7108e967087d",
        "name": "Extract from PDF",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          2928,
          160
        ],
        "parameters": {
          "options": {},
          "operation": "pdf"
        },
        "typeVersion": 1
      },
      {
        "id": "884950de-d4d6-4c86-b56c-c97dbc54e9aa",
        "name": "Extract from CSV",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          2928,
          352
        ],
        "parameters": {
          "options": {
            "encoding": "utf-8",
            "headerRow": false,
            "relaxQuotes": true,
            "includeEmptyCells": true
          }
        },
        "typeVersion": 1
      },
      {
        "id": "04d9c541-5f77-4891-bef8-e2fb7b6a4fa7",
        "name": "Get PDF Response",
        "type": "n8n-nodes-base.set",
        "position": [
          3088,
          160
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a481cde3-b8ec-4d97-aa13-4668bd66c24d",
                "name": "response",
                "type": "string",
                "value": "={{ $json.text }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "68455a41-eb83-4435-bd16-41660100a544",
        "name": "Get CSV Response",
        "type": "n8n-nodes-base.set",
        "position": [
          3088,
          352
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a481cde3-b8ec-4d97-aa13-4668bd66c24d",
                "name": "response",
                "type": "string",
                "value": "={{\n$input.all()\n  .map(item => item.json.row.map(cell => `\"${cell}\"`).join(','))\n  .join('\\n')\n}}"
              }
            ]
          }
        },
        "executeOnce": true,
        "typeVersion": 3.4
      },
      {
        "id": "d7914110-a00d-429a-83c5-f616a42279de",
        "name": "Read File From GDrive",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          1968,
          256
        ],
        "parameters": {
          "name": "ReadFile",
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Call this tool to download and read the contents of a file within google drive.",
          "workflowInputs": {
            "value": {
              "fileId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('fileId', ``, 'string') }}",
              "folderId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('folderId', ``, 'string') }}",
              "operation": "readFile"
            },
            "schema": [
              {
                "id": "operation",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "operation",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "folderId",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "folderId",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "fileId",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "fileId",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "fe6779a1-b38d-41f1-97ec-d4502627d538",
        "name": "Search Files from Gdrive",
        "type": "n8n-nodes-base.googleDriveTool",
        "position": [
          1776,
          288
        ],
        "parameters": {
          "limit": 10,
          "filter": {
            "driveId": {
              "mode": "list",
              "value": "My Drive"
            },
            "whatToSearch": "files"
          },
          "options": {},
          "resource": "fileFolder",
          "queryString": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Search_Query', ``, 'string') }}"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "ZLXSLAtUFlQgPXhb",
            "name": "Google Drive account 2"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "63050b0b-f63c-4842-9410-fa58d3aa4f23",
        "name": "Analyse Image",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          2928,
          528
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "resource": "image",
          "inputType": "base64",
          "operation": "analyze"
        },
        "typeVersion": 1.8
      },
      {
        "id": "ee58e63a-9262-4c2c-b7b3-e5d4554f49f7",
        "name": "Transcribe Audio",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          2928,
          704
        ],
        "parameters": {
          "options": {},
          "resource": "audio",
          "operation": "transcribe"
        },
        "typeVersion": 1.8
      },
      {
        "id": "f28c8080-ec2b-493c-b611-7b806153e105",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          768,
          368
        ],
        "parameters": {
          "color": 5,
          "height": 176,
          "content": "It can be google sheets/ airtable ..."
        },
        "typeVersion": 1
      },
      {
        "id": "05989746-b87c-49cb-9c41-360de1c12848",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2080,
          -112
        ],
        "parameters": {
          "color": 5,
          "width": 480,
          "content": "## https://n8n.io/creators/jimleuk/ (Jimleuk build this)\n\n- https://n8n.io/workflows/3634-build-your-own-google-drive-mcp-server/ (click the link for more detailed explanation)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "5c723a04-c8a3-4bc0-8824-c074261b6471",
        "name": "search  about any doc in google drive",
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "position": [
          1600,
          176
        ],
        "parameters": {
          "sseEndpoint": "https://your instancesse"
        },
        "typeVersion": 1
      },
      {
        "id": "ec2c314e-1663-4bae-81b0-82d178127dba",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          112,
          272
        ],
        "parameters": {
          "color": 5,
          "height": 224,
          "content": "### Advanced model of claude or Grok 4 for better results "
        },
        "typeVersion": 1
      },
      {
        "id": "978c81d5-f666-43a6-9264-9afe2a2ef90b",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2080,
          48
        ],
        "parameters": {
          "color": 7,
          "width": 1180,
          "height": 812,
          "content": "## 2. Handle Multiple Binary Formats via Conversion and AI\n[Read more about the PostgreSQL Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.postgres/)\n\nMCP clients (or rather, the AI agents) still expect and require text responses from our MCP server.\nN8N can provide the right conversion tools to parse most text formats such as PDF, CSV and XML.\nFor images, audio and video, consider using multimodal LLMs to describe or transcribe the file instead."
        },
        "typeVersion": 1
      },
      {
        "id": "4fbb6c1f-7d48-461e-9f40-b511643ab0de",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          64,
          -848
        ],
        "parameters": {
          "color": 7,
          "width": 1072,
          "height": 720,
          "content": "## Load data to vector store"
        },
        "typeVersion": 1
      },
      {
        "id": "5057d61a-b3e1-4954-aeab-af772966ef5a",
        "name": "Knowledge Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          464,
          0
        ],
        "parameters": {
          "options": {
            "systemMessage": "=You are **AI‚ÄØAssistant** for **[your‚ÄØcompany]**, orchestrated by the `Knowledge¬†Agent` node inside an n8n workflow.  \nYour mission:\n\n1. **Respond clearly and helpfully** to every user request, matching their tone and preferred language.  \n2. **Persist context**: every turn is automatically stored in `Postgres¬†Chat¬†Memory`; use it to maintain continuity, avoid repetition, and recall prior details when relevant.  \n3. **Reason before you act**:  \n   - Call the `Think` tool to outline your plan or ask clarifying questions.  \n   - Invoke the appropriate tools when needed:  \n     ‚Ä¢ `General‚ÄØknowledge` (Supabase vector store) for internal content from¬†[your‚ÄØcompany]  \n     ‚Ä¢ `structured‚ÄØdata` (Postgres) for tabular queries  \n     ‚Ä¢ `search‚ÄØabout‚ÄØany‚ÄØdoc‚ÄØin‚ÄØgoogle‚ÄØdrive` to locate Drive files  \n     ‚Ä¢ `Read‚ÄØFile‚ÄØFrom‚ÄØGDrive` to download and process PDFs, CSVs, images, audio, or video  \n     ‚Ä¢ `Message‚ÄØa‚ÄØmodel‚ÄØin‚ÄØPerplexity` only when you need very recent external web information \n4. **Output format**: reply in well‚Äëstructured Markdown‚Äîheadings, lists, and code when useful. Keep it concise; avoid unnecessary tables.\n\nAdditional notes:  \n- Always cite the data source in your answer (‚Äú*from the vector store*,‚Äù ‚Äú*from the analysed CSV*,‚Äù etc.).  \n- If anything is ambiguous (e.g., which file to open), ask a precise follow‚Äëup question first.  \n"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "e0341ead-2135-442d-a515-4b0c42d63cf9",
        "name": "Message a model in Perplexity",
        "type": "n8n-nodes-base.perplexityTool",
        "position": [
          656,
          752
        ],
        "parameters": {
          "options": {},
          "messages": {
            "message": [
              {
                "content": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('message0_Text', ``, 'string') }}"
              }
            ]
          },
          "requestOptions": {}
        },
        "credentials": {
          "perplexityApi": {
            "id": "cNp0HfeB1Cq3pI4g",
            "name": "Perplexity account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "71203174-b2c1-4fd9-8abb-4f254124f72e",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          576,
          688
        ],
        "parameters": {
          "color": 5,
          "height": 224,
          "content": "### Search for live data in the Web"
        },
        "typeVersion": 1
      },
      {
        "id": "c7638349-2fc9-4cc7-8b87-3f7acb7973d8",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -880,
          -848
        ],
        "parameters": {
          "color": 3,
          "width": 896,
          "height": 1872,
          "content": "# üìú Detailed n8n Workflow Description\n\n## Main Flow\n\nThe workflow operates through a three-step process that handles incoming chat messages with intelligent tool orchestration:\n\n1. **Message Trigger**: The `When chat message received` node triggers whenever a user message arrives and passes it directly to the `Knowledge Agent` for processing.\n\n2. **Agent Orchestration**: The `Knowledge Agent` serves as the central orchestrator, registering a comprehensive toolkit of capabilities:\n   - **LLM Processing**: Uses `Anthropic Chat Model` with the *claude-sonnet-4-20250514* model to craft final responses\n   - **Memory Management**: Implements `Postgres Chat Memory` to save and recall conversation context across sessions\n   - **Reasoning Engine**: Incorporates a `Think` tool to force internal chain-of-thought processing before taking any action\n   - **Semantic Search**: Leverages `General knowledge` vector store with OpenAI embeddings (1536-dimensional) and Cohere reranking for intelligent content retrieval\n   - **Structured Queries**: Provides `structured data` Postgres tool for executing queries on relational database tables\n   - **Drive Integration**: Includes `search about any doc in google drive` functionality to locate specific file IDs\n   - **File Processing**: Connects to `Read File From GDrive` sub-workflow for fetching and processing various file formats\n   - **External Intelligence**: Offers `Message a model in Perplexity` for accessing up-to-the-minute web information when internal knowledge proves insufficient\n\n3. **Response Generation**: After invoking the `Think` process, the agent intelligently selects appropriate tools based on the query, integrates results from multiple sources, and returns a comprehensive Markdown-formatted answer to the user.\n\n## Persistent Context Management\n\nThe workflow maintains conversation continuity through `Postgres Chat Memory`, which automatically logs every user-agent exchange. This ensures long-term context retention without requiring manual intervention, allowing for sophisticated multi-turn conversations that build upon previous interactions.\n\n## Semantic Retrieval Pipeline\n\nThe semantic search system operates through a sophisticated two-stage process:\n\n- **Embedding Generation**: `Embeddings OpenAI` converts textual content into high-dimensional vector representations\n- **Relevance Reranking**: `Reranker Cohere` reorders search hits to prioritize the most contextually relevant results\n- **Knowledge Integration**: Processed results feed into the `General knowledge` vector store, providing the agent with relevant internal knowledge snippets for enhanced response accuracy\n\n## Google Drive File Processing\n\nThe file reading capability handles multiple formats through a structured sub-workflow:\n\n1. **Workflow Initiation**: The agent calls `Read File From GDrive` with the selected `fileId` parameter\n2. **Sub-workflow Activation**: `When Executed by Another Workflow` node activates the dedicated file processing sub-workflow\n3. **Operation Validation**: `Operation` node confirms the request type is `readFile`\n4. **File Retrieval**: `Download File1` node retrieves the binary file data from Google Drive\n5. **Format-Specific Processing**: `FileType` node branches processing based on MIME type:\n   - **PDF Files**: Route through `Extract from PDF` ‚Üí `Get PDF Response` to extract plain text content\n   - **CSV Files**: Process via `Extract from CSV` ‚Üí `Get CSV Response` to obtain comma-delimited text data\n   - **Image Files**: Analyze using `Analyse Image` with GPT-4o-mini to generate visual descriptions\n   - **Audio/Video Files**: Transcribe using `Transcribe Audio` with Whisper for text transcript generation\n6. **Content Integration**: The extracted text content returns to `Knowledge Agent`, which seamlessly weaves it into the final response\n\n## External Search Capability\n\nWhen internal knowledge sources prove insufficient, the workflow can access current public information through `Message a model in Perplexity`, ensuring responses remain accurate and up-to-date with the latest available information.\n\n## Design Highlights\n\nThe workflow architecture incorporates several key design principles that enhance reliability and reusability:\n\n- **Forced Reasoning**: The mandatory `Think` step significantly reduces hallucinations and prevents tool misuse by requiring deliberate consideration before action\n- **Template Flexibility**: The design is intentionally generic‚Äîorganizations can replace **[your company]** placeholders with their specific company name and integrate their own credentials for immediate deployment\n- **Documentation Integration**: Sticky notes throughout the canvas serve as inline documentation for workflow creators and maintainers, providing context without affecting runtime performance\n\n## System Benefits\n\nWith this comprehensive architecture, the assistant delivers powerful capabilities including long-term memory retention, semantic knowledge retrieval, multi-format file processing, and contextually rich responses tailored specifically for users at **[your company]**. The system balances sophisticated AI capabilities with practical business requirements, creating a robust foundation for enterprise-grade conversational AI deployment."
        },
        "typeVersion": 1
      },
      {
        "id": "49a2978b-75b9-4968-80cb-3269644348f9",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1168,
          -672
        ],
        "parameters": {
          "color": 3,
          "width": 576,
          "height": 560,
          "content": "## Need a tailor-made workflow? Tell me about your business and get a free proposal:\n\n**[Start here ‚Üí Custom Automation Form](https://taskmorphr.com/contact)**\n\n---\n## üìà Cost-Savings Snapshot  \nCurious what automation could save you?  \nRun the 60-second calculator:\n\n**[ROI / Cost Comparison](https://taskmorphr.com/cost-comparison)**\n\n---\n### ‚úâÔ∏è Reach me directly  \n`paul@taskmorphr.com`"
        },
        "typeVersion": 1
      },
      {
        "id": "d52649d2-518b-4b54-81bc-df42774ea5f7",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1488,
          -272
        ],
        "parameters": {
          "color": 3,
          "width": 224,
          "height": 128,
          "content": "### üõ†Ô∏è Build it yourself  \nBrowse every ready-made workflow:  \n[Full Template Pack ‚Äî coming soon](https://n8n.io/creators/diagopl/)\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Think": {
        "ai_tool": [
          [
            {
              "node": "Knowledge Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "FileType": {
        "main": [
          [
            {
              "node": "Extract from PDF",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Extract from CSV",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Analyse Image",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Transcribe Audio",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Operation": {
        "main": [
          [
            {
              "node": "Download File1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download file": {
        "main": [
          [
            {
              "node": "Add to Supabase Vector DB",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download File1": {
        "main": [
          [
            {
              "node": "FileType",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere": {
        "ai_reranker": [
          [
            {
              "node": "General knowledge",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "structured data": {
        "ai_tool": [
          [
            {
              "node": "Knowledge Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Extract from CSV": {
        "main": [
          [
            {
              "node": "Get CSV Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract from PDF": {
        "main": [
          [
            {
              "node": "Get PDF Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "General knowledge",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "General knowledge": {
        "ai_tool": [
          [
            {
              "node": "Knowledge Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "Add to Supabase Vector DB",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Anthropic Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Knowledge Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader1": {
        "ai_document": [
          [
            {
              "node": "Add to Supabase Vector DB",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Postgres Chat Memory": {
        "ai_memory": [
          [
            {
              "node": "Knowledge Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Read File From GDrive": {
        "ai_tool": [
          [
            {
              "node": "Google Drive MCP Server",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Search Files from Gdrive": {
        "ai_tool": [
          [
            {
              "node": "Google Drive MCP Server",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Knowledge Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Message a model in Perplexity": {
        "ai_tool": [
          [
            {
              "node": "Knowledge Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "Operation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter1": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader1",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòExecute workflow‚Äô": {
        "main": [
          [
            {
              "node": "Download file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "search  about any doc in google drive": {
        "ai_tool": [
          [
            {
              "node": "Knowledge Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "creator": "Lucas Peyrin",
      "instanceId": "e409ea34548a2afe2dffba31130cd1cf2e98ebe2afaeed2a63caf2a0582d1da0",
      "fingerprint": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjcmVhdG9yIjoiIiwiaXNzIjoibjhuIiwiaWF0IjoxNzUyODQ0NDUzfQ.iaCRYEbTvu1E0KUYlUHZI1pFPR17ePims1iJk1HM-pQ",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "4aace023-5b83-409c-b80f-b1deb0442482",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          380,
          480
        ],
        "parameters": {
          "contextWindowLength": 30
        },
        "typeVersion": 1.3
      },
      {
        "id": "624800cc-313a-4fb7-9610-218e141e524b",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Gemini",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          20,
          480
        ],
        "parameters": {
          "options": {
            "temperature": 0
          },
          "modelName": "models/gemini-2.5-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "AXawYbABK5aZbGBE",
            "name": "IA2S"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4100fa02-5444-4565-9696-04bca3d7fa3f",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "OpenAI",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "disabled": true,
        "position": [
          -120,
          480
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "temperature": 0
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "fa4e52f1-aa8e-4f16-9c92-8650338b7990",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Example Chat Window",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          0,
          -40
        ],
        "webhookId": "499666c3-d807-4bb7-8195-43932f64a91f",
        "parameters": {
          "public": true,
          "options": {
            "title": "Your first AI Agent üöÄ",
            "subtitle": "This is for demo purposes. Try me out !",
            "customCss": "/* === THEME OVERRIDE: n8n Glass & Glow (Revised) === */\n\n/*\n  This theme is built upon the default n8n chat CSS variables.\n  We'll use your desired branding and layout, and then add\n  the \"glass\" effect using a semi-transparent background\n  and a backdrop-filter on the main window class.\n*/\n\n:root {\n  /* --- 1. CORE BRANDING & FONTS --- */\n  /* Your choices for font and primary color are applied here. */\n  --chat--font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  --chat--color-primary: #EA4B71; /* n8n Red */\n  --chat--color-primary-shade-50: #D93A60;\n  --chat--color-primary-shade-100: #C82A50;\n  --chat--color-secondary: #20b69e; /* Kept default secondary for things like file uploads */\n  --chat--color-secondary-shade-50: #1ca08a;\n  --chat--color-white: #ffffff;\n  --chat--color-light: #f2f4f8;\n  --chat--color-dark: #1F2937; /* Darker, more modern text color */\n  --chat--color-disabled: #9CA3AF;\n  --chat--color-typing: #404040;\n\n  /* --- 2. WINDOW & LAYOUT --- */\n  /* Your dimensions and rounded corners. The actual glass effect is handled in the class override below. */\n  --chat--window--width: 430px;\n  --chat--window--height: 80vh;\n  --chat--window--border-radius: 16px;\n  --chat--window--border: 1px solid rgba(255, 255, 255, 0.3);\n  --chat--spacing: 1rem; /* 16px base spacing */\n  --chat--window--z-index: 9999;\n  --chat--window--bottom: var(--chat--spacing);\n  --chat--window--right: var(--chat--spacing);\n  --chat--window--margin-bottom: var(--chat--spacing);\n\n  /* --- 3. GLASSMORPHISM BACKGROUNDS --- */\n  /* We make the main sections transparent to let the glass window show through. */\n  --chat--header--background: transparent;\n  --chat--body--background: transparent;\n  --chat--footer--background: transparent;\n\n  /* --- 4. HEADER STYLING --- */\n  --chat--header-height: auto;\n  --chat--header--padding: 20px;\n  --chat--header--color: var(--chat--color-dark);\n  --chat--header--border-bottom: 1px solid rgba(255, 255, 255, 0.2); /* Subtle divider */\n  --chat--heading--font-size: 1.5rem;\n  --chat--subtitle--font-size: 0.875rem;\n  --chat--subtitle--line-height: 1.4;\n  --chat--close--button--color-hover: var(--chat--color-primary);\n\n  /* --- 5. MESSAGE BUBBLES --- */\n  --chat--message--font-size: 0.875rem;\n  --chat--message--padding: 12px 16px;\n  --chat--message--border-radius: 12px;\n  --chat--message-line-height: 1.6;\n  --chat--message--margin-bottom: calc(var(--chat--spacing) * 0.75);\n  --chat--messages-list--padding: var(--chat--spacing);\n  --chat--message--bot--background: var(--chat--color-white);\n  --chat--message--bot--color: #111827;\n  --chat--message--bot--border: none;\n  --chat--message--user--background: var(--chat--color-primary);\n  --chat--message--user--color: var(--chat--color-white);\n  --chat--message--user--border: none;\n\n  /* --- 6. INPUT AREA --- */\n  --chat--textarea--height: 50px;\n  --chat--textarea--max-height: 10rem;\n  --chat--input--font-size: 0.9rem;\n  --chat--input--border: 0;\n  --chat--input--border-radius: 12px; /* Rounded input field */\n  --chat--input--padding: 12px 16px;\n  --chat--input--background: rgba(255, 255, 255, 0.5); /* Semi-transparent input */\n  --chat--input--text-color: #111827;\n  --chat--input--line-height: 1.5;\n  --chat--input--border-active: 0;\n\n  /* --- 7. SEND & FILE BUTTONS --- */\n  --chat--input--send--button--background: transparent;\n  --chat--input--send--button--color: var(--chat--color-primary);\n  --chat--input--send--button--background-hover: transparent;\n  --chat--input--send--button--color-hover: var(--chat--color-primary-shade-50);\n  --chat--input--file--button--background: transparent;\n  --chat--input--file--button--color: var(--chat--color-secondary);\n  --chat--input--file--button--background-hover: transparent;\n  --chat--input--file--button--color-hover: var(--chat--color-secondary-shade-50);\n\n  /* --- 8. TOGGLE BUTTON & OTHERS --- */\n  /* Using your primary brand color for the main toggle button */\n  --chat--toggle--size: 64px;\n  --chat--toggle--width: var(--chat--toggle--size);\n  --chat--toggle--height: var(--chat--toggle--size);\n  --chat--toggle--border-radius: 50%;\n  --chat--toggle--background: var(--chat--color-primary);\n  --chat--toggle--hover--background: var(--chat--color-primary-shade-50);\n  --chat--toggle--active--background: var(--chat--color-primary-shade-100);\n  --chat--toggle--color: var(--chat--color-white);\n}\n\n/* === CLASS OVERRIDES === */\n/*\n  These are essential for effects that CSS variables can't control,\n  like the glass blur, shadows, and max-height.\n*/\n\n.chat-window {\n  /* This is the magic for the glass effect! */\n  background-color: rgba(249, 243, 245, 0.6); /* A semi-transparent background color */\n  backdrop-filter: blur(20px);\n  -webkit-backdrop-filter: blur(20px); /* For Safari compatibility */\n\n  /* A subtle shadow helps lift the window off the page */\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);\n\n  /* Here we apply the max-height you wanted */\n  max-height: 750px;\n}\n\n/* Make user messages slightly wider for better balance */\n.chat-message.is-user {\n\tmax-width: 70%;\n}\n\n.chat-message.is-bot {\n\tmax-width: 80%;\n}\n\n/* Add a subtle glow to messages on hover */\n.chat-message {\n    transition: transform 0.2s ease, box-shadow 0.2s ease;\n}\n.chat-message:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 0 25px 0 rgba(234, 75, 113, 0.2);\n}\n\n/* === PAGE BACKGROUND === */\n/* Your dotted background to simulate the n8n canvas. Perfect as is! */\nbody {\n    background-color: #FDFBFF;\n    background-image:\n        radial-gradient(circle at 1px 1px, rgba(0,0,0,0.07) 1px, transparent 0),\n        linear-gradient(135deg, #F9F3F5 0%, #EFF3FB 100%);\n    background-size: 25px 25px, 100% 100%;\n}",
            "responseMode": "lastNode",
            "inputPlaceholder": "Type your message here..",
            "showWelcomeScreen": false
          },
          "initialMessages": "Hi there! üëã"
        },
        "typeVersion": 1.1
      },
      {
        "id": "cd0e7167-a293-4565-b689-3162c45cd42b",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Your First AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          560,
          -40
        ],
        "parameters": {
          "options": {
            "systemMessage": "<role>\nYou are the n8n Demo AI Agent, a friendly and helpful assistant designed to showcase the power of AI agents within the n8n automation platform. You were created by Lucas Peyrin as part of the \"Your First AI Agent\" template. Your personality is encouraging, slightly educational, and enthusiastic about automation. Your primary function is to demonstrate your capabilities by using your available tools to answer user questions and fulfill their requests. You also frequently mention the other templates from https://n8n.io/creators/lucaspeyrin and push forward forms to give feedback, asking if they would like coaching or consulting.\n</role>\n\n<instructions>\n<goal>\nYour primary goal is to act as a live demonstration of an AI Agent built with n8n. You will interact with users, answer their questions by intelligently using your available tools, and explain the concepts behind AI agents to help them understand their potential. You should also guide them towards further learning and feedback opportunities provided by the template's creator, Lucas Peyrin.\n</goal>\n\n<context>\n### How I Work\nI am an AI model operating within a simple n8n workflow. This workflow gives me two key things:\n1.  **A set of tools:** These are functions I can call to get information or perform actions.\n2.  **Simple Memory:** I can remember the immediate past of our current conversation to understand context.\n\n### My Purpose\nMy main purpose is to be a showcase. I demonstrate how you can give a chat interface to various functions (my tools) without needing complex UIs. This is a great way to make powerful automations accessible to anyone through simple conversation.\n\n### My Available Tools\nYou must choose one of these tools if the user's request matches its capability. You cannot perform these actions yourself; you must call the tool.\n- **get_a_joke**: Use this when the user asks for a joke.\n- **days_from_now**: Use this to calculate a future date. It requires a number of days as input.\n- **wikipedia**: Use this to search for a summary of a topic on Wikipedia.\n- **create_password**: Use this to generate a strong, random password.\n- **calculate_loan_payment**: Use this to calculate a monthly loan payment. It requires the principal amount, the annual interest rate (e.g., 5 for 5%), and the loan term in years.\n- **n8n_blog_rss_feed**: Use this to fetch the latest articles from the official n8n blog.\n\n### About AI Agents in n8n\n- **Reliability:** While I can use one tool at a time effectively, more advanced agents can perform multi-step tasks. However, for complex, mission-critical processes, it's often more reliable to build structured, step-by-step workflows in n8n rather than relying solely on an agent's reasoning. Agents are fantastic for user-facing interactions, but structured workflows are king for backend reliability.\n- **Best Practices:** A good practice is to keep an agent's toolset focused, typically around 10-15 tools, to ensure reliability and prevent confusion.\n\n### Important Information & Next Steps\nIf the user expresses thanks, asks how they can learn more, or asks for help, you should present the following information from the template's creator, Lucas Peyrin. Here is Lucas' creator link that contains all of his templates that are focused on core n8n skills : [More n8n Templates](https://n8n.io/creators/lucaspeyrin)\n\n**Was this helpful? Let me know!**\nYour feedback is incredibly valuable. You can share your thoughts using this form:\n[Give Feedback about this Template](https://api.ia2s.app/form/templates/feedback?template=First%20AI%20Agent)\n\n**Ready to Build Something Great?**\n- **n8n Coaching:** To master n8n with one-on-one sessions, book a session here: [Get Personalized n8n Coaching](https://api.ia2s.app/form/templates/coaching?template=First%20AI%20Agent)\n- **n8n Consulting:** For complex projects and custom workflows, inquire about consulting services here: [Get an Expert to do my n8n Project](https://api.ia2s.app/form/templates/consulting?template=First%20AI%20Agent)\n</context>\n\n<output_format>\n- Respond in a friendly, conversational, and helpful tone.\n- When a user's request requires a tool, first select the appropriate tool. Then, present the result of the tool's execution to the user in a clear and understandable way.\n- Be proactive. If the user is unsure what to do, suggest some examples of what they can ask you based on your available tools (e.g., Talk about your tools and what you know about yourself).\n- When appropriate, seamlessly integrate the \"Important Information & Next Steps\" into your response.\n</output_format>\n</instructions>"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "6acac509-f2a0-4c88-8fb3-837553c7eb8f",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "get_a_joke",
        "type": "n8n-nodes-base.httpRequestTool",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          740,
          480
        ],
        "parameters": {
          "url": "https://v2.jokeapi.dev/joke/Any?blacklistFlags=nsfw,religious,political,racist,sexist,explicit&type=single",
          "fields": "joke",
          "options": {},
          "fieldsToInclude": "selected",
          "toolDescription": "Gets a joke from the jokeapi.",
          "optimizeResponse": true
        },
        "typeVersion": 4.2
      },
      {
        "id": "7b7aac6a-9819-4824-96f9-7505ec42db68",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "days_from_now",
        "type": "n8n-nodes-base.dateTimeTool",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          880,
          480
        ],
        "parameters": {
          "endDate": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End_Date', `Put the date to compare with now here.`, 'string') }}",
          "options": {},
          "operation": "getTimeBetweenDates",
          "startDate": "={{ $now }}",
          "descriptionType": "manual",
          "outputFieldName": "now_day_difference",
          "toolDescription": "Gets the difference (in days) between now and a set date."
        },
        "typeVersion": 2
      },
      {
        "id": "5f533d73-7dff-41fb-8bd7-dbeb05be6f25",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "wikipedia",
        "type": "@n8n/n8n-nodes-langchain.toolWikipedia",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          1020,
          480
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "92d06ffb-c2c1-4bca-b443-72b74ad41eb2",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "create_password",
        "type": "n8n-nodes-base.cryptoTool",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          1160,
          480
        ],
        "parameters": {
          "action": "generate",
          "encodingType": "base64",
          "stringLength": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Length', `Usually 8 to 16 works well.`, 'number') }}",
          "toolDescription": "Generate a secure Password.",
          "dataPropertyName": "password"
        },
        "typeVersion": 1
      },
      {
        "id": "cae4f01a-48c8-4fb6-90c7-5a157d9446f0",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "calculate_loan_payment",
        "type": "@n8n/n8n-nodes-langchain.toolCode",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          1340,
          480
        ],
        "parameters": {
          "jsCode": "const principal = query.loan_amount;\nconst annualRate = query.annual_rate;\nconst years = query.term_years;\n\n// Convert annual rate percentage to a monthly decimal rate\nconst monthlyRate = (annualRate / 100) / 12;\n// Convert years to total number of payments\nconst numberOfPayments = years * 12;\n\nif (principal <= 0 || annualRate <= 0 || years <= 0) {\n  return { error: \"Loan amount, interest rate, and term must be positive numbers.\" };\n}\n\n// Amortization formula: M = P * [r(1+r)^n] / [(1+r)^n - 1]\nconst monthlyPayment = principal * (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / (Math.pow(1 + monthlyRate, numberOfPayments) - 1);\n\nconst result = {\n  monthly_payment: monthlyPayment.toFixed(2), // Format to 2 decimal places for currency\n  total_paid: (monthlyPayment * numberOfPayments).toFixed(2),\n  total_interest: ((monthlyPayment * numberOfPayments) - principal).toFixed(2)\n};\n\nreturn JSON.stringify(result);",
          "description": "Calculates the fixed monthly payment for a loan using the standard amortization formula. Requires the total loan amount, the annual interest rate as a percentage (e.g., 5 for 5%), and the loan term in years.",
          "jsonSchemaExample": "{\n\t\"loan_amount\": 250000,\n    \"annual_rate\": 6.5,\n    \"term_years\": 30\n}",
          "specifyInputSchema": true
        },
        "typeVersion": 1.3
      },
      {
        "id": "58d0757a-160e-44db-ae58-1f4dcdc617e9",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "n8n_blog_rss_feed",
        "type": "n8n-nodes-base.rssFeedReadTool",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          1520,
          480
        ],
        "parameters": {
          "url": "https://n8n.io/blog/rss",
          "options": {},
          "toolDescription": "Gets the latest n8n blog posts."
        },
        "typeVersion": 1.2
      },
      {
        "id": "140875e4-a202-4acb-aef2-1839e93e5eea",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          1720,
          -160
        ],
        "parameters": {
          "color": 4,
          "width": 540,
          "height": 800,
          "content": "## Was this helpful? Let me know!\n\nI really hope this template helped you understand how AI Agents work here in n8n. Your feedback is incredibly valuable and helps me create better resources for the n8n community.\n\n### **Share Your Thoughts & Ideas**\n\nWhether you have a suggestion, found a typo, or just want to say thanks, I'd love to hear from you!\nHere's a simple n8n form built for this purpose:\n\n#### ‚û°Ô∏è **[Click here to give feedback](https://api.ia2s.app/form/templates/feedback?template=First%20AI%20Agent)**\n\n### **Ready to Build Something Great?**\n\nIf you're looking to take your n8n skills or business automation to the next level, I can help.\n\n**üéì n8n Coaching:** Want to become an n8n pro? I offer one-on-one coaching sessions to help you master workflows, tackle specific problems, and build with confidence.\n#### ‚û°Ô∏è **[Book a Coaching Session](https://api.ia2s.app/form/templates/coaching?template=First%20AI%20Agent)**\n\n**üíº n8n Consulting:** Have a complex project, an integration challenge, or need a custom workflow built for your business? Let's work together to create a powerful automation solution.\n#### ‚û°Ô∏è **[Inquire About Consulting Services](https://api.ia2s.app/form/templates/consulting?template=First%20AI%20Agent)**\n\n---\n\nHappy Automating!\nLucas Peyrin"
        },
        "typeVersion": 1
      },
      {
        "id": "6ab90a26-fdb2-4ac2-9d82-d26704725f36",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -220,
          -340
        ],
        "parameters": {
          "width": 460,
          "height": 460,
          "content": "#### üí¨ The Chat Interface\n\nThis is the public-facing chat window where you'll talk to your agent.\n\n**How to Test:**\n1.  **Activate** the workflow.\n2.  Copy the ***Chat URL** from this node's panel.\n3.  Open the URL in a new browser tab to start chatting!\n\n\nYou can customize the look and feel (title, colors, etc.) in the 'Options' and 'Custom CSS' tabs."
        },
        "typeVersion": 1
      },
      {
        "id": "3d455f51-f2c3-4603-ae14-d5bb004d10f8",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          440,
          -340
        ],
        "parameters": {
          "color": 6,
          "width": 540,
          "height": 460,
          "content": "#### üß† The Brain: Your AI Agent\n\nThis is the most important node! It acts as the central brain of your operation.\n\n**What it does:**\n1.  **Receives** your message from the chat.\n2.  **Understands** your goal.\n3.  **Decides** which 'Tool' (superpower) to use.\n4.  **Responds** to you after using the tool.\n\n\nThe **System Message** in this node defines the agent's personality, instructions, and knowledge of its tools. This is where the real magic happens!"
        },
        "typeVersion": 1
      },
      {
        "id": "e746b1f2-1028-428d-8b88-19004bc29f38",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -220,
          140
        ],
        "parameters": {
          "color": 3,
          "width": 460,
          "height": 500,
          "content": "#### ü§ñ The AI Brainpower (LLM)\n\nThese nodes are the Large Language Models (LLMs) that provide the actual intelligence for your agent.\n\n**ACTION REQUIRED:**\n1.  **Choose ONE model:** By default, Gemini is connected. If you prefer OpenAI, disconnect the Gemini node and connect the OpenAI node. Make sure it is enabled (you can press 'D' while it is selected to toggle Deactivation).\n2.  **Add your credentials:** Select your pre-configured API key from the 'Credential' dropdown or create a new credential for the selected model.\n\n\nYour agent won't work without a brain!"
        },
        "typeVersion": 1
      },
      {
        "id": "c08bd708-8e50-4d10-a9bd-5716b76c82c3",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          260,
          160
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 480,
          "content": "#### üß† Short-Term Memory\n\nThis node gives your agent a simple memory.\n\nIt allows the agent to remember the last few messages of your conversation. This is crucial for providing context and having a natural, back-and-forth chat.\n\nYou can control how many messages it remembers with the 'Context Window Length' setting."
        },
        "typeVersion": 1
      },
      {
        "id": "199a2071-0a07-493b-b281-542834cb86d8",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          620,
          160
        ],
        "parameters": {
          "color": 5,
          "width": 1060,
          "height": 480,
          "content": "#### üõ†Ô∏è The Agent's Toolbox (Superpowers)\n\nThese nodes are the **tools** your agent can use. They are its superpowers!\n\nEach tool gives the agent a specific ability, like searching Wikipedia, getting a joke, or calculating a loan.\n\n**How it works:** The Agent's 'Brain' node analyzes your request and intelligently chooses the correct tool from this toolbox to get the job done.\n\n**Want to add more powers?** Simply add another tool node (like the Google Calendar Tool or a custom HTTP Request Tool) and connect it to the Agent's `ai_tool` input!"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Gemini": {
        "ai_languageModel": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI": {
        "ai_languageModel": [
          []
        ]
      },
      "wikipedia": {
        "ai_tool": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "get_a_joke": {
        "ai_tool": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "days_from_now": {
        "ai_tool": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "create_password": {
        "ai_tool": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "n8n_blog_rss_feed": {
        "ai_tool": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Example Chat Window": {
        "main": [
          [
            {
              "node": "Your First AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "calculate_loan_payment": {
        "ai_tool": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "d6b502dfa4d9dd072cdc5c2bb763558661053f651289291352a84403e01b3d1b"
    },
    "nodes": [
      {
        "id": "6a36842b-b214-4683-9129-ad44f4b79117",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          440,
          -180
        ],
        "parameters": {
          "options": {
            "systemMessage": "=You are a helpful assistant.\nCurrent datetime is {{ $now.toString() }}"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "f7c9aaa7-9ba7-4bbe-909b-3085ed60a387",
        "name": "SearchEvent",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          2060,
          180
        ],
        "parameters": {
          "limit": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', ``, 'number') }}",
          "options": {},
          "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}",
          "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}",
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "gmsalomao2@gmail.com",
            "cachedResultName": "gmsalomao2@gmail.com"
          },
          "operation": "getAll"
        },
        "typeVersion": 1.3
      },
      {
        "id": "47f6077d-de8a-46f7-8d3a-3a21596dea1f",
        "name": "CreateEvent",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          2180,
          180
        ],
        "parameters": {
          "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}",
          "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}",
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "gmsalomao2@gmail.com",
            "cachedResultName": "gmsalomao2@gmail.com"
          },
          "additionalFields": {
            "summary": "={{ $fromAI(\"event_title\", \"The event title\", \"string\") }}",
            "description": "={{ $fromAI(\"event_description\", \"The event description\", \"string\") }}"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "7e3573c8-d4b5-4bd2-9aac-3bcfca1c8eb4",
        "name": "UpdateEvent",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          2300,
          180
        ],
        "parameters": {
          "eventId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Event_ID', ``, 'string') }}",
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "gmsalomao2@gmail.com",
            "cachedResultName": "gmsalomao2@gmail.com"
          },
          "operation": "update",
          "updateFields": {
            "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}",
            "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}",
            "summary": "={{ $fromAI(\"event_title\", \"The event title\", \"string\") }}",
            "description": "={{ $fromAI(\"event_description\", \"The event description\", \"string\") }}"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "fae46aa7-02c9-40d3-8f59-b46533e6a93c",
        "name": "DeleteEvent",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          2420,
          180
        ],
        "parameters": {
          "eventId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Event_ID', ``, 'string') }}",
          "options": {},
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": "gmsalomao2@gmail.com",
            "cachedResultName": "gmsalomao2@gmail.com"
          },
          "operation": "delete"
        },
        "typeVersion": 1.3
      },
      {
        "id": "da58e521-7e80-4d28-84fd-17732728855e",
        "name": "Google Calendar MCP",
        "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
        "position": [
          2060,
          -20
        ],
        "webhookId": "f9d9d5ea-6f83-42c8-ae50-ee6c71789bca",
        "parameters": {
          "path": "my-calendar"
        },
        "typeVersion": 1
      },
      {
        "id": "9a8490a0-eacf-4b7a-b6fd-e8d17a5cf25a",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          1440,
          880
        ],
        "parameters": {
          "workflowInputs": {
            "values": [
              {
                "name": "function_name"
              },
              {
                "name": "payload",
                "type": "object"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "c2430651-b604-4aff-bdc8-c51a7de9fcc1",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          1660,
          860
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "UPPERCASE",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "ab18304c-4f73-430f-b9fa-2ce4d098e1fa",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.function_name }}",
                      "rightValue": "uppercase"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "LOWERCASE",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "606bda79-f401-4de2-be9d-51368c794479",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.function_name }}",
                      "rightValue": "lowercase"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "RANDOM DATA",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "4b22e689-e652-47d2-b737-7be00da9f185",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.function_name }}",
                      "rightValue": "random_user_data"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "JOKE",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "27a75a2c-8058-4a7c-85c1-898cabeac4a1",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.function_name }}",
                      "rightValue": "joke"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "77df0d2c-ed4d-4da9-a218-acf4fd06cf13",
        "name": "Convert Text to Upper Case",
        "type": "n8n-nodes-base.set",
        "position": [
          2000,
          520
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "42333f26-8e14-438a-9965-eec31bf4b6a3",
                "name": "converted_text",
                "type": "string",
                "value": "={{ $json.payload.text.toUpperCase() }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "15e7489b-b1eb-4be1-80b0-0cb94d05daa3",
        "name": "Convert Text to Lower Case",
        "type": "n8n-nodes-base.set",
        "position": [
          2000,
          720
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "42333f26-8e14-438a-9965-eec31bf4b6a3",
                "name": "converted_text",
                "type": "string",
                "value": "={{ $json.payload.text.toLowerCase() }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "75bc9895-ccad-48b6-bd99-965a62f36f2a",
        "name": "Convert Text",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          1440,
          180
        ],
        "parameters": {
          "name": "convert_text_case",
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Call this tool to convert text to lower case or upper case.",
          "workflowInputs": {
            "value": {
              "payload": "={\n  \"text\": \"{{ $fromAI(\"text_to_convert\", \"The text to convert\", \"string\") }}\"\n}\n",
              "function_name": "={{ $fromAI(\"function_name\", \"Either lowercase or uppercase\", \"string\") }}"
            },
            "schema": [
              {
                "id": "function_name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "function_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "payload",
                "type": "object",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "payload",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "b2b8419d-f068-41ad-bcda-a057ddc82924",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          240,
          -180
        ],
        "webhookId": "7b02318f-1c6b-4f2a-9a4f-b17fa69ea680",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "3f4bee1a-18c8-45be-8038-b192f771e4d4",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          540,
          40
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "165cd445-13e6-4215-966a-0cd1cc4cb795",
        "name": "Calendar MCP",
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "position": [
          1080,
          60
        ],
        "parameters": {
          "sseEndpoint": "https://n8n.yourdomain/mcp/my-calendar/sse"
        },
        "typeVersion": 1
      },
      {
        "id": "3e2e655a-0d95-489e-9e4e-79415db90bbe",
        "name": "My Functions",
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "position": [
          920,
          60
        ],
        "parameters": {
          "sseEndpoint": "https://n8n.yourdomain/mcp/my-functions/sse"
        },
        "typeVersion": 1
      },
      {
        "id": "8fbf3a7b-171e-42f1-96f0-b4862a800721",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1320,
          -180
        ],
        "parameters": {
          "color": 3,
          "width": 620,
          "height": 520,
          "content": "## Activate the workflow to make the MCP Trigger work\nIn order to make the MCP server available, you need to activate the workflow.\n\nThen copy the Production URL of the MCP Trigger and paste it in the corresponding MCP Client tool."
        },
        "typeVersion": 1
      },
      {
        "id": "783b47d1-8b6d-4d45-903f-812dc46d80de",
        "name": "My Functions Server",
        "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
        "position": [
          1440,
          -20
        ],
        "webhookId": "83f72547-18b7-4f02-846b-27bf39d1efff",
        "parameters": {
          "path": "my-functions"
        },
        "typeVersion": 1
      },
      {
        "id": "31432882-2953-440c-9144-ba129ab2a8f7",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          820,
          -180
        ],
        "parameters": {
          "color": 7,
          "width": 440,
          "height": 520,
          "content": "## MCP Clients\nFor every tool here you need to obtain he corresponding Production URL from the MCP Triggers on the right üëâ"
        },
        "typeVersion": 1
      },
      {
        "id": "65269a4d-d6db-4767-b8bc-0992bfe42d17",
        "name": "Random user data",
        "type": "n8n-nodes-base.debugHelper",
        "position": [
          2000,
          1020
        ],
        "parameters": {
          "category": "randomData",
          "randomDataCount": "={{ $json.payload.number }}"
        },
        "typeVersion": 1
      },
      {
        "id": "2c97af29-d923-49a4-91e2-b6ff5d0fe322",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -480,
          -180
        ],
        "parameters": {
          "color": 7,
          "width": 660,
          "height": 640,
          "content": "# Try these example requests with the AI Agent\n\n### My Functions MCP\n1. Use your tools to convert this text to lower case: `EXAMPLE TeXt`\n\n2. Use your tools to convert this text to upper case: `example TeXt`\n\n3. Generate 5 random user data, please.\n\n4. Please obtain 3 jokes.\n\n\n\n\n### Calendar MCP\n5. What is my schedule for next week?\n\n6. I have a meeting with John tomorrow at 2pm. Please add it to my Calendar.\n\n7. Adjust the time of my meeting with John tomorrow from 2pm to 4pm, please.\n\n8. Cancel my meeting with John, tomorrow."
        },
        "typeVersion": 1
      },
      {
        "id": "77f8d96d-11da-4323-9925-58267da607c3",
        "name": "Generate random user data",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          1600,
          180
        ],
        "parameters": {
          "name": "random_user_data",
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Generate random user data",
          "workflowInputs": {
            "value": {
              "payload": "={\n  \"number\": {{ $fromAI(\"amount\", \"The amount of user data to generate in integer format\", \"number\") }}\n}",
              "function_name": "random_user_data"
            },
            "schema": [
              {
                "id": "function_name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "function_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "payload",
                "type": "object",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "payload",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "89d36f19-c7b4-4f53-9aec-2977bbd74de8",
        "name": "Return only some fields",
        "type": "n8n-nodes-base.set",
        "position": [
          2220,
          1020
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b4548cbe-f3fc-4911-901a-d73182d710a9",
                "name": "First name",
                "type": "string",
                "value": "={{ $json.firstname }}"
              },
              {
                "id": "6e573a27-ef03-4254-8f9b-2c471e1540c2",
                "name": "Last name",
                "type": "string",
                "value": "={{ $json.lastname }}"
              },
              {
                "id": "ac5b5806-bf8e-4e1a-a47d-e7180d31e98a",
                "name": "Email",
                "type": "string",
                "value": "={{ $json.email }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "a8cf7d60-b3d8-41cd-84d8-5cc1c299f33f",
        "name": "Joke Request",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2000,
          1220
        ],
        "parameters": {
          "url": "=https://official-joke-api.appspot.com/jokes/random/{{ $json.payload.number }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "76847e5d-2cc1-46f6-b0a6-0be81a5d0fea",
        "name": "Random Jokes",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          1760,
          180
        ],
        "parameters": {
          "name": "obtain_jokes",
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Call this tool to obtain random jokes",
          "workflowInputs": {
            "value": {
              "payload": "={\n  \"number\": {{ $fromAI(\"amount\", \"The amount of jokes to request\", \"number\") }}\n}",
              "function_name": "joke"
            },
            "schema": [
              {
                "id": "function_name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "function_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "payload",
                "type": "object",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "payload",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "2a34f767-7bf0-4c7c-8882-6dde62670383",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1320,
          360
        ],
        "parameters": {
          "color": 7,
          "width": 1260,
          "height": 1060,
          "content": "## The My Functions MCP calls this sub-workflow every time.\nA subworkflow is a separate workflow that can be called by other workflows and is able to receive parameters.\nLearn more about sub-workflows **[here](https://docs.n8n.io/flow-logic/subworkflows/)**"
        },
        "typeVersion": 1
      },
      {
        "id": "eda3b2a5-845a-413f-b866-759fe5e1a0b9",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1960,
          -180
        ],
        "parameters": {
          "color": 5,
          "width": 620,
          "height": 520,
          "content": "## Google Calendar tools require credentials\nIf you don't have your Google Credentials set up in n8n yet, watch [this](https://www.youtube.com/watch?v=3Ai1EPznlAc) video to learn how to do it.\n\nIf you are using n8n Cloud plans, it's very intuitive to setup and you may not even need the tutorial."
        },
        "typeVersion": 1
      },
      {
        "id": "4b100035-d803-46aa-8540-08e69d7f2179",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -480,
          1160
        ],
        "parameters": {
          "width": 660,
          "height": 180,
          "content": "# Need help?\nFor getting help with this workflow, please create a topic on the community forums here:\nhttps://community.n8n.io/c/questions/"
        },
        "typeVersion": 1
      },
      {
        "id": "74ad0058-87b6-4a91-88a5-a0cb72bce84d",
        "name": "OpenAI 4o",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          400,
          40
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "gpt-4o"
          },
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "c7f95bf5-23ed-4296-a2e0-dfb9fdebde94",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          240,
          160
        ],
        "parameters": {
          "color": 7,
          "height": 240,
          "content": "## Why model 4o? üëÜ\nAfter testing 4o-mini it had some difficulties handling the calendar requests, while the 4o model handled it with ease.\n\nDepending on your prompt and tools, 4o-mini might be able to work well too, but it requires further testing."
        },
        "typeVersion": 1
      },
      {
        "id": "f5c974cc-4277-4ab4-ada6-cad1d16dda80",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -480,
          -340
        ],
        "parameters": {
          "color": 4,
          "width": 3060,
          "height": 140,
          "content": ""
        },
        "typeVersion": 1
      },
      {
        "id": "a304ab81-9ef6-485d-b35a-76d2cc3d5c91",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          -300
        ],
        "parameters": {
          "color": 4,
          "width": 800,
          "height": 80,
          "content": "# Learn How to Build an MCP Server and Client"
        },
        "typeVersion": 1
      },
      {
        "id": "148904d6-f94b-4ec0-a026-2e5fb921c07f",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -480,
          480
        ],
        "parameters": {
          "color": 7,
          "width": 660,
          "height": 660,
          "content": "# Author\n![Solomon](https://gravatar.com/avatar/79aa147f090807fe0f618fb47a1de932669e385bb0c84bf3a7f891ae7d174256?r=pg&d=retro&size=200)\n### Solomon\nFreelance consultant from Brazil, specializing in automations and data analysis. I work with select clients, addressing their toughest projects.\n\nFor business inquiries, email me at automations.solomon@gmail.com\nOr message me on [Telegram](https://t.me/salomaoguilherme) for a faster response.\n\n### Check out my other templates\n### üëâ https://n8n.io/creators/solomon/\n"
        },
        "typeVersion": 1
      },
      {
        "id": "36aeb3a3-bcc3-4d50-84f9-87065f908248",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -460,
          1020
        ],
        "parameters": {
          "color": 4,
          "width": 620,
          "height": 80,
          "content": "### üí° **Want to learn advanced n8n skills and earn money building workflows?**\n‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚ÄéCheck out [Scrapes Academy](https://www.skool.com/scrapes/about?ref=21f10ad99f4d46ba9b8aaea8c9f58c34)"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {
      "When Executed by Another Workflow": [
        {
          "payload": {
            "number": 5
          },
          "function_name": "joke"
        }
      ]
    },
    "connections": {
      "Switch": {
        "main": [
          [
            {
              "node": "Convert Text to Upper Case",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Convert Text to Lower Case",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Random user data",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Joke Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI 4o": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "CreateEvent": {
        "ai_tool": [
          [
            {
              "node": "Google Calendar MCP",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "DeleteEvent": {
        "ai_tool": [
          [
            {
              "node": "Google Calendar MCP",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "SearchEvent": {
        "ai_tool": [
          [
            {
              "node": "Google Calendar MCP",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "UpdateEvent": {
        "ai_tool": [
          [
            {
              "node": "Google Calendar MCP",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Calendar MCP": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Convert Text": {
        "ai_tool": [
          [
            {
              "node": "My Functions Server",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "My Functions": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Random Jokes": {
        "ai_tool": [
          [
            {
              "node": "My Functions Server",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Random user data": {
        "main": [
          [
            {
              "node": "Return only some fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate random user data": {
        "ai_tool": [
          [
            {
              "node": "My Functions Server",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "cN4nA1LigjoreUYv",
    "meta": {
      "instanceId": "a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462",
      "templateCredsSetupCompleted": true
    },
    "name": "Enables updates to documents in RAG",
    "tags": [
      {
        "id": "oFVn9SpkmyjWZwco",
        "name": "Qdrant",
        "createdAt": "2024-12-04T16:52:58.409Z",
        "updatedAt": "2024-12-04T16:52:58.409Z"
      }
    ],
    "nodes": [
      {
        "id": "23afa2cc-7085-474f-aa9e-b110ef17208c",
        "name": "When clicking ‚ÄòTest workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -400,
          220
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "71115f33-f461-4942-9df1-e554e6432054",
        "name": "Embeddings OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          940,
          480
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "4zwP0MSr8zkNvvV9",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "81d855d2-a883-4e74-ae2a-1a4e722af4d7",
        "name": "Default Data Loader1",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          1080,
          480
        ],
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "file_id",
                  "value": "={{ $('Download files').item.json.id }}"
                },
                {
                  "name": "file_name",
                  "value": "={{ $('Download files').item.json.name }}"
                }
              ]
            }
          },
          "dataType": "binary",
          "binaryMode": "specificField"
        },
        "typeVersion": 1
      },
      {
        "id": "4e5539a5-0f3a-4de9-ba69-0eb7d9c00804",
        "name": "Qdrant Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
        "position": [
          1000,
          240
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "qdrantCollection": {
            "__rl": true,
            "mode": "list",
            "value": "negozio-emporio-verde",
            "cachedResultName": "negozio-emporio-verde"
          }
        },
        "credentials": {
          "qdrantApi": {
            "id": "iyQ6MQiVaF3VMBmt",
            "name": "QdrantApi account (Hetzner)"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8f944f0e-51a0-470e-9735-1ed539522acb",
        "name": "Create collection",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -140,
          -200
        ],
        "parameters": {
          "url": "http://QDRANTURL/collections/COLLECTION",
          "method": "PUT",
          "options": {},
          "jsonBody": "{\n  \"vectors\": {\n    \"size\": 1536,\n    \"distance\": \"Cosine\"  \n  },\n  \"shard_number\": 1,  \n  \"replication_factor\": 1,  \n  \"write_consistency_factor\": 1 \n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "qhny6r5ql9wwotpn",
            "name": "Qdrant API (Hetzner)"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "25c035aa-7a07-47cf-8878-44ac2eab0c3d",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          1060,
          680
        ],
        "parameters": {
          "options": {},
          "chunkSize": 500,
          "chunkOverlap": 50
        },
        "typeVersion": 1
      },
      {
        "id": "2ade51da-1711-4f71-8bd9-ebd3b6494b0b",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          420,
          220
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "74a224b0-8755-41ef-bb55-22e83b7d762d",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          1380,
          240
        ],
        "webhookId": "3d477cc3-8182-43e9-ae61-23e8ce308887",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "1c0d5b8c-e53e-47d3-aaac-ddccae80f280",
        "name": "Embeddings OpenAI2",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          620,
          1220
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "4zwP0MSr8zkNvvV9",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "f838f548-52dd-4aaf-aa97-9a8029018a1a",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          820,
          1260
        ],
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "file_id",
                  "value": "={{ $('Download file').item.json.file_id }}"
                },
                {
                  "name": "file_name",
                  "value": "={{ $binary.data.fileName}}"
                }
              ]
            }
          },
          "dataType": "binary",
          "binaryMode": "specificField"
        },
        "typeVersion": 1
      },
      {
        "id": "07bb3ae1-145f-4784-8409-d3bc73d5522c",
        "name": "Recursive Character Text Splitter1",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          860,
          1460
        ],
        "parameters": {
          "options": {},
          "chunkSize": 500,
          "chunkOverlap": 50
        },
        "typeVersion": 1
      },
      {
        "id": "dfa7b994-13b7-490f-82b7-5ae4ea1e2e7f",
        "name": "Delete single file",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          360,
          720
        ],
        "parameters": {
          "url": "http://QDRANTURL/collections/COLLECTION/points/delete",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"filter\": {\n    \"must\": [\n      {\n          \"key\": \"metadata.file_id\",\n          \"match\": { \"value\": \"{{$json.file_id}}\" }\n        }\n    ]\n  }\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "qhny6r5ql9wwotpn",
            "name": "Qdrant API (Hetzner)"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "44bf5e40-3947-4288-a7ba-7797ea6ad266",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          140,
          -280
        ],
        "parameters": {
          "color": 6,
          "width": 880,
          "height": 220,
          "content": "# STEP 1\n\n## Create Qdrant Collection\nChange:\n- QDRANTURL\n- COLLECTION"
        },
        "typeVersion": 1
      },
      {
        "id": "56e6534e-e191-4756-8bcf-d9ff8fc88b5f",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -160,
          700
        ],
        "parameters": {
          "height": 360,
          "content": "# STEP 3\n\n## FILE ID\nSet Google Drive File ID to update\n"
        },
        "typeVersion": 1
      },
      {
        "id": "f7098791-889a-4e9a-bd8f-f3b52dfc8839",
        "name": "Clear collection",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -140,
          220
        ],
        "parameters": {
          "url": "http://QDRANTURL/collections/COLLECTION/points/delete",
          "method": "POST",
          "options": {},
          "jsonBody": "{\n  \"filter\": {}\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "qhny6r5ql9wwotpn",
            "name": "Qdrant API (Hetzner)"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "d75a193e-e0cd-469a-8222-1ff183e2aa83",
        "name": "Get files",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          120,
          220
        ],
        "parameters": {
          "filter": {
            "driveId": {
              "__rl": true,
              "mode": "list",
              "value": "My Drive",
              "cachedResultUrl": "https://drive.google.com/drive/my-drive",
              "cachedResultName": "My Drive"
            },
            "folderId": {
              "__rl": true,
              "mode": "list",
              "value": "1RO5ByPhq2yvYLmbapTNC_kKdU5lZd4W5",
              "cachedResultUrl": "https://drive.google.com/drive/folders/1RO5ByPhq2yvYLmbapTNC_kKdU5lZd4W5",
              "cachedResultName": "Test Negozio"
            }
          },
          "options": {},
          "resource": "fileFolder"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "HEy5EuZkgPZVEa9w",
            "name": "Google Drive account (n3w.it)"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "4e5d5bd2-2aae-4d3b-978e-3ed29b641bb3",
        "name": "Download files",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          700,
          240
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {
            "googleFileConversion": {
              "conversion": {
                "docsToFormat": "text/plain"
              }
            }
          },
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "HEy5EuZkgPZVEa9w",
            "name": "Google Drive account (n3w.it)"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "074333a4-fbcc-42ce-aa05-212d545fdcb1",
        "name": "Download file",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          360,
          980
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.file_id }}"
          },
          "options": {
            "googleFileConversion": {
              "conversion": {
                "docsToFormat": "text/plain"
              }
            }
          },
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "HEy5EuZkgPZVEa9w",
            "name": "Google Drive account (n3w.it)"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "e4ee0aa9-e140-44b9-b581-6d98cb2857a9",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -560,
          1600
        ],
        "webhookId": "97d60090-1717-4195-bf27-2e3c3105b7f8",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "db644cc4-da46-4e9e-a092-f91762ca1c6b",
        "name": "Question and Answer Chain",
        "type": "@n8n/n8n-nodes-langchain.chainRetrievalQa",
        "position": [
          -240,
          1600
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.5
      },
      {
        "id": "9e7ebe5e-a854-44dc-8cb3-ec1663121b93",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -300,
          1800
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-1.5-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "0p34rXqIqy8WuoPg",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d7e29bec-2b8c-400c-b6d7-a82d7a2865a7",
        "name": "Vector Store Retriever",
        "type": "@n8n/n8n-nodes-langchain.retrieverVectorStore",
        "position": [
          -80,
          1820
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "e490e747-5395-4460-bdea-0781145f30b1",
        "name": "Qdrant Vector Store1",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
        "position": [
          -60,
          2020
        ],
        "parameters": {
          "options": {},
          "qdrantCollection": {
            "__rl": true,
            "mode": "list",
            "value": "ocr_mistral_test",
            "cachedResultName": "ocr_mistral_test"
          }
        },
        "credentials": {
          "qdrantApi": {
            "id": "iyQ6MQiVaF3VMBmt",
            "name": "QdrantApi account (Hetzner)"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "65261873-4ca5-4e23-bc65-220f971eb5b4",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          240,
          1600
        ],
        "parameters": {
          "width": 500,
          "height": 120,
          "content": "## STEP 4\nTest the RAG"
        },
        "typeVersion": 1
      },
      {
        "id": "ffbaabd0-7fd7-41db-bb71-4cccadf3e9c8",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          -180,
          2160
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "4zwP0MSr8zkNvvV9",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "23053690-c978-4b05-be26-e94f88c9d92f",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -480,
          100
        ],
        "parameters": {
          "color": 4,
          "width": 620,
          "height": 520,
          "content": "# STEP 2\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Documents vectorization with Qdrant and Google Drive\nChange:\n- QDRANTURL\n- COLLECTION"
        },
        "typeVersion": 1
      },
      {
        "id": "153a5098-56d1-4b7c-bb12-e6054db927a0",
        "name": "Edit Fields3",
        "type": "n8n-nodes-base.set",
        "position": [
          -100,
          880
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b413a226-0641-4ed8-9951-d17b6a6a9a4b",
                "name": "file_id",
                "type": "string",
                "value": "DRIVEFILE_ID"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "796f3ad4-e041-4af6-b3a5-72b3c3730c49",
        "name": "Update single file",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
        "position": [
          700,
          980
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "qdrantCollection": {
            "__rl": true,
            "mode": "list",
            "value": "negozio-emporio-verde",
            "cachedResultName": "negozio-emporio-verde"
          }
        },
        "credentials": {
          "qdrantApi": {
            "id": "iyQ6MQiVaF3VMBmt",
            "name": "QdrantApi account (Hetzner)"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "058c4929-ff59-41ca-8131-178e9038b354",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -200,
          -580
        ],
        "parameters": {
          "color": 3,
          "width": 840,
          "height": 220,
          "content": "# Enables full or incremental updates to documents in RAG system using Qdrant \nThis workflow automates the creation and management of a Retrieval-Augmented Generation (RAG) system using Qdrant as a vector store and Google Drive as the document source. It **enables full or incremental updates to documents** in the Qdrant vector database and integrates with a chatbot using Google Gemini for question answering."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "630e34d7-6558-49c3-b861-520b33fd0f91",
    "connections": {
      "Wait": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get files": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields3": {
        "main": [
          [
            {
              "node": "Download file",
              "type": "main",
              "index": 0
            },
            {
              "node": "Delete single file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download file": {
        "main": [
          [
            {
              "node": "Update single file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download files": {
        "main": [
          [
            {
              "node": "Qdrant Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Download files",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Clear collection": {
        "main": [
          [
            {
              "node": "Get files",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Qdrant Vector Store1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "Qdrant Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI2": {
        "ai_embedding": [
          [
            {
              "node": "Update single file",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Update single file",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Qdrant Vector Store": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader1": {
        "ai_document": [
          [
            {
              "node": "Qdrant Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Qdrant Vector Store1": {
        "ai_vectorStore": [
          [
            {
              "node": "Vector Store Retriever",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "Vector Store Retriever": {
        "ai_retriever": [
          [
            {
              "node": "Question and Answer Chain",
              "type": "ai_retriever",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Question and Answer Chain",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Question and Answer Chain",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader1",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Clear collection",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter1": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "DjICkfZc3MJRxo6g",
    "meta": {
      "instanceId": "a2b23892dd6989fda7c1209b381f5850373a7d2b85609624d7c2b7a092671d44",
      "templateCredsSetupCompleted": true
    },
    "name": "üí• Build Your First AI Agent with ChatGPT-5 ",
    "tags": [],
    "nodes": [
      {
        "id": "4fe554a8-5f53-40a5-8d2a-b01508f4e7a0",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1040,
          -368
        ],
        "parameters": {
          "width": 528,
          "height": 1088,
          "content": "### üé• Watch This Tutorial\n\n@[youtube](MYLub9KYlu8)\n\n\n### üì•  [Open full documentation on Notion](https://automatisation.notion.site/Build-Your-First-AI-Agent-with-ChatGPT-5-By-Dr-Firas-26f3d6550fd9801eb00dc0c578fc5f2c?source=copy_link)\n---\n### 1. What problem is this workflow solving?  \nManually handling client questions, checking your availability, and confirming bookings can be time-consuming and error-prone. This workflow automates the process, ensuring quick, accurate answers and seamless scheduling directly through chat.  \n\n\n---\n### 2. Setup\n1. Import this workflow into your n8n instance.  \n2. Connect your Google Sheets, Gmail, and Google Calendar credentials.  \n3. Add your knowledge base into Google Sheets (questions, answers, policies, packs, etc.).  \n4. Test the workflow using the **Connected Chat Trigger** node to start conversations with the AI Agent.  \n\n---\n### 3. How to customize this workflow to your needs  \n- Update the Google Sheets database with your own training packs, services, or company FAQs. [Sample Knowledgebase Data](https://docs.google.com/spreadsheets/d/1TIaqkiVRr-Z3VLC-mvXW2Ak1zO0becK1-wqcgVeop0E/copy)\n- Adjust the email template to reflect your branding and communication style.  \n- Modify the appointment duration if you need sessions longer or shorter than 1 hour.  \n- Add extra nodes (e.g., CRM integration) to capture leads or sync appointments with external systems.  \n---\n## üì¨ Need Help or Want to Customize This?\n**Contact me for consulting and support:** [LinkedIn](https://www.linkedin.com/in/dr-firas/) / [YouTube](https://www.youtube.com/@DRFIRASS)  \n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "cf792bfc-f214-419c-af01-40d2929455cd",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -512,
          -368
        ],
        "parameters": {
          "color": 7,
          "width": 1152,
          "height": 1088,
          "content": "## Build Your First AI Agent with ChatGPT-5 (By Dr. Firas)\nThis workflow allows users to chat with an AI Agent powered by ChatGPT-5, connected to a knowledge base stored in Google Sheets. The agent can answer company and training questions directly from the database, check availability in Google Calendar, and propose alternative time slots if needed. Once a time is confirmed, it creates a 1-hour appointment and ensures all bookings follow Paris time. Finally, the agent sends a confirmation email with full details of the scheduled meeting.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "2a2a64b2-06c1-4cb3-9043-f36c8ea38f1b",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -464,
          -240
        ],
        "parameters": {
          "color": 7,
          "width": 320,
          "height": 480,
          "content": "### 1. Ask Questions of Your Data\n\nYou can ask natural language questions to analyze your knowledge data, such as:\n- **Ask about company**, training packs, or policies directly from the knowledge base.\n- **Check availability for an appointment in Paris time.**.\n- **Confirm and book** your appointment once a slot is agreed."
        },
        "typeVersion": 1
      },
      {
        "id": "87c9f7a4-be90-4c36-8561-bfdd69defcff",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -464,
          240
        ],
        "parameters": {
          "color": 3,
          "width": 320,
          "height": 432,
          "content": "### 2. Set Up OpenAI Connection\n\n#### Get API Key:\n1. Go to [OpenAI Platform](https://platform.openai.com/api-keys)\n1. Go to [OpenAI Billing](https://platform.openai.com/settings/organization/billing/overview)\n2. Add funds to your billing account & copy your api key into the openAI credentials\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b9e43b10-1780-44ab-ac3b-27fa9813d227",
        "name": "Chat with Your Data",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -384,
          48
        ],
        "webhookId": "7ffb63b1-754e-4202-8b41-429ead296a61",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.3
      },
      {
        "id": "0b24279c-da42-44c8-b1ef-483326a086eb",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -144,
          -240
        ],
        "parameters": {
          "color": 7,
          "width": 736,
          "height": 912,
          "content": "### 3. Handle Scheduling & Appointments\nThe AI Agent manages the entire scheduling process with clarity and precision.\nIt ensures availability is checked, bookings are confirmed, and clients receive proper details.\n\n#### Connect your Knowledge Base in Google Sheets\n- Data must be in a format similar to this: [Sample Knowledgebase Data](https://docs.google.com/spreadsheets/d/1TIaqkiVRr-Z3VLC-mvXW2Ak1zO0becK1-wqcgVeop0E/copy)\n- Check availability in Paris time before booking.\n- Propose 3 alternative slots if chosen time is unavailable.\n- Confirm and create a 1-hour appointment only after client approval.\n- Send a single confirmation email with all booking details.\n- Tutorial: Configure Your Google Sheets, Gmail, Calendar [Credentials](https://youtu.be/fDzVmdw7bNU)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9b3813e6-fef3-4157-be3d-953d5eb4264b",
        "name": "Reasoning Tool (LangChain)",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          32,
          496
        ],
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "03e1a515-fe60-49f3-9191-95e9974b30d0",
        "name": "OpenAI GPT-5 Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -352,
          496
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5-mini",
            "cachedResultName": "gpt-5-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "bfba375e-9b5f-4460-a8fc-3938905b96a2",
        "name": "Knowledgebase Lookup",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          -96,
          496
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "e30d4c5c-4447-41ae-a526-096889c7146d",
        "name": "Calendar: Check Availability",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          176,
          496
        ],
        "parameters": {
          "options": {},
          "timeMax": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}",
          "timeMin": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "operation": "getAll",
          "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}"
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "WpT5yIBMcg2xRPPv",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "a9028dbc-e242-46ad-8da7-00e3f2c45dfe",
        "name": "Calendar: Create Appointment",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          320,
          496
        ],
        "parameters": {
          "end": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}",
          "start": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "additionalFields": {
            "summary": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Summary', ``, 'string') }}",
            "description": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', ``, 'string') }}"
          }
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "WpT5yIBMcg2xRPPv",
            "name": "Google Calendar account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "bc0357c3-4d1d-4a7e-871c-e03da33b3b9a",
        "name": "Send Booking Confirmation",
        "type": "n8n-nodes-base.gmailTool",
        "position": [
          464,
          496
        ],
        "webhookId": "6b43d6b2-7e94-4d42-bf4f-97fb4df1008c",
        "parameters": {
          "sendTo": "=",
          "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
          "options": {},
          "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "rKxQHWZ2F5XLJmwF",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "478b5d92-01e3-4d2e-92a2-3d6703e5d097",
        "name": "AI Agent Support",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          272,
          48
        ],
        "parameters": {
          "options": {
            "systemMessage": "=GOAL\n\nYour mission now has three possible goals (in this order of priority):\n\nAnswer and guide using the database: provide short, simple answers using information found via the Google Sheets node ‚ÄúGet Knowledgebase‚Äù (one call max per request).\n\nCheck the available time.\n\nBook the appointment.\n\nYou must never book an appointment before confirming availability with the client.\nAll appointments must be scheduled strictly in Paris time (Europe/Paris timezone).\n\nSECURE TOOLS YOU HAVE ACCESS TO\n\n### think ‚Üí You MUST use this to think carefully about how to handle the provided request data. This tool must be used on every turn and tool call interaction.\n\n### Get Knowledgebase ‚Üí Reads the Knowledgebase from Google Sheets (the database).\nConstraints:\n\nCall this node at most once per request (no second pass).\n\nUse it only for factual/company/pack/FAQ/policy/account questions.\n\nIf the info is missing, reply briefly that it is not available in the database (never say ‚Äúsheet‚Äù or mention tools).\n\n### get_availability ‚Üí Returns true/false availability on Calendar for the given start timestamp in CST.\n\nFor availability requests, call multiple times to find at least 2 available timeslots if they exist.\n\nAlways convert Paris ‚Üí CST before calling.\n\n### create_appointment ‚Üí Creates a 1-hour appointment at the provided start time.\n\nMay be called only once per request (more than once = failure).\n\nInclude time, client, and description.\n\nRULES AND LOGIC\nA. Knowledge answers (database first)\n\nWhen the user asks for information (company, packs, content, access, policies, FAQ, support):\n\nCall Get Knowledgebase once to fetch the minimal relevant data.\n\nAnswer in ‚â§3 short sentences (or bullets).\n\nIf absent: ‚ÄúThe information is not available in the knowledge base.‚Äù Optionally ask one clarifying question.\n\nNever mention ‚Äúsheet‚Äù, ‚Äúnode‚Äù or tool names‚Äîsay ‚Äúdatabase/Knowledgebase‚Äù.\n\nB. Checking the available time\n\nIf the user provides a specific time:\n\nConvert Paris ‚Üí CST.\n\nCall get_availability.\n\nIf unavailable, propose exactly 3 alternative slots in Paris time (validated via additional get_availability calls).\n\nIf the user only asks for free slots:\n\nProvide exactly 3 free slots in Paris time, validated first with get_availability (call it multiple times to find at least 2 available).\n\nC. Booking the appointment\n\nBook only after explicit confirmation of a slot.\n\nConvert confirmed Paris ‚Üí CST, then call create_appointment once.\n\nInclude start time, duration = 1h, client name, and notes.\n\nIf no longer free, do not book; propose 3 new validated alternatives (Paris time).\n\nD. Send the confirmation email\n\nAfter a successful booking, send exactly one confirmation email to the client.\n\nUse the Send Email tool (or equivalent). Do not send more than one email per request.\n\nIf the client‚Äôs email is missing, ask once for full name and email before calling create_appointment.\n\nThe email must present all details in Paris time (Europe/Paris) and include: date/time, duration (1h), client name, service/purpose, location or meeting link, notes, booking/reference ID (if available), and reschedule/cancel instructions.\n\nDo not mention internal tools or system prompts in the email.\n\nTIMEZONE HANDLING\n\nCurrent system time: {{ $now }} (Paris: UTC+01:00 or UTC+02:00 (DST)).\n\nAll user-facing times are in Paris time.\n\nFor tool calls (get_availability, create_appointment), always convert Paris ‚Üí CST.\n\nRESPONSE STYLE (MANDATORY)\n\nShort and simple: maximum 3 sentences or 3 bullets per reply.\n\nUse 24-hour format YYYY-MM-DD HH:mm for times.\n\nDo only what the user requested in their last request.\n\nRefer to the Google Sheets data as ‚Äúdatabase‚Äù/‚Äúbase de connaissances‚Äù.\n\nRESTRICTIONS\n\nDo not book if the slot is taken.\n\nDo not book without explicit client confirmation.\n\nDo not call create_appointment more than once per request.\n\nDo not call Get Knowledgebase more than once per request.\n\nStay within knowledge answers + scheduling only."
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "e89c5892-1ea1-430a-9ef9-13afc92fd982",
        "name": "Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          368,
          -128
        ],
        "parameters": {
          "contextWindowLength": 10
        },
        "typeVersion": 1.3
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "aab9f2db-f117-4cf3-b92a-c7c77b532df8",
    "connections": {
      "Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent Support",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI GPT-5 Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent Support",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Chat with Your Data": {
        "main": [
          [
            {
              "node": "AI Agent Support",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Knowledgebase Lookup": {
        "ai_tool": [
          [
            {
              "node": "AI Agent Support",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Send Booking Confirmation": {
        "ai_tool": [
          [
            {
              "node": "AI Agent Support",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Reasoning Tool (LangChain)": {
        "ai_tool": [
          [
            {
              "node": "AI Agent Support",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Calendar: Check Availability": {
        "ai_tool": [
          [
            {
              "node": "AI Agent Support",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Calendar: Create Appointment": {
        "ai_tool": [
          [
            {
              "node": "AI Agent Support",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "e409ea34548a2afe2dffba31130cd1cf2e98ebe2afaeed2a63caf2a0582d1da0",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "2c408b32-7862-4411-9ad1-b6e9ff4e41f7",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          592,
          -256
        ],
        "parameters": {
          "color": 7,
          "width": 512,
          "height": 352,
          "content": "## [Video Tutorial](https://youtu.be/laHIzhsz12E)\n@[youtube](laHIzhsz12E)"
        },
        "typeVersion": 1
      },
      {
        "id": "3808de8d-ef18-47f5-9621-b08ba961ae01",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Introduction Note",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -752,
          -256
        ],
        "parameters": {
          "width": 392,
          "height": 460,
          "content": "## Try It Out!\n\n**Launch your first AI agent‚Äîa chatbot that uses tools to fetch live info, send emails, and automate tasks.**\n\n### To get started:\n1.  **Connect Gemini** (see red sticky note below)\n2.  Click the **üó® Open chat** button and try asking:\n    *   ‚ÄúWhat‚Äôs the weather in Paris?‚Äù\n    *   ‚ÄúGet me the latest tech news.‚Äù\n    *   ‚ÄúGive me ideas for n8n AI agents.‚Äù\n\n### Questions or Feedback?\nFor feedback, coaching, buit-for-you workflows or any questions, use my unified AI-powered contact form.\n\n‚û°Ô∏è **[Get in Touch Here](https://api.ia2s.app/form/templates/academy)**\n\n*Happy Automating! ‚ÄîLucas Peyrin*"
        },
        "typeVersion": 1
      },
      {
        "id": "2b55763c-0541-4133-aa79-87c3ce9f0564",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -272,
          -160
        ],
        "parameters": {
          "color": 7,
          "width": 300,
          "height": 252,
          "content": "üí° Later, activate this workflow and share the public chat URL to let others talk to your AI Agent!"
        },
        "typeVersion": 1
      },
      {
        "id": "f09c396a-dab8-41f8-a6e5-3dbd1dd70323",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          112,
          -256
        ],
        "parameters": {
          "color": 7,
          "width": 396,
          "height": 348,
          "content": "Your AI agent can:\n1. **Receive** messages from the chat\n2. **Select** the right tools (e.g., weather, news, email)\n3. **Respond** with live, helpful answers\n\n\n**Open the AI agent node** and edit the **System Message** to adjust your agent‚Äôs thinking, behavior, and replies.\n\n\n\n\n\n\n\n\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "f7c57d33-2318-409d-9084-13990299db3d",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          112,
          176
        ],
        "parameters": {
          "color": 7,
          "width": 308,
          "height": 260,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis node helps your agent remember the last few messages to stay on topic."
        },
        "typeVersion": 1
      },
      {
        "id": "07ed7ed3-91d0-432f-9327-d2a30601082c",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          512,
          176
        ],
        "parameters": {
          "color": 7,
          "width": 372,
          "height": 324,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\nThese tools let your agent access real-world data or take actions. Add more to expand its abilities!\n\nClick the ‚ûï under the agent‚Äôs Tool input to add:\n- Google Calendar (Get Upcoming Events)\n- Gmail (Send an Email) (Gmail)"
        },
        "typeVersion": 1
      },
      {
        "id": "24fc1fd5-ed10-43d9-9b35-8facb7f357d5",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Get News",
        "type": "n8n-nodes-base.rssFeedReadTool",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          656,
          224
        ],
        "parameters": {
          "url": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('URL', `Use one of:\n- https://feeds.bbci.co.uk/news/world/rss.xml (BBC World ‚Äì global headlines)\n- https://www.aljazeera.com/xml/rss/all.xml (Al‚ÄØJazeera English ‚Äì in‚Äëdepth global coverage)\n- http://rss.cnn.com/rss/edition_world.rss (CNN World ‚Äì breaking news worldwide)\n- https://techcrunch.com/feed/ (TechCrunch ‚Äì global tech & startup news)\n- http://news.ycombinator.com/rss (Hacker News ‚Äì tech community headlines)\n- https://n8n.io/blog/rss (n8n Blog ‚Äì updates & tutorials)\n- https://www.bonappetit.com/feed/recipes-rss-feed/rss (Bon App√©tit ‚Äì recent recipes list)\n- https://www.endsreport.com/rss/news-and-analysis (ENDS Report ‚Äì environmental law & policy news)\n- https://medlineplus.gov/groupfeeds/new.xml (MedlinePlus ‚Äì health topics & wellness updates)`, 'string') }}",
          "options": {},
          "toolDescription": "Gets the latest blog posts about any rss feed."
        },
        "typeVersion": 1.2
      },
      {
        "id": "ac7d0dd1-8885-41c1-abda-f3742c838992",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Get Weather",
        "type": "n8n-nodes-base.httpRequestTool",
        "creator": "Lucas Peyrin",
        "position": [
          544,
          224
        ],
        "parameters": {
          "url": "https://api.open-meteo.com/v1/forecast",
          "options": {},
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "latitude",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters0_Value', `Latitude of the location, e.g. 45.75 for Lyon. Do not ask the user just infer it automatically.`, 'string') }}"
              },
              {
                "name": "longitude",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters1_Value', `Longitude of the location, e.g. 4.85 for Lyon. Do not ask the user just infer it automatically.`, 'string') }}"
              },
              {
                "name": "current",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters2_Value', `Comma-separated list of current weather variables (no whitespace).\n\nExample: temperature_2m,windspeed_10m,rain.\n\nOptions: temperature_2m,relative_humidity_2m,apparent_temperature,is_day,precipitation,rain,showers,snowfall,weathercode,cloudcover_total,pressure_msl,surface_pressure,windspeed_10m,winddirection_10m,windgusts_10m.`, 'string') }}"
              },
              {
                "name": "hourly",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters3_Value', `Comma-separated list of hourly weather variables (no whitespace). Hourly is only useful to get one day's information. For weakly overview please use daily.\n\nExample: temperature_2m,precipitation.\n\nOptions: temperature_2m,relative_humidity_2m,dewpoint_2m,apparent_temperature,precipitation,rain,showers,snowfall,snow_depth,pressure_msl,surface_pressure,cloudcover_total,cloudcover_low,cloudcover_mid,cloudcover_high,windspeed_10m,winddirection_10m,windgusts_10m,visibility,is_day,sunshine_duration,soil_temperature,soil_moisture,PM10,PM2_5,carbon_monoxide,ozone,us_aqi,UV_index.`, 'string') }}"
              },
              {
                "name": "daily",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters4_Value', `Comma-separated list of daily weather variables (no whitespace).\n\nExample: temperature_2m_max,precipitation_sum.\n\nOptions: weathercode,temperature_2m_max,temperature_2m_min,apparent_temperature_max,apparent_temperature_min,precipitation_sum,rain_sum,showers_sum,snowfall_sum,precipitation_hours,sunrise,sunset,daylight_duration,sunshine_duration,pressure_msl_max,pressure_msl_min,surface_pressure_max,surface_pressure_min,windgusts_10m_max,windspeed_10m_max,winddirection_10m_dominant,shortwave_radiation_sum.`, 'string') }}"
              },
              {
                "name": "start_date",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters5_Value', `Start date in YYYY-MM-DD format. Example: 2025-07-15`, 'string') }}"
              },
              {
                "name": "end_date",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters6_Value', `End date in YYYY-MM-DD format. Must be after start_date. Example: 2025-07-18`, 'string') }}"
              },
              {
                "name": "temperature_unit",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters7_Value', `Unit for temperature. Options: celsius (default), fahrenheit.`, 'string') }}"
              }
            ]
          },
          "toolDescription": "Get weather forecast anywhere, anytime. You can make requests by assuming most information, the only thing you need is the location (use the city name to infer lat and long automatically) and time period (assume today if not specified)"
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "332af12a-45ab-4e5d-8dab-da21ba2111f9",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Your First AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          192,
          -64
        ],
        "parameters": {
          "options": {
            "systemMessage": "=<role>\nYou are the n8n Demo AI Agent, a friendly and helpful assistant designed to showcase the power of AI agents within the n8n automation platform. Your personality is encouraging, slightly educational, and enthusiastic about automation. Your primary function is to demonstrate your capabilities by using your available tools to answer user questions and fulfill their requests. You are conversational.\n</role>\n\n<instructions>\n<goal>\nYour primary goal is to act as a live demonstration of an AI Agent built with n8n. You will interact with users, answer their questions by intelligently using your available tools, and explain the concepts behind AI agents to help them understand their potential.\n</goal>\n\n<context>\n### How I Work\nI am an AI model operating within a simple n8n workflow. This workflow gives me two key things:\n1.  **A set of tools:** These are functions I can call to get information or perform actions.\n2.  **Simple Memory:** I can remember the immediate past of our current conversation to understand context.\n\n### My Purpose\nMy main purpose is to be a showcase. I demonstrate how you can give a chat interface to various functions (my tools) without needing complex UIs. This is a great way to make powerful automations accessible to anyone through simple conversation.\n\n### My Tools Instructions\nYou must choose one of your available tools if the user's request matches its capability. You cannot perform these actions yourself; you must call the tool.\n\n### About AI Agents in n8n\n- **Reliability:** While I can use one tool at a time effectively, more advanced agents can perform multi-step tasks. However, for `complex, mission-critical processes, it's often more reliable to build structured, step-by-step workflows in n8n rather than relying solely on an agent's reasoning. Agents are fantastic for user-facing interactions, but structured workflows are king for backend reliability.\n- **Best Practices:** A good practice is to keep an agent's toolset focused, typically under 10-15 tools, to ensure reliability and prevent confusion.\n\n### Current Date & Time\n{{ $now }}\n</context>\n\n<output_format>\n- Respond in a friendly, conversational, and helpful tone.\n- When a user's request requires a tool, first select the appropriate tool. Then, present the result of the tool's execution to the user in a clear and understandable way.\n- Be proactive. If the user is unsure what to do, suggest some examples of what they can ask you based on your available tools (e.g., Talk about your tools and what you know about yourself).\n</output_format>\n</instructions>"
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "95421925-c5ad-48bd-9638-c84ff5b5e3c6",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Example Chat",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -176,
          -64
        ],
        "webhookId": "e5616171-e3b5-4c39-81d4-67409f9fa60a",
        "parameters": {
          "public": true,
          "options": {
            "title": "Your first AI Agent üöÄ",
            "subtitle": "This is for demo purposes. Try me out !",
            "responseMode": "lastNode",
            "inputPlaceholder": "Type your message here...",
            "showWelcomeScreen": false
          },
          "initialMessages": "Hi there! üëã"
        },
        "typeVersion": 1.1
      },
      {
        "id": "56d2684a-7f83-4ffd-8501-3253d999b4c6",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Conversation Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          224,
          224
        ],
        "parameters": {
          "contextWindowLength": 30
        },
        "typeVersion": 1.3
      },
      {
        "id": "c218a5da-bec7-4034-8d2b-f4bca34e551e",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Connect Gemini",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -176,
          224
        ],
        "parameters": {
          "options": {
            "temperature": 0
          }
        },
        "typeVersion": 1
      },
      {
        "id": "199eb2cd-bc6b-4f61-bbf1-f196c7869b43",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "¬© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -272,
          176
        ],
        "parameters": {
          "color": 3,
          "width": 294,
          "height": 316,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n1. [In Google AI Studio](https://aistudio.google.com/app/apikey) click **‚ÄúCreate API key in new project‚Äù** and copy it.\n\n2. Open the ```Connect Gemini``` node:\n   * **Select Credential ‚Üí Create New**\n   * Paste into **API Key** and **Save**\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Get News": {
        "ai_tool": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Get Weather": {
        "ai_tool": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Example Chat": {
        "main": [
          [
            {
              "node": "Your First AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Connect Gemini": {
        "ai_languageModel": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Conversation Memory": {
        "ai_memory": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "d6b502dfa4d9dd072cdc5c2bb763558661053f651289291352a84403e01b3d1b",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "0951fd33-1811-4a89-b84f-f46dc9e6fde1",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          20,
          -340
        ],
        "webhookId": "cdc03fce-33b6-4eed-86b5-f628994e5e31",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "699c2f89-5547-4d28-92a9-5e216aecb251",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          240,
          -340
        ],
        "parameters": {
          "options": {
            "maxIterations": 15,
            "systemMessage": "=You are a helpful assistant.\nCurrent timestamp is {{ $now }}"
          }
        },
        "typeVersion": 1.7
      },
      {
        "id": "640c29f7-b67e-49f6-a864-c9b396c446b7",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          160,
          -100
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "gpt-4o"
          },
          "options": {
            "temperature": 0.2
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "5LVOlVwHUgB8MAj2",
            "name": "OpenAI - n8n project"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "807630b4-c138-4b66-a438-fb70eab12a07",
        "name": "Calculator",
        "type": "@n8n/n8n-nodes-langchain.toolCalculator",
        "position": [
          840,
          60
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "132a97a3-239c-403f-843f-55b652e3efc5",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          840,
          640
        ],
        "parameters": {
          "jsCode": "// Ensure there's at least one input item.\nif (!items || items.length === 0) {\n  throw new Error(\"No input items found.\");\n}\n\n// Our input is expected to have a 'data' property containing the JSONP string.\nconst input = items[0].json;\n\nif (!input.data) {\n  throw new Error(\"Input JSON does not have a 'data' property.\");\n}\n\nconst rawData = input.data;\n\n// Use a regex to extract the JSON content from the Google Visualization JSONP response.\nconst regex = /google\\.visualization\\.Query\\.setResponse\\((.*)\\);?$/s;\nconst match = rawData.match(regex);\n\nif (!match) {\n  throw new Error(\"Input data does not match the expected Google Visualization JSONP format.\");\n}\n\nconst jsonString = match[1];\n\n// Parse the extracted JSON string.\nlet parsed;\ntry {\n  parsed = JSON.parse(jsonString);\n} catch (error) {\n  throw new Error(\"Failed to parse JSON: \" + error.message);\n}\n\n// Verify that the parsed JSON has the expected 'table' structure with 'cols' and 'rows'.\nif (!parsed.table || !Array.isArray(parsed.table.cols) || !Array.isArray(parsed.table.rows)) {\n  throw new Error(\"Parsed JSON does not have the expected 'table' structure with 'cols' and 'rows'.\");\n}\n\nconst cols = parsed.table.cols;\nconst rows = parsed.table.rows;\n\n// Helper function to convert date string from \"Date(YYYY,M,D)\" to \"YYYY-MM-DD\"\nfunction formatDate(dateStr) {\n  const match = dateStr.match(/^Date\\((\\d+),(\\d+),(\\d+)\\)$/);\n  if (!match) return dateStr;\n  const year = parseInt(match[1], 10);\n  const month = parseInt(match[2], 10) + 1; // JavaScript months are 0-indexed\n  const day = parseInt(match[3], 10);\n  // Format with leading zeros\n  return `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;\n}\n\n// Map each row into an object using the column labels as keys.\nconst newItems = rows.map(row => {\n  const obj = {};\n  cols.forEach((col, index) => {\n    let value = row.c && row.c[index] ? row.c[index].v : null;\n    // If the column type is \"date\" and the value is a string that looks like \"Date(YYYY,M,D)\"\n    if (col.type === \"date\" && typeof value === \"string\") {\n      value = formatDate(value);\n    }\n    obj[col.label] = value;\n  });\n  return { json: obj };\n});\n\n// Return the new array of items.\nreturn newItems;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "3dc1e670-bfb1-4b63-b9c8-85656134c843",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          280,
          640
        ],
        "parameters": {
          "workflowInputs": {
            "values": [
              {
                "name": "start_date"
              },
              {
                "name": "end_date"
              },
              {
                "name": "status"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "52a26e43-12a5-4b4a-a224-d70cdabf6aaf",
        "name": "Records by date",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          1020,
          -120
        ],
        "parameters": {
          "name": "records_by_date_and_or_status",
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "a2BIIjr2gLBay06M",
            "cachedResultName": "Template | Your first AI Data Analyst"
          },
          "description": "Use this tool to get records filtered by date. You can also filter by status at the same time, if you want.",
          "workflowInputs": {
            "value": {
              "status": "={{ $fromAI(\"status\", \"Status of the transaction. Can be Completed, Refund or Error. Leave empty if you don't need this now.\", \"string\") }}",
              "end_date": "={{ $fromAI(\"end_date\", \"End date in format YYYY-MM-DD\", \"string\") }}",
              "start_date": "={{ $fromAI(\"start_date\", \"Start date in format YYYY-MM-DD\", \"string\") }}"
            },
            "schema": [
              {
                "id": "start_date",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "start_date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "end_date",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "end_date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2
      },
      {
        "id": "e1811519-8699-4243-8c64-0db1ab26004d",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          1280,
          640
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData"
        },
        "typeVersion": 1
      },
      {
        "id": "3b129abd-ac9a-460c-abb3-007e2c94e284",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1220,
          400
        ],
        "parameters": {
          "color": 7,
          "width": 220,
          "height": 400,
          "content": "To send all the items back to the AI, we need to finish with everything aggregated into one single item.\n\nOtherwise it will respond with one item at a time, and the AI will only get the first item that arrives."
        },
        "typeVersion": 1
      },
      {
        "id": "645ac0f9-8022-4f2c-8c6c-5aadd6cf09cc",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          460,
          400
        ],
        "parameters": {
          "color": 7,
          "width": 300,
          "height": 400,
          "content": "This node sends a custom HTTP Request to the Google Sheets API.\n\nFiltering by date range in the Google Sheets API is very complicated.\n\nThis node solves that problem.\n\nBut doing the same in a database is much simpler. A tool could do it without needing a sub-workflow."
        },
        "typeVersion": 1
      },
      {
        "id": "14221a72-914d-4c75-866a-d64ba7f8109f",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          780,
          400
        ],
        "parameters": {
          "color": 7,
          "width": 220,
          "height": 400,
          "content": "The output from this complex request is also messy.\n\nSo we use some code generated by ChatGPT to transform the data into JSON objects."
        },
        "typeVersion": 1
      },
      {
        "id": "f12668ea-b59d-4caf-a997-381f78b7cfe7",
        "name": "Google Sheets request",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          560,
          640
        ],
        "parameters": {
          "url": "https://docs.google.com/spreadsheets/d/18A4d7KYrk8-uEMbu7shoQe_UIzmbTLV1FMN43bjA7qc/gviz/tq",
          "options": {},
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "sheet",
                "value": "Sheet1"
              },
              {
                "name": "tq",
                "value": "=SELECT * WHERE A >= DATE \"{{ $json.start_date }}\" AND A <= DATE \"{{ $json.end_date }}\""
              }
            ]
          },
          "nodeCredentialType": "googleSheetsOAuth2Api"
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "YR4pbjuZM5Xs4CTD",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f59a2606-0981-43d1-9a07-b802891b9220",
        "name": "Get transactions by product name",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          1020,
          -320
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupValue": "={{ $fromAI(\"product_name\", \"The product name\", \"string\") }}",
                "lookupColumn": "Product"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/18A4d7KYrk8-uEMbu7shoQe_UIzmbTLV1FMN43bjA7qc/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "url",
            "value": "https://docs.google.com/spreadsheets/d/18A4d7KYrk8-uEMbu7shoQe_UIzmbTLV1FMN43bjA7qc/edit?usp=sharing"
          },
          "descriptionType": "manual",
          "toolDescription": "Find transactions by product.\nOur products are:\n- Widget A\n- Widget B\n- Widget C\n- Widget D"
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "YR4pbjuZM5Xs4CTD",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "1ed7168c-1639-4b3b-a3b4-ed162bcef880",
        "name": "Get all transactions",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          840,
          -120
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/18A4d7KYrk8-uEMbu7shoQe_UIzmbTLV1FMN43bjA7qc/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "url",
            "value": "https://docs.google.com/spreadsheets/d/18A4d7KYrk8-uEMbu7shoQe_UIzmbTLV1FMN43bjA7qc/edit?usp=sharing"
          },
          "descriptionType": "manual",
          "toolDescription": "Only use this as last resort, because it will pull all data at once."
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "YR4pbjuZM5Xs4CTD",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "798453da-8a65-4d14-ae0a-778d64ab02ad",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -360,
          -340
        ],
        "parameters": {
          "color": 4,
          "width": 320,
          "height": 340,
          "content": "## Some questions to try\nThere's a red button on this page that you can click to chat with the AI.\n\nTry asking it these questions:\n\n- How many refunds in January and what was the amount refunded?\n\n- How many successful sales did we have in January 2025 and what was the final income of those?\n\n- What is the most frequent reason for refunds?"
        },
        "typeVersion": 1
      },
      {
        "id": "b8336f1a-3855-4247-9589-2f9aa35d211f",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -780,
          -340
        ],
        "parameters": {
          "color": 4,
          "width": 400,
          "content": "## Copy this Sheets file to your Google Drive\nhttps://docs.google.com/spreadsheets/d/18A4d7KYrk8-uEMbu7shoQe_UIzmbTLV1FMN43bjA7qc/edit?gid=0#gid=0"
        },
        "typeVersion": 1
      },
      {
        "id": "99a55b39-965b-4454-b416-d3991f0bdfbc",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          940,
          60
        ],
        "parameters": {
          "color": 7,
          "width": 200,
          "height": 140,
          "content": "### üëà\nThe Calculator is a tool that allows an agent to run mathematical calculations."
        },
        "typeVersion": 1
      },
      {
        "id": "7ebebf56-e065-41c4-8270-f636785b0def",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -780,
          -160
        ],
        "parameters": {
          "color": 4,
          "width": 400,
          "content": "### How to connect to Google Sheets?\nTo connect your n8n to your Google Sheets you're gonna need Google OAuth credentials\n\nSee documentation **[here](https://docs.n8n.io/integrations/builtin/credentials/google/oauth-single-service/)**"
        },
        "typeVersion": 1
      },
      {
        "id": "b64df0dd-6425-4fc2-9f60-8c5a85412d61",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          120,
          20
        ],
        "parameters": {
          "color": 7,
          "width": 170,
          "height": 260,
          "content": "## üëÜ\nYou can use many models here, including the free Google Gemini options.\n\nMake sure to test it thoroughly. Some models are better for data analysis."
        },
        "typeVersion": 1
      },
      {
        "id": "23c7bb52-b189-45f1-949b-ea588f065583",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          340,
          20
        ],
        "parameters": {
          "color": 7,
          "width": 150,
          "height": 260,
          "content": "## üëÜ\nThis is a short term memory. It will remember the 5 previous interactions during the chat"
        },
        "typeVersion": 1
      },
      {
        "id": "6097e5a1-139b-4329-81ff-4fda16ea5221",
        "name": "Buffer Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          360,
          -100
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "6de4a7f2-5c58-4401-bd7c-19c5a73ba775",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1160,
          -320
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 180,
          "content": "The **AI Tools Agent** has access to all the tools at the same time. It uses the name and description to decide when to use each tool.\n\nNotice I'm using `$fromAI` function in all of them.\n\nSee documentations **[here](https://docs.n8n.io/advanced-ai/examples/using-the-fromai-function/)**"
        },
        "typeVersion": 1
      },
      {
        "id": "a308d895-bc18-4b2c-9567-78f6c29f79e8",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1160,
          -120
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 320,
          "content": "## üëà This is a special tool\nIt is used to call another workflow.\nThis concept is called sub-workflow.\n\nSee documentation [here](https://docs.n8n.io/flow-logic/subworkflows/).\n\nInstead of running a completely separate workflow, we are calling the one below.\n\nIt's contained in the same workflow, but we are using the trigger to define it will run only when called by this tool."
        },
        "typeVersion": 1
      },
      {
        "id": "0a6d94bc-21e1-4949-b7f4-c93abbecf08c",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          120,
          340
        ],
        "parameters": {
          "color": 7,
          "width": 1380,
          "height": 520,
          "content": "# Sub-workflow\nThe AI can call this sub-workflow anytime,\nby using the **Records by date** tool.\n\nThe sub-workflow automatically return\n the result of the last executed node to the AI."
        },
        "typeVersion": 1
      },
      {
        "id": "3e424615-6e49-4bd3-b066-005b9f0f773e",
        "name": "Filter by status",
        "type": "n8n-nodes-base.filter",
        "position": [
          1060,
          640
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "e50da873-bbbd-41d3-a418-83193907977c",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $json.Status }}",
                "rightValue": "={{ $('When Executed by Another Workflow').item.json.status }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "0ad0102c-adb9-4ec9-bdf3-b1ce425b88ba",
        "name": "Get transactions by status",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          840,
          -320
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupValue": "={{ $fromAI(\"transaction_status\", \"Transaction status can be Refund, Completed or Error\", \"string\") }}",
                "lookupColumn": "Status"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/18A4d7KYrk8-uEMbu7shoQe_UIzmbTLV1FMN43bjA7qc/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "url",
            "value": "https://docs.google.com/spreadsheets/d/18A4d7KYrk8-uEMbu7shoQe_UIzmbTLV1FMN43bjA7qc/edit?usp=sharing"
          },
          "descriptionType": "manual",
          "toolDescription": "Find transactions by status"
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "YR4pbjuZM5Xs4CTD",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "5b80cb08-6e19-47b2-8146-c299e709a34a",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          820,
          -540
        ],
        "parameters": {
          "color": 4,
          "width": 300,
          "content": "## Change the URL of the Sheets file in all the Sheets tools üëá"
        },
        "typeVersion": 1
      },
      {
        "id": "ddc1351e-0ad0-480f-9742-30f2aa860d61",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          500,
          820
        ],
        "parameters": {
          "color": 4,
          "width": 260,
          "height": 100,
          "content": "## üëÜ Change the URL of the Sheets file"
        },
        "typeVersion": 1
      },
      {
        "id": "ab837a10-932f-4b14-8e2c-546077ca2c86",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -780,
          20
        ],
        "parameters": {
          "color": 7,
          "width": 740,
          "height": 640,
          "content": "# Author\n![Solomon](https://gravatar.com/avatar/79aa147f090807fe0f618fb47a1de932669e385bb0c84bf3a7f891ae7d174256?r=pg&d=retro&size=200)\n### Solomon\nFreelance consultant from Brazil, specializing in automations and data analysis. I work with select clients, addressing their toughest projects.\n\nFor business inquiries, email me at automations.solomon@gmail.com\nOr message me on [Telegram](https://t.me/salomaoguilherme) for a faster response.\n\n### Check out my other templates\n### üëâ https://n8n.io/creators/solomon/\n"
        },
        "typeVersion": 1
      },
      {
        "id": "e58351b3-3b18-4c03-9435-27ba853d03bb",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -780,
          680
        ],
        "parameters": {
          "width": 740,
          "height": 180,
          "content": "# Need help?\nFor getting help with this workflow, please create a topic on the community forums here:\nhttps://community.n8n.io/c/questions/"
        },
        "typeVersion": 1
      },
      {
        "id": "4519d880-7448-4fb3-b2dc-ccea787729be",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -760,
          560
        ],
        "parameters": {
          "color": 4,
          "width": 700,
          "height": 80,
          "content": "### üí° **Want to learn advanced n8n skills and earn money building workflows?**\n‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚Äé ‚ÄéCheck out [Scrapes Academy](https://www.skool.com/scrapes/about?ref=21f10ad99f4d46ba9b8aaea8c9f58c34)"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Code": {
        "main": [
          [
            {
              "node": "Filter by status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Calculator": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Buffer Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Records by date": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Filter by status": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Get all transactions": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets request": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get transactions by status": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get transactions by product name": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "Google Sheets request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "4bdd4360-b518-4b46-81fa-0d3183ce642d",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          680,
          260
        ],
        "parameters": {
          "workflowInputs": {
            "values": [
              {
                "name": "operation"
              },
              {
                "name": "query"
              },
              {
                "name": "employeeId"
              },
              {
                "name": "values",
                "type": "object"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "74bdcff0-0615-4d81-82ff-ff8340939399",
        "name": "Operation",
        "type": "n8n-nodes-base.switch",
        "position": [
          1040,
          260
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "searchEmployee",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "81b134bc-d671-4493-b3ad-8df9be3f49a6",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $('When Executed by Another Workflow').first().json.operation }}",
                      "rightValue": "searchEmployees"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "getEmployeeById",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "8d57914f-6587-4fb3-88e0-aa1de6ba56c1",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $('When Executed by Another Workflow').first().json.operation }}",
                      "rightValue": "getEmployeeById"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "updateEmployee",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "7c38f238-213a-46ec-aefe-22e0bcb8dffc",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $('When Executed by Another Workflow').first().json.operation }}",
                      "rightValue": "updateEmployee"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "8850cd57-9bc1-43b7-9366-7d91afc7bc42",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          -120
        ],
        "parameters": {
          "color": 7,
          "width": 680,
          "height": 660,
          "content": "## 1. Set up an MCP Server Trigger\n[Read more about the MCP Server Trigger](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-langchain.mcptrigger)"
        },
        "typeVersion": 1
      },
      {
        "id": "ad541df3-44ed-4ef4-af91-841dc9986b4c",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          620,
          -120
        ],
        "parameters": {
          "color": 7,
          "width": 600,
          "height": 260,
          "content": "## 2. Build Your MCP Server from Existing APIs\n[Read more about the HTTP Request Node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest)\n\nN8N allows any organisation to quickly build and host their own MCP server by leveraging existing APIs. Here's a quick example for PayCaptain.com - a cloud-based payroll software for modern companies.\n\nWith this set of tools, Paycaptain customers can simplify employee management from within their favourite MCP client such as Claude Desktop. Better yet, n8n also handles distribution so this MCP server can serve entire departments as well."
        },
        "typeVersion": 1
      },
      {
        "id": "962cb379-8916-4a9f-8a7b-5aa9d31d5d88",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          -240
        ],
        "parameters": {
          "color": 5,
          "width": 380,
          "height": 100,
          "content": "### Always Authenticate Your Server!\nBefore going to production, it's always advised to enable authentication on your MCP server trigger."
        },
        "typeVersion": 1
      },
      {
        "id": "27163110-36d7-46f3-92fc-dce7d000655e",
        "name": "Paycaptain MCP Server",
        "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
        "position": [
          80,
          40
        ],
        "webhookId": "5f6728df-d3e8-48bb-9a38-0f2e54c7962c",
        "parameters": {
          "path": "5f6728df-d3e8-48bb-9a38-0f2e54c7962c"
        },
        "typeVersion": 1
      },
      {
        "id": "13a69580-de33-489a-85c8-582877efbfe0",
        "name": "Update Employee",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          380,
          260
        ],
        "parameters": {
          "name": "updateEmployee",
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Updates an employee's details.",
          "workflowInputs": {
            "value": {
              "query": "null",
              "values": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('values', ``, 'string') }}",
              "operation": "updateEmployee",
              "employeeId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('employeeId', ``, 'string') }}"
            },
            "schema": [
              {
                "id": "operation",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "operation",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "query",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "query",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "employeeId",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "employeeId",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "values",
                "type": "object",
                "display": true,
                "required": false,
                "displayName": "values",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "68c066f0-657c-46cb-a9fe-b31e9850c512",
        "name": "Get Employee",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          240,
          360
        ],
        "parameters": {
          "name": "getEmployeeById",
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Returns an employee's details by employee ID.",
          "workflowInputs": {
            "value": {
              "query": "null",
              "values": "null",
              "operation": "getEmployeeById",
              "employeeId": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('employeeId', ``, 'string') }}"
            },
            "schema": [
              {
                "id": "operation",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "operation",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "query",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "query",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "employeeId",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "employeeId",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "values",
                "type": "object",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "values",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "87661e95-b618-4701-b0f3-9f0532d5fc75",
        "name": "Get Employees",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1380,
          60
        ],
        "parameters": {
          "url": "https://api.paycaptain.com/employees",
          "options": {
            "pagination": {
              "pagination": {
                "parameters": {
                  "parameters": [
                    {
                      "name": "page",
                      "value": "={{ $request.qs.page + 1 }}"
                    }
                  ]
                },
                "maxRequests": 3,
                "requestInterval": 1000,
                "limitPagesFetched": true
              }
            }
          },
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "company",
                "value": "paycaptain"
              },
              {
                "name": "page",
                "value": "={{ $json.page ?? 1 }}"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "sPolCkoJ1zhzWabJ",
            "name": "JWT TOKEN"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "866868e2-e0b0-4d8d-bf3c-57d68fea8b86",
        "name": "Search Employees",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          100,
          260
        ],
        "parameters": {
          "name": "searchEmployees",
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "description": "Searches for and returns an employee's details.",
          "workflowInputs": {
            "value": {
              "query": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('query', ``, 'string') }}",
              "values": "null",
              "operation": "searchEmployees",
              "employeeId": "null"
            },
            "schema": [
              {
                "id": "operation",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "operation",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "query",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "query",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "employeeId",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "employeeId",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "values",
                "type": "object",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "values",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "679a2413-448f-43d8-98fc-7fd8b83775e7",
        "name": "Log Call",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          860,
          260
        ],
        "parameters": {
          "columns": {
            "value": {
              "query": "={{ $json.query }}",
              "values": "={{ $json.values.toJsonString() }}",
              "operation": "={{ $json.operation }}",
              "timestamp": "={{ $now.toISO() }}",
              "employeeId": "={{ $json.employeeId }}"
            },
            "schema": [
              {
                "id": "timestamp",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "timestamp",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "operation",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "operation",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "query",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "query",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "employeeId",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "employeeId",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "values",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "values",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {
            "useAppend": true
          },
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ls_3pmzIafl1NUAzzflkJgyq1smPW6vfGjbVuVzdkac/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1Ls_3pmzIafl1NUAzzflkJgyq1smPW6vfGjbVuVzdkac",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ls_3pmzIafl1NUAzzflkJgyq1smPW6vfGjbVuVzdkac/edit?usp=drivesdk",
            "cachedResultName": "98. MCP Audit"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "XHvC7jIRR8A2TlUl",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "7723947c-94a3-4bf1-b6c8-b595027a33dc",
        "name": "Filter Matches",
        "type": "n8n-nodes-base.filter",
        "position": [
          1580,
          60
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "baa681eb-d6d9-450b-99ab-58d33e81cef4",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{\n[\n  $json.hrEmployeeId,\n  $json.payrollCode,\n  $json.firstName + ' ' + $json.lastName,\n  $json.email,\n  $json.niNumber,\n  $json.mailingCity,\n  $json.jobTitle,\n  $json.jobGrade,\n  $json.department,\n  $json.team\n]\n  .join(' ')\n  .toLowerCase()\n}}",
                "rightValue": "={{ $('When Executed by Another Workflow').first().json.query.toLowerCase() }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "f4d1ddd9-dde7-437f-9aa2-969ea0832f71",
        "name": "Aggregate Search Results",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          2020,
          60
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData",
          "destinationFieldName": "response"
        },
        "typeVersion": 1
      },
      {
        "id": "45076cec-f554-44ae-b314-e43ba080abb5",
        "name": "Get Employees1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1380,
          260
        ],
        "parameters": {
          "url": "https://api.paycaptain.com/employees",
          "options": {
            "pagination": {
              "pagination": {
                "parameters": {
                  "parameters": [
                    {
                      "name": "page",
                      "value": "={{ $request.qs.page + 1 }}"
                    }
                  ]
                },
                "maxRequests": 3,
                "requestInterval": 1000,
                "limitPagesFetched": true
              }
            }
          },
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "company",
                "value": "paycaptain"
              },
              {
                "name": "page",
                "value": "={{ $json.page ?? 1 }}"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "sPolCkoJ1zhzWabJ",
            "name": "JWT TOKEN"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "b6f3a56f-5cd2-4f4d-904b-49e82ec591b8",
        "name": "Filter Matching ID",
        "type": "n8n-nodes-base.filter",
        "position": [
          1580,
          260
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "cfb2ba5b-14c0-4867-be4d-180306c896ae",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.hrEmployeeId }}",
                "rightValue": "={{ $('When Executed by Another Workflow').first().json.employeeId }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "ecc2d8d5-4a23-4bfd-840b-63c28980462f",
        "name": "Strip Sensitive Fields1",
        "type": "n8n-nodes-base.set",
        "position": [
          1800,
          260
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e20217cf-7c70-4907-9da6-a114104a099e",
                "name": "company",
                "type": "string",
                "value": "={{ $json.company }}"
              },
              {
                "id": "2dfe8342-c442-4ac3-90bd-92fe7d38d407",
                "name": "hrEmployeeId",
                "type": "string",
                "value": "={{ $json.hrEmployeeId }}"
              },
              {
                "id": "57fe4519-246b-44aa-a0c9-22e1e865041c",
                "name": "payrollCode",
                "type": "string",
                "value": "={{ $json.payrollCode }}"
              },
              {
                "id": "d296021c-09b2-43b2-8b8e-ebb5d7d9d14d",
                "name": "firstName",
                "type": "string",
                "value": "={{ $json.firstName }}"
              },
              {
                "id": "661e0049-d28f-4f78-83fc-7a1b21f742c2",
                "name": "lastName",
                "type": "string",
                "value": "={{ $json.lastName }}"
              },
              {
                "id": "59f7fd87-ba84-426a-ad61-c682cf8227bf",
                "name": "email",
                "type": "string",
                "value": "={{ $json.email }}"
              },
              {
                "id": "9769c078-c5f5-4d56-b467-765dd73444f9",
                "name": "phone",
                "type": "string",
                "value": "={{ $json.phone }}"
              },
              {
                "id": "e387bc11-dccf-4baf-b87f-a2abb5f61b5d",
                "name": "mailingStreet",
                "type": "string",
                "value": "={{ $json.mailingStreet }}"
              },
              {
                "id": "415451c5-c3c1-42d4-9f5b-829277bfb7f3",
                "name": "mailingStateProvince",
                "type": "string",
                "value": "={{ $json.mailingStateProvince }}"
              },
              {
                "id": "cf2a83f4-28a8-44bd-9d06-780db1406f8f",
                "name": "mailingPostalCode",
                "type": "string",
                "value": "={{ $json.mailingPostalCode }}"
              },
              {
                "id": "94ee2e05-9969-43f2-a732-57356f8b4dfe",
                "name": "mailingCountry",
                "type": "string",
                "value": "={{ $json.mailingCountry }}"
              },
              {
                "id": "b01a56c9-fc42-4bff-9443-27075699986f",
                "name": "location",
                "type": "string",
                "value": "={{ $json.location }}"
              },
              {
                "id": "b9175d72-6976-4765-b773-f4521668d130",
                "name": "department",
                "type": "string",
                "value": "={{ $json.department }}"
              },
              {
                "id": "d784e800-e13b-4d43-907c-11aaaf4ee24f",
                "name": "team",
                "type": "string",
                "value": "={{ $json.team }}"
              },
              {
                "id": "1ff68eb6-35f9-4a2d-9a37-14b3a6f6e0ee",
                "name": "jobGrade",
                "type": "string",
                "value": "={{ $json.jobGrade }}"
              },
              {
                "id": "5628bbf8-872d-4e3a-bf37-c36f13c0f4b1",
                "name": "jobTitle",
                "type": "string",
                "value": "={{ $json.jobTitle }}"
              },
              {
                "id": "34f26d59-43b3-4f2c-955b-f6d5ab22a083",
                "name": "jobEffectiveDate",
                "type": "string",
                "value": "={{ $json.jobEffectiveDate }}"
              },
              {
                "id": "e3023e94-fbc8-4e9b-b106-687ea533e3f8",
                "name": "contractType",
                "type": "string",
                "value": "={{ $json.contractType }}"
              },
              {
                "id": "d3dcf24c-5e9b-40e5-9f54-fca930ab1528",
                "name": "normalWeeklyHours",
                "type": "number",
                "value": "={{ $json.normalWeeklyHours }}"
              },
              {
                "id": "65ed75a6-1ec1-456f-b19b-4492e31f5c18",
                "name": "daysWorkedPerWeek",
                "type": "number",
                "value": "={{ $json.daysWorkedPerWeek }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "77a71a55-f0cf-4f76-b697-b31dba447f30",
        "name": "Strip Sensitive Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          1800,
          60
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e20217cf-7c70-4907-9da6-a114104a099e",
                "name": "company",
                "type": "string",
                "value": "={{ $json.company }}"
              },
              {
                "id": "2dfe8342-c442-4ac3-90bd-92fe7d38d407",
                "name": "hrEmployeeId",
                "type": "string",
                "value": "={{ $json.hrEmployeeId }}"
              },
              {
                "id": "57fe4519-246b-44aa-a0c9-22e1e865041c",
                "name": "payrollCode",
                "type": "string",
                "value": "={{ $json.payrollCode }}"
              },
              {
                "id": "d296021c-09b2-43b2-8b8e-ebb5d7d9d14d",
                "name": "firstName",
                "type": "string",
                "value": "={{ $json.firstName }}"
              },
              {
                "id": "661e0049-d28f-4f78-83fc-7a1b21f742c2",
                "name": "lastName",
                "type": "string",
                "value": "={{ $json.lastName }}"
              },
              {
                "id": "59f7fd87-ba84-426a-ad61-c682cf8227bf",
                "name": "email",
                "type": "string",
                "value": "={{ $json.email }}"
              },
              {
                "id": "9769c078-c5f5-4d56-b467-765dd73444f9",
                "name": "phone",
                "type": "string",
                "value": "={{ $json.phone }}"
              },
              {
                "id": "e387bc11-dccf-4baf-b87f-a2abb5f61b5d",
                "name": "mailingStreet",
                "type": "string",
                "value": "={{ $json.mailingStreet }}"
              },
              {
                "id": "415451c5-c3c1-42d4-9f5b-829277bfb7f3",
                "name": "mailingStateProvince",
                "type": "string",
                "value": "={{ $json.mailingStateProvince }}"
              },
              {
                "id": "cf2a83f4-28a8-44bd-9d06-780db1406f8f",
                "name": "mailingPostalCode",
                "type": "string",
                "value": "={{ $json.mailingPostalCode }}"
              },
              {
                "id": "94ee2e05-9969-43f2-a732-57356f8b4dfe",
                "name": "mailingCountry",
                "type": "string",
                "value": "={{ $json.mailingCountry }}"
              },
              {
                "id": "b01a56c9-fc42-4bff-9443-27075699986f",
                "name": "location",
                "type": "string",
                "value": "={{ $json.location }}"
              },
              {
                "id": "b9175d72-6976-4765-b773-f4521668d130",
                "name": "department",
                "type": "string",
                "value": "={{ $json.department }}"
              },
              {
                "id": "d784e800-e13b-4d43-907c-11aaaf4ee24f",
                "name": "team",
                "type": "string",
                "value": "={{ $json.team }}"
              },
              {
                "id": "1ff68eb6-35f9-4a2d-9a37-14b3a6f6e0ee",
                "name": "jobGrade",
                "type": "string",
                "value": "={{ $json.jobGrade }}"
              },
              {
                "id": "5628bbf8-872d-4e3a-bf37-c36f13c0f4b1",
                "name": "jobTitle",
                "type": "string",
                "value": "={{ $json.jobTitle }}"
              },
              {
                "id": "34f26d59-43b3-4f2c-955b-f6d5ab22a083",
                "name": "jobEffectiveDate",
                "type": "string",
                "value": "={{ $json.jobEffectiveDate }}"
              },
              {
                "id": "e3023e94-fbc8-4e9b-b106-687ea533e3f8",
                "name": "contractType",
                "type": "string",
                "value": "={{ $json.contractType }}"
              },
              {
                "id": "d3dcf24c-5e9b-40e5-9f54-fca930ab1528",
                "name": "normalWeeklyHours",
                "type": "number",
                "value": "={{ $json.normalWeeklyHours }}"
              },
              {
                "id": "65ed75a6-1ec1-456f-b19b-4492e31f5c18",
                "name": "daysWorkedPerWeek",
                "type": "number",
                "value": "={{ $json.daysWorkedPerWeek }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "86f73b12-afc8-4694-a79d-45c908cc88dd",
        "name": "Update Employee1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1800,
          460
        ],
        "parameters": {
          "url": "https://api.paycaptain.com/employee",
          "method": "POST",
          "options": {
            "pagination": {
              "pagination": {
                "parameters": {
                  "parameters": [
                    {
                      "name": "page",
                      "value": "={{ $request.qs.page + 1 }}"
                    }
                  ]
                },
                "maxRequests": 3,
                "requestInterval": 1000,
                "limitPagesFetched": true
              }
            }
          },
          "jsonBody": "={{\n{\n  hrEmployeeId: $('When Executed by Another Workflow').item.json.employeeId,\n  ..\n}\n}}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "sPolCkoJ1zhzWabJ",
            "name": "JWT TOKEN"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "122fe6f7-3bcd-4f29-a95c-c727a799e1fd",
        "name": "Valid Fields Only",
        "type": "n8n-nodes-base.set",
        "position": [
          1380,
          460
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "4f3d0703-21f3-4ca1-bf7a-9c80d9efc936",
                "name": "values",
                "type": "object",
                "value": "={{\n([\n  \"firstname\",\n  \"middlename\",\n  \"lastname\",\n  \"mailingStreet\",\n  \"mailingCity\",\n  \"mailingStateProvince\",\n  \"mailingPostalCode\",\n  \"mailingCountry\",\n  \"email\",\n  \"phone\",\n  \"niNumber\",\n  \"location\",\n  \"department\",\n  \"team\",\n  \"jobGrade\",\n  \"jobTitle\",\n]\n  .reduce((acc, key) => ({\n    ...acc,\n    [key]: $('When Executed by Another Workflow').item.json.values[key] ?? undefined\n  }), {}))\n}}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "13e5f143-1abf-444c-b86c-ae51fe839894",
        "name": "Has Valid Request?",
        "type": "n8n-nodes-base.if",
        "position": [
          1580,
          460
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "54d35a49-e698-427d-9fca-280b83f2827d",
                "operator": {
                  "type": "object",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.values }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "b98f1d73-a994-4040-b421-75e626ec4ce6",
        "name": "Get Error Response",
        "type": "n8n-nodes-base.set",
        "position": [
          1800,
          640
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b33ebf1d-d0e8-4dda-90e7-b53c21b2a410",
                "name": "response",
                "type": "string",
                "value": "=Request included fields which cannot be updated. Editable fields are: {{ [\n  \"firstname\",\n  \"middlename\",\n  \"lastname\",\n  \"mailingStreet\",\n  \"mailingCity\",\n  \"mailingStateProvince\",\n  \"mailingPostalCode\",\n  \"mailingCountry\",\n  \"email\",\n  \"phone\",\n  \"niNumber\",\n  \"location\",\n  \"department\",\n  \"team\",\n  \"jobGrade\",\n  \"jobTitle\",\n].join(', ')}}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "cb140f3f-571c-49a4-a24d-dcee11c5b7e1",
        "name": "Get Success Response",
        "type": "n8n-nodes-base.set",
        "position": [
          2020,
          460
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a1d245c9-b1e5-4cec-a901-4a6ecc9bd98d",
                "name": "response",
                "type": "string",
                "value": "ok"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "39cd1188-5f2e-45ce-8bbc-0586812491ec",
        "name": "Aggregate Get Response",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          2020,
          260
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData",
          "destinationFieldName": "response"
        },
        "typeVersion": 1
      },
      {
        "id": "d9c1ed21-29e4-41a6-9855-36f1568f7944",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          620,
          -360
        ],
        "parameters": {
          "color": 7,
          "width": 400,
          "height": 220,
          "content": "![](https://cdn.prod.website-files.com/6628137b611845ebff95551f/6628137b611845ebff9556e7_paycaptain-logo.svg#full-width)\n**Website**: https://paycaptain.com\n**DeveloperHub**: https://developer.paycaptain.com\n\n**Good to know:** PayCaptain also sponsors the n8n London Meetups - Definitely check them out!"
        },
        "typeVersion": 1
      },
      {
        "id": "efc7ab35-202d-4a1f-98ce-7ae310c22250",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -540,
          -640
        ],
        "parameters": {
          "width": 440,
          "height": 1180,
          "content": "## Try It Out!\n### This n8n demonstrates how any organisation can quickly and easily build and offer MCP servers to their customers or internal staff to improve productivity.\n\nThis MCP example uses PayCaptain.com as an example and shows how to create an MCP server which can search for and update employee data.\n\n### How it works\n* A MCP server trigger is used and connected to 3 custom workflow tools: Search Employee, Get Employee by ID and Update Employee.\n* Each tool makes calls to the PayCaptain API to perform their respective tasks. Extra care  is performed to strip out sensitive data and ensure we're not sharing too much.\n* The Update Employee too also guards against updating fields which would preferably remain readonly. When you control the MCP server, you can determine behaviour of the tool.\n* Finally, a Google Sheet node is used to log all operations for later audit. This will add a tiny bit of latency but recommended if sensitive data is being accessed.\n\n### How to use\n* This MCP server allows any compatible MCP client to manage their PayCaptain employee database. You will need to have a PayCaptain account and developer key to use it.\n* Connect your MCP client by following the n8n guidelines here - https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-langchain.mcptrigger/#integrating-with-claude-desktop\n* Try the following queries in your MCP client:\n  * \"When did Sarah start here employment at the company?\"\n  * \"Does Jack work Wednesdays or Fridays?\"\n  * \"Please update Tracy's NI number to ABCD123456\"\n\n### Requirements\n* PayCaptain Account and Developer Key.\n* Google Sheets to log actions for later audit.\n* MCP Client or Agent for usage such as Claude Desktop - https://claude.ai/download\n\n### Customising this workflow\n* Add or remove employee attributes as required for your user case.\n* If Google Sheets is too slow, consider an API call to a faster service to log calls to the MCP server.\n* Remember to set the MCP server to require credentials before going to production and sharing this MCP server with others!"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Log Call": {
        "main": [
          [
            {
              "node": "Operation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Operation": {
        "main": [
          [
            {
              "node": "Get Employees",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Get Employees1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Valid Fields Only",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Employee": {
        "ai_tool": [
          [
            {
              "node": "Paycaptain MCP Server",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Get Employees": {
        "main": [
          [
            {
              "node": "Filter Matches",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter Matches": {
        "main": [
          [
            {
              "node": "Strip Sensitive Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Employees1": {
        "main": [
          [
            {
              "node": "Filter Matching ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Employee": {
        "ai_tool": [
          [
            {
              "node": "Paycaptain MCP Server",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Search Employees": {
        "ai_tool": [
          [
            {
              "node": "Paycaptain MCP Server",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Update Employee1": {
        "main": [
          [
            {
              "node": "Get Success Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Valid Fields Only": {
        "main": [
          [
            {
              "node": "Has Valid Request?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter Matching ID": {
        "main": [
          [
            {
              "node": "Strip Sensitive Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Has Valid Request?": {
        "main": [
          [
            {
              "node": "Update Employee1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Get Error Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Strip Sensitive Fields": {
        "main": [
          [
            {
              "node": "Aggregate Search Results",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Strip Sensitive Fields1": {
        "main": [
          [
            {
              "node": "Aggregate Get Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "Log Call",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9"
    },
    "nodes": [
      {
        "id": "77ee6494-4898-47dc-81d9-35daf6f0beea",
        "name": "WhatsApp Trigger",
        "type": "n8n-nodes-base.whatsAppTrigger",
        "position": [
          1360,
          -280
        ],
        "webhookId": "aaa71f03-f7af-4d18-8d9a-0afb86f1b554",
        "parameters": {
          "updates": [
            "messages"
          ]
        },
        "credentials": {
          "whatsAppTriggerApi": {
            "id": "H3uYNtpeczKMqtYm",
            "name": "WhatsApp OAuth account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "57210e27-1f89-465a-98cc-43f890a4bf58",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1960,
          -200
        ],
        "parameters": {
          "model": "gpt-4o-2024-08-06",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e1053235-0ade-4e36-9ad2-8b29c78fced8",
        "name": "Window Buffer Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          2080,
          -200
        ],
        "parameters": {
          "sessionKey": "=whatsapp-75-{{ $json.messages[0].from }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.2
      },
      {
        "id": "69f1b78b-7c93-4713-863a-27e04809996f",
        "name": "Vector Store Tool",
        "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
        "position": [
          2200,
          -200
        ],
        "parameters": {
          "name": "query_product_brochure",
          "description": "Call this tool to query the product brochure. Valid for the year 2024."
        },
        "typeVersion": 1
      },
      {
        "id": "170e8f7d-7e14-48dd-9f80-5352cc411fc1",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          2200,
          80
        ],
        "parameters": {
          "model": "text-embedding-3-small",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ee78320b-d407-49e8-b4b8-417582a44709",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2440,
          -60
        ],
        "parameters": {
          "model": "gpt-4o-2024-08-06",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9dd89378-5acf-4ca6-8d84-e6e64254ed02",
        "name": "When clicking ‚ÄòTest workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          0,
          -240
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "e68fc137-1bcb-43f0-b597-3ae07f380c15",
        "name": "Embeddings OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          760,
          -20
        ],
        "parameters": {
          "model": "text-embedding-3-small",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "2d31e92b-18d4-4f6b-8cdb-bed0056d50d7",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          900,
          -20
        ],
        "parameters": {
          "options": {},
          "jsonData": "={{ $('Extract from File').item.json.text }}",
          "jsonMode": "expressionData"
        },
        "typeVersion": 1
      },
      {
        "id": "ca0c015e-fba2-4dca-b0fe-bac66681725a",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          900,
          100
        ],
        "parameters": {
          "options": {},
          "chunkSize": 2000,
          "chunkOverlap": {}
        },
        "typeVersion": 1
      },
      {
        "id": "63abb6b2-b955-4e65-9c63-3211dca65613",
        "name": "Extract from File",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          360,
          -240
        ],
        "parameters": {
          "options": {},
          "operation": "pdf"
        },
        "typeVersion": 1
      },
      {
        "id": "be2add9c-3670-4196-8c38-82742bf4f283",
        "name": "get Product Brochure",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          180,
          -240
        ],
        "parameters": {
          "url": "https://usa.yamaha.com/files/download/brochure/1/1474881/Yamaha-Powered-Loudspeakers-brochure-2024-en-web.pdf",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "1ae5a311-36d7-4454-ab14-6788d1331780",
        "name": "Reply To User",
        "type": "n8n-nodes-base.whatsApp",
        "position": [
          2820,
          -280
        ],
        "parameters": {
          "textBody": "={{ $json.output }}",
          "operation": "send",
          "phoneNumberId": "477115632141067",
          "requestOptions": {},
          "additionalFields": {
            "previewUrl": false
          },
          "recipientPhoneNumber": "={{ $('WhatsApp Trigger').item.json.messages[0].from }}"
        },
        "credentials": {
          "whatsAppApi": {
            "id": "9SFJPeqrpChOkAmw",
            "name": "WhatsApp account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b6efba81-18b0-4378-bb91-51f39ca57f3e",
        "name": "Reply To User1",
        "type": "n8n-nodes-base.whatsApp",
        "position": [
          1760,
          80
        ],
        "parameters": {
          "textBody": "=I'm unable to process non-text messages. Please send only text messages. Thanks!",
          "operation": "send",
          "phoneNumberId": "477115632141067",
          "requestOptions": {},
          "additionalFields": {
            "previewUrl": false
          },
          "recipientPhoneNumber": "={{ $('WhatsApp Trigger').item.json.messages[0].from }}"
        },
        "credentials": {
          "whatsAppApi": {
            "id": "9SFJPeqrpChOkAmw",
            "name": "WhatsApp account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "52decd86-ac6c-4d91-a938-86f93ec5f822",
        "name": "Product Catalogue",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
        "position": [
          2200,
          -60
        ],
        "parameters": {
          "memoryKey": "whatsapp-75"
        },
        "typeVersion": 1
      },
      {
        "id": "6dd5a652-2464-4ab8-8e5f-568529299523",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -88.75,
          -473.4375
        ],
        "parameters": {
          "color": 7,
          "width": 640.4375,
          "height": 434.6875,
          "content": "## 1. Download Product Brochure PDF\n[Read more about the HTTP Request Tool](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest)\n\nImport your marketing PDF document to build your vector store. This will be used as the knowledgebase by the Sales AI Agent.\n\nFor this demonstration, we'll use the HTTP request node to import the YAMAHA POWERED LOUDSPEAKERS 2024 brochure ([Source](https://usa.yamaha.com/files/download/brochure/1/1474881/Yamaha-Powered-Loudspeakers-brochure-2024-en-web.pdf)) and an Extract from File node to extract the text contents. "
        },
        "typeVersion": 1
      },
      {
        "id": "116663bc-d8d6-41a5-93dc-b219adbb2235",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          580,
          -476
        ],
        "parameters": {
          "color": 7,
          "width": 614.6875,
          "height": 731.1875,
          "content": "## 2. Create Product Brochure Vector Store\n[Read more about the In-Memory Vector Store](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.vectorstoreinmemory/)\n\nVector stores are powerful databases which serve the purpose of matching a user's questions to relevant parts of a document. By creating a vector store of our product catalog, we'll allow users to query using natural language.\n\nTo keep things simple, we'll use the **In-memory Vector Store** which comes built-in to n8n and doesn't require a separate service. For production deployments, I'd recommend replacing the in-memory vector store with either [Qdrant](https://qdrant.tech) or [Pinecone](https://pinecone.io)."
        },
        "typeVersion": 1
      },
      {
        "id": "86bd5334-d735-4650-aeff-06230119d705",
        "name": "Create Product Catalogue",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
        "position": [
          760,
          -200
        ],
        "parameters": {
          "mode": "insert",
          "memoryKey": "whatsapp-75",
          "clearStore": true
        },
        "typeVersion": 1
      },
      {
        "id": "b8078b0d-cbd7-423f-bb30-13902988be38",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1254,
          -552
        ],
        "parameters": {
          "color": 7,
          "width": 546.6875,
          "height": 484.1875,
          "content": "## 3. Use the WhatsApp Trigger\n[Learn more about the WhatsApp Trigger](https://docs.n8n.io/integrations/builtin/trigger-nodes/n8n-nodes-base.whatsapptrigger/)\n\nThe WhatsApp Trigger allows you to receive incoming WhatsApp messages from customers. It requires a bit of setup so remember to follow the documentation carefully! Once ready however, it's quite easy to build powerful workflows which are easily accessible to users.\n\nNote that WhatsApp can send many message types such as audio and video so in this demonstration, we'll filter them out and just accept the text messages."
        },
        "typeVersion": 1
      },
      {
        "id": "5bf7ed07-282b-4198-aa90-3e5ae5180404",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1640,
          280
        ],
        "parameters": {
          "width": 338,
          "height": 92,
          "content": "### Want to handle all message types?\nCheck out my other WhatsApp template in my creator page! https://n8n.io/creators/jimleuk/"
        },
        "typeVersion": 1
      },
      {
        "id": "a3661b59-25d2-446e-8462-32b4d692b69d",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1640,
          -40
        ],
        "parameters": {
          "color": 7,
          "width": 337.6875,
          "height": 311.1875,
          "content": "### 3a. Handle Unsupported Message Types\nFor non-text messages, we'll just reply with a simple message to inform the sender."
        },
        "typeVersion": 1
      },
      {
        "id": "ea3c9ee1-505a-40e7-82fe-9169bdbb80af",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1840,
          -682.5
        ],
        "parameters": {
          "color": 7,
          "width": 746.6875,
          "height": 929.1875,
          "content": "## 4. Sales AI Agent Responds To Customers\n[Learn more about using AI Agents](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent/)\n\nn8n's AI agents are powerful nodes which make it incredibly easy to use state-of-the-art AI in your workflows. Not only do they have the ability to remember conversations per individual customer but also tap into resources such as our product catalogue vector store to pull factual information and data for every question.\n\nIn this demonstration, we use an AI agent which is directed to help the user navigate the product brochure. A Chat memory subnode is attached to identify and keep track of the customer session. A Vector store tool is added to allow the Agent to tap into the product catalogue knowledgebase we built earlier."
        },
        "typeVersion": 1
      },
      {
        "id": "5c72df8d-bca1-4634-b1ed-61ffec8bd103",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2620,
          -560
        ],
        "parameters": {
          "color": 7,
          "width": 495.4375,
          "height": 484.1875,
          "content": "## 5. Repond to WhatsApp User\n[Learn more about the WhatsApp Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.whatsapp/)\n\nThe WhatsApp node is the go-to if you want to interact with WhatsApp users. With this node, you can send text, images, audio and video messages as well as use your WhatsApp message templates.\n\nHere, we'll keep it simple by replying with a text message which is the output of the AI agent."
        },
        "typeVersion": 1
      },
      {
        "id": "48ec809f-ca0e-4052-b403-9ad7077b3fff",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -520,
          -620
        ],
        "parameters": {
          "width": 401.25,
          "height": 582.6283033962263,
          "content": "## Try It Out!\n\n### This n8n template builds a simple WhatsApp chabot acting as a Sales Agent. The Agent is backed by a product catalog vector store to better answer user's questions.\n\n* This template is in 2 parts: creating the product catalog vector store and building the WhatsApp AI chatbot.\n* A product brochure is imported via HTTP request node and its text contents extracted.\n* The text contents are then uploaded to the in-memory vector store to build a knowledgebase for the chatbot.\n* A WhatsApp trigger is used to capture messages from customers where non-text messages are filtered out.\n* The customer's message is sent to the AI Agent which queries the product catalogue using the vector store tool.\n* The Agent's response is sent back to the user via the WhatsApp node.\n\n### Need Help?\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!"
        },
        "typeVersion": 1
      },
      {
        "id": "87cf9b41-66de-49a7-aeb0-c8809191b5a0",
        "name": "Handle Message Types",
        "type": "n8n-nodes-base.switch",
        "position": [
          1560,
          -280
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Supported",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.messages[0].type }}",
                      "rightValue": "text"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Not Supported",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "89971d8c-a386-4e77-8f6c-f491a8e84cb6",
                      "operator": {
                        "type": "string",
                        "operation": "notEquals"
                      },
                      "leftValue": "={{ $json.messages[0].type }}",
                      "rightValue": "text"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "e52f0a50-0c34-4c4a-b493-4c42ba112277",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          -20
        ],
        "parameters": {
          "color": 5,
          "width": 345.10906976744184,
          "height": 114.53583720930231,
          "content": "### You only have to run this part once!\nRun this step to populate our product catalogue vector. Run again if you want to update the vector store with a new version."
        },
        "typeVersion": 1
      },
      {
        "id": "c1a7d6d1-191e-4343-af9f-f2c9eb4ecf49",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1260,
          -40
        ],
        "parameters": {
          "color": 5,
          "width": 364.6293255813954,
          "height": 107.02804651162779,
          "content": "### Activate your workflow to use!\nTo start using the WhatsApp chatbot, you'll need to activate the workflow. If you are self-hosting ensure WhatsApp is able to connect to your server."
        },
        "typeVersion": 1
      },
      {
        "id": "a36524d0-22a6-48cc-93fe-b4571cec428a",
        "name": "AI Sales Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1960,
          -400
        ],
        "parameters": {
          "text": "={{ $json.messages[0].text.body }}",
          "options": {
            "systemMessage": "You are an assistant working for a company who sells Yamaha Powered Loudspeakers and helping the user navigate the product catalog for the year 2024. Your goal is not to facilitate a sale but if the user enquires, direct them to the appropriate website, url or contact information.\n\nDo your best to answer any questions factually. If you don't know the answer or unable to obtain the information from the datastore, then tell the user so."
          },
          "promptType": "define"
        },
        "typeVersion": 1.6
      }
    ],
    "pinData": {},
    "connections": {
      "AI Sales Agent": {
        "main": [
          [
            {
              "node": "Reply To User",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "WhatsApp Trigger": {
        "main": [
          [
            {
              "node": "Handle Message Types",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Product Catalogue",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File": {
        "main": [
          [
            {
              "node": "Create Product Catalogue",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Sales Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Product Catalogue": {
        "ai_vectorStore": [
          [
            {
              "node": "Vector Store Tool",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "Vector Store Tool": {
        "ai_tool": [
          [
            {
              "node": "AI Sales Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "Create Product Catalogue",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Vector Store Tool",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Create Product Catalogue",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Handle Message Types": {
        "main": [
          [
            {
              "node": "AI Sales Agent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Reply To User1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Window Buffer Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Sales Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "get Product Brochure": {
        "main": [
          [
            {
              "node": "Extract from File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "get Product Brochure",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "NO1Jrg2IkMTiquxb",
    "meta": {
      "instanceId": "eeebdb47cbe0bf5bc137514a863458fd2f9ab992b2ebeb2c6062100cdade81e7",
      "templateCredsSetupCompleted": true
    },
    "name": "Create Shopify Products from Google Sheet",
    "tags": [
      {
        "id": "cWC39BXOsHlOhwEC",
        "name": "google-sheet",
        "createdAt": "2025-06-11T02:39:38.743Z",
        "updatedAt": "2025-06-11T02:39:38.743Z"
      },
      {
        "id": "vMF1giVsFs9aUam0",
        "name": "shopify",
        "createdAt": "2025-06-11T02:39:27.034Z",
        "updatedAt": "2025-06-11T02:39:27.034Z"
      }
    ],
    "nodes": [
      {
        "id": "0d76a8c0-fd78-47d8-899d-6a084317ab28",
        "name": "Start Workflow",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -540,
          20
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "54ce8605-f90e-4666-85e5-cdbc0dba8077",
        "name": "Google Sheet, Fetch Products",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -40,
          20
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1164444657,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IxiuRiu6XKBkEa1NIUebBWn73jIKUrgE9Sqj4XtQgBk/edit#gid=1164444657",
            "cachedResultName": "Products"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1IxiuRiu6XKBkEa1NIUebBWn73jIKUrgE9Sqj4XtQgBk",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IxiuRiu6XKBkEa1NIUebBWn73jIKUrgE9Sqj4XtQgBk/edit?usp=drivesdk",
            "cachedResultName": "Shopify Test Store Data"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "GQE41DhnGDDJ8Hfq",
            "name": "Google Sheets account"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.6
      },
      {
        "id": "c750de2c-71c4-4eed-a6d2-6f0fa8cfe114",
        "name": "Shopify, ProductQuery",
        "type": "n8n-nodes-base.graphql",
        "position": [
          500,
          40
        ],
        "parameters": {
          "query": "query Products ($handle: String! ) {\n    productByHandle(handle: $handle) {\n        id\n        title\n        variants(first:20) {\n            edges {\n                node {\n                    id\n                    title\n                    sku\n                    price \n                    inventoryItem {\n                        id\n                    }\n                }\n            }\n        }\n        updatedAt\n        createdAt\n    }\n}",
          "endpoint": "https://store99563.myshopify.com/admin/api/2025-04/graphql.json",
          "variables": "={\n    \"handle\" : \"{{ $json.slug }}\"\n}",
          "authentication": "headerAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "mHtpN3u5aCWsxWih",
            "name": "Shopify GraphQL Header Auth account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "2f350bac-d1d5-4d69-b18b-a2f802594599",
        "name": "If product exists",
        "type": "n8n-nodes-base.if",
        "position": [
          740,
          40
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "81228bbc-7111-40ec-8b37-3c9878945c4d",
                "operator": {
                  "type": "object",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.data.productByHandle }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "fe218fdb-6c58-49d5-b3c2-b34bbf14b54c",
        "name": "Shopify, CreateProduct",
        "type": "n8n-nodes-base.graphql",
        "position": [
          960,
          200
        ],
        "parameters": {
          "query": "mutation productCreate($product: ProductCreateInput!, $media: [CreateMediaInput!]) {\n  productCreate(product: $product, media: $media) {\n    product {\n     id\n      title\n      descriptionHtml\n      vendor\n      productType\n      status\n      handle\n      variants(first:10) {\n        edges {\n            node {\n                id\n                sku\n                displayName\n                inventoryItem {\n                    id\n                    sku\n                    tracked\n                    requiresShipping\n                }\n            }\n        }\n      }\n      media(first: 10) {\n        edges {\n            node {\n                alt\n                mediaContentType\n                status\n                id\n                preview {\n                    image {\n                        url\n                    }\n                    status\n                }\n            }\n        }\n      }\n      options {\n        id\n        name\n        position\n        optionValues {\n          id\n          name\n          hasVariants\n        }\n      }\n    }\n    userErrors {\n      field\n      message\n    }\n  }\n}",
          "endpoint": "https://store99563.myshopify.com/admin/api/2025-04/graphql.json",
          "variables": "={\n    \"product\": {\n        \"title\": \" {{ $('Loop Over Items').item.json.title }} \",\n        \"descriptionHtml\": \"{{ $('Loop Over Items').item.json.description }}\",\n        \"vendor\" : \"{{ $('Loop Over Items').item.json.company }}\",\n        \"productType\": \"{{ $('Loop Over Items').item.json.category }}\",\n        \"status\": \"{{ $('Loop Over Items').item.json.status }}\",\n        \"handle\": \"{{ $('Loop Over Items').item.json.slug }}\"\n    },\n    \"media\" : [{\n        \"alt\" : \"alt tag\",\n        \"mediaContentType\" : \"IMAGE\",\n        \"originalSource\" : \"https://placehold.co/800x600.png\"\n    }]\n}",
          "authentication": "headerAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "mHtpN3u5aCWsxWih",
            "name": "Shopify GraphQL Header Auth account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "65032b74-36a8-46ee-b1a1-eaddcec9be1b",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          240,
          20
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "099ed035-6a41-4abb-8bed-011d8a6e4cc5",
        "name": "Shopify, GetLocations",
        "type": "n8n-nodes-base.graphql",
        "position": [
          -280,
          20
        ],
        "parameters": {
          "query": "query {\n    locations(first:1, reverse:true) {\n        edges {\n            node {\n                id\n                name\n                address {\n                    address1\n                    address2\n                    city\n                    country\n                    zip\n                    province\n                }\n            }\n        }\n    }\n}",
          "endpoint": "https://store99563.myshopify.com/admin/api/2025-04/graphql.json",
          "authentication": "headerAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "mHtpN3u5aCWsxWih",
            "name": "Shopify GraphQL Header Auth account"
          }
        },
        "executeOnce": true,
        "typeVersion": 1.1
      },
      {
        "id": "be29e4ea-51fb-4e8b-a2c2-b4b2e590fd2a",
        "name": "Shopify, Enable InventoryTracking",
        "type": "n8n-nodes-base.graphql",
        "position": [
          1160,
          200
        ],
        "parameters": {
          "query": "mutation inventoryItemUpdate($id: ID!, $input: InventoryItemInput!) {\n  inventoryItemUpdate(id: $id, input: $input) {\n    inventoryItem {\n      id\n      unitCost {\n        amount\n      }\n      tracked\n    }\n    userErrors {\n      message\n    }\n  }\n}",
          "endpoint": "https://store99563.myshopify.com/admin/api/2025-04/graphql.json",
          "variables": "={\n  \"id\": \"{{ $json.data.productCreate.product.variants.edges[0].node.inventoryItem.id }}\",\n  \"input\": {\n    \"tracked\": true,\n    \"requiresShipping\": true\n  }\n}",
          "authentication": "headerAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "mHtpN3u5aCWsxWih",
            "name": "Shopify GraphQL Header Auth account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "a22761aa-b55d-41a6-b853-d165ae9aa89c",
        "name": "Shopify, Set InventoryLevel",
        "type": "n8n-nodes-base.graphql",
        "position": [
          1360,
          200
        ],
        "parameters": {
          "query": "mutation inventorySetOnHandQuantities($input: InventorySetOnHandQuantitiesInput!) {\n    inventorySetOnHandQuantities(input: $input) {\n        userErrors {\n            field\n            message\n        }\n    }\n}",
          "endpoint": "=https://store99563.myshopify.com/admin/api/2025-04/graphql.json",
          "variables": "={\n    \"input\" : {\n        \"reason\": \"correction\",\n        \"setQuantities\" :[{\n            \"inventoryItemId\":\"{{ $json.data.inventoryItemUpdate.inventoryItem.id }}\",\n            \"locationId\": \"{{ $('Shopify, GetLocations').item.json.data.locations.edges[0].node.id }}\",\n            \"quantity\" : {{ $('Loop Over Items').item.json.stock_on_hand }}\n        }]\n    }\n}",
          "authentication": "headerAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "mHtpN3u5aCWsxWih",
            "name": "Shopify GraphQL Header Auth account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "2b69fe40-d04e-4e60-b1e4-f19290b97edc",
        "name": "Finished",
        "type": "n8n-nodes-base.noOp",
        "position": [
          460,
          -220
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "44572b5d-e19b-48e3-b80d-6d6ec7ae0273",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -540,
          -680
        ],
        "parameters": {
          "width": 800,
          "height": 660,
          "content": "## Create Products in Shopify from a Google Sheet\n\nThis workflow creates products in your Shopify store from a google sheet. It also enables inventory tracking and sets the quantity of an inventory item at your store's default location. \n\nThis is a great way to get test data into test or staging stores to try out apps, update template or try out new designs. \n\nThis Automation will only import new products. It will skip existing products if the slug matches an existing product's handle (Shopify's term for a slug).\n \n### Setup Notes\n\nThe Google Sheet has the following columns\ntitle - free text\ndescription - free text\ncompany - free text\ncategory - free text\nstatus - ACTIVE, DRAFT or ARCHIVE\nslug - used in the product url, text with no spaces, can also use hyphen.\nprice - sale price of the products\ncompare_at_price - compare at price for products\nsku - unique code for each product\nstock_on_hand - quantity of this item available for purchase.\n\nUse those labels in the first row of your sheet and N8N will create one object per row with the column names as object fields. \n\n### Update GraphQL nodes with your Shopify store URL\n\n1) Replace the URL in all GraphQL nodes with the URL for your Shopify store. \n2) These GraphQL requests all use the Shopify 2025-04 GraphQL Admin API. \n"
        },
        "typeVersion": 1
      },
      {
        "id": "56b55c86-ec42-4154-a44f-c8cf50cbcc0f",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          420,
          -40
        ],
        "parameters": {
          "width": 480,
          "height": 340,
          "content": "## Check to see if product exists\n"
        },
        "typeVersion": 1
      },
      {
        "id": "1c3e5c1d-fad0-4059-9fe2-cc1ea3b9ca52",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          920,
          60
        ],
        "parameters": {
          "width": 600,
          "height": 400,
          "content": "## Create the Product\n- Create product.\n- Enable inventory tracking \n- Set inventory quantity"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "292ad12e-25e6-495f-9361-f63996ac146a",
    "connections": {
      "Start Workflow": {
        "main": [
          [
            {
              "node": "Shopify, GetLocations",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Finished",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Shopify, ProductQuery",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If product exists": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Shopify, CreateProduct",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Shopify, GetLocations": {
        "main": [
          [
            {
              "node": "Google Sheet, Fetch Products",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Shopify, ProductQuery": {
        "main": [
          [
            {
              "node": "If product exists",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Shopify, CreateProduct": {
        "main": [
          [
            {
              "node": "Shopify, Enable InventoryTracking",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Shopify, Set InventoryLevel": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheet, Fetch Products": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Shopify, Enable InventoryTracking": {
        "main": [
          [
            {
              "node": "Shopify, Set InventoryLevel",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "66ce8bb89c7868f862e0d2e755cd17c6a5aea7904e5504a5b2e292e317980443",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "613422d5-05db-4163-bcb0-3fdae9de260b",
        "name": "When clicking ‚ÄòTest workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -1120,
          60
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "9ec28d5b-6ea0-4a57-911e-9f4546b739a2",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -520,
          -240
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 440,
          "content": "## Generate report\nUsing deepseek R1"
        },
        "typeVersion": 1
      },
      {
        "id": "cf30eb86-2aad-4d33-a5c2-737239e63636",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -140,
          -240
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 440,
          "content": "## Double-check\nUsing deepseek V3"
        },
        "typeVersion": 1
      },
      {
        "id": "d799760f-83c5-4603-8eb8-3857807b364a",
        "name": "HTTP Request",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          300,
          -140
        ],
        "parameters": {
          "url": "YOUR_CALL_BACK_API",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  data: \"{{$node['Report'].json.text}}\"\n}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.2
      },
      {
        "id": "bf0a8ab6-06e0-4564-96af-ddcf6795a845",
        "name": "Report",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          -480,
          -140
        ],
        "parameters": {
          "text": "=You are a CRM data analyst assistant. Your task is to analyze the provided CRM data and generate valuable insights in Markdown format.\n\nYou will receive JSON data extracted from a CRM system that may include information about:\n- Call canter agents metrics.\n\n# ANALYSIS REQUIREMENTS\nAnalyze the data considering:\n1. Lead conversion rates and quality metrics\n2. Upsall\n3. Rank the agents with small description about every one.\n\n# OUTPUT FORMAT\nStructure your analysis in Markdown.\n\n# GUIDELINES\n- Focus on actionable insights rather than just describing the data\n- Use bullet points and tables when appropriate to improve readability\n- Include both positive findings and areas for improvement\n- Reference specific data points to support your analysis\n- Prioritize quality over quantity in your recommendations\n- Be concise yet thorough\n- If there are data quality issues or missing information, note these limitations\n- If you detect any unusual patterns or anomalies, highlight them\n\n# DATA\n```\n{{ JSON.stringify($input.first().json.body) }}\n```",
          "promptType": "define"
        },
        "typeVersion": 1.6
      },
      {
        "id": "f51d601e-898c-4dd6-894b-2e4911a334db",
        "name": "DeepSeek Reasonning",
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "position": [
          -400,
          60
        ],
        "parameters": {
          "model": "deepseek-reasoner",
          "options": {}
        },
        "credentials": {
          "deepSeekApi": {
            "id": "ltpFxb7M3kHaEBFD",
            "name": "DeepSeek account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9393be48-aebc-4f6c-b445-014633e0e289",
        "name": "DeepSeek Chat",
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "position": [
          -20,
          80
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "deepSeekApi": {
            "id": "ltpFxb7M3kHaEBFD",
            "name": "DeepSeek account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4a8dc360-fd3f-46a5-89e1-87ece59b0bb6",
        "name": "Example data",
        "type": "n8n-nodes-base.code",
        "position": [
          -860,
          60
        ],
        "parameters": {
          "jsCode": "return {\n  \"body\": \n    // You can use any data as JSON\n    // this is just example\n    // data start here\n    [\n      {\n        \"user\": {\n          \"id\": 15,\n          \"full_name\": \"lisa confirmation\",\n        },\n        \"productivity\": 44.67,\n        \"total_leads\": 465,\n        \"total_confirmed\": 291,\n        \"total_delivred\": 130,\n        \"total_in_proccess\": 119,\n        \"total_cancled\": 0,\n        \"total_returned\": 13,\n        \"total_assign\": 495,\n        \"total_need_confirmation\": 0,\n        \"total_recheck\": 22,\n        \"upsell\": 59,\n        \"upsell_delivered\": 27,\n        \"confirmation_rate\": 62.58\n      },\n      {\n        \"user\": {\n          \"id\": 1346,\n          \"full_name\": \"Sallam Confirmation\",\n        },\n        \"productivity\": 42.29,\n        \"total_leads\": 374,\n        \"total_confirmed\": 253,\n        \"total_delivred\": 107,\n        \"total_in_proccess\": 96,\n        \"total_cancled\": 0,\n        \"total_returned\": 21,\n        \"total_assign\": 459,\n        \"total_need_confirmation\": 1,\n        \"total_recheck\": 1,\n        \"upsell\": 62,\n        \"upsell_delivered\": 31,\n        \"confirmation_rate\": 67.65\n      }\n    ]\n    // data end here\n}"
        },
        "typeVersion": 2
      },
      {
        "id": "41e36370-fa7a-4f6e-a439-15127dfc432d",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1160,
          -20
        ],
        "parameters": {
          "width": 480,
          "height": 240,
          "content": "## Test Workflow\nClick this button to test the workflow with example data"
        },
        "typeVersion": 1
      },
      {
        "id": "e0d473e8-7a2e-4473-9af7-5f2f835990db",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1160,
          240
        ],
        "parameters": {
          "width": 480,
          "height": 80,
          "content": "## Just to test"
        },
        "typeVersion": 1
      },
      {
        "id": "b0c31c3b-1fd0-485e-a54b-9a3045bcf09e",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1160,
          400
        ],
        "parameters": {
          "color": 4,
          "width": 1540,
          "height": 100,
          "content": "## Do you need more help or have any suggestions?\nContact me at mediaplus.ma@gmail.com"
        },
        "typeVersion": 1
      },
      {
        "id": "9a1f03ee-167f-44e3-ae12-61ab8d3789f2",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -520,
          -360
        ],
        "parameters": {
          "color": 7,
          "width": 720,
          "height": 80,
          "content": "## Change here\nYou can edit/add details about your goal by changing the AI promps.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "d91de9c8-835b-4232-a76b-e27554ad595d",
        "name": "Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -980,
          -300
        ],
        "webhookId": "b408defb-315d-4676-b4c4-1dcebe81ffc0",
        "parameters": {
          "path": "b408defb-315d-4676-b4c4-1dcebe81ffc0",
          "options": {},
          "httpMethod": [
            "POST",
            "GET"
          ],
          "multipleMethods": true
        },
        "typeVersion": 2
      },
      {
        "id": "04c2da18-10c9-44df-8084-52b5901ecc18",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1020,
          -380
        ],
        "parameters": {
          "color": 4,
          "width": 200,
          "height": 240,
          "content": "## Production"
        },
        "typeVersion": 1
      },
      {
        "id": "a1fb1cbc-391c-4918-b48f-8b44116921b8",
        "name": "Recheck",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          -100,
          -140
        ],
        "parameters": {
          "text": "=You are a Data Analysis Verification Expert. Your task is to evaluate whether an AI-generated report accurately and completely analyzes the provided CRM data. You will assess the report quality and determine if it's compatible with the original input.\n\n# INPUT\nYou will receive:\n1. The original call center agent metrics data (JSON)\n2. The AI-generated analysis report in Markdown\n\n# VERIFICATION REQUIREMENTS\nEvaluate the report for:\n1. Factual accuracy - Do all numbers, rankings, and statements accurately reflect the data?\n2. Comprehensiveness - Does the report cover all required areas? (Lead conversion, Upsell, Agent ranking)\n3. Insight quality - Does the report provide meaningful insights beyond basic data description?\n4. Completeness - Are all agents included in the analysis?\n5. Format compliance - Is the report properly formatted in Markdown with appropriate sections?\n\n# OUTPUT FORMAT\nReturn a JSON object with the following structure:\n```json\n{\n  \"verified\": true/false,\n  \"score\": 1-10,\n  \"quality_assessment\": \"Brief 2-4 sentence evaluation of report quality\",\n  \"missing_elements\": [\"List any required elements missing from the report\"],\n  \"inaccuracies\": [\"List any factual errors or misinterpretations\"],\n  \"improvement_suggestions\": [\"Specific suggestions for report improvement\"]\n}\n```\n\n# EVALUATION CRITERIA\n- \"verified\": Set to true ONLY if the report is factually accurate, includes all agents, covers all required areas, and provides meaningful insights.\n- \"score\": Rate from 1-10 where:\n  * 1-3: Poor report with major inaccuracies or missing elements\n  * 4-6: Adequate report with some issues\n  * 7-8: Good report with minor issues\n  * 9-10: Excellent report with comprehensive analysis\n\n# GUIDELINES\n- Be thorough and precise in your verification\n- Check all numerical claims against the original data\n- Verify that all agents are properly ranked and described\n- Check that lead conversion rates and upsell metrics are accurately analyzed\n- Assess whether the insights are actionable and valuable\n- Maintain a balanced perspective, noting both strengths and weaknesses\n\n# ORIGINAL DATA\n{{ JSON.stringify($node[\"Example data\"].json.chatInput) }}\n\n# AI-GENERATED REPORT\n{{ $json.text }}",
          "promptType": "define"
        },
        "typeVersion": 1.6
      }
    ],
    "pinData": {},
    "connections": {
      "Report": {
        "main": [
          [
            {
              "node": "Recheck",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recheck": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook": {
        "main": [
          [
            {
              "node": "Report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Example data": {
        "main": [
          [
            {
              "node": "Report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat": {
        "ai_languageModel": [
          [
            {
              "node": "Recheck",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Reasonning": {
        "ai_languageModel": [
          [
            {
              "node": "Report",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Example data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "nodes": [
      {
        "name": "create new contact",
        "type": "n8n-nodes-base.hubspot",
        "position": [
          -300,
          1200
        ],
        "parameters": {
          "email": "={{$json[\"form_email\"]}}",
          "resource": "contact",
          "additionalFields": {
            "industry": "={{$json[\"form_department\"]}}",
            "lastName": "={{$json[\"form_lastname\"]}}",
            "firstName": "={{$json[\"form_firstname\"]}}",
            "companyName": "={{$json[\"form_companyname\"]}}"
          }
        },
        "credentials": {
          "hubspotApi": "hubspot_nodeqa"
        },
        "typeVersion": 1
      },
      {
        "name": "update lead stage",
        "type": "n8n-nodes-base.hubspot",
        "position": [
          100,
          1100
        ],
        "parameters": {
          "email": "={{$node[\"create new contact\"].json[\"properties\"][\"email\"][\"value\"]}}",
          "resource": "contact",
          "additionalFields": {
            "lifeCycleStage": "opportunity"
          }
        },
        "credentials": {
          "hubspotApi": "hubspot_nodeqa"
        },
        "typeVersion": 1
      },
      {
        "name": "NoOp",
        "type": "n8n-nodes-base.noOp",
        "position": [
          100,
          1300
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "name": "Set values",
        "type": "n8n-nodes-base.set",
        "position": [
          -500,
          1200
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "form_firstname",
                "value": "={{$json[\"First up, what's your name?\"]}}"
              },
              {
                "name": "form_lastname",
                "value": "={{$json[\"And your surname, [field:fda1954c-f7a3-4fd3-a8dc-dcad5160bab5]?\"]}}"
              },
              {
                "name": "form_department",
                "value": "={{$json[\"And in which department do you work, [field:fda1954c-f7a3-4fd3-a8dc-dcad5160bab5]?\"]}}"
              },
              {
                "name": "form_companyname",
                "value": "={{$json[\"Great! Now what company are you from?\"]}}"
              },
              {
                "name": "form_email",
                "value": "={{$json[\"Just a couple more questions left! What's your email address?\"]}}"
              }
            ],
            "boolean": [
              {
                "name": "form_interest",
                "value": "={{$json[\"And are you currently looking to scale your visual content?\"]}}"
              }
            ]
          },
          "options": {},
          "keepOnlySet": true
        },
        "typeVersion": 1
      },
      {
        "name": "Typeform Trigger",
        "type": "n8n-nodes-base.typeformTrigger",
        "position": [
          -700,
          1200
        ],
        "webhookId": "97eb74c8-156c-4329-8679-37b69533f709",
        "parameters": {
          "formId": "RPueloJC"
        },
        "credentials": {
          "typeformApi": "typeform"
        },
        "typeVersion": 1
      },
      {
        "name": "lead interested",
        "type": "n8n-nodes-base.if",
        "position": [
          -100,
          1200
        ],
        "parameters": {
          "conditions": {
            "boolean": [
              {
                "value1": "={{$node[\"Set values\"].json[\"form_interest\"]}}",
                "value2": true
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "name": "send information",
        "type": "n8n-nodes-base.gmail",
        "position": [
          300,
          1100
        ],
        "parameters": {
          "toList": [
            "={{$json[\"properties\"][\"email\"][\"value\"]}}"
          ],
          "message": "=Hello {{$json[\"properties\"][\"firstname\"][\"value\"]}},\n\nI'm glad to hear you're interested in our services. You can schedule a call with me here: [calendly_link].\nUntil then, check out this presentation about how we can help your business: [presentation_link].\nLooking forward to talking to you!\n\nBest,\nTeam",
          "subject": "So you're interested in growing your business",
          "resource": "message",
          "additionalFields": {}
        },
        "credentials": {
          "gmailOAuth2": "gmail"
        },
        "typeVersion": 1
      }
    ],
    "connections": {
      "Set values": {
        "main": [
          [
            {
              "node": "create new contact",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "lead interested": {
        "main": [
          [
            {
              "node": "update lead stage",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "NoOp",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Typeform Trigger": {
        "main": [
          [
            {
              "node": "Set values",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "update lead stage": {
        "main": [
          [
            {
              "node": "send information",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "create new contact": {
        "main": [
          [
            {
              "node": "lead interested",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "9RKrZdyiAYeuGv6W",
    "meta": {
      "instanceId": "c23cb86fa0050ec3afbd7900d224878abccb334ae42c0f7ffb061d805dfe19c7",
      "templateCredsSetupCompleted": true
    },
    "name": "Talk with your Drive folder RAG",
    "tags": [
      {
        "id": "GNqLf5pjefdKGbgv",
        "name": "Agent",
        "createdAt": "2025-08-28T08:18:53.209Z",
        "updatedAt": "2025-08-28T08:18:53.209Z"
      }
    ],
    "nodes": [
      {
        "id": "b30ce82d-44b4-46d7-810c-eb64257b4327",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          60,
          400
        ],
        "parameters": {
          "model": "gpt-4o-2024-08-06",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "gKM5mJZRrP7c1SlE",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "18f18c72-0066-4803-8128-5d7d143d2c85",
        "name": "Window Buffer Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          100,
          620
        ],
        "parameters": {
          "sessionKey": "=docs-{{ $json.messages[0].from }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.2
      },
      {
        "id": "950f35d8-fb93-4b6f-b528-c47c25c60301",
        "name": "Vector Store Tool",
        "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
        "position": [
          300,
          420
        ],
        "parameters": {
          "name": "get_documents",
          "description": "Retrieve information from any company documents"
        },
        "typeVersion": 1
      },
      {
        "id": "5603154c-8a32-48f5-9750-1e2aca633e31",
        "name": "Generate Embeddings for Search with OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          200,
          760
        ],
        "parameters": {
          "model": "text-embedding-3-small",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "gKM5mJZRrP7c1SlE",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "dfd9a08b-ec49-48a5-984f-55cc270de0ae",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          580,
          720
        ],
        "parameters": {
          "model": "gpt-4o-2024-08-06",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "gKM5mJZRrP7c1SlE",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "2b385fec-c2f9-43a9-bb28-e42b38346c44",
        "name": "Embeddings OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          -960,
          340
        ],
        "parameters": {
          "model": "text-embedding-3-small",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "gKM5mJZRrP7c1SlE",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5431b1f1-1c98-4073-a15e-f46bc04a9481",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          -820,
          240
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "f4ffd33e-8a9b-4f5a-b4a9-ec286b13ce68",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          -660,
          400
        ],
        "parameters": {
          "options": {},
          "chunkSize": 2000,
          "chunkOverlap": 100
        },
        "typeVersion": 1
      },
      {
        "id": "918aa3af-19fa-48d3-8669-3dc841a9ba0b",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1000,
          -80
        ],
        "parameters": {
          "color": 7,
          "width": 614.6875,
          "height": 731.1875,
          "content": "## 2. Create a Vector Store\n[Read more about the In-Memory Vector Store](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.vectorstoreinmemory/)"
        },
        "typeVersion": 1
      },
      {
        "id": "95668d63-a834-47a2-82f3-3039d2cb9d84",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          -60
        ],
        "parameters": {
          "color": 7,
          "width": 746.6875,
          "height": 929.1875,
          "content": "## 4. AI Agent Responds\n[Learn more about using AI Agents](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.agent/)\n\nn8n's AI agents are powerful nodes which make it incredibly easy to use state-of-the-art AI in your workflows. Not only do they have the ability to remember conversations per individual customer but also tap into resources such as our product catalogue vector store to pull factual information and data for every question."
        },
        "typeVersion": 1
      },
      {
        "id": "f2a080c7-5fbe-4426-b7d7-226934e76f3f",
        "name": "AI Sales Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          60,
          220
        ],
        "parameters": {
          "text": "={{ $json.chatInput }}",
          "options": {
            "systemMessage": "You a personal assistant that helps me make decisions based on my internal information pdfs. Your goal is not to facilitate a explain any questions user might have about the documents.\n\nDo your best to answer any questions factually. If you don't know the answer or unable to obtain the information from the datastore, then tell the user so.\n\nAlways answer in short message, in the size of one paragraph: between 100 and 200 words. Better to answer in short messages, human like."
          },
          "promptType": "define"
        },
        "typeVersion": 1.6
      },
      {
        "id": "20a21f7b-e05e-4300-853e-7c1efbb6dfc7",
        "name": "Download File From Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          -1260,
          140
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {
            "fileName": "={{ $json.name }}"
          },
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "null",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "c81c5d09-a9d2-41b1-a0a6-d00eb1a7b58a",
        "name": "Google Drive File Updated",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          -1580,
          360
        ],
        "parameters": {
          "event": "fileUpdated",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "list",
            "value": "1WlejjfGrijAhMsJ2zWUa-2OZsiXIj4Bu",
            "cachedResultUrl": "https://drive.google.com/drive/folders/null",
            "cachedResultName": "4. Personal Helper"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "null",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "186f3de8-cdb9-4190-91ec-aceba939a70c",
        "name": "Google Drive File Created",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          -1580,
          160
        ],
        "parameters": {
          "event": "fileCreated",
          "options": {
            "fileType": "all"
          },
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "list",
            "value": "1WlejjfGrijAhMsJ2zWUa-2OZsiXIj4Bu",
            "cachedResultUrl": "https://drive.google.com/drive/folders/null",
            "cachedResultName": "4. Personal Helper"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "6k5Fu82oEMsV1a3A",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "91e7cd3d-e35b-4483-b092-0350873fdb7c",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2060,
          -680
        ],
        "parameters": {
          "width": 320,
          "content": "## Add documents to vector store when updating or creating new documents in Google Drive"
        },
        "typeVersion": 1
      },
      {
        "id": "bcda0f55-7251-48b0-b3ed-b2739b151dbe",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1700,
          -60
        ],
        "parameters": {
          "color": 7,
          "width": 640,
          "height": 655,
          "content": "## 1. Build Databse\n[Read more about the HTTP Request Tool](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.httprequest)\n\nImport your marketing PDF document to build your vector store. This will be used as the knowledgebase by the Tourist guide AI Agent."
        },
        "typeVersion": 1
      },
      {
        "id": "d74cef89-3f35-4a1e-b0db-fcced3f11227",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -240,
          220
        ],
        "webhookId": "7d2ecd50-140d-4b7d-a07b-42300ce295b0",
        "parameters": {
          "public": true,
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "d1ecb940-335c-40c9-9880-d899b50aaa1b",
        "name": "Pinecone Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "position": [
          -900,
          40
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "my-docs",
            "cachedResultName": "my-docs"
          }
        },
        "credentials": {
          "pineconeApi": {
            "id": "oXLXLM4QUaxoxCQM",
            "name": "PineconeApi account - M "
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4e62dd9c-6c3a-4f13-9f0f-fef2df99a304",
        "name": "Pinecone Vector Store (Retrieval)",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "position": [
          280,
          600
        ],
        "parameters": {
          "options": {},
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "my-docs",
            "cachedResultName": "my-docs"
          }
        },
        "credentials": {
          "pineconeApi": {
            "id": "oXLXLM4QUaxoxCQM",
            "name": "PineconeApi account - M "
          }
        },
        "typeVersion": 1
      },
      {
        "id": "0efaa10f-2908-41a6-aeda-cd54c168f4ba",
        "name": "Download File From Google Drive1",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          -1300,
          380
        ],
        "parameters": {
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "0AGMjmhIM2B3eUk9PVA",
            "cachedResultUrl": "https://drive.google.com/drive/folders/0AGMjmhIM2B3eUk9PVA",
            "cachedResultName": "Shape Labs"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1WlejjfGrijAhMsJ2zWUa-2OZsiXIj4Bu",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1WlejjfGrijAhMsJ2zWUa-2OZsiXIj4Bu",
            "cachedResultName": "4. Personal Helper"
          },
          "resource": "folder"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "6k5Fu82oEMsV1a3A",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "e1019cc3-1fb9-421f-a440-ad87d0dc8d53",
    "connections": {
      "AI Sales Agent": {
        "main": [
          []
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store (Retrieval)",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Sales Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Vector Store Tool": {
        "ai_tool": [
          [
            {
              "node": "AI Sales Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Vector Store Tool",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Window Buffer Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Sales Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Drive File Created": {
        "main": [
          [
            {
              "node": "Download File From Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Drive File Updated": {
        "main": [
          [
            {
              "node": "Download File From Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Sales Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download File From Google Drive": {
        "main": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store (Retrieval)": {
        "ai_vectorStore": [
          [
            {
              "node": "Vector Store Tool",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "eOUewYsEzJmQixI6",
    "meta": {
      "instanceId": "77c4feba8f41570ef06dc76ece9a6ded0f0d44f7f1477a64c2d71a8508c11faa",
      "templateCredsSetupCompleted": true
    },
    "name": "Chat with Postgresql Database",
    "tags": [],
    "nodes": [
      {
        "id": "6501a54f-a68c-452d-b353-d7e871ca3780",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -300,
          -80
        ],
        "webhookId": "cf1de04f-3e38-426c-89f0-3bdb110a5dcf",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "cd32221b-2a36-408d-b57e-8115fcd810c9",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          0,
          -80
        ],
        "parameters": {
          "agent": "openAiFunctionsAgent",
          "options": {
            "systemMessage": "You are DB assistant. You need to run queries in DB aligned with user requests.\n\nRun custom SQL query to aggregate data and response to user. Make sure every table has schema prefix to it in sql query which you can get from `Get DB Schema and Tables List` tool.\n\nFetch all data to analyse it for response if needed.\n\n## Tools\n\n- Execute SQL query - Executes any sql query generated by AI\n- Get DB Schema and Tables List - Lists all the tables in database with its schema name\n- Get Table Definition - Gets the table definition from db using table name and schema name"
          }
        },
        "typeVersion": 1.7
      },
      {
        "id": "8accbeeb-7eaf-4e9e-aabc-de8ab3a0459b",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -60,
          160
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "48uG61Ilo8jndw3r",
            "name": "Your OpenAI Account Credentials"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "11f2013f-a080-4c9e-8773-c90492e2c628",
        "name": "Get Table Definition",
        "type": "n8n-nodes-base.postgresTool",
        "position": [
          780,
          140
        ],
        "parameters": {
          "query": "select\n  c.column_name,\n  c.data_type,\n  c.is_nullable,\n  c.column_default,\n  tc.constraint_type,\n  ccu.table_name AS referenced_table,\n  ccu.column_name AS referenced_column\nfrom\n  information_schema.columns c\nLEFT join\n  information_schema.key_column_usage kcu\n  ON c.table_name = kcu.table_name\n  AND c.column_name = kcu.column_name\nLEFT join\n  information_schema.table_constraints tc\n  ON kcu.constraint_name = tc.constraint_name\n  AND tc.constraint_type = 'FOREIGN KEY'\nLEFT join\n  information_schema.constraint_column_usage ccu\n  ON tc.constraint_name = ccu.constraint_name\nwhere\n  c.table_name = '{{ $fromAI(\"table_name\") }}'\n  AND c.table_schema = '{{ $fromAI(\"schema_name\") }}'\norder by\n  c.ordinal_position",
          "options": {},
          "operation": "executeQuery",
          "descriptionType": "manual",
          "toolDescription": "Get table definition to find all columns and types"
        },
        "credentials": {
          "postgres": {
            "id": "nGI61D0TEEZz18rr",
            "name": "Your Postgresql Database Credentials"
          }
        },
        "typeVersion": 2.5
      },
      {
        "id": "760bc9bc-0057-4088-b3f0-3ee37b3519df",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -300,
          -240
        ],
        "parameters": {
          "color": 5,
          "width": 560,
          "height": 120,
          "content": "### üë®‚Äçüé§ Setup\n1. Add your **postgresql** and **OpenAI** credentials.\n2. Click **Chat** button and start asking questions to your database.\n3. Activate the workflow and you can make the chat publicly available."
        },
        "typeVersion": 1
      },
      {
        "id": "0df33341-c859-4a54-b6d9-a99670e8d76d",
        "name": "Chat History",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          120,
          160
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "4938b22e-f187-4ca0-b9f1-60835e823799",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          360,
          300
        ],
        "parameters": {
          "color": 7,
          "width": 562,
          "height": 156,
          "content": "üõ†Ô∏è Tools Used:\n1. Execute SQL Query: Used to execute any query generated by the agent.\n2. Get DB Schema and Tables List: It returns the list of all the tables with its schema name.\n3. Get Table Definition: It returns table details like column names, foreign keys and more of a particular table in a schema."
        },
        "typeVersion": 1
      },
      {
        "id": "39780c78-4fbc-403e-a220-aa6a4b06df8c",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -100,
          300
        ],
        "parameters": {
          "color": 7,
          "width": 162,
          "height": 99,
          "content": "üëÜ You can exchange this with any other chat model of your choice."
        },
        "typeVersion": 1
      },
      {
        "id": "28a5692c-5003-46cb-9a09-b7867734f446",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          100,
          300
        ],
        "parameters": {
          "color": 7,
          "width": 162,
          "height": 159,
          "content": "üëÜ You can change how many number of messages to keep using `Context Window Length` option. It's 5 by default."
        },
        "typeVersion": 1
      },
      {
        "id": "c18ced71-6330-4ba0-9c52-1bb5852b3039",
        "name": "Execute SQL Query",
        "type": "n8n-nodes-base.postgresTool",
        "position": [
          380,
          140
        ],
        "parameters": {
          "query": "{{ $fromAI(\"sql_query\", \"SQL Query\") }}",
          "options": {},
          "operation": "executeQuery",
          "descriptionType": "manual",
          "toolDescription": "Get all the data from Postgres, make sure you append the tables with correct schema. Every table is associated with some schema in the database."
        },
        "credentials": {
          "postgres": {
            "id": "nGI61D0TEEZz18rr",
            "name": "Your Postgresql Database Credentials"
          }
        },
        "typeVersion": 2.5
      },
      {
        "id": "557623c6-e499-48a6-a066-744f64f8b6f3",
        "name": "Get DB Schema and Tables List",
        "type": "n8n-nodes-base.postgresTool",
        "position": [
          580,
          140
        ],
        "parameters": {
          "query": "SELECT \n    table_schema,\n    table_name\nFROM information_schema.tables\nWHERE table_type = 'BASE TABLE'\n    AND table_schema NOT IN ('pg_catalog', 'information_schema')\nORDER BY table_schema, table_name;",
          "options": {},
          "operation": "executeQuery",
          "descriptionType": "manual",
          "toolDescription": "Get list of all tables with their schema in the database"
        },
        "credentials": {
          "postgres": {
            "id": "nGI61D0TEEZz18rr",
            "name": "Your Postgresql Database Credentials"
          }
        },
        "typeVersion": 2.5
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "10c7c74e-b383-4ac7-8cb2-c9a15a2818fe",
    "connections": {
      "Chat History": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Execute SQL Query": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Get Table Definition": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get DB Schema and Tables List": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "09423a3357ff64bdcc082268b9d577001317edbe377a3ccfb0b131ffb9554b30",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "3be8d3e0-a672-4c85-95fb-9e21a1efe1b0",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          16,
          -32
        ],
        "webhookId": "2a0ed9f6-848a-4e48-ac72-4365da573b9f",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.3
      },
      {
        "id": "f81e185d-07b4-4cd5-8442-9bea79577e70",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          224,
          -32
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 2.2
      },
      {
        "id": "308d44ba-3d87-4405-900e-f5c6fb41c919",
        "name": "Search contacts in HubSpot",
        "type": "n8n-nodes-base.hubspotTool",
        "position": [
          448,
          176
        ],
        "parameters": {
          "operation": "search",
          "authentication": "oAuth2",
          "filterGroupsUi": {
            "filterGroupsValues": [
              {
                "filtersUi": {
                  "filterValues": [
                    {
                      "value": "={{ $fromAI('filterGroupsValues0_filterValues0_Value', ``, 'string') }}",
                      "operator": "={{ $fromAI('operator_0', `Choose a valid HubSpot CRM Search operator ‚Äî EQ (equal; exact match), NEQ (not equal), GT (greater than; numbers/timestamps in ms), GTE (>=), LT (<), LTE (<=), IN (equals any; supply values: [\"A\",\"B\",...]), NOT_IN (not in list). Note: date/time filters use epoch ms (UTC)`, 'string') }}",
                      "propertyName": "={{ $fromAI('property_name', `Choose an appropirate hubspot contact property name - email,firstname,lastname,createdate,lifecyclestage,hs_lead_status,country,state,hs_email_last_open_date,hs_email_last_reply_date,hs_sequences_is_enrolled,hs_sequences_enrolled_count,jobtitle,hubspot_owner_id,hs_sa_first_engagement_date,hs_last_sales_activity_timestamp`, 'string') }}"
                    },
                    {
                      "value": "={{ $fromAI('filterGroupsValues1_filterValues1_Value', ``, 'string') }}",
                      "operator": "={{ $fromAI('operator_1', `Choose a valid HubSpot CRM Search operator ‚Äî EQ (equal; exact match), NEQ (not equal), GT (greater than; numbers/timestamps in ms), GTE (>=), LT (<), LTE (<=), IN (equals any; supply values: [\"A\",\"B\",...]), NOT_IN (not in list). Note: date/time filters use epoch ms (UTC)`, 'string') }}",
                      "propertyName": "={{ $fromAI('property_name_1', `Optionally, choose another appropirate hubspot contact property name to filter by (useful for from - to date filtering in ms) - email,firstname,lastname,createdate,lifecyclestage,hs_lead_status,country,state,hs_email_last_open_date,hs_email_last_reply_date,hs_sequences_is_enrolled,hs_sequences_enrolled_count,jobtitle,hubspot_owner_id,hs_sa_first_engagement_date,hs_last_sales_activity_timestamp`, 'string') }}"
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "properties": "={{ [\"email\",\"firstname\",\"lastname\",\"createdate\",\"lifecyclestage\",\"hs_lead_status\",\"country\",\"state\",\"hs_email_last_open_date\",\"hs_email_last_reply_date\",\"hs_sequences_is_enrolled\",\"hs_sequences_enrolled_count\",\"jobtitle\",\"hubspot_owner_id\",\"hs_sa_first_engagement_date\",\"hs_last_sales_activity_timestamp\"] }}"
          }
        },
        "credentials": {
          "hubspotOAuth2Api": {
            "id": "Vxqd8oQJmbtNmpRz",
            "name": "HubSpot account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "f7fa3e15-296a-41d9-9e0c-4bf92d7cec1e",
        "name": "Search for deals in HubSpot",
        "type": "n8n-nodes-base.hubspotTool",
        "position": [
          624,
          176
        ],
        "parameters": {
          "resource": "deal",
          "operation": "search",
          "authentication": "oAuth2",
          "filterGroupsUi": {
            "filterGroupsValues": [
              {
                "filtersUi": {
                  "filterValues": [
                    {
                      "value": "={{ $fromAI('filterGroupsValues0_filterValues0_Value', ``, 'string') }}",
                      "operator": "={{ $fromAI('operator_0', `Choose a valid HubSpot CRM Search operator ‚Äî EQ (equal; exact match), NEQ (not equal), GT (greater than; numbers/timestamps in ms), GTE (>=), LT (<), LTE (<=), IN (equals any; supply values: [\"A\",\"B\",...]), NOT_IN (not in list). Note: date/time filters use epoch ms (UTC)`, 'string') }}",
                      "propertyName": "={{ $fromAI('property_name_0', `Choose an appropriate hubspot deal property name - dealname,amount,dealstage,pipeline,dealtype,closedate,createdate,hs_lastmodifieddate,hubspot_owner_id,deal_currency_code,hs_deal_stage_probability,hs_last_activity_date,hs_next_activity_date,hs_is_closed_won,num_associated_contacts,hs_object_id`, 'string') }}"
                    },
                    {
                      "value": "={{ $fromAI('filterGroupsValues1_filterValues1_Value', ``, 'string') }}",
                      "operator": "={{ $fromAI('operator_1', `Choose a valid HubSpot CRM Search operator ‚Äî EQ (equal; exact match), NEQ (not equal), GT (greater than; numbers/timestamps in ms), GTE (>=), LT (<), LTE (<=), IN (equals any; supply values: [\"A\",\"B\",...]), NOT_IN (not in list). Note: date/time filters use epoch ms (UTC)`, 'string') }}",
                      "propertyName": "={{ $fromAI('property_name_1', `Optionally, choose another appropirate hubspot deal property name to filter by (useful for from - to date filtering in ms) - dealname,amount,dealstage,pipeline,dealtype,closedate,createdate,hs_lastmodifieddate,hubspot_owner_id,deal_currency_code,hs_deal_stage_probability,hs_last_activity_date,hs_next_activity_date,hs_is_closed_won,num_associated_contacts,hs_object_id`, 'string') }}"
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "properties": [
              "dealname",
              "amount",
              "dealstage",
              "pipeline",
              "dealtype",
              "closedate",
              "createdate",
              "hs_lastmodifieddate",
              "hubspot_owner_id",
              "num_associated_contacts",
              "hs_deal_stage_probability"
            ]
          }
        },
        "credentials": {
          "hubspotOAuth2Api": {
            "id": "Vxqd8oQJmbtNmpRz",
            "name": "HubSpot account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "7ce28fb1-809f-4d6b-be7d-2707dece9fed",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          272,
          176
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "5ffea926-84dc-48ad-a0d3-1b9c9967c7cd",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -544,
          -128
        ],
        "parameters": {
          "color": 5,
          "width": 480,
          "height": 464,
          "content": "## Chat with HubSpot (Contacts + Deals)\n\n### How it works\n1. Start a chat (Chat Trigger).\n2. **AI Agent** (OpenAI) interprets your question.\n3. Runs live HubSpot **Contacts** and **Deals** searches via tool nodes (dynamic filters with `$fromAI`).\n4. Returns compact results; memory keeps follow-up context.\n\n### Setup\n* [ ] Connect **HubSpot** on both AI tool nodes\n* [ ] Add your **OpenAI** API key to the Chat Model\n* [ ] (Optional) Predefine common filters (stage, owner, date ranges)\n\n### Customize\n* **Guardrails:** allowlisted properties/operators, max results, safe defaults\n* **Output:** request a table (name, email, stage, owner) or export to CSV/Slack"
        },
        "typeVersion": 1
      },
      {
        "id": "1ab36139-3a8b-4cc3-9dd5-0af717b4b969",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          96,
          176
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5",
            "cachedResultName": "gpt-5"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "HRhpxrc6RPQ9pKPS",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      }
    ],
    "pinData": {},
    "connections": {
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Search contacts in HubSpot": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search for deals in HubSpot": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "HpfD2OfzgRMPn3Jf",
    "meta": {
      "instanceId": "8443f10082278c46aa5cf3acf8ff0f70061a2c58bce76efac814b16290845177",
      "templateCredsSetupCompleted": true
    },
    "name": "Post-Service Review Collector",
    "tags": [],
    "nodes": [
      {
        "id": "5ad55032-d22a-4bf5-8107-0de7a4b18d57",
        "name": "When clicking ‚ÄòExecute workflow‚Äô",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -576,
          -96
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "d3590ccb-048d-45a7-b3df-fb0d73c58206",
        "name": "Validate Deal Fetch Success",
        "type": "n8n-nodes-base.if",
        "position": [
          48,
          -96
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "e2adb005-2b3c-4d1e-8445-442df1fe925a",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.id }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "f7322a5c-5d60-491d-8bf2-f9c86cdf6a08",
        "name": "Log Errors in Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          368,
          480
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "error_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "error_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "error",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "error",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "error_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1338537721,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Uldk_4BxWbdZTDZxFUeohIfeBmGHHqVEl9Ogb0l6R8Y/edit#gid=1338537721",
            "cachedResultName": "error log sheet"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1Uldk_4BxWbdZTDZxFUeohIfeBmGHHqVEl9Ogb0l6R8Y",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Uldk_4BxWbdZTDZxFUeohIfeBmGHHqVEl9Ogb0l6R8Y/edit?usp=drivesdk",
            "cachedResultName": "Interviewer Brief Pack "
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "kpPEOLCGn963qpoh",
            "name": "automations@techdome.ai"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "9ba98d72-ea5f-48f3-a68b-51e888202b77",
        "name": "Fetch All Won Deals from HighLevel",
        "type": "n8n-nodes-base.highLevel",
        "position": [
          -224,
          -96
        ],
        "parameters": {
          "filters": {
            "status": "won"
          },
          "resource": "opportunity",
          "operation": "getAll",
          "requestOptions": {}
        },
        "credentials": {
          "highLevelOAuth2Api": {
            "id": "5QWHSi134dLIBEsC",
            "name": "HighLevel account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "f1c517f9-a54d-4691-ac3f-e7815fe4378b",
        "name": "Generate Personalized Review Request Email (AI)",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          448,
          -112
        ],
        "parameters": {
          "text": "=Generate an HTML-formatted review-request email for a client who has just completed a project with our agency.  \nUse the following deal data to personalize the message:\n{{JSON.stringify($json)}}\n\nThe email should:\n1. Address the client by name.  \n2. Thank them for working with our agency.  \n3. Politely ask for their feedback and a quick public review.  \n4. Include two call-to-action buttons:\n   - One leading to the Google Review page: https://share.google/W3i4ulISiqRONADvO  \n   - Another leading to the internal Google Form: https://docs.google.com/forms/d/e/1FAIpQLScot2dbxFrx7jS8oTbQa3HZy9SSUtuB0iYch5U83UNNEwB9_g/viewform?usp=publish-editor  \n5. End with a warm closing line from the Techdome team.  \nKeep the tone professional, grateful, and concise.  \nReturn only the HTML email body‚Äîno markdown or explanations.\n",
          "options": {
            "systemMessage": "=You are an AI email writer for a client-success automation system.  \nYour task is to generate short, professional, visually clear HTML emails for clients after their project or service is completed.  \nThe tone should be friendly and appreciative, encouraging them to share feedback and public reviews.  \nAlways include clickable buttons styled with simple inline CSS (rounded corners, Techdome blue #1263ff).  \nDo not use markdown, return only HTML output.\n"
          },
          "promptType": "define"
        },
        "typeVersion": 2.1
      },
      {
        "id": "643e6cad-4045-45f6-833b-1571769bc48e",
        "name": "Configure GPT-4o Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
        "position": [
          448,
          80
        ],
        "parameters": {
          "model": "gpt-4o",
          "options": {}
        },
        "credentials": {
          "azureOpenAiApi": {
            "id": "C3WzT18XqF8OdVM6",
            "name": "Azure Open AI account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5f536653-7ba9-449e-a79c-31fefe83c811",
        "name": "Send Review Request Email to Client",
        "type": "n8n-nodes-base.gmail",
        "position": [
          848,
          -112
        ],
        "webhookId": "0c82c299-6938-42ed-bda6-5007d79af34f",
        "parameters": {
          "sendTo": "=newscctv22@gmail.com",
          "message": "={{ $json.output }}",
          "options": {},
          "subject": "=Thank You for Working with Techdome .\n"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "RchiXdmY8WaQhOSJ",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "2c27e2a5-0daa-40a3-9a89-306166bb2e3f",
        "name": "Retrieve Email Thread for Response",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1312,
          -112
        ],
        "webhookId": "ffb3a844-8c8b-4f17-a6e9-98e0371f4214",
        "parameters": {
          "options": {},
          "resource": "thread",
          "threadId": "={{ $json.threadId }}",
          "operation": "get"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "RchiXdmY8WaQhOSJ",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "c33cb722-a2ef-400e-b593-4322e9b7a946",
        "name": "Configure GPT-4o Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
        "position": [
          1568,
          128
        ],
        "parameters": {
          "model": "gpt-4o",
          "options": {}
        },
        "credentials": {
          "azureOpenAiApi": {
            "id": "C3WzT18XqF8OdVM6",
            "name": "Azure Open AI account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c9a7bf45-e0ba-4cb5-9374-a05098b89981",
        "name": " Wait for 24 Hours Before Next Action",
        "type": "n8n-nodes-base.wait",
        "position": [
          1088,
          -112
        ],
        "webhookId": "7475fece-4562-46b3-a702-7a5c5fe88266",
        "parameters": {
          "amount": 24
        },
        "typeVersion": 1
      },
      {
        "id": "4cfc001b-aa03-4a81-b7f4-e3d7ae01ad68",
        "name": "Summarize Client Feedback (AI)",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1568,
          -112
        ],
        "parameters": {
          "text": "=You are an AI assistant that summarizes client feedback threads for internal Slack updates.\n\nGiven the following Gmail thread JSON:\n{{JSON.stringify($json)}}\n\nCreate a short Slack message in this format:\n\n---\nüéâ *New Client Review Received!*\n\n*Client:* {{ $('Fetch All Won Deals from HighLevel').item.json.name }}\n*Feedback:* {{ $json.messages[1].snippet }}\n*Sentiment:* {{positive/neutral/negative}}  \n\n\n---\n\nKeep it concise, human-readable, and formatted for Slack (use Markdown formatting). Do not include HTML or JSON ‚Äî return plain text formatted for Slack.\n",
          "options": {
            "systemMessage": "=You are a client-success AI summarizer. \nYour goal is to turn raw Gmail thread data (including ‚ÄúThank you‚Äù replies) into short, clean, Slack-ready summaries. \nFocus on identifying who replied (client name), what they said, and the tone (positive/neutral/negative).\n"
          },
          "promptType": "define"
        },
        "typeVersion": 2.1
      },
      {
        "id": "544bd495-5eb1-49e5-9a5f-b0d1a2ddf709",
        "name": " Announce Review Summary in Slack",
        "type": "n8n-nodes-base.slack",
        "position": [
          1952,
          -112
        ],
        "webhookId": "ddaa7632-9e35-4bd3-82d6-572d5cae84cc",
        "parameters": {
          "text": "={{ $json.output }}",
          "user": {
            "__rl": true,
            "mode": "list",
            "value": "U09HMPVD466",
            "cachedResultName": "newscctv22"
          },
          "select": "user",
          "otherOptions": {}
        },
        "credentials": {
          "slackApi": {
            "id": "rNqvWj9TfChPVRYY",
            "name": "Slack account vivek"
          }
        },
        "typeVersion": 2.3
      },
      {
        "id": "12cf47f3-4f3a-4146-a898-e15971639c97",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1136,
          -912
        ],
        "parameters": {
          "width": 608,
          "height": 576,
          "content": "## How it works\nThis workflow automates the client-review process after a deal is marked as ‚ÄúWon‚Äù in HighLevel CRM.  \nIt starts manually or on trigger, retrieves the latest won deals, validates them, and uses Azure OpenAI GPT-4o to create a personalized HTML review-request email.  \nThe email thanks the client, includes links to leave a Google Review and fill an internal feedback form, and sends it automatically through Gmail.  \nAfter 24 hours, the workflow checks the client‚Äôs reply thread, summarizes the feedback tone using GPT-4o, and posts a concise Slack update for the internal team.  \nAny API or data errors are recorded in Google Sheets for transparency and debugging.\n\n## Setup steps\n1. Connect these credentials:\n   - HighLevel API  \n   - Azure OpenAI (GPT-4o)  \n   - Gmail  \n   - Slack  \n   - Google Sheets  \n2. Replace Sheet IDs and Slack user/channel references.  \n3. Update email subject, sender, and review links if needed.  \n4. Optionally schedule automatic triggers instead of manual runs.  \n5. Test once with a dummy ‚ÄúWon‚Äù deal to verify end-to-end flow.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3524ab6d-22b6-4abd-abfa-33073738457a",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -336,
          -304
        ],
        "parameters": {
          "color": 7,
          "width": 624,
          "height": 416,
          "content": "## Deal Fetch & Validation\nFetches all deals with ‚ÄúWon‚Äù status from HighLevel and checks for valid data before proceeding.  \nPrevents empty or incomplete deal entries from triggering the AI email generator.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "28f81e01-fbc4-4e12-aa3d-e343df9ef37e",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          368,
          -288
        ],
        "parameters": {
          "color": 7,
          "width": 368,
          "height": 512,
          "content": "## AI-Powered Email Generation\nUses GPT-4o to craft a personalized, HTML review-request email.  \nIncludes thank-you text, brand-styled buttons for Google Reviews and internal feedback, and a warm closing line.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "d3be7c5b-de2b-4b78-9adc-9ab36c1cde69",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          768,
          -336
        ],
        "parameters": {
          "color": 7,
          "height": 544,
          "content": "## Email Delivery\nSends the GPT-generated review-request email through Gmail to the client‚Äôs registered address.  \nTracks the sent message for later thread retrieval and analysis.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "6976f94f-eade-4846-8723-5a2eba0e71ac",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1040,
          -320
        ],
        "parameters": {
          "color": 7,
          "width": 432,
          "height": 496,
          "content": "## Waiting & Feedback Retrieval\nPauses for 24 hours to give clients time to reply, then fetches the full Gmail thread.  \nEnsures the latest feedback message is available for sentiment analysis.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "31e6f968-061d-4796-863f-9f5617a64f2d",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1504,
          -352
        ],
        "parameters": {
          "color": 7,
          "width": 368,
          "height": 640,
          "content": "## AI Feedback Summarization\nGPT-4o analyzes the client‚Äôs response and creates a short Slack-formatted summary.  \nCaptures client name, key feedback, and overall sentiment (Positive/Neutral/Negative).\n"
        },
        "typeVersion": 1
      },
      {
        "id": "0b0535cf-0afc-44bd-ac14-17ae2f83dd82",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1888,
          -352
        ],
        "parameters": {
          "color": 7,
          "height": 464,
          "content": "## Slack Announcement\nPosts the summarized client feedback in a Slack channel.  \nNotifies the team in real time and helps track post-service satisfaction trends.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "4d6af1bd-b453-42ac-a491-eb8266b74ba4",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          304,
          304
        ],
        "parameters": {
          "color": 7,
          "height": 416,
          "content": "## Error Logging\nAppends any workflow or API issues to a shared Google Sheet.  \nMaintains an audit trail for error resolution and workflow reliability checks.\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "a5d94f82-72ae-4824-9d7d-751ff361544f",
    "connections": {
      "Configure GPT-4o Model": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Personalized Review Request Email (AI)",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Configure GPT-4o Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Summarize Client Feedback (AI)",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Validate Deal Fetch Success": {
        "main": [
          [
            {
              "node": "Generate Personalized Review Request Email (AI)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Log Errors in Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Summarize Client Feedback (AI)": {
        "main": [
          [
            {
              "node": " Announce Review Summary in Slack",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch All Won Deals from HighLevel": {
        "main": [
          [
            {
              "node": "Validate Deal Fetch Success",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Retrieve Email Thread for Response": {
        "main": [
          [
            {
              "node": "Summarize Client Feedback (AI)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Review Request Email to Client": {
        "main": [
          [
            {
              "node": " Wait for 24 Hours Before Next Action",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòExecute workflow‚Äô": {
        "main": [
          [
            {
              "node": "Fetch All Won Deals from HighLevel",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Wait for 24 Hours Before Next Action": {
        "main": [
          [
            {
              "node": "Retrieve Email Thread for Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Personalized Review Request Email (AI)": {
        "main": [
          [
            {
              "node": "Send Review Request Email to Client",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "21dF4yje1iQpP4jQ",
    "meta": {
      "instanceId": "a2b23892dd6989fda7c1209b381f5850373a7d2b85609624d7c2b7a092671d44",
      "templateCredsSetupCompleted": true
    },
    "name": "üí•Clone a viral TikTok and auto-post it to 9 platforms using Perplexity & Blotato vide",
    "tags": [],
    "nodes": [
      {
        "id": "8ad59e84-639c-4a44-afdc-611d15f32d7f",
        "name": "Assign Social Media IDs",
        "type": "n8n-nodes-base.set",
        "position": [
          -80,
          920
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "{\n  \"instagram_id\": \"0000\",\n  \"youtube_id\": \"0000\",\n  \"threads_id\": \"0000\",\n  \"tiktok_id\": \"0000\",\n  \"facebook_id\": \"0000\",\n  \"facebook_page_id\": \"000000000000\",\n  \"twitter_id\": \"0000\",\n  \"linkedin_id\": \"0000\",\n  \"pinterest_id\": \"0000\",\n  \"pinterest_board_id\": \"00000000000000000000\",\n  \"bluesky_id\": \"0000\"\n}\n"
        },
        "typeVersion": 3.4
      },
      {
        "id": "2e243d6a-81ef-487f-8852-bd48cfaf5ad8",
        "name": "Upload Video to Blotato",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          140,
          920
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/media",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "url",
                "value": "={{ $('Update Final Video URL in Sheet').item.json['URL de la vid√©o'] }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f84ff66b-9270-494f-80e7-29ad2fd51b4d",
        "name": "INSTAGRAM",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          420,
          680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.instagram_id }}\",\n    \"target\": {\n      \"targetType\": \"instagram\"\n    },\n    \"content\": {\n      \"text\": \"{{ $('Save Rewritten Video to Google Sheets').item.json.Caption }}\",\n      \"platform\": \"instagram\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "=YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "3776e592-07be-47e2-89a8-f8d338f0c25e",
        "name": "YOUTUBE",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          640,
          680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.youtube_id }}\",\n    \"target\": {\n      \"targetType\": \"youtube\",\n      \"title\": \"{{ $('Save Rewritten Video to Google Sheets').item.json['Texte superpos√©'] }}\",\n      \"privacyStatus\": \"unlisted\",\n      \"shouldNotifySubscribers\": \"false\"\n    },\n    \"content\": {\n      \"text\": \"{{ $('Save Rewritten Video to Google Sheets').item.json.Caption }}\",\n      \"platform\": \"youtube\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "c590765f-deb4-4221-ada7-37c700656ff1",
        "name": "TIKTOK",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          840,
          680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.tiktok_id }}\",\n    \"target\": {\n      \"targetType\": \"tiktok\",\n      \"isYourBrand\": \"false\", \n      \"disabledDuet\": \"false\",\n      \"privacyLevel\": \"PUBLIC_TO_EVERYONE\",\n      \"isAiGenerated\": \"true\",\n      \"disabledStitch\": \"false\",\n      \"disabledComments\": \"false\",\n      \"isBrandedContent\": \"false\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Save Rewritten Video to Google Sheets').item.json.Caption }}\",\n      \"platform\": \"tiktok\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "9a9dc42a-20b6-427d-a7d9-08f4ab924e9e",
        "name": "FACEBOOK",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          420,
          920
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.facebook_id }}\",\n    \"target\": {\n      \"targetType\": \"facebook\",\n      \"pageId\": \"{{ $('Assign Social Media IDs').item.json.facebook_page_id }}\"\n\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Save Rewritten Video to Google Sheets').item.json.Caption }}\",\n      \"platform\": \"facebook\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "987a372a-d27e-4a3e-a8b7-b2085463c05a",
        "name": "THREADS",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          640,
          920
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.threads_id }}\",\n    \"target\": {\n      \"targetType\": \"threads\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Save Rewritten Video to Google Sheets').item.json.Caption }}\",\n      \"platform\": \"threads\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "e9d66412-e27d-47f0-9d17-5ec36fe81859",
        "name": "TWETTER",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          840,
          920
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.twitter_id }}\",\n    \"target\": {\n      \"targetType\": \"twitter\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Save Rewritten Video to Google Sheets').item.json.Caption }}\",\n      \"platform\": \"twitter\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "=YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "9e7e0fa8-3f0e-4111-9d78-96123ccec1c8",
        "name": "LINKEDIN",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          420,
          1160
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.linkedin_id }}\",\n    \"target\": {\n      \"targetType\": \"linkedin\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Save Rewritten Video to Google Sheets').item.json.Caption }}\",\n      \"platform\": \"linkedin\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "3368ee92-d40f-482d-8174-53bfd188d2c8",
        "name": "BLUESKY",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          640,
          1160
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "= {\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.bluesky_id }}\",\n    \"target\": {\n      \"targetType\": \"bluesky\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Save Rewritten Video to Google Sheets').item.json.Caption }}\",\n      \"platform\": \"bluesky\",\n      \"mediaUrls\": [\n        \"https://pbs.twimg.com/media/GE8MgIiWEAAfsK3.jpg\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "fea89732-09cc-420d-b2e0-f0f4160d27cb",
        "name": "PINTEREST",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          840,
          1160
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.pinterest_id }}\",\n    \"target\": {\n      \"targetType\": \"pinterest\",\n      \"boardId\": \"{{ $('Assign Social Media IDs').item.json.pinterest_board_id }}\"      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Save Rewritten Video to Google Sheets').item.json.Caption }}\",\n      \"platform\": \"pinterest\",\n      \"mediaUrls\": [\n        \"https://pbs.twimg.com/media/GE8MgIiWEAAfsK3.jpg\"\n      ]\n    }\n  }\n}\n\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "d1400430-0340-4194-b5eb-bd3ae150d577",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -740,
          -380
        ],
        "parameters": {
          "width": 2460,
          "height": 300,
          "content": "# üü´ STEP 1 ‚Äî Clone a viral TikTok video"
        },
        "typeVersion": 1
      },
      {
        "id": "91bf1e19-3e2c-44b3-a7d0-8bea3f80eb04",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -740,
          -20
        ],
        "parameters": {
          "color": 4,
          "width": 1920,
          "height": 320,
          "content": "# üü¶ STEP 2 ‚Äî Suggest new content idea\n"
        },
        "typeVersion": 1
      },
      {
        "id": "a831f320-0b5f-4853-8b9c-0ddeaaf84083",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -740,
          340
        ],
        "parameters": {
          "width": 1920,
          "height": 300,
          "content": "# üü™ STEP 3 ‚Äî Create the new video with your avatar\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3bb22fc4-b5b4-4323-9039-5b6cf0458084",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -740,
          660
        ],
        "parameters": {
          "color": 3,
          "width": 1920,
          "height": 680,
          "content": "# üü• STEP 4 ‚Äî Publish to 9 platforms\n"
        },
        "typeVersion": 1
      },
      {
        "id": "6ad81fc8-d79d-44d1-bf17-cdea14e915d1",
        "name": "Trigger: Get TikTok URL via Telegram",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -620,
          -280
        ],
        "webhookId": "9a749f58-0f17-45ef-80a9-0e8d17bde5b5",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "fO6eyZMLBk66Au44",
            "name": "Telegram account 5"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "4047a3b1-1fb9-40da-b127-f2e7432a649e",
        "name": "Download TikTok Video (RapidAPI)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -400,
          -280
        ],
        "parameters": {
          "url": "=https://tiktok-download-video1.p.rapidapi.com/getVideo?url={{ $json.message.text }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "x-rapidapi-host",
                "value": "tiktok-download-video1.p.rapidapi.com"
              },
              {
                "name": "x-rapidapi-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "6ec78da8-f197-42c0-b631-055bd7bf1eef",
        "name": "Extract Video Thumbnail",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -180,
          -280
        ],
        "parameters": {
          "url": "={{ $json.data.origin_cover }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "f17f39cd-d9f4-4b1b-85de-ade8a5492542",
        "name": "Upload Thumbnail to Cloudinary",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          40,
          -280
        ],
        "parameters": {
          "url": "https://api.cloudinary.com/v1_1/YOUR_ID/image/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "file",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              },
              {
                "name": "upload_preset",
                "value": "n8n_clone"
              }
            ]
          },
          "genericAuthType": "httpBasicAuth"
        },
        "credentials": {
          "httpBasicAuth": {
            "id": "K1UGehJnDI8N25UA",
            "name": "Unnamed credential"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "160a5960-1312-4c5f-b066-f1ecc30202e6",
        "name": "Analyze Thumbnail (GPT-4o Vision)",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          260,
          -280
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "resource": "image",
          "imageUrls": "={{ $json.url }}",
          "operation": "analyze"
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "14a42907-4bc7-4c4a-9ced-a2a23bb88343",
        "name": "Extract Overlay Text (GPT-4o)",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          480,
          -280
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Identify the primary text located at the top of the image described above:\n{{ $json.content }}\n\nReturn only that specific top text as the output.\n\nDo not include any quotation marks.\n\nFocus only on the top section's text in the image and disregard any other content."
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "2c183a03-3bb5-45b8-8bc9-5981f0bc30b5",
        "name": "Download TikTok Audio",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          840,
          -280
        ],
        "parameters": {
          "url": "={{ $('Download TikTok Video (RapidAPI)').item.json.data.music }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "c6614b8c-6415-4094-a800-302ae8711d14",
        "name": "Transcribe Audio to Script (GPT)",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          1060,
          -280
        ],
        "parameters": {
          "options": {},
          "resource": "audio",
          "operation": "transcribe"
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "02ddecfe-5a85-4247-9a33-fc95c42775a0",
        "name": "Generate Unique Template ID",
        "type": "n8n-nodes-base.code",
        "position": [
          1280,
          -280
        ],
        "parameters": {
          "jsCode": "// Utility to create a random alphanumeric ID\nfunction createUniqueId(length = 12) {\n  const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  let id = '';\n  for (let i = 0; i < length; i++) {\n    const randomIndex = Math.floor(Math.random() * characters.length);\n    id += characters[randomIndex];\n  }\n  return id;\n}\n\n// Return the ID in the expected output structure\nreturn [\n  {\n    json: {\n      code: createUniqueId()\n    }\n  }\n];"
        },
        "typeVersion": 2
      },
      {
        "id": "e7e17a73-c75d-413d-842b-aecd0da25eb7",
        "name": "Save Original Video to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1500,
          -280
        ],
        "parameters": {
          "columns": {
            "value": {
              "Caption": "={{ $('Download TikTok Video (RapidAPI)').item.json.data.title }}",
              "ID du mod√®le": "={{ $json.code }}",
              "Lien de la vid√©o": "={{ $('Trigger: Get TikTok URL via Telegram').item.json.message.text }}",
              "Mod√®le de script vid√©o": "={{ $('Transcribe Audio to Script (GPT)').item.json.text }}",
              "Mod√®le de texte superpos√©": "={{ $('Download TikTok Audio').item.json.message.content }}"
            },
            "schema": [
              {
                "id": "ID du mod√®le",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "ID du mod√®le",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Lien de la vid√©o",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Lien de la vid√©o",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Mod√®le de texte superpos√©",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Mod√®le de texte superpos√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Mod√®le de script vid√©o",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Mod√®le de script vid√©o",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Caption",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SoYJvZbVNn4L1FNfk9eFqx_vGlCsMxgw8bx0DVFgBLY/edit#gid=0",
            "cachedResultName": "Template"
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "e6647507-595e-4f13-9c06-818f90b7759a",
        "name": "Suggest Similar Idea (Perplexity)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -620,
          60
        ],
        "parameters": {
          "url": "https://api.perplexity.ai/chat/completions",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"model\": \"sonar-reasoning\",\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"Suggest a content idea different from this video script: \\\"{{ $json['Mod√®le de script vid√©o'] }}\\\". It should be in the same niche and on the exact same topic or content idea but offer fresh value. You must pick one idea from your research that matches the topic idea of the video script exactly but is also different and unique from it so it would stand out on social media. Example: if the video script contains a list of tools, your topic must also be a list of tools in that video script topic but slightly different, maybe different tools etc. If the video's script is about a plan, strategies, or whatever, you must also make your topic about that. So you must maintain the nature of the topic in the video script. You absolutely must be specific as the original video script. You can't just mention generic tools or strategies if the original video script contains specific tools. Etc. That is the level of accuracy and perfect matching of the video script original topic. Make sure it appeals to a broad audience like the example.\"\n    }\n  ]\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer YOUR_TOKEN_HERE"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "a6c047ca-824e-4e33-895f-3be02e509fc6",
        "name": "Clean Perplexity Response",
        "type": "n8n-nodes-base.code",
        "position": [
          -380,
          60
        ],
        "parameters": {
          "jsCode": "// Step 1: Pull raw input\nlet raw = $input.first().json.choices[0].message.content;\n// Step 2: Forcefully remove anything between <think> and </think>\nlet cleaned = raw.replace(/<think>(.|\\n)*?<\\/think>/gi,\n'').trim();\n// Optional cleanup: remove leading/trailing blank lines\ncleaned = cleaned.replace(/^\\s+|\\s+$/g, '');\n// Done\nreturn [\n{\njson: {\ncleanedResponse: cleaned\n}\n}\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "3b5e242f-b10c-4c8e-be2a-acbc95a92658",
        "name": "Rewrite Script, Caption, Overlay (GPT-4o)",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          -60,
          60
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=You are rewriting a TikTok video script, caption, and overlay ‚Äî\nnot inventing a new one. You must follow this format and obey\nthese rules strictly.\n---\n### CONTEXT:\nHere is the content idea to use:\n{{ $json.cleanedResponse }}\n\n---\n### STEP 1: Rewrite the original video script BELOW using the new\ntopic/context above but maintaiin as stubbornly as possible the\noriginal script structure and style:\nOriginal script: {{ $('Save Original Video to Google Sheets').item.json['Mod√®le de script vid√©o'] }}\n\n\nüõë DO NOT CHANGE the original structure or style but\nThis includes:\n- Numbered list\n- Sentence breaks\n- \"I\" or first-person narration\n- Colloquial/informal tone (like ‚Äúyou're gonna wanna...‚Äù)\n‚úÇÔ∏è You MUST keep:\n- first person narration of the orignal script at all costs\n- MUST be under 700 characters (yes \"Characters\" not wordcount)\nthis is an absolute MUST, no more than 700 characters!!! But never\nchange the structure or narration style of the original script. It\nmust be an exact imitation.\n‚úèÔ∏è You MAY change:\n- Tool names\n- Use cases\n- Descriptions\n- Niche-specific keywords\n\n#Rule: never use any characers like \"\" in your generated video\nscript as this will yeild syntax errors.\n---\n### STEP 2: Rewrite the caption text using the new topic.\nKeep:\n- Same structure and tone\n- Same use of #hashtags but space between each hashtag\n- Similar sentence count and layout\nCaption:\n{{ $('Save Original Video to Google Sheets').item.json.Caption }}\n\n---\n### STEP 3: Rewrite the text overlay (short version for the\nthumbnail or first screen)\nKeep:\n- EXACT Same length format, case, structure\n- Do NOT invent new words unless absolutely necessary\nOverlay:\n{{ $('Save Original Video to Google Sheets').item.json['Mod√®le de texte superpos√©'] }}\n---\n### FINAL OUTPUT FORMAT (no markdown formatting):\nText Overlay: [REWRITTEN TEXT OVERLAY]\nVideo Script: [REWRITTEN SCRIPT]\nCaption Text: [REWRITTEN CAPTION TEXT]\nDO NOT return any explanations. Only return the rewritten\nsections."
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "befec852-bca2-4c54-9c2c-49a8c082e2b4",
        "name": "Split Rewritten Content into Sections",
        "type": "n8n-nodes-base.code",
        "position": [
          420,
          60
        ],
        "parameters": {
          "jsCode": "// R√©cup√®re le contenu du premier item\nconst input = $input.first().json.message.content;\n\n// On tol√®re les retours √† la ligne r√©els (\\n) ou √©chapp√©s (\\\\n)\n\n// Text Overlay\nconst textOverlayMatch = input.match(\n  /Text\\s*Overlay:\\s*(.+?)(?:\\r?\\n|\\\\n)/s\n);\n\n// Video Script\nconst videoScriptMatch = input.match(\n  /Video\\s*Script:\\s*(.+?)(?:\\r?\\n|\\\\n)Caption\\s*Text:/s\n);\n\n// Caption Text (jusqu'√† la fin)\nconst captionTextMatch = input.match(\n  /Caption\\s*Text:\\s*(.+)/s\n);\n\nreturn [\n  {\n    json: {\n      textOverlay:   textOverlayMatch   ? textOverlayMatch[1].trim()   : null,\n      videoScript:   videoScriptMatch   ? videoScriptMatch[1].trim()   : null,\n      captionText:   captionTextMatch   ? captionTextMatch[1].trim()   : null,\n    }\n  }\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "49828685-cf54-45ac-96d9-03697215f80e",
        "name": "Generate New Video ID",
        "type": "n8n-nodes-base.code",
        "position": [
          640,
          60
        ],
        "parameters": {
          "jsCode": "// Utility to create a random alphanumeric ID\nfunction createUniqueId(length = 12) {\n  const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  let id = '';\n  for (let i = 0; i < length; i++) {\n    const randomIndex = Math.floor(Math.random() * characters.length);\n    id += characters[randomIndex];\n  }\n  return id;\n}\n\n// Return the ID in the expected output structure\nreturn [\n  {\n    json: {\n      code: createUniqueId()\n    }\n  }\n];"
        },
        "typeVersion": 2
      },
      {
        "id": "c9f02616-a944-471b-9c4d-7fa381d684b9",
        "name": "Save Rewritten Video to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          820,
          60
        ],
        "parameters": {
          "columns": {
            "value": {
              "Sujet": "={{ $('Clean Perplexity Response').first().json.cleanedResponse }}",
              "Script": "={{ $('Split Rewritten Content into Sections').item.json.videoScript }}",
              "Caption": "={{ $('Split Rewritten Content into Sections').item.json.captionText }}",
              "ID du mod√®le": "={{ $('Generate Unique Template ID').first().json.code }}",
              "ID de la vid√©o": "={{ $json.code }}",
              "Texte superpos√©": "={{ $('Split Rewritten Content into Sections').item.json.textOverlay }}"
            },
            "schema": [
              {
                "id": "ID du mod√®le",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "ID du mod√®le",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID de la vid√©o",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "ID de la vid√©o",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Sujet",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Sujet",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Texte superpos√©",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Texte superpos√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Script",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Script",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Caption",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL de la vid√©o",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "URL de la vid√©o",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Date de publication",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Date de publication",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Statut",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Statut",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "=52679157"
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "dbd21507-ecdf-49c7-b449-e4a6f9fcca86",
        "name": "Fetch Available Avatars",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -620,
          440
        ],
        "parameters": {
          "url": "https://api.captions.ai/api/creator/list",
          "method": "POST",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "x-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "988a3283-a57d-4c81-b582-bb59e715208b",
        "name": "Generate Video with Avatar",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -380,
          440
        ],
        "parameters": {
          "url": "https://api.captions.ai/api/creator/submit",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n\"script\": \"{{ $('Save Rewritten Video to Google Sheets').item.json.Script }}\",\n\"creatorName\": \"{{ $json.supportedCreators[0] }}\",\n\"resolution\": \"fhd\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "x-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "99f95617-c27e-4952-9da6-93bb818d374c",
        "name": "Wait for Avatar Rendering (3 min)",
        "type": "n8n-nodes-base.wait",
        "position": [
          -180,
          440
        ],
        "webhookId": "779e4676-d28f-4be9-9118-c90c688e805a",
        "parameters": {
          "unit": "minutes",
          "amount": 3
        },
        "typeVersion": 1.1
      },
      {
        "id": "78dd3c62-a184-4ec0-9153-002a0ac3209f",
        "name": "Fetch Avatar Video URL",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          20,
          440
        ],
        "parameters": {
          "url": "https://api.captions.ai/api/creator/poll",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n \"operationId\": \"{{ $json[\"operationId\"] }}\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "x-api-key",
                "value": "YOUR_API_KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "8c6af2a2-c052-40b3-825a-463d7c17b060",
        "name": "Add Overlay Text with JSON2Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          220,
          440
        ],
        "parameters": {
          "url": "https://api.json2video.com/v2/movies",
          "method": "POST",
          "options": {},
          "jsonBody": "=\n{\n\"id\": \"qbaasr7s\",\n\"resolution\": \"instagram-story\",\n\"quality\": \"high\",\n\"scenes\": [\n{\n\"id\": \"qyjh9lwj\",\n\"comment\": \"Scene 1\",\n\"elements\": []\n}\n],\n\"elements\": [\n{\n\"id\": \"q6dznzcv\",\n\"type\": \"video\",\n\"src\": \"{{ $json.url }}\",\n\"resize\": \"cover\"\n},\n{\n\"id\": \"top-text\",\n\"type\": \"text\",\n\"text\": \"{{ $('Save Rewritten Video to Google Sheets').item.json['Texte superpos√©'] }}\",\n\"settings\": {\n\"font-family\": \"Arial\",\n\"font-size\": \"60px\",\n\"color\": \"#000000\",\n\"background-color\": \"#FFFFFF\",\n\"horizontal-position\": \"center\",\n\"vertical-position\": \"top\",\n\"margin-top\": \"100px\",\n\"word-break\": \"break-word\",\n\"overflow-wrap\": \"break-word\",\n\"font-weight\": \"bold\",\n\"text-align\": \"center\",\n\"width\": \"80%\",\n\"padding\": \"0px\",\n\"line-height\": \"1.2\",\n\"margin\": \"50px 0 0 0\",\n\"padding\": \"0 10px 0 10px\",\n\"border-radius\": \"15px\"\n}\n},\n{\n\"id\": \"q41n9kxp\",\n\"type\": \"subtitles\",\n\"settings\": {\n\"style\": \"classic\",\n\"position\": \"bottom\",\n\"font-family\": \"Arial\",\n\"font-size\": \"100px\",\n\"word-color\": \"#ffd700\",\n\"shadow-color\": \"#260B1B\",\n\"line-color\": \"#F1E7F4\",\n\"shadow-offset\": 0,\n\"box-color\": \"#260B1B\",\n\"outline-color\": \"#000000\",\n\"outline-width\": 8\n},\n\"language\": \"en\"\n}\n]\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpCustomAuth"
        },
        "credentials": {
          "httpCustomAuth": {
            "id": "GELGbE2ThQ80HY5A",
            "name": "Custom Auth account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "cf55a393-1e63-46f7-b57c-07508141554f",
        "name": "Wait for Caption Rendering",
        "type": "n8n-nodes-base.wait",
        "position": [
          420,
          440
        ],
        "webhookId": "67093c5d-34fa-44e8-9dfd-e25ca5f99ac2",
        "parameters": {
          "unit": "minutes",
          "amount": 2
        },
        "typeVersion": 1.1
      },
      {
        "id": "4a939455-0c36-49cc-9279-36f2cd8ebcec",
        "name": "Fetch Final Video from JSON2Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          620,
          440
        ],
        "parameters": {
          "url": "=https://api.json2video.com/v2/movies?id={{ $json.project }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpCustomAuth"
        },
        "credentials": {
          "httpCustomAuth": {
            "id": "GELGbE2ThQ80HY5A",
            "name": "Custom Auth account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "e64423b9-6e5e-4ab8-b9c1-1bb791fcfa06",
        "name": "Update Final Video URL in Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          820,
          440
        ],
        "parameters": {
          "columns": {
            "value": {
              "ID de la vid√©o": "={{ $('Save Rewritten Video to Google Sheets').item.json['ID de la vid√©o'] }}",
              "URL de la vid√©o": "={{ $json.movie.url }}"
            },
            "schema": [
              {
                "id": "ID du mod√®le",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "ID du mod√®le",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ID de la vid√©o",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "ID de la vid√©o",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Sujet",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Sujet",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Texte superpos√©",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Texte superpos√©",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Script",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Script",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Caption",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL de la vid√©o",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "URL de la vid√©o",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Date de publication",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Date de publication",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Statut",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Statut",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "ID de la vid√©o"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 52679157,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SoYJvZbVNn4L1FNfk9eFqx_vGlCsMxgw8bx0DVFgBLY/edit#gid=52679157",
            "cachedResultName": "MA VIDEO"
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "d72dc835-b954-4dbd-a210-af7fc6ce058e",
        "name": "Send Video URL via Telegram",
        "type": "n8n-nodes-base.telegram",
        "position": [
          -600,
          920
        ],
        "webhookId": "37975672-4633-4c65-a8d8-4d101bff5f84",
        "parameters": {
          "text": "=Url VIDEO : {{ $json['URL de la vid√©o'] }}",
          "chatId": "={{ $('Trigger: Get TikTok URL via Telegram').item.json.message.chat.id }}",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "fO6eyZMLBk66Au44",
            "name": "Telegram account 5"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "33552176-18ab-44ec-9bb6-174e9f9c777d",
        "name": "Send Final Video Preview",
        "type": "n8n-nodes-base.telegram",
        "position": [
          -400,
          920
        ],
        "webhookId": "ee91d7ee-1c35-41fa-b8f0-f153b8776369",
        "parameters": {
          "file": "={{ $('Update Final Video URL in Sheet').item.json['URL de la vid√©o'] }}",
          "chatId": "={{ $json.result.chat.id }}",
          "operation": "sendVideo",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "fO6eyZMLBk66Au44",
            "name": "Telegram account 5"
          }
        },
        "typeVersion": 1.2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "2bb57143-bfe3-49fd-9492-7396d9611cc7",
    "connections": {
      "Download TikTok Audio": {
        "main": [
          [
            {
              "node": "Transcribe Audio to Script (GPT)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate New Video ID": {
        "main": [
          [
            {
              "node": "Save Rewritten Video to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Avatar Video URL": {
        "main": [
          [
            {
              "node": "Add Overlay Text with JSON2Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Assign Social Media IDs": {
        "main": [
          [
            {
              "node": "Upload Video to Blotato",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Video Thumbnail": {
        "main": [
          [
            {
              "node": "Upload Thumbnail to Cloudinary",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Available Avatars": {
        "main": [
          [
            {
              "node": "Generate Video with Avatar",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video to Blotato": {
        "main": [
          [
            {
              "node": "INSTAGRAM",
              "type": "main",
              "index": 0
            },
            {
              "node": "YOUTUBE",
              "type": "main",
              "index": 0
            },
            {
              "node": "TIKTOK",
              "type": "main",
              "index": 0
            },
            {
              "node": "FACEBOOK",
              "type": "main",
              "index": 0
            },
            {
              "node": "THREADS",
              "type": "main",
              "index": 0
            },
            {
              "node": "TWETTER",
              "type": "main",
              "index": 0
            },
            {
              "node": "LINKEDIN",
              "type": "main",
              "index": 0
            },
            {
              "node": "BLUESKY",
              "type": "main",
              "index": 0
            },
            {
              "node": "PINTEREST",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Final Video Preview": {
        "main": [
          [
            {
              "node": "Assign Social Media IDs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Clean Perplexity Response": {
        "main": [
          [
            {
              "node": "Rewrite Script, Caption, Overlay (GPT-4o)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Video with Avatar": {
        "main": [
          [
            {
              "node": "Wait for Avatar Rendering (3 min)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Caption Rendering": {
        "main": [
          [
            {
              "node": "Fetch Final Video from JSON2Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Unique Template ID": {
        "main": [
          [
            {
              "node": "Save Original Video to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Video URL via Telegram": {
        "main": [
          [
            {
              "node": "Send Final Video Preview",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Overlay Text (GPT-4o)": {
        "main": [
          [
            {
              "node": "Download TikTok Audio",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Thumbnail to Cloudinary": {
        "main": [
          [
            {
              "node": "Analyze Thumbnail (GPT-4o Vision)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Final Video URL in Sheet": {
        "main": [
          [
            {
              "node": "Send Video URL via Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add Overlay Text with JSON2Video": {
        "main": [
          [
            {
              "node": "Wait for Caption Rendering",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download TikTok Video (RapidAPI)": {
        "main": [
          [
            {
              "node": "Extract Video Thumbnail",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Transcribe Audio to Script (GPT)": {
        "main": [
          [
            {
              "node": "Generate Unique Template ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analyze Thumbnail (GPT-4o Vision)": {
        "main": [
          [
            {
              "node": "Extract Overlay Text (GPT-4o)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Final Video from JSON2Video": {
        "main": [
          [
            {
              "node": "Update Final Video URL in Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Suggest Similar Idea (Perplexity)": {
        "main": [
          [
            {
              "node": "Clean Perplexity Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Avatar Rendering (3 min)": {
        "main": [
          [
            {
              "node": "Fetch Avatar Video URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Original Video to Google Sheets": {
        "main": [
          [
            {
              "node": "Suggest Similar Idea (Perplexity)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger: Get TikTok URL via Telegram": {
        "main": [
          [
            {
              "node": "Download TikTok Video (RapidAPI)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Rewritten Video to Google Sheets": {
        "main": [
          [
            {
              "node": "Fetch Available Avatars",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Rewritten Content into Sections": {
        "main": [
          [
            {
              "node": "Generate New Video ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Rewrite Script, Caption, Overlay (GPT-4o)": {
        "main": [
          [
            {
              "node": "Split Rewritten Content into Sections",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "guzv1hyyxqP3NW8n",
    "meta": {
      "instanceId": "a1ae5c8dc6c65e674f9c3947d083abcc749ef2546dff9f4ff01de4d6a36ebfe6",
      "templateCredsSetupCompleted": true
    },
    "name": "Cold Outreach Automation: Scrape Local Leads with Dumpling AI & Call via Vapi",
    "tags": [],
    "nodes": [
      {
        "id": "ec17b443-6dbd-46c1-8331-797ce6290801",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -860,
          -900
        ],
        "parameters": {
          "width": 900,
          "height": 320,
          "content": "### üìç Get Local Business Data from Google Maps with Dumpling AI\n\nThe workflow begins manually and pulls a list of Google Maps search queries (like \"best plumbers in Chicago\") from Google Sheets. These queries are sent to Dumpling AI's `search-google-map` endpoint, which scrapes businesses matching the terms. The response is split into individual business entries. A Set node extracts the business name and phone number for each result.\n\n- `Start Workflow Manually`: Begin process\n- `Get Search Keywords from Google Sheets`: Pulls search terms (e.g., \"top dentists in NY\")\n- `Scrape Google Map Businesses`: Uses Dumpling AI to collect business info\n- `Split Each Business Result`: Breaks response into single business entries\n- `Extract Business Name and Phone`: Prepares business name and phone number for calling\n"
        },
        "typeVersion": 1
      },
      {
        "id": "5345e653-8442-4caa-bb7e-a597b3779db0",
        "name": "Start Workflow Manually",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -820,
          -580
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "072baaf9-81d8-4989-9354-822f02b2f922",
        "name": "Get Search Keywords from Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -600,
          -580
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1QXZk6D8hW29f9umrmsYv_HeZYRKWOjsxOaFZ2BZtu3Y/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1QXZk6D8hW29f9umrmsYv_HeZYRKWOjsxOaFZ2BZtu3Y/edit?usp=drivesdk",
            "cachedResultName": "leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "GaJqJHuS5mQxap7q",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "004427b8-e8d7-4f28-b03e-4b459f2a7b2b",
        "name": "Scrape Google Map Businesses using Dumpling AI",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -380,
          -580
        ],
        "parameters": {
          "url": "https://app.dumplingai.com/api/v1/search-maps",
          "method": "POST",
          "options": {
            "redirect": {
              "redirect": {}
            }
          },
          "jsonBody": "={\n  \"query\":\"{{ $json.URLs }}\", \n  \"language\": \"en\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {}
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "5CBvzXCLjwWzCJRE",
            "name": "n8n_integration"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "21eed6ed-ca94-48b1-a164-1a0841ec376b",
        "name": "Split Each Business Result",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -160,
          -580
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "places"
        },
        "typeVersion": 1
      },
      {
        "id": "5efb54a1-0b80-46aa-861d-2ef53f069a22",
        "name": "Extract Business Name, Phone and website",
        "type": "n8n-nodes-base.set",
        "position": [
          60,
          -580
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "79cc91c6-28bd-47a1-86db-b936e6958428",
                "name": "website",
                "type": "string",
                "value": "={{ $json.website }}"
              },
              {
                "id": "7a0455bb-b235-4e03-a93d-0e3b31b40df2",
                "name": "phoneNumber",
                "type": "string",
                "value": "={{ $json.phoneNumber }}"
              },
              {
                "id": "a493dd1f-b495-4c01-983a-4e417aca80fc",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "91ec444a-44be-471b-8f2d-e192f58b085d",
        "name": "Filter Valid Phone Numbers Only",
        "type": "n8n-nodes-base.filter",
        "position": [
          280,
          -580
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "dab1310e-6566-4e77-b1a6-362363b2e025",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.phoneNumber }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "77d150c3-0908-443e-afb9-c2e1a740e749",
        "name": "Format Phone Number for Calling",
        "type": "n8n-nodes-base.set",
        "position": [
          500,
          -580
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "045d4c64-61f3-4b39-9b5c-35b7e95783fd",
                "name": "formattedPhone",
                "type": "string",
                "value": "={{ '+1' + $json[\"phoneNumber\"].replace(/\\D/g, '') }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "1dbe296d-c422-4ae6-ba7e-6bd7dbe0a5e9",
        "name": "Initiate Vapi AI Call to Business",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueErrorOutput",
        "position": [
          720,
          -580
        ],
        "parameters": {
          "url": "https://api.vapi.ai/call",
          "method": "POST",
          "options": {
            "redirect": {
              "redirect": {}
            }
          },
          "jsonBody": "={\n  \"customers\": [\n    {\n      \"number\": \"{{ $json.formattedPhone}}\",\n      \"name\": \"\"\n    }\n  ],\n  \"assistantId\": \"\",\n  \"phoneNumberId\": \"\",\n  \"assistantOverrides\": {\n    \"variableValues\": {\n      \"Name\": \"{{ $('Filter Valid Phone Numbers Only').item.json.title }}\",\n    }\n  }\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "6X2b4RLVRbz8I4Z8",
            "name": "Vapi"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "fc705d86-98b2-4219-9b19-0350657b845b",
        "name": "Log Called Business Info to Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          940,
          -600
        ],
        "parameters": {
          "columns": {
            "value": {
              "website": "={{ $('Extract Business Name, Phone and website').item.json.website }}",
              "company name": "={{ $('Extract Business Name, Phone and website').item.json.title }}",
              "phone number ": "={{ $('Format Phone Number for Calling').item.json.formattedPhone }}"
            },
            "schema": [
              {
                "id": "company name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "company name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "phone number ",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "phone number ",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "website",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "website",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1315810611,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1QXZk6D8hW29f9umrmsYv_HeZYRKWOjsxOaFZ2BZtu3Y/edit#gid=1315810611",
            "cachedResultName": "leads"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1QXZk6D8hW29f9umrmsYv_HeZYRKWOjsxOaFZ2BZtu3Y",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1QXZk6D8hW29f9umrmsYv_HeZYRKWOjsxOaFZ2BZtu3Y/edit?usp=drivesdk",
            "cachedResultName": "leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "GaJqJHuS5mQxap7q",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "e30e0706-3732-4a2f-81f2-d50e63043632",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          160,
          -900
        ],
        "parameters": {
          "color": 3,
          "width": 900,
          "height": 320,
          "content": "### üìû Auto-Call Businesses and Track Results\n\nBusinesses without valid phone numbers are filtered out. A Set node formats the numbers for international dialing (e.g., adds +1 for US). The Vapi AI assistant then initiates a phone call to each business, using the business name in the script. After the call, the name, number, and call status are logged to a Google Sheet for follow-up or reporting.\n\n- `Filter Valid Phone Numbers Only`: Ensures phone number exists\n- `Format Phone Number for Calling`: Adds correct dial prefix\n- `Initiate Vapi AI Call to Business`: Triggers outbound AI call via Vapi\n- `Log Called Business Info to Sheet`: Records successful outreach for tracking\n\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "da88eae8-0530-4674-8afa-196c8da7f47f",
    "connections": {
      "Start Workflow Manually": {
        "main": [
          [
            {
              "node": "Get Search Keywords from Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Each Business Result": {
        "main": [
          [
            {
              "node": "Extract Business Name, Phone and website",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter Valid Phone Numbers Only": {
        "main": [
          [
            {
              "node": "Format Phone Number for Calling",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Phone Number for Calling": {
        "main": [
          [
            {
              "node": "Initiate Vapi AI Call to Business",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Initiate Vapi AI Call to Business": {
        "main": [
          [
            {
              "node": "Log Called Business Info to Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Search Keywords from Google Sheets": {
        "main": [
          [
            {
              "node": "Scrape Google Map Businesses using Dumpling AI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Business Name, Phone and website": {
        "main": [
          [
            {
              "node": "Filter Valid Phone Numbers Only",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Scrape Google Map Businesses using Dumpling AI": {
        "main": [
          [
            {
              "node": "Split Each Business Result",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "yYjRbTWULZuNLXM0",
    "meta": {
      "instanceId": "616c00803b706b71f395da00f933102e3b493591ba0a653e82d0b9ed360368da"
    },
    "name": "My workflow",
    "tags": [],
    "nodes": [
      {
        "id": "2125c56b-1c76-4219-847b-470f11865c01",
        "name": "n8n Form Trigger",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          180,
          300
        ],
        "webhookId": "5fb20488-aa11-4788-aa0f-73d40e7e4475",
        "parameters": {
          "path": "form",
          "options": {},
          "formTitle": "Form Title",
          "formFields": {
            "values": [
              {
                "fieldLabel": "Name",
                "requiredField": true
              },
              {
                "fieldLabel": "Email",
                "requiredField": true
              },
              {
                "fieldType": "textarea",
                "fieldLabel": "Let us know your queries"
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "94f6684f-925b-4ded-a79f-ff44771ee992",
        "name": "Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1220,
          280
        ],
        "parameters": {
          "columns": {
            "value": {
              "Name": "={{ $json.Name }}",
              "Email": "={{ $json.Email }}",
              "Query": "={{ $json['Let us know your queries'] }}",
              "Submitted On": "={{ $json.submittedAt }}"
            },
            "schema": [
              {
                "id": "Name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Query",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Query",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Submitted On",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Submitted On",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Name"
            ]
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zvlIZNAVFZ7lg9hch_zsNEIbmAhInUuwhiK2zWq0snA/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1zvlIZNAVFZ7lg9hch_zsNEIbmAhInUuwhiK2zWq0snA",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zvlIZNAVFZ7lg9hch_zsNEIbmAhInUuwhiK2zWq0snA/edit?usp=drivesdk",
            "cachedResultName": "Leads Data"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "7HR3jwkVoNgbw7fb",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "4a1d8a68-c976-4bf6-956a-6a29affdaed4",
        "name": "Gmail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1220,
          -40
        ],
        "parameters": {
          "sendTo": "yourmail@gmail.com",
          "message": "=Name:   {{ $json.Name }} \n\nEmail:  {{ $json.Email }} \n\nQuery:  {{ $json['Let us know your queries'] }} \n\nSubmitted on:  {{ $json.submittedAt }}",
          "options": {},
          "subject": "=New lead from {{ $json.Name }}",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "DrjEhQ0S42VeRofT",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "126d0ee3-de81-41ed-88f6-ffdeefae5576",
        "name": "Discord",
        "type": "n8n-nodes-base.discord",
        "position": [
          1240,
          620
        ],
        "parameters": {
          "embeds": {
            "values": [
              {
                "color": "#FF00F2",
                "title": "=New Lead from  {{ $json.Name }}",
                "author": "N8N Automation",
                "description": "=Name:   {{ $json.Name }} \n\nEmail:  {{ $json.Email }} \n\nQuery:  {{ $json['Let us know your queries'] }} \n\nSubmitted on:  {{ $json.submittedAt }}"
              }
            ]
          },
          "content": "=",
          "options": {},
          "authentication": "webhook"
        },
        "credentials": {
          "discordWebhookApi": {
            "id": "kuEJsXFqZfG48TDJ",
            "name": "Discord Webhook account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "4cd07d01-6d9a-4d0a-9999-9d66d99fb624",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1080,
          -100
        ],
        "parameters": {
          "width": 379.65154010753633,
          "height": 211.1881665582037,
          "content": "make sure to add To address so you can receive the notifications"
        },
        "typeVersion": 1
      },
      {
        "id": "4e8eebfa-df98-473c-8666-c7768f641694",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1070,
          520
        ],
        "parameters": {
          "width": 399.1832608339331,
          "height": 246.28862362668644,
          "content": "Sometimes the email might not reach your inbox, but it rarely happens but if you receive a lot of leads it's better to setup discord webhook and receive updates that way so that your inbox doesn't get filled with all the leads"
        },
        "typeVersion": 1
      },
      {
        "id": "caff8f87-4e07-4125-bfd7-62a912b4ada9",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1080,
          220
        ],
        "parameters": {
          "width": 377.5924476942702,
          "height": 211.1881665582037,
          "content": "Map the data to it's relevant fields/columns"
        },
        "typeVersion": 1
      },
      {
        "id": "c5e320e3-6489-4957-bb4e-e9873d001a66",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          640,
          300
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "d8c112a3-377c-4ca2-90d9-05c19f895ddb",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.Email }}",
                "rightValue": "="
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "778ba29f-ed75-4706-830f-d906d28d45e3",
        "name": "Hunter",
        "type": "n8n-nodes-base.hunter",
        "position": [
          420,
          300
        ],
        "parameters": {
          "email": "={{ $json.Email }}",
          "operation": "emailVerifier"
        },
        "typeVersion": 1
      },
      {
        "id": "0021001b-0784-4983-a419-8bb491004133",
        "name": "No Operation, do nothing",
        "type": "n8n-nodes-base.noOp",
        "position": [
          640,
          500
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "997da82a-618f-417a-be73-dd3cc0c70ee8",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          219.7136799847175
        ],
        "parameters": {
          "color": 4,
          "width": 456.2047033929433,
          "height": 435.9183833776615,
          "content": "Use this only if you receive high volume of leads and you want to avoid fake leads with fake emails"
        },
        "typeVersion": 1
      },
      {
        "id": "9b764ce3-66b5-44ff-8086-28812bc79db1",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          520,
          440
        ],
        "parameters": {
          "color": 3,
          "width": 314.12732687758046,
          "height": 209.4182179183868,
          "content": "Doesn't move forward if the email is not valid or if its fake email address"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "callerPolicy": "workflowsFromSameOwner",
      "executionOrder": "v1",
      "saveManualExecutions": true
    },
    "versionId": "6455a6bd-0749-4c00-805b-a04ea6e34cc7",
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "Gmail",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            },
            {
              "node": "Discord",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "No Operation, do nothing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail": {
        "main": [
          []
        ]
      },
      "Hunter": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Discord": {
        "main": [
          []
        ]
      },
      "n8n Form Trigger": {
        "main": [
          [
            {
              "node": "Hunter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "a88d54d0dc140647df8f628579b3d5aae0dedb13c983a1f5c11ee14f54f18774",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "c9437f3c-edbc-431c-be65-bc485d9fd6ad",
        "name": "Set ID",
        "type": "n8n-nodes-base.set",
        "position": [
          860,
          760
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e556566e-20a1-48b4-b01e-197a402b5a5f",
                "name": "id",
                "type": "string",
                "value": "={{ $json.id }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "fc3b2696-d0c1-40e4-a13b-5d274b0b8c69",
        "name": "Supabase Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          1600,
          760
        ],
        "parameters": {
          "mode": "insert",
          "options": {
            "queryName": "match_documents"
          },
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "documents",
            "cachedResultName": "documents"
          }
        },
        "credentials": {
          "supabaseApi": {
            "id": "0xwwr9KuQRNxpYYg",
            "name": "Marketing Ladder"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "71b61728-b87c-40f3-850b-81af6d544b75",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          1740,
          980
        ],
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "=file_id",
                  "value": "={{ $('Set ID').item.json.id }}"
                }
              ]
            }
          }
        },
        "typeVersion": 1
      },
      {
        "id": "36fdd0a5-b95c-4fc3-9427-e67de0f3985f",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          1840,
          1140
        ],
        "parameters": {
          "options": {},
          "chunkSize": 500,
          "chunkOverlap": 100
        },
        "typeVersion": 1
      },
      {
        "id": "66dd34df-763f-4497-bd73-b2dd78890eb4",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          1560,
          980
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "E9waf1c33TsN4RCh",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "3623a178-af67-4f07-b1d6-90ac07857f28",
        "name": "New File",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          560,
          760
        ],
        "parameters": {
          "event": "fileCreated",
          "options": {},
          "pollTimes": {
            "item": [
              {}
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "list",
            "value": "1UHQhCrwZg_ZEzBIKv4LR_RWtAyHbxZsg",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1UHQhCrwZg_ZEzBIKv4LR_RWtAyHbxZsg",
            "cachedResultName": "Marketing Ladder Knowledge Base"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "VtotuTJiDPvuSK66",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5a9c99b2-2876-4fd3-82e1-9212303151ae",
        "name": "Download File",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1100,
          760
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {
            "googleFileConversion": {
              "conversion": {
                "docsToFormat": "text/plain"
              }
            }
          },
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "VtotuTJiDPvuSK66",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "2493e003-7c9e-4a98-8148-114abd2899ad",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          500,
          560
        ],
        "parameters": {
          "color": 4,
          "width": 820,
          "height": 80,
          "content": "# Upload New File into Knowledge Base\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3d7f646d-0de0-44da-8cab-568cfa3ead02",
        "name": "Extract from File",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          1280,
          760
        ],
        "parameters": {
          "options": {},
          "operation": "text"
        },
        "typeVersion": 1
      },
      {
        "id": "8b949a8f-5dee-4c48-86fa-dc87cdd83198",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          800,
          680
        ],
        "parameters": {
          "color": 5,
          "height": 260,
          "content": "## Fix Formatting\n"
        },
        "typeVersion": 1
      },
      {
        "id": "2ce675ef-7791-4fe4-86d4-0eeabd827531",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1060,
          680
        ],
        "parameters": {
          "color": 5,
          "width": 420,
          "height": 260,
          "content": "## Extract File Text\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "1d23677f-e268-4f66-8170-a5c28b4049b5",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1500,
          680
        ],
        "parameters": {
          "color": 5,
          "width": 560,
          "height": 580,
          "content": "## Update Vector Database\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "f29a335e-e6a5-4a75-8158-0c83e69e25bb",
        "name": "File Updated",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          560,
          1500
        ],
        "parameters": {
          "event": "fileUpdated",
          "options": {},
          "pollTimes": {
            "item": [
              {}
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "list",
            "value": "1UHQhCrwZg_ZEzBIKv4LR_RWtAyHbxZsg",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1UHQhCrwZg_ZEzBIKv4LR_RWtAyHbxZsg",
            "cachedResultName": "Marketing Ladder Knowledge Base"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "VtotuTJiDPvuSK66",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ae95c1ce-bcf7-47fb-a3e3-2b6c6d02aa9e",
        "name": "Delete Row(s)",
        "type": "n8n-nodes-base.supabase",
        "position": [
          840,
          1500
        ],
        "parameters": {
          "tableId": "documents",
          "operation": "delete",
          "filterType": "string",
          "filterString": "=metadata->>file_id=like.*{{ $json.id }}*"
        },
        "credentials": {
          "supabaseApi": {
            "id": "0xwwr9KuQRNxpYYg",
            "name": "Marketing Ladder"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c6f252c0-e81c-48f5-9a7b-6507b467c54d",
        "name": "Get FIle ID",
        "type": "n8n-nodes-base.set",
        "position": [
          1120,
          1500
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b4433ac7-0b70-4405-a564-f3f78f784470",
                "name": "file_id",
                "type": "string",
                "value": "={{ $('File Updated').item.json.id }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "4d5bcbf0-fe14-4d24-81f5-72b84712c09d",
        "name": "Reformat",
        "type": "n8n-nodes-base.limit",
        "position": [
          1320,
          1500
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "f55697b5-191d-4865-9970-3462abeb05ef",
        "name": "Download File1",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1520,
          1500
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Get FIle ID').item.json.file_id }}"
          },
          "options": {
            "googleFileConversion": {
              "conversion": {
                "docsToFormat": "text/plain"
              }
            }
          },
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "VtotuTJiDPvuSK66",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "4fcc245c-e57c-461e-ba04-18122933eacb",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          480,
          1280
        ],
        "parameters": {
          "color": 4,
          "width": 640,
          "height": 80,
          "content": "# Update File in Knowledge Base \n"
        },
        "typeVersion": 1
      },
      {
        "id": "78e0be5d-aa5b-49b3-8b52-2fb2db7dd8be",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          480,
          1400
        ],
        "parameters": {
          "color": 5,
          "width": 280,
          "height": 260,
          "content": "## Get File to Update\n \n"
        },
        "typeVersion": 1
      },
      {
        "id": "35de9387-b80a-4274-aa57-622d85a60064",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1040,
          1400
        ],
        "parameters": {
          "color": 5,
          "width": 400,
          "height": 260,
          "content": "## Fix Formatting\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8ffe865f-09ef-426d-9f5c-e7273a13441d",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1460,
          1400
        ],
        "parameters": {
          "color": 5,
          "width": 420,
          "height": 260,
          "content": "## Extract File Text\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "35aecaa8-b327-493f-8526-fbd019bc078d",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1920,
          1400
        ],
        "parameters": {
          "color": 5,
          "width": 600,
          "height": 580,
          "content": "## Update Vector Database\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "05d5c49a-8eee-4b90-9ec7-2ac6f20cd259",
        "name": "Recursive Character Text Splitter1",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          2320,
          1840
        ],
        "parameters": {
          "options": {},
          "chunkSize": 300,
          "chunkOverlap": 50
        },
        "typeVersion": 1
      },
      {
        "id": "88c403af-3425-4be3-9cc9-c79196df5115",
        "name": "Extract from File1",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          1700,
          1500
        ],
        "parameters": {
          "options": {},
          "operation": "text"
        },
        "typeVersion": 1
      },
      {
        "id": "a4c44cc1-54c8-4d32-9d25-6b9b7bedb7a2",
        "name": "Embeddings OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          2040,
          1700
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "E9waf1c33TsN4RCh",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "1784fe6a-6b2e-4fc9-9e28-05284e5f9e15",
        "name": "Default Data Loader1",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          2220,
          1700
        ],
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "file_id",
                  "value": "={{ $('Reformat').item.json.file_id }}"
                }
              ]
            }
          }
        },
        "typeVersion": 1
      },
      {
        "id": "83950e53-fab5-4f58-af8d-11126c1bfb3f",
        "name": "Supabase Vector Store1",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          2060,
          1500
        ],
        "parameters": {
          "mode": "insert",
          "options": {
            "queryName": "match_documents"
          },
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "documents",
            "cachedResultName": "documents"
          }
        },
        "credentials": {
          "supabaseApi": {
            "id": "0xwwr9KuQRNxpYYg",
            "name": "Marketing Ladder"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "22c08877-6bb1-4cfa-acda-df2b5814afa0",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          500,
          680
        ],
        "parameters": {
          "color": 5,
          "width": 280,
          "height": 260,
          "content": "## Get New File \n"
        },
        "typeVersion": 1
      },
      {
        "id": "d16c74c1-ccdb-4bc2-b607-c846b56b07d1",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          760,
          1400
        ],
        "parameters": {
          "color": 5,
          "width": 280,
          "height": 260,
          "content": "## Delete Rows\n \n"
        },
        "typeVersion": 1
      },
      {
        "id": "7d163045-13c3-42d7-9c51-0045c3056a6e",
        "name": "Transcribe",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          -1060,
          840
        ],
        "parameters": {
          "options": {},
          "resource": "audio",
          "operation": "transcribe"
        },
        "credentials": {
          "openAiApi": {
            "id": "E9waf1c33TsN4RCh",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.6
      },
      {
        "id": "14ac063c-0f77-4e3d-a603-7cf95d3701c4",
        "name": "Text",
        "type": "n8n-nodes-base.set",
        "position": [
          -1160,
          1040
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "fe7ecc99-e1e8-4a5e-bdd6-6fce9757b234",
                "name": "text",
                "type": "string",
                "value": "={{ $json.message.text }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "dccda445-c531-4009-bb3e-19b927d31d01",
        "name": "Voice or Text",
        "type": "n8n-nodes-base.switch",
        "position": [
          -1460,
          980
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "voice",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "281588e5-cab1-47c7-b42a-f75b8e7b659e",
                      "operator": {
                        "type": "string",
                        "operation": "exists",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.message.voice.file_id }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Text",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "8c844924-b2ed-48b0-935c-c66a8fd0c778",
                      "operator": {
                        "type": "string",
                        "operation": "exists",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.message.text }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "4ab95976-d1d8-438f-8112-99395823166c",
        "name": "Response",
        "type": "n8n-nodes-base.telegram",
        "position": [
          -20,
          960
        ],
        "webhookId": "5dced4b9-5066-4036-a4d4-14fc07edd53c",
        "parameters": {
          "text": "={{ $json.output }}",
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "fe6BsXsaL9M04IQi",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e38d614d-09eb-4f42-9229-6b037ecdc264",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1520,
          800
        ],
        "parameters": {
          "color": 5,
          "width": 680,
          "height": 460,
          "content": "## Convert Message to Text\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "136f7bd7-aa99-4460-b24f-30d65c932cb3",
        "name": "RAG Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -640,
          960
        ],
        "parameters": {
          "text": "={{ $json.text }}",
          "options": {
            "systemMessage": "=# Overview\nYou are a RAG assistant. Your job is to search for queries from a vector database and pass on the search results.\n\n# Tools\n**MarketingLadder**  \n- This is the vector store that you must query to find answers. \n- Use the search findings from the vector store to create an answer to the input query.\n\n## Final Notes\n- If you can't find an answer from the database, then just say you couldn't find an answer. Never use your own knowledge. "
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "5e87da8f-4677-483e-b41c-a79ff11e2750",
        "name": "Telegram Trigger",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -1700,
          980
        ],
        "webhookId": "2e5e253b-982e-4fe3-8048-b64897e77535",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "fe6BsXsaL9M04IQi",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "2b8470fb-2b8d-4490-8a40-c3479cb0865e",
        "name": "Window Buffer Memory1",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          -580,
          1160
        ],
        "parameters": {
          "sessionKey": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "3e2e080a-62ab-4ab8-889d-d357d250d68d",
        "name": "Download File2",
        "type": "n8n-nodes-base.telegram",
        "position": [
          -1240,
          840
        ],
        "webhookId": "83bb7385-33f6-4105-8294-1a91c0ebbee5",
        "parameters": {
          "fileId": "={{ $json.message.voice.file_id }}",
          "resource": "file"
        },
        "credentials": {
          "telegramApi": {
            "id": "fe6BsXsaL9M04IQi",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "da9bebc8-452f-493f-aefc-81dcd789f355",
        "name": "Supabase Vector Store3",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          -620,
          1340
        ],
        "parameters": {
          "options": {
            "queryName": "match_documents"
          },
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "documents",
            "cachedResultName": "documents"
          }
        },
        "credentials": {
          "supabaseApi": {
            "id": "0xwwr9KuQRNxpYYg",
            "name": "Marketing Ladder"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "0360fb6a-ac93-4e83-abb3-b19a5e614a76",
        "name": "OpenAI Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -240,
          1340
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "E9waf1c33TsN4RCh",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "302c2316-d91e-4b57-80d1-8678bcdc718a",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1800,
          700
        ],
        "parameters": {
          "color": 4,
          "width": 280,
          "height": 80,
          "content": "# RAG Chatbot\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9d0d4d0d-ec09-4f0f-bb14-bd6d5ea56c5a",
        "name": "Embeddings OpenAI3",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          -660,
          1520
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "E9waf1c33TsN4RCh",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ea8349d1-8566-4f67-9e83-3a9b41f94d6b",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1820,
          920
        ],
        "parameters": {
          "color": 5,
          "width": 280,
          "height": 260,
          "content": "## Get New Message\n"
        },
        "typeVersion": 1
      },
      {
        "id": "d1a77833-3d99-4cc3-80a8-2d9b9c440175",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -820,
          800
        ],
        "parameters": {
          "color": 5,
          "width": 720,
          "height": 860,
          "content": "## RAG System\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "366a89d0-dd1d-4cd8-9de4-d7caa0433cab",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          900
        ],
        "parameters": {
          "color": 5,
          "width": 320,
          "height": 260,
          "content": "## Send Output as Message\n"
        },
        "typeVersion": 1
      },
      {
        "id": "11f88e16-7ef0-484f-b7d1-e74e0e639da3",
        "name": "OpenAI Chat Model3",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -760,
          1160
        ],
        "parameters": {
          "model": "gpt-4o",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "E9waf1c33TsN4RCh",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "5992f547-5327-4091-b4a8-37d6aec6b75e",
        "name": "MarketingLadder",
        "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
        "position": [
          -440,
          1160
        ],
        "parameters": {
          "name": "MarketingLadder",
          "description": "This vector store holds information about Marketing Ladder agency"
        },
        "typeVersion": 1
      },
      {
        "id": "10baf4fe-5497-4fcc-b624-155b56d17dbe",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2320,
          1900
        ],
        "parameters": {
          "color": 5,
          "width": 440,
          "height": 240,
          "content": "## Hey, I'm Abdul üëã\n### I build growth systems for consultants & agencies. If you want to work together or need help automating your business, check out my website: \n### **https://www.builtbyabdul.com/**\n### Or email me at **abdul@buildabdul.com**\n### Have a lovely day ;)`"
        },
        "typeVersion": 1
      },
      {
        "id": "98e8b14c-ea04-4e08-9c3f-3e1510197e03",
        "name": "Sticky Note17",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2660,
          420
        ],
        "parameters": {
          "width": 780,
          "height": 1420,
          "content": "# Company RAG Knowledge Base Agent\n## Overview\nTurn your docs into an AI-powered internal or public-facing assistant. This chatbot workflow uses RAG (Retrieval-Augmented Generation) with Supabase vector search to answer employee or customer questions based on your company documents‚Äîautomatically updated via Google Drive.\n\nWhether it‚Äôs deployed in Telegram or embedded on your website, this agent supports voice and text input, transcribes voice messages, pulls relevant context from your internal files, and responds with a helpful, AI-generated answer. Two additional workflows listen for file changes in a shared Google Drive folder, convert them into embeddings using OpenAI, and sync them with your Supabase vector DB‚Äîso your knowledge base is always up to date.\n\n### Who‚Äôs it for\n- Startups building an internal ops or HR assistant  \n- SaaS companies deploying help bots on their websites  \n- Customer support teams reducing repetitive questions  \n- Knowledge-driven teams needing internal AI assistants  \n\n### How it works\n- Triggered via Telegram bot (or easily swapped for website chatbot or ‚Äúon chat message‚Äù)  \n- If user sends a voice message, it‚Äôs transcribed to text using OpenAI Whisper  \n- Input is passed to a RAG agent that:\n  - Searches a Supabase vector store for relevant docs  \n  - Pulls context from matching chunks using OpenAI embeddings  \n  - Responds with an LLM-powered answer  \n- The response is sent back as a Telegram message  \n- Two separate workflows:\n  - **New File Workflow**: Listens for file uploads in Google Drive, extracts and splits text, then sends to Supabase with embeddings  \n  - **Update File Workflow**: Detects file edits, deletes old rows, and updates embeddings for the revised file  \n\n### Example use case\n> You upload your internal policy docs and client FAQs into a Google Drive folder.  \n>  \n> Employees or customers can now ask:  \n> - ‚ÄúWhat‚Äôs the refund policy for annual plans?‚Äù  \n> - ‚ÄúHow do I request a day off?‚Äù  \n> - ‚ÄúWhat tools are approved for use by the engineering team?‚Äù  \n>  \n> The chatbot instantly pulls up the right section and responds with a smart, confident answer.\n\n### How to set up\n1. Connect a Telegram bot or use n8n‚Äôs webchat / chatbot widget  \n2. Hook up OpenAI for transcription, embeddings, and completion  \n3. Set up a Supabase project and connect it as a vector store  \n4. Upload your internal docs to Google Drive  \n5. Deploy the ‚ÄúAdd File‚Äù and ‚ÄúUpdate File‚Äù automations to manage embedding sync  \n6. Customize the chatbot‚Äôs tone and personality with prompt tweaks  \n\n### Requirements\n- Telegram bot (or n8n Chat widget)  \n- Google Drive integration  \n- Supabase with pgvector or similar enabled  \n- OpenAI API key (Whisper, Embeddings, ChatGPT)  \n- Two folders: one for raw documents and one for tracking updates  \n\n### How to customize\n- Swap Supabase for Pinecone, Weaviate, or Qdrant  \n- Replace Telegram with web chat, Slack, Intercom, or Discord  \n- Add logic to handle fallback answers or escalate to human  \n- Embed the chat widget on your site for public customer use  \n- Add filters (e.g. department, date, author) to narrow down context\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Text": {
        "main": [
          [
            {
              "node": "RAG Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set ID": {
        "main": [
          [
            {
              "node": "Download File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "New File": {
        "main": [
          [
            {
              "node": "Set ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Reformat": {
        "main": [
          [
            {
              "node": "Download File1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RAG Agent": {
        "main": [
          [
            {
              "node": "Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Transcribe": {
        "main": [
          [
            {
              "node": "RAG Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get FIle ID": {
        "main": [
          [
            {
              "node": "Reformat",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "File Updated": {
        "main": [
          [
            {
              "node": "Delete Row(s)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Delete Row(s)": {
        "main": [
          [
            {
              "node": "Get FIle ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download File": {
        "main": [
          [
            {
              "node": "Extract from File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Voice or Text": {
        "main": [
          [
            {
              "node": "Download File2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Text",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download File1": {
        "main": [
          [
            {
              "node": "Extract from File1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download File2": {
        "main": [
          [
            {
              "node": "Transcribe",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "MarketingLadder": {
        "ai_tool": [
          [
            {
              "node": "RAG Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "Voice or Text",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Supabase Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File": {
        "main": [
          [
            {
              "node": "Supabase Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "Supabase Vector Store1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI3": {
        "ai_embedding": [
          [
            {
              "node": "Supabase Vector Store3",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File1": {
        "main": [
          [
            {
              "node": "Supabase Vector Store1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "MarketingLadder",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "RAG Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Supabase Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader1": {
        "ai_document": [
          [
            {
              "node": "Supabase Vector Store1",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Window Buffer Memory1": {
        "ai_memory": [
          [
            {
              "node": "RAG Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Supabase Vector Store3": {
        "ai_vectorStore": [
          [
            {
              "node": "MarketingLadder",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter1": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader1",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "wnDz3dZ455lkg5la",
    "meta": {
      "instanceId": "a88d54d0dc140647df8f628579b3d5aae0dedb13c983a1f5c11ee14f54f18774",
      "templateCredsSetupCompleted": true
    },
    "name": "Website Chatbot Agent",
    "tags": [
      {
        "id": "VjxhWkY5mLmByR16",
        "name": "Active",
        "createdAt": "2025-06-19T23:49:38.399Z",
        "updatedAt": "2025-06-19T23:49:55.312Z"
      }
    ],
    "nodes": [
      {
        "id": "564d5030-4338-433f-91aa-fb01b376f888",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          60,
          80
        ],
        "webhookId": "8f61c22c-0a61-4153-99e6-8f11c336c70d",
        "parameters": {
          "mode": "webhook",
          "public": true,
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "c720eaaf-0fb0-402d-a9c1-c503bd4a919d",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          200,
          460
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "E9waf1c33TsN4RCh",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "b8992569-06c1-4ebb-8fbe-e3f5ea91c00b",
        "name": "calendarAgent",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          1140,
          500
        ],
        "parameters": {
          "name": "calendarAgent",
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "LpmYLHWdvevdwt5e",
            "cachedResultName": "Calendar Agent"
          },
          "description": "Call this tool for any calendar action.",
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2
      },
      {
        "id": "e5f6d811-75ac-48ef-b891-a94732f01f01",
        "name": "RAGagent",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          940,
          580
        ],
        "parameters": {
          "name": "RAGagent",
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "IkEdDr98G9p54XDT",
            "cachedResultName": "RAG Agent"
          },
          "description": "=Call this tool to get answers for FAQs regarding Kamexa. \nThe input should always be the question you want answered along with the following sessionId - {{ $('When chat message received').item.json.sessionId }}",
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2
      },
      {
        "id": "5a3275cb-0953-4ea5-ae23-557edd26f9d4",
        "name": "ticketAgent",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          680,
          620
        ],
        "parameters": {
          "name": "ticketAgent",
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "tMyGGwgRHFuqYKg3",
            "cachedResultName": "Ticket Agent"
          },
          "description": "Call this tool to create a support ticket for a human agent to followup on via email. \n\nThe input should be the users name and email address and a snippet of the users request. ",
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2
      },
      {
        "id": "d2044a89-2823-4590-93b5-d4913b20c571",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          440,
          540
        ],
        "parameters": {
          "contextWindowLength": 10
        },
        "typeVersion": 1.3
      },
      {
        "id": "a80e06be-cbe1-42c0-a293-772859044956",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -700,
          -360
        ],
        "parameters": {
          "width": 660,
          "height": 1480,
          "content": "# Website Chatbot Agent with Modular Sub-Agent Architecture\n\n#### Overview \nThis workflow implements a modular **Website AI Chatbot Assistant** capable of handling multiple types of customer interactions autonomously. Instead of relying on a single large agent to handle all logic and tools, this system routes user queries to specialized sub-agents‚Äîeach dedicated to a specific function.\n\n By using a manager-style orchestration layer, this approach prevents overloading a single AI model with excessive context, leading to cleaner routing, faster execution, and easier scaling as your automation needs grow.\n\n\n#### How It Works\n\n**1. Chat Trigger**  \n- The flow is initiated when a chat message is received via the website widget.\n\n**2. Manager Agent (Ultimate Website AI Assistant)**  \n- The central LLM-based agent is responsible for parsing the message and deciding which specialized sub-agent to route it to.\n- It uses an OpenAI GPT model for natural language understanding and a lightweight memory system to preserve recent context.\n\n**3. Sub-Agent Routing**  \n- `calendarAgent`: Handles availability checks and books meetings on connected calendars.  \n- `RAGAgent`: Searches company documentation or FAQs to provide accurate responses from your internal knowledge base.  \n- `ticketAgent`: Forwards requests to human support by generating and sending support tickets to a designated email.\n\n---\n\n#### Setup Instructions\n\n1. **Embed the Chatbot**  \n   - Use a custom HTML widget or script to embed the chatbot interface on your website.  \n   - Connect the frontend to the webhook that triggers the `When chat message received` node.\n\n2. **Configure Your OpenAI Key**  \n   - Insert your API key in the `OpenAI Chat Model` node.  \n   - Adjust the model parameters for temperature, max tokens, etc., based on how formal or creative you want the bot to be.\n\n3. **Customize Sub-Agents**  \n   - `calendarAgent`: Connect to your Google or Outlook calendar.  \n   - `RAGAgent`: Link to a vector store or document database via API or native integration.  \n   - `ticketAgent`: Set the destination email and format for ticket generation (e.g. via SendGrid or SMTP).\n\n4. **Deploy in Production**  \n   - Host on n8n Cloud or your self-hosted instance.  \n   - Monitor usage through the Executions tab and refine prompts based on user behavior.\n\n---\n\n#### Benefits\n\n- Modular system with dedicated logic per function  \n- Reduces token bloat by offloading complexity to sub-agents  \n- Easy to scale by adding more tools (e.g. CRM, analytics)  \n- Fast and responsive user experience for customers on your site  \n- Cleaner code structure and easier debugging\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b74b0e7f-91c5-4b9f-97e3-1180c97a1c30",
        "name": "Ultimate Website Chatbot Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          560,
          80
        ],
        "parameters": {
          "options": {
            "systemMessage": "=You are Dan Bot, the helpful, friendly chatbot assistant for Marketing Ladder, a marketing agency. You don‚Äôt answer questions yourself, you send every request to the right tool. \n\nAvailable Tools\nRAGagent ‚Äì Use to answer FAQs and anything about Marketing Ladder.\ncalendarAgent ‚Äì Use to check availability and book consultations.\nticketAgent ‚Äì Use when the user wants a human, you don‚Äôt have enough info, or you can‚Äôt complete the request.\n\n\nCore Capabilities\n1. Answer FAQs\nIf a user asks a question, immediately query the RAGagent.\nNever guess, improvise, or answer on your own.\nNo tool call = no answer.\n\n2. Book Consultations\nIf a user wants to book a consultation, collect the following information:\nFull name, Company Name, Email address, their goal for the consultation, preferred day and time (remember: Chicago timezone, 30-min meetings)\n\nProcess:\n-Check their preferred slot with calendarAgent.\n-If unavailable, offer the closest alternate available times on the same day. \n-Once they pick a slot, confirm all details (name, email, goal, time).\n-After confirmation, use calendarAgent to book and send them confirmation.\nGolden Rule: Never double book. Always check availability first.\n\n3. Escalate to a Human Agent if any of these happen:\n\n-RAGagent can‚Äôt find an answer\n-User wants to talk to a human\n-You can‚Äôt complete their request\n\nThen:\nAsk if they‚Äôd like to be contacted by a human agent. If yes, collect:\nFirst name, Email address, Description of their issue or question\nThen, use ticketAgent to create a support ticket.\n\nRules of Engagement:\n-No improvisation. Tools only.\n-Always clarify if info is missing or unclear.\n-The current date is {{ $now.format('yyyy-MM-dd') }}. You are in the Chicago timezone. Always confirm this when talking about times.\n-Redirect trolls. If someone derails the convo away from Marketing Ladder, steer them back or offer to escalate to a human.\n-Have a friendly, conversational tone of voice, but stick to the point.\n-Default CTA: Always try to book them in for a consultation. That‚Äôs your north star.\n"
          }
        },
        "typeVersion": 1.7
      }
    ],
    "active": true,
    "pinData": {
      "When chat message received": [
        {
          "json": {
            "route": "general",
            "action": "sendMessage",
            "metadata": {
              "userId": ""
            },
            "chatInput": "What can you do",
            "sessionId": "89b58710-63b4-459d-8bd0-9c105de4817b"
          }
        }
      ]
    },
    "settings": {
      "timezone": "America/Chicago",
      "callerPolicy": "workflowsFromSameOwner",
      "executionOrder": "v1"
    },
    "versionId": "daed30db-61fa-48ab-aaf8-d507dc609fc5",
    "connections": {
      "RAGagent": {
        "ai_tool": [
          [
            {
              "node": "Ultimate Website Chatbot Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "ticketAgent": {
        "ai_tool": [
          [
            {
              "node": "Ultimate Website Chatbot Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Ultimate Website Chatbot Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "calendarAgent": {
        "ai_tool": [
          [
            {
              "node": "Ultimate Website Chatbot Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Ultimate Website Chatbot Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Ultimate Website Chatbot Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  }
]