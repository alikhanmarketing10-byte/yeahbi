[
  {
    "meta": {
      "instanceId": "393ca9e36a1f81b0f643c72792946a5fe5e49eb4864181ba4032e5a408278263"
    },
    "nodes": [
      {
        "id": "506c4b19-583b-45c2-8f95-88d9a0bd08de",
        "name": "Data refinement",
        "type": "n8n-nodes-base.set",
        "position": [
          400,
          208
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "691e681b-b79e-4372-8afd-bdbaf0881c11",
                "name": "Prenom",
                "type": "string",
                "value": "={{ $json.payload.data['Prénom'] }}"
              },
              {
                "id": "c425fd31-6f20-4bc7-939d-ff3bdf63314e",
                "name": "Nom",
                "type": "string",
                "value": "={{ $json.payload.data.Nom }}"
              },
              {
                "id": "65ee47ca-19e9-490a-b647-0cb383ca21a6",
                "name": "Entreprise",
                "type": "string",
                "value": "={{ $json.payload.data.Entreprise }}"
              },
              {
                "id": "f0b97b9e-f621-42a9-b53e-1a32b277b588",
                "name": "Mail professionnel",
                "type": "string",
                "value": "={{ $json.payload.data['Mail professionnel'] }}"
              },
              {
                "id": "e25cb1ae-0514-485a-b93c-18bdb6ec16ba",
                "name": "Téléphone",
                "type": "string",
                "value": "={{ $json.payload.data['Téléphone pro'] }}"
              },
              {
                "id": "729eb9b0-0a3a-4f38-8fcb-226a6574c9c9",
                "name": "URL du site internet",
                "type": "string",
                "value": "={{ $json.payload.data['URL du site internet'] }}"
              },
              {
                "id": "91c587be-2a62-4dcd-b16e-7c644e0bbcda",
                "name": "Message",
                "type": "string",
                "value": "={{ $json.payload.data.Message }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "3e5e7b00-6151-428d-bb14-8df2abb7e105",
        "name": "Form Trigger",
        "type": "n8n-nodes-base.webflowTrigger",
        "position": [
          176,
          208
        ],
        "webhookId": "53bcc9fa-3e52-451e-800d-8c747b173ff9",
        "parameters": {
          "site": "6825df5b20329ba581df4914"
        },
        "credentials": {
          "webflowOAuth2Api": {
            "id": "CbSzY9RPrUDbhOdg",
            "name": "Growth AI"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "dc173e74-da2e-48c9-8b7c-10b3c546765d",
        "name": "Search an organization",
        "type": "n8n-nodes-base.pipedrive",
        "position": [
          896,
          208
        ],
        "parameters": {
          "term": "={{ $('Data refinement').item.json.Entreprise }}",
          "limit": 10,
          "resource": "organization",
          "operation": "search",
          "additionalFields": {
            "exactMatch": true
          }
        },
        "credentials": {
          "pipedriveApi": {
            "id": "i6m1kGabR1OKHcuL",
            "name": "Pipedrive"
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "62b6bf1e-e1eb-4f0a-9e2f-787fe35e68df",
        "name": "If Organization exists",
        "type": "n8n-nodes-base.if",
        "position": [
          1136,
          208
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "a2b14d78-0253-480a-bb37-c64dee0f50dd",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.name }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "415befbb-f2e9-4d7c-b70d-176608e4d2b7",
        "name": "Indicatif site",
        "type": "n8n-nodes-base.code",
        "position": [
          592,
          208
        ],
        "parameters": {
          "jsCode": "// Nœud Code n8n pour formater les numéros de téléphone avec indicatifs\n// Copiez ce code dans un nœud \"Code\" de n8n\n\n// Configuration des indicatifs par pays/région\nconst countryPrefixes = {\n  // France\n  'FR': {\n    prefix: '+33',\n    patterns: [\n      /^0[1-9]/,           // 01, 02, 03, 04, 05, 06, 07, 08, 09\n      /^[1-9]/             // Sans le 0 initial\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+33${cleaned}`;\n    }\n  },\n  \n  // Pays frontaliers de la France\n  // Belgique\n  'BE': {\n    prefix: '+32',\n    patterns: [\n      /^0[2-9]/,           // 02, 03, 04, etc.\n      /^[2-9]/             // Sans le 0 initial\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+32${cleaned}`;\n    }\n  },\n  \n  // Suisse\n  'CH': {\n    prefix: '+41',\n    patterns: [\n      /^0[1-9]/,           // 01, 02, etc.\n      /^[1-9]/             // Sans le 0 initial\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+41${cleaned}`;\n    }\n  },\n  \n  // Luxembourg\n  'LU': {\n    prefix: '+352',\n    patterns: [\n      /^[2-9]/,            // Commencent par 2-9 (pas de 0 initial)\n      /^6[0-9]/            // Mobiles commencent par 6\n    ],\n    format: (number) => {\n      return `+352${number}`;\n    }\n  },\n  \n  // Allemagne\n  'DE': {\n    prefix: '+49',\n    patterns: [\n      /^0[1-9]/,           // 01, 02, etc.\n      /^[1-9]/             // Sans le 0 initial\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+49${cleaned}`;\n    }\n  },\n  \n  // Espagne\n  'ES': {\n    prefix: '+34',\n    patterns: [\n      /^[67]/,             // Mobiles commencent par 6 ou 7\n      /^[89]/              // Fixes commencent par 8 ou 9\n    ],\n    format: (number) => {\n      return `+34${number}`;\n    }\n  },\n  \n  // Italie\n  'IT': {\n    prefix: '+39',\n    patterns: [\n      /^0[1-9]/,           // Fixes commencent par 0\n      /^3[0-9]/            // Mobiles commencent par 3\n    ],\n    format: (number) => {\n      return `+39${number}`;\n    }\n  },\n  \n  // Portugal\n  'PT': {\n    prefix: '+351',\n    patterns: [\n      /^2[1-9]/,           // Fixes région Lisbonne (21, 22, etc.)\n      /^9[1-6]/,           // Mobiles (91, 92, 93, 96)\n      /^[89][0-9]/         // Autres fixes\n    ],\n    format: (number) => {\n      return `+351${number}`;\n    }\n  },\n  \n  // Pays francophones d'Afrique du Nord\n  // Maroc\n  'MA': {\n    prefix: '+212',\n    patterns: [\n      /^0[5-7]/,           // 05, 06, 07\n      /^[5-7]/             // Sans le 0 initial\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+212${cleaned}`;\n    }\n  },\n  \n  // Algérie\n  'DZ': {\n    prefix: '+213',\n    patterns: [\n      /^0[1-9]/,           // 01, 02, etc.\n      /^[5-7]/             // Mobiles 5, 6, 7\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+213${cleaned}`;\n    }\n  },\n  \n  // Tunisie\n  'TN': {\n    prefix: '+216',\n    patterns: [\n      /^[2-5]/,            // Fixes régionaux (20, 21, 22, etc.)\n      /^[9]/               // Mobiles commencent par 9\n    ],\n    format: (number) => {\n      return `+216${number}`;\n    }\n  },\n  \n  // Autres pays (conservés)\n  // Canada\n  'CA': {\n    prefix: '+1',\n    patterns: [\n      /^1[0-9]{10}$/,      // 1 + 10 chiffres\n      /^[0-9]{10}$/        // 10 chiffres sans le 1\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^1/, '');\n      return `+1${cleaned}`;\n    }\n  },\n  \n  // États-Unis\n  'US': {\n    prefix: '+1',\n    patterns: [\n      /^1[0-9]{10}$/,      // 1 + 10 chiffres\n      /^[0-9]{10}$/        // 10 chiffres sans le 1\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^1/, '');\n      return `+1${cleaned}`;\n    }\n  },\n  \n  // Royaume-Uni\n  'GB': {\n    prefix: '+44',\n    patterns: [\n      /^0[1-9]/,           // 01, 02, etc.\n      /^[1-9]/             // Sans le 0 initial\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+44${cleaned}`;\n    }\n  },\n\n  // Pays asiatiques et du Moyen-Orient\n  // Qatar\n  'QA': {\n    prefix: '+974',\n    patterns: [\n      /^[3567]/,           // Mobiles commencent par 3, 5, 6, 7\n      /^4[0-9]/            // Fixes commencent par 4\n    ],\n    format: (number) => {\n      return `+974${number}`;\n    }\n  },\n\n  // Maldives\n  'MV': {\n    prefix: '+960',\n    patterns: [\n      /^[79]/,             // Mobiles commencent par 7 ou 9\n      /^3[0-9]/            // Fixes commencent par 3\n    ],\n    format: (number) => {\n      return `+960${number}`;\n    }\n  },\n\n  // Pakistan\n  'PK': {\n    prefix: '+92',\n    patterns: [\n      /^0[1-9]/,           // Fixes avec 0 initial\n      /^3[0-9]/            // Mobiles commencent par 3\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+92${cleaned}`;\n    }\n  },\n\n  // Inde\n  'IN': {\n    prefix: '+91',\n    patterns: [\n      /^0[1-9]/,           // Fixes avec 0 initial\n      /^[6-9]/             // Mobiles commencent par 6, 7, 8, 9\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+91${cleaned}`;\n    }\n  },\n\n  // Hong Kong\n  'HK': {\n    prefix: '+852',\n    patterns: [\n      /^[2-3]/,            // Fixes commencent par 2 ou 3\n      /^[5-9]/             // Mobiles commencent par 5, 6, 9\n    ],\n    format: (number) => {\n      return `+852${number}`;\n    }\n  },\n\n  // Corée du Sud\n  'KR': {\n    prefix: '+82',\n    patterns: [\n      /^0[1-9]/,           // Fixes avec 0 initial\n      /^1[0-9]/            // Mobiles commencent par 1\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+82${cleaned}`;\n    }\n  },\n\n  // Japon\n  'JP': {\n    prefix: '+81',\n    patterns: [\n      /^0[1-9]/,           // Fixes avec 0 initial\n      /^[789][0-9]/        // Mobiles commencent par 7, 8, 9\n    ],\n    format: (number) => {\n      let cleaned = number.replace(/^0/, '');\n      return `+81${cleaned}`;\n    }\n  }\n};\n\n/**\n * Nettoie un numéro de téléphone en supprimant tous les caractères non numériques\n * @param {string} phoneNumber - Numéro de téléphone brut\n * @returns {string} - Numéro nettoyé\n */\nfunction cleanPhoneNumber(phoneNumber) {\n  if (!phoneNumber || typeof phoneNumber !== 'string') {\n    return '';\n  }\n  \n  // Supprimer tous les caractères non numériques sauf le + au début\n  let cleaned = phoneNumber.trim();\n  \n  // Si le numéro commence déjà par +, on le garde tel quel\n  if (cleaned.startsWith('+')) {\n    return cleaned.replace(/[^\\d+]/g, '');\n  }\n  \n  // Sinon, supprimer tous les caractères non numériques\n  return cleaned.replace(/[^\\d]/g, '');\n}\n\n/**\n * Détecte le pays et formate le numéro de téléphone\n * @param {string} phoneNumber - Numéro de téléphone nettoyé\n * @returns {Object} - Objet avec le numéro formaté et les informations du pays\n */\nfunction detectAndFormatPhoneNumber(phoneNumber) {\n  // Si le numéro commence déjà par +, on considère qu'il est déjà formaté\n  if (phoneNumber.startsWith('+')) {\n    return {\n      formatted: phoneNumber,\n      detected_country: 'Already formatted',\n      confidence: 'high'\n    };\n  }\n  \n  // Parcourir chaque pays pour trouver une correspondance\n  for (const [countryCode, config] of Object.entries(countryPrefixes)) {\n    for (const pattern of config.patterns) {\n      if (pattern.test(phoneNumber)) {\n        return {\n          formatted: config.format(phoneNumber),\n          detected_country: countryCode,\n          confidence: 'high',\n          original: phoneNumber\n        };\n      }\n    }\n  }\n  \n  // Si aucun pattern ne correspond, essayer de deviner par la longueur\n  const length = phoneNumber.length;\n  \n  // Longueurs typiques par défaut (France comme fallback pour l'Europe)\n  if (length === 10 && phoneNumber.startsWith('0')) {\n    return {\n      formatted: countryPrefixes.FR.format(phoneNumber),\n      detected_country: 'FR',\n      confidence: 'medium',\n      original: phoneNumber,\n      reason: 'Fallback: 10 digits starting with 0 (assumed French)'\n    };\n  }\n  \n  if (length === 9 && !phoneNumber.startsWith('0')) {\n    return {\n      formatted: `+33${phoneNumber}`,\n      detected_country: 'FR',\n      confidence: 'low',\n      original: phoneNumber,\n      reason: 'Fallback: 9 digits without 0 (assumed French mobile)'\n    };\n  }\n  \n  // Si on ne peut pas détecter, retourner le numéro original avec un avertissement\n  return {\n    formatted: phoneNumber,\n    detected_country: 'Unknown',\n    confidence: 'none',\n    original: phoneNumber,\n    warning: 'Could not detect country, returned original number'\n  };\n}\n\n// Code principal du nœud n8n\nconst items = $input.all();\nconst processedItems = [];\n\nfor (const item of items) {\n  try {\n    // Récupérer le numéro de téléphone depuis l'objet spécifié\n    const rawPhoneNumber = $input.first().json['Téléphone'];\n    \n    if (!rawPhoneNumber) {\n      processedItems.push({\n        ...item,\n        json: {\n          ...item.json,\n          phone_formatted: '+330000000000'\n        }\n      });\n      continue;\n    }\n    \n    // Nettoyer et formater le numéro\n    const cleanedNumber = cleanPhoneNumber(rawPhoneNumber);\n    \n    if (!cleanedNumber) {\n      processedItems.push({\n        ...item,\n        json: {\n          ...item.json,\n          phone_formatted: '+330000000000'\n        }\n      });\n      continue;\n    }\n    \n    // Détecter et formater\n    const result = detectAndFormatPhoneNumber(cleanedNumber);\n    \n    // Ajouter seulement le numéro formaté à l'item\n    processedItems.push({\n      ...item,\n      json: {\n        ...item.json,\n        // Numéro formaté avec indicatif\n        phone_formatted: result.formatted\n      }\n    });\n    \n  } catch (error) {\n    // En cas d'erreur, retourner le numéro par défaut\n    processedItems.push({\n      ...item,\n      json: {\n        ...item.json,\n        phone_formatted: '+330000000000'\n      }\n    });\n  }\n}\n\nreturn processedItems;\n\n// Exemple de ce que vous obtiendrez en sortie :\n/*\n{\n  \"phone_formatted\": \"+33612345678\"\n}\n\n// En cas d'erreur ou numéro non trouvé :\n{\n  \"phone_formatted\": \"+330000000000\"\n}\n*/"
        },
        "typeVersion": 2
      },
      {
        "id": "813177b9-1470-460f-abde-ec4e6ddd0e72",
        "name": "Create Organization",
        "type": "n8n-nodes-base.pipedrive",
        "position": [
          1360,
          256
        ],
        "parameters": {
          "name": "={{ $('Data refinement').item.json.Entreprise }}",
          "resource": "organization",
          "additionalFields": {}
        },
        "credentials": {
          "pipedriveApi": {
            "id": "i6m1kGabR1OKHcuL",
            "name": "Pipedrive"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "98bd9f52-90c3-4ae5-995f-9f94d04b1a70",
        "name": "Search Person",
        "type": "n8n-nodes-base.pipedrive",
        "position": [
          1872,
          192
        ],
        "parameters": {
          "term": "={{ $('Data refinement').item.json.Prenom }} {{ $('Data refinement').item.json.Nom }}",
          "limit": 10,
          "resource": "person",
          "operation": "search",
          "additionalFields": {
            "exactMatch": true
          }
        },
        "credentials": {
          "pipedriveApi": {
            "id": "i6m1kGabR1OKHcuL",
            "name": "Pipedrive"
          }
        },
        "executeOnce": false,
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "27b6e952-9f30-481d-a55f-03729407a83a",
        "name": "If Person exists",
        "type": "n8n-nodes-base.if",
        "position": [
          2080,
          192
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "a2b14d78-0253-480a-bb37-c64dee0f50dd",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.name }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "83add9d3-7f88-41f4-8478-e91d1a3a7796",
        "name": "Update a person",
        "type": "n8n-nodes-base.pipedrive",
        "position": [
          2400,
          128
        ],
        "parameters": {
          "personId": "={{ $json.id }}",
          "resource": "person",
          "operation": "update",
          "updateFields": {
            "email": [
              "={{ $('Data refinement').item.json['Mail professionnel'] }}"
            ],
            "phone": [
              "={{ $('Indicatif site').item.json.phone_formatted }}"
            ]
          }
        },
        "credentials": {
          "pipedriveApi": {
            "id": "i6m1kGabR1OKHcuL",
            "name": "Pipedrive"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "28a022b1-4351-43de-9bc4-c78874462d3c",
        "name": "Create a person",
        "type": "n8n-nodes-base.pipedrive",
        "position": [
          2400,
          256
        ],
        "parameters": {
          "name": "={{ $('Data refinement').item.json.Prenom }} {{ $('Data refinement').item.json.Nom }}",
          "resource": "person",
          "additionalFields": {
            "email": [
              "={{ $('Data refinement').item.json['Mail professionnel'] }}"
            ],
            "phone": [],
            "org_id": "={{ $('Aggregate Organisation').item.json.data[0].id }}",
            "owner_id": 25649125,
            "customProperties": {
              "property": [
                {
                  "name": "c17f379e66fb0fa2c7e6ddfd986f7aa581086dd4",
                  "value": "Growth Ai"
                }
              ]
            }
          }
        },
        "credentials": {
          "pipedriveApi": {
            "id": "i6m1kGabR1OKHcuL",
            "name": "Pipedrive"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "7f111320-0447-4f6e-b657-74fa63481c9d",
        "name": "Aggregate Organisation",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          1568,
          192
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData"
        },
        "typeVersion": 1
      },
      {
        "id": "e29700af-5beb-4b0d-99dc-303f10be4ad2",
        "name": "Aggregate Person",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          2752,
          192
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData"
        },
        "typeVersion": 1
      },
      {
        "id": "8bde17ce-7152-4b6f-afe1-bb6cb1dece6e",
        "name": "Create a lead",
        "type": "n8n-nodes-base.pipedrive",
        "position": [
          3200,
          192
        ],
        "parameters": {
          "title": "=Website - {{ $('Data refinement').item.json.Entreprise }} {{ $json.data[0].name }} ",
          "resource": "lead",
          "person_id": "={{ $json.data[0].id }}",
          "associateWith": "person",
          "additionalFields": {
            "organization_id": "={{ $('Aggregate Organisation').item.json.data[0].id }}"
          }
        },
        "credentials": {
          "pipedriveApi": {
            "id": "i6m1kGabR1OKHcuL",
            "name": "Pipedrive"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "a5ad1abe-6af9-4437-8edf-8723438857ec",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          80,
          80
        ],
        "parameters": {
          "color": 5,
          "width": 656,
          "height": 320,
          "content": "# Phase 1: Form Data Collection and Processing"
        },
        "typeVersion": 1
      },
      {
        "id": "0fc73804-a953-4ff6-8302-d6150dac5f5b",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1792,
          80
        ],
        "parameters": {
          "color": 3,
          "width": 1088,
          "height": 320,
          "content": "# Phase 3: Contact Person Management"
        },
        "typeVersion": 1
      },
      {
        "id": "43939a20-55db-4d94-804c-555134f96f86",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2976,
          80
        ],
        "parameters": {
          "color": 4,
          "width": 576,
          "height": 304,
          "content": "# Phase 4: Lead Generation and Assignment"
        },
        "typeVersion": 1
      },
      {
        "id": "46c36a31-f9f0-46a6-ab7f-485933f64b4f",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          80,
          432
        ],
        "parameters": {
          "color": 5,
          "width": 656,
          "height": 496,
          "content": "### What you do:\n\nSubmit a contact form on the website with your business information including first name, last name, company, professional email, phone number, website URL, and message.\n\n### What the system does:\n\nCaptures form submission automatically via Webflow trigger when you submit the contact form\nExtracts and structures all form fields (first name, last name, company, professional email, phone, website URL, message) into clean data variables\nFormats phone numbers intelligently by detecting country codes and adding appropriate international prefixes (+33 for France, +32 for Belgium, etc.) using advanced pattern recognition\nHandles multiple country formats including France, neighboring European countries, North African francophone countries, and major international markets\n\n### Result:\n\n✅ Contact form data automatically captured and structured\n✅ Phone numbers standardized with proper international formatting\n✅ Data prepared for CRM integration without manual intervention\n✅ Multi-country phone number support ensures global compatibility"
        },
        "typeVersion": 1
      },
      {
        "id": "ce9eed3e-4a5b-4df1-af7f-a5a27dd9ee68",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          848,
          80
        ],
        "parameters": {
          "width": 848,
          "height": 320,
          "content": "# Phase 2: Organization Management"
        },
        "typeVersion": 1
      },
      {
        "id": "3f1833cf-76c3-4510-b1e0-6bfa1519fa3a",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          848,
          448
        ],
        "parameters": {
          "width": 848,
          "height": 304,
          "content": "### What the system does:\n\nSearches Pipedrive CRM for existing organizations using the company name from your form submission\nChecks if organization exists by performing an exact match search in the database\nCreates new organization in Pipedrive if no match is found, or retrieves existing organization if already present\nAggregates organization data to ensure consistent information flow to the next phase\n\n### Result:\n\n✅ Eliminates duplicate organizations in your CRM\n✅ Automatically maintains clean company database\n✅ Ensures every contact is properly linked to their organization\n✅ Reduces manual data entry and cleanup work\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9f9cf2e8-942e-48eb-9912-d58fda5841ca",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1792,
          448
        ],
        "parameters": {
          "color": 3,
          "width": 1088,
          "height": 320,
          "content": "### What the system does:\n\nSearches for existing person in Pipedrive using the full name (first name + last name) from the form\nDetermines if contact exists by performing exact match verification\nUpdates existing contact with new email and formatted phone number if person is found\nCreates new contact with complete information (name, email, phone, company association, owner assignment) if person doesn't exist\nAggregates person data to prepare for lead creation process\n\n### Result:\n\n✅ Maintains up-to-date contact information automatically\n✅ Prevents duplicate contacts in your CRM system\n✅ Ensures all contacts are properly linked to their organizations\n✅ Assigns contacts to the appropriate sales team member\n"
        },
        "typeVersion": 1
      },
      {
        "id": "a3dfc1ab-fad6-4278-be22-a111dee1465d",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2976,
          448
        ],
        "parameters": {
          "color": 4,
          "width": 576,
          "height": 336,
          "content": "### What the system does:\n\nCreates a qualified lead in Pipedrive with a simplified title format \"Website - [Company Name] [Contact Name]\"\nAssociates lead with the contact person and their organization automatically\nLinks organizational data to provide complete lead context without additional labeling or ownership assignment\n\n### Result:\n\n✅ Qualified leads automatically generated from website forms\n✅ Clean lead titles with clear website source identification\n✅ Complete lead context with contact and company information\n✅ Streamlined lead creation without complex tagging or assignment rules\n✅ Ready for manual review and assignment by sales teamRéessayer"
        },
        "typeVersion": 1
      },
      {
        "id": "3af66fdd-620e-4bd6-91fd-0805038f668d",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1328,
          -448
        ],
        "parameters": {
          "width": 816,
          "height": 336,
          "content": "## Need more advanced automation solutions? Contact us for custom enterprise workflows!\n\n# Growth-AI.fr\n\n## https://www.linkedin.com/in/allanvaccarizi/\n## https://www.linkedin.com/in/hugo-marinier-%F0%9F%A7%B2-6537b633/"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {
      "Form Trigger": [
        {
          "payload": {
            "id": "68cac21e6d94e82e588fd174",
            "data": {
              "Nom": "DONAYAN",
              "Message": "Bonjour,\nNous cherchons à minimiser le temps de développement d'interfaces entre un logiciel financier développé maison en .net, c#, angular base de données Oracle et l'ERP comptable XRP Ultimate de CEGID en bases de données Oracle également.\nPouvons nous être accompagnés pour gagner du temps ?\nMerci\nCordialement\nSerge DONAYAN\nDSI de l'OPAC de l'Oise",
              "Prénom": "Serge",
              "Entreprise": "OPAC de l'Oise",
              "Téléphone pro": "0612338479",
              "Mail professionnel": "sdonayan@opacoise.fr",
              "URL du site internet": "www.opacoise.fr"
            },
            "name": "Formulaire de contact",
            "formId": "688b54011dc104dda0fd6c2e",
            "pageId": "6825df5c20329ba581df4a27",
            "schema": [],
            "siteId": "6825df5b20329ba581df4914",
            "submittedAt": "2025-09-17T14:13:49.255Z",
            "formElementId": "2ae14dd8-eaf6-16be-e556-3949bccd583a",
            "publishedPath": "/"
          },
          "triggerType": "form_submission"
        }
      ]
    },
    "connections": {
      "Form Trigger": {
        "main": [
          [
            {
              "node": "Data refinement",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create a lead": {
        "main": [
          []
        ]
      },
      "Search Person": {
        "main": [
          [
            {
              "node": "If Person exists",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Indicatif site": {
        "main": [
          [
            {
              "node": "Search an organization",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create a person": {
        "main": [
          [
            {
              "node": "Aggregate Person",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Data refinement": {
        "main": [
          [
            {
              "node": "Indicatif site",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update a person": {
        "main": [
          [
            {
              "node": "Aggregate Person",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate Person": {
        "main": [
          [
            {
              "node": "Create a lead",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If Person exists": {
        "main": [
          [
            {
              "node": "Update a person",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Create a person",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Organization": {
        "main": [
          [
            {
              "node": "Aggregate Organisation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate Organisation": {
        "main": [
          [
            {
              "node": "Search Person",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If Organization exists": {
        "main": [
          [
            {
              "node": "Aggregate Organisation",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Create Organization",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search an organization": {
        "main": [
          [
            {
              "node": "If Organization exists",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "ad5b12df-3bdf-4672-99a7-0034664f29ef",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1180,
          120
        ],
        "parameters": {
          "color": 4,
          "width": 420.4803040774015,
          "height": 189.69151356225348,
          "content": "## Reply draft with OpenAI Assistant\nThis workflow automatically transfers content of incoming email messages with specific labels into OpenAI Assitant and returns reply draft. After draft is composed, trigger label is deleted from the thread.\n\n**Please remember to configure your OpenAI Assistant first.**"
        },
        "typeVersion": 1
      },
      {
        "id": "80a93a48-0576-4dfb-817a-34cbc215307a",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -740,
          120
        ],
        "parameters": {
          "width": 451.41125086385614,
          "height": 313.3056033573073,
          "content": "### Schedule trigger and get emails\nRun the workflow in equal intervals and check for threads with specific labels (trigger labels)."
        },
        "typeVersion": 1
      },
      {
        "id": "0dba2603-8012-47d1-8c60-4068924b74cd",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1180,
          340
        ],
        "parameters": {
          "color": 3,
          "width": 421.0932411886662,
          "height": 257.42916378714597,
          "content": "## ⚠️ Note\n\n1. Complete video guide for this workflow is available [on my YouTube](https://youtu.be/a8Dhj3Zh9vQ). \n2. Remember to add your credentials and configure nodes (covered in the video guide).\n3. If you like this workflow, please subscribe to [my YouTube channel](https://www.youtube.com/@workfloows) and/or [my newsletter](https://workfloows.com/).\n\n**Thank you for your support!**"
        },
        "typeVersion": 1
      },
      {
        "id": "4eb67d90-b834-48f6-8d8a-ed0a9d8321fd",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          520,
          120
        ],
        "parameters": {
          "width": 381.6458068293894,
          "height": 313.7892229150129,
          "content": "### Generate reply\nTransfer email content to OpenAI Assitant and return AI-generated reply.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "fdb6e16b-5f42-4872-bf63-b18a14220cdf",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1160,
          120
        ],
        "parameters": {
          "width": 219.88389496558554,
          "height": 314.75072291501283,
          "content": "### Create HTML message\nConvert incoming Markdown from OpenAI Assistant into HTML content."
        },
        "typeVersion": 1
      },
      {
        "id": "111e4276-7f63-4b11-92be-fd9de7e23f05",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1400,
          120
        ],
        "parameters": {
          "width": 461.3148409669012,
          "height": 314.75072291501283,
          "content": "### Build and encode message\nCreate raw message in RFC standard and encode it into base64 string (please see [Gmail API reference](https://developers.google.com/gmail/api/reference/rest/v1/users.drafts/create) for more details)."
        },
        "typeVersion": 1
      },
      {
        "id": "0d377266-7fa2-43c4-9259-e8611d52df41",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1880,
          120
        ],
        "parameters": {
          "width": 219.88389496558554,
          "height": 314.75072291501283,
          "content": "### Insert reply draft\nAdd reply draft from OpenAI Assistant to specific Gmail thread."
        },
        "typeVersion": 1
      },
      {
        "id": "c743486b-82e0-42f4-bd41-fad6115ac520",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2120,
          120
        ],
        "parameters": {
          "width": 219.88389496558554,
          "height": 314.75072291501283,
          "content": "### Remove label\nDelete trigger label from the Gmail thread."
        },
        "typeVersion": 1
      },
      {
        "id": "dfe99c2e-a8e6-48de-a11d-54adaf98a7fe",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "width": 219.88389496558554,
          "height": 314.75072291501283,
          "content": "### Return message content\nRetrieve content of the last message in the thread."
        },
        "typeVersion": 1
      },
      {
        "id": "6f228048-4067-494a-af44-080237c2555c",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          340
        ],
        "parameters": {
          "width": 470.88389496558545,
          "height": 314.75072291501283,
          "content": "### Get last message from thread\nReturn all messages for a single thread and pass for further processing only the last one."
        },
        "typeVersion": 1
      },
      {
        "id": "bea0ea14-6198-4022-8ddc-a0c9f895d46e",
        "name": "Remove AI label from email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2180,
          260
        ],
        "webhookId": "f19c59fe-49bd-4661-aff3-a50e43e5964a",
        "parameters": {
          "resource": "thread",
          "threadId": "={{ $('Map fields for further processing').item.json[\"threadId\"] }}",
          "operation": "removeLabels"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "dc9b5760-1669-4f29-b28d-73cd417775b4",
        "name": "Add email draft to thread",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1940,
          260
        ],
        "parameters": {
          "url": "https://www.googleapis.com/gmail/v1/users/me/drafts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\"message\":{\"raw\":\"{{ $json.encoded }}\", \"threadId\": \"{{ $('Map fields for further processing').item.json[\"threadId\"] }}\"}}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.2
      },
      {
        "id": "dbbb607b-701f-49cd-b872-96522abde5b7",
        "name": "Convert raw to base64",
        "type": "n8n-nodes-base.code",
        "position": [
          1680,
          260
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const encoded = Buffer.from($json.raw).toString('base64');\n\nreturn { encoded };"
        },
        "typeVersion": 2
      },
      {
        "id": "9114d833-1c6a-47f1-bc8d-12fb8e17218e",
        "name": "Build email raw",
        "type": "n8n-nodes-base.set",
        "position": [
          1480,
          260
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "6b6ece46-aeef-4ae5-9a0d-f472e7ced464",
                "name": "raw",
                "type": "string",
                "value": "=To: {{ $json.to }}\nSubject: {{ $json.subject }}\nContent-Type: text/html; charset=\"utf-8\"\n\n{{ $json.response }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "67c1b6ca-d419-45a9-a1d5-2a6ac157454f",
        "name": "Convert response to HTML",
        "type": "n8n-nodes-base.markdown",
        "position": [
          1220,
          260
        ],
        "parameters": {
          "mode": "markdownToHtml",
          "options": {},
          "markdown": "={{ $json.response }}"
        },
        "typeVersion": 1
      },
      {
        "id": "97be72d7-20dd-4829-bf1c-f738fb6a8a21",
        "name": "Map fields for further processing",
        "type": "n8n-nodes-base.set",
        "position": [
          980,
          260
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "d5022255-06d2-4322-b51e-ae80b7f6eef6",
                "name": "response",
                "type": "string",
                "value": "={{ $json.output }}"
              },
              {
                "id": "f729def0-3905-4c7d-ad1d-86ef7b001e9c",
                "name": "threadId",
                "type": "string",
                "value": "={{ $('Get single message content').item.json[\"threadId\"] }}"
              },
              {
                "id": "3ef18ad8-7328-4b97-bd6d-9d395a3c4a48",
                "name": "to",
                "type": "string",
                "value": "={{ $('Get single message content').item.json[\"from\"][\"text\"] }}"
              },
              {
                "id": "b013770d-fce2-4030-b372-8d94f04b51e9",
                "name": "subject",
                "type": "string",
                "value": "={{ $('Get single message content').item.json[\"subject\"] }}"
              },
              {
                "id": "69cc71b6-614d-4528-a598-69fbde1b5fd9",
                "name": "messageId",
                "type": "string",
                "value": "={{ $('Get threads with specific labels').item.json[\"id\"] }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "545a4296-5307-42ee-8935-2886338e2518",
        "name": "Ask OpenAI Assistant",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          580,
          260
        ],
        "parameters": {
          "text": "={{ $json.text }}",
          "prompt": "define",
          "options": {},
          "resource": "assistant",
          "assistantId": {
            "__rl": true,
            "mode": "list",
            "value": "asst_s32wsRpwU1HbLt40wRhghB6Y",
            "cachedResultName": "Eva"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "4f326fec-e4bb-42dc-9f26-4a3d8ce86f24",
        "name": "Get single message content",
        "type": "n8n-nodes-base.gmail",
        "position": [
          60,
          120
        ],
        "webhookId": "1ddb410c-fcdd-4230-967a-cf7844727877",
        "parameters": {
          "messageId": "={{ $json.id }}",
          "operation": "get"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "faeb879f-db00-47b7-8995-9fb9025079cf",
        "name": "Return last message in thread",
        "type": "n8n-nodes-base.limit",
        "position": [
          280,
          460
        ],
        "parameters": {
          "keep": "lastItems"
        },
        "typeVersion": 1
      },
      {
        "id": "8085cb54-3c85-4450-9e42-825a9d467d6b",
        "name": "Get thread messages",
        "type": "n8n-nodes-base.gmail",
        "position": [
          60,
          460
        ],
        "webhookId": "d53aee55-4233-42e3-b0b7-2b4521956013",
        "parameters": {
          "options": {},
          "resource": "thread",
          "threadId": "={{ $json.id }}",
          "operation": "get"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "8a3c1885-8a05-4357-85ea-03cb9e8b24fa",
        "name": "Loop over threads",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -200,
          260
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "74197fae-823e-47bc-a1c9-b2fbe90b1171",
        "name": "Get threads with specific labels",
        "type": "n8n-nodes-base.gmail",
        "position": [
          -460,
          260
        ],
        "webhookId": "6b7faf91-cc60-482c-b661-dbd702cba2cc",
        "parameters": {
          "filters": {
            "labelIds": []
          },
          "resource": "thread"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "a3360f69-b8e6-4ef8-933a-352243ab9125",
        "name": "Schedule trigger (1 min)",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -680,
          260
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "minutes",
                "minutesInterval": 1
              }
            ]
          }
        },
        "typeVersion": 1.2
      }
    ],
    "pinData": {},
    "connections": {
      "Build email raw": {
        "main": [
          [
            {
              "node": "Convert raw to base64",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop over threads": {
        "main": [
          [
            {
              "node": "Get single message content",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Get thread messages",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get thread messages": {
        "main": [
          [
            {
              "node": "Return last message in thread",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Ask OpenAI Assistant": {
        "main": [
          [
            {
              "node": "Map fields for further processing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert raw to base64": {
        "main": [
          [
            {
              "node": "Add email draft to thread",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert response to HTML": {
        "main": [
          [
            {
              "node": "Build email raw",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule trigger (1 min)": {
        "main": [
          [
            {
              "node": "Get threads with specific labels",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add email draft to thread": {
        "main": [
          [
            {
              "node": "Remove AI label from email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get single message content": {
        "main": [
          [
            {
              "node": "Ask OpenAI Assistant",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Return last message in thread": {
        "main": [
          [
            {
              "node": "Loop over threads",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get threads with specific labels": {
        "main": [
          [
            {
              "node": "Loop over threads",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Map fields for further processing": {
        "main": [
          [
            {
              "node": "Convert response to HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "52254486b159b349334953c1738da94e90477c7604aa8db2062d11afc0120739",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "45b86db7-50e8-46b8-835b-2fb61709e362",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -360,
          -160
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "rss"
        },
        "typeVersion": 1
      },
      {
        "id": "ba641186-ea96-466d-ba5c-f98128a450e2",
        "name": "Get Articles Daily",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -800,
          -160
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 12
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "b4c98895-ef0e-4247-a08b-99b5bf069d1e",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -860,
          -320
        ],
        "parameters": {
          "color": 3,
          "width": 2420,
          "height": 820,
          "content": "## Step 1. Save news in a vector store (runs daily)"
        },
        "typeVersion": 1
      },
      {
        "id": "ddc6261e-6d92-42ad-88d9-6ff2078943b2",
        "name": "Set Tech News RSS Feeds",
        "type": "n8n-nodes-base.set",
        "position": [
          -580,
          -160
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b8c00469-890b-4b5b-8e2e-2ad9ec2d0815",
                "name": "rss",
                "type": "array",
                "value": "=[\n  \"https://feeds.bbci.co.uk/news/technology/rss.xml\",\n  \"https://www.wired.com/feed/rss\",\n  \"https://www.technologyreview.com/topnews.rss\",\n  \"https://techcrunch.com/feed/\",\n\"https://www.marktechpost.com/feed/\",\n\"https://hackernoon.com/feed\",\n\"https://www.artificialintelligence-news.com/feed/\"\n]\n"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "52605fe6-bd2a-41c3-a25f-f372701b28df",
        "name": "Read RSS News Feeds",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -140,
          -160
        ],
        "parameters": {
          "url": "={{ $json.rss }}",
          "options": {
            "ignoreSSL": false
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "5758e689-58fe-407e-b3aa-dafe73176e78",
        "name": "Set and Normalize Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          220,
          -160
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e9f27ceb-c5f2-4997-8cb1-67576a7bb337",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              },
              {
                "id": "4c4f9417-40f2-4fb0-9976-d09f5984680f",
                "name": "content",
                "type": "string",
                "value": "={{ $json['content:encodedSnippet'] ?? $json.contentSnippet}}"
              },
              {
                "id": "e1986bac-054e-4240-ba50-536dbcd27337",
                "name": "date",
                "type": "string",
                "value": "={{ $json.isoDate}}"
              },
              {
                "id": "9566e23c-ac30-4d66-abbd-889f322688b7",
                "name": "link",
                "type": "string",
                "value": "={{ $json.link }}"
              },
              {
                "id": "61203b8d-7198-4087-83dc-83ac83afa5b1",
                "name": "categories",
                "type": "string",
                "value": "={{ $json.categories }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "c88f982d-8ee5-4ef5-bbdc-387e33d4d5d7",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          400,
          40
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "k5QLUV8boAepwce0",
            "name": "OpenAi account - jharilela@gmail.com - default project"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c34832be-0561-485b-92f5-68c05b9b77ce",
        "name": "Text Classifier",
        "type": "@n8n/n8n-nodes-langchain.textClassifier",
        "position": [
          460,
          -160
        ],
        "parameters": {
          "options": {
            "fallback": "discard"
          },
          "inputText": "=Title: {{ $json.title }}\nContent: {{ $json.content }}\nCategories: {{ $json.categories }}",
          "categories": {
            "categories": [
              {
                "category": "=AI",
                "description": "AI and Artificial Intelligence related articles "
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "89c58644-23dc-473c-b5c3-17e46642ce93",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1700,
          -340
        ],
        "parameters": {
          "color": 5,
          "width": 1140,
          "height": 800,
          "content": "## Step 2: Relevance scoring\n\nConsider improving this by using\n- [serp api](https://serpapi.com/dashboard)\n- [jina ai](https://jina.ai/api-dashboard/reader)\n- [perplexity ai](https://www.perplexity.ai/)\n- [open ai web search](https://www.youtube.com/watch?v=eeuLRpvQ3DY)"
        },
        "typeVersion": 1
      },
      {
        "id": "93339b1d-6ff3-4868-be68-9ccaacc0bfc5",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1900,
          -100
        ],
        "parameters": {
          "text": "=Here are 24 trending AI-related articles published today:\n\n {{ JSON.stringify($json.data) }}\n\nFrom this, generate:\n1. 10 unique long-tail blog title ideas based on these trends\n2. For each title, suggest:\n   - Main keyword\n   - Related keywords\n   - Suggested angle or tone (e.g. educational, provocative, analytical)\n3. Ensure each title is SEO-friendly, non-generic, and future-resilient\n",
          "options": {
            "systemMessage": "You are a content strategist for an AI-focused blog.\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "118aee64-ac8f-40d5-a0c1-44b9713cbce0",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1800,
          120
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "k5QLUV8boAepwce0",
            "name": "OpenAi account - jharilela@gmail.com - default project"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "b9ce417b-1e12-4385-8559-577b636337be",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          1720,
          -100
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData"
        },
        "typeVersion": 1
      },
      {
        "id": "6f29f470-d74e-4bba-91b0-ba6f1e34bfcf",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2160,
          100
        ],
        "parameters": {
          "jsonSchemaExample": "[\n  {\n  \"title\": \"Why Code Review AI Like CriticGPT Might Replace Juniors\",\n  \"main_keyword\": \"AI code review\",\n  \"related_keywords\": [\"CriticGPT\", \"OpenAI\", \"developer tools\", \"LLM code agent\"],\n  \"tone\": \"analytical\",\n  \"link_articles\": [\"https://www.hatica.io/blog/future-of-code-reviews-2025-trends/\", \"https://graphite.dev/blog/ai-wont-replace-human-code-review\", \"https://medium.com/@ravibiswas0909/can-ai-replace-junior-developers-my-honest-take-861c7d430ce7\"],\n  \"date\": \"2025-06-16\"\n},{\n  \"title\": \"Huawei AI chips that power BYD and self driving cars in china\",\n  \"main_keyword\": \"AI chips\",\n  \"related_keywords\": [\"Huawei\", \"AI\", \"self driving cars\", \"BYD\"],\n  \"tone\": \"skeptical\",\n  \"link_articles\": [\"https://technode.com/2025/03/11/chinas-gac-to-sell-level-3-autonomous-driving-vehicles-with-huawei/\", \"https://www.reuters.com/business/autos-transportation/chinas-byd-use-huaweis-advanced-autonomous-driving-system-off-road-evs-2024-08-27/\", \"https://schen583.medium.com/huawei-intelligent-driving-solutions-overview-a-16-billion-valued-automotive-tier-1-f88f4bdfdff9\"],\n  \"date\": \"2025-06-16\"\n}\n]\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "9ba4a367-e0b1-450d-971b-7892201ff530",
        "name": "Filter",
        "type": "n8n-nodes-base.filter",
        "position": [
          40,
          -160
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "dda47c0b-b0b2-46f0-a469-cd1b0e1b8152",
                "operator": {
                  "type": "dateTime",
                  "operation": "after"
                },
                "leftValue": "={{ $json.isoDate }}",
                "rightValue": "={{ $now.minus(1,\"days\") }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "918ea92f-6a19-4fb7-a896-3911a24cb306",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1940,
          -320
        ],
        "parameters": {
          "color": 7,
          "width": 1020,
          "height": 1360,
          "content": "## Steps\n1. RSS Feed Ingestion (Daily Trigger)\n[x] Fetch latest articles from curated AI RSS feeds:\n[x] OpenAI, Meta AI, DeepMind, arXiv AI, HuggingFace, TechCrunch AI, VentureBeat AI, etc.\n[x] Deduplicate and store links + metadata (title, date, summary)\n\n2. Relevance Filtering\n[x] Filter for articles:\n[x] Published within last 24 hours\n[x] Containing key topics: model releases, tool updates, research, AI regulation, etc.\n[x] Score relevance using: Keyword match, Named entity recognition, Popularity heuristics (retweet count, domain authority, etc.)\n\n3. Content Summarization\n[x] Summarize 2–3 selected articles using extractive + abstractive methods\nExtract:\n[x] Key ideas\n[x] Notable names (models, companies, researchers)\n[x] Quotes or stats\n\n4. Long-Tail Angle Generation\nConvert short-tail news into long-tail evergreen angles: E.g. “OpenAI launches CriticGPT” → “Why AI Code Review Will Replace Junior Engineers”\nUse prompt chaining:\n[x] Step 1: extract the core topic\n[x] Step 2: generate 5 long-tail blog titles with intent match (e.g., 'how', 'why', 'what's next')\n[x] Step 3: score titles based on uniqueness + search intent\n\n5. SEO-Driven Outline Creation\nGenerate outline optimized for:\n[x] H1 + H2 structure\n[x] Natural keyword inclusion\n[x] Featured snippet targeting\n[x] Structure: Intro → Background → Trend → Insight → Forecast → CTA\n\n6. Full-Length Blog Drafting\n[x] Draft 1,000–1,500 word blog using outline\nInclude:\n[x] Citations from original articles\n[x] External links for trust\n[x] Analogies, examples, future implications\n[x] Maintain tone: informative, thought-leader, semi-technical\n\n7. SEO Enrichment\nGenerate:\n[x] Meta title (60 chars)\n[x] Meta description (160 chars)\n[x] Alt text for images\n[x] Slug URL with keyword\n[x] Auto-check for keyword density, passive voice, Flesch score\n\n8. Image Generation (Optional)\n[x] Create featured image using AI (e.g., DALL·E)\n\n9. Export & Publish\n[x] Export article in Markdown or HTML\n[x] Push to CMS (e.g., WordPress REST API)\n[x] publish immediately\n[ ] schedule\n\n10. Logging & Feedback Loop\n[x] Log:\n- Source articles\n- Generated title\n- Keywords used\n- Post URL\n- Store in database for:\n- Deduplication\n- Trend tracking\n- Traffic correlation\n[ ] Feedback loop:\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "d7468098-66f8-47bf-8699-abf78eb06a13",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -860,
          580
        ],
        "parameters": {
          "color": 4,
          "width": 2400,
          "height": 800,
          "content": "## Step 3: Research the news articles\n**Double click** to edit me. [Guide](https://docs.n8n.io/workflows/sticky-notes/)"
        },
        "typeVersion": 1
      },
      {
        "id": "3eee8f2b-8c60-47f2-a1fa-e612e65ca131",
        "name": "HTTP Request",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          180,
          980
        ],
        "parameters": {
          "url": "={{ $json[\"link_articles\"] }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "d75cb082-27f0-4201-b220-c6da5ff50c37",
        "name": "HTML",
        "type": "n8n-nodes-base.html",
        "position": [
          360,
          980
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {
                "key": "body",
                "cssSelector": "body",
                "skipSelectors": "img"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a8039220-b7ec-4952-b33b-c3198cc8c4fd",
        "name": "OpenAI Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          740,
          1180
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "k5QLUV8boAepwce0",
            "name": "OpenAi account - jharilela@gmail.com - default project"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "69785989-babd-4c85-9112-36261a5099c0",
        "name": "AI Agent1",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          800,
          980
        ],
        "parameters": {
          "text": "=Below is an article. Extract the 3 most important sentences that summarize the factual content. Do not interpret. Only copy exact sentences.\n\nUse that to extract and list:\n1. write a 2-paragraph summary of the article in your own words.\n2. Key concepts or ideas\n3. Names of companies, models, or researchers\n4. Any quoted statements or numerical/statistical claims\n\nHere is the article:\n {{ $json.data }}",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2
      },
      {
        "id": "418c402c-5467-4dda-9a25-796384c3bce0",
        "name": "Structured Output Parser1",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1020,
          1180
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"abstract_summary\": \"...\",\n  \"ideas\": [\"...\"],\n  \"names\": [\"OpenAI\", \"CriticGPT\"],\n  \"quotes_or_stats\": [\"'70% faster than human review'\", \"CriticGPT released in June 2025\"]\n}\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "827e24bd-e62a-41a9-a48b-7a4423270d5e",
        "name": "Aggregate1",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          200,
          780
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData",
          "destinationFieldName": "articles"
        },
        "typeVersion": 1
      },
      {
        "id": "e0d1c4a3-cdce-4684-b6dc-83a10fc49977",
        "name": "AI Agent2",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "generate blog title ideas",
        "position": [
          -400,
          1640
        ],
        "parameters": {
          "text": "=You are a viral blog strategist. Given the following blog article concept: {{ JSON.stringify($json) }}\n\nGenerate 5 compelling blog post titles that:\n- Evoke curiosity or urgency\n- Include emotional or controversial angles\n- Use long-tail keywords for SEO\n- Are clear, specific, and make the reader want to click\n- Follow formats like:\n  - “Why [X] Is About to Change Everything in [Y]”\n  - “The Hidden Truth About [Topic]”\n  - “How [Persona] Are Using [X] to [Y]”\n  - “What No One Tells You About [Topic]”\n  - “X Predictions About the Future of [Topic] That’ll Shock You”\n\nEnd your response with:  \n**Core Topic:** [a single phrase summarizing the article idea]\n",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "becfb981-a620-463b-9053-4e97ab7822b9",
        "name": "OpenAI Chat Model3",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -380,
          1860
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "k5QLUV8boAepwce0",
            "name": "OpenAi account - jharilela@gmail.com - default project"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a578c715-df33-42bf-af9f-4d441d750e28",
        "name": "Structured Output Parser2",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          -260,
          1860
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"titles\": [\n    \"Why AI Code Review Will Replace Junior Engineers\",\n    \"How AI is Reshaping Software QA in 2025\",\n    \"What CriticGPT Means for Developer Workflows\",\n    \"The Future of Code Reviews: AI vs Human Engineers\",\n    \"5 Benefits of Using AI for Code Quality Control\"\n  ],\n  \"core_topic\" : \"AI software engineers\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "857ef5d7-768a-471c-ba86-1d08212fae1b",
        "name": "Split Out2",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          2280,
          -100
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "output"
        },
        "typeVersion": 1
      },
      {
        "id": "378ff680-dcd6-48c5-b142-e36768ddb153",
        "name": "Split Out1",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -440,
          860
        ],
        "parameters": {
          "include": "allOtherFields",
          "options": {},
          "fieldToSplitOut": "link_articles"
        },
        "typeVersion": 1
      },
      {
        "id": "c2520709-9364-48c1-8ef8-03be04802c98",
        "name": "MongoDB",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          2680,
          -100
        ],
        "parameters": {
          "fields": "=title,main_keyword,related_keywords,tone,completed_step,link_articles",
          "options": {
            "dateFields": "date"
          },
          "operation": "insert",
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a52fcd08-93ad-49f9-a4f1-a8c1ddafa9f3",
        "name": "MongoDB1",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          -620,
          860
        ],
        "parameters": {
          "query": "{\"completed_step\":2}",
          "options": {
            "limit": 1
          },
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "52fe3080-a279-42ae-a56d-af0e2491f948",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -840,
          1480
        ],
        "parameters": {
          "color": 6,
          "width": 3880,
          "height": 800,
          "content": "## Step 4,5,6,7: Write the article and prepare SEO\n**Double click** to edit me. [Guide](https://docs.n8n.io/workflows/sticky-notes/)"
        },
        "typeVersion": 1
      },
      {
        "id": "8df64bb2-6bc8-4c46-9223-2fb2c2682764",
        "name": "MongoDB3",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          -580,
          1640
        ],
        "parameters": {
          "query": "{\"completed_step\":3}",
          "options": {
            "limit": 1
          },
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "118ab8a8-4047-4da5-8723-f13c38becd2d",
        "name": "MongoDB4",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          1280,
          1640
        ],
        "parameters": {
          "fields": "blog_outline, completed_step",
          "options": {},
          "operation": "update",
          "updateKey": "_id",
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "5d4b8a5b-3e3f-4cf7-a813-5ae6417c34f1",
        "name": "AI Agent3",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "rate blog title ideas",
        "position": [
          -60,
          1640
        ],
        "parameters": {
          "text": "=Rate the following blog titles based on the **core topic**. Score each title out of 10 in:\n1. Uniqueness\n2. SEO keyword clarity\n3. Emotional and curiosity-driven clickbait quality\n\nTitles: {{ JSON.stringify($json.output.titles) }}\nCore Topic: {{ JSON.stringify($json.output.core_topic) }}\n\nReturn a ranked list with justifications for each score. Highlight the best one.\n",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "0de5e677-eb04-4c2f-90df-f3637a244877",
        "name": "OpenAI Chat Model4",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -20,
          1860
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "k5QLUV8boAepwce0",
            "name": "OpenAi account - jharilela@gmail.com - default project"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "eb6fe9ab-9a3a-4641-a0ac-6c3990c70e74",
        "name": "Structured Output Parser3",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          80,
          1860
        ],
        "parameters": {
          "jsonSchemaExample": "[\n  {\n    \"title\": \"Why AI Code Review Will Replace Junior Engineers\",\n    \"uniqueness_score\": 8,\n    \"seo_score\": 7,\n    \"longtail_score\": 9,\n    \"reason\": \"Strong intent signal ('why'), specific audience reference ('junior engineers'), but replacement framing may be oversimplified.\"\n  },\n  {\n    \"title\": \"How AI is Reshaping Software QA in 2025\",\n    \"uniqueness_score\": 6,\n    \"seo_score\": 9,\n    \"longtail_score\": 8,\n    \"reason\": \"Good long-tail and temporal relevance, but the 'reshaping' verb is generic and the angle lacks a unique hook.\"\n  },\n  {\n    \"title\": \"What CriticGPT Means for Developer Workflows\",\n    \"uniqueness_score\": 5,\n    \"seo_score\": 6,\n    \"longtail_score\": 6,\n    \"reason\": \"Moderately informative but lacks specificity, and may be too short-tail. Could benefit from clearer impact framing.\"\n  },\n  {\n    \"title\": \"The Future of Code Reviews: AI vs Human Engineers\",\n    \"uniqueness_score\": 7,\n    \"seo_score\": 8,\n    \"longtail_score\": 9,\n    \"reason\": \"Decent contrast-based framing. 'Future of' titles have strong SEO pull, but risk becoming overused.\"\n  },\n  {\n    \"title\": \"5 Benefits of Using AI for Code Quality Control\",\n    \"uniqueness_score\": 6,\n    \"seo_score\": 10,\n    \"longtail_score\": 8,\n    \"reason\": \"Clear list format, strong SEO structure, but uses a very common benefits-based formula with a broad target.\"\n  }\n]\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "f94e8254-62ad-490a-924e-036ed971c2ba",
        "name": "Code3",
        "type": "n8n-nodes-base.code",
        "notes": "rank and choose the best one",
        "position": [
          1140,
          1640
        ],
        "parameters": {
          "jsCode": "let outline = $input.first().json.output[0].outline || '';\n\n// Step 1: Remove ```markdown and ``` fences\noutline = outline\n  .replace(/```markdown\\n?/g, '')   // remove opening ```markdown\n  .replace(/```/g, '')              // remove closing ```\n  .trim();\n\n// Step 2: Escape backslashes and double quotes\noutline = outline\n  .replace(/\\\\/g, '\\\\\\\\')           // escape backslashes\n  .replace(/\"/g, '\\\\\"');            // escape double quotes\n\nreturn {\n    _id : $('Code7').first().json._id,\n    blog_outline: outline,\n    completed_step : 5\n  }\n"
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "7ede969a-a684-4a59-89f6-7f95dc05a442",
        "name": "Code4",
        "type": "n8n-nodes-base.code",
        "position": [
          380,
          780
        ],
        "parameters": {
          "jsCode": "function escapeQuotes(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/\"/g, \"'\");\n}\n\nconst articles = $input.first().json.articles.map(article => {\n  const sanitized = {};\n\n  // Loop through keys and escape problematic strings\n  for (const [key, value] of Object.entries(article)) {\n    if (Array.isArray(value)) {\n      sanitized[key] = value.map(v => escapeQuotes(v));\n    } else if (typeof value === 'string') {\n      sanitized[key] = escapeQuotes(value);\n    } else {\n      sanitized[key] = value;\n    }\n  }\n\n  return sanitized;\n});\n\nconst item_id = $('MongoDB1').first().json._id\n\nreturn {\n    _id: item_id,\n    articles: articles,\n    completed_step: 3\n  }\n"
        },
        "typeVersion": 2
      },
      {
        "id": "c8462857-7249-4878-b024-4ab90c53a9ef",
        "name": "MongoDB2",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          560,
          780
        ],
        "parameters": {
          "fields": "articles, completed_step",
          "options": {},
          "operation": "update",
          "updateKey": "_id",
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.2,
        "alwaysOutputData": true
      },
      {
        "id": "02db3b5e-6ebc-47ce-91d4-b0120e62888f",
        "name": "AI Agent5",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "generate blog outline markdown",
        "position": [
          800,
          1640
        ],
        "parameters": {
          "text": "=You are an SEO blog strategist.\n\nGiven:\n- Title: {{ $('MongoDB3').item.json.blog_title }}\n- Main keyword: {{ $('MongoDB3').item.json.main_keyword }}\n- Related keywords: {{ JSON.stringify($('MongoDB3').item.json.related_keywords) }}\n- Related articles: {{ JSON.stringify($('MongoDB3').item.json.articles) }}\n\nGenerate a detailed outline for a blog post that:\n- Uses a strong **H1** as the main title\n- Includes **H2 subheadings** for each major section\n- Naturally incorporates the main keyword and related keywords\n- Follows this structure:\n  1. Intro\n  2. Background\n  3. Trend\n  4. Insight\n  5. Forecast\n  6. CTA\n- Is optimized for **featured snippet** inclusion on Google\n\nRespond in Markdown format. Include H1 and H2 tags.\n",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "106cb1f4-c0e0-4bb6-baf4-e73128beff58",
        "name": "OpenAI Chat Model6",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          800,
          1860
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "k5QLUV8boAepwce0",
            "name": "OpenAi account - jharilela@gmail.com - default project"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "404b3108-fd22-48dc-ad0c-cc96fdef6c6d",
        "name": "Code7",
        "type": "n8n-nodes-base.code",
        "notes": "rank and choose the best one",
        "position": [
          300,
          1640
        ],
        "parameters": {
          "jsCode": "const input = $('AI Agent3').first().json.output;\n\n// Add average_score to each item\nfor (const item of input) {\n  item.average_score = (\n    (item.uniqueness_score || 0) +\n    (item.seo_score || 0) +\n    (item.longtail_score || 0)\n  ) / 3;\n}\n\n// Sort by average_score descending\ninput.sort((a, b) => b.average_score - a.average_score);\n\n// Return full sorted list + top blog title\nreturn {\n    blog_title_ideas: input,\n    blog_title: input[0].title,\n    core_topic: $('AI Agent2').first().json.output.core_topic , \n    _id: $('MongoDB3').first().json._id,\n    completed_step : 4\n  }\n"
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "d690e954-bd1d-4e66-aca6-852a8054208e",
        "name": "MongoDB7",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          440,
          1640
        ],
        "parameters": {
          "fields": "blog_title, blog_title_ideas, core_topic, completed_step",
          "options": {},
          "operation": "update",
          "updateKey": "_id",
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "fddb3ed6-d327-45c7-b2bf-4ad22a2cb818",
        "name": "AI Agent6",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "create blog content",
        "position": [
          1420,
          1640
        ],
        "parameters": {
          "text": "=Use this information:\n\n- **Title**: {{ $('MongoDB3').item.json.blog_title }}\n- **Main Keyword**: {{ $('MongoDB3').item.json.main_keyword }}\n- **Related Keywords**: {{ JSON.stringify($('MongoDB3').item.json.related_keywords) }}\n- **Tone**: {{ $('MongoDB3').item.json.tone }}\n- **Outline**: {{ $('Code3').item.json.blog_outline }}\n- **Related Articles**: {{ JSON.stringify($('MongoDB3').item.json.articles) }}\n- **Citations**: {{ JSON.stringify($('MongoDB3').item.json.link_articles) }}\n\nInstructions:\n\n1. Write approximately 300 to 500 words per section outline\n2. Naturally include the main and related keywords.\n3. Incorporate:\n   - At least 2 **citations** (link to or mention source_articles)\n   - 1 analogy or example for clarity\n   - Future implications or forecasts\n4. Maintain the tone: {{ $('MongoDB3').item.json.tone }}\n5. Write in Markdown format with:\n   - `#` for H1\n   - `##` for H2\n   - bullet points, bold text, or italics where needed\n\nRespond with the full blog article only.\n",
          "options": {
            "systemMessage": "You are a professional blog writer for a leading AI publication.\n\nYour job is to write a complete, well-structured, SEO-friendly blog post."
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "520787ba-fe10-416d-846e-a63b588f52c2",
        "name": "OpenAI Chat Model7",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1360,
          1860
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "gpt-4o"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "k5QLUV8boAepwce0",
            "name": "OpenAi account - jharilela@gmail.com - default project"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a41dbfe7-49a7-4b30-aa37-368d16d01b43",
        "name": "MongoDB5",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          1980,
          1640
        ],
        "parameters": {
          "fields": "blog_article, completed_step",
          "options": {},
          "operation": "update",
          "updateKey": "_id",
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e8cb6a64-a778-4129-a74e-cfe8c4c00080",
        "name": "Code5",
        "type": "n8n-nodes-base.code",
        "notes": "rank and choose the best one",
        "position": [
          1800,
          1640
        ],
        "parameters": {
          "jsCode": "let blog_article = $('AI Agent6').first().json.output\nblog_article = blog_article\n  .replace(/```markdown\\n?/g, '')   // remove opening ```markdown\n  .replace(/```/g, '')              // remove closing ```\n  .trim();\n\n// Step 2: Escape backslashes and double quotes\nblog_article = blog_article\n  .replace(/\\\\/g, '\\\\\\\\')           // escape backslashes\n  .replace(/\"/g, '\\\\\"');        \n\nreturn {\n    _id : $('Code7').first().json._id,\n    blog_article: blog_article,\n    completed_step : 6\n  }\n"
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "ca4193e1-d31a-4d6d-a059-5b6ce3a2b318",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          2500,
          -100
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "return {\n  ...$input.item.json,\n  completed_step: 2\n}"
        },
        "typeVersion": 2
      },
      {
        "id": "8a55bbcc-9562-4334-9da7-ffefbd161091",
        "name": "AI Agent7",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "generate meta data",
        "position": [
          2160,
          1640
        ],
        "parameters": {
          "text": "=Based on the blog article below, generate:\n1. A **meta title** (max 60 characters)\n2. A **meta description** (max 160 characters)\n3. An **image alt text** for the featured image\n4. A **URL slug** based on the blog title and keyword\n5. A basic SEO report:\n   - Keyword density for the main keyword\n   - Count of passive voice sentences\n   - Estimated Flesch reading score (0–100 scale)\n\nData:\n- Title: {{ $('MongoDB3').item.json.blog_title }}\n- Main Keyword: {{ $('MongoDB3').item.json.main_keyword }}\n- Related Keywords: {{ JSON.stringify($('MongoDB3').item.json.related_keywords) }}\n- Content: {{ $json.blog_article }}\n",
          "options": {
            "systemMessage": "You are an SEO expert."
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "65d65285-f403-4332-9f6e-e70dcca6eb13",
        "name": "OpenAI Chat Model8",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2100,
          1860
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "k5QLUV8boAepwce0",
            "name": "OpenAi account - jharilela@gmail.com - default project"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ba552978-35a5-48e2-bfbe-6fccf69d03a3",
        "name": "MongoDB6",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          2700,
          1640
        ],
        "parameters": {
          "fields": "=completed_step,meta_title,meta_description,image_alt_text, slug, seo_report",
          "options": {},
          "operation": "update",
          "updateKey": "_id",
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "334c62b5-15b8-442c-9978-d94d90ee3926",
        "name": "Code6",
        "type": "n8n-nodes-base.code",
        "notes": "rank and choose the best one",
        "position": [
          2540,
          1640
        ],
        "parameters": {
          "jsCode": "return {\n    _id : $('Code7').first().json._id,\n    ...$input.first().json.output,\n    completed_step : 7\n  }\n"
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "12045d2a-a760-445b-bdbb-c7dd814e886f",
        "name": "Structured Output Parser4",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2380,
          1840
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"meta_title\": \"Why AI Code Review Tools Matter\",\n  \"meta_description\": \"Explore how AI is reshaping code reviews and what it means for developers.\",\n  \"image_alt_text\": \"AI reviewing code on a laptop screen\",\n  \"slug\": \"ai-code-review-tools\",\n  \"seo_report\": {\n    \"keyword_density\": \"2.8%\",\n    \"passive_voice_count\": 4,\n    \"flesch_score\": 62.5\n  }\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "abcd3bc8-6983-424b-9378-3db2be76e3a9",
        "name": "MongoDB8",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          -520,
          2420
        ],
        "parameters": {
          "query": "{\"completed_step\":7}",
          "options": {
            "limit": 1
          },
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "90e042a5-fd2d-4738-a0cd-c11128dd54f6",
        "name": "OpenAI",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          60,
          2640
        ],
        "parameters": {
          "prompt": "={{ $('MongoDB8').item.json.image_alt_text }}",
          "options": {
            "size": "1792x1024"
          },
          "resource": "image"
        },
        "credentials": {
          "openAiApi": {
            "id": "k5QLUV8boAepwce0",
            "name": "OpenAi account - jharilela@gmail.com - default project"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "1d34c2fc-dc4a-4616-9651-22a920fc8ce7",
        "name": "AI Agent4",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "rate blog title ideas",
        "position": [
          -280,
          2640
        ],
        "parameters": {
          "text": "=Use the blog title, main keyword, and image alt text to craft a image generation prompt that captures a human-centered, emotionally compelling moment related to the image alt text.\n\nImagine a scene that tells a story or captures a pivotal feeling — something symbolic, cinematic, and relatable. Think in terms of real-world settings, natural environments, recognizable objects, or subtle interactions that represent change, tension, or hope. Let the visual convey meaning without relying on text or overt symbols.\n\nAvoid abstract visualizations like circuits, networks, floating data, or robotic aesthetics. Instead, evoke emotion and narrative through setting, lighting, perspective, and atmosphere. Let the image feel like a glimpse into a personal story, a lived moment, or a metaphor unfolding.\n\nDo not include any text or words in the image.\n\nRespond only with the image generation rompt.\n\nBlog Titile: {{ $json.blog_title }}\nMain Keyword: {{ $json.main_keyword }}\nImage Alt Text: {{ $json.image_alt_text }}",
          "options": {
            "systemMessage": "You are a creative visual expert in marketing and digital design. Your job is to craft emotionally compelling image prompts that generate click bait images for social media posts\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "e1573b88-90fd-425a-93a5-5f6f71e90ded",
        "name": "OpenAI Chat Model5",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -280,
          2860
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "k5QLUV8boAepwce0",
            "name": "OpenAi account - jharilela@gmail.com - default project"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "046d025b-01a8-4a29-9373-47bd051a70ef",
        "name": "Structured Output Parser5",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          -120,
          2860
        ],
        "parameters": {
          "jsonSchemaExample": "{\n\t\"prompt\": \"Create a visually striking digital banner for a blog article titled 'Exploring the Future of Generative Models Through Latent Space Interpolation.' The banner should feature a vibrant and abstract representation of a 'latent space,' showcasing smooth, flowing transitions between diverse data point visuals like images, sounds, and patterns. Incorporate elements symbolizing generative models such as neural networks, GANs, and VAEs. Use a color palette that blends futuristic blues, purples, and tech-inspired gradients\"\n}"
        },
        "typeVersion": 1.3
      },
      {
        "id": "fae23884-28f9-454d-a9a0-78efe85d2f24",
        "name": "Wordpress1",
        "type": "n8n-nodes-base.wordpress",
        "position": [
          1580,
          2420
        ],
        "parameters": {
          "title": "={{ $('MongoDB8').first().json.blog_title }}",
          "additionalFields": {
            "slug": "={{ $('MongoDB8').first().json.slug }}",
            "status": "draft",
            "sticky": false,
            "content": "={{ $json.blog_html }}",
            "authorId": 3,
            "categories": [
              8
            ],
            "postTemplate": {
              "values": {}
            },
            "commentStatus": "closed"
          }
        },
        "credentials": {
          "wordpressApi": {
            "id": "G1G8jDdEoWAVytQb",
            "name": "Wordpress  - anya@emp0.com"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "51780c90-ac3f-4960-a5d1-fb038119ec43",
        "name": "Set Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1760,
          2420
        ],
        "parameters": {
          "url": "=https://articles.emp0.com/wp-json/wp/v2/posts/{{ $('Wordpress1').item.json.id }}",
          "method": "POST",
          "options": {},
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "featured_media",
                "value": "={{ $('Upload image2').item.json.id }}"
              }
            ]
          },
          "nodeCredentialType": "wordpressApi"
        },
        "credentials": {
          "wordpressApi": {
            "id": "G1G8jDdEoWAVytQb",
            "name": "Wordpress  - anya@emp0.com"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "d53f2502-4c15-45c3-a085-5c5d28cea827",
        "name": "Upload image2",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          860,
          2420
        ],
        "parameters": {
          "url": "https://articles.emp0.com/wp-json/wp/v2/media",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "binaryData",
          "sendHeaders": true,
          "authentication": "predefinedCredentialType",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Disposition",
                "value": "=attachment; filename=\"img-{{ $('MongoDB8').item.json.slug }}.jpg\""
              }
            ]
          },
          "inputDataFieldName": "data",
          "nodeCredentialType": "wordpressApi"
        },
        "credentials": {
          "wordpressApi": {
            "id": "G1G8jDdEoWAVytQb",
            "name": "Wordpress  - anya@emp0.com"
          }
        },
        "retryOnFail": true,
        "typeVersion": 4.2,
        "waitBetweenTries": 5000
      },
      {
        "id": "a37a09bb-f82d-462d-9e67-ee180097429b",
        "name": "Set metatag1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1940,
          2420
        ],
        "parameters": {
          "url": "=https://articles.emp0.com/wp-json/wp/v2/posts/{{ $('Wordpress1').item.json.id }}",
          "method": "PUT",
          "options": {},
          "jsonBody": "={\n  \"meta\":{\n    \"_yoast_wpseo_title\":\"{{ $('MongoDB8').item.json.meta_title }}\",\n    \"_yoast_wpseo_metadesc\":\"{{ $('MongoDB8').item.json.meta_description }}\"\n  }\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "nodeCredentialType": "wordpressApi"
        },
        "credentials": {
          "wordpressApi": {
            "id": "G1G8jDdEoWAVytQb",
            "name": "Wordpress  - anya@emp0.com"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "9363f64c-6494-419e-bc84-166f2013fc3c",
        "name": "Code12",
        "type": "n8n-nodes-base.code",
        "position": [
          1040,
          2420
        ],
        "parameters": {
          "jsCode": "return { \n  \"_id\" : $('MongoDB8').first().json._id,\n  \"blog_image_url\": $input.first().json.source_url,\n  completed_step : 8\n};\n"
        },
        "typeVersion": 2
      },
      {
        "id": "2f149a7d-e6a8-4cdb-84a9-f474274fe4dc",
        "name": "MongoDB15",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          1220,
          2420
        ],
        "parameters": {
          "fields": "=completed_step,blog_image_url",
          "options": {},
          "operation": "update",
          "updateKey": "_id",
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "d687a052-adf1-4a3d-be85-94f7b0e8f772",
        "name": "Wordpress2",
        "type": "n8n-nodes-base.wordpress",
        "position": [
          2160,
          2420
        ],
        "parameters": {
          "postId": "={{ $('Wordpress1').item.json.id }}",
          "operation": "update",
          "updateFields": {
            "status": "publish"
          }
        },
        "credentials": {
          "wordpressApi": {
            "id": "ROMzk4TNprbiDIjp",
            "name": "wp - jay@emp0.com"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9a90e900-ad8e-490f-bf3a-8788cca624d5",
        "name": "MongoDB16",
        "type": "n8n-nodes-base.mongoDb",
        "position": [
          2560,
          2420
        ],
        "parameters": {
          "fields": "completed_step, blog_status, blog_link",
          "options": {},
          "operation": "update",
          "updateKey": "_id",
          "collection": "blog"
        },
        "credentials": {
          "mongoDb": {
            "id": "TwJB8fMcekPw13qA",
            "name": "MongoDB account - jharilela@gmail.com"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "3292cb3b-22c0-43aa-8860-e1b2bcea3280",
        "name": "Code14",
        "type": "n8n-nodes-base.code",
        "position": [
          2360,
          2420
        ],
        "parameters": {
          "jsCode": "return { \n  \"_id\" : $('MongoDB8').first().json._id,\n  \"blog_status\": \"Publish\",\n  \"blog_link\" : $('Wordpress1').first().json.link, \n  completed_step : 9\n};\n"
        },
        "typeVersion": 2
      },
      {
        "id": "8dca0746-0c42-4597-93d7-26023f9c237e",
        "name": "Code8",
        "type": "n8n-nodes-base.code",
        "position": [
          1400,
          2420
        ],
        "parameters": {
          "jsCode": "const markdown = $('MongoDB8').first().json.blog_article || '';\n\n// Simple replacements (limited Markdown support)\nlet html = markdown\n  .replace(/^### (.*$)/gim, '<h3>$1</h3>')\n  .replace(/^## (.*$)/gim, '<h2>$1</h2>')\n  .replace(/^# (.*$)/gim, '<h1>$1</h1>')\n  .replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>')\n  .replace(/\\*(.*?)\\*/gim, '<em>$1</em>')\n  .replace(/\\[(.*?)\\]\\((.*?)\\)/gim, '<a href=\"$2\">$1</a>')\n  .replace(/\\n$/gim, '<br />');\n\nhtml = `<div>${html}</div>`; // wrap in container\n\nreturn [{\n  json: {\n    blog_html: html\n  }\n}];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "bd78a139-74de-4b89-980f-bc60d8c09b59",
        "name": "HTTP Request1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -180,
          2420
        ],
        "parameters": {
          "url": "https://cloud.leonardo.ai/api/rest/v1/generations",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"modelId\": \"b2614463-296c-462a-9586-aafdb8f00e36\",\n  \"contrast\": 3.5,\n  \"prompt\": \"{{$json.prompt }}\",\n  \"num_images\": 1,\n  \"width\": 1472,\n  \"height\": 832,\n  \"styleUUID\": \"111dc692-d470-4eec-b791-3475abac4c46\",\n  \"enhancePrompt\": true\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "content-type",
                "value": "application/json"
              },
              {
                "name": "accept",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "JvhQAEa4Frw0CDoq",
            "name": "Leonardo AI"
          },
          "httpHeaderAuth": {
            "id": "rGBKnDk3FO1WfA4z",
            "name": "Header Auth - leonardo ai"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "fa9d6f10-ea2e-442d-bce1-419e7cf9769a",
        "name": "HTTP Request2",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          360,
          2420
        ],
        "parameters": {
          "url": "=https://cloud.leonardo.ai/api/rest/v1/generations/{{ $json.sdGenerationJob.generationId }}",
          "options": {},
          "sendHeaders": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "JvhQAEa4Frw0CDoq",
            "name": "Leonardo AI"
          },
          "httpHeaderAuth": {
            "id": "rGBKnDk3FO1WfA4z",
            "name": "Header Auth - leonardo ai"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "80ea7142-4fed-4469-881b-39139456e1ad",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          0,
          2420
        ],
        "webhookId": "c6eba895-fa7a-4113-88a0-8352816b4b98",
        "parameters": {
          "unit": "minutes",
          "amount": 1
        },
        "typeVersion": 1.1
      },
      {
        "id": "928aaf73-65c1-4d21-85aa-abca6a723525",
        "name": "HTTP Request3",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          580,
          2420
        ],
        "parameters": {
          "url": "={{ $json.generations_by_pk.generated_images[0].url }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "ba31143c-c24a-40de-8fbb-b14976b91ec4",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -840,
          2340
        ],
        "parameters": {
          "width": 3880,
          "height": 800,
          "content": "## Step 8,9: Generate image and create blog article"
        },
        "typeVersion": 1
      },
      {
        "id": "ba31cf93-d6ac-4a17-a19a-d5679f5da805",
        "name": "Get Articles Daily1",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -760,
          2420
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "hours",
                "hoursInterval": 2,
                "triggerAtMinute": 20
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "5e3dbe1b-1f6f-440e-bbfd-7c3d02f4faea",
        "name": "Get Articles Daily2",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -800,
          860
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "hours",
                "hoursInterval": 2
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6c16c912-c25a-42f9-bdc7-34d241e49255",
        "name": "Get Articles Daily3",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -760,
          1640
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "hours",
                "hoursInterval": 2,
                "triggerAtMinute": 10
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e3898031-6f85-4ff7-a868-c63016865d5e",
        "name": "Structured Output Parser6",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1000,
          1860
        ],
        "parameters": {
          "jsonSchemaExample": "[\n  {\n    \"outline\": \"```markdown\\n# Navigating Legal Complexities in AI and Copyright: A Complete Guide\\n\\n## Introduction: The Intersection of AI and Copyright\\nThe rise of generative AI has sparked a seismic shift in the creative landscape, leading to a plethora of AI copyright issues that challenge traditional views on intellectual property. As artists, musicians, and creators increasingly turn to AI-generated content, the question arises: who owns the rights to these creations? In this guide, we will explore the nuances of AI copyright issues, the implications for creativity rights, and what the future holds for artists harnessing the power of AI.\\n\\n## Background: Understanding AI and Copyright\\nIn order to grasp the complexities of AI copyright issues, one must first understand the fundamentals of copyright law and its application to generative AI. Copyright is designed to protect original works of authorship, but the emergence of AI-generated content complicates this traditional framework. This section will cover:\\n- Key definitions of intellectual property.\\n- The role of creativity rights in copyright law.\\n- Examples of how traditional copyright has been challenged by advancements in generative AI technologies.\\n\\n## Trend: The Rise of Generative AI and Its Impact\\nThe increasing sophistication of generative AI tools means more creators are using these technologies to produce art and music. This trend raises significant questions about originality and ownership. In this section, we will discuss:\\n- Notable applications of generative AI in various creative fields.\\n- The ongoing debate surrounding the legality and ethics of AI-generated content.\\n- Highlighting perspectives from industry experts, including insights from creators like Ed Sheeran on the nature of creativity in a world shaped by AI.\\n\\n## Insight: The Tension Between Innovation and Copyright Law\\nAs the lines blur between human creativity and machine-generated art, there is a growing tension between innovation and the protection of creativity rights. This section will delve into:\\n- Case studies showcasing the struggles artists face in asserting ownership over AI-assisted works.\\n- Quotations from thought leaders, such as Ed Sheeran’s view on the shared building blocks of creativity.\\n- Analyzing the statements of influential figures who have commented on the implications of AI on artistic expression, including references to past artistic movements.\\n\\n## Forecast: The Future of AI Copyright Issues\\nLooking ahead, the legal frameworks surrounding AI copyright issues are likely to evolve. This section will provide:\\n- Predictions on how copyright law may adapt to accommodate the realities of generative AI.\\n- Insights into potential policy changes and reforms that could arise from ongoing debates.\\n- A discussion on the importance of fostering a balanced approach that respects creativity rights while encouraging innovation.\\n\\n## Call to Action: Join the Conversation\\nAs the landscape of AI-generated content continues to evolve, the need for informed stakeholders is more critical than ever. We encourage readers to engage in this important dialogue. Share your thoughts on AI copyright issues and how you see the future of creativity rights developing. Stay updated with our latest insights and contribute to shaping the future of intellectual property in the age of AI.\\n```\\n\"\n  }\n]"
        },
        "typeVersion": 1.3
      },
      {
        "id": "c5b15f9c-e367-4e5e-bb1d-84742b75efeb",
        "name": "Code9",
        "type": "n8n-nodes-base.code",
        "position": [
          -340,
          2420
        ],
        "parameters": {
          "jsCode": "const base = $('MongoDB8').first().json.image_alt_text || '';\nconst cleanBase = base.replace(/[\"\\n\\r]/g, ''); // Remove double quotes and line breaks\nconst enrichedPrompt = `A cinematic, emotionally compelling scene involving people that captures the essence of: ${cleanBase}. Include visible human figures in natural interaction or meaningful posture, placed in a symbolic setting that reinforces the story.`;\n\nreturn [{\n  json: {\n    prompt: enrichedPrompt\n  }\n}];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "d566905f-666f-4ec0-b3e8-3e2ed9e6121d",
        "name": "Transform news to MD",
        "type": "n8n-nodes-base.code",
        "position": [
          580,
          980
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "function stripHtmlTags(html) {\n  return html\n    .replace(/<\\/?[^>]+(>|$)/g, '') // remove all HTML tags\n    .replace(/&nbsp;/g, ' ')\n    .replace(/&amp;/g, '&')\n    .replace(/&quot;/g, '\"')\n    .replace(/&#39;/g, \"'\")\n    .replace(/&lt;/g, '<')\n    .replace(/&gt;/g, '>');\n}\n\nconst input = $json.body || \"\";\nconst markdownContent = stripHtmlTags(input).trim();\n\nreturn {\n  json: {\n    data: markdownContent\n  }\n};\n"
        },
        "typeVersion": 2
      },
      {
        "id": "155318c9-d262-43f1-b7ed-5a4fa8bedc84",
        "name": "Code1",
        "type": "n8n-nodes-base.code",
        "position": [
          1220,
          980
        ],
        "parameters": {
          "jsCode": "// Get current item data\nlet article = $json.output || {};\n\narticle.link = $('Code10').first().json.link_articles;\n\n// Return with flattened structure\nreturn {\n  json: {\n    ...article\n  }\n};\n"
        },
        "typeVersion": 2
      },
      {
        "id": "f95f87f6-6125-4685-a772-cedc5ef6bb4e",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -240,
          860
        ],
        "parameters": {
          "options": {
            "reset": false
          }
        },
        "typeVersion": 3,
        "alwaysOutputData": false
      },
      {
        "id": "ea0b5f05-e784-44e6-9949-0c30d6dabf7d",
        "name": "Code10",
        "type": "n8n-nodes-base.code",
        "position": [
          0,
          980
        ],
        "parameters": {
          "jsCode": "return $input.all();"
        },
        "typeVersion": 2
      }
    ],
    "pinData": {},
    "connections": {
      "Code": {
        "main": [
          [
            {
              "node": "MongoDB",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTML": {
        "main": [
          [
            {
              "node": "Transform news to MD",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "MongoDB4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code4": {
        "main": [
          [
            {
              "node": "MongoDB2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code5": {
        "main": [
          [
            {
              "node": "MongoDB5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code6": {
        "main": [
          [
            {
              "node": "MongoDB6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code7": {
        "main": [
          [
            {
              "node": "MongoDB7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code8": {
        "main": [
          [
            {
              "node": "Wordpress1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code9": {
        "main": [
          [
            {
              "node": "HTTP Request1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code10": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code12": {
        "main": [
          [
            {
              "node": "MongoDB15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code14": {
        "main": [
          [
            {
              "node": "MongoDB16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter": {
        "main": [
          [
            {
              "node": "Set and Normalize Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI": {
        "main": [
          []
        ]
      },
      "MongoDB": {
        "main": [
          []
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Split Out2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "MongoDB1": {
        "main": [
          [
            {
              "node": "Split Out1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "MongoDB2": {
        "main": [
          []
        ]
      },
      "MongoDB3": {
        "main": [
          [
            {
              "node": "AI Agent2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "MongoDB4": {
        "main": [
          [
            {
              "node": "AI Agent6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "MongoDB5": {
        "main": [
          [
            {
              "node": "AI Agent7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "MongoDB6": {
        "main": [
          []
        ]
      },
      "MongoDB7": {
        "main": [
          [
            {
              "node": "AI Agent5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "MongoDB8": {
        "main": [
          [
            {
              "node": "Code9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent2": {
        "main": [
          [
            {
              "node": "AI Agent3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent3": {
        "main": [
          [
            {
              "node": "Code7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent4": {
        "main": [
          []
        ]
      },
      "AI Agent5": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent6": {
        "main": [
          [
            {
              "node": "Code5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent7": {
        "main": [
          [
            {
              "node": "Code6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "MongoDB15": {
        "main": [
          [
            {
              "node": "Code8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Image": {
        "main": [
          [
            {
              "node": "Set metatag1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Read RSS News Feeds",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate1": {
        "main": [
          [
            {
              "node": "Code4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out1": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out2": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wordpress1": {
        "main": [
          [
            {
              "node": "Set Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wordpress2": {
        "main": [
          [
            {
              "node": "Code14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set metatag1": {
        "main": [
          [
            {
              "node": "Wordpress2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request1": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "HTTP Request3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request3": {
        "main": [
          [
            {
              "node": "Upload image2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload image2": {
        "main": [
          [
            {
              "node": "Code12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Aggregate1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Text Classifier": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Text Classifier",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Get Articles Daily": {
        "main": [
          [
            {
              "node": "Set Tech News RSS Feeds",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model4": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent3",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent4",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model6": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent5",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model7": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent6",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model8": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent7",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Get Articles Daily1": {
        "main": [
          [
            {
              "node": "MongoDB8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Articles Daily2": {
        "main": [
          [
            {
              "node": "MongoDB1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Articles Daily3": {
        "main": [
          [
            {
              "node": "MongoDB3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read RSS News Feeds": {
        "main": [
          [
            {
              "node": "Filter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Transform news to MD": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Tech News RSS Feeds": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set and Normalize Fields": {
        "main": [
          [
            {
              "node": "Text Classifier",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser2": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser3": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent3",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser4": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent7",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser5": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent4",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser6": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent5",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "nodes": [
      {
        "id": "3017950d-52a5-4f51-a64d-7f223c01743e",
        "name": "chatPrompt",
        "type": "n8n-nodes-base.set",
        "position": [
          0,
          -880
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b3ce66e0-2b6f-4714-a672-59ef6e43ced9",
                "name": "prompt",
                "type": "string",
                "value": "=1. Rules\n- Communicate formally, clearly, and respectfully at all times.\n- Be concise and precise, avoiding unnecessary details.\n- Maintain a positive, professional tone as a reliable and knowledgeable assistant.\n- Respect user boundaries and refrain from engaging in prohibited or inappropriate topics.\n- Keep the conversation engaging by encouraging user participation, but when requesting clarification or additional information, ask only one focused question at a time to avoid overwhelming the user. Avoid abrupt endings to the dialogue.\n- Follow user instructions precisely.\n- Do not include any additional text or explanations unless explicitly requested.\n\n2. Response instructions\n- Analyze the message and conversation history to maintain context and continuity.\n- If repetition is requested, return the message exactly as provided. Otherwise, respond clearly and appropriately based on intent and context.\n- If the message is vague, suggest an interpretation and ask for clarification while keeping the conversation active."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "975f1ebd-9af9-4bc5-8cec-6c3be3d3a63d",
        "name": "otherPrompt",
        "type": "n8n-nodes-base.set",
        "position": [
          0,
          -720
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "d78c64d5-3c9e-4ffd-875e-973eb3c4d20a",
                "name": "prompt",
                "type": "string",
                "value": "=1. Rules\n- Communicate formally, clearly, and respectfully at all times.\n- Be concise and precise, avoiding unnecessary details.\n- Maintain a positive, professional tone as a reliable and knowledgeable assistant.\n- Respect user boundaries and refrain from engaging in prohibited or inappropriate topics.\n- Keep the conversation engaging by encouraging user participation, but when requesting clarification or additional information, ask only one focused question at a time to avoid overwhelming the user. Avoid abrupt endings to the dialogue.\n- Follow user instructions precisely.\n- Do not include any additional text or explanations unless explicitly requested.\n\n2. General Instructions\n- If a message is unclear or lacks details, respond with your best understanding as a suggestion, and politely ask the user to confirm or provide more details if it is not what they meant.\n- If the request is inappropriate or irrelevant, respond politely and clearly refuse, maintaining respect and professionalism, and invite a valid request.\n- Always follow the established rules to maintain professionalism and accuracy."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "f297c8ce-7c7c-4011-9c36-e4993dbfd926",
        "name": "generatePrompt",
        "type": "n8n-nodes-base.set",
        "position": [
          0,
          -1040
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "70c93816-7110-48e3-a105-568dd766bdf4",
                "name": "prompt",
                "type": "string",
                "value": "=1.  General instructions\nCreate a prompt that generates only one response with no comments and no line breaks. Based on the input provided, generate a detailed visual description of the request in a clear and coherent manner. Avoid using quotation marks, apostrophes, or any other punctuation marks.\n\n2. Visual specifications\n- Composition: maintain a balanced and harmonious layout where all elements (images, shapes, and text) work together seamlessly. Ensure that no part of the image feels overcrowded, and the design directs the viewer’s attention naturally. Use a minimalistic approach, avoiding excessive detail or distractions.\n\n- Color palette: choose a color scheme that complements the overall theme and enhances the mood. The colors should be visually pleasing and work together harmoniously. Use no more than 3-4 main colors to maintain simplicity and coherence, ensuring they do not overpower the design.\n\n- Visual clarity: the image should be crisp and clear, with all elements legible and easy to interpret. Avoid blurry or pixelated visuals. Maintain sharp contrasts between key elements for emphasis and visual clarity.\n\n- Image size and resolution: the image should be sized to fit standard display requirements (e.g., social media, web posts). Ensure the resolution is high enough for clarity on both desktop and mobile devices. The image must maintain visual quality without losing sharpness or details when viewed on different screens.\n\n- Aesthetic appeal: aim for a design that is not only functional but also visually appealing. The overall style should be modern, clean, and aesthetically pleasing, with a consistent look that aligns with the intended mood or message. Ensure the design is pleasing to the eye, evoking the intended response from the viewer.\n\n- Visual balance: ensure the elements in the image are well-spaced, with no part feeling too heavy or too light. Create a natural flow of focus, guiding the viewer’s eye through the composition without distraction."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "51eb4b31-0099-4886-9dfd-dc9c02107562",
        "name": "buildPrompt",
        "type": "n8n-nodes-base.set",
        "position": [
          140,
          -880
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "f435e1c3-6ff9-4e68-852c-0a39a5903ebe",
                "name": "prompt",
                "type": "string",
                "value": "={{ $json.prompt }}"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "d9a263b3-9078-47e9-8146-abf62100af21",
        "name": "ChatCore",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          280,
          -880
        ],
        "parameters": {
          "text": "=Input from user: {{ $('sessionData').item.json.Mensaje }}\n\n{{ $json.prompt }}\n\nRespond only with the exact text requested, strictly following the instructions above. ",
          "options": {
            "systemMessage": "=You are a professional enterprise chatbot designed to assist users with clear, respectful, and accurate communication. You provide informative text responses and generate images only upon explicit user requests. Utilize available conversation history to maintain context and coherence. Adhere strictly to company rules to ensure appropriate and secure interactions.\n\nYou can chat with me to get answers and create custom images based on your instructions.\n\nPrioritize the most recent relevant message if multiple prior references exist. Always respond in Spanish when providing text-based chat replies. For image generation requests, respond in English. Keep responses as short as possible without compromising clarity or natural interaction. Do not force interaction with the user beyond what is necessary to respond clearly."
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "67e27375-a9f9-45d7-8ea9-aad5d18996de",
        "name": "GeminiModel",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          300,
          -720
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash-001"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "zuXA1v8tUW8qt8Gz",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "58ab707f-00e3-4b9f-b598-af89cebf99ce",
        "name": "inputProcessor",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          -460,
          -880
        ],
        "parameters": {
          "text": "=1. Context\nYou are an intelligent assistant designed to analyze user requests accurately by considering both the current user input and prior conversation history (if available). Use this context to improve classification and response relevance. Only classify as \"generate\" if the request clearly meets all criteria. Never assume without certainty.\n\n2. General instructions\n- Use prior conversation history, if available, to interpret references, refinements, or corrections in the user’s message. \n- Apply updates directly when a previous request is being modified (e.g., changing part of a generated image).\n- Maintain context continuity unless the user explicitly shifts the topic.\n- When evaluating intention, prioritize the most recent relevant message to avoid using outdated context.\n- If the message is vague, nonsensical, or overly brief (e.g., a single word), do not classify it as \"generate\". Even if image requests occurred earlier. Only proceed if the current input clearly meets all criteria. Default to \"other\" unless the message includes clear direction.\n\n3. User Request: \"{{ $('sessionData').item.json.Mensaje }}\"\n\n4. Conversation history:\n{{ $json.messages}}\n\n5. Intentions\nClassify the user's intention as exactly one of the following:\n- \"generate\": user requests the direct creation of new visual content (e.g., images or art) to be delivered. This includes implicit requests for physical or tangible objects (e.g., \"give me a pet\"), but only if the message contains clear intent or is supported by prior context. Single-word or vague inputs without clear directive or context should not be treated as generate.\n- \"chat\": user engages in meaningful conversational interaction, including requests to generate textual prompts, explanations, or dialogue that have clear context and intent.\n- \"other\": request does not fit into the above categories, or involves content that is restricted, inappropriate, irrelevant, nonsensical, or lacks clear context or intent distinct from conversational engagement.\n\n6. Data types\nWhen analyzing the user’s message, determine whether a request for a physical or tangible object should be interpreted as a visual content request. In general, treat requests for tangible items as image generation unless the context explicitly suggests otherwise. For intangible content, respond with text unless the user clearly asks for an image.\n\nBased on the intention and content of the request, select exactly one data type to return:\n\n- \"text\": a textual response such as an answer, explanation, dialogue, or prompt text.\n- \"image\": a visual response explicitly or implicitly requested as image generation.\n\nAssign \"image\" as typeData only if the intention is \"generate\". In all other cases, including when the intention is \"other\", assign \"text\".\n\n7. Output format\nRespond only with a JSON object in this exact format, with no additional text or explanation: {\"intention\": \"value\", \"typeData\": \"value\"}",
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.6,
        "alwaysOutputData": false
      },
      {
        "id": "0123eef4-eb57-485a-ad01-66dc47b332f8",
        "name": "GeminiModel1",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -440,
          -740
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "zuXA1v8tUW8qt8Gz",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8853d1da-5ab6-44cf-8054-7267392c9eae",
        "name": "structuredOutput",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          -300,
          -740
        ],
        "parameters": {
          "jsonSchemaExample": "{\n\t\"typeData\": \"text\",\n\t\"intention\": \"generate\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "b679111d-c640-4f59-8046-c37fa7f977e9",
        "name": "contentType",
        "type": "n8n-nodes-base.switch",
        "position": [
          580,
          -800
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "=Imagen",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "24ab5811-2b6d-4f2f-8620-8697dadc2d4d",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $('intentHandler').item.json.output.typeData }}",
                      "rightValue": "image"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Texto",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "28759436-2f6a-4bb3-a9bf-924477241809",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $('intentHandler').item.json.output.typeData }}",
                      "rightValue": "text"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "8abd3463-8ecc-4086-9057-e7494b8b2d9d",
        "name": "textCleaner",
        "type": "n8n-nodes-base.code",
        "position": [
          820,
          -980
        ],
        "parameters": {
          "jsCode": "let texto = $input.first().json.prompt.replace(/[\\n\\r\\t]/g, \" \")  // Reemplaza saltos de línea, retorno de carro y tabulaciones por espacio\n  .replace(/['\"\\\\]/g, \"\")      // Elimina comillas simples, dobles y barras invertidas\n  .replace(/\\s+/g, \" \")        // Reemplaza múltiples espacios por un solo espacio\n  .trim();                     // Elimina los espacios en blanco al inicio y al final\n\nreturn {\n  text: texto\n}"
        },
        "typeVersion": 2
      },
      {
        "id": "a11a2afc-71c4-4b3f-81ec-fb8cacc1d9f2",
        "name": "imageGeneration",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          940,
          -980
        ],
        "parameters": {
          "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp-image-generation:generateContent",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"contents\": [\n    {\n      \"role\": \"user\",\n      \"parts\": [\n        {\n          \"text\": \"{{ $json.text }}\"\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"responseModalities\": [\"Text\", \"Image\"]\n  }\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googlePalmApi"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "zuXA1v8tUW8qt8Gz",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "ccce85bc-79f7-43ed-b649-8b1533d774a5",
        "name": "imageBuilder",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          1060,
          -980
        ],
        "parameters": {
          "options": {
            "fileName": "generated_image.png"
          },
          "operation": "toBinary",
          "sourceProperty": "candidates[0].content.parts[1].inlineData.data"
        },
        "typeVersion": 1.1
      },
      {
        "id": "4dbbf4c4-4d78-42d3-bdbc-a35a584643ff",
        "name": "sendImage",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1180,
          -980
        ],
        "webhookId": "511272cc-d9e3-4384-9407-e5d4296db621",
        "parameters": {
          "chatId": "={{ $('sessionData').item.json.sessionId }}",
          "operation": "sendPhoto",
          "binaryData": true,
          "additionalFields": {
            "fileName": "=generated_image.png"
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "w7tC1svlHpL7ogwy",
            "name": "TheCrawlerZeroBot"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8e525ff1-f403-4f7a-a281-36fb18824168",
        "name": "sendTextMessage",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1180,
          -780
        ],
        "webhookId": "1d1eee00-2306-4ac1-870f-0988e305f0d0",
        "parameters": {
          "text": "={{ $('ChatCore').item.json.output }}",
          "chatId": "={{ $('sessionData').item.json.sessionId }}",
          "additionalFields": {
            "parse_mode": "HTML",
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "w7tC1svlHpL7ogwy",
            "name": "TheCrawlerZeroBot"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4e0fcbad-8b6b-4c39-80ac-6aed0f8cf0fd",
        "name": "sessionData",
        "type": "n8n-nodes-base.set",
        "position": [
          -980,
          -880
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "Mensaje",
                "value": "={{ $('userInput').item.json.message.text }}"
              },
              {
                "name": "sessionId",
                "value": "={{ $('userInput').item.json.message.chat.id }}"
              },
              {
                "name": "Lenguaje",
                "value": "={{ $('userInput').item.json.message.from.language_code }}"
              },
              {
                "name": "Username",
                "value": "={{ $('userInput').item.json.message.chat.username }}"
              }
            ]
          },
          "options": {},
          "keepOnlySet": true
        },
        "typeVersion": 2
      },
      {
        "id": "ea84ebc4-2932-4fd9-8771-b13a929b6ea5",
        "name": "conversationStore",
        "type": "@n8n/n8n-nodes-langchain.memoryManager",
        "position": [
          -860,
          -880
        ],
        "parameters": {
          "options": {
            "groupMessages": true
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "03420024-1474-4b55-a98a-e80e0826ccc7",
        "name": "memoryRetriever",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          -820,
          -740
        ],
        "parameters": {
          "sessionKey": "={{ $('sessionData').item.json.sessionId }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 2
        },
        "typeVersion": 1.3
      },
      {
        "id": "28f6a639-1c50-4754-a66c-772cc3a05083",
        "name": "latestContext",
        "type": "n8n-nodes-base.code",
        "position": [
          -580,
          -880
        ],
        "parameters": {
          "jsCode": "const allItems = $input.all();\nconst lastItem = allItems[allItems.length - 1];\n\nif (lastItem && Array.isArray(lastItem.json.messages)) {\n  const messages = lastItem.json.messages;\n  const count = messages.length;\n\n  if (count === 0) return [{ json: { message: \"\" } }];\n\n  const extractFirstLine = (text) => {\n    if (!text) return \"\";\n    return text.split('\\n')[0].replace(/^Input from user:\\s*/, '');\n  };\n\n  const trimEndNewline = (text) => {\n    if (!text) return \"\";\n    return text.replace(/\\n+$/, '');\n  };\n\n  // Tomar los últimos dos o menos mensajes\n  const selectedMessages = (count === 1) ? [messages[0]] : messages.slice(-1);\n\n  // Construir el texto concatenado\n  const combinedMessage = selectedMessages.map((msg, idx) => {\n    return `Message ${idx + 1}:\\nhuman: ${extractFirstLine(msg.human)}\\nai: ${trimEndNewline(msg.ai)}`;\n  }).join('\\n\\n');\n\n  return [{ json: { messages: combinedMessage } }];\n}\n\nreturn [{ json: { messages: \"\" } }];"
        },
        "typeVersion": 2
      },
      {
        "id": "14bae45a-aafa-407f-9761-62954acabbbd",
        "name": "intentHandler",
        "type": "n8n-nodes-base.switch",
        "position": [
          -180,
          -880
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "generate",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "24ab5811-2b6d-4f2f-8620-8697dadc2d4d",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $json.output.intention }}",
                      "rightValue": "generate"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "chat",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "28759436-2f6a-4bb3-a9bf-924477241809",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $json.output.intention }}",
                      "rightValue": "chat"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "other",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "de4b6e87-950e-461c-869f-d27c73f8d763",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $json.output.intention }}",
                      "rightValue": "other"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "2f3d4931-9549-449b-8ff8-e27bf7b69e1f",
        "name": "userInput",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -1100,
          -880
        ],
        "webhookId": "ddbf3f08-3f4d-446d-9378-054225c91a06",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "w7tC1svlHpL7ogwy",
            "name": "TheCrawlerZeroBot"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "357a258b-32a7-47c4-bcf1-f32cec025cba",
        "name": "conversationMemory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          420,
          -700
        ],
        "parameters": {
          "sessionKey": "={{ $('sessionData').item.json.sessionId }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 10
        },
        "typeVersion": 1.3
      },
      {
        "id": "f1dad098-8b9f-4160-91ab-1eb7185d51a2",
        "name": "errorPreprocessor",
        "type": "n8n-nodes-base.set",
        "position": [
          700,
          -980
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "d11831d7-533b-4132-9849-612e093d6b32",
                "name": "prompt",
                "type": "string",
                "value": "={{ $('ChatCore').item.json.output }} It is mandatory to add a description of the image you are going to make."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "804fcbd3-cbc1-41d9-bbeb-40469545012f",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -860,
          -1240
        ],
        "parameters": {
          "color": 4,
          "width": 380,
          "height": 680,
          "content": "### 2. Memory and Conversational Context\n\nRetrieves the necessary context to properly infer intentions.\n\n- conversationStore: stores the entire conversation history.\n\n- memoryRetriever: extracts relevant information according to the current need.\n\n- latestContext: formats and prepares the context to be useful in response generation.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "4b4e8510-6b97-4b1d-afdb-916581aa539d",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1220,
          -1240
        ],
        "parameters": {
          "color": 5,
          "width": 340,
          "height": 680,
          "content": "### 1. Input and Session Management\n\nReceives messages from Telegram and manages the session to maintain context.\n\n- userInput: captures the user's message.\n\n- sessionData: saves and updates the session state.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "6b14b58f-2e17-4cfb-baf4-3318b3fd9533",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -460,
          -1240
        ],
        "parameters": {
          "color": 6,
          "width": 700,
          "height": 680,
          "content": "### 3. Intent Processing and Prompt Generation\nAnalyzes the intention and selects appropriate prompts according to the user's intention.\n\n- inputProcessor: detects intention and type of content to send.\n\n- intentHandler: redirects the flow based on the intention.\n\n- generatePrompt, chatPrompt, otherPrompt, buildPrompt: select the prompts for the response."
        },
        "typeVersion": 1
      },
      {
        "id": "fa4cfc3f-cdaf-4184-b183-ca31b1aa1d86",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          260,
          -1240
        ],
        "parameters": {
          "color": 3,
          "width": 300,
          "height": 680,
          "content": "### 4. Core of Generation and Conversation Management\nGenerates responses using Google Gemini, integrating context for coherence.\n\n- ChatCore: orchestrates the generation and management of the conversation.\n\n- GeminiModel: creates the final response based on prompts.\n\n- conversationMemory: stores information to maintain coherence."
        },
        "typeVersion": 1
      },
      {
        "id": "ce598ece-492b-4294-9aa4-ea0c6757edf2",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          580,
          -1240
        ],
        "parameters": {
          "color": 7,
          "width": 800,
          "height": 680,
          "content": "### 5. Content Classification and User Delivery\n\nDetermines the type of content and manages its delivery via Telegram.\n\n- contentType: defines the output format (text, image, etc.).\n\n- errorPreprocessor, textCleaner: clean and validate the content.\n\n- imageGeneration, imageBuilder: create visual content when necessary.\n\n- sendImage, sendTextMessage: send the content to the user."
        },
        "typeVersion": 1
      }
    ],
    "connections": {
      "ChatCore": {
        "main": [
          [
            {
              "node": "contentType",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "userInput": {
        "main": [
          [
            {
              "node": "sessionData",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "chatPrompt": {
        "main": [
          [
            {
              "node": "buildPrompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GeminiModel": {
        "ai_languageModel": [
          [
            {
              "node": "ChatCore",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "buildPrompt": {
        "main": [
          [
            {
              "node": "ChatCore",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "contentType": {
        "main": [
          [
            {
              "node": "errorPreprocessor",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "sendTextMessage",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "otherPrompt": {
        "main": [
          [
            {
              "node": "buildPrompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "sessionData": {
        "main": [
          [
            {
              "node": "conversationStore",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "textCleaner": {
        "main": [
          [
            {
              "node": "imageGeneration",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GeminiModel1": {
        "ai_languageModel": [
          [
            {
              "node": "inputProcessor",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "imageBuilder": {
        "main": [
          [
            {
              "node": "sendImage",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "intentHandler": {
        "main": [
          [
            {
              "node": "generatePrompt",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "chatPrompt",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "otherPrompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "latestContext": {
        "main": [
          [
            {
              "node": "inputProcessor",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "generatePrompt": {
        "main": [
          [
            {
              "node": "buildPrompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "inputProcessor": {
        "main": [
          [
            {
              "node": "intentHandler",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "imageGeneration": {
        "main": [
          [
            {
              "node": "imageBuilder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "memoryRetriever": {
        "ai_memory": [
          [
            {
              "node": "conversationStore",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "sendTextMessage": {
        "main": [
          []
        ]
      },
      "structuredOutput": {
        "ai_outputParser": [
          [
            {
              "node": "inputProcessor",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "conversationStore": {
        "main": [
          [
            {
              "node": "latestContext",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "errorPreprocessor": {
        "main": [
          [
            {
              "node": "textCleaner",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "conversationMemory": {
        "ai_memory": [
          [
            {
              "node": "ChatCore",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "7eb33f3b90daa426f859ca3ba78306e8f7bedb062192407b5811dc8aa23756f7",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "881efba9-1edc-4ec6-ab4e-5ac67ddb27fc",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -384,
          -96
        ],
        "webhookId": "71ca0160-ea8f-4037-a9a0-c83a3391d0bf",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.3
      },
      {
        "id": "a8e434db-570a-40e0-9b9f-dbca06e6fd76",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          88,
          -96
        ],
        "parameters": {
          "options": {
            "systemMessage": "=You are a helpful Meta ads assistant.\n\nCurrent date is: {{ $today.format('yyyy-MM-dd') }}"
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "bd6f4433-634a-4313-a4fc-f76290eedab2",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -160,
          128
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5-mini",
            "cachedResultName": "gpt-5-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "79I2aysjviBIV4Aj",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "f46356dc-c1c8-4798-aacc-f059dbc85b23",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          -32,
          128
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "d88a8ce8-4d31-4cdc-ad84-20d7162aaa34",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          -384,
          504
        ],
        "parameters": {
          "workflowInputs": {
            "values": [
              {
                "name": "command"
              },
              {
                "name": "id"
              },
              {
                "name": "since"
              },
              {
                "name": "until"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "8e7b6270-e895-448c-83fa-f00d2f4f7f54",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          64,
          488
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "list_accounts",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "6890448a-74f3-497b-8996-0edc456ef140",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.command }}",
                      "rightValue": "list_accounts"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "account",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "e8c7ff7a-abae-4a60-996f-b57322c513f2",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.command }}",
                      "rightValue": "account"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "list_ads",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "dc723584-5403-443b-b770-820f561e801b",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.command }}",
                      "rightValue": "list_ads"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "49b75fbb-06e6-4451-b4a2-31410d03bbbf",
        "name": "list accounts",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          96,
          128
        ],
        "parameters": {
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "UXdblREvbkvy3WSs",
            "cachedResultName": "Meta Ads Agent"
          },
          "description": "List ad accounts",
          "workflowInputs": {
            "value": {
              "command": "list_accounts"
            },
            "schema": [
              {
                "id": "command",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "command",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "since",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "since",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "until",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "until",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "command"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "3f322a2e-324d-42e3-a657-2880cd893aea",
        "name": "account details",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          224,
          128
        ],
        "parameters": {
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "UXdblREvbkvy3WSs",
            "cachedResultName": "Meta Ads Agent"
          },
          "description": "List ad accounts",
          "workflowInputs": {
            "value": {
              "id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('id', `Account id (regexp act_\\\\d+)`, 'string') }}",
              "since": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('since', `Starting date (YYYY-MM-DD)`, 'string') }}",
              "until": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('until', `End date (YYYY-MM-DD)`, 'string') }}",
              "command": "account"
            },
            "schema": [
              {
                "id": "command",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "command",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "since",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "since",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "until",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "until",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "command"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "ffa7f3ac-b8f7-4b5b-9764-11319699bb0d",
        "name": "graph: adaccounts",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          288,
          312
        ],
        "parameters": {
          "edge": "adaccounts",
          "node": "me",
          "options": {
            "fields": {
              "field": [
                {
                  "name": "name"
                }
              ]
            }
          },
          "graphApiVersion": "v23.0"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "tCCZIaLWLX5MspPG",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5e63ad12-607f-4d54-859e-d57d8688057e",
        "name": "account: campaigns",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          736,
          232
        ],
        "parameters": {
          "edge": "campaigns",
          "node": "={{ $json.id }}",
          "options": {
            "fields": {
              "field": [
                {
                  "name": "id,name,status"
                }
              ]
            },
            "queryParameters": {
              "parameter": [
                {
                  "name": "effective_status",
                  "value": "=[\"ACTIVE\"]"
                }
              ]
            }
          },
          "graphApiVersion": "v23.0"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "tCCZIaLWLX5MspPG",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5252e239-fb20-43a4-8a41-7b4cf1c9ab01",
        "name": "account: adsets",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          736,
          424
        ],
        "parameters": {
          "edge": "adsets",
          "node": "={{ $json.id }}",
          "options": {
            "fields": {
              "field": [
                {
                  "name": "id,name,status,campaign"
                }
              ]
            },
            "queryParameters": {
              "parameter": [
                {
                  "name": "effective_status",
                  "value": "=[\"ACTIVE\"]"
                }
              ]
            }
          },
          "graphApiVersion": "v23.0"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "tCCZIaLWLX5MspPG",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "798a573c-707e-4a6b-9093-7b9f8aa61cb0",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          960,
          584
        ],
        "parameters": {
          "mode": "combine",
          "options": {
            "includeUnpaired": true
          },
          "combineBy": "combineByPosition",
          "numberInputs": 4
        },
        "typeVersion": 3.2
      },
      {
        "id": "01f68eb7-c747-4134-971e-bf18822d6009",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          1184,
          616
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "return {\n  campaigns: $('account: campaigns').item.json.data,\n  adsets: $('account: adsets').item.json.data,\n  ads:   $('account: ads').item.json.data,\n  account_insights: $('account insights').item.json.data\n}"
        },
        "typeVersion": 2
      },
      {
        "id": "2da3e999-12e7-4370-ac21-3f447b6b3289",
        "name": "No Operation, do nothing",
        "type": "n8n-nodes-base.noOp",
        "position": [
          512,
          504
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "fb4d9260-92bb-45cf-9055-a746f1aace7b",
        "name": "account: ads",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          736,
          616
        ],
        "parameters": {
          "edge": "ads",
          "node": "={{ $json.id }}",
          "options": {
            "fields": {
              "field": [
                {
                  "name": "id,name,status,campaign{id,name},adset{id,name}"
                }
              ]
            },
            "queryParameters": {
              "parameter": [
                {
                  "name": "effective_status",
                  "value": "=[\"ACTIVE\"]"
                }
              ]
            }
          },
          "graphApiVersion": "v23.0"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "tCCZIaLWLX5MspPG",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "f6f46492-052c-4e7d-8f1e-d5c42b84450c",
        "name": "Edit Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          288,
          1000
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "481319e1-d562-415d-aa04-4063421bc9b1",
                "name": "id",
                "type": "string",
                "value": "={{ $json.id.startsWith('act') ? $json.id : 'act_'+$json.id }}"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "03766677-b021-48d7-8b44-9fe278c415c6",
        "name": "since, until",
        "type": "n8n-nodes-base.set",
        "position": [
          -160,
          504
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "ff699971-c2bb-4e24-96c1-a246cdd3f87b",
                "name": "since",
                "type": "string",
                "value": "={{ $json.since ?? $today.startOf('month') }}"
              },
              {
                "id": "76e8ddf3-e35c-4f4a-bcd6-db751d4443e2",
                "name": "until",
                "type": "string",
                "value": "={{ $json.until ?? $today.endOf('month') }}"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "d3ed3c25-a702-44e5-be77-3303960ed0fb",
        "name": "fix missing act_",
        "type": "n8n-nodes-base.set",
        "position": [
          288,
          504
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "481319e1-d562-415d-aa04-4063421bc9b1",
                "name": "id",
                "type": "string",
                "value": "={{ $json.id.startsWith('act') ? $json.id : 'act_'+$json.id }}"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "12c8ba0e-e1e4-49f8-aadb-9d8a9c40b0e5",
        "name": "No Operation, do nothing1",
        "type": "n8n-nodes-base.noOp",
        "position": [
          512,
          1000
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "629df03e-4091-487a-b0ec-32e366b9b008",
        "name": "account insights",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          736,
          808
        ],
        "parameters": {
          "edge": "insights",
          "node": "={{ $json.id }}",
          "options": {
            "fields": {
              "field": [
                {
                  "name": "attribution_setting,conversion_values,conversions,cost_per_conversion,cpc,cpm,ctr,frequency,impressions,inline_post_engagement,purchase_roas,reach,result_rate,results,spend"
                }
              ]
            },
            "queryParameters": {
              "parameter": [
                {
                  "name": "time_range[since]",
                  "value": "={{ $json.since.replace(/T.*/,'') }}"
                },
                {
                  "name": "time_range[until]",
                  "value": "={{ $json.until.replace(/T.*/,'') }}"
                }
              ]
            }
          },
          "graphApiVersion": "v23.0"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "tCCZIaLWLX5MspPG",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c8e86105-8551-4777-b36b-8870ac20e09b",
        "name": "ads: insights",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          736,
          1000
        ],
        "parameters": {
          "edge": "=",
          "node": "={{ $json.id }}",
          "options": {
            "fields": {
              "field": [
                {
                  "name": "=ads{id,status,name,insights{clicks,impressions,purchase_roas,conversion_values,conversions},campaign{id,name},adset{id,name}}"
                }
              ]
            },
            "queryParameters": {
              "parameter": [
                {
                  "name": "effective_status",
                  "value": "=[\"ACTIVE\"]"
                }
              ]
            }
          },
          "graphApiVersion": "v23.0"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "tCCZIaLWLX5MspPG",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ed5b25f1-ccc1-4ca4-80f7-12f2e5f44020",
        "name": "ad details",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          352,
          128
        ],
        "parameters": {
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "UXdblREvbkvy3WSs",
            "cachedResultName": "Meta Ads Agent"
          },
          "description": "List ad details for a given ad account. Use account id (regexp act_\\d+) instead of account name.",
          "workflowInputs": {
            "value": {
              "id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('id', `Account id (regexp act_\\\\d+)`, 'string') }}",
              "since": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('since', ``, 'string') }}",
              "until": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('until', ``, 'string') }}",
              "command": "list_ads"
            },
            "schema": [
              {
                "id": "command",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "command",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "since",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "since",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "until",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "until",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "command"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "f6a1df1a-3f2d-497a-ac3a-ceba3f043cb3",
        "name": "Calculator",
        "type": "@n8n/n8n-nodes-langchain.toolCalculator",
        "position": [
          480,
          128
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "763f01ad-0888-4434-b9c4-c47e9880b7cb",
        "name": "Code1",
        "type": "n8n-nodes-base.code",
        "position": [
          960,
          1000
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "return {\n  ads:   $('ads: insights').item.json.ads.data,\n}"
        },
        "typeVersion": 2
      }
    ],
    "pinData": {},
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "graph: adaccounts",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "fix missing act_",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Calculator": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "ad details": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "No Operation, do nothing1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "account: ads": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "since, until": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "ads: insights": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "list accounts": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "account details": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "account: adsets": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "account insights": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "fix missing act_": {
        "main": [
          [
            {
              "node": "No Operation, do nothing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "graph: adaccounts": {
        "main": [
          []
        ]
      },
      "account: campaigns": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "No Operation, do nothing": {
        "main": [
          [
            {
              "node": "account: campaigns",
              "type": "main",
              "index": 0
            },
            {
              "node": "account: adsets",
              "type": "main",
              "index": 0
            },
            {
              "node": "account: ads",
              "type": "main",
              "index": 0
            },
            {
              "node": "account insights",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "No Operation, do nothing1": {
        "main": [
          [
            {
              "node": "ads: insights",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "since, until",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "RV4zArpzN5InxYND",
    "meta": {
      "instanceId": "1e9c5d216f82eece259bdabdf191aced054cce6456f87af0ff7807ca2b37638a",
      "templateCredsSetupCompleted": true
    },
    "name": "Conversational Telegram Bot with GPT-4o for Text and Voice Messages",
    "tags": [
      {
        "id": "hlEHEpOdSg5lhIqi",
        "name": "Template",
        "createdAt": "2025-06-05T15:35:52.689Z",
        "updatedAt": "2025-06-05T15:35:52.689Z"
      }
    ],
    "nodes": [
      {
        "id": "a33e3f45-f16e-4107-937e-0ce1d230060f",
        "name": "Telegram Trigger",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -660,
          -180
        ],
        "webhookId": "912e007f-19d9-4b5a-a90e-12ba01c9978d",
        "parameters": {
          "updates": [
            "message",
            "*"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "ya9idB8joP5s1Xf4",
            "name": "Your Telegram Access Token"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e17f452c-4f9a-48f8-91a2-526260159676",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          520,
          420
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "gpt-4o"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "WOlQJiwanaNPGe2f",
            "name": "OpenAi Credential"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "9b33ec46-8772-4bfb-a448-fea5a673bbaa",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          740,
          460
        ],
        "parameters": {
          "sessionKey": "={{ $json.sessionId }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 10
        },
        "typeVersion": 1.3
      },
      {
        "id": "8cdd7ba8-c998-4ea7-b861-8dcaf12febfe",
        "name": "Get Voice",
        "type": "n8n-nodes-base.telegram",
        "position": [
          80,
          0
        ],
        "webhookId": "1962cd81-9991-4199-a78a-2250bf29631a",
        "parameters": {
          "fileId": "={{ $json.message.voice.file_id }}",
          "resource": "file"
        },
        "credentials": {
          "telegramApi": {
            "id": "ya9idB8joP5s1Xf4",
            "name": "Your Telegram Access Token"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "7fa34d0e-5215-44e5-b1d3-1e8abb5771ae",
        "name": "Text Or Voice",
        "type": "n8n-nodes-base.switch",
        "position": [
          -240,
          -180
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Text",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "0a236099-525e-4748-a57d-8b8e2c63c48b",
                      "operator": {
                        "type": "string",
                        "operation": "exists",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.message.text }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Voice",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "24b7e8b8-6fce-4ddc-94b6-30b852891995",
                      "operator": {
                        "type": "string",
                        "operation": "exists",
                        "singleValue": true
                      },
                      "leftValue": "={{  $json.message.voice.file_id }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "b90a586b-5d90-4f76-8e4e-bd44095f9aac",
        "name": "Transcribe The Voice",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          280,
          0
        ],
        "parameters": {
          "options": {},
          "resource": "audio",
          "operation": "transcribe"
        },
        "credentials": {
          "openAiApi": {
            "id": "WOlQJiwanaNPGe2f",
            "name": "OpenAi Credential"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "587adf8a-2e69-4078-a603-84f0322207cb",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          720,
          80
        ],
        "parameters": {
          "text": "={{ $json.message.text }}",
          "options": {
            "systemMessage": "=# Overview\nYou are a personal assistant that helps user to fulfill their request.\n\nWhen you are asked to perform a task on the current date, please use the current time and date: {{$now}}\n\n## Output\nYou should output the result and don't include any link. Just mentioned where you added it to."
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "2455c7cb-f341-4891-9096-dc62116298c0",
        "name": "Typing Action",
        "type": "n8n-nodes-base.telegram",
        "position": [
          -240,
          -360
        ],
        "webhookId": "2479f7f8-6d54-4d45-921e-af6dcfae768e",
        "parameters": {
          "chatId": "={{ $json.message.chat.id }}",
          "operation": "sendChatAction"
        },
        "credentials": {
          "telegramApi": {
            "id": "ya9idB8joP5s1Xf4",
            "name": "Your Telegram Access Token"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "8c2b6195-6101-4652-848c-505d13a3c1d2",
        "name": "Send Response To Telegram",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1340,
          80
        ],
        "webhookId": "76e4b8a4-1086-4d24-b60e-b96942d83bdf",
        "parameters": {
          "text": "={{ $json.output }}",
          "chatId": "={{$('Telegram Trigger').first().json.message.chat.id}}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "ya9idB8joP5s1Xf4",
            "name": "Your Telegram Access Token"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c8fd047d-8575-484e-939a-46064b81d035",
        "name": "Send Context To AI Agent",
        "type": "n8n-nodes-base.set",
        "position": [
          460,
          -200
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "590b803f-833c-4854-bde7-5241d25b2b32",
                "name": "message.text",
                "type": "string",
                "value": "={{ $json.message.text }}"
              },
              {
                "id": "303e0b5d-3d37-48fc-bbd3-ce62dbe7ef78",
                "name": "sessionId",
                "type": "string",
                "value": "={{ $json.message.chat.id }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "f7e90526-08a5-4a59-956f-d39e6ff472f0",
        "name": "Send Transcribe Context To AI Agent",
        "type": "n8n-nodes-base.set",
        "position": [
          460,
          0
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "2bb71aef-0ca1-4c26-95e1-c0c83bc82068",
                "name": "message.text",
                "type": "string",
                "value": "={{ $json.text }}"
              },
              {
                "id": "692a2bae-35da-41d3-be8d-32c0f5dfbbef",
                "name": "sessionId",
                "type": "string",
                "value": "={{ $('Telegram Trigger').item.json.message.chat.id }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "timezone": "Australia/Sydney",
      "callerPolicy": "workflowsFromSameOwner",
      "executionOrder": "v1"
    },
    "versionId": "3a29c25b-e7bd-41a7-91ee-4438fa9c1c1a",
    "connections": {
      "AI Agent": {
        "main": [
          [
            {
              "node": "Send Response To Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Voice": {
        "main": [
          [
            {
              "node": "Transcribe The Voice",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Text Or Voice": {
        "main": [
          [
            {
              "node": "Send Context To AI Agent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Get Voice",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Typing Action": {
        "main": [
          []
        ]
      },
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "Text Or Voice",
              "type": "main",
              "index": 0
            },
            {
              "node": "Typing Action",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Transcribe The Voice": {
        "main": [
          [
            {
              "node": "Send Transcribe Context To AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Context To AI Agent": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Transcribe Context To AI Agent": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "A0xnegTHL43LL3eP",
    "meta": {
      "instanceId": "a1ae5c8dc6c65e674f9c3947d083abcc749ef2546dff9f4ff01de4d6a36ebfe6",
      "templateCredsSetupCompleted": true
    },
    "name": "Convert YouTube Videos into SEO Blog Posts",
    "tags": [],
    "nodes": [
      {
        "id": "c79371d9-c1be-48d4-a2c7-d97a12f4e23c",
        "name": "When clicking ‘Test workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          0,
          0
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "7812d81b-3fe8-42a0-8ac8-53161c345e60",
        "name": "Get YouTube Transcript",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          440,
          0
        ],
        "parameters": {
          "url": "https://app.dumplingai.com/api/v1/get-youtube-transcript",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "videoUrl",
                "value": "={{ $json['YouTube Video Url'] }}"
              },
              {
                "name": "includeTimestamps",
                "value": "={{false}}"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "0pq31j7wKqOIHFaR",
            "name": "Dumpling AI Bearer YOUR_TOKEN_HERE account"
          },
          "httpHeaderAuth": {
            "id": "ASc5gIQaW1c63ZhO",
            "name": "Dumpling AI Auth"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "bd25a5d9-c2a2-49fa-a73a-dc1d65875629",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          140,
          -260
        ],
        "parameters": {
          "width": 260,
          "height": 240,
          "content": "## Set Variables\nSet your variables here, such as:\n- YouTube Video URL: The YouTube video you want to convert into a SEO Blog Post\n- Recipient Email Address: This is the email we send all generated content to at the end of the workflow.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "52e1de35-84ee-4019-aa5f-3502e6b728e1",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          360,
          180
        ],
        "parameters": {
          "width": 280,
          "height": 200,
          "content": "## Get YouTube Transcript\nThis step gets the transcript of the YouTube video with Dumpling AI. The target video must have captions or subtitles enabled. You can modify this to specify a language.\n "
        },
        "typeVersion": 1
      },
      {
        "id": "ec94d583-7e25-4ac4-8fb9-beb369832355",
        "name": "Set Variables",
        "type": "n8n-nodes-base.set",
        "position": [
          220,
          0
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a777e7e9-4334-4a6a-8a4c-f3b6bf5fc94b",
                "name": "YouTube Video Url",
                "type": "string",
                "value": "https://www.youtube.com/watch?v=Dpie2Cd4iB4"
              },
              {
                "id": "257054fa-5348-475e-965e-5ecd03d901bd",
                "name": "Recipient Email Address",
                "type": "string",
                "value": "example@example.com"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "fa1b0e6f-3892-4bc8-8fd8-c96d3a596991",
        "name": "Generate Blog Post",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          660,
          0
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "role": "system",
                "content": "Write a detailed SEO-optimized blog post using the provided YouTube video transcript.\n\nUse the transcript content as the foundation for the blog, extracting key ideas, topics, and themes to highlight. Ensure the blog post is structured with clear headings, subheadings, and paragraphs, incorporating SEO keywords naturally. The tone should be engaging and informative, targeted towards readers interested in the video's subject matter.\n\n- Identify the main topics and themes of the transcript.\n- Extract key points, arguments, or stories present in the transcript.\n- Determine suitable SEO keywords related to the content and integrate them meaningfully.\n- Craft a title that is both engaging and SEO-friendly.\n- Write a comprehensive and well-structured blog post with an introduction, body, and conclusion.\n- Use bullet points, lists, or numbers if necessary for clarity and readability.\n\n# Steps\n\n1. **Transcript Analysis**: Begin by thoroughly reading the provided transcript to understand the core messages and detailed content.\n   \n2. **Identify Key Points**: Extract important points, arguments, or themes that should be highlighted in the blog post.\n\n3. **SEO Keyword Research**: Determine relevant SEO keywords that align with the content’s themes and audiences.\n\n4. **Blog Structuring**: Create an outline for the blog post, arranging sections logically with appropriate headings (H2, H3) for SEO.\n\n5. **Content Writing**: Write each section based on the transcript’s content, ensuring the inclusion of SEO keywords and maintaining a clear and engaging tone.\n\n6. **Review and Edit**: Proofread for grammatical accuracy and SEO optimization. Ensure smooth flow and coherence.\n\n# Output Format\n\nRespond in the following JSON format:\n```json\n{\n  \"title\": \"string\",\n  \"blogImagePrompt\": \"string\",\n  \"description\": \"string\",\n  \"content\": \"string\"\n}\n```\n\n- Title: Craft an SEO-friendly engaging title.\n- Blog Image Prompt: Provide a textual prompt that can be used to generate an image relevant to the blog post content. We prefer abstract images.\n- Description: Summarize the blog post in a concise and engaging way.\n- Content: Write a comprehensive blog using the transcript as reference, structured with clear headings and engaging content.\n\n# Examples\n\n### Input\n[YouTube Transcript]\n\n### Output\n```json\n{\n  \"title\": \"Understanding Renewable Energy: A Path to Sustainability\",\n  \"blogImagePrompt\": \"An illustration of various renewable energy sources like solar panels and wind turbines.\",\n  \"description\": \"Explore the importance and impact of renewable energy on our planet. This blog delves into key themes and actionable insights from the transcript, providing a comprehensive understanding of sustainable energy solutions.\",\n  \"content\": \"Introduction: Renewable energy is transforming our world...\\nBody: Today's pressing challenges around fossil fuels...\\nConclusion: In embracing renewable energy, we...\"\n}\n```\n\n(This example reflects the JSON structure. Use real content from the transcript to fill these sections.)"
              },
              {
                "content": "={{ $json.transcript }}"
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "fdhWALG84tBLgSZT",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "50bfb015-554d-48f3-aa81-130677620fdd",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          660,
          -340
        ],
        "parameters": {
          "width": 260,
          "height": 320,
          "content": "## Generate Blog Post\nHere we get GPT-4o (or a model of your choice) to generate a detailed SEO blog post. We ask for:\n- title \n- description\n- blogImagePrompt\n- content\n\nTo improve this step, you can consider generating section by section or replacing this with an AI Agent with research capabilities"
        },
        "typeVersion": 1
      },
      {
        "id": "ecc499c0-776e-4cb1-8361-6f05e0cda021",
        "name": "Generate AI Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1036,
          0
        ],
        "parameters": {
          "url": "https://app.dumplingai.com/api/v1/generate-ai-image",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"model\": \"FLUX.1-dev\",\n  \"input\": {\n    \"prompt\": \"{{ $json.message.content.blogImagePrompt }}\"\n  }\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "0pq31j7wKqOIHFaR",
            "name": "Dumpling AI Bearer YOUR_TOKEN_HERE account"
          },
          "httpHeaderAuth": {
            "id": "ASc5gIQaW1c63ZhO",
            "name": "Dumpling AI Auth"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "c0e5dfef-5314-4d30-836a-e9e4d13e4679",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          980,
          180
        ],
        "parameters": {
          "height": 260,
          "content": "## Generate Blog Image\nHere we use the FLUX.1-dev model via Dumpling AI to generate a image for the blog post. Feel free to use the image model you prefer. You may need to update to a more powerful (expensive) model if you want text in your images."
        },
        "typeVersion": 1
      },
      {
        "id": "7d7c0463-7d19-46a3-be5a-d5bd47b82032",
        "name": "Gmail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1696,
          0
        ],
        "webhookId": "93615493-65f6-41ab-9ea7-2f6ffb8cbc40",
        "parameters": {
          "sendTo": "={{ $('Set Variables').item.json['Recipient Email Address'] }}",
          "message": "=Description: {{ $('Generate Blog Post').item.json.message.content.description }}\n\nContent:\n{{ $('Markdown').item.json.htmlContent }}",
          "options": {
            "attachmentsUi": {
              "attachmentsBinary": [
                {}
              ]
            }
          },
          "subject": "={{ $('Generate Blog Post').item.json.message.content.title }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "g5pJ3U0ehy2NiEiI",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "5af18f00-3d7d-4db4-ab2b-595ef7e8adc3",
        "name": "Markdown",
        "type": "n8n-nodes-base.markdown",
        "position": [
          1256,
          0
        ],
        "parameters": {
          "mode": "markdownToHtml",
          "options": {},
          "markdown": "={{ $('Generate Blog Post').item.json.message.content.content }}",
          "destinationKey": "htmlContent"
        },
        "typeVersion": 1
      },
      {
        "id": "ca2b7c3e-44e9-4043-916a-b44c3ef662f2",
        "name": "Download Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1476,
          0
        ],
        "parameters": {
          "url": "={{ $('Generate AI Image').item.json.images[0].url }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "a7414823-fc14-4981-97bb-d14f4622172e",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1180,
          -200
        ],
        "parameters": {
          "width": 260,
          "height": 180,
          "content": "## Convert Markdown to HTML\nOpenAI LLMs tend to output markdown. We need to convert to HTML for formatting in the the Gmail node."
        },
        "typeVersion": 1
      },
      {
        "id": "a0213875-25cb-48b1-b845-e14b2e83efac",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1400,
          180
        ],
        "parameters": {
          "width": 260,
          "height": 180,
          "content": "## Download Image for Attachment\nThe image URL is a temporary URL, so we need to download the image and attach it to the email being sent."
        },
        "typeVersion": 1
      },
      {
        "id": "35307e5f-662b-41ab-89fb-3519d790fa52",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1620,
          -200
        ],
        "parameters": {
          "width": 260,
          "height": 180,
          "content": "## Send blog post via email for next steps\nWe send all generated content to your email address so you have a record of all generations and can get it ready for publication"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "f91b5401-28b5-435c-a147-64bc124b1993",
    "connections": {
      "Markdown": {
        "main": [
          [
            {
              "node": "Download Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Variables": {
        "main": [
          [
            {
              "node": "Get YouTube Transcript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Image": {
        "main": [
          [
            {
              "node": "Gmail",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate AI Image": {
        "main": [
          [
            {
              "node": "Markdown",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Blog Post": {
        "main": [
          [
            {
              "node": "Generate AI Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get YouTube Transcript": {
        "main": [
          [
            {
              "node": "Generate Blog Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Test workflow’": {
        "main": [
          [
            {
              "node": "Set Variables",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "iicQhN2T4dTs1xcU",
    "meta": {
      "instanceId": "a2b23892dd6989fda7c1209b381f5850373a7d2b85609624d7c2b7a092671d44",
      "templateCredsSetupCompleted": true
    },
    "name": "💥 Convert YouTube videos to viral Shorts with Klap and auto-post with Blotato -VIDE",
    "tags": [],
    "nodes": [
      {
        "id": "0c87598f-852e-4c50-a81b-30cd0ee48c37",
        "name": "Assign Social Media IDs",
        "type": "n8n-nodes-base.set",
        "position": [
          340,
          680
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "{\n  \"instagram_id\": \"111\",\n  \"youtube_id\": \"222\",\n  \"tiktok_id\": \"333\",\n  \"facebook_id\": \"444\",\n  \"facebook_page_id\": \"555\",\n  \"threads_id\": \"666\",\n  \"twitter_id\": \"777\",\n  \"linkedin_id\": \"888\",\n  \"pinterest_id\": \"999\",\n  \"pinterest_board_id\": \"101010\",\n  \"bluesky_id\": \"111111\"\n}"
        },
        "typeVersion": 3.4
      },
      {
        "id": "3fb3c2da-8ebb-42a4-9c21-7009061c8232",
        "name": "Upload Video to Blotato",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          560,
          680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/media",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "url",
                "value": "={{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Clip URL'] }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "53aa0026-2305-49c3-8598-83f332e6a8d8",
        "name": "INSTAGRAM",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          840,
          420
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.instagram_id }}\",\n    \"target\": {\n      \"targetType\": \"instagram\"\n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"instagram\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  },\n  \"scheduledTime\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Schedule Time'] }}\"\n}\n\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "dddca94b-5cf3-492e-9348-6f297e90eb33",
        "name": "YOUTUBE",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1060,
          420
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.youtube_id }}\",\n    \"target\": {\n      \"targetType\": \"youtube\",\n      \"title\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Video Title'] }}\",\n      \"privacyStatus\": \"public\",\n      \"shouldNotifySubscribers\": true,\n      \"isMadeForKids\": false\n    },\n    \"content\": {\n      \"text\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Clip Caption'] }}\",\n      \"platform\": \"youtube\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n},\n  \"scheduledTime\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Schedule Time'] }}\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "your_API"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "886befdc-80c5-4a05-961e-0398c38a7d89",
        "name": "TIKTOK",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1260,
          420
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.tiktok_id }}\",\n    \"target\": {\n      \"targetType\": \"tiktok\",\n      \"isYourBrand\": \"false\", \n      \"disabledDuet\": \"false\",\n      \"privacyLevel\": \"PUBLIC_TO_EVERYONE\",\n      \"isAiGenerated\": \"true\",\n      \"disabledStitch\": \"false\",\n      \"disabledComments\": \"false\",\n      \"isBrandedContent\": \"false\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Clip Caption'] }}\",\n      \"platform\": \"tiktok\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  },\n  \"scheduledTime\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Schedule Time'] }}\"\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "your_api"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "6bd21195-5c01-4915-9a19-bbfa6965f311",
        "name": "FACEBOOK",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          840,
          680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.facebook_id }}\",\n    \"target\": {\n      \"targetType\": \"facebook\",\n      \"pageId\": \"{{ $('Assign Social Media IDs').item.json.facebook_page_id }}\"\n\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"facebook\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  },\n  \"scheduledTime\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Schedule Time'] }}\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "your_api"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "b9916566-1f7d-4481-a55f-656e821650f7",
        "name": "THREADS",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1060,
          680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.threads_id }}\",\n    \"target\": {\n      \"targetType\": \"threads\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"threads\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  },\n  \"scheduledTime\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Schedule Time'] }}\"\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "your_api"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "d148a2b1-c97c-4a52-a18d-b21358006f11",
        "name": "LINKEDIN",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          840,
          920
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.linkedin_id }}\",\n    \"target\": {\n      \"targetType\": \"linkedin\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"linkedin\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  },\n  \"scheduledTime\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Schedule Time'] }}\"\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "your_api"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "0cd669ba-a985-4d42-a9c9-162a6bf3866e",
        "name": "BLUESKY",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1060,
          920
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "= {\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.bluesky_id }}\",\n    \"target\": {\n      \"targetType\": \"bluesky\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"bluesky\",\n      \"mediaUrls\": [\n        \"https://pbs.twimg.com/media/GE8MgIiWEAAfsK3.jpg\"\n      ]\n    }\n  },\n  \"scheduledTime\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Schedule Time'] }}\"\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "your_api"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "a6fa19f7-cb8f-4a06-821f-d7df760bbe4c",
        "name": "PINTEREST",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1260,
          920
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.pinterest_id }}\",\n    \"target\": {\n      \"targetType\": \"pinterest\",\n      \"boardId\": \"{{ $('Assign Social Media IDs').item.json.pinterest_board_id }}\"      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"pinterest\",\n      \"mediaUrls\": [\n        \"https://pbs.twimg.com/media/GE8MgIiWEAAfsK3.jpg\"\n      ]\n    }\n  },\n  \"scheduledTime\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Schedule Time'] }}\"\n}\n\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "your_api"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "bc234c37-1a36-4f47-bdde-25cde260f751",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -840,
          -200
        ],
        "parameters": {
          "width": 2300,
          "height": 500,
          "content": "# ✅ Step 1 — Convert YouTube Video to Shorts\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8d18f741-0eab-44f2-9cd3-54f3da5a375c",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -840,
          340
        ],
        "parameters": {
          "color": 3,
          "width": 1080,
          "height": 760,
          "content": "# ✅ Step 2 — Schedule Shorts for Publication\n"
        },
        "typeVersion": 1
      },
      {
        "id": "4002b90c-5225-486f-b02b-8bf4bd3fff01",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          280,
          340
        ],
        "parameters": {
          "color": 5,
          "width": 1180,
          "height": 760,
          "content": "# ✅ Step 3 — Publish Shorts to Social Media with Blotato\n"
        },
        "typeVersion": 1
      },
      {
        "id": "bb53bd16-b23b-42c1-94c3-0c4de579ace0",
        "name": "Trigger: Receive YouTube URL via Telegram",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -760,
          -100
        ],
        "webhookId": "a35f885c-4c5a-48fd-a2a2-c0ae7e52fe0c",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "QJ4Pnum56LmvCx9q",
            "name": "Telegram account 6"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "fae0fa5c-7879-4dc2-8ef7-a899b79a9fd5",
        "name": "Extract YouTube URL & Number of Shorts",
        "type": "n8n-nodes-base.code",
        "position": [
          -580,
          -100
        ],
        "parameters": {
          "jsCode": "const message = $input.first().json.message.text;\nconst chatId = $input.first().json.message.chat.id;\n\n// Split by space to get URL and number\nconst parts = message.trim().split(/\\s+/);\n\n// Find the URL part\nconst urlPart = parts.find(part => part.includes('youtube.com') || part.includes('youtu.be'));\n\n// Find the number part\nconst numberPart = parts.find(part => /^\\d+$/.test(part));\n\nif (urlPart && numberPart) {\n\tconst number = parseInt(numberPart);\n\n\t// Validate number range\n\tif (number >= 1 && number <= 10) {\n\t\treturn [{\n\t\t\tjson: {\n\t\t\t\taction: 'process',\n\t\t\t\t'YouTube URL': urlPart,\n\t\t\t\t'How many shorts to generate?': number,\n\t\t\t\tchat_id: chatId\n\t\t\t}\n\t\t}];\n\t} else {\n\t\treturn [{\n\t\t\tjson: {\n\t\t\t\taction: 'invalid_number',\n\t\t\t\tchat_id: chatId,\n\t\t\t\tmessage: 'Please use a number between 1 and 10'\n\t\t\t}\n\t\t}];\n\t}\n} else {\n\treturn [{\n\t\tjson: {\n\t\t\taction: 'invalid_format',\n\t\t\tchat_id: chatId,\n\t\t\tmessage: `Send: YouTube_URL Number\\nExample:\\nhttps://youtu.be/abc123 5`\n\t\t}\n\t}];\n}\n"
        },
        "typeVersion": 2
      },
      {
        "id": "941ee622-2a82-414a-a710-992d19321505",
        "name": "Send Video to Klap for Shorts Generation",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -400,
          -100
        ],
        "parameters": {
          "url": "https://api.klap.app/v2/tasks/video-to-shorts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"source_video_url\": \"{{ $json['YouTube URL'] }}\",\n  \"language\": \"en\",\n  \"target_clip_count\": {{ $json['How many shorts to generate?'] }},\n  \"max_clip_count\": {{ $json['How many shorts to generate?'] }},\n  \"editing_options\": {\n    \"captions\": true,\n    \"reframe\": true,\n    \"emojis\": true,\n    \"remove_silences\": true,\n    \"intro_title\": true\n  },\n  \"min_duration\": 15,\n  \"max_duration\": 60,\n  \"target_duration\": 30\n} ",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "YOUR_API"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "dd36f27f-e34d-47cc-b288-40bdd62e9c67",
        "name": "Check Shorts Generation Status",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -200,
          -100
        ],
        "parameters": {
          "url": "=https://api.klap.app/v2/tasks/{{ $json.id }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "YOUR_API"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "6c969e03-9fe8-4dbf-9654-83ac551c34fe",
        "name": "Is Video Processing Complete?",
        "type": "n8n-nodes-base.if",
        "position": [
          20,
          -100
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "ffa318cf-7bdc-4ea5-bb02-ac69ae94a8c7",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.status }}",
                "rightValue": "ready"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "445b66de-d201-45e0-8920-ab7fcafa8814",
        "name": "Wait Before Checking Status Again",
        "type": "n8n-nodes-base.wait",
        "position": [
          240,
          80
        ],
        "webhookId": "1a54337d-9f1e-4432-84c2-df2bfb731bb8",
        "parameters": {
          "amount": 60
        },
        "typeVersion": 1.1
      },
      {
        "id": "d5587a02-4d66-4180-86eb-8b604f94f458",
        "name": "List Generated Clip Ideas",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          240,
          -100
        ],
        "parameters": {
          "url": "=https://api.klap.app/v2/projects/{{ $json.output_id }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "YOUR_API"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "18d45b4a-fe47-45fd-b904-43495e3b79b2",
        "name": "Export HD Short from Klap",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          460,
          -100
        ],
        "parameters": {
          "url": "=https://api.klap.app/v2/projects/{{ $('Check Shorts Generation Status').item.json.output_id }}/{{ $json.id }}/exports",
          "method": "POST",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "YOUR_API"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "00796fb5-12c9-43dc-8ccc-48e40919b197",
        "name": "Fetch Final Shorts URLs",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          700,
          -100
        ],
        "parameters": {
          "url": "=https://api.klap.app/v2/projects/{{ $('Check Shorts Generation Status').item.json.output_id }}/{{ $('List Generated Clip Ideas').item.json.id }}/exports/{{ $json.id }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "YOUR_API"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "b1f6e0e1-0900-49d1-a66c-60da05495ce0",
        "name": "Are All Shorts Ready?",
        "type": "n8n-nodes-base.code",
        "position": [
          980,
          -100
        ],
        "parameters": {
          "jsCode": "const allVideos = $input.all();\n\nconst totalExpected = allVideos.length;\nconst readyCount = allVideos.filter(v => v.json.status === 'ready').length;\n\n// Si tous les items sont présents et tous sont 'ready', alors true\nconst allReady = totalExpected > 0 && readyCount === totalExpected;\n\nreturn allVideos.map(video => ({\n  json: {\n    ...video.json,\n    is_everything_ready: allReady\n  }\n}));\n"
        },
        "typeVersion": 2
      },
      {
        "id": "f6b740c3-efb9-4d03-8a45-5cb0aa0b270c",
        "name": "Ready to Schedule Shorts?",
        "type": "n8n-nodes-base.if",
        "position": [
          1200,
          -100
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "4d35bf8e-906d-45dd-883e-570a91f06f41",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.is_everything_ready }}",
                "rightValue": "true"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "5b0218d3-7449-45e2-98e2-cc7d0aa21318",
        "name": "Wait Before Rechecking Final Shorts",
        "type": "n8n-nodes-base.wait",
        "position": [
          1200,
          60
        ],
        "webhookId": "40e3258c-a486-49b2-b18d-71770ef50173",
        "parameters": {
          "amount": 60
        },
        "typeVersion": 1.1
      },
      {
        "id": "af4d701f-a957-4b96-818e-105a5beeefac",
        "name": "Fetch YouTube Video Title",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -760,
          540
        ],
        "parameters": {
          "url": "=https://www.youtube.com/oembed?url={{ $('Extract YouTube URL & Number of Shorts').item.json['YouTube URL'] }}&format=json ",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "aabb8208-c624-496e-a2fc-acda25e73cb2",
        "name": "Load Publishing Schedule from Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -500,
          540
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "a05b791e-fb08-4b9a-b197-44ae5ba9f7da",
        "name": "Extract Scheduling Parameters (Posts/Day, Hours)",
        "type": "n8n-nodes-base.code",
        "position": [
          -240,
          540
        ],
        "parameters": {
          "jsCode": "let postsPerDay;\nlet startHour;\nlet endHour;\nfor (const item of items) {\nconst setting = item.json[\"Publishing Settings\"];\nconst value = item.json[\"col_2\"];\nif (setting === \"Post per Day\") {\npostsPerDay = parseInt(value, 10);\n} else if (setting === \"Start Time\") {\nstartHour = parseInt(value.split(\":\")[0], 10);\n} else if (setting === \"End Time\") {\nendHour = parseInt(value.split(\":\")[0], 10);\n}\n}\nreturn [\n{\njson: {\npostsPerDay,\nstartHour,\nendHour\n}\n}\n];"
        },
        "typeVersion": 2
      },
      {
        "id": "a9d6fc11-e802-4fe5-98d6-433e818e4c6c",
        "name": "Fetch Already Scheduled Shorts",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          40,
          540
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6,
        "alwaysOutputData": true
      },
      {
        "id": "e627a05b-bda2-43fb-8791-c885dbc4dd90",
        "name": "Determine Last Scheduled Time",
        "type": "n8n-nodes-base.code",
        "position": [
          -760,
          800
        ],
        "parameters": {
          "jsCode": "// Get existing scheduled posts\nconst existingPosts = $input.all();\n// Safe fallback: if the sheet is empty, use an empty object\nconst scheduleSettings = ($('Fetch Already Scheduled Shorts').first() || {\njson: {} }).json;\n// Find the latest scheduled time\nlet lastScheduledTime = new Date();\nif (existingPosts.length > 0) {\n// Get all scheduled times and find the latest\nconst scheduledTimes = existingPosts\n.map(post => new Date(post.json['Schedule Time']))\n.filter(date => !isNaN(date))\n.sort((a, b) => b - a); // Sort descending\nif (scheduledTimes.length > 0) {\nlastScheduledTime = scheduledTimes[0];\n}\n}\n// Pass this to the next node\nreturn [{\njson: {\nlastScheduledTime: lastScheduledTime.toISOString(),\npostsPerDay: scheduleSettings.postsPerDay,\nstartHour: scheduleSettings.startHour,\nendHour: scheduleSettings.endHour\n}\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "09f97fab-b396-411e-a33d-e845be8d7935",
        "name": "Calculate Publication Times for New Shorts",
        "type": "n8n-nodes-base.code",
        "position": [
          -500,
          800
        ],
        "parameters": {
          "jsCode": "const postsPerDay = parseInt($('Extract Scheduling Parameters (Posts/Day, Hours)').first().json.postsPerDay);\nconst startHour = parseInt($('Extract Scheduling Parameters (Posts/Day, Hours)').first().json.startHour);\nconst endHour = parseInt($('Extract Scheduling Parameters (Posts/Day, Hours)').first().json.endHour);\nconst lastScheduledTime = new\nDate($input.first().json.lastScheduledTime);\n// Get video data\nconst videos = $('List Generated Clip Ideas').all();\nconst finalShorts = $('Fetch Final Shorts URLs').all();\nconst now = new Date();\nconst totalHours = endHour - startHour;\nconst intervalMs = (totalHours * 60 * 60 * 1000) / postsPerDay;\n// Start from the day after the last scheduled post\nlet startDate = new Date(lastScheduledTime);\nstartDate.setDate(startDate.getDate() + 1);\nstartDate.setHours(startHour, 0, 0, 0);\n// If starting date is in the past, use tomorrow\nif (startDate < now) {\nstartDate = new Date();\nstartDate.setDate(startDate.getDate() + 1);\nstartDate.setHours(startHour, 0, 0, 0);\n}\nconst result = [];\nlet videoIndex = 0;\nlet currentDate = new Date(startDate);\nlet dailyPostCount = 0;\nwhile (videoIndex < videos.length) {\n// Calculate time slot\nconst baseTime = new Date(currentDate);\nbaseTime.setHours(startHour + (dailyPostCount * (totalHours /\npostsPerDay)), 0, 0, 0);\n// Add randomness ±30 min\nconst offset = (Math.random() - 0.5) * 60 * 60 * 1000;\nconst scheduledTime = new Date(baseTime.getTime() + offset);\n// Get video data\nconst video = videos[videoIndex].json;\nconst finalShort = finalShorts[videoIndex].json;\nresult.push({\njson: {\nscheduled_at: scheduledTime.toISOString(),\nvideo_name: video.name,\nvideo_virality_score: video.virality_score,\nvideo_caption: video.publication_captions.youtube,\nvideo_tiktok_caption: video.publication_captions.tiktok,\nvideo_url: finalShort.src_url,\nvideo_id: video.id\n}\n});\nvideoIndex++;\ndailyPostCount++;\n// Move to next day if daily limit reached\nif (dailyPostCount >= postsPerDay) {\ncurrentDate.setDate(currentDate.getDate() + 1);\ndailyPostCount = 0;\n}\n}\nreturn result;"
        },
        "typeVersion": 2
      },
      {
        "id": "d6c651b7-59c9-4f9e-a7ef-b71da871a381",
        "name": "Convert Times to Local Timezone (Paris)",
        "type": "n8n-nodes-base.code",
        "position": [
          -240,
          800
        ],
        "parameters": {
          "jsCode": "return $input.all().map(item => {\nconst utc = item.json.scheduled_at;\nconst local = new Date(utc).toLocaleString(\"en-US\", {\ntimeZone: \"Europe/Paris\",\ntimeZoneName: \"short\",\nhour12: false\n});\nreturn {\njson: {\n...item.json, // This includes all the video data\nlocal_time: local\n}\n};\n});"
        },
        "typeVersion": 2
      },
      {
        "id": "67b6658d-4f87-42af-a487-8f24b3744965",
        "name": "Log Shorts & Schedule Info to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          40,
          800
        ],
        "parameters": {
          "columns": {
            "value": {
              "Clip URL": "={{ $json.video_url }}",
              "Video URL": "={{ $('Extract YouTube URL & Number of Shorts').first().json['YouTube URL'] }}",
              "Video Title": "={{ $('Fetch YouTube Video Title').first().json.title }}",
              "Clip Caption": "={{ $json.video_tiktok_caption }}",
              "Schedule Time": "={{ $json.scheduled_at }}",
              "Video Clip Idea": "={{ $json.video_name }}",
              "Clip Virality Score": "={{ $json.video_virality_score }}",
              "Schedule Time (local)": "={{ $json.local_time }}"
            },
            "schema": [
              {
                "id": "Video Title",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Video Title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Video URL",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Video URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Video Clip Idea",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Video Clip Idea",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Clip Virality Score",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Clip Virality Score",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Clip Caption",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Clip Caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Clip URL",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Clip URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Schedule Time",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Schedule Time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Schedule Time (local)",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Schedule Time (local)",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "1fb02be6-b65e-48f3-8d0d-45bb64630aed",
        "name": "Send Publication Summary to Telegram",
        "type": "n8n-nodes-base.telegram",
        "position": [
          560,
          420
        ],
        "webhookId": "7b1f7dbf-c8dc-4cb7-b538-19b6d8d0ea72",
        "parameters": {
          "text": "=Your YouTube video \"{{ $('Fetch YouTube Video Title').first().json.title }}\"\nwas converted into {{ $('Extract YouTube URL & Number of Shorts').first().json['How many shorts to generate?'] }} shorts and scheduled for publication on Tiktok,\nInstagram, Facebook, LinkedIn, Twitter and YouTube at these\ntimes:\n{{ $('Convert Times to Local Timezone (Paris)').all().map(item =>\nitem.json.local_time).join('\\n') }}",
          "chatId": "={{ $('Trigger: Receive YouTube URL via Telegram').first().json.message.chat.id }}",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "QJ4Pnum56LmvCx9q",
            "name": "Telegram account 6"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "295a47d5-3521-46da-99eb-35d52ecf4f56",
        "name": "TWITTER",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1260,
          680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.twitter_id }}\",\n    \"target\": {\n      \"targetType\": \"twitter\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"twitter\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  },\n  \"scheduledTime\": \"{{ $('Log Shorts & Schedule Info to Google Sheets').item.json['Schedule Time'] }}\"\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "your_api"
              }
            ]
          }
        },
        "typeVersion": 4.2
      }
    ],
    "active": false,
    "pinData": {
      "Assign Social Media IDs": [
        {
          "json": {
            "tiktok_id": "2079",
            "bluesky_id": "932",
            "threads_id": "507",
            "twitter_id": "1289",
            "youtube_id": "873",
            "facebook_id": "1759",
            "linkedin_id": "1446",
            "instagram_id": "1687",
            "pinterest_id": "363",
            "facebook_page_id": "101603614680195",
            "pinterest_board_id": "1146658823815436667"
          }
        },
        {
          "json": {
            "tiktok_id": "2079",
            "bluesky_id": "932",
            "threads_id": "507",
            "twitter_id": "1289",
            "youtube_id": "873",
            "facebook_id": "1759",
            "linkedin_id": "1446",
            "instagram_id": "1687",
            "pinterest_id": "363",
            "facebook_page_id": "101603614680195",
            "pinterest_board_id": "1146658823815436667"
          }
        },
        {
          "json": {
            "tiktok_id": "2079",
            "bluesky_id": "932",
            "threads_id": "507",
            "twitter_id": "1289",
            "youtube_id": "873",
            "facebook_id": "1759",
            "linkedin_id": "1446",
            "instagram_id": "1687",
            "pinterest_id": "363",
            "facebook_page_id": "101603614680195",
            "pinterest_board_id": "1146658823815436667"
          }
        },
        {
          "json": {
            "tiktok_id": "2079",
            "bluesky_id": "932",
            "threads_id": "507",
            "twitter_id": "1289",
            "youtube_id": "873",
            "facebook_id": "1759",
            "linkedin_id": "1446",
            "instagram_id": "1687",
            "pinterest_id": "363",
            "facebook_page_id": "101603614680195",
            "pinterest_board_id": "1146658823815436667"
          }
        },
        {
          "json": {
            "tiktok_id": "2079",
            "bluesky_id": "932",
            "threads_id": "507",
            "twitter_id": "1289",
            "youtube_id": "873",
            "facebook_id": "1759",
            "linkedin_id": "1446",
            "instagram_id": "1687",
            "pinterest_id": "363",
            "facebook_page_id": "101603614680195",
            "pinterest_board_id": "1146658823815436667"
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "07f8bb30-431e-4f84-977c-edb26a7c4da0",
    "connections": {
      "TIKTOK": {
        "main": [
          []
        ]
      },
      "Are All Shorts Ready?": {
        "main": [
          [
            {
              "node": "Ready to Schedule Shorts?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Assign Social Media IDs": {
        "main": [
          [
            {
              "node": "Upload Video to Blotato",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Final Shorts URLs": {
        "main": [
          [
            {
              "node": "Are All Shorts Ready?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video to Blotato": {
        "main": [
          [
            {
              "node": "INSTAGRAM",
              "type": "main",
              "index": 0
            },
            {
              "node": "YOUTUBE",
              "type": "main",
              "index": 0
            },
            {
              "node": "TIKTOK",
              "type": "main",
              "index": 0
            },
            {
              "node": "FACEBOOK",
              "type": "main",
              "index": 0
            },
            {
              "node": "THREADS",
              "type": "main",
              "index": 0
            },
            {
              "node": "TWITTER",
              "type": "main",
              "index": 0
            },
            {
              "node": "LINKEDIN",
              "type": "main",
              "index": 0
            },
            {
              "node": "BLUESKY",
              "type": "main",
              "index": 0
            },
            {
              "node": "PINTEREST",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send Publication Summary to Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Export HD Short from Klap": {
        "main": [
          [
            {
              "node": "Fetch Final Shorts URLs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch YouTube Video Title": {
        "main": [
          [
            {
              "node": "Load Publishing Schedule from Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Generated Clip Ideas": {
        "main": [
          [
            {
              "node": "Export HD Short from Klap",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Ready to Schedule Shorts?": {
        "main": [
          [
            {
              "node": "Fetch YouTube Video Title",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait Before Rechecking Final Shorts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Determine Last Scheduled Time": {
        "main": [
          [
            {
              "node": "Calculate Publication Times for New Shorts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Video Processing Complete?": {
        "main": [
          [
            {
              "node": "List Generated Clip Ideas",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait Before Checking Status Again",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Shorts Generation Status": {
        "main": [
          [
            {
              "node": "Is Video Processing Complete?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Already Scheduled Shorts": {
        "main": [
          [
            {
              "node": "Determine Last Scheduled Time",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait Before Checking Status Again": {
        "main": [
          [
            {
              "node": "Check Shorts Generation Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait Before Rechecking Final Shorts": {
        "main": [
          [
            {
              "node": "Fetch Final Shorts URLs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract YouTube URL & Number of Shorts": {
        "main": [
          [
            {
              "node": "Send Video to Klap for Shorts Generation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert Times to Local Timezone (Paris)": {
        "main": [
          [
            {
              "node": "Log Shorts & Schedule Info to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Video to Klap for Shorts Generation": {
        "main": [
          [
            {
              "node": "Check Shorts Generation Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger: Receive YouTube URL via Telegram": {
        "main": [
          [
            {
              "node": "Extract YouTube URL & Number of Shorts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Calculate Publication Times for New Shorts": {
        "main": [
          [
            {
              "node": "Convert Times to Local Timezone (Paris)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Load Publishing Schedule from Google Sheets": {
        "main": [
          [
            {
              "node": "Extract Scheduling Parameters (Posts/Day, Hours)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Log Shorts & Schedule Info to Google Sheets": {
        "main": [
          [
            {
              "node": "Assign Social Media IDs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Scheduling Parameters (Posts/Day, Hours)": {
        "main": [
          [
            {
              "node": "Fetch Already Scheduled Shorts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "LPUpZtHK7gGRA5wa",
    "meta": {
      "instanceId": "1d871c7857f6a0f6093c24e2cd2fa1fa755b3826859fe85548d66cefd9f0e0ed"
    },
    "name": "Automated AI YouTube Shorts Factory for ASMR (Seedance)",
    "tags": [
      {
        "id": "1",
        "name": "AI"
      },
      {
        "id": "2",
        "name": "YouTube"
      },
      {
        "id": "3",
        "name": "Content Creation"
      }
    ],
    "nodes": [
      {
        "id": "25a59939-f6b6-4fae-8ed0-7808e008331c",
        "name": "Unbundle Prompts",
        "type": "n8n-nodes-base.code",
        "position": [
          3060,
          220
        ],
        "parameters": {
          "jsCode": "function findSceneEntries(obj) {\n  const scenes = [];\n\n  for (const [key, value] of Object.entries(obj)) {\n    if (key.toLowerCase().startsWith(\"scene\") && typeof value === \"string\") {\n      scenes.push(value);\n    } else if (typeof value === \"object\" && value !== null) {\n      scenes.push(...findSceneEntries(value));\n    }\n  }\n\n  return scenes;\n}\n\nlet output = [];\n\ntry {\n  const inputData = items[0].json;\n  const scenes = findSceneEntries(inputData);\n\n  if (scenes.length === 0) {\n    throw new Error(\"No scene keys found at any level.\");\n  }\n\n  output = scenes.map(scene => ({ description: scene }));\n} catch (e) {\n  throw new Error(\"Could not extract scenes properly. Details: \" + e.message);\n}\n\nreturn output;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "c15a3956-bf4f-446e-b14b-1304d5b37f3d",
        "name": "Create Sounds",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3260,
          440
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/mmaudio-v2 ",
          "body": "= {\n        \"prompt\": \"ASMR Soothing sound effects. {{ $('Prompts AI Agent').item.json.output.Sound }}\",\n        \"duration\": 10,\n        \"video_url\": \"{{ $json.data.outputs[0] }}\"\n  }\n",
          "method": "POST",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          },
          "sendBody": true,
          "contentType": "raw",
          "authentication": "genericCredentialType",
          "rawContentType": "application/json",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {},
        "typeVersion": 4.2
      },
      {
        "id": "d277a432-e3b3-4069-837c-6e68def03672",
        "name": "Get Sounds",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3780,
          440
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/mmaudio-v2/requests/{{ $json.request_id }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {},
        "typeVersion": 4.2
      },
      {
        "id": "2734cc8e-416a-41fd-a20b-40c079889907",
        "name": "Wait for Sounds",
        "type": "n8n-nodes-base.wait",
        "position": [
          3480,
          440
        ],
        "parameters": {
          "amount": 60
        },
        "typeVersion": 1.1
      },
      {
        "id": "70f2ebeb-1ef1-439c-88b5-3c6094dca6a3",
        "name": "List Elements",
        "type": "n8n-nodes-base.code",
        "position": [
          3060,
          640
        ],
        "parameters": {
          "jsCode": "return [\n  {\n    video_urls: items.map(item => item.json.video.url)\n  }\n];"
        },
        "typeVersion": 2
      },
      {
        "id": "8892adcd-e2da-476c-998d-b814b12184e0",
        "name": "Sequence Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3260,
          640
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/ffmpeg-api/compose",
          "body": "={\n  \"tracks\": [\n    {\n      \"id\": \"1\",\n      \"type\": \"video\",\n      \"keyframes\": [\n        { \"url\": \"{{ $json.video_urls[0] }}\", \"timestamp\": 0, \"duration\": 10 },\n        { \"url\": \"{{ $json.video_urls[1] }}\", \"timestamp\": 10, \"duration\": 10 },\n        { \"url\": \"{{ $json.video_urls[2] }}\", \"timestamp\": 20, \"duration\": 10 }\n      ]\n    }\n  ]\n}",
          "method": "POST",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          },
          "sendBody": true,
          "contentType": "raw",
          "authentication": "genericCredentialType",
          "rawContentType": "application/json",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {},
        "typeVersion": 4.2
      },
      {
        "id": "9063eb02-8cd4-4b75-87f2-fdd59f56f26c",
        "name": "Get Final Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3780,
          640
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/ffmpeg-api/requests/{{ $json.request_id }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {},
        "typeVersion": 4.2
      },
      {
        "id": "b3c4c19c-2caa-454c-ae56-a6c00117a6d4",
        "name": "Wait for Final Video",
        "type": "n8n-nodes-base.wait",
        "position": [
          3480,
          640
        ],
        "parameters": {
          "amount": 60
        },
        "typeVersion": 1.1
      },
      {
        "id": "7edea676-00ad-4c17-8fd9-54e55e06dbc5",
        "name": "Think",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          2580,
          520
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "9d61496d-66a5-454f-b60a-6d997a4d75e8",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2220,
          440
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1"
          }
        },
        "credentials": {
          "openAiApi": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "da01687e-ad98-42c0-bab5-057882d6709b",
        "name": "Prompts AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2720,
          220
        ],
        "parameters": {
          "text": "=Give me 3 video prompts based on the previous \n\nUse the Think tool to review your output",
          "options": {
            "systemMessage": "=Role: You are a prompt-generation AI specializing in satisfying, ASMR-style video prompts for kinetic sand. Your task is to generate a multi-scene video sequence that vividly shows a tool (like a knife, scoop, or press) interacting with kinetic sand in a clean, high-detail setting.\n\nYour writing must follow this style:\n\nSatisfying, tactile realism.\nMacro-level detail with a tight focus on the tool interacting with the sand's unique texture.\nThe tool must always be in motion — slicing, scooping, pressing, or crumbling the sand. Never idle or static.\nCamera terms are allowed (e.g. macro view, top-down shot, slow-motion).\n\nEach scene must contain all of the following, expressed through detailed visual language:\n\n✅ The kinetic sand (from the Idea)\n✅ The environment or surface (from the Environment)\n✅ The texture, structure, and behavior of the sand as it's being manipulated\n✅ A visible tool (knife, scoop, mold) actively interacting with the sand\n\nDescriptions should show:\n\nThe physical makeup of the sand — is it layered with different colors, sparkly, smooth, or matte? Emphasize its granular, yet cohesive structure.\nHow the sand responds to the tool — clean slicing, soft crumbling, perfect imprints, satisfying deformation, or a cascading collapse.\nThe interaction between the tool and the sand — sand grains momentarily sticking to the tool, the smooth surface left behind, the crisp edges of a cut.\nAny ASMR-relevant sensory cues like the satisfying crunch, the soft hiss of falling grains, or the shimmer of glitter, but always shown visually — not narrated.\n\nTone:\n\nSatisfying, mesmerizing, tactile.\nNo poetic metaphors, emotion, or storytelling.\nAvoid fantasy or surreal imagery.\nAll description must feel physically grounded and visually appealing.\n\nLength:\n\nEach scene must be between 1,000 and 2,000 characters.\nNo shallow or repetitive scenes — each must be immersive, descriptive, and specific.\nEach scene should explore a distinct phase of the action, a different camera perspective, or a new behavior of the sand.\n\nInputs:\n\nIdea: \"{{ $json.idea }}\"\nEnvironment: \"{{ $json.environment_prompt }}\"\nSound: \"{{ $json.sound_prompt }}\"\n\nFormat:\n\nIdea: \"...\"\nEnvironment: \"...\"\nSound: \"...\"\n\nScene 1: \"...\"\nScene 2: \"...\"\nScene 3: \"...\"\n(and so on)"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "64abf568-4e09-4e5c-bd12-7475e721a54c",
        "name": "Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2380,
          440
        ],
        "parameters": {
          "jsonSchemaExample": "[\n  {\n    \"Caption\": \"Diver Removes Nets Off Whale 🐋 #whalerescue #marinelife #oceanrescue #seahelpers #love #nature #instagood #explore #viral #savenature #oceanguardians #cleanoceans\",\n    \"Idea\": \"Diver carefully cuts tangled net from distressed whale in open sea\",\n    \"Environment\": \"Open ocean, sunlight beams through water, diver and whale, cinematic realism\",\n    \"Sound\": \"Primary sound description under 15 words\",\n    \"Status\": \"for production\"\n  }\n]\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "d8c29c02-f396-4150-aa2c-550d7b123f9e",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          1500,
          220
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "minutes",
                "minutesInterval": 30
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "f2e85826-3416-4a1e-8f26-5a8538087174",
        "name": "Parser2",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2900,
          440
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"Idea\": \"An obsidian rock being sliced with a shimmering knife\",\n  \"Environment\": \"Clean studio table, subtle light reflections\",\n  \"Sound\": \"Crisp slicing, deep grinding, and delicate crumbling\",\n  \"Scene 1\": \"Extreme macro shot: a razor-sharp, polished knife blade presses into the dark, granular surface of an obsidian rock, just beginning to indent.\",\n  \"Scene 2\": \"Close-up: fine, iridescent dust particles erupt from the point of contact as the blade cuts deeper into the obsidian, catching the studio light.\",\n  \"Scene 3\": \"Mid-shot: the knife, held perfectly steady, has formed a shallow, clean groove across the obsidian's shimmering surface, revealing a new, smooth texture.\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "790aee60-38b8-4939-834c-bd468b0f240b",
        "name": "Create Clips",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3260,
          220
        ],
        "parameters": {
          "url": "https://api.wavespeed.ai/api/v3/bytedance/seedance-v1-lite-t2v-480p",
          "body": "={\n  \"aspect_ratio\": \"9:16\",\n  \"duration\": 10,\n  \"prompt\": \"VIDEO THEME: {{ $('Prompts AI Agent').item.json.output.Idea }} | WHAT HAPPENS IN THE VIDEO: {{ $json.description }} | WHERE THE VIDEO IS SHOT: {{ $('Prompts AI Agent').item.json.output.Environment }}\"\n}\n",
          "method": "POST",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 3000
              }
            }
          },
          "sendBody": true,
          "contentType": "raw",
          "authentication": "genericCredentialType",
          "rawContentType": "application/json",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {},
        "typeVersion": 4.2
      },
      {
        "id": "ba98805d-7d8b-476e-86b3-94017f79454b",
        "name": "Wait for Clips",
        "type": "n8n-nodes-base.wait",
        "position": [
          3480,
          220
        ],
        "parameters": {
          "amount": 120
        },
        "typeVersion": 1.1
      },
      {
        "id": "7fc24bd4-8740-4633-b15a-868ff3cdacf5",
        "name": "Get Clips",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3780,
          220
        ],
        "parameters": {
          "url": "=https://api.wavespeed.ai/api/v3/predictions/{{ $json.data.id }}/result",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {},
        "typeVersion": 4.2
      },
      {
        "id": "614d8a4b-1319-4c0a-9b52-de284c232a6d",
        "name": "Download Final Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          4120,
          820
        ],
        "parameters": {
          "url": "={{ $('Get Final Video').item.json.video_url }}",
          "options": {
            "response": {
              "response": "file"
            }
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f916f4e9-9634-4863-bdb9-b56e3401165e",
        "name": "Upload to YouTube",
        "type": "n8n-nodes-base.youTube",
        "position": [
          4320,
          820
        ],
        "parameters": {
          "title": "=AI ASMR : {{ $('Update Final Video to Sheet').item.json.idea }}",
          "options": {
            "tags": "=asmr, viral, asmrai, n8n, automation",
            "description": "=AI-Generated Video Idea: {{ $('Update Final Video to Sheet').item.json.idea }}\n\nThis video was created automatically using our automated workflow #asmrai #asmr #n8n",
            "privacyStatus": "public",
            "notifySubscribers": true
          },
          "resource": "video",
          "operation": "upload"
        },
        "credentials": {
          "youTubeOAuth2Api": {}
        },
        "typeVersion": 1
      },
      {
        "id": "f9c33085-e6e4-41c9-a463-62cb52c6e71c",
        "name": "Telegram Notification",
        "type": "n8n-nodes-base.telegram",
        "position": [
          4600,
          820
        ],
        "parameters": {
          "text": "=✅ Your new video is ready!  **Title:** {{ $('Update Final Video to Sheet').item.json.idea }}  \nWatch it here: \nhttps://www.youtube.com/watch?v={{ $('Upload to YouTube').item.json.id }}",
          "chatId": "YOUR_CHAT_ID",
          "additionalFields": {
            "parse_mode": "HTML"
          }
        },
        "credentials": {
          "telegramApi": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "acbdb550-278a-4f0a-a3c2-b3f1e9183dec",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1800,
          420
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1"
          }
        },
        "credentials": {
          "openAiApi": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "708c4602-2d5c-49f1-84a8-3117a83ce2cc",
        "name": "Gmail Notification",
        "type": "n8n-nodes-base.gmail",
        "position": [
          4600,
          1000
        ],
        "parameters": {
          "sendTo": "your-email@gmail.com",
          "message": "=✅ Your new video is ready!  **Title:** {{ $('Update Final Video to Sheet').item.json.idea }}  Watch it here: https://www.youtube.com/watch?v={{ $('Upload to YouTube').item.json.id }}",
          "options": {
            "senderName": "Bilsimaging -n8n Automation"
          },
          "subject": "✅ Your new video is ready!"
        },
        "credentials": {
          "gmailOAuth2": {}
        },
        "typeVersion": 2.1
      },
      {
        "id": "86188a74-2ca4-4e15-a151-f5a2ae927763",
        "name": "1. Generate Trendy Idea",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1800,
          220
        ],
        "parameters": {
          "text": "Generate one short, trendy, and viral ASMR video idea. Describe the core concept in less than 10 words. Do not explain it, just state the idea.",
          "options": {
            "systemMessage": "You are an AI that specializes in identifying viral trends on platforms like TikTok and YouTube Shorts. Your job is to brainstorm a single, simple, and satisfying ASMR video concept. You must only return the idea as a single line of plain text. Do not add any extra words, formatting, or explanation."
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "2d8da7d8-c7a0-48b6-b999-59832b543e91",
        "name": "Note: AI Ideation",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1520,
          0
        ],
        "parameters": {
          "color": 3,
          "width": 940,
          "height": 180,
          "content": "### Step 1: AI Brainstorms an Idea\nThis workflow starts with a Schedule Trigger. The first AI agent generates a simple, trendy ASMR concept. The second agent expands this into a full production plan (caption, environment, etc.)."
        },
        "typeVersion": 1
      },
      {
        "id": "692c4c92-7d16-482f-8bca-cc951ab772e4",
        "name": "Note: Asset Generation",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2560,
          0
        ],
        "parameters": {
          "color": 3,
          "width": 600,
          "height": 180,
          "content": "### Step 2: Scene Generation & Video Creation\nThe plan is used to generate detailed scene descriptions. Then, we call the Wavespeed AI (Seedance) and Fal AI APIs to create the video clips and sound effects in parallel."
        },
        "typeVersion": 1
      },
      {
        "id": "211c2810-58c9-4246-ba27-561c3e57a74c",
        "name": "Note: Final Assembly",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3260,
          0
        ],
        "parameters": {
          "color": 3,
          "width": 660,
          "height": 180,
          "content": "### Step 3: Final Assembly\nThe video clips are stitched together."
        },
        "typeVersion": 1
      },
      {
        "id": "c76e5236-b71b-4705-b30c-89d5ae5dd0f5",
        "name": "Note: Distribution",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          4040,
          0
        ],
        "parameters": {
          "color": 3,
          "width": 960,
          "height": 180,
          "content": "### Step 4: Distribution & Logging\nThe final video is uploaded to YouTube, the Google Sheet is updated, and notifications are sent."
        },
        "typeVersion": 1
      },
      {
        "id": "57e8010f-7184-4d88-84fd-d2b85782a09b",
        "name": "SUBMISSION GUIDE",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "width": 1320,
          "height": 1240,
          "content": "//ASMR AI Workflow By Bilsimaging.com\n### How It Works\n\nThis workflow is a fully autonomous content factory that creates and publishes satisfying ASMR-style YouTube Shorts without any human intervention. It's a powerful example of chaining multiple AI services together to generate unique media.\n\nThe process runs in four main stages:\n\n1.  **AI Ideation:** A schedule trigger kicks off the workflow. The first AI agent brainstorms a simple, trendy ASMR concept. A second agent then enriches this concept into a detailed JSON production plan, including a viral-style caption, environment description, and sound profile.\n\n2.  **Asset Generation:** The workflow generates detailed scene-by-scene prompts. It then calls the ByteDance Seedance API (via Wavespeed) to create the video clips and the Fal AI API to generate corresponding sound effects.\n\n3.  **Final Assembly:** The clips are sequenced into a final video. \n\n4.  **Distribution & Logging:** The final video is downloaded, uploaded to a designated YouTube channel, the original row in a Google Sheet is updated with the new YouTube link and a \"Done\" status, and notifications are sent via Telegram and Gmail.\n\n### Set Up Steps\n\nThis is an advanced workflow that requires several credentials. \n\nYou will need to create credentials for the following services:\n\n*   **OpenAI:** For the AI agents.\n*   **Wavespeed AI:** For the Seedance video model.\n*   **Fal AI:** For sound generation and video sequencing.\n*   **Google OAuth:** For both the Google Sheets and YouTube nodes. You will need to enable the Google Sheets API and YouTube Data API v3 in your Google Cloud project.\n*   **Telegram Bot:** For the final notification.\n*   **Gmail (Optional):** If you want email notifications.\n\nYou will also need to create a **Google Sheet** to log the ideas and final outputs. A template can be easily created with columns for `id`, `idea`, `caption`, `production_status`, `environment_prompt`, `sound_prompt`, `final_output`, and `youtube_url`.\n\n### Features\n\n*   **Fully Autonomous Content Creation:** Runs on a schedule to generate and publish content without any manual input.\n*   **Two-Stage AI Ideation:** Uses a \"creative\" AI and a \"planning\" AI to produce more dynamic and well-structured ideas.\n*   **Multi-Modal AI:** Chains together text-to-text, text-to-video, and text-to-audio models in a single, cohesive flow.\n*   **Closed-Loop System:** Logs the initial idea to a Google Sheet and updates the *same row* with the final links and status, creating a perfect production log.\n*   **Spreadsheet as a CMS:** Manage your entire content pipeline from a simple Google Sheet.\n*   **Real-time Notifications:** Get immediate alerts on Telegram or Gmail as soon as a new video is live.\n\n### Pro-Tips & How to Handle APIs\n\n*   **API Rate Limits:** If you run the workflow very frequently, some APIs might temporarily block you. To avoid this, you can adjust the **Schedule Trigger** to run less often (e.g., every 30 minutes instead of every 10). For more advanced control, you can add a `batchInterval` in the settings of the HTTP Request nodes.\n\n\n*   **Cost Management:** Remember that AI API calls cost money. It is highly recommended to set up **budget alerts** in your OpenAI, Fal AI, and Wavespeed AI account dashboards to avoid any surprise bills.\n\n*   **Customization:** The creative core of this workflow is in the **Prompts AI Agent** and **Enrich Idea into Plan** nodes. To change the style, tone, or type of videos created, simply edit the `systemMessage` in the options of these nodes.\n\nFor any help or tips on handling the APIs, don't hesitate to contact me at **bilsimaging@gmail.com**."
        },
        "typeVersion": 1
      },
      {
        "id": "62e10519-d31e-4012-8dcf-7e2e82ab35cd",
        "name": "2. Enrich Idea into Plan",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2200,
          220
        ],
        "parameters": {
          "text": "=Take the following trendy ASMR idea and expand it into a full production plan using your required JSON format. Use the examples below for inspiration on how to format the \"Idea\" field.\n\nThe short ASMR idea is:\n[[\n{{ $json.output }}\n]]\n\nHave your final expanded \"Idea\" field be in this format: \"(color/style) (object) being (action)\". \nExamples for your inspiration: layered rainbow kinetic sand being sliced, sparkly purple soap being scooped, neon green slime being pressed.\n\nUse the Think tool to review your output.",
          "options": {
            "systemMessage": "=**Role**: You are an AI designed to generate 1 immersive, satisfying idea based on a user-provided topic. Your output must be formatted as a JSON array (single line) and follow all the rules below exactly.\n\n***\nRULES:\n\nOnly return 1 idea at a time.\n\nThe user will provide a key topic (e.g. \"kinetic sand slicing,\" \"satisfying sand scooping,\" \"ASMR sand sounds\").\n\nThe Idea must:\n\nBe under 13 words.\n\nDescribe an interesting and viral-worthy moment, action, or event related to the provided topic.\n\nThe Caption must be:\n\nShort, punchy, and viral-friendly.\n\nInclude one relevant emoji.\n\nInclude exactly 12 hashtags in this order:\n** 4 topic-relevant hashtags\n** 4 all-time most popular hashtags\n** 4 currently trending hashtags\n\nAll hashtags must be lowercase.\n\nSet Status to \"for production\" (always).\n\nThe Environment must:\n\nBe under 20 words.\n\nMatch the action in the Idea exactly.\n\nClearly describe:\n\nWhere the event is happening (e.g. minimalist white surface, clean studio table)\nKey visuals or background details (e.g. bright lighting, subtle glitter)\nStyle of scene (e.g. macro close-up, cinematic slow-motion)\n\nThe Sound must:\n\nBe under 15 words.\n\nDescribe the primary sound that makes sense to happen in the video. This will be fed to a sound model later on.\n\n\n***\nOUTPUT FORMAT (single-line JSON array):\n\n[\n  {\n    \"Caption\": \"That crunch! 🤤 #kineticsand #satisfyingvideos #asmrsand #sand #oddlysatisfying #viral #fyp #explore #trending #tiktok #diy #crafts\",\n    \"Idea\": \"Slicing through a block of layered rainbow kinetic sand\",\n    \"Environment\": \"Macro close-up on a clean, bright white surface, cinematic slow-motion\",\n    \"Sound\": \"Crisp, crunchy slicing sounds with a soft, gentle hiss\",\n    \"Status\": \"for production\"\n  }\n]"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "06ccc97f-aa87-4c64-860b-0da4739d3de5",
        "name": "3. Log New Idea to Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2560,
          220
        ],
        "parameters": {
          "columns": {
            "value": {
              "idea": "={{ $json.output[0].Idea }}",
              "caption": "={{ $json.output[0].Caption }}",
              "production": "In Progress",
              "sound_prompt": "={{ $json.output[0].Sound }}",
              "environment_prompt": "={{ $json.output[0].Environment }}"
            },
            "mappingMode": "defineBelow"
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "value": "YOUR_SHEET_NAME"
          },
          "documentId": {
            "__rl": true,
            "value": "YOUR_GOOGLE_SHEET_ID"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {}
        },
        "typeVersion": 4.5
      },
      {
        "id": "58b1f682-2752-4995-b05e-7598353d7a61",
        "name": "Update Final Video to Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          4120,
          640
        ],
        "parameters": {
          "key": "idea",
          "value": "={{ $('Update Final Video to Sheet').item.json.idea }}",
          "columns": {
            "value": {
              "production": "Done",
              "youtube_url": "=",
              "final_output": "={{ $json.video_url }}"
            },
            "mappingMode": "defineBelow"
          },
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "value": "YOUR_SHEET_NAME"
          },
          "documentId": {
            "__rl": true,
            "value": "YOUR_GOOGLE_SHEET_ID"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {}
        },
        "typeVersion": 4.5
      },
      {
        "id": "fbf64920-6e9c-4dfa-b75a-bbf022ea597b",
        "name": "Update Sheet with Youtube Link",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          4600,
          640
        ],
        "parameters": {
          "key": "idea",
          "value": "={{ $('Update Final Video to Sheet').item.json.idea }}",
          "columns": {
            "value": {
              "youtube_url": "=https://www.youtube.com/watch?v={{ $('Upload to YouTube').item.json.id }}"
            },
            "mappingMode": "defineBelow"
          },
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "value": "YOUR_SHEET_NAME"
          },
          "documentId": {
            "__rl": true,
            "value": "YOUR_GOOGLE_SHEET_ID"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {}
        },
        "typeVersion": 4.5
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "final_submission_v1",
    "connections": {
      "Think": {
        "ai_tool": [
          [
            {
              "node": "2. Enrich Idea into Plan",
              "type": "ai_tool",
              "index": 0
            },
            {
              "node": "Prompts AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Parser": {
        "ai_outputParser": [
          [
            {
              "node": "2. Enrich Idea into Plan",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Parser2": {
        "ai_outputParser": [
          [
            {
              "node": "Prompts AI Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Get Clips": {
        "main": [
          [
            {
              "node": "Create Sounds",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Sounds": {
        "main": [
          [
            {
              "node": "List Elements",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Clips": {
        "main": [
          [
            {
              "node": "Wait for Clips",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Sounds": {
        "main": [
          [
            {
              "node": "Wait for Sounds",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Elements": {
        "main": [
          [
            {
              "node": "Sequence Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Sequence Video": {
        "main": [
          [
            {
              "node": "Wait for Final Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Clips": {
        "main": [
          [
            {
              "node": "Get Clips",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Final Video": {
        "main": [
          [
            {
              "node": "Update Final Video to Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Sounds": {
        "main": [
          [
            {
              "node": "Get Sounds",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prompts AI Agent": {
        "main": [
          [
            {
              "node": "Unbundle Prompts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "1. Generate Trendy Idea",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Unbundle Prompts": {
        "main": [
          [
            {
              "node": "Create Clips",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "2. Enrich Idea into Plan",
              "type": "ai_languageModel",
              "index": 0
            },
            {
              "node": "Prompts AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Upload to YouTube": {
        "main": [
          [
            {
              "node": "Gmail Notification",
              "type": "main",
              "index": 0
            },
            {
              "node": "Telegram Notification",
              "type": "main",
              "index": 0
            },
            {
              "node": "Update Sheet with Youtube Link",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "1. Generate Trendy Idea",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Download Final Video": {
        "main": [
          [
            {
              "node": "Upload to YouTube",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Final Video": {
        "main": [
          [
            {
              "node": "Get Final Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "1. Generate Trendy Idea": {
        "main": [
          [
            {
              "node": "2. Enrich Idea into Plan",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "2. Enrich Idea into Plan": {
        "main": [
          [
            {
              "node": "3. Log New Idea to Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "3. Log New Idea to Sheet": {
        "main": [
          [
            {
              "node": "Prompts AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Final Video to Sheet": {
        "main": [
          [
            {
              "node": "Download Final Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "67d4d33d8b0ad4e5e12f051d8ad92fc35893d7f48d7f801bc6da4f39967b3592",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "22c8d63b-ce3c-4aab-b3f6-4bae8c1b9ec5",
        "name": "Window Buffer Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          1460,
          880
        ],
        "parameters": {
          "sessionKey": "={{ $json.sessionId }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 20
        },
        "typeVersion": 1.2
      },
      {
        "id": "45403d5c-6e85-424f-b40b-c6214b57457b",
        "name": "Respond to Webhook",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          1880,
          580
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "1111262a-1743-4bae-abf1-f69d2e1a580c",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1360,
          760
        ],
        "parameters": {
          "model": "gpt-4o-2024-08-06",
          "options": {
            "temperature": 0.4
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "XWFTuTtx9oWglhNn",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "df891547-c715-4dc6-bfcc-c0ac5cfcaf02",
        "name": "Make Appointment",
        "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
        "position": [
          1820,
          840
        ],
        "parameters": {
          "url": "https://graph.microsoft.com/v1.0/me/events",
          "method": "POST",
          "jsonBody": "{\n  \"subject\": \"Meetings with <name> at <company>\",\n  \"start\": {\n    \"dateTime\": \"{dateStartTime}\",\n    \"timeZone\": \"Europe/London\"\n  },\n  \"end\": {\n    \"dateTime\": \"{dateEndTime}\",\n    \"timeZone\": \"Europe/London\"\n  },\n  \"body\": {\n    \"contentType\": \"HTML\",\n    \"content\": \"{reason}\"\n  },\n  \"attendees\": [\n    {\n      \"emailAddress\": {\n        \"address\": \"{email}\",\n        \"name\": \"{name}\"\n      },\n      \"type\": \"required\"\n    }\n  ],\n  \"location\": {\n    \"displayName\": \"Online Meeting\"\n  },\n  \"isOnlineMeeting\": true,\n  \"onlineMeetingProvider\": \"teamsForBusiness\",\n  \"showAs\": \"busy\",\n  \"categories\": [\n    \"Meeting\"\n  ]\n}",
          "sendBody": true,
          "sendQuery": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "parametersQuery": {
            "values": [
              {
                "name": "Content-Type",
                "value": "application/json",
                "valueProvider": "fieldValue"
              }
            ]
          },
          "toolDescription": "Call this tool to make the appointment, ensure you send the user email, name, company, reason for the meeting and the appointment start time and the date in ISO String format with timezone for <timezone>. When creating an appointment, always send JSON.",
          "nodeCredentialType": "microsoftOutlookOAuth2Api",
          "placeholderDefinitions": {
            "values": [
              {
                "name": "dateStartTime",
                "type": "string",
                "description": "The date and start time of the appointment in toISOString format with timezone for Europe/London"
              },
              {
                "name": "dateEndTime",
                "type": "string",
                "description": "The date and end time of the appointment in toISOString format, always 30 minutes after the dateStartTime,  format with timezone for Europe/London"
              },
              {
                "name": "reason",
                "type": "string",
                "description": "Detailed description of the meeting, will be sent to us and the customer"
              },
              {
                "name": "email",
                "type": "string",
                "description": "The customers email address."
              },
              {
                "name": "name",
                "type": "string",
                "description": "The customers full name, must be second and last name"
              }
            ]
          }
        },
        "credentials": {
          "microsoftOutlookOAuth2Api": {
            "id": "E0WY3yUNKgrxIwLU",
            "name": "Microsoft Outlook Business"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "44141c44-de49-4707-b287-24007c84ca21",
        "name": "Execute Workflow Trigger",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          2160,
          580
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "795e1451-57d8-4563-8b86-5a75df2427b6",
        "name": "varResponse",
        "type": "n8n-nodes-base.set",
        "position": [
          3120,
          460
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "c0b6e779-0f7b-41f0-81f8-457f2b31ccfe",
                "name": "response",
                "type": "array",
                "value": "={{ $json.freeTimeSlots.toJsonString() }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "4283635f-649c-4cc7-84b9-37524ddb6ce0",
        "name": "freeTimeSlots",
        "type": "n8n-nodes-base.code",
        "position": [
          2900,
          460
        ],
        "parameters": {
          "jsCode": "// Input: An array with objects containing a 'value' array of events.\nconst businessHoursStart = \"08:00:00Z\";  // Business hours start time\nconst businessHoursEnd = \"17:30:00Z\";    // Business hours end time\n\nconst inputData = items[0].json.value;  // Assuming the input data is in the 'value' array of the first item\n\n// Function to convert ISO datetime string to a Date object with specified time\nfunction getDateWithTime(dateString, time) {\n  const datePart = new Date(dateString).toISOString().split(\"T\")[0];  // Extract the date part (YYYY-MM-DD)\n  return new Date(`${datePart}T${time}`);\n}\n\n// Function to get day of the week from a date string\nfunction getDayOfWeek(dateString) {\n  const daysOfWeek = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n  return daysOfWeek[new Date(dateString).getUTCDay()];\n}\n\n// Function to add days to a date\nfunction addDays(date, days) {\n  const result = new Date(date);\n  result.setDate(result.getDate() + days);\n  return result;\n}\n\n// Function to format date as YYYY-MM-DD\nfunction formatDate(date) {\n  return date.toISOString().split('T')[0];\n}\n\n// Determine the default timezone from input data\nconst defaultTimeZone = inputData.length > 0 && inputData[0].start && inputData[0].start.timeZone \n  ? inputData[0].start.timeZone \n  : \"UTC\";\n\n// Find min and max dates in the input\nlet minDate = null;\nlet maxDate = null;\n\ninputData.forEach(event => {\n  if (event.start && event.start.dateTime) {\n    const eventDate = new Date(event.start.dateTime);\n    if (!minDate || eventDate < minDate) {\n      minDate = eventDate;\n    }\n    if (!maxDate || eventDate > maxDate) {\n      maxDate = eventDate;\n    }\n  }\n});\n\n// If we have valid dates, ensure they're at the start of the day\nif (minDate && maxDate) {\n  minDate = new Date(minDate.toISOString().split('T')[0]);\n  maxDate = new Date(maxDate.toISOString().split('T')[0]);\n}\n\n// Organise events by date\nconst eventsByDate = {};\ninputData.forEach(event => {\n  if (event.start && event.start.dateTime) {\n    const eventDate = new Date(event.start.dateTime).toISOString().split(\"T\")[0];  // Extract the date\n    if (!eventsByDate[eventDate]) {\n      eventsByDate[eventDate] = [];\n    }\n    if (event.showAs === \"busy\") {\n      eventsByDate[eventDate].push({\n        start: new Date(event.start.dateTime),\n        end: new Date(event.end.dateTime),\n        timeZone: event.start.timeZone || defaultTimeZone\n      });\n    }\n  }\n});\n\n// Find free slots within business hours for each date\nconst freeTimeSlots = [];\n\n// Process all dates in the range\nif (minDate && maxDate) {\n  for (let currentDate = new Date(minDate); currentDate <= maxDate; currentDate = addDays(currentDate, 1)) {\n    const dateStr = formatDate(currentDate);\n    const busyEvents = eventsByDate[dateStr] || [];\n    \n    // Define business start and end times for the current date\n    const businessStart = getDateWithTime(dateStr, businessHoursStart);\n    const businessEnd = getDateWithTime(dateStr, businessHoursEnd);\n    \n    // If there are no busy events for this date, add the entire business day as free\n    if (busyEvents.length === 0) {\n      freeTimeSlots.push({\n        date: dateStr,\n        dayOfWeek: getDayOfWeek(dateStr),\n        freeStart: businessStart.toISOString(),\n        freeEnd: businessEnd.toISOString(),\n        timeZone: defaultTimeZone\n      });\n      continue; // Skip to the next date\n    }\n    \n    // Sort events by their start time\n    busyEvents.sort((a, b) => a.start - b.start);\n    \n    // Check if there's free time before the first busy event\n    if (busyEvents[0].start > businessStart) {\n      freeTimeSlots.push({\n        date: dateStr,\n        dayOfWeek: getDayOfWeek(dateStr),\n        freeStart: businessStart.toISOString(),\n        freeEnd: busyEvents[0].start.toISOString(),\n        timeZone: busyEvents[0].timeZone\n      });\n    }\n    \n    // Check for gaps between busy events\n    for (let i = 0; i < busyEvents.length - 1; i++) {\n      if (busyEvents[i].end < busyEvents[i+1].start) {\n        freeTimeSlots.push({\n          date: dateStr,\n          dayOfWeek: getDayOfWeek(dateStr),\n          freeStart: busyEvents[i].end.toISOString(),\n          freeEnd: busyEvents[i+1].start.toISOString(),\n          timeZone: busyEvents[i].timeZone\n        });\n      }\n    }\n    \n    // Check if there's free time after the last busy event\n    if (busyEvents[busyEvents.length - 1].end < businessEnd) {\n      freeTimeSlots.push({\n        date: dateStr,\n        dayOfWeek: getDayOfWeek(dateStr),\n        freeStart: busyEvents[busyEvents.length - 1].end.toISOString(),\n        freeEnd: businessEnd.toISOString(),\n        timeZone: busyEvents[busyEvents.length - 1].timeZone\n      });\n    }\n  }\n}\n\n// Output the free time slots\nreturn [{ json: { freeTimeSlots } }];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "0786b561-449e-4c8f-bddb-c2bbd95dc197",
        "name": "Get Events",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2680,
          460
        ],
        "parameters": {
          "url": "=https://graph.microsoft.com/v1.0/me/calendarView",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "startDateTime",
                "value": "={{ new Date(new Date().setDate(new Date().getDate() + 2)).toISOString() }}"
              },
              {
                "name": "endDateTime",
                "value": "={{ new Date(new Date().setDate(new Date().getDate() + 16)).toISOString() }}"
              },
              {
                "name": "$top",
                "value": "50"
              },
              {
                "name": "select",
                "value": "start,end,categories,importance,isAllDay,recurrence,showAs,subject,type"
              },
              {
                "name": "orderby",
                "value": "start/dateTime asc"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Prefer",
                "value": "outlook.timezone=\"Europe/London\""
              }
            ]
          },
          "nodeCredentialType": "microsoftOutlookOAuth2Api"
        },
        "credentials": {
          "microsoftOutlookOAuth2Api": {
            "id": "E0WY3yUNKgrxIwLU",
            "name": "Microsoft Outlook Business"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "55c4233e-d395-4193-9a1d-1884faed6f1e",
        "name": "Get Availability",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          1760,
          1080
        ],
        "parameters": {
          "name": "Get_availability",
          "fields": {
            "values": [
              {
                "name": "route",
                "stringValue": "availability"
              }
            ]
          },
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "KD21RG8VeXYDS2Vf",
            "cachedResultName": "Website Chatbot"
          },
          "description": "Call this tool to check my calendar for availability before booking an appointment. This will result in all events for the next 2 weeks. Review all events and do not double book."
        },
        "typeVersion": 1.2
      },
      {
        "id": "096d1962-31e6-4b3b-ba75-7956f70a6a32",
        "name": "Send Message",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          1620,
          1080
        ],
        "parameters": {
          "name": "Send_email",
          "fields": {
            "values": [
              {
                "name": "route",
                "stringValue": "message"
              }
            ]
          },
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "KD21RG8VeXYDS2Vf",
            "cachedResultName": "Website Chatbot"
          },
          "description": "Call this tool when the customer wants to speak to a human, or is not ready to make an appointment or if the customer has questions outside of your remit. The tool will send an email to our founder, <insert name>. Always send the customer's full name, company and email address along with a detailed message about the enquiry. You must always gather project details.",
          "jsonSchemaExample": "{\n\t\"email\": \"the customer's email\",\n    \"subject\": \"the subject of the email\",\n    \"message\": \"The customer's enquiry, must be a detailed description of their enquiry\",\n    \"name\": \"the customer's full name\",\n    \"company\": \"the customer company name\"\n}",
          "specifyInputSchema": true
        },
        "typeVersion": 1.2
      },
      {
        "id": "285ddd31-5412-4d1c-ab80-d9960ec902bb",
        "name": "Chat Trigger",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "disabled": true,
        "position": [
          620,
          600
        ],
        "webhookId": "f406671e-c954-4691-b39a-66c90aa2f103",
        "parameters": {
          "mode": "webhook",
          "public": true,
          "options": {
            "responseMode": "responseNode",
            "allowedOrigins": "*"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "032a26e9-6853-490d-991b-b2af2d845f58",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          2380,
          580
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "availability",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.route }}",
                      "rightValue": "availability"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "message",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "52fd844b-cc8d-471f-a56a-40e119b66194",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.route }}",
                      "rightValue": "message"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "c74905ce-4fd9-486c-abc4-b0b1d57d71a8",
        "name": "varMessageResponse",
        "type": "n8n-nodes-base.set",
        "position": [
          2900,
          700
        ],
        "parameters": {
          "options": {
            "ignoreConversionErrors": false
          },
          "assignments": {
            "assignments": [
              {
                "id": "0d2ad084-9707-4979-84e4-297d1c21f725",
                "name": "response",
                "type": "string",
                "value": "={{ $json }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "04c5d43c-1629-4e11-a6bb-ae73369d7002",
        "name": "Send Message1",
        "type": "n8n-nodes-base.microsoftOutlook",
        "position": [
          2680,
          700
        ],
        "webhookId": "d8acc2cb-fcba-4312-a743-e74abe76d071",
        "parameters": {
          "subject": "={{ $('Execute Workflow Trigger').item.json.query.subject }}",
          "bodyContent": "=<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>New Webchat Customer Enquiry</title>\n    <style type=\"text/css\">\n        /* Client-specific styles */\n        body, table, td, a { -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; }\n        table, td { mso-table-lspace: 0pt; mso-table-rspace: 0pt; }\n        img { -ms-interpolation-mode: bicubic; }\n\n        /* Reset styles */\n        body { margin: 0; padding: 0; }\n        img { border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; }\n        table { border-collapse: collapse !important; }\n        body { height: 100% !important; margin: 0; padding: 0; width: 100% !important; }\n\n        /* iOS BLUE LINKS */\n        a[x-apple-data-detectors] {\n            color: inherit !important;\n            text-decoration: none !important;\n            font-size: inherit !important;\n            font-family: inherit !important;\n            font-weight: inherit !important;\n            line-height: inherit !important;\n        }\n\n        /* Styles for Outlook and other email clients */\n        .ExternalClass { width: 100%; }\n        .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div { line-height: 100%; }\n        \n        /* Responsive styles */\n        @media screen and (max-width: 600px) {\n            .container { width: 100% !important; }\n            .content { padding: 15px !important; }\n            .field { padding: 10px !important; }\n            .header h1 { font-size: 20px !important; }\n            .header p { font-size: 12px !important; }\n        }\n    </style>\n</head>\n<body style=\"margin: 0; padding: 0; background-color: #f4f4f4;\">\n    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n        <tr>\n            <td>\n                <table align=\"center\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"600\" style=\"border-collapse: collapse; background-color: #ffffff;\">\n                    <tr>\n                        <td align=\"center\" bgcolor=\"#1a1a1a\" style=\"padding: 30px 0; background: linear-gradient(135deg, #1a1a1a 0%, #2d1f3d 100%);\">\n                            <h1 style=\"color: #ffffff; font-family: Arial, sans-serif; font-size: 24px; font-weight: 700; margin: 0; text-transform: uppercase; letter-spacing: 1px;\">New Customer Enquiry</h1>\n                            <p style=\"color: #ffffff; font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; margin: 10px 0 0; opacity: 0.8;\">A potential client has reached out through our webchat</p>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"padding: 20px;\">\n                            <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\n                                <tr>\n                                    <td style=\"padding: 15px; background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 8px;\">\n                                        <p style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6; color: #6a1b9a; font-weight: bold; margin: 0 0 5px 0;\">FROM</p>\n                                        <p style=\"font-family: Arial, sans-serif; font-size: 16px; line-height: 1.6; color: #333333; margin: 0;\">{{ $('Execute Workflow Trigger').item.json.query.name }}</p>\n                                    </td>\n                                </tr>\n                                <tr><td height=\"20\"></td></tr>\n                                <tr>\n                                    <td style=\"padding: 15px; background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 8px;\">\n                                        <p style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6; color: #6a1b9a; font-weight: bold; margin: 0 0 5px 0;\">EMAIL</p>\n                                        <p style=\"font-family: Arial, sans-serif; font-size: 16px; line-height: 1.6; color: #333333; margin: 0;\">{{ $('Execute Workflow Trigger').item.json.query.email }}</p>\n                                    </td>\n                                </tr>\n                                <tr><td height=\"20\"></td></tr>\n                                <tr>\n                                    <td style=\"padding: 15px; background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 8px;\">\n                                        <p style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6; color: #6a1b9a; font-weight: bold; margin: 0 0 5px 0;\">COMPANY</p>\n                                        <p style=\"font-family: Arial, sans-serif; font-size: 16px; line-height: 1.6; color: #333333; margin: 0;\">{{ $('Execute Workflow Trigger').item.json.query.company }}</p>\n                                    </td>\n                                </tr>\n                                <tr><td height=\"20\"></td></tr>\n                                <tr>\n                                    <td style=\"padding: 15px; background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 8px;\">\n                                        <p style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6; color: #6a1b9a; font-weight: bold; margin: 0 0 5px 0;\">MESSAGE</p>\n                                        <p style=\"font-family: Arial, sans-serif; font-size: 16px; line-height: 1.6; color: #333333; margin: 0;\">{{ $('Execute Workflow Trigger').item.json.query.message }}</p>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"center\" bgcolor=\"#e90ebb\" style=\"padding: 20px; background: linear-gradient(135deg, #e90ebb 0%, #6a1b9a 100%);\">\n                            <p style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 20px; color: #ffffff; margin: 0;\">This enquiry was automatically generated from our website's chat interface.</p>\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n</body>\n</html>",
          "toRecipients": "you@yourdomain.com",
          "additionalFields": {
            "importance": "High",
            "bodyContentType": "html"
          }
        },
        "credentials": {
          "microsoftOutlookOAuth2Api": {
            "id": "E0WY3yUNKgrxIwLU",
            "name": "Microsoft Outlook Business"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "5a2636f1-47d3-4421-840b-56553bf14d82",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1580,
          1000
        ],
        "parameters": {
          "width": 311.6936390497898,
          "height": 205.34013605442183,
          "content": "Ensure these referance this workflow, replace placeholders"
        },
        "typeVersion": 1
      },
      {
        "id": "a9fe05d4-6b86-4313-9f11-b20e3ce7db89",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2600,
          380
        ],
        "parameters": {
          "width": 468,
          "height": 238,
          "content": "modify business hours\nmodify timezones"
        },
        "typeVersion": 1
      },
      {
        "id": "5dfda5c9-eeeb-421a-a80d-f42c94602080",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1460,
          580
        ],
        "parameters": {
          "text": "={{ $json.chatInput }}",
          "options": {
            "systemMessage": "=You are an intelligent personal assistant to Wayne, Founder at nocodecreative.io (ai consultancy and software development agency) responsible for coordinating appointments and gathering relevant information from customers. Your tasks are to:\n\n- Understand when the customer is available by asking for suitable days and times (ensuring they are aware we are in a UK timezone)\n- Check the calendar to identify available slots that match their preferences. Pay attention to each event's start and end time and do not double book, you will be given all events for the next 14 days\n- Ask the customer what they would like to discuss during the appointment to ensure proper preparation.\n- Get the customer's name, company name and email address to book the appointment\n- Make the conversation friendly and natural. Confirm the appointment details with the customer and let them know I’ll be ready to discuss what they’d like.\n- After you have checked the calendar, book the appointment accordingly, without double booking. Confirm the customer's timezone and adjust the appointment for EU/London.\n- If the customer isn't ready to book, you can send an email for a human to respond to, ensure you gather a detailed enquiry from the customer including contact details and project information.Ensure the message contains enough information for a human to respond, always include project details, if the customer hasn't provided project details, ask.\n- Alwways suggest an appointment before sending a message, appointment are you primary goal, message are a fall back\n\nExample questions:\n\n\"Hi there! we'd love to help arrange a time that works for us to meet. Could you let us know which days and times are best for you? We’ll check the calendar and book in a suitable slot.\"\n\n\"Could you please let us know what you’d like to discuss during the appointment? This helps us prepare in advance and make our time together as productive as possible.\"\n\n\"Before we put you in touch with a human, please can you provide more information about the project you have in mind?\" //You must gather project info at all times, even if the enquiry is about pricing/costs.\n\nIf the time the customer suggests is not available, suggest the nearest alternative appointment based on existing events, do not book an appointment outside of freeTimeSlots\n\nImportant information:\n- All appointments need 48 hours' notice from {{ \n  new Date().toLocaleString(\"en-GB\", { timeZone: \"Europe/London\", hour12: false })\n  .split(\", \")[0].split(\"/\").reverse().join(\"-\") \n  + \"T\" + new Date().toLocaleTimeString(\"en-GB\", { timeZone: \"Europe/London\", hour12: false }) + \":00.000Z\" \n}} (current date and time in the UK) // this is non-negotiable, but discuss with care and be friendly, only let the customer know this if required\n- Business hours are 8am - 6pm Monday to Friday only Europe/London timezone, ensure the customer is aware of this and help them book during UK hours, you must confirm their timezone to do this!\n- Do not book appointments on a Saturday or sunday\n- Do not book appointments outside of freeTimeSlots\n- Always check the next 14 days, and review all events before providing availability \n- All appointments are for a max of 30 minutes\n- You must never offer an appointment without checking the calendar, if you cannot check the calendar, you cannot book and must let the customer know you can not book an appointment right now.\n- Always offer the soonest appointment available if the customer's preferred time is unavailable\n- When confirming an appointment, be thankful and excited!\n- Initial 30 minute consultation are free of charge\n\n\nMessages and description:\n- When creating descriptions or sending messages, always ensure enough detail is provided for preparation, meaning you can ask follow-up questions to extract further information as required. For example, if a customer asks about pricing, gather some information about the project so our team can provide accurate pricing, and apply this logic throughout\n\nComments:\n//!IMPORTANT! Do not offer any times without checking the calendar, do not make availability up\n//**Do not discuss anything other than appointment booking, if the query does not relate to an appointment, advise them you cannot help at this time.** be friendly and always offer to book an appointment to discuss their query\n//When the appointment is confirmed, let the customer know, by name, that they will be meeting our founder, Wayne for a 30 minute consultation, and that they will receive a calendar invite by email, ensure they accept the invite to confirm the appointment.\n//Always respond as a highly professional executive PA, remember this is the customer's first engagement, they do not know us or Wayne at this stage\n//Do not refer to yourself as me or I, instead communicate like an organisation, using terms like 'us'\n//Always gather project for descriptions and messages"
          },
          "promptType": "define"
        },
        "typeVersion": 1.6
      },
      {
        "id": "6156ab7e-d411-46b9-ac44-52ad56ee563d",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          840,
          600
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "158a0b91-534d-4745-b10e-8a7c97050861",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.chatInput }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "c94171a9-a71d-4f63-bef6-e90361c57abd",
        "name": "Respond With Initial Message",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          1140,
          720
        ],
        "parameters": {
          "options": {},
          "respondWith": "json",
          "responseBody": "{\n  \"output\": \"Hi, how can I help you today?\"\n}"
        },
        "typeVersion": 1.1
      },
      {
        "id": "43129771-e976-41af-8adb-88cb5465628d",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1340,
          -240
        ],
        "parameters": {
          "color": 6,
          "width": 668,
          "height": 111,
          "content": "# Custom Branded n8n Chatbot\nBuilt by [Wayne Simpson](https://www.linkedin.com/in/simpsonwayne/) at [nocodecreative.io](https://nocodecreative.io)\n☕ If you find this useful, feel free to [buy me a coffee](https://ko-fi.com/waynesimpson)"
        },
        "typeVersion": 1
      },
      {
        "id": "bb890f44-caf0-4b7d-b95e-0c05c70e8f45",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1000,
          -80
        ],
        "parameters": {
          "color": 7,
          "width": 667,
          "height": 497,
          "content": "# Watch the Setup Video 📺\n### Watch Set Up Video 👇\n[![Auto Categorise Outlook Emails with AI](https://cdn.jsdelivr.net/gh/WayneSimpson/n8n-chatbot-template/custom-branded-chatbot.png)](https://youtu.be/xQ1tCQZhLaI)\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "f0b054cc-f961-4c48-846c-a80ea5e49924",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1700,
          -80
        ],
        "parameters": {
          "color": 7,
          "width": 600,
          "height": 500,
          "content": "## Read to blog post to get started 📝\n**Follow along to add a custom branded chat widget to your webiste**\n\n[![Custom Branded n8n Chatbot](https://cdn.jsdelivr.net/gh/WayneSimpson/n8n-chatbot-template/chat%20widget.png)](https://blog.nocodecreative.io/create-a-branded-ai-powered-website-chatbot-with-n8n/)"
        },
        "typeVersion": 1
      },
      {
        "id": "210cef85-6fbe-413e-88b6-b0fed76212ac",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2600,
          640
        ],
        "parameters": {
          "color": 4,
          "width": 260,
          "height": 240,
          "content": "Customise the email template"
        },
        "typeVersion": 1
      },
      {
        "id": "17abc6bd-06c3-48e7-8380-e10024daa9f5",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1760,
          740
        ],
        "parameters": {
          "color": 6,
          "width": 208,
          "height": 238,
          "content": "modify timezones"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {
      "Execute Workflow Trigger": [
        {
          "query": "Check availability for Monday at 9am",
          "route": "availability"
        }
      ]
    },
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Respond With Initial Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "Get Events",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send Message1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Respond to Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Events": {
        "main": [
          [
            {
              "node": "freeTimeSlots",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Chat Trigger": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Message": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Send Message1": {
        "main": [
          [
            {
              "node": "varMessageResponse",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "freeTimeSlots": {
        "main": [
          [
            {
              "node": "varResponse",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Availability": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Make Appointment": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Window Buffer Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Execute Workflow Trigger": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "Glb4VNoQI44GT0p9",
    "meta": {
      "instanceId": "a1f3364de0f3da48758a2641efb07c3b0d216a3a7cc93596fbed2316d6dea4ad",
      "templateCredsSetupCompleted": true
    },
    "name": "My workflow 4",
    "tags": [],
    "nodes": [
      {
        "id": "909a08a4-4cec-4987-9379-d4cdc2d92a53",
        "name": "RSS Feed: Times of India",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          680,
          240
        ],
        "parameters": {
          "url": "https://timesofindia.indiatimes.com/rssfeeds/-2128936835.cms",
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "471cc8ab-0074-4e25-b952-1899574398a9",
        "name": "Gmail: Fetch Emails",
        "type": "n8n-nodes-base.gmail",
        "position": [
          700,
          440
        ],
        "webhookId": "85735980-07e5-418b-b029-44bb9825ac9b",
        "parameters": {
          "filters": {},
          "operation": "getAll"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "WbGCG42FAaeECe0u",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "07a33739-0181-4ead-87bd-c1f0c3fc4999",
        "name": "TodoList: Fetch Tasks",
        "type": "n8n-nodes-base.todoist",
        "position": [
          700,
          620
        ],
        "parameters": {
          "limit": 5,
          "filters": {},
          "operation": "getAll"
        },
        "credentials": {
          "todoistApi": {
            "id": "q3NiAT93rPChns6G",
            "name": "Todoist account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "af295aad-f7e7-4d38-80e5-b79b79637b5f",
        "name": "Format Digest: Merge & Style Data",
        "type": "n8n-nodes-base.code",
        "position": [
          1280,
          440
        ],
        "parameters": {
          "jsCode": "const newsItems = $input.all().map(item => item.json);\nconst emails = $(\"Gmail: Fetch Emails\").all().map(item => item.json);\nconst tasks = $(\"TodoList: Fetch Tasks\").all().map(item => item.json);\n\n// Select top 5 items from each\nconst topNews = newsItems.slice(0, 5).map(item => ({\n  title: item.title,\n  link: item.link\n}));\n\nconst latestEmails = emails.slice(0, 5).map(item => ({\n  subject: item.Subject,\n  snippet: item.snippet\n}));\n\nconst topTasks = tasks.slice(0, 5).map(task => ({\n  content: task.content,\n  url: task.url,\n  emoji: task.emoji || '🔴',\n  due: task.due\n}));\n\n// Create the final JSON object with email subject and a formatted email body with inline CSS\nconst result = {\n  meta: {\n    generated_at: new Date().toISOString(),\n    time_emoji: \"🌞\"\n  },\n  email: {\n    subject: `🌞 Daily Digest • 📋 ${topTasks.length} Tasks ⚠️ • 📰 ${topNews.length} News Updates`,\n    body: `\n      <div style=\"max-width:600px; margin:0 auto; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color:#333; background:#f4f7f9; padding:20px; border:1px solid #e1e8ed; border-radius:8px;\">\n         <div style=\"text-align:center; padding-bottom:20px;\">\n             <h1 style=\"margin:0; font-size:28px; color:#0073e6;\">Daily Digest</h1>\n             <p style=\"margin:10px 0 0; font-size:16px; color:#666;\">Your automated daily summary</p>\n         </div>\n         <hr style=\"border:none; border-top:1px solid #ddd; margin:20px 0;\">\n         <div style=\"margin-bottom:20px;\">\n             <h2 style=\"font-size:20px; color:#0073e6; margin-bottom:10px;\">Tasks (${topTasks.length})</h2>\n             <ul style=\"list-style:none; padding:0;\">\n               ${topTasks.map(task => `\n                 <li style=\"margin-bottom:10px; padding:10px; background:#fff; border:1px solid #e1e8ed; border-radius:4px;\">\n                   <span style=\"font-size:18px; margin-right:10px;\">${task.emoji}</span> \n                   <span style=\"font-size:16px;\">${task.content}</span> \n                   <span style=\"color:#999; font-size:14px; margin-left:5px;\">(Due: ${task.due})</span>\n                   <a href=\"${task.url}\" style=\"text-decoration:none; color:#0073e6; float:right;\">View Task</a>\n                 </li>\n               `).join('')}\n             </ul>\n         </div>\n         <div style=\"margin-bottom:20px;\">\n             <h2 style=\"font-size:20px; color:#0073e6; margin-bottom:10px;\">News (${topNews.length})</h2>\n             <ul style=\"list-style:none; padding:0;\">\n               ${topNews.map(news => `\n                 <li style=\"margin-bottom:10px; padding:10px; background:#fff; border:1px solid #e1e8ed; border-radius:4px;\">\n                   <a href=\"${news.link}\" style=\"text-decoration:none; font-size:16px; color:#0073e6;\">${news.title}</a>\n                 </li>\n               `).join('')}\n             </ul>\n         </div>\n         <div style=\"margin-bottom:20px;\">\n             <h2 style=\"font-size:20px; color:#0073e6; margin-bottom:10px;\">Emails (${latestEmails.length})</h2>\n             <ul style=\"list-style:none; padding:0;\">\n               ${latestEmails.map(email => `\n                 <li style=\"margin-bottom:10px; padding:10px; background:#fff; border:1px solid #e1e8ed; border-radius:4px;\">\n                   <strong style=\"font-size:16px; color:#0073e6;\">${email.subject}</strong>\n                   <p style=\"margin:5px 0 0; font-size:14px; color:#666;\">${email.snippet}</p>\n                 </li>\n               `).join('')}\n             </ul>\n         </div>\n         <div style=\"text-align:center; font-size:12px; color:#aaa; margin-top:20px;\">\n             <p>Digest generated at: ${new Date().toLocaleString()}</p>\n         </div>\n      </div>\n    `\n  },\n  tasks: topTasks,\n  news: topNews,\n  emails: latestEmails\n};\n\nreturn [{ json: result }];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "5399bee1-d0e7-4ed7-af7f-d0ddccb00b4d",
        "name": "Gmail: Send Digest",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1540,
          440
        ],
        "webhookId": "3cd541af-51d4-465e-803d-a74572a15d83",
        "parameters": {
          "sendTo": "youremail@gmail.com",
          "message": "={{ $json.email.body }}",
          "options": {},
          "subject": "={{ $json.email.subject }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "WbGCG42FAaeECe0u",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "9f398bc2-e84c-4df4-8958-aaa1d7c2ed37",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          0,
          60
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "9984d3c0-7469-4b79-8d31-1a06b8dd23b6",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          1020,
          440
        ],
        "parameters": {
          "numberInputs": 3
        },
        "typeVersion": 3
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "550f65e6-68ec-449a-9fb5-241acba42455",
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Format Digest: Merge & Style Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "RSS Feed: Times of India",
              "type": "main",
              "index": 0
            },
            {
              "node": "Gmail: Fetch Emails",
              "type": "main",
              "index": 0
            },
            {
              "node": "TodoList: Fetch Tasks",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail: Fetch Emails": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "TodoList: Fetch Tasks": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "RSS Feed: Times of India": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Digest: Merge & Style Data": {
        "main": [
          [
            {
              "node": "Gmail: Send Digest",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "e409ea34548a2afe2dffba31130cd1cf2e98ebe2afaeed2a63caf2a0582d1da0",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "d5a76a59-a08d-4ed9-aa47-e49f01192e19",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1136,
          -48
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "1bbdea91-baef-465b-9d7a-29e3af85cdd3",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Official n8n Documentation",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -848,
          -48
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "topK": 10,
          "options": {},
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "documents",
            "cachedResultName": "documents"
          },
          "toolDescription": "Get related chunks of the official n8n documentation.",
          "includeDocumentMetadata": false
        },
        "credentials": {
          "supabaseApi": {
            "id": "xGXZD7rRAPQj61k6",
            "name": "Test"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "8c365d9c-c6f5-448d-8900-e51140056f0a",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          576,
          -1552
        ],
        "parameters": {
          "options": {},
          "jsonData": "={{ $json.documentation }}",
          "jsonMode": "expressionData",
          "textSplittingMode": "custom"
        },
        "typeVersion": 1.1
      },
      {
        "id": "345ffcae-00ad-4555-ab88-4b9c5b4e7fac",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          672,
          -1344
        ],
        "parameters": {
          "options": {
            "splitCode": "markdown"
          },
          "chunkSize": 1500,
          "chunkOverlap": 200
        },
        "typeVersion": 1
      },
      {
        "id": "42c79849-3529-471e-b355-76363791f0f5",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Remove Duplicate Documentation Content",
        "type": "n8n-nodes-base.removeDuplicates",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -48,
          -1776
        ],
        "parameters": {
          "options": {
            "scope": "node",
            "historySize": 10000
          },
          "operation": "removeItemsSeenInPreviousExecutions",
          "dedupeValue": "={{ $json.documentation }}"
        },
        "typeVersion": 2
      },
      {
        "id": "3e914e61-6eb1-4570-83ca-89987b32bbcd",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Only Keep Doc Paths",
        "type": "n8n-nodes-base.filter",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          80,
          -2544
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "52b8b89a-30cd-4a0d-a428-e5d341bcebbf",
                "operator": {
                  "type": "string",
                  "operation": "endsWith"
                },
                "leftValue": "={{ $json.link }}",
                "rightValue": "/"
              },
              {
                "id": "d8019c4e-e1a1-43ec-93a8-dac3d8c083b6",
                "operator": {
                  "type": "string",
                  "operation": "notStartsWith"
                },
                "leftValue": "={{ $json.link }}",
                "rightValue": "https://"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "648fc609-500b-49cb-b1a2-a3d531e04ed9",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Clean Documentation",
        "type": "n8n-nodes-base.set",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -480,
          -1776
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "5ed964a6-5200-454c-b983-f3dc7c8c7a48",
                "name": "documentation",
                "type": "string",
                "value": "={{ $json.data.replace(/([^#\\n]+)\\s*#/g, '# $1').trim().replace(/^\\s*https?:\\/\\/\\S+\\s*/, '') }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "f2ffe790-312a-43b9-b568-398ef2ae508d",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Gemini 2.5 Flash",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1488,
          -48
        ],
        "parameters": {
          "options": {
            "temperature": 0
          }
        },
        "credentials": {
          "googlePalmApi": {
            "id": "AXawYbABK5aZbGBE",
            "name": "IA2S"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "fbda8b9a-038d-4968-b65d-a438cbfac493",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Your Supabase Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          464,
          -1776
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "documents",
            "cachedResultName": "documents"
          },
          "embeddingBatchSize": 30
        },
        "credentials": {
          "supabaseApi": {
            "id": "xGXZD7rRAPQj61k6",
            "name": "Test"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "e09949fc-205a-4a6e-ac02-038c8c8409da",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Get All n8n Documentation Links",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1072,
          -2544
        ],
        "parameters": {
          "url": "https://docs.n8n.io/",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "2bccb047-cdb0-41cd-bd23-457b3aaffc02",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Extract Links from HTML",
        "type": "n8n-nodes-base.html",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -784,
          -2544
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {
                "key": "links",
                "attribute": "href",
                "cssSelector": "a",
                "returnArray": true,
                "returnValue": "attribute"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6cbddaa0-24b2-4bff-b72f-13220065ceee",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Split Out Links",
        "type": "n8n-nodes-base.splitOut",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -448,
          -2544
        ],
        "parameters": {
          "options": {
            "destinationFieldName": "link"
          },
          "fieldToSplitOut": "links"
        },
        "typeVersion": 1
      },
      {
        "id": "75d011f4-cb3b-4f8c-8cd0-902205ea6e8b",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Remove Duplicate Links",
        "type": "n8n-nodes-base.removeDuplicates",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -144,
          -2544
        ],
        "parameters": {
          "compare": "selectedFields",
          "options": {},
          "fieldsToCompare": "link"
        },
        "typeVersion": 2
      },
      {
        "id": "2ff289f1-9fca-4b26-bd97-8748c4c0c982",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Add Documentation Page to Vector Store",
        "type": "n8n-nodes-base.executeWorkflow",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          592,
          -2512
        ],
        "parameters": {
          "options": {
            "waitForSubWorkflow": true
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          },
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "data"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          }
        },
        "typeVersion": 1.2,
        "alwaysOutputData": true
      },
      {
        "id": "602123a8-8889-4f07-a7bd-2c2f3e1f710d",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Get Documentation Page",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "onError": "continueErrorOutput",
        "position": [
          -1008,
          -1776
        ],
        "parameters": {
          "url": "=https://docs.n8n.io/{{ $json.link }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "f3d49729-da95-4676-ba77-2f1f69c03b4c",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Extract Documentation Content",
        "type": "n8n-nodes-base.html",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -704,
          -1776
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {
                "key": "data",
                "cssSelector": "article",
                "skipSelectors": "img, footer, form"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "10d376c0-d5e8-4d3e-a420-78616724f491",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2560,
          -2192
        ],
        "parameters": {
          "color": 7,
          "width": 760,
          "height": 752,
          "content": "-- Enable the pgvector extension to work with embedding vectors (REMOVE THIS LINE IF ALREADY ENABLED)\ncreate extension vector;\n\n-- Create a table to store your documents\ncreate table documents (\n  id bigserial primary key,\n  content text, -- corresponds to Document.pageContent\n  metadata jsonb, -- corresponds to Document.metadata\n  embedding vector(768) -- 768 works for Gemini embeddings, CHANGE IF OPENAI EMBEDDINGS\n);\n\n-- Create a function to search for documents\ncreate function match_documents (\n  query_embedding vector(1536),\n  match_count int default null,\n  filter jsonb DEFAULT '{}'\n) returns table (\n  id bigint,\n  content text,\n  metadata jsonb,\n  similarity float\n)\nlanguage plpgsql\nas $$\n#variable_conflict use_column\nbegin\n  return query\n  select\n    id,\n    content,\n    metadata,\n    1 - (documents.embedding <=> query_embedding) as similarity\n  from documents\n  where metadata @> filter\n  order by documents.embedding <=> query_embedding\n  limit match_count;\nend;\n$$;"
        },
        "typeVersion": 1
      },
      {
        "id": "dc7586a5-10ff-445a-add8-c385a3f19e5c",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Gemini Query Embedding",
        "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -768,
          144
        ],
        "parameters": {},
        "credentials": {
          "googlePalmApi": {
            "id": "AXawYbABK5aZbGBE",
            "name": "IA2S"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "0c699715-c6d5-4292-aa2e-cacf9f684c2f",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Gemini Chunk Embedding",
        "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          448,
          -1552
        ],
        "parameters": {},
        "credentials": {
          "googlePalmApi": {
            "id": "AXawYbABK5aZbGBE",
            "name": "IA2S"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8706ada8-8b69-4b68-aab2-c96c2b2119d0",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Keep Supabase Instance Alive",
        "type": "n8n-nodes-base.supabase",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -112,
          -896
        ],
        "parameters": {
          "limit": 1,
          "tableId": "documents",
          "operation": "getAll"
        },
        "credentials": {
          "supabaseApi": {
            "id": "xGXZD7rRAPQj61k6",
            "name": "Test"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c140b29f-6fea-456d-a2f2-de02e669f48b",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Every 6 Days",
        "type": "n8n-nodes-base.scheduleTrigger",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -336,
          -896
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "daysInterval": 6
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "1e7540da-bf42-4fcb-b3cb-37f45a532728",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1664,
          -2896
        ],
        "parameters": {
          "color": 7,
          "width": 2640,
          "height": 1760,
          "content": "## Part 1: Building the Knowledge Base (The Library)\n\n**Goal:** To read all n8n documentation, break it into small pieces, and store it in our Supabase database.\n**Action:** You only need to run this part **ONCE** by clicking the \"Execute workflow\" button on the top-left trigger.\n**Time:** This will take several minutes to complete (~15 to 20)."
        },
        "typeVersion": 1
      },
      {
        "id": "272fcc9f-887a-4b7c-a92e-212b73286230",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Loop Over Documentation Pages",
        "type": "n8n-nodes-base.splitInBatches",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          368,
          -2544
        ],
        "parameters": {
          "options": {},
          "batchSize": 10
        },
        "typeVersion": 3
      },
      {
        "id": "a620eb1b-3afa-41b2-a92c-00c0250fb62d",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2624,
          -3216
        ],
        "parameters": {
          "color": 6,
          "width": 1064,
          "height": 296,
          "content": "# Tutorial: Build an AI Expert with RAG\n\nWelcome! This workflow teaches you **RAG (Retrieval-Augmented Generation)**.\n\n**The Goal:** To create an AI chatbot that is an expert on a specific topic (the n8n docs) and *never* makes up answers.\n\n**It has two parts:**\n1.  **TOP FLOW (Indexing):** You run this once manually to build the AI's knowledge base. It reads the n8n docs and stores them in a Supabase database.\n2.  **BOTTOM FLOW (Chat):** This is the live chatbot. It retrieves relevant info from the knowledge base to answer your questions accurately."
        },
        "typeVersion": 1
      },
      {
        "id": "52b33334-f3bf-4fd0-a595-9993b5e59e45",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2624,
          -2896
        ],
        "parameters": {
          "color": 7,
          "width": 924,
          "height": 3228,
          "content": "# Workflow Setup"
        },
        "typeVersion": 1
      },
      {
        "id": "cbd4f31b-1ae0-4b9a-b479-0ac0598b829a",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "n8n Docs AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1120,
          -640
        ],
        "parameters": {
          "options": {
            "systemMessage": "=<role>\nYou are a specialized AI assistant, an expert in n8n's official documentation. Your sole mission is to help users by providing accurate and factual information extracted exclusively from this documentation. You are meticulous, factual, and never deviate from your knowledge scope.\n</role>\n\n<instructions>\n<goal>\nYour primary goal is to provide precise and factual answers to user questions about the n8n automation platform, based **exclusively** on the excerpts from the official documentation provided in the context.\n</goal>\n\n<context>\nYou operate according to a RAG (Retrieval-Augmented Generation) model. For each user question, use the appropriate tool to retrieve the necessary information from the n8n documentation's vector database.\n\n**Mandatory rules:**\n\n1.  **Single source of truth:** Your answer MUST be entirely and solely derived from the information present in the provided documentation.\n2.  **Accuracy and implicit citation:** Base your answer as literally as possible on the documentation text. Rephrase for clarity and conciseness, but do not add any information not found there. Act as if the documentation is your only knowledge in the world.\n3.  **Do not mention the process:** Never mention your tool or the fact that you are a RAG system in your answer to the user. Respond as an expert who directly consults their documentation.\n</context>\n\n<output_format>\n*   **Clarity:** Provide a clear, concise, and direct answer.\n*   **Structuring:** If the context contains steps, lists, or code examples, use Markdown syntax to format them legibly (bullet points, numbered lists, code blocks for code snippets, JSON, etc.).\n*   **Tone:** Adopt a professional, helpful, and confident tone, that of a technical n8n expert.\n</output_format>\n</instructions>"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "b034896c-93d8-4ea9-99d1-4e4d5e014412",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1168,
          -2752
        ],
        "parameters": {
          "color": 7,
          "width": 288,
          "height": 400,
          "content": "### Step 1.1: Find All the 'Books'\n\n**What it does:** This node visits the main n8n documentation page.\n**Analogy:** We're asking the library's front desk for a complete list of every single book they have."
        },
        "typeVersion": 1
      },
      {
        "id": "46c45a67-e934-4b08-8e26-4cde8452fc75",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -864,
          -2752
        ],
        "parameters": {
          "color": 7,
          "width": 272,
          "height": 400,
          "content": "### Step 1.2: Read the List of Books\n\n**What it does:** It takes the HTML from the previous step and extracts every single link (`<a>` tag).\n**Analogy:** We're reading the list from the front desk and pulling out just the titles of the books (the links)."
        },
        "typeVersion": 1
      },
      {
        "id": "f1f4f619-bf7f-46bd-b693-a52d4d086792",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -576,
          -2752
        ],
        "parameters": {
          "color": 7,
          "width": 336,
          "height": 400,
          "content": "### Step 1.3: Process One Book at a Time\n\n**What it does:** It takes the big list of links and turns each link into a separate item for n8n to process.\n**Analogy:** Instead of trying to read all the books at once, we're creating a separate to-do item for each book."
        },
        "typeVersion": 1
      },
      {
        "id": "c797b838-0aee-4e27-b13b-f9bbc106fb65",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -224,
          -2752
        ],
        "parameters": {
          "color": 7,
          "width": 480,
          "height": 400,
          "content": "### Step 1.4: Tidy Up the To-Do List\n\n**What it does:** First, it removes any duplicate links. Then, it filters out any links that don't point to an actual documentation page (e.g., links to the homepage or external sites).\n**Analogy:** We're throwing away duplicate to-do items and any notes that aren't actually books."
        },
        "typeVersion": 1
      },
      {
        "id": "b0e2599e-5e8d-40a7-8c8e-69e874ce22dc",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          272,
          -2752
        ],
        "parameters": {
          "color": 4,
          "width": 512,
          "height": 464,
          "content": "### Step 1.5: The Librarian's Reading Loop\n\n**What it does:** This is the engine of the indexing process. It takes our clean list of pages and processes them one by one. The `Execute Workflow` node calls the \"sub-workflow\" below for each and every page.\n**Analogy:** This loop tells our librarian to pick up one book (link) at a time and go through the full process of reading and indexing it."
        },
        "typeVersion": 1
      },
      {
        "id": "3177c487-9dfb-4f21-839f-130f65a9b859",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1104,
          -1984
        ],
        "parameters": {
          "color": 7,
          "width": 288,
          "height": 384,
          "content": "### Step 1.5.1: Read a Single Page\n\n**What it does:** This node takes a single URL from the loop and fetches the HTML content of that page.\n**Analogy:** The librarian opens one book to the first page."
        },
        "typeVersion": 1
      },
      {
        "id": "e6f2fa91-e79a-4157-9985-79b591d88df5",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1632,
          -2128
        ],
        "parameters": {
          "color": 5,
          "width": 512,
          "height": 528,
          "content": "### Why Use a Sub-Workflow?\n\nThe main reason is **memory management**.\n\nProcessing a single web page, especially creating vector embeddings for all its chunks, uses a lot of memory (RAM). The n8n documentation has over 1,000 pages. If we tried to process all of them in a single, linear run, the memory usage would build up with each page and would likely crash your n8n instance.\n\nWhen a sub-workflow finishes its run for one item (one page), n8n **clears out the memory** (RAM) it used before starting the next one.\n\nBy using a sub-workflow, we process pages one-by-one in a memory-efficient loop, making the entire indexing process stable and reliable, even on a massive scale."
        },
        "typeVersion": 1
      },
      {
        "id": "db438316-dbed-4d25-ac1a-80373a7235af",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -800,
          -1984
        ],
        "parameters": {
          "color": 7,
          "width": 512,
          "height": 384,
          "content": "### Step 1.5.2: Get the Good Stuff\n\n**What it does:** It extracts only the main text from the article on the page, ignoring menus, footers, and images. Then, it cleans up the formatting.\n**Analogy:** The librarian tears out only the useful pages from the book and cleans up any smudges or messy handwriting."
        },
        "typeVersion": 1
      },
      {
        "id": "9b8b485b-4be8-474a-9ba1-1a1d55d7a02e",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -272,
          -2208
        ],
        "parameters": {
          "color": 5,
          "width": 544,
          "height": 608,
          "content": "### Step 1.5.3: Avoid Re-reading\n\n**What it does:** It checks if we have already processed this exact page content in a previous run. If so, it stops here to save time and resources.\n**Analogy:** The librarian checks their \"already read\" pile to avoid reading the same book twice.\n\n**A Powerful Feature Explained:**\n\nUsually, the \"Remove Duplicates\" node only looks at the items in the *current* execution. But here, it's set to **\"Remove items seen in previous executions.\"**\n\nThis is incredibly powerful in a sub-workflow. Even though our sub-workflow only sees one page at a time, this node has a long-term memory. It remembers every single page it has *ever* processed across all previous runs.\n\nThis makes the workflow robust. You can run the indexing process again and again to update the knowledge base with new documentation, and it will never waste resources re-processing old pages and more importantly, it won't create duplicate chunks in Supabase."
        },
        "typeVersion": 1
      },
      {
        "id": "e271d052-dc6e-4380-be18-8d51c49fc6ef",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          288,
          -2208
        ],
        "parameters": {
          "color": 6,
          "width": 656,
          "height": 1040,
          "content": "### Step 1.5.4: Create & Store the 'Magic Index Cards'\n\nThis is the most important step of indexing!\n\n1.  **`Recursive Character Text Splitter`:** The text is broken down into small, overlapping paragraphs (\"chunks\").\n    *   **Analogy:** The librarian breaks the book down into small, meaningful paragraphs. This is vital for finding very specific answers later.\n\n2.  **`Gemini Chunk Embedding`:** An AI model converts each chunk of text into a list of numbers (a \"vector\" or \"embedding\").\n    *   **Analogy:** The librarian uses a 'magic pen' to turn each paragraph into a unique set of numbers. Paragraphs with similar meanings get similar numbers.\n\n3.  **`Your Supabase Vector Store (Insert)`:** The original text chunk and its new vector are saved together in your Supabase database.\n    *   **Analogy:** The librarian files the original paragraph along with its magic number on an index card and puts it in a special filing cabinet (your Supabase vector store)."
        },
        "typeVersion": 1
      },
      {
        "id": "041060ee-020a-4541-b894-3a7f531fc20e",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1664,
          -1104
        ],
        "parameters": {
          "color": 7,
          "width": 1200,
          "height": 1440,
          "content": "## Part 2: The Chatbot (Talking to the Expert Librarian)\n\n**Goal:** To provide an interface where a user can ask a question, have the system find relevant information from the knowledge base, and get an accurate, AI-generated answer.\n**Action:** After running the Indexing flow, **Activate** this workflow. Then, open the `When chat message received` node and use its Public URL to chat."
        },
        "typeVersion": 1
      },
      {
        "id": "f93ae799-f751-48ce-ac9e-98a0ec2c8cda",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note17",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1632,
          -944
        ],
        "parameters": {
          "color": 4,
          "width": 368,
          "height": 448,
          "content": "### The Front Desk: Ask Your Question Here\n\n**What it does:** This is the public-facing chat interface. When you send a message here, the entire RAG process begins.\n\n**Action:**\n1.  **Activate** the entire workflow.\n2.  To test directly inside n8n, click the **\"Open Chat\"** button in this node's parameter panel.\n3.  To chat publicly, copy the **Public URL** from this node and open it in a new browser tab."
        },
        "typeVersion": 1
      },
      {
        "id": "e13e5f83-3628-4bc9-9d4a-2b2a1d8f5af8",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note18",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1248,
          -832
        ],
        "parameters": {
          "color": 5,
          "width": 560,
          "height": 400,
          "content": "### The Brains: The Expert Librarian\n\n**What it does:** This is the AI agent that orchestrates the entire response. It understands your question, decides which tools to use, and formulates the final answer.\n**System Prompt:** Its instructions (in the System Message) are very strict: **\"Only use the provided documents to answer. Do not make things up.\"**"
        },
        "typeVersion": 1
      },
      {
        "id": "5597474d-cded-474e-a9cc-631050986d63",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note19",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1632,
          -480
        ],
        "parameters": {
          "color": 7,
          "width": 368,
          "height": 576,
          "content": "### The 'Synthesizer' & 'Strategist'\n\n**What it does:** This is the Large Language Model (LLM). It has two critical jobs:\n\n1.  **The Strategist:** Based on your question and the conversation history, it decides *what information to look for* in the knowledge base (the library).\n2.  **The Synthesizer:** After getting the relevant documents, it generates the final, human-readable answer based *only* on that context.\n\n\n**Analogy:** This is the part of the librarian's brain that first decides which section of the library to search, and then reads the specific index cards to write a clear, helpful response.\n\nThe model used here is **Gemini 2.5 Flash**."
        },
        "typeVersion": 1
      },
      {
        "id": "60d88a66-9f0c-482f-8235-461695fd9d02",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note20",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1248,
          -416
        ],
        "parameters": {
          "color": 7,
          "width": 288,
          "height": 512,
          "content": "### Short-Term Memory\n\n**What it does:** This node stores the last few messages of your conversation.\n**Analogy:** This helps the librarian remember what you just talked about, so you can ask follow-up questions without having to repeat yourself."
        },
        "typeVersion": 1
      },
      {
        "id": "c2c15516-c4f3-4770-9435-8a2ec33d4d80",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note21",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -944,
          -416
        ],
        "parameters": {
          "color": 6,
          "width": 448,
          "height": 720,
          "content": "### The Tool: The 'Magic Filing Cabinet' Retriever\n\nThis is the \"Retrieval\" part of RAG. When the agent gets your question, it uses this tool to find the most relevant information.\n\n1.  **`Gemini Query Embedding`:** Your question is converted into its own 'magic number' (vector of 768 dimensions).\n\n2.  **`Vector Store (Retrieve)`:** It searches the Supabase database for the stored document chunks with the most similar 'magic numbers' to your question's number.\n\n\n**Analogy:** The librarian takes your question, finds the most relevant index cards from the filing cabinet, and hands them over to the 'Synthesizer' to formulate the answer."
        },
        "typeVersion": 1
      },
      {
        "id": "d450a7b2-584a-4e47-b66b-0f5442db45ec",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note22",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -432,
          -1104
        ],
        "parameters": {
          "color": 7,
          "width": 544,
          "height": 416,
          "content": "## Optional: Keep the Database Awake\n\n**What it does:** Free Supabase projects \"go to sleep\" after a week of inactivity. This scheduled trigger runs a tiny query every 6 days to keep your database awake and ready.\n**Action:** You can delete this if you have a paid Supabase plan or a self-hosted instance."
        },
        "typeVersion": 1
      },
      {
        "id": "ee177bf3-36c5-4b05-baad-b0858be54d0a",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Start Indexing",
        "type": "n8n-nodes-base.manualTrigger",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1312,
          -2544
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "b1e9e574-d2d7-41be-8859-b3aeea8c5be0",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "RAG Chatbot",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1472,
          -640
        ],
        "webhookId": "e80f40f5-f8dc-4d0e-9ce5-594c61d233df",
        "parameters": {
          "public": true,
          "options": {
            "title": "",
            "subtitle": "",
            "customCss": "/* === THEME OVERRIDE: n8n Glass & Glow (Revised) === */\n\n/*\n  This theme is built upon the default n8n chat CSS variables.\n  We'll use your desired branding and layout, and then add\n  the \"glass\" effect using a semi-transparent background\n  and a backdrop-filter on the main window class.\n*/\n\n:root {\n  /* --- 1. CORE BRANDING & FONTS --- */\n  /* Your choices for font and primary color are applied here. */\n  --chat--font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  --chat--color-primary: #EA4B71; /* n8n Red */\n  --chat--color-primary-shade-50: #D93A60;\n  --chat--color-primary-shade-100: #C82A50;\n  --chat--color-secondary: #20b69e; /* Kept default secondary for things like file uploads */\n  --chat--color-secondary-shade-50: #1ca08a;\n  --chat--color-white: #ffffff;\n  --chat--color-light: #f2f4f8;\n  --chat--color-dark: #1F2937; /* Darker, more modern text color */\n  --chat--color-disabled: #9CA3AF;\n  --chat--color-typing: #404040;\n\n  /* --- 2. WINDOW & LAYOUT --- */\n  /* Your dimensions and rounded corners. The actual glass effect is handled in the class override below. */\n  --chat--window--width: 430px;\n  --chat--window--height: 80vh;\n  --chat--window--border-radius: 16px;\n  --chat--window--border: 1px solid rgba(255, 255, 255, 0.3);\n  --chat--spacing: 1rem; /* 16px base spacing */\n  --chat--window--z-index: 9999;\n  --chat--window--bottom: var(--chat--spacing);\n  --chat--window--right: var(--chat--spacing);\n  --chat--window--margin-bottom: var(--chat--spacing);\n\n  /* --- 3. GLASSMORPHISM BACKGROUNDS --- */\n  /* We make the main sections transparent to let the glass window show through. */\n  --chat--header--background: transparent;\n  --chat--body--background: transparent;\n  --chat--footer--background: transparent;\n\n  /* --- 4. HEADER STYLING (REMOVED) --- */\n  /* The header is removed by setting its height, padding, and border to 0/none. */\n  --chat--header-height: 0;\n  --chat--header--padding: 0;\n  --chat--header--border-bottom: none;\n  /* The rest of the header variables are now irrelevant. */\n  --chat--header--color: var(--chat--color-dark);\n  --chat--heading--font-size: 1.5rem;\n  --chat--subtitle--font-size: 0.875rem;\n  --chat--subtitle--line-height: 1.4;\n  --chat--close--button--color-hover: var(--chat--color-primary);\n\n  /* --- 5. MESSAGE BUBBLES --- */\n  --chat--message--font-size: 0.875rem;\n  --chat--message--padding: 12px 16px;\n  --chat--message--border-radius: 12px;\n  --chat--message-line-height: 1.6;\n  --chat--message--margin-bottom: calc(var(--chat--spacing) * 0.75);\n  /* Adjusted padding: Top is 0, sides and bottom use the base spacing. */\n  --chat--messages-list--padding: 0 var(--chat--spacing) var(--chat--spacing);\n  --chat--message--bot--background: var(--chat--color-white);\n  --chat--message--bot--color: #111827;\n  --chat--message--bot--border: none;\n  --chat--message--user--background: var(--chat--color-primary);\n  --chat--message--user--color: var(--chat--color-white);\n  --chat--message--user--border: none;\n\n  /* --- 6. INPUT AREA --- */\n  --chat--textarea--height: 50px;\n  --chat--textarea--max-height: 10rem;\n  --chat--input--font-size: 0.9rem;\n  --chat--input--border: 0;\n  --chat--input--border-radius: 12px; /* Rounded input field */\n  --chat--input--padding: 12px 16px;\n  --chat--input--background: rgba(255, 255, 255, 0.5); /* Semi-transparent input */\n  --chat--input--text-color: #111827;\n  --chat--input--line-height: 1.5;\n  --chat--input--border-active: 0;\n\n  /* --- 7. SEND & FILE BUTTONS --- */\n  --chat--input--send--button--background: transparent;\n  --chat--input--send--button--color: var(--chat--color-primary);\n  --chat--input--send--button--background-hover: transparent;\n  --chat--input--send--button--color-hover: var(--chat--color-primary-shade-50);\n  --chat--input--file--button--background: transparent;\n  --chat--input--file--button--color: var(--chat--color-secondary);\n  --chat--input--file--button--background-hover: transparent;\n  --chat--input--file--button--color-hover: var(--chat--color-secondary-shade-50);\n\n  /* --- 8. TOGGLE BUTTON & OTHERS --- */\n  /* Using your primary brand color for the main toggle button */\n  --chat--toggle--size: 64px;\n  --chat--toggle--width: var(--chat--toggle--size);\n  --chat--toggle--height: var(--chat--toggle--size);\n  --chat--toggle--border-radius: 50%;\n  --chat--toggle--background: var(--chat--color-primary);\n  --chat--toggle--hover--background: var(--chat--color-primary-shade-50);\n  --chat--toggle--active--background: var(--chat--color-primary-shade-100);\n  --chat--toggle--color: var(--chat--color-white);\n}\n\n/* === CLASS OVERRIDES === */\n/*\n  These are essential for effects that CSS variables can't control,\n  like the glass blur, shadows, and max-height.\n*/\n\n.chat-window {\n  /* This is the magic for the glass effect! */\n  background-color: rgba(249, 243, 245, 0.6); /* A semi-transparent background color */\n  backdrop-filter: blur(20px);\n  -webkit-backdrop-filter: blur(20px); /* For Safari compatibility */\n\n  /* A subtle shadow helps lift the window off the page */\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);\n\n  /* Here we apply the max-height you wanted */\n  max-height: 750px;\n}\n\n/* Add top margin to the first message only for initial spacing */\n.chat-messages-list .chat-message:first-child {\n  margin-top: var(--chat--spacing);\n}\n\n/* Make user messages slightly wider for better balance */\n.chat-message.is-user {\n\tmax-width: 70%;\n}\n\n.chat-message.is-bot {\n\tmax-width: 80%;\n}\n\n/* Add a subtle glow to messages on hover */\n.chat-message {\n    transition: transform 0.2s ease, box-shadow 0.2s ease;\n}\n.chat-message:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 0 25px 0 rgba(234, 75, 113, 0.2);\n}\n\n/* === PAGE BACKGROUND === */\n/* Your dotted background to simulate the n8n canvas. Perfect as is! */\nbody {\n    background-color: #FDFBFF;\n    background-image:\n        radial-gradient(circle at 1px 1px, rgba(0,0,0,0.07) 1px, transparent 0),\n        linear-gradient(135deg, #F9F3F5 0%, #EFF3FB 100%);\n    background-size: 25px 25px, 100% 100%;\n}",
            "inputPlaceholder": "Type your n8n related question.."
          },
          "initialMessages": "Hello! I'm an AI assistant trained on the official n8n documentation.\nYou can ask me anything about n8n nodes, workflows, or concepts. For example:\n\"How does the IF node work?\"\n\"What is a sub-workflow?\""
        },
        "typeVersion": 1.1
      },
      {
        "id": "486ed614-77bc-41fd-bc8e-d034701b6919",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note25",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2592,
          -2816
        ],
        "parameters": {
          "width": 704,
          "height": 256,
          "content": "## Setup Step 1: Create Your Supabase Project\n\nFirst, we need to create the \"library\" where your AI's knowledge will be stored.\n\n**Action:**\n1.  Go to [supabase.com](https://supabase.com/) and sign up for a free account.\n2.  Create a **New Project**. Give it a name (e.g., \"n8n-rag-tutorial\") and generate a secure password.\n\n\nYou now have an empty database ready to be configured."
        },
        "typeVersion": 1
      },
      {
        "id": "ece95b88-01df-4d23-9004-878c5d6a7b49",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note26",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2592,
          -2544
        ],
        "parameters": {
          "width": 832,
          "height": 1136,
          "content": "## Setup Step 2: Prepare the Database (SQL)\n\nNow we need to build the \"shelves\" and \"card catalog system\" for our library.\n\n**Action:**\n1.  In your Supabase project, go to the **SQL Editor**.\n2.  Find the other large sticky note on this canvas that contains the SQL code.\n3.  **Copy the entire SQL code** and paste it into the Supabase SQL Editor, then click **\"RUN\"**.\n\n\n**⚠️ IMPORTANT:**\n*   If you get an error that the `pgvector` extension already exists, simply delete the first line of the code (`create extension vector;`) and run it again.\n*   This script is configured for **Gemini embeddings (dimension 768)**. If you plan to use an OpenAI model like `text-embedding-3-small`, you **MUST** change the vector dimension in the script from `vector(768)` to `vector(1536)`."
        },
        "typeVersion": 1
      },
      {
        "id": "f68cfb36-4229-42de-b249-d99ae6de65ee",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2592,
          -16
        ],
        "parameters": {
          "width": 624,
          "height": 320,
          "content": "## Setup Step 7: Chat with Your Expert!\n\nCongratulations, the library is built! Now it's time to ask the expert librarian a question.\n\n**Action:**\n1.  **Activate** the entire workflow using the toggle switch at the top of the screen.\n2.  Open the **`RAG Chatbot`** chat trigger node (bottom-left).\n3.  To chat:\n    *   Copy its **Public URL** and open it in a new browser tab.\n    *   OR, click the **\"Open Chat\"** button in the node's panel to test it directly inside n8n.\n\n\n**Try asking:** \"How does the IF node work?\" or \"What is a sub-workflow?\""
        },
        "typeVersion": 1
      },
      {
        "id": "1f66a70a-1da1-42f1-ada9-4d298fe6636f",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note23",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2592,
          -1392
        ],
        "parameters": {
          "width": 720,
          "height": 272,
          "content": "## Setup Step 3: Get Your Supabase Keys\n\nTo let n8n access your new library, we need the keys.\n\n**Action:**\n1.  Go to **Project Settings > API**.\n2.  Find the **Project URL**. Copy it.\n3.  Find the **Project API Keys** section. Copy the key under the `service_role` (it's the long, secret one).\n\n\nKeep these two values ready for the next step. They are your library's address and master key."
        },
        "typeVersion": 1
      },
      {
        "id": "16a876d7-73f4-4d60-8fc2-9f6b682e346d",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note24",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2592,
          -1104
        ],
        "parameters": {
          "width": 656,
          "height": 400,
          "content": "## Setup Step 4: Connect Your Credentials\n\nNow, let's save those keys securely in n8n without leaving the workflow.\n\n**Action for Supabase:**\n1.  Go to the **`Your Supabase Vector Store`** node on the canvas.\n2.  Click the **Credential** dropdown and select **`+ Create New Credential`**.\n3.  In the window that opens:\n    *   Paste your **Project URL** into the `Host` field.\n    *   Paste your **Service Role Key** into the `API Key` field.\n4.  Click **Save**. Your new credential will be created and automatically selected for this node.\n\n**Action for Google AI:**\n1.  Go to the **`Gemini 2.5 Flash`** node.\n2.  Click the **Credential** dropdown and select **`+ Create New Credential`**.\n3.  Paste your **Gemini API key** and click **Save**."
        },
        "typeVersion": 1
      },
      {
        "id": "5e4db806-3fda-48f3-b0e4-be7d042dec8e",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note27",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2592,
          -688
        ],
        "parameters": {
          "width": 864,
          "height": 368,
          "content": "## Setup Step 5: Select Credentials for Other Nodes\n\nYour new credentials are now saved. Let's make sure all the other nodes are using them.\n\n**Action:**\nGo to the remaining Supabase and Gemini nodes. Your new credentials will now be available in their **Credential** dropdown lists. Simply select the correct one for each.\n\n**Select your Supabase credential for:**\n*   `Official n8n Documentation`\n*   `Keep Supabase Instance Alive`\n\n**Select your Google AI credential for:**\n*   `Gemini Chunk Embedding`\n*   `Gemini Query Embedding`"
        },
        "typeVersion": 1
      },
      {
        "id": "49d66d23-1eb4-4cb3-bada-c2dc3cea3599",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note28",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -2592,
          -304
        ],
        "parameters": {
          "width": 784,
          "height": 272,
          "content": "## Setup Step 6: Build the Knowledge Base (Indexing)\n\nThis is the big one-time step where the \"librarian\" reads all the books.\n\n**Action:**\n1.  Find the **`Start Indexing`** manual trigger node at the top-left of the canvas.\n2.  Click its **\"Execute workflow\"** button.\n\n\n**⚠️ Be Patient!** This process will take **15-20 minutes** to scrape, process, and store the entire n8n documentation. Let it run until it completes successfully. You only need to do this once."
        },
        "typeVersion": 1
      },
      {
        "id": "a981dd10-915b-46bf-9c79-58ec73dd7cd7",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Ingest Web Page",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -1312,
          -1776
        ],
        "parameters": {
          "inputSource": "passthrough"
        },
        "typeVersion": 1.1
      },
      {
        "id": "42e9804c-db9b-4417-a9b2-bc747bb4edc0",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note29",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -432,
          -656
        ],
        "parameters": {
          "color": 3,
          "width": 544,
          "height": 768,
          "content": "## Was this helpful? Let me know!\n\nI really hope this template helped you understand RAG better. Your feedback is incredibly valuable and helps me create better resources for the n8n community.\n\n### **Share Your Thoughts & Ideas**\n\nWhether you have a suggestion, found a typo, or just want to say thanks, I'd love to hear from you!\nHere's a simple n8n form built for this purpose:\n\n#### ➡️ **[Click here to give feedback](https://api.ia2s.app/form/templates/feedback?template=n8n%20RAG)**\n\n### **Ready to Build Something Great?**\n\nIf you're looking to take your n8n skills or business automation to the next level, I can help.\n\n**🎓 n8n Coaching:** Want to become an n8n pro? I offer one-on-one coaching sessions to help you master workflows, tackle specific problems, and build with confidence.\n#### ➡️ **[Book a Coaching Session](https://api.ia2s.app/form/templates/coaching?template=n8n%20RAG)**\n\n**💼 n8n Consulting:** Have a complex project, an integration challenge, or need a custom workflow built for your business? Let's work together to create a powerful automation solution.\n#### ➡️ **[Inquire About Consulting Services](https://api.ia2s.app/form/templates/consulting?template=n8n%20RAG)**\n\n---\n\nHappy Automating!\nLucas Peyrin"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {
      "Ingest Web Page": [
        {
          "link": "integrations/builtin/core-nodes/n8n-nodes-base.comparedatasets/"
        }
      ]
    },
    "connections": {
      "RAG Chatbot": {
        "main": [
          [
            {
              "node": "n8n Docs AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Every 6 Days": {
        "main": [
          [
            {
              "node": "Keep Supabase Instance Alive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "n8n Docs AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Start Indexing": {
        "main": [
          [
            {
              "node": "Get All n8n Documentation Links",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Ingest Web Page": {
        "main": [
          [
            {
              "node": "Get Documentation Page",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out Links": {
        "main": [
          [
            {
              "node": "Remove Duplicate Links",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini 2.5 Flash": {
        "ai_languageModel": [
          [
            {
              "node": "n8n Docs AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Clean Documentation": {
        "main": [
          [
            {
              "node": "Remove Duplicate Documentation Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Your Supabase Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Only Keep Doc Paths": {
        "main": [
          [
            {
              "node": "Loop Over Documentation Pages",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Chunk Embedding": {
        "ai_embedding": [
          [
            {
              "node": "Your Supabase Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Query Embedding": {
        "ai_embedding": [
          [
            {
              "node": "Official n8n Documentation",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Get Documentation Page": {
        "main": [
          [
            {
              "node": "Extract Documentation Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Remove Duplicate Links": {
        "main": [
          [
            {
              "node": "Only Keep Doc Paths",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Links from HTML": {
        "main": [
          [
            {
              "node": "Split Out Links",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Official n8n Documentation": {
        "ai_tool": [
          [
            {
              "node": "n8n Docs AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Extract Documentation Content": {
        "main": [
          [
            {
              "node": "Clean Documentation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Documentation Pages": {
        "main": [
          [],
          [
            {
              "node": "Add Documentation Page to Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get All n8n Documentation Links": {
        "main": [
          [
            {
              "node": "Extract Links from HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Add Documentation Page to Vector Store": {
        "main": [
          [
            {
              "node": "Loop Over Documentation Pages",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Remove Duplicate Documentation Content": {
        "main": [
          [
            {
              "node": "Your Supabase Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "6cdbf57e7035d3e617d2b60161d6112ec5ad3a16e1cfb77a74071016efecef02"
    },
    "name": "Daily Digest",
    "tags": [],
    "nodes": [
      {
        "id": "14994381-59c1-4a78-903d-7d5a7331da0e",
        "name": "Sticky Note - Overview",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2960,
          -80
        ],
        "parameters": {
          "color": 5,
          "width": 520,
          "height": 340,
          "content": "# 📬 Personal Daily Tech Newsletter\n\n**What it does:**\nAutomatically curates and emails a personalized daily newsletter with the latest tech news, tools, and products tailored to your interests.\n\n**How it works:**\n1. Triggers daily at 9 AM\n2. Fetches RSS feeds from your favorite tech sources\n3. Uses Google Gemini AI to filter and curate based on your interests\n4. Sends a beautifully formatted newsletter to your inbox\n\n**Customize:**\n- Change RSS sources in the \"Set\" nodes\n- Modify keywords/interests in \"Analyze document\" node\n- Update your email address in \"Send email\" node\n- Adjust schedule time in trigger node"
        },
        "typeVersion": 1
      },
      {
        "id": "23f5f52a-4493-4dca-b093-57af26d260e2",
        "name": "Sticky Note - Trigger",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2368,
          304
        ],
        "parameters": {
          "color": 3,
          "width": 280,
          "height": 220,
          "content": "## 📅 Daily Trigger\nScheduled to run every day at 9:00 AM"
        },
        "typeVersion": 1
      },
      {
        "id": "ad00a451-044d-4a93-b82e-35101217f111",
        "name": "Schedule Trigger1",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -2272,
          384
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 9
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "712ba274-a397-4cd7-91ce-d6f26d07dd80",
        "name": "Sticky Note - Sources",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2032,
          208
        ],
        "parameters": {
          "color": 4,
          "width": 280,
          "height": 520,
          "content": "## 📰 RSS Feed Sources\nDefine which RSS feeds to monitor for tech news and tools"
        },
        "typeVersion": 1
      },
      {
        "id": "d29d564d-0125-437b-9922-e19bc483289c",
        "name": "Tech News Sites",
        "type": "n8n-nodes-base.set",
        "position": [
          -1936,
          336
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "{\"url\" :  [\n\"https://techcrunch.com/feed/\",\n\"https://www.theverge.com/rss/index.xml\",\n    \"https://analyticsindiamag.com/feed/\",\n     \"https://www.wired.com/feed/rss\",\n       \"https://thenextweb.com/feed\"\n]}"
        },
        "typeVersion": 3.4
      },
      {
        "id": "c788d7df-fb92-4cdf-a41f-321426601cc6",
        "name": "Tools Subredit and Sites",
        "type": "n8n-nodes-base.set",
        "position": [
          -1936,
          496
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "{\n  \"Url\": [\n    \n      \"https://www.reddit.com/r/SideProject/.rss\",\n      \"https://www.reddit.com/r/InternetIsBeautiful/.rss\",\n      \"https://dev.to/feed/tag/tools\",\n      \"https://www.producthunt.com/feed\"\n    \n  ]\n}"
        },
        "typeVersion": 3.4
      },
      {
        "id": "0460882d-8869-43ce-be88-2701f84f80b6",
        "name": "Sticky Note - Processing",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1712,
          208
        ],
        "parameters": {
          "color": 6,
          "width": 820,
          "height": 524,
          "content": "## 🔄 RSS Feed Processing\nSplit, loop through feeds in batches, and fetch content"
        },
        "typeVersion": 1
      },
      {
        "id": "3d3910c4-20f6-436a-b71b-cb60ce2001b0",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -1632,
          336
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "url"
        },
        "typeVersion": 1
      },
      {
        "id": "6e9386a7-f343-4cff-9e08-4e150635ac44",
        "name": "Split Out1",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -1632,
          496
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "Url"
        },
        "typeVersion": 1
      },
      {
        "id": "b1d6beb3-f1ac-436f-aa56-2578b6adaf39",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -1440,
          304
        ],
        "parameters": {
          "options": {},
          "batchSize": 5
        },
        "typeVersion": 3
      },
      {
        "id": "2eea7ce2-d3b3-446d-9918-856e6d5e2a9d",
        "name": "Loop Over Items1",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -1440,
          496
        ],
        "parameters": {
          "options": {},
          "batchSize": 4
        },
        "typeVersion": 3
      },
      {
        "id": "127fb49f-55b7-4253-a365-933286e5ab8d",
        "name": "RSS Read OF Tech News",
        "type": "n8n-nodes-base.rssFeedRead",
        "onError": "continueRegularOutput",
        "position": [
          -1216,
          320
        ],
        "parameters": {
          "url": "={{ $('Split Out').item.json.url }}",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "4d99995d-538f-4fed-83a9-2886f18e59cc",
        "name": "RSS Read OF Tools",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1216,
          512
        ],
        "parameters": {
          "url": "={{ $json.Url }}",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "57c8972a-273e-4025-9695-3688281e1376",
        "name": "Sticky Note - Combine",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -832,
          208
        ],
        "parameters": {
          "color": 2,
          "width": 420,
          "height": 504,
          "content": "## 📦 Combine & Convert\nMerge all feeds and convert to CSV for AI"
        },
        "typeVersion": 1
      },
      {
        "id": "2e7c93c2-e17b-4a8c-b0dc-23d18f91935e",
        "name": "Merge Both List",
        "type": "n8n-nodes-base.merge",
        "position": [
          -736,
          400
        ],
        "parameters": {},
        "typeVersion": 3.2
      },
      {
        "id": "474180f0-97b6-4308-a83e-442cc0d29489",
        "name": "Conver To CSV",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          -560,
          400
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "81e6441b-2f11-4e89-aca6-d2a207359367",
        "name": "Sticky Note - AI",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -352,
          208
        ],
        "parameters": {
          "color": 7,
          "width": 540,
          "height": 504,
          "content": "## 🤖 AI Curation\n\nGoogle Gemini analyzes content and selects the top items based on your interests.\n\n**Note:** Change the keywords in the **Analyze Document** node’s text input prompt according to your interests.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "bac6a4ba-594c-40e9-9618-d25363ba6421",
        "name": "Upload a file",
        "type": "@n8n/n8n-nodes-langchain.googleGemini",
        "position": [
          -256,
          400
        ],
        "parameters": {
          "resource": "file",
          "inputType": "binary"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "VtYuo9vnFZPNYw1Z",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "3b565d0a-9fdf-433d-ad5b-b71ac3232f66",
        "name": "Analyze document",
        "type": "@n8n/n8n-nodes-langchain.googleGemini",
        "position": [
          -16,
          400
        ],
        "parameters": {
          "text": "# Tech Content Writer Prompt\n\nYou are a tech content writer.\nI have two lists of items:\n1️⃣ New Tools & Products\n{products_list}\n2️⃣ Global & India Tech News\n{news_list}\n\n## Task:\n- Select the **top 10-15 items** from each list based on these interests and keywords:\n  - **Tools & Products Keywords:** [\"AI\", \"automation\", \"developer\", \"open source\", \"productivity\", \"creative\", \"innovation\", \"API\", \"web app\", \"tools\"]\n  - **News Keywords:** [\"technology innovation\", \"AI breakthrough\", \"framework\", \"developer update\", \"research\", \"automation trend\", \"product launch\"]\n- Keep **two separate sections**: \n  1. Tools & Products (10-15 items)\n  2. Global & India Tech Innovations (10-15 items)\n- Summarize each item in **2-3 lines**.\n- **If an image URL is provided**, display it beautifully under the title with rounded edges\n- Tone: \"Curious, energetic, and concise – focused on discovery, usefulness, and creativity.\"\n- Format using the HTML template below, replacing placeholder items with actual content from the lists.\n\n## HTML Template:\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Daily Tech Digest</title>\n    <style>\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;\n            background: #f5f5f5;\n            margin: 0;\n            padding: 16px;\n            line-height: 1.5;\n            font-size: 15px;\n            color: #333;\n        }\n        \n        .container {\n            max-width: 600px;\n            margin: 0 auto;\n            background: #ffffff;\n            border-radius: 8px;\n        }\n        \n        .header {\n            background: #000;\n            color: #fff;\n            padding: 20px 16px;\n            border-radius: 8px 8px 0 0;\n        }\n        \n        .header h1 {\n            font-size: 20px;\n            font-weight: 600;\n            margin: 0 0 4px 0;\n        }\n        \n        .header p {\n            font-size: 13px;\n            margin: 0;\n            opacity: 0.8;\n        }\n        \n        .content {\n            padding: 20px 16px;\n        }\n        \n        .section {\n            margin-bottom: 32px;\n        }\n        \n        .section:last-child {\n            margin-bottom: 0;\n        }\n        \n        .section-title {\n            font-size: 16px;\n            font-weight: 600;\n            color: #000;\n            margin: 0 0 16px 0;\n            padding-bottom: 8px;\n            border-bottom: 2px solid #000;\n        }\n        \n        .item {\n            margin-bottom: 20px;\n            padding-bottom: 20px;\n            border-bottom: 1px solid #e5e5e5;\n        }\n        \n        .item:last-child {\n            border-bottom: none;\n            margin-bottom: 0;\n            padding-bottom: 0;\n        }\n        \n        .item-title {\n            font-size: 15px;\n            font-weight: 600;\n            color: #000;\n            margin: 0 0 12px 0;\n        }\n        \n        .item-image {\n            width: 100%;\n            height: auto;\n            border-radius: 12px;\n            margin-bottom: 12px;\n            display: block;\n            object-fit: cover;\n        }\n        \n        .item-summary {\n            font-size: 14px;\n            color: #555;\n            margin: 0 0 8px 0;\n        }\n        \n        .item-link {\n            color: #0066cc;\n            text-decoration: none;\n            font-size: 14px;\n            font-weight: 500;\n        }\n        \n        .footer {\n            background: #f9f9f9;\n            padding: 16px;\n            text-align: center;\n            font-size: 12px;\n            color: #666;\n            border-radius: 0 0 8px 8px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>⚡ Daily Tech Digest</h1>\n            <p>{current_date}</p>\n        </div>\n        \n        <div class=\"content\">\n            <!-- Tools & Products Section -->\n            <div class=\"section\">\n                <h2 class=\"section-title\">🧠 New Tools & Products</h2>\n                \n                <!-- Example with Image -->\n                <div class=\"item\">\n                    <div class=\"item-title\">{Product Title 1}</div>\n                    <!-- Include image if URL is available -->\n                    <img src=\"{image_url}\" alt=\"{Product Title}\" class=\"item-image\" onerror=\"this.style.display='none'\">\n                    <div class=\"item-summary\">\n                        {2-3 line summary of the product}\n                    </div>\n                    <a href=\"{product_link}\" class=\"item-link\">Learn more →</a>\n                </div>\n                \n                <!-- Example without Image -->\n                <div class=\"item\">\n                    <div class=\"item-title\">{Product Title 2}</div>\n                    <div class=\"item-summary\">\n                        {2-3 line summary of the product}\n                    </div>\n                    <a href=\"{product_link}\" class=\"item-link\">Learn more →</a>\n                </div>\n                \n                <!-- Add more items as needed -->\n            </div>\n            \n            <!-- Global & India Tech News Section -->\n            <div class=\"section\">\n                <h2 class=\"section-title\">🌍 Global & India Tech Innovations</h2>\n                \n                <!-- Example with Image -->\n                <div class=\"item\">\n                    <div class=\"item-title\">{News Title 1}</div>\n                    <!-- Include image if URL is available -->\n                    <img src=\"{image_url}\" alt=\"{News Title}\" class=\"item-image\" onerror=\"this.style.display='none'\">\n                    <div class=\"item-summary\">\n                        {2-3 line summary of the news}\n                    </div>\n                    <a href=\"{news_link}\" class=\"item-link\">Read more →</a>\n                </div>\n                \n                <!-- Example without Image -->\n                <div class=\"item\">\n                    <div class=\"item-title\">{News Title 2}</div>\n                    <div class=\"item-summary\">\n                        {2-3 line summary of the news}\n                    </div>\n                    <a href=\"{news_link}\" class=\"item-link\">Read more →</a>\n                </div>\n                \n                <!-- Add more items as needed -->\n            </div>\n        </div>\n        \n        <div class=\"footer\">\n            Stay curious. Keep building.\n        </div>\n    </div>\n</body>\n</html>\n```",
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "models/gemini-2.5-flash-preview-05-20",
            "cachedResultName": "models/gemini-2.5-flash-preview-05-20"
          },
          "options": {},
          "resource": "document",
          "documentUrls": "={{ $json.fileUri }}"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "VtYuo9vnFZPNYw1Z",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b52be0db-7f23-42f5-be51-ef974fea34a7",
        "name": "Sticky Note - Email",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          256,
          208
        ],
        "parameters": {
          "width": 520,
          "height": 472,
          "content": "## 📧 Newsletter Delivery\n\nFormat and send the personalized newsletter.\n\n**Note:**\nAdd **SMTP credentials**, **sender**, and **receiver information**.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "df2a0631-fa25-4eb6-a1dc-5d99a82c481d",
        "name": "Code in JavaScript",
        "type": "n8n-nodes-base.code",
        "position": [
          368,
          400
        ],
        "parameters": {
          "jsCode": "// Get the HTML from previous node\nlet htmlText = $input.first().json.content.parts[0].text\n// Remove all \\n characters and trim\nhtmlText = htmlText.replace(/\\n/g, \"\").trim();\n\n// Return as JSON\nreturn [{ json: { html: htmlText } }];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "9ec9cefa-4888-424c-96ce-8241328a9164",
        "name": "Send email",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          592,
          400
        ],
        "webhookId": "9c1d2a26-ab49-44a3-aea5-f13cc14ebf64",
        "parameters": {
          "html": "={{ $json.html.replace(/^```html/, '').replace(/```$/, '').trim() }}\n",
          "options": {},
          "subject": "=⚡ Daily Tech Digest - {{ new Date().toLocaleDateString(\"en-US\", { year: \"numeric\", month: \"long\", day: \"numeric\" }) }}\n",
          "toEmail": "receiver@example.com",
          "fromEmail": "sender@example.com"
        },
        "credentials": {
          "smtp": {
            "id": "Cg1l3roJc0JGX3OL",
            "name": "SMTP account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "fb268b0b-c0bc-4632-9343-7ac2adbf7d0e",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2048,
          656
        ],
        "parameters": {
          "color": 3,
          "width": 304,
          "height": 144,
          "content": "**Note:**\nI have used **two different sources of interest** (News and Tools). \nThat’s why there are **two separate lists**. Please make changes according to your approach or workflow.\n\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "",
    "connections": {
      "Split Out": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out1": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Conver To CSV": {
        "main": [
          [
            {
              "node": "Upload a file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload a file": {
        "main": [
          [
            {
              "node": "Analyze document",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Merge Both List",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "RSS Read OF Tech News",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge Both List": {
        "main": [
          [
            {
              "node": "Conver To CSV",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tech News Sites": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analyze document": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items1": {
        "main": [
          [
            {
              "node": "Merge Both List",
              "type": "main",
              "index": 1
            }
          ],
          [
            {
              "node": "RSS Read OF Tools",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS Read OF Tools": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger1": {
        "main": [
          [
            {
              "node": "Tech News Sites",
              "type": "main",
              "index": 0
            },
            {
              "node": "Tools Subredit and Sites",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "Send email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS Read OF Tech News": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tools Subredit and Sites": {
        "main": [
          [
            {
              "node": "Split Out1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "VqgG9dsRgPuxiNDW",
    "meta": {
      "instanceId": "5ddd5df8055e38d81880227d5c6dcdf1994486d01343a3c0e8e3e8bba2c674e7",
      "templateCredsSetupCompleted": true
    },
    "name": "n8n local test",
    "tags": [],
    "nodes": [
      {
        "id": "250ff8ae-f645-4644-af93-f2148549ed86",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -940,
          580
        ],
        "webhookId": "e0526870-3bc3-4dfc-9914-8e68363c4621",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "fbcc24b9-f983-49af-a7b9-dc78277e746c",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -660,
          560
        ],
        "parameters": {
          "options": {
            "systemMessage": "You are a helpful assistant you have access to a knowledge base"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "03cfe40b-62ca-41af-ba97-80072e018e3d",
        "name": "Ollama Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
        "position": [
          -840,
          400
        ],
        "parameters": {
          "model": "llama3.2:latest",
          "options": {}
        },
        "credentials": {
          "ollamaApi": {
            "id": "n77wZlvZvtjVPvN8",
            "name": "Ollama account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5c16650c-44a9-4c5f-b8f2-d0e9e5a0f41d",
        "name": "Postgres Chat Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
        "position": [
          -720,
          380
        ],
        "parameters": {},
        "credentials": {
          "postgres": {
            "id": "dd7SihZdZXIWFCAf",
            "name": "Postgres account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "d975770d-0463-480c-aa70-33395f5f40b2",
        "name": "Qdrant Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
        "position": [
          660,
          460
        ],
        "parameters": {
          "options": {},
          "qdrantCollection": {
            "__rl": true,
            "mode": "list",
            "value": "midjourney",
            "cachedResultName": "midjourney"
          }
        },
        "credentials": {
          "qdrantApi": {
            "id": "cbWjDnr5YQkhxhly",
            "name": "QdrantApi account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "a5282142-d4dc-40b9-bff9-93df5fc5905f",
        "name": "Ollama Model",
        "type": "@n8n/n8n-nodes-langchain.lmOllama",
        "position": [
          400,
          360
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "ollamaApi": {
            "id": "n77wZlvZvtjVPvN8",
            "name": "Ollama account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "76a8d5b3-0c41-4f6c-b3c1-6a00ce555b23",
        "name": "Embeddings Ollama",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOllama",
        "position": [
          480,
          520
        ],
        "parameters": {},
        "credentials": {
          "ollamaApi": {
            "id": "n77wZlvZvtjVPvN8",
            "name": "Ollama account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "3d6d64f3-b1d3-4453-9f17-6d3a55273407",
        "name": "Answer questions with a vector store",
        "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
        "position": [
          620,
          320
        ],
        "parameters": {
          "description": "this tool will be used to retrieve knowledge"
        },
        "typeVersion": 1.1
      },
      {
        "id": "312d4235-a534-45f2-8cba-475b12874281",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -960,
          320
        ],
        "parameters": {
          "color": 7,
          "width": 660,
          "height": 480,
          "content": "## Local Rag AI AGENT  \n"
        },
        "typeVersion": 1
      },
      {
        "id": "832d366c-3eb4-4845-8661-067fc12d278b",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          240,
          240
        ],
        "parameters": {
          "color": 4,
          "width": 720,
          "height": 460,
          "content": "## Qdrant Vector store and Ollama Embeddings\n"
        },
        "typeVersion": 1
      },
      {
        "id": "49d25a7c-432c-4794-ad49-c6dc57685120",
        "name": "File Created",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          -760,
          900
        ],
        "parameters": {
          "event": "fileCreated",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "list",
            "value": "1uf6zZN51rgAuQgid4-Oi314f6mJIQdiB",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1uf6zZN51rgAuQgid4-Oi314f6mJIQdiB",
            "cachedResultName": "Daex"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "Libd6umJKamTZGV1",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "39b32d2b-b4c7-44de-8f86-f519be58e4b5",
        "name": "File Updated",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          -760,
          1100
        ],
        "parameters": {
          "event": "fileUpdated",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "list",
            "value": "1914m3M7kRzkd5RJqAfzRY9EBcJrKemZC",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1914m3M7kRzkd5RJqAfzRY9EBcJrKemZC",
            "cachedResultName": "Meeting Notes"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "Libd6umJKamTZGV1",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b5cf9dc7-7bd9-41a3-b736-6417de3cf4b0",
        "name": "Set File ID",
        "type": "n8n-nodes-base.set",
        "position": [
          -540,
          1000
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "10646eae-ae46-4327-a4dc-9987c2d76173",
                "name": "file_id",
                "type": "string",
                "value": "={{ $json.id }}"
              },
              {
                "id": "dd0aa081-79e7-4714-8a67-1e898285554c",
                "name": "folder_id",
                "type": "string",
                "value": "={{ $json.parents[0] }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "fee137e8-a785-4a07-a3f7-84f1d15438f8",
        "name": "Download File",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          -100,
          1000
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Set File ID').item.json.file_id }}"
          },
          "options": {
            "googleFileConversion": {
              "conversion": {
                "docsToFormat": "text/plain"
              }
            }
          },
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "Libd6umJKamTZGV1",
            "name": "Google Drive account"
          }
        },
        "executeOnce": true,
        "typeVersion": 3
      },
      {
        "id": "03adfdbf-1dc4-48c4-9263-5660f1abb505",
        "name": "Extract Document Text",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          120,
          1000
        ],
        "parameters": {
          "options": {},
          "operation": "text"
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "5490338c-f7a4-4e14-a493-b2f3d60af56f",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          460,
          1222.5
        ],
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "file_id",
                  "value": "={{ $('Set File ID').item.json.file_id }}"
                },
                {
                  "name": "folder_id",
                  "value": "={{ $('Set File ID').item.json.folder_id }}"
                }
              ]
            }
          }
        },
        "typeVersion": 1
      },
      {
        "id": "1bcb0f4f-92bb-40e6-a1a9-2a2acd232202",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          548,
          1420
        ],
        "parameters": {
          "options": {},
          "chunkSize": 100
        },
        "typeVersion": 1
      },
      {
        "id": "f3f1d04c-050e-4aa6-85b1-cbb4b3eaf591",
        "name": "Embeddings Ollama1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOllama",
        "position": [
          340,
          1220
        ],
        "parameters": {
          "model": "llama3.2:latest"
        },
        "credentials": {
          "ollamaApi": {
            "id": "n77wZlvZvtjVPvN8",
            "name": "Ollama account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "066b5093-a034-43e8-a5ea-72aea5770d6c",
        "name": "Qdrant Vector Store Insert",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
        "position": [
          340,
          980
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "qdrantCollection": {
            "__rl": true,
            "mode": "list",
            "value": "midjourney",
            "cachedResultName": "midjourney"
          }
        },
        "credentials": {
          "qdrantApi": {
            "id": "cbWjDnr5YQkhxhly",
            "name": "QdrantApi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d85eda28-8be7-4b0d-97bf-254c39a3f690",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -806.5,
          855
        ],
        "parameters": {
          "color": 5,
          "width": 1568.9362829025763,
          "height": 705.2695614889159,
          "content": "## Workflow to Create Local Knowledgebase from Google Drive Folder"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "ecc4d322-242f-4c1e-a43a-18d79efde064",
    "connections": {
      "Set File ID": {
        "main": [
          [
            {
              "node": "Download File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "File Created": {
        "main": [
          [
            {
              "node": "Set File ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "File Updated": {
        "main": [
          [
            {
              "node": "Set File ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Ollama Model": {
        "ai_languageModel": [
          [
            {
              "node": "Answer questions with a vector store",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Download File": {
        "main": [
          [
            {
              "node": "Extract Document Text",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings Ollama": {
        "ai_embedding": [
          [
            {
              "node": "Qdrant Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Ollama Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings Ollama1": {
        "ai_embedding": [
          [
            {
              "node": "Qdrant Vector Store Insert",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Qdrant Vector Store Insert",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Qdrant Vector Store": {
        "ai_vectorStore": [
          [
            {
              "node": "Answer questions with a vector store",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "Postgres Chat Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Extract Document Text": {
        "main": [
          [
            {
              "node": "Qdrant Vector Store Insert",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Answer questions with a vector store": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "",
    "meta": {},
    "name": "My workflow",
    "tags": [],
    "nodes": [
      {
        "id": "f611e34d-0de9-42b7-b438-bc522817f9ba",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          180,
          180
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {},
        "typeVersion": 1.2
      },
      {
        "id": "7c968986-dcc4-4a26-bedf-5a5f9c75d2dc",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          340,
          180
        ],
        "parameters": {
          "sessionKey": "={{ $json.message.chat.id }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "fd291678-8522-4e00-94bc-7033689f14b3",
        "name": "Google Docs",
        "type": "n8n-nodes-base.googleDocsTool",
        "position": [
          480,
          180
        ],
        "parameters": {
          "operation": "get",
          "documentURL": "https://docs.google.com/document/d/1os02TMG0h74DYE_mmv5utPr68LtV946otozP1YZTNr0/edit?tab=t.0"
        },
        "credentials": {},
        "typeVersion": 2
      },
      {
        "id": "d3e871cb-48b9-4921-8376-359f53e40942",
        "name": "Telegram Trigger",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -100,
          0
        ],
        "webhookId": "d546870e-898a-4d37-b290-a4b3e3eac311",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {},
        "typeVersion": 1.2
      },
      {
        "id": "8deb9aa3-4b45-4737-a6a5-4311fb460b04",
        "name": "Telegram",
        "type": "n8n-nodes-base.telegram",
        "position": [
          680,
          0
        ],
        "webhookId": "cfeeb7fc-6dad-4482-b8c7-73998bfc613f",
        "parameters": {
          "text": "={{ $json.output }}",
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {},
        "typeVersion": 1.2
      },
      {
        "id": "eac2e88c-0c0f-4451-bbe2-915de6e9ab1a",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -200,
          -100
        ],
        "parameters": {
          "width": 300,
          "height": 500,
          "content": "Telegram Trigger"
        },
        "typeVersion": 1
      },
      {
        "id": "c99be9a9-7368-4b22-be65-26108f8dc23a",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          120,
          -100
        ],
        "parameters": {
          "color": 4,
          "width": 500,
          "height": 500,
          "content": "Telegram Trigger"
        },
        "typeVersion": 1
      },
      {
        "id": "ba596aa6-e6fb-4df4-9bdb-7b75536cfbf6",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          -100
        ],
        "parameters": {
          "color": 3,
          "width": 280,
          "height": 500,
          "content": "Telegram Trigger"
        },
        "typeVersion": 1
      },
      {
        "id": "ccf10ec2-eae2-47be-9be7-7bf7b3d974cb",
        "name": "Customer Support AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          220,
          0
        ],
        "parameters": {
          "text": "={{ $json.message.text }}",
          "options": {
            "systemMessage": "You are a helpful Customer Support Agent, cross-reference the Google Doc for any customer queries for relevant information. If relevant information is not found, do not make up facts. Plainly let the user know that the information isn't available. \n\n#Tonality\nFriendly, casual and helpful. if user or customer says hi, inform them that you are a Friendly Customer Support Agent"
          },
          "promptType": "define"
        },
        "typeVersion": 2
      },
      {
        "id": "ac9ffbcd-0b7a-421e-92f4-5e367d6ba4c9",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -600,
          -100
        ],
        "parameters": {
          "color": 5,
          "width": 360,
          "height": 500,
          "content": "🤖 AI Customer Support Agent with Google Docs Knowledge (Telegram + OpenAI)\n\nThis no-code workflow turns your Telegram bot into an intelligent, always-on AI support agent that references your business documentation in Google Docs to respond to customer queries—instantly and accurately.\n\nWatch full step-by-step video tutorial of the build here:\nhttps://www.youtube.com/@Automatewithmarc\n\n🔧 How it works:\nTelegram Trigger – Captures incoming messages from users on your Telegram bot\n\nLangchain AI Agent (OpenAI GPT) – Interprets the message and uses RAG (retrieval-augmented generation) techniques to craft an answer\n\nGoogle Docs Tool – Connects to and retrieves context from your specified Google Doc (e.g. FAQ, SOPs, policies)\n\nMemory Buffer – Keeps track of recent chat history for more human-like conversations\n\nTelegram Reply Node – Sends the AI-generated response back to the user\n\n💡 Use Cases:\nE-commerce customer service\n\nSaaS product onboarding\n\nInternal helpdesk bot for teams\n\nWhatsApp-style support for digital businesses\n\n🧠 What makes this powerful:\nSupports complex questions by referencing a live Google Doc knowledge base\n\nWorks in plain conversational language (no buttons or forms needed)\n\nRuns 24/7 with zero code\n\nEasily extendable to Slack, WhatsApp, or email support\n\n🛠️ Tools used:\nTelegram Node (trigger + send)\n\nLangchain Agent with OpenAI GPT\n\nGoogle Docs Tool\n\nMemory Buffer\n\nSticky Notes for easy understanding"
        },
        "typeVersion": 1
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "",
    "connections": {
      "Google Docs": {
        "ai_tool": [
          [
            {
              "node": "Customer Support AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Customer Support AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "Customer Support AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Customer Support AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Customer Support AI Agent": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "bU9BBKV0yadVVd30",
    "meta": {
      "instanceId": "315ec16104c52c82cc21fd9b6adb469e4bd7c2899d0990cb255788b78628ebf4"
    },
    "name": "Adaptive & Conditional AI Chat Agent - www.quantralabs.com",
    "tags": [],
    "nodes": [
      {
        "id": "6cccf7c5-9d8b-4f11-a7e1-c1bcf48bb9fe",
        "name": "Query Classification",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "Classify a query into one of four categories: Factual, Analytical, Opinion, or Contextual.\n        \nReturns:\nstr: Query category",
        "position": [
          -660,
          880
        ],
        "parameters": {
          "text": "=Classify this query: {{ $('Combined Fields').item.json.user_query }}",
          "options": {
            "systemMessage": "You are an expert at classifying questions. \n\nClassify the given query into exactly one of these categories:\n- Factual: Queries seeking specific, verifiable information.\n- Analytical: Queries requiring comprehensive analysis or explanation.\n- Opinion: Queries about subjective matters or seeking diverse viewpoints.\n- Contextual: Queries that depend on user-specific context.\n\nReturn ONLY the category name, without any explanation or additional text."
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "937104bc-5756-4adb-af0b-3e8741536e44",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          -300,
          860
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Factual",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "87f3b50c-9f32-4260-ac76-19c05b28d0b4",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.output.trim() }}",
                      "rightValue": "Factual"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Analytical",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "f8651b36-79fa-4be4-91fb-0e6d7deea18f",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.output.trim() }}",
                      "rightValue": "Analytical"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Opinion",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "5dde06bc-5fe1-4dca-b6e2-6857c5e96d49",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.output.trim() }}",
                      "rightValue": "Opinion"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Contextual",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "bf97926d-7a0b-4e2f-aac0-a820f73344d8",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.output.trim() }}",
                      "rightValue": "Contextual"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {
            "fallbackOutput": 0
          }
        },
        "typeVersion": 3.2
      },
      {
        "id": "7346bf45-3f9b-4717-8cb5-52d829f0826c",
        "name": "Factual Strategy - Focus on Precision",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "Retrieval strategy for factual queries focusing on precision.",
        "position": [
          100,
          120
        ],
        "parameters": {
          "text": "=Enhance this factual query: {{ $('Combined Fields').item.json.user_query }}",
          "options": {
            "systemMessage": "=You are an expert at enhancing search queries.\n\nYour task is to reformulate the given factual query to make it more precise and specific for information retrieval. Focus on key entities and their relationships.\n\nProvide ONLY the enhanced query without any explanation."
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "ac1df57d-524c-4393-a81c-fb720f19b05e",
        "name": "Analytical Strategy - Comprehensive Coverage",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "Retrieval strategy for analytical queries focusing on comprehensive coverage.",
        "position": [
          100,
          660
        ],
        "parameters": {
          "text": "=Generate sub-questions for this analytical query: {{ $('Combined Fields').item.json.user_query }}",
          "options": {
            "systemMessage": "=You are an expert at breaking down complex questions.\n\nGenerate sub-questions that explore different aspects of the main analytical query.\nThese sub-questions should cover the breadth of the topic and help retrieve comprehensive information.\n\nReturn a list of exactly 3 sub-questions, one per line."
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "7df8350e-4f18-47fb-bd9a-c0238d218603",
        "name": "Opinion Strategy - Diverse Perspectives",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "Retrieval strategy for opinion queries focusing on diverse perspectives.",
        "position": [
          100,
          1200
        ],
        "parameters": {
          "text": "=Identify different perspectives on: {{ $('Combined Fields').item.json.user_query }}",
          "options": {
            "systemMessage": "=You are an expert at identifying different perspectives on a topic.\n\nFor the given query about opinions or viewpoints, identify different perspectives that people might have on this topic.\n\nReturn a list of exactly 3 different viewpoint angles, one per line."
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "0f9ef12d-7df4-4255-b5e2-27eb4e7ce982",
        "name": "Contextual Strategy - User Context Integration",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "Retrieval strategy for contextual queries integrating user context.",
        "position": [
          100,
          1740
        ],
        "parameters": {
          "text": "=Infer the implied context in this query: {{ $('Combined Fields').item.json.user_query }}",
          "options": {
            "systemMessage": "=You are an expert at understanding implied context in questions.\n\nFor the given query, infer what contextual information might be relevant or implied but not explicitly stated. Focus on what background would help answering this query.\n\nReturn a brief description of the implied context."
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "3c04f8e8-1304-436d-86eb-d905aa1cc261",
        "name": "Chat",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -1320,
          1020
        ],
        "webhookId": "56f626b5-339e-48af-857f-1d4198fc8a4d",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "e1daa9fc-62d2-4664-a9f3-dcdecf9071e6",
        "name": "Factual Prompt and Output",
        "type": "n8n-nodes-base.set",
        "position": [
          500,
          120
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a4a28ac2-4a56-46f6-8b86-f5d1a34b2ced",
                "name": "output",
                "type": "string",
                "value": "={{ $json.output }}"
              },
              {
                "id": "7aa6ce13-afbf-4871-b81c-6e9c722a53dc",
                "name": "prompt",
                "type": "string",
                "value": "You are a helpful assistant providing factual information. Answer the question based on the provided context. Focus on accuracy and precision. If the context doesn't contain the information needed, acknowledge the limitations."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "1429dfd5-709d-4065-9134-05820fad871b",
        "name": "Contextual Prompt and Output",
        "type": "n8n-nodes-base.set",
        "position": [
          500,
          1740
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a4a28ac2-4a56-46f6-8b86-f5d1a34b2ced",
                "name": "output",
                "type": "string",
                "value": "={{ $json.output }}"
              },
              {
                "id": "7aa6ce13-afbf-4871-b81c-6e9c722a53dc",
                "name": "prompt",
                "type": "string",
                "value": "You are a helpful assistant providing contextually relevant information. Answer the question considering both the query and its context. Make connections between the query context and the information in the provided documents. If the context doesn't fully address the specific situation, acknowledge the limitations."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "01c57856-4378-4085-bb67-2edf9b1164f9",
        "name": "Opinion Prompt and Output",
        "type": "n8n-nodes-base.set",
        "position": [
          500,
          1200
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a4a28ac2-4a56-46f6-8b86-f5d1a34b2ced",
                "name": "output",
                "type": "string",
                "value": "={{ $json.output }}"
              },
              {
                "id": "7aa6ce13-afbf-4871-b81c-6e9c722a53dc",
                "name": "prompt",
                "type": "string",
                "value": "You are a helpful assistant discussing topics with multiple viewpoints. Based on the provided context, present different perspectives on the topic. Ensure fair representation of diverse opinions without showing bias. Acknowledge where the context presents limited viewpoints."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "3cb3f5e1-c85c-4481-a147-8b3c419526ee",
        "name": "Analytical Prompt and Output",
        "type": "n8n-nodes-base.set",
        "position": [
          500,
          660
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a4a28ac2-4a56-46f6-8b86-f5d1a34b2ced",
                "name": "output",
                "type": "string",
                "value": "={{ $json.output }}"
              },
              {
                "id": "7aa6ce13-afbf-4871-b81c-6e9c722a53dc",
                "name": "prompt",
                "type": "string",
                "value": "You are a helpful assistant providing analytical insights. Based on the provided context, offer a comprehensive analysis of the topic. Cover different aspects and perspectives in your explanation. If the context has gaps, acknowledge them while providing the best analysis possible."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "34577e85-b067-49dd-90a6-048805de5118",
        "name": "Gemini Classification",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -680,
          1080
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash-lite"
        },
        "typeVersion": 1
      },
      {
        "id": "7257c1dd-56bb-4f50-b206-2edd55fdd7cf",
        "name": "Gemini Factual",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          80,
          340
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "47465499-74e8-4425-913a-2efd5c5e3441",
        "name": "Gemini Analytical",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          80,
          880
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "a7273940-82c8-44a9-8890-b00c1a741015",
        "name": "Chat Buffer Memory Analytical",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          240,
          880
        ],
        "parameters": {
          "sessionKey": "={{ $('Combined Fields').item.json.chat_memory_key }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 10
        },
        "typeVersion": 1.3
      },
      {
        "id": "6b573a7d-a6f0-4290-b3f1-3e36785bbee1",
        "name": "Chat Buffer Memory Factual",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          240,
          340
        ],
        "parameters": {
          "sessionKey": "={{ $('Combined Fields').item.json.chat_memory_key }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 10
        },
        "typeVersion": 1.3
      },
      {
        "id": "9b20e2d9-9c67-45a0-9dfe-03bafb62f67f",
        "name": "Gemini Opinion",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          80,
          1420
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "70489752-18b8-4676-a700-539c7b0fecb3",
        "name": "Chat Buffer Memory Opinion",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          240,
          1420
        ],
        "parameters": {
          "sessionKey": "={{ $('Combined Fields').item.json.chat_memory_key }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 10
        },
        "typeVersion": 1.3
      },
      {
        "id": "e32a0ce3-2f72-43ca-b12a-03e3cf1b7818",
        "name": "Gemini Contextual",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          80,
          1960
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "75c4f677-4c78-4a22-b0b4-44f3882c1a4e",
        "name": "Chat Buffer Memory Contextual",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          240,
          1960
        ],
        "parameters": {
          "sessionKey": "={{ $('Combined Fields').item.json.chat_memory_key }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 10
        },
        "typeVersion": 1.3
      },
      {
        "id": "31d68f85-3cfc-4c93-81f7-c27070bf7307",
        "name": "Embeddings",
        "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
        "position": [
          1020,
          1100
        ],
        "parameters": {
          "modelName": "models/text-embedding-004"
        },
        "typeVersion": 1
      },
      {
        "id": "53910aea-7326-4d59-8585-693cb05afc3e",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 700,
          "height": 520,
          "content": "## Factual Strategy\n**Retrieve precise facts and figures.**"
        },
        "typeVersion": 1
      },
      {
        "id": "87015bf7-0bf1-490f-90b4-96346cc51b7c",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          540
        ],
        "parameters": {
          "color": 7,
          "width": 700,
          "height": 520,
          "content": "## Analytical Strategy\n**Provide comprehensive coverage of a topics and exploring different aspects.**"
        },
        "typeVersion": 1
      },
      {
        "id": "b14886e0-e513-405d-92d5-d4a417280546",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          1080
        ],
        "parameters": {
          "color": 7,
          "width": 700,
          "height": 520,
          "content": "## Opinion Strategy\n**Gather diverse viewpoints on a subjective issue.**"
        },
        "typeVersion": 1
      },
      {
        "id": "77cd1373-d547-462b-85cb-6799e7fbae84",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          1620
        ],
        "parameters": {
          "color": 7,
          "width": 700,
          "height": 520,
          "content": "## Contextual Strategy\n**Incorporate user-specific context to fine-tune the retrieval.**"
        },
        "typeVersion": 1
      },
      {
        "id": "edfe1620-b040-466c-a8b2-a6f2aae565c5",
        "name": "Concatenate Context",
        "type": "n8n-nodes-base.summarize",
        "position": [
          1400,
          880
        ],
        "parameters": {
          "options": {},
          "fieldsToSummarize": {
            "values": [
              {
                "field": "document.pageContent",
                "separateBy": "other",
                "aggregation": "concatenate",
                "customSeparator": "={{ \"\\n\\n---\\n\\n\" }}"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "059f5b2e-52db-49f6-bee8-9dfcd5fd1ea4",
        "name": "Retrieve Documents from Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
        "position": [
          1040,
          880
        ],
        "parameters": {
          "mode": "load",
          "topK": 10,
          "prompt": "={{ $json.prompt }}\n\nUser query: \n{{ $json.output }}",
          "options": {},
          "qdrantCollection": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Combined Fields').item.json.vector_store_id }}"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "d1a2de81-c92b-459a-a2b6-bb6d171ba712",
        "name": "Set Prompt and Output",
        "type": "n8n-nodes-base.set",
        "position": [
          840,
          880
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "1d782243-0571-4845-b8fe-4c6c4b55379e",
                "name": "output",
                "type": "string",
                "value": "={{ $json.output }}"
              },
              {
                "id": "547091fb-367c-44d4-ac39-24d073da70e0",
                "name": "prompt",
                "type": "string",
                "value": "={{ $json.prompt }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "aa7dede0-8241-4428-84db-7a403935a052",
        "name": "Gemini Answer",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1680,
          1100
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "5a33f53d-2297-46a1-9508-54c1e4f168be",
        "name": "Answer",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1720,
          880
        ],
        "parameters": {
          "text": "=User query: {{ $('Combined Fields').item.json.user_query }}",
          "options": {
            "systemMessage": "={{ $('Set Prompt and Output').item.json.prompt }}\n\nUse the following context (delimited by <ctx></ctx>) and the chat history to answer the user query.\n<ctx>\n{{ $json.concatenated_document_pageContent }}\n</ctx>"
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "888d1b5e-151f-4fb7-a201-fa8706af6ae8",
        "name": "Chat Buffer Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          1860,
          1100
        ],
        "parameters": {
          "sessionKey": "={{ $('Combined Fields').item.json.chat_memory_key }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 10
        },
        "typeVersion": 1.3
      },
      {
        "id": "573efafe-0dca-46d9-98a9-2684277d411d",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          760,
          680
        ],
        "parameters": {
          "color": 7,
          "width": 820,
          "height": 580,
          "content": "## Perform adaptive retrieval\n**Find document considering both query and context.**"
        },
        "typeVersion": 1
      },
      {
        "id": "f4219ef7-16ce-4cc6-8b03-a9480b2daf55",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1600,
          680
        ],
        "parameters": {
          "color": 7,
          "width": 740,
          "height": 580,
          "content": "## Reply to the user integrating retrieval context"
        },
        "typeVersion": 1
      },
      {
        "id": "4fe79c8d-9670-4b2a-a7c7-5a2239906a14",
        "name": "Respond to Webhook",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          2080,
          880
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "ff99bc5a-bbbe-457d-b979-2ca1e04bd980",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -760,
          680
        ],
        "parameters": {
          "color": 7,
          "width": 700,
          "height": 580,
          "content": "## User query classification\n**Classify the query into one of four categories: Factual, Analytical, Opinion, or Contextual.**"
        },
        "typeVersion": 1
      },
      {
        "id": "c632a735-5a96-4a70-bf4c-6126e2e193f1",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          -1320,
          760
        ],
        "parameters": {
          "workflowInputs": {
            "values": [
              {
                "name": "user_query"
              },
              {
                "name": "chat_memory_key"
              },
              {
                "name": "vector_store_id"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "332b925d-0581-4b92-a7ce-83cbc8f66254",
        "name": "Combined Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          -1000,
          880
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "90ab73a2-fe01-451a-b9df-bffe950b1599",
                "name": "user_query",
                "type": "string",
                "value": "={{ $json.user_query || $json.chatInput }}"
              },
              {
                "id": "36686ff5-09fc-40a4-8335-a5dd1576e941",
                "name": "chat_memory_key",
                "type": "string",
                "value": "={{ $json.chat_memory_key || $('Chat').item.json.sessionId }}"
              },
              {
                "id": "4230c8f3-644c-4985-b710-a4099ccee77c",
                "name": "vector_store_id",
                "type": "string",
                "value": "={{ $json.vector_store_id || \"<ID HERE>\" }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "eab0d609-5d9b-4794-adb5-fd8a784f34b0",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1340,
          1300
        ],
        "parameters": {
          "width": 1280,
          "height": 1300,
          "content": "# Adaptive RAG Workflow\n\nThis n8n workflow implements a version of the Adaptive Retrieval-Augmented Generation (RAG) approach. It classifies user queries and applies different retrieval and generation strategies based on the query type (Factual, Analytical, Opinion, or Contextual) to provide more relevant and tailored answers from a knowledge base stored in a Qdrant vector store.\n\n## How it Works\n\n1.  **Input Trigger:**\n    * The workflow can be initiated via the built-in Chat interface or triggered by another n8n workflow.\n    * It expects inputs: `user_query`, `chat_memory_key` (for conversation history), and `vector_store_id` (specifying the Qdrant collection).\n    * A `Set` node (`Combined Fields`) standardizes these inputs.\n\n2.  **Query Classification:**\n    * A Google Gemini agent (`Query Classification`) analyzes the `user_query`.\n    * It classifies the query into one of four categories:\n        * **Factual:** Seeking specific, verifiable information.\n        * **Analytical:** Requiring comprehensive analysis or explanation.\n        * **Opinion:** Asking about subjective matters or seeking diverse viewpoints.\n        * **Contextual:** Depending on user-specific or implied context.\n\n3.  **Adaptive Strategy Routing:**\n    * A `Switch` node routes the workflow based on the classification result from the previous step.\n\n4.  **Strategy Implementation (Query Adaptation):**\n    * Depending on the route, a specific Google Gemini agent adapts the query or approach:\n        * **Factual Strategy:** Rewrites the query for better precision, focusing on key entities (`Factual Strategy - Focus on Precision`).\n        * **Analytical Strategy:** Breaks down the main query into multiple sub-questions to ensure comprehensive coverage (`Analytical Strategy - Comprehensive Coverage`).\n        * **Opinion Strategy:** Identifies different potential perspectives or angles related to the query (`Opinion Strategy - Diverse Perspectives`).\n        * **Contextual Strategy:** Infers implied context needed to answer the query effectively (`Contextual Strategy - User Context Integration`).\n    * Each strategy path uses its own chat memory buffer for the adaptation step.\n\n5.  **Retrieval Prompt & Output Setup:**\n    * Based on the *original* query classification, a `Set` node (`Factual/Analytical/Opinion/Contextual Prompt and Output`, combined via connections to `Set Prompt and Output`) prepares:\n        * The output from the strategy step (e.g., rewritten query, sub-questions, perspectives).\n        * A tailored system prompt for the final answer generation agent, instructing it how to behave based on the query type (e.g., focus on precision for Factual, present diverse views for Opinion).\n\n6.  **Document Retrieval (RAG):**\n    * The `Retrieve Documents from Vector Store` node uses the adapted query/output from the strategy step to search the specified Qdrant collection (`vector_store_id`).\n    * It retrieves the top relevant document chunks using Google Gemini embeddings.\n\n7.  **Context Preparation:**\n    * The content from the retrieved document chunks is concatenated (`Concatenate Context`) to form a single context block for the final answer generation.\n\n8.  **Answer Generation:**\n    * The final `Answer` agent (powered by Google Gemini) generates the response.\n    * It uses:\n        * The tailored system prompt set in step 5.\n        * The concatenated context from retrieved documents (step 7).\n        * The original `user_query`.\n        * The shared chat history (`Chat Buffer Memory` using `chat_memory_key`).\n\n9.  **Response:**\n    * The generated answer is sent back to the user via the `Respond to Webhook` node."
        },
        "typeVersion": 1
      },
      {
        "id": "1580b44f-bd48-43f8-b9ef-dbfd58042e68",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1100,
          680
        ],
        "parameters": {
          "color": 7,
          "width": 320,
          "height": 580,
          "content": "## ⚠️  If using in Chat mode\n\nUpdate the `vector_store_id` variable to the corresponding Qdrant ID needed to perform the documents retrieval."
        },
        "typeVersion": 1
      },
      {
        "id": "df475a3d-cec6-4a29-8d33-cfe8a1ae3d6c",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1720,
          1300
        ],
        "parameters": {
          "color": 5,
          "width": 360,
          "height": 200,
          "content": "## Quantra Labs \nFollow Us\nhttps://www.x.com/quantralabs\n\nConnect with Us\nhttps://www.linkedin.com/company/quantra-labs\n\nwww.quantralabs.com"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "c562673d-bddb-4abd-adef-59c2fb61e716",
    "connections": {
      "Chat": {
        "main": [
          [
            {
              "node": "Combined Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Answer": {
        "main": [
          [
            {
              "node": "Respond to Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "Factual Strategy - Focus on Precision",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Analytical Strategy - Comprehensive Coverage",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Opinion Strategy - Diverse Perspectives",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Contextual Strategy - User Context Integration",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings": {
        "ai_embedding": [
          [
            {
              "node": "Retrieve Documents from Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Answer": {
        "ai_languageModel": [
          [
            {
              "node": "Answer",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Factual": {
        "ai_languageModel": [
          [
            {
              "node": "Factual Strategy - Focus on Precision",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Opinion": {
        "ai_languageModel": [
          [
            {
              "node": "Opinion Strategy - Diverse Perspectives",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Combined Fields": {
        "main": [
          [
            {
              "node": "Query Classification",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Analytical": {
        "ai_languageModel": [
          [
            {
              "node": "Analytical Strategy - Comprehensive Coverage",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Contextual": {
        "ai_languageModel": [
          [
            {
              "node": "Contextual Strategy - User Context Integration",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Chat Buffer Memory": {
        "ai_memory": [
          [
            {
              "node": "Answer",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Concatenate Context": {
        "main": [
          [
            {
              "node": "Answer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Query Classification": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Classification": {
        "ai_languageModel": [
          [
            {
              "node": "Query Classification",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Set Prompt and Output": {
        "main": [
          [
            {
              "node": "Retrieve Documents from Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Factual Prompt and Output": {
        "main": [
          [
            {
              "node": "Set Prompt and Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Opinion Prompt and Output": {
        "main": [
          [
            {
              "node": "Set Prompt and Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Chat Buffer Memory Factual": {
        "ai_memory": [
          [
            {
              "node": "Factual Strategy - Focus on Precision",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Chat Buffer Memory Opinion": {
        "ai_memory": [
          [
            {
              "node": "Opinion Strategy - Diverse Perspectives",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Analytical Prompt and Output": {
        "main": [
          [
            {
              "node": "Set Prompt and Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Contextual Prompt and Output": {
        "main": [
          [
            {
              "node": "Set Prompt and Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Chat Buffer Memory Analytical": {
        "ai_memory": [
          [
            {
              "node": "Analytical Strategy - Comprehensive Coverage",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Chat Buffer Memory Contextual": {
        "ai_memory": [
          [
            {
              "node": "Contextual Strategy - User Context Integration",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "Combined Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Retrieve Documents from Vector Store": {
        "main": [
          [
            {
              "node": "Concatenate Context",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Factual Strategy - Focus on Precision": {
        "main": [
          [
            {
              "node": "Factual Prompt and Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Opinion Strategy - Diverse Perspectives": {
        "main": [
          [
            {
              "node": "Opinion Prompt and Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analytical Strategy - Comprehensive Coverage": {
        "main": [
          [
            {
              "node": "Analytical Prompt and Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Contextual Strategy - User Context Integration": {
        "main": [
          [
            {
              "node": "Contextual Prompt and Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "I0Tzx8whIWYdQJVn",
    "meta": {
      "instanceId": "a1ae5c8dc6c65e674f9c3947d083abcc749ef2546dff9f4ff01de4d6a36ebfe6",
      "templateCredsSetupCompleted": true
    },
    "name": "Generate Avatar Videos from Latest AI News using Dumpling AI and HeyGen",
    "tags": [],
    "nodes": [
      {
        "id": "8a457904-7d80-4bf8-a433-d25dbce33c45",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -840,
          -95
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "90cf1daa-9652-4717-84af-f96a1a3d7dc6",
        "name": "Dumpling AI: Search AI News",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -620,
          -95
        ],
        "parameters": {
          "url": "https://app.dumplingai.com/api/v1/search-news",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"query\": \"AI Agent\",\n  \"language\": \"en\",\n  \"dateRange\": \"pastHour\",\n  \"page\": \"1\"\n}\n",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "RLFzAcGRepr5eXZB",
            "name": "Dumpling AI-n8n"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "321da41d-6a13-4a00-95c1-915fa6d8f5e6",
        "name": "Split: Individual News Items",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -400,
          -95
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "news"
        },
        "typeVersion": 1
      },
      {
        "id": "d7e5fcf2-7a24-4277-9459-9e828d3a98ef",
        "name": "Limit: Top 4 News Results",
        "type": "n8n-nodes-base.limit",
        "position": [
          -180,
          -95
        ],
        "parameters": {
          "maxItems": 4
        },
        "typeVersion": 1
      },
      {
        "id": "c1847dce-9564-44ae-b9a9-1ac48e42d2c8",
        "name": "Dumpling AI: Scrape Article Content",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          40,
          -95
        ],
        "parameters": {
          "url": "https://app.dumplingai.com/api/v1/scrape",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"url\": \"{{ $json.link }}\",\n  \"cleaned\": \"true\"\n}\n",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "RLFzAcGRepr5eXZB",
            "name": "Dumpling AI-n8n"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f6e8c80e-72b7-47ba-a3b6-0d43a0ee1615",
        "name": " Combine: Merge Scraped News Content",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          260,
          -95
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "content"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "7c203f11-51ca-4aaa-a3c5-a571af36accd",
        "name": "GPT-4o Agent: Write Video Script",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          480,
          -95
        ],
        "parameters": {
          "text": "=Here is the topic:{{ $json.content }}\n\n\nHere is the news article:{{ $('Dumpling AI: Search AI News').item.json.searchParameters.q }}\n",
          "options": {
            "systemMessage": "=You are a creative content writer. I will give you a news article and the intended topic or angle I want to focus on. Your job is to turn that into a short, engaging script suitable for a 30 to 60-second video. Write in a natural, conversational tone that sounds like someone talking to a general audience. Keep it simple, clear, and focused on the most interesting or important angle based on the topic I provide. Avoid technical jargon. The goal is to grab attention and make the message easy to understand and relatable. Very important: Output the final script as a single line only — no new lines, no paragraph breaks, no titles or formatting. Just plain text in one continuous sentence."
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "b5bc7652-ba15-4d8d-a3ab-08e65f7ea54f",
        "name": " GPT-4o Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          568,
          125
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "dd8NvMC6rvx8RITo",
            "name": "OpenAi account 2"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c60ba871-f5a9-4ec2-b3d9-5aa4583c8f43",
        "name": " HeyGen: Generate Avatar Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          856,
          -95
        ],
        "parameters": {
          "url": "https://api.heygen.com/v2/video/generate",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"video_inputs\": [\n    {\n      \"character\": {\n        \"type\": \"avatar\",\n        \"avatar_id\": \"\",\n        \"avatar_style\": \"normal\"\n      },\n      \"voice\": {\n        \"type\": \"text\",\n        \"input_text\": \"{{ $json.output }}\",\n        \"voice_id\": \"\",\n        \"speed\": 1.1\n      }\n    }\n  ],\n  \"dimension\": {\n    \"width\": 1280,\n    \"height\": 720\n  }\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "h1B8sEXHl3ik4IwS",
            "name": "heygen 2"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "97b7db8d-2233-4bb5-b615-a93885ddfcfa",
        "name": "Wait: For HeyGen to Process",
        "type": "n8n-nodes-base.wait",
        "position": [
          1076,
          -95
        ],
        "webhookId": "f78db6d8-9a63-4961-8abb-ac44b4c230d1",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "33b34d1e-4674-44fe-937e-ad907a6ff6ca",
        "name": "HeyGen: Check Video Status",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1296,
          -95
        ],
        "parameters": {
          "url": "https://api.heygen.com/v1/video_status.get",
          "options": {},
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "video_id",
                "value": "={{ $json.data.video_id }}"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "h1B8sEXHl3ik4IwS",
            "name": "heygen 2"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "27a6d57c-f518-43fd-93f0-2a237ccf0a99",
        "name": "IF: Video Completed?",
        "type": "n8n-nodes-base.if",
        "position": [
          1516,
          -170
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "fbed8c0e-f2ad-4519-9eb9-1423731654ea",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.data.status }}",
                "rightValue": "completed"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "99219ffb-7d15-4393-877a-a9cb592c025b",
        "name": " Wait: Retry if Not Complete",
        "type": "n8n-nodes-base.wait",
        "position": [
          1736,
          5
        ],
        "webhookId": "82e9f0a0-05e2-4eae-9b8c-d08e554a9704",
        "parameters": {
          "amount": 20
        },
        "typeVersion": 1.1
      },
      {
        "id": "6761efd6-79c8-4a79-970e-a30d26a18336",
        "name": "Google Sheets: Log Video URL",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1736,
          -220
        ],
        "parameters": {
          "columns": {
            "value": {
              "Video link": "={{ $json.data.video_url }}"
            },
            "schema": [
              {
                "id": "Video link",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Video link",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Video link"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1AUADRf5MafbEazIZKuEBuDb7ETBEpCI0WSEnxFDJqn4/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1AUADRf5MafbEazIZKuEBuDb7ETBEpCI0WSEnxFDJqn4/edit?usp=drivesdk",
            "cachedResultName": "Videos"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "GaJqJHuS5mQxap7q",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "294f5c10-e0fa-42c2-8a7a-f823ae4ed477",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -840,
          -700
        ],
        "parameters": {
          "width": 800,
          "height": 660,
          "content": "### 🎥 Workflow Overview: Auto-Generate AI News Avatar Videos\n\nThis workflow runs every hour and creates an avatar-style video summarizing \nthe latest AI-related news.\n\n**Here’s what it does:**\n- Searches for recent AI Agent news using Dumpling AI\n- Scrapes the content from the top 4 articles\n- Merges article content into one body of text\n- Uses GPT-4o to generate a short, casual video script\n- Sends the script to HeyGen to create an avatar video\n- Waits for the video to finish rendering\n- Logs the video link in a Google Sheet\n\n🛠 Tools Used:\n- Dumpling AI (News search + scraping)\n- OpenAI GPT-4o (Script writing)\n- HeyGen (Video generation)\n- Google Sheets (Tracking links)\n\n📌 Credentials Required:\n- Dumpling AI API (via HTTP Header credentials)\n- HeyGen API key (via Bearer YOUR_TOKEN_HERE credential)\n- Google Sheets + OpenAI account\n\nCustomize the topic (e.g., change \"AI Agent\" to something else), avatar, voice, \nor video style to suit your brand.\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "3339c6da-749b-481d-85d4-e90f923c83c9",
    "connections": {
      " GPT-4o Model": {
        "ai_languageModel": [
          [
            {
              "node": "GPT-4o Agent: Write Video Script",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Dumpling AI: Search AI News",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "IF: Video Completed?": {
        "main": [
          [
            {
              "node": "Google Sheets: Log Video URL",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": " Wait: Retry if Not Complete",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit: Top 4 News Results": {
        "main": [
          [
            {
              "node": "Dumpling AI: Scrape Article Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HeyGen: Check Video Status": {
        "main": [
          [
            {
              "node": "IF: Video Completed?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Dumpling AI: Search AI News": {
        "main": [
          [
            {
              "node": "Split: Individual News Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait: For HeyGen to Process": {
        "main": [
          [
            {
              "node": "HeyGen: Check Video Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Wait: Retry if Not Complete": {
        "main": [
          [
            {
              "node": "HeyGen: Check Video Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split: Individual News Items": {
        "main": [
          [
            {
              "node": "Limit: Top 4 News Results",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " HeyGen: Generate Avatar Video": {
        "main": [
          [
            {
              "node": "Wait: For HeyGen to Process",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GPT-4o Agent: Write Video Script": {
        "main": [
          [
            {
              "node": " HeyGen: Generate Avatar Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Dumpling AI: Scrape Article Content": {
        "main": [
          [
            {
              "node": " Combine: Merge Scraped News Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Combine: Merge Scraped News Content": {
        "main": [
          [
            {
              "node": "GPT-4o Agent: Write Video Script",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "KTF9dWBSWK1Mnjxu",
    "name": "AI Video & Voice Clone",
    "tags": [],
    "nodes": [
      {
        "id": "657bc2dd-01f2-4292-acd1-d447c3a63283",
        "name": "Google Sheets Trigger",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          -288,
          0
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "REPLACE_WITH_YOUR_SHEET_TAB",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/REPLACE_WITH_YOUR_SHEET_ID/edit#REPLACE_WITH_YOUR_SHEET_TAB",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "REPLACE_WITH_YOUR_SHEET_ID",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/REPLACE_WITH_YOUR_SHEET_ID/edit",
            "cachedResultName": "Leads"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "bba9b597-557a-49b5-9eb5-09fe7cc0b9f9",
        "name": "Research Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          240,
          0
        ],
        "parameters": {
          "text": "=Full Name:{{ $json.Name }}\nEmail Address:{{ $json['Email Address'] }}\nPhone Number: {{ $json['Phone Number'] }}\nCompany:{{ $json.Company }}\nIndustry: {{ $json.Industry }}\nLinkedIn Profile: {{ $json['LinkedIn URL'] }}\n",
          "options": {
            "systemMessage": "=You are Outbound Research Agent for Purple Unicorn, an influencer marketing agency.\nYour mission: Use Preplexity Tool to research the assigned prospect and return insights that equip the sales team to personalize highly relevant outreach.\n\nYou will be given the following input about the lead:\nFull Name, Email Address, Phone Number, Company Name, Industry, Linked URL\n\nYour responsibilities:\n\nUsing Perplexity Tool: \n\nResearch the PERSON\n\nCurrent role & main responsibilities\n\nRecent achievements, interviews, social activity, thought-leadership topics\n\nInterests related to content, influencers, social media, brand building\n\nResearch the COMPANY\n\nWhat they sell, who they serve, and main value propositions\n\nRecent news, campaigns, marketing strategy insights (especially digital/influencer)\n\nGrowth signals: funding, hiring trends, product launches\n\nCurrent presence on Instagram / TikTok / YouTube / LinkedIn if available\n\nIdentify OPPORTUNITIES\n\nWhere influencer marketing could help:\n\nIncrease brand awareness\n\nImprove social engagement & conversions\n\nModernize outdated marketing approach\n\nExample influencers or campaign angles aligned to their industry/customer base\n\nExtract TRIGGERS\n\nWhat makes this lead worth contacting right now\n\nTie insights directly to Purple Unicorn’s value (high-ROI influencer campaigns)\n\nTone & Format Requirements:\n\nBe accurate, concise, and compelling\n\nNo fluff, no generic statements\n\nUse bullet points and short actionable sentences\n\nInclude 3–5 customized outreach hooks that the SDR can directly use\n\nKeep strict data integrity — state only verifiable insights\n\nOutput Format (always follow this structure)\n\nProspect Overview\n\nName: …\n\nRole: …\n\nKey interests: …\n\nCompany Overview\n\nWhat they do: …\n\nTarget customers: …\n\nMarketing status: …\n\nOpportunities for Influencer Marketing (Purple Unicorn)\n\n…\n\nSales Triggers\n\n…\n\n3–5 Personalized Outreach Hooks\n\n…\n\n…\n\n…"
          },
          "promptType": "define"
        },
        "typeVersion": 3
      },
      {
        "id": "9452861e-a74c-45bf-8ef5-905c04172888",
        "name": "Message a model in Perplexity",
        "type": "n8n-nodes-base.perplexityTool",
        "position": [
          304,
          208
        ],
        "parameters": {
          "model": "sonar-pro",
          "options": {},
          "messages": {
            "message": [
              {
                "content": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('message0_Text', ``, 'string') }}"
              }
            ]
          },
          "simplify": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Simplify_Output', ``, 'boolean') }}",
          "requestOptions": {}
        },
        "typeVersion": 1
      },
      {
        "id": "a191cb19-4d54-4ccf-8489-733acbbb6a96",
        "name": "Scripting Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          672,
          0
        ],
        "parameters": {
          "text": "={{ $json.output }}",
          "options": {
            "systemMessage": "=You are Script Writing Agent for Marc from Purple Unicorn, an influencer marketing agency. \n\nYou will receive research insights about a single prospect and their company.\nYour job is to write a personalized 30-second outreach script for narration by an AI video avatar.\n\nRequirements:\n\nTone & Voice\n\nCasual, confident, and friendly\n\nSounds like a real human talking — no corporate jargon\n\nPersonalized references based on the provided research (THIS IS CRITICAL)\n\nFocus on building curiosity and interest, not hard selling\n\nContent Rules\n\nIntro with the prospect’s name and what caught our attention about their work or company\n\nBriefly connect Purple Unicorn’s influencer marketing expertise to their goals or current marketing status\n\nMention 1–2 specific opportunities or triggers discovered in research\n\nEnd with a light, non-pushy call to chat (“worth a quick convo?”)\n\nOutput Format\n\nOnly return the script as plain text (no bullet points or explanations)\n\n4–6 short conversational paragraphs\n\nTotal read time: ~30 seconds (80–110 words)\n\nProhibited\n\nNo email-style formatting (no subject lines, no signatures)\n\nNo emojis\n\nNo generic filler like “I hope you’re well”\n\nNo unverified claims\n\nExample structure (for reference — do not include in output)\n\nHi [Name], loved your work on…\nNoticed your company is pushing into…\nAt Purple Unicorn, we help brands like yours…\nThought we could explore…\nUp for a quick chat?\n\nStay focused on making the prospect feel seen, understood, and excited enough to respond.\n\n##Output rule\nOutput only valid text format without special characters to make sure that it will be a valid JSON input in the next node"
          },
          "promptType": "define"
        },
        "typeVersion": 3
      },
      {
        "id": "4cb305d9-0838-4d74-8665-4f948e11b626",
        "name": "Heygen Clone AI Creation",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1232,
          0
        ],
        "parameters": {
          "url": "https://api.heygen.com/v2/video/generate",
          "method": "POST",
          "options": {},
          "jsonBody": "={{\n  {\n    \"video_inputs\": [\n      {\n        \"character\": {\n          \"type\": \"avatar\",\n          \"avatar_id\": \"c84a546eb24e496da33673c336624d1c\",\n          \"avatar_style\": \"normal\"\n        },\n        \"voice\": {\n          \"type\": \"text\",\n          \"input_text\": $json.output,\n          \"voice_id\": \"e690edf698c043409a59fbfc5175c4b1\",\n          \"speed\": 1.1\n        }\n      }\n    ],\n    \"dimension\": { \"width\": 720, \"height\": 1280 }\n  }\n}}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "typeVersion": 4.3
      },
      {
        "id": "2526777e-d184-4ffa-96df-581a3899cf24",
        "name": "Send a message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2304,
          0
        ],
        "parameters": {
          "sendTo": "your-email@example.com",
          "message": "={{ $json.output.body }}\n\nListen my quick assessment of your business:\n{{ $('GET Result').item.json.data.video_url }}",
          "options": {
            "appendAttribution": false
          },
          "subject": "={{ $json.output.title }}",
          "emailType": "text"
        },
        "typeVersion": 2.1
      },
      {
        "id": "76a46ccd-e1f9-4022-a18e-9f760436dff9",
        "name": "Send an SMS/MMS/WhatsApp message",
        "type": "n8n-nodes-base.twilio",
        "position": [
          1584,
          336
        ],
        "parameters": {
          "to": "REPLACE_PHONE",
          "from": "REPLACE_PHONE",
          "message": "={{ $json.webContentLink }}",
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "f0741d59-b5d6-4578-b24f-7ddf91527788",
        "name": "Code in JavaScript",
        "type": "n8n-nodes-base.code",
        "position": [
          -96,
          0
        ],
        "parameters": {
          "jsCode": "// \"items\" is an array of all rows coming from Google Sheets\n// We only want the latest one (usually the last item in the array)\n\nif (items.length === 0) {\n\treturn [];\n}\n\n// Take the last item (most recently added row)\nconst lastItem = items[items.length - 1];\n\n// Return it as a single-item array so n8n can continue as usual\nreturn [lastItem];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "f75ff906-4b9f-4cc8-8384-60bc6f2d4e6d",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          112,
          208
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5.1",
            "cachedResultName": "gpt-5.1"
          },
          "options": {
            "timeout": 6000000
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "55a89042-e5ac-4c20-bb54-60e0400ab684",
        "name": "OpenRouter Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          640,
          208
        ],
        "parameters": {
          "model": "openai/gpt-5.1",
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "b9cab21d-8851-4e36-90fb-9f8bdc5d3d71",
        "name": "Convert text to speech",
        "type": "@elevenlabs/n8n-nodes-elevenlabs.elevenLabs",
        "position": [
          1152,
          336
        ],
        "parameters": {
          "text": "={{ $json.output }}",
          "voice": {
            "__rl": true,
            "mode": "id",
            "value": "UEKYgullGqaF0keqT8Bu"
          },
          "resource": "speech",
          "requestOptions": {},
          "additionalOptions": {}
        },
        "typeVersion": 1
      },
      {
        "id": "d27df0a6-1151-443a-86c0-28592890c5a4",
        "name": "Upload file",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1360,
          336
        ],
        "parameters": {
          "name": "Audio",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "REPLACE_WITH_YOUR_FOLDER_ID",
            "cachedResultUrl": "https://drive.google.com/drive/folders/REPLACE_WITH_YOUR_FOLDER_ID",
            "cachedResultName": "n8n Folder"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "54f9ad85-bc0d-4f02-9c30-8168060bba3f",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1056,
          -80
        ],
        "parameters": {
          "color": 6,
          "width": 1536,
          "height": 288,
          "content": "Intro Video Generation + Send to Email"
        },
        "typeVersion": 1
      },
      {
        "id": "7c816c51-b4fe-47e7-8b50-a6ba687ff359",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1056,
          240
        ],
        "parameters": {
          "color": 4,
          "width": 752,
          "height": 288,
          "content": "Voice Generation and Text"
        },
        "typeVersion": 1
      },
      {
        "id": "70dcb589-3e92-41f7-9208-1c3afd6a7f71",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          64,
          -96
        ],
        "parameters": {
          "color": 4,
          "width": 960,
          "height": 624,
          "content": "Research & Script"
        },
        "typeVersion": 1
      },
      {
        "id": "0f2d716c-7aa0-441c-936c-c4f3cc1674d3",
        "name": "Wait 30s",
        "type": "n8n-nodes-base.wait",
        "position": [
          1440,
          0
        ],
        "parameters": {
          "amount": 30
        },
        "typeVersion": 1.1
      },
      {
        "id": "9364537a-8917-43ab-b9c2-12ceec88d1c0",
        "name": "GET Result",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1648,
          0
        ],
        "parameters": {
          "url": "https://api.heygen.com/v1/video_status.get",
          "options": {},
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "video_id",
                "value": "={{ $json.data.video_id }}"
              }
            ]
          }
        },
        "typeVersion": 4.3
      },
      {
        "id": "aa799380-8601-4d87-a2a2-f8e47fee29cb",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1856,
          0
        ],
        "parameters": {
          "text": "={{ $('Research Agent').item.json.output }}",
          "options": {
            "systemMessage": "You are the Outreach Email Copywriter Agent for Purple Unicorn Marketing Agency.\nYour task is to generate one short and personalized outbound email for each prospect.\n\nRequirements:\n\nYou will receive prospect details in the user input\n\nUse their company information or recent updates to personalize the message\n\nThe email must reference a personalized intro video included in the outreach\n\nMarc from Purple Unicorn Agency is the sender\n\nTone: friendly, clear, and value-led\n\nKeep it short and impactful (no long paragraphs)\n\nSTRICT Output Format\n\nYou must output valid JSON only, with exactly two properties:\n\n{\n  \"title\": \"A short, attention-grabbing subject line\",\n  \"body\": \"Email body text here. Keep paragraphs short and include a reference to the personalized video.\"\n}\n\n\nMandatory rules\n\nNo additional text outside the JSON\n\nNo markdown formatting\n\nNo emojis\n\nNo explanations or annotations\n\nIf the required information is insufficient, use placeholders rather than adding commentary\n\nIf your output does not strictly match the JSON structure above, it will be considered incorrect."
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 3
      },
      {
        "id": "f236ceb1-bb32-4058-af83-0b079263f7cf",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1824,
          224
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "06c9c350-5107-45dc-bf89-8df081dda40f",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2032,
          208
        ],
        "parameters": {
          "autoFix": true,
          "jsonSchemaExample": "{\n  \"title\": \"…\",\n  \"body\": \"…\"\n}\n"
        },
        "typeVersion": 1.3
      },
      {
        "id": "a7abfece-d384-40f7-8c1a-a48609a6ce73",
        "name": "OpenAI Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1968,
          416
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "64bb87e2-5094-44b9-a0e3-a9c4d0805f66",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -336,
          -96
        ],
        "parameters": {
          "color": 7,
          "width": 368,
          "height": 624
        },
        "typeVersion": 1
      },
      {
        "id": "7f7bc175-94e8-4a40-9b58-c875fd196c8d",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1200,
          -96
        ],
        "parameters": {
          "width": 800,
          "height": 816,
          "content": "What this Workflow Does\n\nAutomates the creation of hyper-personalized outreach videos, voice notes, and emails whenever a new lead is added to Google Sheets.\n\nWatch step-by-step tutorial of this build here: https://www.youtube.com/watch?v=q9AAh9zRou4\n\nIt performs:\nLead Intake (Google Sheets Trigger → Latest Row Extractor)\nDeep AI Research (Perplexity + Research Agent)\nPersonalized Scriptwriting (Script Agent)\nHeyGen Video Generation\nElevenLabs Voice Note Generation\nUpload Audio to Google Drive\nEmail Delivery (video + voice note + personalized email)\nOptional SMS/WhatsApp Message via Twilio\n\nHigh-Level Flow\nGoogle Sheets → Research → Script → Video → Voice → Drive → Email/SMS\n\nNode Lane Explanations\n\nResearch & Script Lane\nCode Node: grabs latest lead from the sheet\nResearch Agent: uses Perplexity to gather insights\nScript Agent: creates a 30-sec personalized outreach script\nOpenAI/OpenRouter models: support research + script consistency\nVideo Generation Lane\nHeyGen Request: creates avatar video based on script\nWait → GET Result: polls until video is ready\nAI Email Agent: generates JSON email (subject + body referencing video)\nVoice & Upload Lane\nElevenLabs: converts script or summary to voice note\nGoogle Drive Upload: stores voice file\nTwilio (optional): sends voice note link via SMS/WhatsApp\nEmail Output\nGmail Node: sends the outreach email + video link + voice note link to your inbox\n\nPurpose\nCreate SDR-ready, highly-personalized outreach assets using AI — end-to-end automated."
        },
        "typeVersion": 1
      },
      {
        "id": "8eaee9ef-0431-40e6-8ddb-6937d0fa05a2",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -336,
          -496
        ],
        "parameters": {
          "width": 688,
          "height": 368,
          "content": "@[youtube](q9AAh9zRou4)"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "8a4f77a5-2630-43ff-b68a-64fe45050f1c",
    "connections": {
      "AI Agent": {
        "main": [
          [
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 30s": {
        "main": [
          [
            {
              "node": "GET Result",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GET Result": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload file": {
        "main": [
          [
            {
              "node": "Send an SMS/MMS/WhatsApp message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Research Agent": {
        "main": [
          [
            {
              "node": "Scripting Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Scripting Agent": {
        "main": [
          [
            {
              "node": "Heygen Clone AI Creation",
              "type": "main",
              "index": 0
            },
            {
              "node": "Convert text to speech",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Research Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "Research Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Structured Output Parser",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets Trigger": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Scripting Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Convert text to speech": {
        "main": [
          [
            {
              "node": "Upload file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Heygen Clone AI Creation": {
        "main": [
          [
            {
              "node": "Wait 30s",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Message a model in Perplexity": {
        "ai_tool": [
          [
            {
              "node": "Research Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "templateId": "universal-device-assistant-v1",
      "templateCreatedDate": "2024-01-15T00:00:00.000Z"
    },
    "name": "Universal Digital Device Support Assistant",
    "tags": [],
    "nodes": [
      {
        "id": "3a4f96f5-e0a5-46a5-b604-9c8a7b45e8a1",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -900,
          -420
        ],
        "parameters": {
          "width": 383.5309107901297,
          "height": 320.7616136919316,
          "content": "## 🎯 UNIVERSAL DEVICE SUPPORT ASSISTANT\n\nThis workflow creates an AI-powered support system for ANY device:\n• Kitchen appliances\n• Electronics\n• Smart home devices\n• Power tools\n• Medical equipment\n\n### 📊 Performance:\n• Response time: <3 seconds\n• Accuracy: 95%+\n• Languages: Unlimited\n\n### 🔧 Setup:\n1. Add API credentials\n2. Upload device manuals\n3. Activate workflow\n4. Share webhook URL"
        },
        "typeVersion": 1
      },
      {
        "id": "configuration-note",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -900,
          100
        ],
        "parameters": {
          "width": 350,
          "height": 350,
          "content": "## ⚙️ CONFIGURATION CHECKLIST\n\n- [ ] OpenAI API Key added\n- [ ] Pinecone API Key added\n- [ ] Webhook path configured\n- [ ] CORS headers enabled\n- [ ] Memory window set\n- [ ] Chunk size optimized\n- [ ] Test manual uploaded\n- [ ] Response tested\n\n💡 **Tips:**\n• Use chunk size 1000 for manuals\n• Enable CORS for web apps\n• Test with simple queries first"
        },
        "typeVersion": 1
      },
      {
        "id": "example-queries",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -400,
          -500
        ],
        "parameters": {
          "width": 320,
          "height": 280,
          "content": "## 💬 EXAMPLE USER QUERIES\n\n**Test these to verify setup:**\n\n• 'My dishwasher shows error E24'\n• 'How do I set up my smart thermostat?'\n• 'Coffee machine not heating'\n• 'Router red light blinking'\n• 'TV remote not working'\n• 'Washing machine making noise'\n• 'Printer paper jam'\n• 'Vacuum cleaner lost suction'"
        },
        "typeVersion": 1
      },
      {
        "id": "troubleshooting",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          -400
        ],
        "parameters": {
          "width": 300,
          "height": 300,
          "content": "## 🔍 TROUBLESHOOTING\n\n**❌ No response:**\n→ Check API keys\n→ Verify webhook is active\n→ Check execution logs\n\n**❌ Poor answers:**\n→ Upload more detailed manuals\n→ Adjust chunk size\n→ Improve system prompt\n\n**❌ Slow response:**\n→ Reduce token limit\n→ Optimize vector search\n→ Use caching"
        },
        "typeVersion": 1
      },
      {
        "id": "extension-ideas",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          100
        ],
        "parameters": {
          "width": 300,
          "height": 320,
          "content": "## 🚀 EXTENSION IDEAS\n\n• Add image recognition for visual guides\n• Connect to IoT devices for real-time data\n• Integrate with ticketing systems\n• Add multi-language support\n• Create mobile app\n• Add voice interface\n• Connect to manufacturer APIs\n• Add warranty tracking\n• Create maintenance reminders\n• Build analytics dashboard"
        },
        "typeVersion": 1
      },
      {
        "id": "webhook-entry",
        "name": "Webhook - User Query",
        "type": "n8n-nodes-base.webhook",
        "notes": "Receives user queries about any household device",
        "position": [
          -680,
          -260
        ],
        "webhookId": "device-assistant",
        "parameters": {
          "path": "device-assistant",
          "options": {
            "responseHeaders": {
              "entries": [
                {
                  "name": "Access-Control-Allow-Origin",
                  "value": "*"
                }
              ]
            }
          },
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 1.1
      },
      {
        "id": "ai-agent",
        "name": "AI Agent - Device Expert",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "Processes queries using LLM and knowledge base",
        "position": [
          -280,
          -260
        ],
        "parameters": {
          "options": {
            "systemMessage": "You are a Universal Digital Device Support Assistant - an intelligent AI helper for any household or technical device.\n\n## Your Role\n- Technical expert for all types of devices (household appliances, electronics, smart home, etc.)\n- Specialist in setup, configuration, and troubleshooting\n- Patient explainer using official manuals and documentation\n\n## Your Knowledge Base\nYou have access to device manuals through the vector database. Use this information for accurate, step-by-step guidance.\n\n## Communication Style\n- Friendly and patient\n- Technically accurate yet understandable\n- Structured responses with clear steps\n- Always reference manual sections when available\n\n## Key Functions\n- Initial setup and installation\n- Configuration and optimization\n- Troubleshooting common issues\n- Maintenance recommendations\n- Safety guidelines\n\n## Example Devices\n- Kitchen appliances (ovens, dishwashers, coffee machines)\n- Home entertainment (TVs, sound systems)\n- Smart home devices (thermostats, security cameras)\n- Computer peripherals (printers, routers)\n- Power tools and garden equipment\n\n## Response Format\nProvide:\n1. Clear identification of the device/issue\n2. Step-by-step instructions\n3. Safety warnings if applicable\n4. Tips for optimal use\n5. When to contact professional support\n\nAlways use information from the knowledge base when available."
          }
        },
        "typeVersion": 1.9
      },
      {
        "id": "webhook-response",
        "name": "Send Response",
        "type": "n8n-nodes-base.respondToWebhook",
        "notes": "Returns formatted response to user",
        "position": [
          320,
          -260
        ],
        "parameters": {
          "options": {
            "responseCode": 200,
            "responseHeaders": {
              "entries": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                }
              ]
            }
          },
          "respondWith": "json",
          "responseBody": "={{ JSON.stringify({\n  response: $json.output || \"I couldn't generate a response. Please try rephrasing your question.\",\n  sessionId: $json.sessionId || \"default\",\n  device: $json.device || \"unknown\",\n  timestamp: new Date().toISOString(),\n  confidence: $json.confidence || 0.8\n}) }}"
        },
        "typeVersion": 1.1
      },
      {
        "id": "llm-model",
        "name": "LLM Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "notes": "Configure with your preferred LLM (OpenAI, Anthropic, local models, etc.)",
        "position": [
          -420,
          -60
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4-mini"
          },
          "options": {
            "maxTokens": 2000,
            "temperature": 0.3
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "{{ADD_YOUR_OPENAI_CREDENTIAL_ID}}",
            "name": "OpenAI account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "conversation-memory",
        "name": "Conversation Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "notes": "Maintains context throughout the conversation",
        "position": [
          -240,
          -60
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "vector-database",
        "name": "Manual Knowledge Base",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "notes": "Vector database containing device manuals. Can be replaced with Qdrant, Weaviate, or other vector stores",
        "position": [
          -100,
          -60
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {
            "topK": 5
          },
          "toolName": "Device_Manual_Database",
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "device-manuals"
          },
          "toolDescription": "Comprehensive database of device manuals including setup instructions, troubleshooting guides, technical specifications, and maintenance procedures for various household and technical devices."
        },
        "credentials": {
          "pineconeApi": {
            "id": "{{ADD_YOUR_PINECONE_CREDENTIAL_ID}}",
            "name": "Pinecone account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "embeddings-model",
        "name": "Embeddings Model",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "notes": "Creates embeddings for semantic search. Can use any embedding model",
        "position": [
          -60,
          100
        ],
        "parameters": {
          "model": "text-embedding-ada-002",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "{{ADD_YOUR_OPENAI_CREDENTIAL_ID}}",
            "name": "OpenAI account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "manual-upload",
        "name": "Manual Upload Trigger",
        "type": "n8n-nodes-base.manualTrigger",
        "notes": "Use this to upload new device manuals to the knowledge base",
        "position": [
          -600,
          300
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "prepare-manual-data",
        "name": "Prepare Manual Data",
        "type": "n8n-nodes-base.set",
        "notes": "Format manual text and metadata for upload",
        "position": [
          -380,
          300
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "device-info",
                "name": "deviceType",
                "type": "string",
                "value": "Example: Smart Thermostat"
              },
              {
                "id": "manual-text",
                "name": "text",
                "type": "string",
                "value": "=PASTE YOUR DEVICE MANUAL TEXT HERE\n\nExample content:\n\nChapter 1: Installation\n- Step 1: Remove device from packaging\n- Step 2: Check included components\n- Step 3: Install batteries or connect power\n\nChapter 2: Initial Setup\n- Connect to WiFi network\n- Download companion app\n- Follow in-app instructions\n\nChapter 3: Troubleshooting\n- Device not responding: Check power connection\n- Connection issues: Verify WiFi password\n- Reset procedure: Hold button for 10 seconds\n\nReplace this with your actual device manual content!"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "upload-to-vectordb",
        "name": "Upload to Vector Database",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "notes": "Stores manual content in vector database for retrieval",
        "position": [
          -120,
          300
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "device-manuals"
          }
        },
        "credentials": {
          "pineconeApi": {
            "id": "{{ADD_YOUR_PINECONE_CREDENTIAL_ID}}",
            "name": "Pinecone account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "document-loader",
        "name": "Document Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "notes": "Processes various document formats (PDF, TXT, DOCX)",
        "position": [
          -20,
          520
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "text-splitter",
        "name": "Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "notes": "Splits large documents into searchable chunks",
        "position": [
          60,
          700
        ],
        "parameters": {
          "options": {},
          "chunkSize": 1000,
          "chunkOverlap": 200
        },
        "typeVersion": 1
      },
      {
        "id": "upload-embeddings",
        "name": "Upload Embeddings",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "notes": "Creates embeddings for manual upload",
        "position": [
          -200,
          560
        ],
        "parameters": {
          "model": "text-embedding-ada-002",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "{{ADD_YOUR_OPENAI_CREDENTIAL_ID}}",
            "name": "OpenAI account"
          }
        },
        "typeVersion": 1.2
      }
    ],
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "connections": {
      "LLM Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent - Device Expert",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Document Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Document Loader": {
        "ai_document": [
          [
            {
              "node": "Upload to Vector Database",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings Model": {
        "ai_embedding": [
          [
            {
              "node": "Manual Knowledge Base",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Upload Embeddings": {
        "ai_embedding": [
          [
            {
              "node": "Upload to Vector Database",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Conversation Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent - Device Expert",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Manual Data": {
        "main": [
          [
            {
              "node": "Upload to Vector Database",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook - User Query": {
        "main": [
          [
            {
              "node": "AI Agent - Device Expert",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Manual Knowledge Base": {
        "ai_tool": [
          [
            {
              "node": "AI Agent - Device Expert",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Manual Upload Trigger": {
        "main": [
          [
            {
              "node": "Prepare Manual Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent - Device Expert": {
        "main": [
          [
            {
              "node": "Send Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "c1RYY5JDniAWe4Lm",
    "meta": {
      "instanceId": "de822f81f3a2367cef7d9549771a77783236bc9596481be2ae65c05fbcc4b4fd",
      "templateCredsSetupCompleted": true
    },
    "name": "💥 Create AI Viral Videos using NanoBanana 2 PRO & VEO3.1 and Publish via Blotato -vide",
    "tags": [],
    "nodes": [
      {
        "id": "7c727b4c-0395-4262-85f9-b00fa9d5aa9e",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          928,
          832
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "HUbsD20wv3CFr7gN",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "913750ef-1d67-4a69-ab6d-8219b44a54ec",
        "name": "Think",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          1072,
          832
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "0f440371-db4d-4847-a104-5bd02f5ec495",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1200,
          832
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"prompt\": \"string\",\n  \"caption\": \"string\",\n  \"title\": \"string\", \n  \"hashtags\": \"string\"\n}\n"
        },
        "typeVersion": 1.3
      },
      {
        "id": "b5174475-5425-49de-97fa-381e573f260f",
        "name": "Telegram Trigger: Receive Video Idea",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          784,
          192
        ],
        "webhookId": "83b8d6e3-67b7-40f0-ba8c-b980fdcbe527",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "TBPespUzbkdn7hk7",
            "name": "Telegram_wan"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c52b61fe-df02-4c7f-9b1d-c8763d081c0f",
        "name": "Set Master Prompt",
        "type": "n8n-nodes-base.set",
        "position": [
          800,
          640
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "cc2e0500-57b1-4615-82cb-1c950e5f2ec4",
                "name": "json_master",
                "type": "string",
                "value": "={\n  \"description\": \"Brief narrative description of the scene, focusing on key visual storytelling and product transformation.\",\n  \"style\": \"cinematic | photorealistic | stylized | gritty | elegant\",\n  \"camera\": {\n    \"type\": \"fixed | dolly | Steadicam | crane combo\",\n    \"movement\": \"describe any camera moves like slow push-in, pan, orbit\",\n    \"lens\": \"optional lens type or focal length for cinematic effect\"\n  },\n  \"lighting\": {\n    \"type\": \"natural | dramatic | high-contrast\",\n    \"sources\": \"key lighting sources (sunset, halogen, ambient glow...)\",\n    \"FX\": \"optional VFX elements like fog, reflections, flares\"\n  },\n  \"environment\": {\n    \"location\": \"describe location or room (kitchen, desert, basketball court...)\",\n    \"set_pieces\": [\n      \"list of key background or prop elements\",\n      \"e.g. hardwood floors, chain-link fence, velvet surface\"\n    ],\n    \"mood\": \"describe the ambient atmosphere (moody, clean, epic...)\"\n  },\n  \"elements\": [\n    \"main physical items involved (product box, accessories, vehicles...)\",\n    \"include brand visibility (logos, packaging, texture...)\"\n  ],\n  \"subject\": {\n    \"character\": {\n      \"description\": \"optional – physical description, outfit\",\n      \"pose\": \"optional – position or gesture\",\n      \"lip_sync_line\": \"optional – spoken line if there’s a voiceover\"\n    },\n    \"product\": {\n      \"brand\": \"Brand name\",\n      \"model\": \"Product model or name\",\n      \"action\": \"description of product transformation or assembly\"\n    }\n  },\n  \"motion\": {\n    \"type\": \"e.g. transformation, explosion, vortex\",\n    \"details\": \"step-by-step visual flow of how elements move or evolve\"\n  },\n  \"VFX\": {\n    \"transformation\": \"optional – describe style (neon trails, motion blur...)\",\n    \"impact\": \"optional – e.g. shockwave, glow, distortion\",\n    \"particles\": \"optional – embers, sparks, thread strands...\",\n    \"environment\": \"optional – VFX affecting the scene (ripples, wind...)\"\n  },\n  \"audio\": {\n    \"music\": \"optional – cinematic score, trap beat, ambient tone\",\n    \"sfx\": [\n      \"list of sound effects (zip, pop, woosh...)\"\n    ],\n    \"ambience\": \"optional – background soundscape (traffic, wind...)\",\n    \"voiceover\": {\n      \"delivery\": \"tone and style (confident, whisper, deep...)\",\n      \"line\": \"text spoken if applicable\"\n    }\n  },\n  \"ending\": \"Final shot description – what is seen or felt at the end (freeze frame, logo pulse, glow...)\",\n  \"text\": \"none | overlay | tagline | logo pulse at end only\",\n  \"format\": \"16:9 | 4k | vertical\",\n  \"keywords\": [\n    \"brand\",\n    \"scene style\",\n    \"motion type\",\n    \"camera style\",\n    \"sound mood\",\n    \"target theme\"\n  ]\n}\n"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "8d368aed-2dd7-47c2-90e8-bd9d8163ab4a",
        "name": "AI Agent: Generate Video Script",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1008,
          640
        ],
        "parameters": {
          "text": "=Create a UGC-style video prompt using both the reference image and the user description.  \n\n**Inputs**  \n- User description (optional):  \n  `{{ $('Telegram Trigger: Receive Video Idea').item.json.message.caption }}`  \n- Reference image analysis (stay strictly faithful to what’s visible):  \n  `{{ $('OpenAI Vision: Analyze Reference Image').item.json.content }}`  \n\n**Rules**  \n- Keep the style casual, authentic, and realistic. Avoid studio-like or cinematic language.  \n- Default model: `veo3.1` (unless otherwise specified).  \n- Output only **one JSON object** with the key: `video_prompt`.  \n",
          "options": {
            "systemMessage": "=system_prompt:\n  ## SYSTEM PROMPT: Structured Video Ad Prompt Generator\n  A - Ask:\n    Generate a structured video ad prompt for cinematic generation, strictly based on the master schema provided in: {{ $json.json_master }}.\n    The final result must be a JSON object with exactly 3 top-level keys: `prompt`, `caption`, `title` and `hashtags`.\n\n  G - Guidance:\n    role: Creative Director\n    output_count: 1\n    character_limit: None\n    constraints:\n      - The output must be valid JSON.\n      - The `prompt` field must contain a **single-line JSON string** that follows the exact structure of {{ $json.json_master }} with all fields preserved.\n      - The `hashtags` field must contain array of 8-10 tags.\n      - The `caption` field should contain a short, descriptive and unique title (max 15 words).\n      - The `title` field should contain a short title.\n      - Do not include any explanations, markdown, or extra text — only the JSON object.\n      - Escape all inner quotes in the `prompt` string so it is valid as a stringified JSON inside another JSON.\n    tool_usage:\n      - Ensure consistent alignment across all fields (camera, lighting, motion, etc.).\n      - Maintain full structure even for optional fields (use \"none\", \"\", or [] as needed).\n\n  N - Notation:\n    format: JSON\n    expected_output:\n      {\n        \"prompt\": \"{...stringified JSON of the full prompt...}\",\n        \"caption\": \"A unique short descriptive\",\n        \"title\": \"A unique short title\",\n        \"hashtags\": \"tags\"\n      }\n\n    Return JSON with: prompt (150-200 word cinematic Veo 3.1 description), caption (50-100 word social media text with emojis), hashtags (array of 8-10 tags)"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2
      },
      {
        "id": "508e2f17-37eb-455d-b69a-19e773705e75",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "disabled": true,
        "position": [
          720,
          544
        ],
        "parameters": {
          "color": 7,
          "width": 1852,
          "height": 428,
          "content": "# 📑 STEP 2 — Generate Video with VEO3.1"
        },
        "typeVersion": 1
      },
      {
        "id": "3d5fe2a9-6fee-4f29-a7b0-ff1628d1d96a",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          720,
          96
        ],
        "parameters": {
          "color": 7,
          "width": 1856,
          "height": 432,
          "content": "# 📑 STEP 1 — Create Image with NanoBanana 2 PRO\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3028553a-e742-49fd-b68c-6f5a9c6e0f9e",
        "name": "Set: Bot Token (Placeholder)",
        "type": "n8n-nodes-base.set",
        "position": [
          992,
          192
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "af62651a-3fc8-419d-908b-6514f6f4bcb3",
                "name": "YOUR_BOT_TOKEN",
                "type": "string",
                "value": "YOUR_BOT_TOKEN"
              },
              {
                "id": "588b2c82-50af-41f1-bce2-0f7e627162b0",
                "name": "fal_api_key",
                "type": "string",
                "value": "YOUR_fal_api_key"
              },
              {
                "id": "bdb28513-38da-4a61-bffd-aa0f8a165579",
                "name": "CAPTION",
                "type": "string",
                "value": "={{ $('Telegram Trigger: Receive Video Idea').item.json.message.caption }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "ac849dab-7a31-4eed-82c6-210f312c53d0",
        "name": "Telegram API: Get File URL",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1216,
          192
        ],
        "parameters": {
          "url": "=https://api.telegram.org/bot{{ $json.YOUR_BOT_TOKEN }}/getFile?file_id={{ $('Telegram Trigger: Receive Video Idea').item.json.message.photo[ $('Telegram Trigger: Receive Video Idea').item.json.message.photo.length - 1].file_id }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "0fb7dee2-9d26-4488-b123-a68d374da7e2",
        "name": "OpenAI Vision: Analyze Reference Image",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          1424,
          192
        ],
        "parameters": {
          "text": "=You are an image analysis assistant.\n\nYour task is to analyze the given image and output results **only in YAML format**. Do not add explanations, comments, or extra text outside YAML.\n\nRules:\n\n- If the image depicts a **product**, return:\n    \n    ```yaml\n    brand_name: (brand if visible or inferable)\n    color_scheme:\n      - hex: (hex code of each prominent color)\n        name: (descriptive name of the color)\n    font_style: (serif/sans-serif, bold/thin, etc.)\n    visual_description: (1–2 sentences summarizing what is seen, ignoring the background)\n    \n    ```\n    \n- If the image depicts a **character**, return:\n    \n    ```yaml\n    character_name: (name if visible or inferable, else \"unknown\")\n    color_scheme:\n      - hex: (hex code of each prominent color on the character)\n        name: (descriptive name of the color)\n    outfit_style: (clothing style, accessories, or notable features)\n    visual_description: (1–2 sentences summarizing what the character looks like, ignoring the background)\n    \n    ```\n    \n- If the image depicts **both**, return **both sections** in YAML.\n\nOnly output valid YAML. No explanations.",
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "chatgpt-4o-latest",
            "cachedResultName": "CHATGPT-4O-LATEST"
          },
          "options": {},
          "resource": "image",
          "imageUrls": "=https://api.telegram.org/file/bot{{ $('Set: Bot Token (Placeholder)').first().json.YOUR_BOT_TOKEN }}/{{ $json.result.file_path }}",
          "operation": "analyze"
        },
        "credentials": {
          "openAiApi": {
            "id": "HUbsD20wv3CFr7gN",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "b197982b-4a3d-4a9a-9a04-06ad04f8ef9b",
        "name": "LLM: Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1824,
          384
        ],
        "parameters": {
          "jsonSchemaExample": "{\n\t\"image_prompt\": \"string\"\n}"
        },
        "typeVersion": 1.3
      },
      {
        "id": "03caf7c5-c03e-4ef7-b104-e7e5a23d0e02",
        "name": "LLM: OpenAI Chat",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1600,
          384
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "HUbsD20wv3CFr7gN",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "eaa418ce-bbcd-42d0-ac2a-f7dcda99fdb1",
        "name": "Generate Image Prompt",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1648,
          192
        ],
        "parameters": {
          "text": "=Your task is to create an image prompt following the system guidelines.  \nEnsure that the reference image is represented as **accurately as possible**, including all text elements.  \n\nUse the following inputs:  \n\n- **User’s description:**  \n{{ $('Set: Bot Token (Placeholder)').first().json.CAPTION }}\n\n- **Reference image description:**  \n{{ $json.content }}\n",
          "options": {
            "systemMessage": "=ROLE: UGC Image Prompt Builder  \n\nGOAL:  \nGenerate one concise, natural, and realistic image prompt (≤120 words) from a given product or reference image. The prompt must simulate authentic UGC (user-generated content) photography.  \n\nRULES:  \n- Always output **one JSON object only** with the key:  \n  - `image_prompt`: (string with full description)  \n- Do **not** add commentary, metadata, or extra keys. JSON only.  \n\nSTYLE GUIDELINES:  \n- Tone: casual, unstaged, lifelike, handheld snapshot.  \n- Camera cues: include at least 2–3 (e.g., phone snapshot, handheld framing, off-center composition, natural indoor light, soft shadows, slight motion blur, auto exposure, unpolished look, mild grain).  \n- Realism: embrace imperfections (wrinkles, stray hairs, skin texture, clutter, smudges).  \n- Packaging/Text: preserve exactly as visible. Never invent claims, numbers, or badges.  \n- Diversity: if people appear but are unspecified, vary gender/ethnicity naturally; default age range = 21–38.  \n- Setting: default to real-world everyday spaces (home, street, store, gym, office).  \n\nSAFETY:  \n- No copyrighted character names.  \n- No dialogue or scripts. Only describe scenes.  \n\nOUTPUT CONTRACT:  \n- JSON only, no prose outside.  \n- Max 120 words in `image_prompt`.  \n- Must cover: subject, action, mood, setting, style/camera, colors, and text accuracy.  \n\nCHECKLIST BEFORE OUTPUT:  \n- Natural handheld tone?  \n- At least 2 camera cues included?  \n- Product text preserved exactly?  \n- Only JSON returned?  \n\n---  \n\n### Example  \n\nGood Example :  \n```json\n{ \"image_prompt\": \"a young adult casually holding a skincare tube near a bathroom mirror; action: dabs small amount on the back of the hand; mood: easy morning; setting: small apartment bathroom with towel on rack and toothbrush cup; style/camera: phone snapshot, handheld framing, off-center composition, natural window light, slight motion blur, mild grain; colors: soft whites and mint label; text accuracy: keep every word on the tube exactly as visible, no added claims\" }\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "04938906-9aa0-49cb-8073-52030f2c7f91",
        "name": "NanoBanana: Create Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1984,
          192
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/nano-banana-pro/edit",
          "method": "POST",
          "options": {
            "response": {
              "response": {
                "responseFormat": "json"
              }
            }
          },
          "jsonBody": "={\n  \"prompt\": \"{{ $json.output.image_prompt.replace(/\\\"/g, '\\\\\\\"').replace(/\\n/g, '\\\\n') }}\",\n  \"image_urls\": [\n     \"https://api.telegram.org/file/bot{{ $('Set: Bot Token (Placeholder)').first().json.YOUR_BOT_TOKEN }}/{{ $('Telegram API: Get File URL').first().json.result.file_path }}\"\n  ],\n  \"resolution\": \"1K\",\n  \"aspect_ratio\": \"9:16\",\n  \"output_format\": \"png\"\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "={{ 'Key ' + $('Set: Bot Token (Placeholder)').first().json.fal_api_key }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "526eedfe-fbbd-4aff-bba1-9fbb990a74e4",
        "name": "Wait for Image Edit",
        "type": "n8n-nodes-base.wait",
        "position": [
          2192,
          192
        ],
        "webhookId": "40c00cdc-ee17-499f-9c6e-ca5438d5cfbb",
        "parameters": {
          "amount": 2
        },
        "typeVersion": 1.1
      },
      {
        "id": "51985580-f325-49d3-bfff-83b0de4db6ca",
        "name": "Download Edited Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2400,
          192
        ],
        "parameters": {
          "url": "={{ $json.response_url }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "4534025f-dd17-4225-aaa6-b0343dca4864",
        "name": "Parse GPT Response",
        "type": "n8n-nodes-base.code",
        "position": [
          1360,
          640
        ],
        "parameters": {
          "jsCode": "// Parse responses into { title, prompt, caption, hashtags[], hashtags_string }\nreturn $input.all().map(item => {\n  const data = item.json || {};\n\n  let title = \"\";\n  let prompt = \"\";\n  let caption = \"\";\n  let hashtagsArr = [];\n\n  // 1) NOUVEAU FORMAT : { output: { title, prompt, caption, hashtags } }\n  if (data.output) {\n    const o = data.output || {};\n    title = o.title ?? \"\";\n    prompt = o.prompt ?? \"\";\n    caption = o.caption ?? \"\";\n\n    const rawHashtags = o.hashtags ?? [];\n    if (Array.isArray(rawHashtags)) {\n      hashtagsArr = rawHashtags;\n    } else if (typeof rawHashtags === \"string\") {\n      try {\n        const parsedTags = JSON.parse(rawHashtags);\n        if (Array.isArray(parsedTags)) {\n          hashtagsArr = parsedTags;\n        } else {\n          hashtagsArr = rawHashtags.split(/[,\\s]+/).filter(Boolean);\n        }\n      } catch {\n        hashtagsArr = rawHashtags.split(/[,\\s]+/).filter(Boolean);\n      }\n    }\n  }\n\n  // 2) ANCIEN FORMAT OpenAI (fallback)\n  if (!title && !prompt && !caption && hashtagsArr.length === 0) {\n    let content =\n      data?.choices?.[0]?.message?.content ??\n      data?.message?.content ??\n      data?.content ??\n      null;\n\n    if (content && typeof content === \"object\") {\n      title = content.title ?? \"\";\n      prompt = content.prompt ?? \"\";\n      caption = content.caption ?? \"\";\n\n      if (Array.isArray(content.hashtags)) {\n        hashtagsArr = content.hashtags;\n      } else if (typeof content.hashtags === \"string\") {\n        hashtagsArr = content.hashtags.split(/[,\\s]+/).filter(Boolean);\n      }\n    }\n    else if (typeof content === \"string\" && content.trim()) {\n      try {\n        const parsed = JSON.parse(content);\n        title = parsed.title ?? \"\";\n        prompt = parsed.prompt ?? \"\";\n        caption = parsed.caption ?? \"\";\n\n        if (Array.isArray(parsed.hashtags)) {\n          hashtagsArr = parsed.hashtags;\n        } else if (typeof parsed.hashtags === \"string\") {\n          hashtagsArr = parsed.hashtags.split(/[,\\s]+/).filter(Boolean);\n        }\n      } catch {\n        title = \"\";\n        prompt = \"\";\n        caption = \"\";\n        hashtagsArr = [];\n      }\n    }\n  }\n\n  // 3) Normalisation des hashtags\n  const norm = Array.from(\n    new Set(\n      (hashtagsArr || [])\n        .map(h => (h ?? \"\").toString().trim())\n        .filter(Boolean)\n        .map(h => (h.startsWith(\"#\") ? h : `#${h}`))\n    )\n  );\n\n  const hashtags_string = norm.join(\" \");\n\n  return {\n    json: {\n      title,\n      prompt,\n      caption,\n      hashtags: norm,\n      hashtags_string\n    }\n  };\n});\n"
        },
        "typeVersion": 2
      },
      {
        "id": "1a6f333e-8aa0-4285-bdfb-64b7ca0b6267",
        "name": "Optimize Prompt for Veo",
        "type": "n8n-nodes-base.set",
        "position": [
          1568,
          640
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "id-1",
                "name": "veo_prompt",
                "type": "string",
                "value": "={{ $json.prompt }} consistent character throughout, photorealistic quality, professional cinematography, 8 seconds duration, 9:16 aspect ratio, 24fps"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "cfc41241-f73d-4bfc-aa3a-e7d65281bf82",
        "name": "Download Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2400,
          640
        ],
        "parameters": {
          "url": "={{ $json.video.url }}",
          "options": {
            "response": {
              "response": {
                "responseFormat": "file"
              }
            }
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "ae4420cd-7088-45a8-942d-c7b96455e685",
        "name": "Prepare Veo Request Body",
        "type": "n8n-nodes-base.code",
        "position": [
          1776,
          640
        ],
        "parameters": {
          "jsCode": "const prompt = $input.item.json.veo_prompt || $input.item.json.prompt;\n\n// Nouvelle source d'image : sortie de \"Download Edited Image\"\nconst imageUrl = $('Download Edited Image').first().json.images[0].url;\n\nif (!prompt || prompt.length < 10) {\n  throw new Error('Prompt required');\n}\n\nif (!imageUrl || typeof imageUrl !== 'string' || !imageUrl.startsWith('http')) {\n  throw new Error('A valid image URL from Download Edited Image is required');\n}\n\n// VEO attend un tableau d'URLs, même si on n'en a qu'une\nconst imageUrls = [imageUrl];\n\nreturn {\n  json: {\n    veo_request_body: {\n      prompt: prompt,\n      image_urls: imageUrls,\n      duration: 8,\n      aspect_ratio: \"9:16\"\n    },\n    ...($input.item.json)\n  }\n};\n"
        },
        "typeVersion": 2
      },
      {
        "id": "50dedf01-6b48-464b-ab9f-3608e499f3cc",
        "name": "Veo Generation",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1984,
          640
        ],
        "parameters": {
          "url": "https://fal.run/fal-ai/veo3.1/reference-to-video",
          "method": "POST",
          "options": {
            "timeout": 600000,
            "response": {
              "response": {
                "responseFormat": "json"
              }
            }
          },
          "jsonBody": "={{ JSON.stringify($json.veo_request_body) }}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ 'Key ' + $('Set: Bot Token (Placeholder)').first().json.fal_api_key }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "c135569a-c630-4b25-8f6e-2f42b00fb58e",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          2192,
          640
        ],
        "webhookId": "d08e597e-4696-4ad6-a068-a774daa84077",
        "parameters": {
          "amount": 2
        },
        "typeVersion": 1.1
      },
      {
        "id": "2a1bc1b1-57d6-483c-a51c-a97675d463c8",
        "name": "Send Video to Telegram",
        "type": "n8n-nodes-base.telegram",
        "position": [
          800,
          1152
        ],
        "webhookId": "f2ebfc81-f6ea-440e-8702-844ab3c6f244",
        "parameters": {
          "chatId": "={{ $('Telegram Trigger: Receive Video Idea').first().json.message.chat.id }}",
          "operation": "sendVideo",
          "binaryData": true,
          "additionalFields": {
            "caption": "=Your video is ready! 🎥  {{ $json.video.url }}"
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "TBPespUzbkdn7hk7",
            "name": "Telegram_wan"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6dd2b073-71c5-4d5b-82b2-0383a7e680b7",
        "name": "Step 5 - Publishing",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          720,
          992
        ],
        "parameters": {
          "color": 5,
          "width": 1852,
          "height": 404,
          "content": "# 📑 STEP 3  —  Publish with Blotato"
        },
        "typeVersion": 1
      },
      {
        "id": "a984be16-6697-4cfc-bb1c-a8f7463be5a1",
        "name": "Upload Video to BLOTATO",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1136,
          1152
        ],
        "parameters": {
          "mediaUrl": "={{ $('Download Video').item.json.video.url }}",
          "resource": "media"
        },
        "credentials": {
          "blotatoApi": {
            "id": "wozsYJYLfCZO37j8",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "c3b8258b-5ee7-47fa-9d7e-4e3c59928f9e",
        "name": "Youtube",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1872,
          1216
        ],
        "parameters": {
          "options": {},
          "platform": "youtube",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "8047",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/8047",
            "cachedResultName": "DR FIRASS (Dr. Firas)"
          },
          "postContentText": "={{ $('Parse GPT Response').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}",
          "postCreateYoutubeOptionTitle": "={{ $('Parse GPT Response').first().json.title }}",
          "postCreateYoutubeOptionPrivacyStatus": "private",
          "postCreateYoutubeOptionShouldNotifySubscribers": false
        },
        "credentials": {
          "blotatoApi": {
            "id": "wozsYJYLfCZO37j8",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "981fa66f-f01c-418e-8b02-24865cfb341f",
        "name": "Tiktok",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1552,
          1056
        ],
        "parameters": {
          "options": {},
          "platform": "tiktok",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "2079",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/2079",
            "cachedResultName": "elitecybzcs"
          },
          "postContentText": "={{ $('Parse GPT Response').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "wozsYJYLfCZO37j8",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "fa93e28f-6e93-479f-95f3-8d949090fc1c",
        "name": "Linkedin",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1712,
          1056
        ],
        "parameters": {
          "options": {},
          "platform": "linkedin",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "1446",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1446",
            "cachedResultName": "Samuel Amalric"
          },
          "postContentText": "={{ $('Parse GPT Response').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "wozsYJYLfCZO37j8",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "77026e85-e28f-44ff-9ad1-2191565bd8a4",
        "name": "Facebook",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1872,
          1056
        ],
        "parameters": {
          "options": {},
          "platform": "facebook",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "1759",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1759",
            "cachedResultName": "Firass Ben"
          },
          "facebookPageId": {
            "__rl": true,
            "mode": "list",
            "value": "101603614680195",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1759/subaccounts/101603614680195",
            "cachedResultName": "Dr. Firas"
          },
          "postContentText": "={{ $('Parse GPT Response').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "wozsYJYLfCZO37j8",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "87ce0af6-a9e9-47e2-a958-824cb8c52f07",
        "name": "Instagram",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1552,
          1216
        ],
        "parameters": {
          "options": {},
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "1687",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1687",
            "cachedResultName": "acces.a.vie"
          },
          "postContentText": "={{ $('Parse GPT Response').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "wozsYJYLfCZO37j8",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "2f7980a6-5d3f-4d2b-a565-4c840529d8c1",
        "name": "Twitter (X)",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1712,
          1216
        ],
        "parameters": {
          "options": {},
          "platform": "twitter",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "1289",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1289",
            "cachedResultName": "Docteur_Firas"
          },
          "postContentText": "={{ $('Parse GPT Response').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "wozsYJYLfCZO37j8",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "eaa3e024-0eef-4a71-ae0b-25fe1cc27a1c",
        "name": "Merge1",
        "type": "n8n-nodes-base.merge",
        "position": [
          2144,
          1072
        ],
        "parameters": {
          "mode": "chooseBranch",
          "numberInputs": 6
        },
        "typeVersion": 3.2
      },
      {
        "id": "4889de2f-81e3-49e2-a921-739aec5be20e",
        "name": "Send a text message",
        "type": "n8n-nodes-base.telegram",
        "position": [
          2368,
          1136
        ],
        "webhookId": "ba74ea20-4e1f-45e4-b95e-0c41b4394b56",
        "parameters": {
          "text": "Published",
          "chatId": "={{ $('Telegram Trigger: Receive Video Idea').first().json.message.chat.id }}",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "TBPespUzbkdn7hk7",
            "name": "Telegram_wan"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "3e6b4da3-2e64-49f4-8e76-97753b87b81b",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          48,
          96
        ],
        "parameters": {
          "width": 652,
          "height": 1300,
          "content": "# 🚀 AI Viral Video Workflow — NanoBanana 2 PRO × VEO3.1 × Blotato (By Dr. Firas)\n\n[![AI Voice Agent Preview](https://www.dr-firas.com/nanobanana2.png)](https://youtu.be/nlwpbXQqNQ4)\n\n##  📘 Documentation  \nAccess detailed setup instructions, API config, platform connection guides, and workflow customization tips:\n\n📎 [Open the full documentation on Notion](https://automatisation.notion.site/NonoBanan-PRO-2-2b53d6550fd981a5acbecf7cf50aeb3c?source=copy_link)\n\nThis workflow converts a simple Telegram message into a **ready-to-publish AI viral video**, fully automated.\n\n## 🔥 What this workflow does\n### 1️⃣ Image Creation (NanoBanana 2 PRO)\n- User sends on Telegram:\n  - A reference image  \n  - A short text idea  \n### 2️⃣ Video Generation (VEO3.1)\n- An AI Agent builds a structured video prompt  \n- Optimizes it for **VEO3.1**  \n- Generates a vertical 9:16 video (8 seconds)  \n- Sends the final video to Telegram\n### 3️⃣ Multi-Platform Publishing (Blotato)\n- Uploads the video to Blotato  \n- Auto-publishes to\n\n## ⚙️ Requirements\n1. ✅ **Create a [Blotato](https://blotato.com/?ref=firas) account** (Pro plan required for API access)  \n2. 🔑 **Generate your Blotato API Key** via: `Settings > API > Generate API Key`  \n3. 📦 **Enable “Verified Community Nodes”** in the n8n admin settings  \n4. 🧩 **Install the Blotato** verified community node in n8n  \n5. 🛠 **Create a Blotato API credential** inside your n8n credentials tab  "
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "6eeaa654-b434-47fa-b135-e915b506d7c7",
    "connections": {
      "Wait": {
        "main": [
          [
            {
              "node": "Download Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Think": {
        "ai_tool": [
          [
            {
              "node": "AI Agent: Generate Video Script",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Merge1": {
        "main": [
          [
            {
              "node": "Send a text message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tiktok": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Youtube": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 5
            }
          ]
        ]
      },
      "Facebook": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Linkedin": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Instagram": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "Twitter (X)": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 4
            }
          ]
        ]
      },
      "Download Video": {
        "main": [
          [
            {
              "node": "Send Video to Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Veo Generation": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "LLM: OpenAI Chat": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Image Prompt",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent: Generate Video Script",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Set Master Prompt": {
        "main": [
          [
            {
              "node": "AI Agent: Generate Video Script",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse GPT Response": {
        "main": [
          [
            {
              "node": "Optimize Prompt for Veo",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Image Edit": {
        "main": [
          [
            {
              "node": "Download Edited Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Edited Image": {
        "main": [
          [
            {
              "node": "Set Master Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Image Prompt": {
        "main": [
          [
            {
              "node": "NanoBanana: Create Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Video to Telegram": {
        "main": [
          [
            {
              "node": "Upload Video to BLOTATO",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Optimize Prompt for Veo": {
        "main": [
          [
            {
              "node": "Prepare Veo Request Body",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video to BLOTATO": {
        "main": [
          [
            {
              "node": "Tiktok",
              "type": "main",
              "index": 0
            },
            {
              "node": "Linkedin",
              "type": "main",
              "index": 0
            },
            {
              "node": "Facebook",
              "type": "main",
              "index": 0
            },
            {
              "node": "Instagram",
              "type": "main",
              "index": 0
            },
            {
              "node": "Twitter (X)",
              "type": "main",
              "index": 0
            },
            {
              "node": "Youtube",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "NanoBanana: Create Image": {
        "main": [
          [
            {
              "node": "Wait for Image Edit",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Veo Request Body": {
        "main": [
          [
            {
              "node": "Veo Generation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent: Generate Video Script",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Telegram API: Get File URL": {
        "main": [
          [
            {
              "node": "OpenAI Vision: Analyze Reference Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set: Bot Token (Placeholder)": {
        "main": [
          [
            {
              "node": "Telegram API: Get File URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "LLM: Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Generate Image Prompt",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent: Generate Video Script": {
        "main": [
          [
            {
              "node": "Parse GPT Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Trigger: Receive Video Idea": {
        "main": [
          [
            {
              "node": "Set: Bot Token (Placeholder)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Vision: Analyze Reference Image": {
        "main": [
          [
            {
              "node": "Generate Image Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "R0H2VtXiwntWQFgT",
    "meta": {
      "instanceId": "5ca157bf036415a321c9d29eeb986017053989bb83b5b61701e90fe3987ac8b7",
      "templateCredsSetupCompleted": true
    },
    "name": "RAG Buyer Workflow",
    "tags": [],
    "nodes": [
      {
        "id": "101e791a-aa76-4fc0-9d6c-5e1de26f401b",
        "name": "Telegram Trigger",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -448,
          32
        ],
        "webhookId": "99eab1a0-569d-4f0f-a49e-578a02abfe63",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "49LK4ys7AjTguufd",
            "name": "RAG BOT"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "6973ece8-4835-4c38-ba94-4dd71dc89c22",
        "name": "Set 'Text'",
        "type": "n8n-nodes-base.set",
        "position": [
          112,
          32
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "fe7ecc99-e1e8-4a5e-bdd6-6fce9757b234",
                "name": "text",
                "type": "string",
                "value": "={{ $json.message.text }}"
              },
              {
                "id": "f5c168de-4e80-4e0e-a2e2-7161eba7ddb4",
                "name": "chat_ID",
                "type": "string",
                "value": "={{ $json.message.chat.id }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "1e2849ca-6579-4955-86d0-26b017644f0c",
        "name": "Download Voice File",
        "type": "n8n-nodes-base.telegram",
        "position": [
          64,
          -160
        ],
        "webhookId": "c0b376b1-7b63-41b6-8063-0b3096b8333d",
        "parameters": {
          "fileId": "={{ $json.message.voice.file_id }}",
          "resource": "file",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "49LK4ys7AjTguufd",
            "name": "RAG BOT"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "2eaeee5e-2c4d-48f4-b7df-f08a8e1f8b50",
        "name": "Transcribe Audio",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          208,
          -160
        ],
        "parameters": {
          "options": {},
          "resource": "audio",
          "operation": "transcribe"
        },
        "credentials": {
          "openAiApi": {
            "id": "G7yKHr9wDJKojrFb",
            "name": "OpenAi account nagorik"
          }
        },
        "typeVersion": 1.6
      },
      {
        "id": "cc05d303-217b-4628-9e13-3f9c766a9735",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          -176,
          32
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Voice",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "operator": {
                        "type": "string",
                        "operation": "exists",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.message.voice.file_id }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Text",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "8c844924-b2ed-48b0-935c-c66a8fd0c778",
                      "operator": {
                        "type": "string",
                        "operation": "exists",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.message.text }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "c6b94515-1390-4c4f-ad94-f3f4f7fa2ea8",
        "name": "Response",
        "type": "n8n-nodes-base.telegram",
        "position": [
          768,
          -80
        ],
        "webhookId": "682ca5ab-d30c-4ea5-bb25-c2f26206e761",
        "parameters": {
          "text": "={{ $json.output }}",
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "49LK4ys7AjTguufd",
            "name": "RAG BOT"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "190140a1-e79a-47e9-9c0b-3634739eba4a",
        "name": "AI Agent1",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          400,
          0
        ],
        "parameters": {
          "text": "={{ $json.text }}",
          "options": {
            "systemMessage": "=Role & Behavior:\n\nYou are a friendly, professional support agent for a men’s clothing store who can understand english. Dont provide support about anything else. Reply in the same language the customer is speaking or writing in.\n\nAlways respond with empathy, clarity, and patience.\n\nKeep responses clear, accurate, and precise based on your knowledge base and user's query. Dont make up your own answers.\n\nResponsibilities\n\nCustomer Support\n\nUse the RAG tool to fetch the most accurate and up-to-date information.\n\nProvide price, brand, product info & key features of product based on  the customer requests.\n\nIf no exact answer is found, be honest and suggest alternatives or next steps.\n\nTone & Communication:\n\nAlways acknowledge customer concerns politely.\n\nKeep explanations simple and easy to understand.\n\nMaintain a supportive and professional tone in every message.\n\nOrder Handling:\n\nYou are responsible for taking customer orders.\n\nTo record an order, you must collect all four details:\n\n1. Name\n2. Phone Number\n3. Address\n4. Category of Product\n\nDo not record the order until all four details are provided and you have them in your memory.\n\nOnce all details are collected, record the order using the Google Sheet tool."
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "073c3999-6863-4ff1-bc27-e202b1425817",
        "name": "Answer questions with a vector store1",
        "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
        "position": [
          704,
          304
        ],
        "parameters": {
          "name": "mens_clothing_info",
          "description": "Use this tool to answer every questions by the user regarding men's clothing store."
        },
        "typeVersion": 1
      },
      {
        "id": "ecd39fca-e517-402a-9c3d-58f37e9aeb25",
        "name": "Pinecone Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "position": [
          608,
          432
        ],
        "parameters": {
          "options": {
            "pineconeNamespace": "mens-collection"
          },
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "mens-collection",
            "cachedResultName": "mens-collection"
          }
        },
        "credentials": {
          "pineconeApi": {
            "id": "nWCibAdZpkZoDctX",
            "name": "PineconeApi account Rashed's"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "e9e31ca3-139e-4349-917d-b1f775757db4",
        "name": "Embeddings OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          752,
          544
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "G7yKHr9wDJKojrFb",
            "name": "OpenAi account nagorik"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "53526095-5d9a-489d-ace3-8a2c8f4b7186",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          224,
          336
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-nano",
            "cachedResultName": "gpt-4.1-nano"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "G7yKHr9wDJKojrFb",
            "name": "OpenAi account nagorik"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ddd139ef-d700-422e-af70-c197dc48ebe9",
        "name": "OpenAI Chat Model4",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          928,
          432
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-nano",
            "cachedResultName": "gpt-4.1-nano"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "G7yKHr9wDJKojrFb",
            "name": "OpenAi account nagorik"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a1f3e17f-5a41-4b09-bbd3-3d6ca27b614e",
        "name": "Append row in sheet in Google Sheets",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          1200,
          144
        ],
        "parameters": {
          "columns": {
            "value": {
              "Name": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Name', ``, 'string') }}",
              "Address": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Address', ``, 'string') }}",
              "Category": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Category', ``, 'string') }}",
              "Phone number": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Phone_number', ``, 'string') }}"
            },
            "schema": [
              {
                "id": "Name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Phone number",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Phone number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Address",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Category",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Category",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ptg4mT5V2SbE0E_99_a5fxDOBVbpoudOKp7d5wR4KGg/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1Ptg4mT5V2SbE0E_99_a5fxDOBVbpoudOKp7d5wR4KGg",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ptg4mT5V2SbE0E_99_a5fxDOBVbpoudOKp7d5wR4KGg/edit?usp=drivesdk",
            "cachedResultName": "men's buyers"
          },
          "descriptionType": "manual",
          "toolDescription": "Use this tool to record name, phone number, address and category of products of buyers of men's clothing store"
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "3MJE8MvoAP44Rjl9",
            "name": "Nagorik Google Sheet"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "050029c8-e0a8-4022-846b-462b27a4c5fb",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          384,
          336
        ],
        "parameters": {
          "sessionKey": "={{ $json.chat_ID }}",
          "sessionIdType": "customKey",
          "contextWindowLength": 8
        },
        "typeVersion": 1.3
      },
      {
        "id": "e080c2de-8b80-4500-b21a-88156956f00a",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -528,
          -64
        ],
        "parameters": {
          "color": 4,
          "width": 256,
          "height": 256,
          "content": "## Capturing Telegram Message \n"
        },
        "typeVersion": 1
      },
      {
        "id": "4cfc35d9-2b3d-47e9-a6a6-ac4d7779c876",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -256,
          -64
        ],
        "parameters": {
          "color": 5,
          "width": 256,
          "height": 256,
          "content": "## Text/Voice Message Router\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3dee79ed-fe11-468c-bb49-f29a66b2dc0d",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          16,
          -256
        ],
        "parameters": {
          "color": 7,
          "width": 336,
          "height": 256,
          "content": "## Voice Message Processing\nProcesses the voice message to extract the queries"
        },
        "typeVersion": 1
      },
      {
        "id": "2bb50900-46ef-4060-a2ab-4b8853ad4023",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          368,
          -96
        ],
        "parameters": {
          "color": 5,
          "width": 304,
          "height": 240,
          "content": "## RAG and Order Taking Agent\n"
        },
        "typeVersion": 1
      },
      {
        "id": "0e5ab26c-5b3d-4e72-9aa2-dd7c2ac0e02b",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          176,
          192
        ],
        "parameters": {
          "color": 7,
          "width": 336,
          "height": 272,
          "content": "## Agent's Brain\nAgent uses these components to think and keep converstation in memory"
        },
        "typeVersion": 1
      },
      {
        "id": "d0bc7779-143b-4e14-968a-6b22b6bda9a9",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          576,
          192
        ],
        "parameters": {
          "color": 7,
          "width": 496,
          "height": 496,
          "content": "## Agent's Store Knowledge Base\nDescription: Retrives store data from the existing knowledge base. "
        },
        "typeVersion": 1
      },
      {
        "id": "ce19747c-b00c-4e1c-98d0-83b11506ce52",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1104,
          64
        ],
        "parameters": {
          "color": 3,
          "width": 256,
          "height": 256,
          "content": "## Order Registry"
        },
        "typeVersion": 1
      },
      {
        "id": "6332ac42-f9e3-43a5-ab30-b42c49575f27",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          688,
          -144
        ],
        "parameters": {
          "color": 6,
          "width": 256,
          "height": 240,
          "content": "## Bot Response Point"
        },
        "typeVersion": 1
      },
      {
        "id": "6f5650cc-5e8f-4290-b894-baf0a5a27268",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -960,
          -352
        ],
        "parameters": {
          "width": 400,
          "height": 848,
          "content": "# Overview\n## How it works:\n* Captures all incoming text and voice messages through a Telegram Trigger.\n* Detects message type using a Switch node and routes text and voice notes to the correct processing path.\n* Transcribes voice messages using OpenAI and extracts clean message content with a Set node.\n* Uses an AI Agent (GPT-4.1-nano) to generate friendly, accurate replies while maintaining conversation context with an 8-message memory window.\n* Searches your product catalog and information through a Pinecone-powered RAG system to provide prices, features, and other details with high accuracy.\n* Automatically collects customer order details and records complete orders into Google Sheets.\n* Sends final responses and confirmations back to customers through Telegram.\n\n## Setup setps:\n* Import the supplied JSON into your n8n instance.\n* Create a Telegram bot via @BotFather and add its API token in n8n.\n* Add required credentials: Telegram API, OpenAI API, Pinecone, and Google Sheets OAuth2.\n* Set up your Pinecone index, namespace, and upload your store data.\n* Prepare a Google Sheet with columns: Name, Phone number, Address, Category.\n* Update the Google Sheets node with your document ID.\n* Customize the AI Agent’s system message to match your store voice and product categories.\n* Test using text and voice messages, then activate the workflow for continuous operation."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "f122a859-929f-4f61-bdcb-564c09ab1329",
    "connections": {
      "Switch": {
        "main": [
          [
            {
              "node": "Download Voice File",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Set 'Text'",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          [
            {
              "node": "Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set 'Text'": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Transcribe Audio": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model4": {
        "ai_languageModel": [
          [
            {
              "node": "Answer questions with a vector store1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Download Voice File": {
        "main": [
          [
            {
              "node": "Transcribe Audio",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store": {
        "ai_vectorStore": [
          [
            {
              "node": "Answer questions with a vector store1",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "Append row in sheet in Google Sheets": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Answer questions with a vector store1": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "V994vNilogCvoCug",
    "meta": {
      "instanceId": "YOUR_ID"
    },
    "name": "News_Tech_EN",
    "tags": [
      {
        "id": "7FnQEcGVfEQxsJCK",
        "name": "AI",
        "createdAt": "2025-09-04T13:51:20.972Z",
        "updatedAt": "2025-09-04T13:51:20.972Z"
      },
      {
        "id": "DNVBijE9cEya3mqW",
        "name": "PROD",
        "createdAt": "2025-11-23T13:34:14.752Z",
        "updatedAt": "2025-11-23T13:34:14.752Z"
      },
      {
        "id": "O6GI5lYnoKbDq2aN",
        "name": "News",
        "createdAt": "2025-12-02T14:30:28.623Z",
        "updatedAt": "2025-12-02T14:30:28.623Z"
      },
      {
        "id": "dsb6ypU8KgN6sZTl",
        "name": "creator-to-publish",
        "createdAt": "2025-11-23T13:36:30.079Z",
        "updatedAt": "2025-11-23T13:36:30.079Z"
      }
    ],
    "nodes": [
      {
        "id": "4da74104-9743-462b-8919-9cd595ce683a",
        "name": "RSS_TheHackersNews",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          -448
        ],
        "parameters": {
          "url": "https://feeds.feedburner.com/TheHackersNews",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "d6c68cbe-61a3-4217-a90c-34da70f91ac7",
        "name": "RSS_GrahamCluley",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          -64
        ],
        "parameters": {
          "url": "https://feeds.feedburner.com/TheHackersNews",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "9f7c8f2f-5261-4918-95bb-d3fba6420773",
        "name": "RSS_cybersecuritynews",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          -320
        ],
        "parameters": {
          "url": "https://cybersecuritynews.com/feed/",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "301a3616-d053-4816-aafa-a7099f33eecb",
        "name": "RSS_ilsole24ore Tech",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          1040
        ],
        "parameters": {
          "url": "https://www.ilsole24ore.com/rss/tecnologia.xml",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "67a27f78-8f18-4c01-ba07-9175b7b35396",
        "name": "RSS_ilsole24ore Cyber",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          912
        ],
        "parameters": {
          "url": "https://www.ilsole24ore.com/rss/tecnologia--cybersicurezza.xml",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "73d381f7-0589-4b1c-b5f0-3601b8ff32b3",
        "name": "RSS_cybersecurity360",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          1168
        ],
        "parameters": {
          "url": "https://www.cybersecurity360.it/feed/",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "e872dc6b-e6bf-4da1-82bc-9218914722a4",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1104,
          -512
        ],
        "parameters": {
          "color": 7,
          "height": 2096,
          "content": "### CyberSecurity"
        },
        "typeVersion": 1
      },
      {
        "id": "aafe97e9-8bcd-44f8-b486-e51ef3e438cf",
        "name": "RSS_artificialintelligence-news.",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          1632
        ],
        "parameters": {
          "url": "https://www.artificialintelligence-news.com/feed/",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "85ebe282-13f3-484d-a4ac-27115596c0d8",
        "name": "RSS_GoogleResearch",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          1760
        ],
        "parameters": {
          "url": "https://research.google/blog/rss/",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "68ab41cb-f7f7-4de1-8e89-c3d437d01a0d",
        "name": "RSS_MIT",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          1888
        ],
        "parameters": {
          "url": "https://news.mit.edu/rss/topic/artificial-intelligence2",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "4c11828a-01e7-41e4-8271-1a61db3b6838",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1104,
          1600
        ],
        "parameters": {
          "color": 7,
          "height": 560,
          "content": "### AI"
        },
        "typeVersion": 1
      },
      {
        "id": "f43023df-1b86-4c72-878f-b6558dddba9d",
        "name": "Filter",
        "type": "n8n-nodes-base.filter",
        "position": [
          160,
          1216
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "05cbdcd8-582a-460b-bbb2-f55c76b39ae3",
                "operator": {
                  "type": "dateTime",
                  "operation": "after"
                },
                "leftValue": "={{ $json.isoDate }}",
                "rightValue": "={{ DateTime.now().minus({ hours: 24 }).toISO() }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "1cb69db6-d8ff-4b90-875d-f54720058744",
        "name": "Sort - Articles by Date",
        "type": "n8n-nodes-base.sort",
        "position": [
          400,
          1216
        ],
        "parameters": {
          "options": {},
          "sortFieldsUi": {
            "sortField": [
              {
                "order": "descending",
                "fieldName": "isoDate"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "64d14789-8049-4476-aa7a-9b92c5075c92",
        "name": "Build Final Newsletter HTML",
        "type": "n8n-nodes-base.code",
        "position": [
          1168,
          1216
        ],
        "parameters": {
          "jsCode": "// Take the output from the LLM - News Summarizer node\nconst item = items[0].json;\n\n// 1. Get raw text from Gemini format\nlet text = item?.content?.parts?.[0]?.text;\nif (!text) {\n  throw new Error(\n    \"Unexpected LLM output, missing content.parts[0].text:\\n\" +\n    JSON.stringify(item, null, 2)\n  );\n}\n\n// 2. If there is ```json ... ``` remove the fences\nconst fenced = text.match(/```json?[\\s\\n]*([\\s\\S]*?)```/i);\nif (fenced) {\n  text = fenced[1].trim();\n}\n\n// 3. Extract the first { ... } block (in case the model adds text before/after)\nlet candidate = text;\nconst start = candidate.indexOf(\"{\");\nconst end = candidate.lastIndexOf(\"}\");\nif (start === -1 || end === -1) {\n  throw new Error(\n    \"No JSON object found in LLM output:\\n\" + text\n  );\n}\ncandidate = candidate.slice(start, end + 1);\n\n// 4. Clean trailing commas before } or ]\ncandidate = candidate.replace(/,\\s*([}\\]])/g, \"$1\");\n\n// 5. Parse JSON\nlet data;\ntry {\n  data = JSON.parse(candidate);\n} catch (err) {\n  throw new Error(\n    \"JSON parse error (inner payload from LLM):\\n\" +\n    err.message +\n    \"\\n\\nPayload was:\\n\" +\n    candidate\n  );\n}\n\n// 6. Special cases: { \"text\": \"{...}\" } etc.\nif (data.text && (!data.subject || !data.html)) {\n  try {\n    const inner = JSON.parse(data.text);\n    if (inner.subject && inner.html) {\n      data = inner;\n    }\n  } catch {\n    // if it fails, keep data as-is and proceed\n  }\n}\n\n// 7. Final validation\nif (!data.subject || !data.html) {\n  throw new Error(\n    \"LLM JSON does not contain subject/html as expected:\\n\" +\n    JSON.stringify(data, null, 2)\n  );\n}\n\n// 8. HTML email template\nconst htmlEmail = `\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>${data.subject}</title>\n  <style>\n    body { font-family: Arial, sans-serif; line-height:1.5; color:#333; background-color:#f7f9fa; margin:0; padding:20px; }\n    .container { max-width:700px; margin:0 auto; background:#fff; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.1); overflow:hidden; }\n    .header { background:#2c3e50; color:#fff; padding:20px; text-align:center; }\n    .header h1 { margin:0; font-size:24px; }\n    .content { padding:20px; }\n    h2 { color:#e74c3c; border-bottom:2px solid #e74c3c; padding-bottom:5px; }\n    ul { padding-left:20px; }\n    li { margin-bottom:10px; }\n    a { color:#2980b9; text-decoration:none; }\n    a:hover { text-decoration:underline; }\n    .footer { background:#ecf0f1; text-align:center; padding:10px; font-size:12px; color:#7f8c8d; }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"header\">\n      <h1>${data.subject}</h1>\n    </div>\n    <div class=\"content\">\n      ${data.html}\n    </div>\n    <div class=\"footer\">\n      <em>Briefing automatically sent on ${new Date().toLocaleDateString('en-US', {\n        year: 'numeric', month: 'long', day: 'numeric'\n      })}.</em>\n    </div>\n  </div>\n</body>\n</html>\n`.trim();\n\n// 9. Return data for the Gmail node\nreturn [\n  {\n    json: {\n      subject: data.subject,\n      html: htmlEmail,\n    },\n  },\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "f6e41658-fcb0-4b07-99cf-1c9df1ca2e99",
        "name": "Send Final Digest Email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1520,
          1216
        ],
        "webhookId": "2dc19d78-fe57-437a-8ce2-6337f6ceff87",
        "parameters": {
          "sendTo": "user@example.com",
          "message": "={{ $json.html }}",
          "options": {
            "senderName": "n8n News"
          },
          "subject": "=News_Tech | n8n RSS"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "454oo3lK2q6e5HzC",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "84e2fce2-bbac-4a12-badb-1275dde45e4b",
        "name": "Code in JavaScript",
        "type": "n8n-nodes-base.code",
        "position": [
          608,
          1216
        ],
        "parameters": {
          "jsCode": "// Trasforma i 68 item in UN solo item con un array \"articles\"\nreturn [\n  {\n    json: {\n      articles: items.map(i => ({\n        title: i.json.title,\n        content: i.json.contentSnippet || i.json.content,\n        link: i.json.link,\n        isoDate: i.json.isoDate,\n      })),\n    },\n  },\n];"
        },
        "typeVersion": 2
      },
      {
        "id": "e6b6c2c8-876b-4023-b2ec-b2242ee98060",
        "name": "LLM - News Summarizer",
        "type": "@n8n/n8n-nodes-langchain.googleGemini",
        "position": [
          816,
          1216
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "models/gemini-2.5-flash",
            "cachedResultName": "models/gemini-2.5-flash"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=You are the editor-in-chief of a major technology newspaper.\n\nEvery day you receive dozens of tech, AI and cybersecurity news articles, but your job is NOT to summarize everything.\nYour job is to decide WHAT REALLY MATTERS for a smart reader interested in technology, innovation and digital power.\n\nThink like a front-page editor of a tech newspaper.\n\n━━━━━━━━━━━━━━━━━━━━\nEDITORIAL RULES\n━━━━━━━━━━━━━━━━━━━━\n\n### 1. SELECTION (most important rule)\n\n* From ALL provided articles, select at most 8–10 total news items.\n* Selecting fewer is perfectly acceptable.\n* Ignore minor updates, marketing announcements, product rumors, curiosities, lifestyle tech, speculative hype.\n\n---\n\n### 2. RELEVANCE CRITERIA (at least one)\n\nSelect only news that have real strategic importance, such as:\n\n* Artificial Intelligence (foundation models, regulation, major deployments, scientific or industrial breakthroughs)\n* Big Tech companies (OpenAI, Google, Microsoft, Meta, Apple, Amazon, Nvidia, etc.)\n* Cybersecurity incidents (data breaches, ransomware, state-sponsored cyberwarfare, critical infrastructure attacks)\n* Regulation & digital policy (EU AI Act, privacy, antitrust, platform regulation)\n* Semiconductors, cloud, digital infrastructure, networks\n* National or European technological sovereignty\n* Major industrial or economic impacts of technology\n* Democracy, misinformation, surveillance, digital rights\n\n---\n\n### 3. DEDUPLICATION\n\n* If multiple articles refer to the same event, keep only one.\n* Prefer the most complete, clear and authoritative article.\n\n---\n\n### 4. STRUCTURE BY TOPIC\n\nGroup the selected news into the following categories\n(use only those with at least one item):\n\n* AI & Machine Learning\n* Big Tech & Digital Industry\n* Cybersecurity & Cyberwar\n* Regulation & Digital Policy\n* Tech Economy & Markets\n* Infrastructure, Cloud & Chips\n* Digital Society & Rights\n\nDo NOT invent new categories.\n\n---\n\n### 5. WRITING STYLE + LINK (CRITICAL RULES)\n\n* Each news item: 1–2 sentences, journalistic and factual tone\n* No opinions, no commentary, no hype\n* Prefer context and implications over technical details\n\nMANDATORY LINK\n\n* Every news item must end with ONE source, formatted as a clickable HTML link on the name of the outlet only\n* DO NOT show the URL in plain text\n* DO NOT use markdown\n* DO NOT use parentheses, brackets or braces\n\n✅ ONLY ALLOWED FORMAT:\n\n<a href=\"ORIGINAL_URL\" target=\"_blank\">Outlet Name</a>\n\n✅ Correct example:\n\nAmazon Web Services introduced new chips and strengthened its AI services at the Re:Invent event, focusing on the integration of generative models for enterprises. <a href=\"https://www.ilsole24ore.com/...\" target=\"_blank\">Il Sole 24 Ore</a>\n\n---\n\n━━━━━━━━━━━━━━━━━━━━\nINPUT DATA\n━━━━━━━━━━━━━━━━━━━━\n\nYou receive the last 24 hours of tech news as a JSON array of articles:\n\n{{ JSON.stringify($json.articles) }}\n\nEach article includes:\n\n* title\n* content\n* link\n* isoDate\n\n---\n\n━━━━━━━━━━━━━━━━━━━━\nTASK\n━━━━━━━━━━━━━━━━━━━━\n\n1. Read all articles in \"articles\".\n2. Select only the most relevant tech / AI / cyber news (max 8–10).\n3. Deduplicate articles covering the same event.\n4. Organize the selected news into the defined categories.\n5. Build a clean, readable HTML output, ensuring every news item includes its formatted source link.\n\n---\n\n━━━━━━━━━━━━━━━━━━━━\nOUTPUT (MANDATORY)\n━━━━━━━━━━━━━━━━━━━━\n\nYou must return ONLY a valid JSON object.\nNo additional text, no explanations, no markdown, no code fences.\n\nExact format:\n\n{\n  \"subject\": \"Tech & AI Briefing – [Day Month Year]\",\n  \"html\": \"<h2>🧠 Tech, AI & Cyber – Top Stories</h2>...<p><em>Tech briefing automatically generated on [Day Month Year].</em></p>\"\n}\n\nIf you include even a single word outside this JSON object, the response is INVALID."
              }
            ]
          }
        },
        "credentials": {
          "googlePalmApi": {
            "id": "odFC4MRUZfXkV4ZA",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4bcab353-1ec6-46ce-b06f-0c20f25b51b8",
        "name": "RSS_darkreading",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          320
        ],
        "parameters": {
          "url": "https://www.darkreading.com/rss.xml",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "6b138749-4c9c-4050-af9f-a02e078fe408",
        "name": "RSS_GoogleCloudBlog",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          64
        ],
        "parameters": {
          "url": "https://cloudblog.withgoogle.com/topics/threat-intelligence/rss/",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "f3c1b42e-14fb-49bf-ac07-ba54359ee235",
        "name": "RSS_krebsonsecurity",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          -192
        ],
        "parameters": {
          "url": "https://krebsonsecurity.com/feed/",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "1b1f01a4-1e4c-464f-92c8-6a33dedf030f",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1104,
          2176
        ],
        "parameters": {
          "color": 7,
          "height": 416,
          "content": "### Nvidia"
        },
        "typeVersion": 1
      },
      {
        "id": "a52e25c6-42e7-41bf-b379-1dfc74b51ac3",
        "name": "RSS_Nvidia1",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          2208
        ],
        "parameters": {
          "url": "https://nvidianews.nvidia.com/releases.xml",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "6d17fd5a-1fe5-4922-b3e1-caa63a16cbb6",
        "name": "RSS_Nvidia2",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          2336
        ],
        "parameters": {
          "url": "https://developer.nvidia.com/blog/feed",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "4df9ae9a-a0dc-4dc5-afb5-77cc75a3d305",
        "name": "RSS_Nvidia3",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          2464
        ],
        "parameters": {
          "url": "https://feeds.feedburner.com/nvidiablog",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "d740fd2e-7407-439a-982a-91a69d2e974b",
        "name": "RSS_OpenAI",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          2016
        ],
        "parameters": {
          "url": "https://openai.com/news/rss.xml",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "e101e47a-b74c-4239-98ad-5dc934a71496",
        "name": "RSS_cve1",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          624
        ],
        "parameters": {
          "url": "https://nvd.nist.gov/feeds/xml/cve/misc/nvd-rss.xml",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "9bf9fe97-16ae-4afa-8a1a-2c34b9665d5b",
        "name": "RSS_cve2",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          752
        ],
        "parameters": {
          "url": "https://cvefeed.io/rssfeed/latest.xml",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "4c5f021e-91bd-4d04-a618-9f9ed5185049",
        "name": "Merge_Nvidia",
        "type": "n8n-nodes-base.merge",
        "position": [
          -736,
          2336
        ],
        "parameters": {
          "numberInputs": 3
        },
        "typeVersion": 3.2
      },
      {
        "id": "31dd05a0-007f-420a-b998-861c4fde049e",
        "name": "Merge_AI",
        "type": "n8n-nodes-base.merge",
        "position": [
          -736,
          1808
        ],
        "parameters": {
          "numberInputs": 4
        },
        "typeVersion": 3.2
      },
      {
        "id": "2021a80f-c837-4a47-a0fd-b3a542cd153b",
        "name": "Merge_Cyber1",
        "type": "n8n-nodes-base.merge",
        "position": [
          -736,
          -16
        ],
        "parameters": {
          "numberInputs": 8
        },
        "typeVersion": 3.2
      },
      {
        "id": "f62fbf89-cfd0-4051-867d-0bc0253eff45",
        "name": "Merge_Cyber2",
        "type": "n8n-nodes-base.merge",
        "position": [
          -736,
          704
        ],
        "parameters": {},
        "typeVersion": 3.2
      },
      {
        "id": "d75ca9e8-257b-4ec4-92cc-174ccb13372e",
        "name": "Merge_Cyber3",
        "type": "n8n-nodes-base.merge",
        "position": [
          -736,
          1104
        ],
        "parameters": {
          "numberInputs": 5
        },
        "typeVersion": 3.2
      },
      {
        "id": "96a345b0-bc85-4c9a-bd54-2576ad5f3177",
        "name": "Merge_All",
        "type": "n8n-nodes-base.merge",
        "position": [
          -48,
          1168
        ],
        "parameters": {
          "numberInputs": 5
        },
        "typeVersion": 3.2
      },
      {
        "id": "efa61ecf-3f45-4aed-8cd6-0125ce530d07",
        "name": "RSS_darkreading1",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          192
        ],
        "parameters": {
          "url": "https://research.checkpoint.com/feed/",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "9bf679c2-a256-4d9f-88a7-1c88f3a0a242",
        "name": "RSS_Sans",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          464
        ],
        "parameters": {
          "url": "https://isc.sans.edu/rssfeed_full.xml",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "4293ac0a-21aa-4a7c-a8c4-500f0f494d68",
        "name": "RSS_CiscoTalos",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          1440
        ],
        "parameters": {
          "url": "https://blog.talosintelligence.com/rss/",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "8f95b809-f398-4cd3-bb32-2b395282bc8b",
        "name": "RSS Read",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1040,
          1296
        ],
        "parameters": {
          "url": "https://feeds.feedburner.com/eset/blog",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "5b07023a-66af-4b91-b587-76f837f4f076",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -2032,
          1248
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "dabb8fc9-b658-4617-9534-b541baee78c7",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -224,
          -528
        ],
        "parameters": {
          "width": 592,
          "height": 992,
          "content": "## RSS Tech News to your inbox\n\nThis workflow automates the collection, normalization, and publication of content from a broad set of RSS feeds. The execution begins with a Schedule Trigger, which activates the entire pipeline at recurring intervals. Each feed is handled by its own individual RSS node, allowing full separation of sources and easier monitoring or troubleshooting. The collected items flow into a structured series of Merge nodes that consolidate all outputs into one unified data stream.\n\nAfter aggregation, the workflow performs filtering and transformation. A dedicated filtering step removes invalid or duplicate entries, while a custom Function node standardizes fields such as title, URL, timestamp, and raw content. This ensures that data coming from heterogeneous sources is normalized before further processing. The workflow also includes an AI-powered enrichment stage—via an OpenAI node—which generates summaries, tags, categories, or any other metadata needed to enhance the collected articles.\n\nThe pipeline concludes by delivering the processed content to a chosen destination (email, database, Notion, API endpoint, or social platform). The modular design allows new sources to be added effortlessly without altering the core logic, making the workflow scalable and easy to maintain.\nThis setup is ideal for automated newsletters, content curation, topic monitoring, or internal knowledge management systems.\n\nRead: [Full setup Guide](https://paoloronco.it/n8n-template-rss-tech-news-to-your-inbox/)\n\n#### Youtube Video: \n[![RSS Tech News](https://img.youtube.com/vi/Gck8nmvx1UA/0.jpg)](https://www.youtube.com/watch?v=Gck8nmvx1UA \"RSS Tech News\")"
        },
        "typeVersion": 1
      },
      {
        "id": "a7afaeb6-90ed-41e9-98da-acc7dcd53a6a",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2064,
          1104
        ],
        "parameters": {
          "color": 7,
          "width": 192,
          "height": 288,
          "content": "📌 Schedule Trigger\nStarts the entire workflow automatically at defined intervals—no manual execution required."
        },
        "typeVersion": 1
      },
      {
        "id": "b589cb54-d7dd-4dbc-a796-3a840f647307",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1408,
          -512
        ],
        "parameters": {
          "color": 7,
          "width": 192,
          "height": 192,
          "content": "📌 RSS Nodes (Multiple Sources)\n\nEach node fetches the latest entries from one feed. Using isolated nodes keeps the flow stable and simplifies debugging."
        },
        "typeVersion": 1
      },
      {
        "id": "0bcdb515-2676-45ae-b6fd-631ad65febd8",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -96,
          992
        ],
        "parameters": {
          "color": 7,
          "width": 192,
          "height": 416,
          "content": "📌 Merge Nodes\n\nCombine all feed outputs into one coherent dataset, preparing the workflow for global filtering and processing."
        },
        "typeVersion": 1
      },
      {
        "id": "82e0d9b0-99f7-48c8-9e34-a1d6b31a4718",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          112,
          992
        ],
        "parameters": {
          "color": 7,
          "width": 208,
          "height": 352,
          "content": "📌 Filter\n\nFilters out everything older than 24 hours by comparing each article’s isoDate to “now minus 24 hours”. Only fresh news is allowed through to keep the briefing truly daily and relevant."
        },
        "typeVersion": 1
      },
      {
        "id": "e8f58b9c-f8c1-43fe-8347-c9ab83fb7528",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          800,
          992
        ],
        "parameters": {
          "color": 7,
          "width": 256,
          "height": 352,
          "content": "📌 Gemini Node (AI Enrichment)\n\nGenerates summaries, keywords, topics, or enhanced textual representations of each article."
        },
        "typeVersion": 1
      },
      {
        "id": "f3dcffd2-acb7-4a46-ab22-fd95b606909e",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1472,
          992
        ],
        "parameters": {
          "color": 7,
          "width": 256,
          "height": 368,
          "content": "📌 Final Output Node (Email / Notion / API / etc.)\n\nSends the finished newsletter via Gmail.\nUses the subject from the Code node and the generated html as the email body, so you receive a curated Tech & AI briefing directly in your inbox with no manual work required."
        },
        "typeVersion": 1
      },
      {
        "id": "214a64fc-a382-4080-b2c5-55efe456a4c5",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          336,
          992
        ],
        "parameters": {
          "color": 7,
          "width": 208,
          "height": 352,
          "content": "📌Sort – Articles by Date\n\nSorts all remaining articles by isoDate in descending order. This ensures that the most recent and time-sensitive stories are processed first and shown higher in the final briefing."
        },
        "typeVersion": 1
      },
      {
        "id": "1ebc2fb4-1105-4edf-92b1-8909e3d072d0",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          560,
          992
        ],
        "parameters": {
          "color": 7,
          "width": 224,
          "height": 352,
          "content": "📌Sort – Code in JavaScript\n\nTakes all incoming RSS items and packs them into a single item with an articles array.\nFor each article it keeps: title, content or contentSnippet, link, isoDate\n"
        },
        "typeVersion": 1
      },
      {
        "id": "93992ebf-d965-4db0-a30f-933369648275",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1072,
          992
        ],
        "parameters": {
          "color": 7,
          "width": 368,
          "height": 368,
          "content": "📌 Build Final Newsletter HTML (Code)\n\nThis Code node takes the JSON returned by the LLM and prepares the final email.\nIt removes any ```json wrappers, parses the JSON safely, and checks that subject and html exist.\nThen it inserts both fields into a clean, responsive HTML email template.\nThe output is a single item containing the final subject and html, ready for the Gmail node."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "01915da8-1071-4cf1-811d-9ec164adc58b",
    "connections": {
      "Filter": {
        "main": [
          [
            {
              "node": "Sort - Articles by Date",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS_MIT": {
        "main": [
          [
            {
              "node": "Merge_AI",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Merge_AI": {
        "main": [
          [
            {
              "node": "Merge_All",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "RSS Read": {
        "main": [
          [
            {
              "node": "Merge_Cyber3",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "RSS_Sans": {
        "main": [
          [
            {
              "node": "Merge_Cyber1",
              "type": "main",
              "index": 7
            }
          ]
        ]
      },
      "RSS_cve1": {
        "main": [
          [
            {
              "node": "Merge_Cyber2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS_cve2": {
        "main": [
          [
            {
              "node": "Merge_Cyber2",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Merge_All": {
        "main": [
          [
            {
              "node": "Filter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS_OpenAI": {
        "main": [
          [
            {
              "node": "Merge_AI",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "RSS_Nvidia1": {
        "main": [
          [
            {
              "node": "Merge_Nvidia",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS_Nvidia2": {
        "main": [
          [
            {
              "node": "Merge_Nvidia",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "RSS_Nvidia3": {
        "main": [
          [
            {
              "node": "Merge_Nvidia",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Merge_Cyber1": {
        "main": [
          [
            {
              "node": "Merge_All",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge_Cyber2": {
        "main": [
          [
            {
              "node": "Merge_All",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Merge_Cyber3": {
        "main": [
          [
            {
              "node": "Merge_All",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Merge_Nvidia": {
        "main": [
          [
            {
              "node": "Merge_All",
              "type": "main",
              "index": 4
            }
          ]
        ]
      },
      "RSS_CiscoTalos": {
        "main": [
          [
            {
              "node": "Merge_Cyber3",
              "type": "main",
              "index": 4
            }
          ]
        ]
      },
      "RSS_darkreading": {
        "main": [
          [
            {
              "node": "Merge_Cyber1",
              "type": "main",
              "index": 6
            }
          ]
        ]
      },
      "RSS_GrahamCluley": {
        "main": [
          [
            {
              "node": "Merge_Cyber1",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "RSS_darkreading1": {
        "main": [
          [
            {
              "node": "Merge_Cyber1",
              "type": "main",
              "index": 5
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "RSS_TheHackersNews",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_cybersecuritynews",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_krebsonsecurity",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_GrahamCluley",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_GoogleCloudBlog",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_darkreading1",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_Sans",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_cve1",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_cve2",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_ilsole24ore Cyber",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_ilsole24ore Tech",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_cybersecurity360",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS Read",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_CiscoTalos",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_artificialintelligence-news.",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_GoogleResearch",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_MIT",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_OpenAI",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_Nvidia1",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_Nvidia2",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_Nvidia3",
              "type": "main",
              "index": 0
            },
            {
              "node": "RSS_darkreading",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "LLM - News Summarizer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS_GoogleResearch": {
        "main": [
          [
            {
              "node": "Merge_AI",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "RSS_TheHackersNews": {
        "main": [
          [
            {
              "node": "Merge_Cyber1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS_GoogleCloudBlog": {
        "main": [
          [
            {
              "node": "Merge_Cyber1",
              "type": "main",
              "index": 4
            }
          ]
        ]
      },
      "RSS_krebsonsecurity": {
        "main": [
          [
            {
              "node": "Merge_Cyber1",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "RSS_cybersecurity360": {
        "main": [
          [
            {
              "node": "Merge_Cyber3",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "RSS_ilsole24ore Tech": {
        "main": [
          [
            {
              "node": "Merge_Cyber3",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "LLM - News Summarizer": {
        "main": [
          [
            {
              "node": "Build Final Newsletter HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS_cybersecuritynews": {
        "main": [
          [
            {
              "node": "Merge_Cyber1",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "RSS_ilsole24ore Cyber": {
        "main": [
          [
            {
              "node": "Merge_Cyber3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Sort - Articles by Date": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Build Final Newsletter HTML": {
        "main": [
          [
            {
              "node": "Send Final Digest Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS_artificialintelligence-news.": {
        "main": [
          [
            {
              "node": "Merge_AI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "v9dRFBMYVwnQUhii",
    "meta": {
      "instanceId": "d06afcec45b6881aa3c2bd3e34579ea44e46952db235308e9371e2bb743e4b43",
      "templateCredsSetupCompleted": true
    },
    "name": "AI Research Assistant with Jina & Gemini",
    "tags": [],
    "nodes": [
      {
        "id": "43de71f4-db4d-41aa-8294-abf2e0e984c8",
        "name": "Search web",
        "type": "n8n-nodes-base.jinaAi",
        "position": [
          20,
          40
        ],
        "parameters": {
          "options": {
            "outputFormat": ""
          },
          "operation": "search",
          "searchQuery": "={{ $json.chatInput }}",
          "requestOptions": {}
        },
        "credentials": {
          "jinaAiApi": {
            "id": "5ZbnfpUHVYg1i658",
            "name": "Jina AI account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8126e0ee-8472-4f1f-8921-1e2aded6682e",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -300,
          40
        ],
        "webhookId": "19764858-2825-4532-98ce-8fc538cf9ed0",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "0c414f7e-d927-4a6b-a45c-412676d99986",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          700,
          40
        ],
        "parameters": {
          "options": {
            "reset": false
          }
        },
        "typeVersion": 3
      },
      {
        "id": "0a8274f0-7ef4-4305-a3e7-81b34cd07ddc",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          340,
          40
        ],
        "parameters": {
          "language": "python",
          "pythonCode": "extracted_urls = []\n\nfor item in _input.all():\n    original_json = item.json\n\n    if 'url' in original_json:\n        extracted_urls.append({'url': original_json['url']})\n      \nreturn extracted_urls"
        },
        "typeVersion": 2
      },
      {
        "id": "540cae13-9d70-47b5-9be4-902abc7d6391",
        "name": "Read URL content",
        "type": "n8n-nodes-base.jinaAi",
        "position": [
          1040,
          200
        ],
        "parameters": {
          "url": "={{ $json.url }}",
          "options": {},
          "requestOptions": {}
        },
        "credentials": {
          "jinaAiApi": {
            "id": "5ZbnfpUHVYg1i658",
            "name": "Jina AI account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e282b54c-4230-449b-ab7c-96f0566e81f2",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          1980,
          180
        ],
        "webhookId": "d584a477-75aa-4d75-aa1b-0ef3c630f8cc",
        "parameters": {
          "amount": 1
        },
        "typeVersion": 1.1
      },
      {
        "id": "37c6d91d-526e-4c9a-a1f3-4bbba63740bd",
        "name": "Structured Output",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1640,
          340
        ],
        "parameters": {
          "jsonSchemaExample": "{\n\t\"source_url\": \"...\",\n\t\"summarized_content\": \"...\"\n}"
        },
        "typeVersion": 1.3
      },
      {
        "id": "ef58119f-ab0e-4c99-a83d-d2a0dbc0ba17",
        "name": "Transform",
        "type": "n8n-nodes-base.code",
        "position": [
          1060,
          -180
        ],
        "parameters": {
          "language": "python",
          "pythonCode": "all_outputs = []\nfor item in _input.all():\n    current_item_data = item.json\n\n    # Safely get the 'url' from the current item's data\n    output = current_item_data.get('output')\n\n    # Append the URL to the list if it exists\n    if output:\n        all_outputs.append(output)\n\n# Create the final single dictionary with all URLs under the \"urls\" key\nfinal_output_dict = {\n    \"output\": all_outputs\n}\n\n# Return the final dictionary as a single n8n item\nreturn [{'json': final_output_dict}]"
        },
        "typeVersion": 2
      },
      {
        "id": "154f148c-2f33-4d1d-afe2-2b75adfa16c5",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -420,
          -160
        ],
        "parameters": {
          "width": 340,
          "height": 380,
          "content": "## User query\n"
        },
        "typeVersion": 1
      },
      {
        "id": "0bb609ef-222d-4cc6-8ffd-0145cea615f3",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          -160
        ],
        "parameters": {
          "color": 7,
          "width": 260,
          "height": 380,
          "content": "## Search web\n\n**Purpose:** Web search using Jina AI based on chat input.\n**Input:** Chat message.\n**Note:** Requires Jina AI API key."
        },
        "typeVersion": 1
      },
      {
        "id": "01ee087c-e26c-4b8f-9f3f-9598d0cd83d3",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          220,
          -160
        ],
        "parameters": {
          "color": 2,
          "width": 320,
          "height": 380,
          "content": "## Code (URL Transform)\n\n**Purpose:** Custom JavaScript code to process/transform URLs, likely preparing them for the loop.\n**Input:** Raw URLs from \"Search web\".\n**Output:** Formatted URLs suitable for \"Loop over Items\"."
        },
        "typeVersion": 1
      },
      {
        "id": "76f010e5-fc84-4066-a39a-7dd870ff9345",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          560,
          -160
        ],
        "parameters": {
          "color": 6,
          "width": 380,
          "height": 380,
          "content": "## Loop over all URLs\n\n**Purpose:** Iterates over each URL provided by the \"Code\" node.\n**Function:** Processes each URL individually for content gathering and summarization.\n**Note:** Essential for handling multiple search results."
        },
        "typeVersion": 1
      },
      {
        "id": "6cdc7a5f-b488-4b72-a0da-9351c7478ea1",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          960,
          100
        ],
        "parameters": {
          "color": 3,
          "width": 260,
          "height": 480,
          "content": "## Read URL Content\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n**Purpose:** Fetches the full content of each URL provided by the loop.\n**Input:** Individual URLs from \"Loop over Items\".\n**Output:** Raw web page content.\n**Note:** Essential for summarization."
        },
        "typeVersion": 1
      },
      {
        "id": "0d3c40cd-733b-4508-adc6-e34171e48ef1",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1240,
          100
        ],
        "parameters": {
          "color": 5,
          "width": 600,
          "height": 480,
          "content": "## Summarize Gathered content\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n**Purpose:** AI agent to summarize web page content.\n**Input:** Web content & user query.\n**Output:** Summarized content.\n**Note:** Uses \"Summarizer Model\"."
        },
        "typeVersion": 1
      },
      {
        "id": "30e03e88-16a5-4a77-bf19-74488042d88f",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1860,
          100
        ],
        "parameters": {
          "color": 4,
          "width": 340,
          "height": 480,
          "content": "## Avoid rate limits\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n**Purpose:** Introduces a pause to prevent hitting API rate limits.\n**Configuration:** Adjust delay time (e.g., 1000ms) based on API limits.\n**Tip:** Crucial for stable, long-running processes."
        },
        "typeVersion": 1
      },
      {
        "id": "52fd4d1c-63b6-44f0-b43f-30f092eadf7f",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          960,
          -480
        ],
        "parameters": {
          "width": 300,
          "height": 480,
          "content": "## Transform (Summaries Aggregator)\n\n**Purpose:** Python code to consolidate all individual summarized outputs into a single list.\n**Input:** Multiple summaries.\n**Output:** One item with `{\"output\": [all_summaries]}`.\n**Key:** Prepares data for research report generation."
        },
        "typeVersion": 1
      },
      {
        "id": "1572a6bd-ed9b-4461-9167-4b1d98bfc878",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1280,
          -480
        ],
        "parameters": {
          "color": 7,
          "width": 480,
          "height": 480,
          "content": "## Generate research Report\n\n**Purpose:** AI Agent to orchestrate research report generation.\n**Input:** Summarized data from \"Transform summarized data\".\n**Function:** Guides the \"Generator Model\" to create the report."
        },
        "typeVersion": 1
      },
      {
        "id": "f35efe92-7181-4283-8b93-858b807b1b40",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1780,
          -480
        ],
        "parameters": {
          "width": 500,
          "height": 480,
          "content": "## Evaluate and Generate Final Report\n\n**Purpose:** AI Chain to evaluate and refine the generated report.\n**Input:** Research report from \"Generator Agent\".\n**Function:** Uses \"Evaluator Model\" to assess and improve output quality."
        },
        "typeVersion": 1
      },
      {
        "id": "d6d4b224-dd71-4bf7-be6f-b804002d48ac",
        "name": "Summarizer Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1420,
          180
        ],
        "parameters": {
          "text": "=Summarize this information:\n\nSource url: {{ $json.url }}\nTitle of the page: {{ $json.title }}\nDescription: {{ $json.description }}\nContent: {{ $json.content }}\n\nInitial User query: {{ $('When chat message received').item.json.chatInput }}",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2
      },
      {
        "id": "ef2cf6a3-3ea5-4874-898f-25ebc56997f1",
        "name": "Summarizer Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1380,
          340
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "ngL4RI02lM8v6drj",
            "name": "Google Gemini API"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4d26eb57-9e13-45e9-b365-c531189b0030",
        "name": "Generator Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1340,
          -120
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "ngL4RI02lM8v6drj",
            "name": "Google Gemini API"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "bc46ca58-24a6-4942-86e2-1c4c4df46c45",
        "name": "Generator Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1380,
          -320
        ],
        "parameters": {
          "text": "=## System Instructions\n\nYou are a specialized research AI agent designed to synthesize information from multiple sources and produce comprehensive, well-cited research documents. Your primary function is to analyze provided source URLs and their summarized contents to generate detailed research reports with proper inline citations.\n\n## Input \n\nInput with source_url and their summary : {\n\"1\": {\n    \"source_url\": {{ $json.output[0].source_url }},\n    \"summarized_content\": {{ $json.output[0].summarized_content }}\n  },\n\"2\": {\n    \"source_url\": {{ $json.output[1].source_url }},\n    \"summarized_content\": {{ $json.output[1].summarized_content }}\n  },\n\"3\": {\n    \"source_url\": {{ $json.output[2] }},\n    \"summarized_content\": {{ $json.output[2].summarized_content }}\n  },\n\"4\": {\n    \"source_url\": {{ $json.output[3].source_url }},\n    \"summarized_content\": {{ $json.output[3].summarized_content }}\n  },\n\"5\": {\n    \"source_url\": {{ $json.output[4].source_url }},\n    \"summarized_content\": {{ $json.output[4].summarized_content }}\n  },\n\"6\": {\n    \"source_url\": {{ $json.output[5].source_url }},\n    \"summarized_content\": {{ $json.output[5].summarized_content }}\n  },\n\"7\": {\n    \"source_url\": {{ $json.output[6].source_url }},\n    \"summarized_content\": {{ $json.output[6].summarized_content }}\n  },\n\"8\": {\n    \"source_url\": {{ $json.output[7].source_url }},\n    \"summarized_content\": {{ $json.output[7].summarized_content }}\n  },\n\"9\": {\n    \"source_url\": {{ $json.output[8].source_url }},\n    \"summarized_content\": {{ $json.output[8].summarized_content }}\n  },\n\"10\": {\n    \"source_url\": {{ $json.output[9].source_url }},\n    \"summarized_content\": {{ $json.output[9].summarized_content }}\n  }\n} \n\n\n## Research Generation Instructions\n\n### 1. Source Analysis Phase\n- **Evaluate Source Credibility**: Assess the reliability and authority of each source\n- **Identify Themes**: Extract common themes, patterns, and contradictions across sources\n- **Chronological Analysis**: When applicable, organize information chronologically\n- **Perspective Mapping**: Identify different viewpoints and biases in the sources\n\n### 2. Research Structure Requirements\n\n#### A. Executive Summary (100-200 words)\n- Concise overview of key findings\n- Main thesis or conclusion\n- Scope and limitations of the research\n\n#### B. Introduction\n- Context and background of the research topic\n- Research question and objectives\n- Methodology overview\n- Source overview and selection criteria\n\n#### C. Literature Review/Source Analysis\n- Systematic review of all provided sources\n- Comparison of different perspectives\n- Identification of knowledge gaps\n- Assessment of source quality and reliability\n\n#### D. Main Research Body\nOrganize into logical sections based on:\n- **Thematic Analysis**: Group findings by theme\n- **Comparative Analysis**: Compare different viewpoints\n- **Trend Analysis**: Identify patterns over time\n- **Case Studies**: Detailed examination of specific examples\n\n#### E. Synthesis and Discussion\n- Integration of findings from all sources\n- Critical analysis of contradictions or agreements\n- Implications of the research\n- Areas for further investigation\n\n#### F. Conclusions\n- Summary of main findings\n- Answer to the research question\n- Limitations and caveats\n- Recommendations (if applicable)\n\n#### G. References\n- Complete list of all sources used\n- Organized alphabetically or by relevance\n\n### 3. Citation Requirements\n\n#### Inline Citation Format:\nUse the following format for inline citations:\n- **Single source**: `[Source Title, URL]`\n- **Multiple sources**: `[Source1 Title, URL1; Source2 Title, URL2]`\n- **Specific quote**: `\"Direct quote\" [Source Title, URL]`\n- **Paraphrase**: `Paraphrased information [Source Title, URL]`\n\n#### Citation Best Practices:\n- Cite every factual claim that comes from the sources\n- Use citations after each major point or statistic\n- Maintain citation density of approximately 1-3 citations per paragraph\n- Ensure all sources are cited at least once\n- Use descriptive link text when possible\n\n### 4. Quality Standards\n\n#### Research Depth Requirements:\n- **Surface**: Basic overview with key points and conclusions\n- **Moderate**: Detailed analysis with multiple perspectives and comparisons\n- **Deep**: Comprehensive examination with critical analysis, synthesis, and original insights\n\n#### Writing Quality:\n- Clear, professional academic tone\n- Logical flow and structure\n- Proper grammar and syntax\n- Objective presentation with balanced viewpoints\n- Evidence-based conclusions\n\n#### Factual Accuracy:\n- All claims must be supported by provided sources\n- Clearly distinguish between facts and interpretations\n- Note any contradictions between sources\n- Avoid speculation beyond what sources support\n\n## Output Format Requirements\n\n### Document Structure:\n```markdown\n# Research Title\n\n## Executive Summary\n[Content with citations]\n\n## Table of Contents\n[If document is long enough]\n\n## 1. Introduction\n[Content with citations]\n\n## 2. Literature Review\n[Content with citations]\n\n## 3. [Main Research Sections]\n[Content with citations]\n\n## 4. Discussion and Synthesis\n[Content with citations]\n\n## 5. Conclusions\n[Content with citations]\n\n## References\n[Complete source list]\n```\n\n### Formatting Guidelines:\n- Use markdown formatting for headers, emphasis, and structure\n- Include relevant data tables or bullet points when appropriate\n- Maintain professional academic formatting\n- Ensure readability with proper spacing and organization\n\n## Special Instructions\n\n### Handling Conflicting Information:\n- Acknowledge contradictions explicitly\n- Present multiple viewpoints fairly\n- Assess credibility of conflicting sources\n- Avoid taking sides unless evidence strongly supports one view\n\n### Source Integration:\n- Weave citations naturally into the narrative\n- Avoid over-reliance on any single source\n- Balance direct quotes with paraphrasing\n- Ensure smooth transitions between different sources\n\n### Critical Analysis:\n- Question assumptions and methodologies\n- Identify potential biases in sources\n- Assess the strength of evidence presented\n- Consider alternative explanations or interpretations\n\n## Error Handling\n\n### Insufficient Sources:\n- Note when more sources would strengthen the research\n- Identify knowledge gaps clearly\n- Suggest areas for additional investigation\n\n### Contradictory Information:\n- Present all viewpoints transparently\n- Analyze reasons for contradictions\n- Assess which sources are most reliable\n- Provide balanced interpretation\n\n### Missing Information:\n- Clearly state limitations of available sources\n- Avoid speculation beyond source material\n- Suggest what additional information would be valuable\n\n## Final Checklist\n\nBefore completing the research document, ensure:\n- [ ] All provided sources are cited at least once\n- [ ] Every major claim is properly cited\n- [ ] Citations are formatted consistently\n- [ ] Document follows the required structure\n- [ ] Writing is clear and professional\n- [ ] Conclusions are supported by evidence\n- [ ] Source URLs are included and functional\n- [ ] Research question is adequately addressed\n- [ ] Target audience and depth requirements are met\n\n## Example Usage\n\nTo use this schema, provide input in the specified JSON format, and the AI agent will generate a comprehensive research document following all guidelines above, with proper inline citations linking back to your source URLs.",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 2
      },
      {
        "id": "bb051d77-8911-4f09-8626-b5e4f72ee5db",
        "name": "Evaluator Chain",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          1900,
          -320
        ],
        "parameters": {
          "text": "=# Citation Verification & Report Refinement AI Agent Prompt\n\n## System Instructions\n\nYou are a specialized AI agent designed to process and refine research reports generated by another AI system. Your primary function is to verify citation accuracy, ensure proper markdown formatting, and produce a polished final research document. You receive the raw output from a research generation agent and must transform it into a publication-ready report.\n\n## Input Schema\n\n### Expected Input Format:\n```json\n[\n  {\n    \"output\": \"{{ $json.output }}\"\n  }\n]\n```\n\n## Core Responsibilities\n\n### 1. Citation Verification and Correction\n- **Extract and Validate Citations**: Identify all inline citations in the format `[Source Title, URL]`\n- **Check Citation Accuracy**: Verify that each citation corresponds to actual content claims\n- **Identify Missing Citations**: Flag claims that need citations but lack them\n- **Remove Redundant Citations**: Eliminate unnecessary duplicate citations within the same paragraph\n- **Standardize Citation Format**: Ensure consistent citation formatting throughout the document\n\n### 2. Content Quality Assurance\n- **Fact Consistency**: Ensure all claims are supported by the cited sources\n- **Logical Flow**: Verify that the document structure follows a logical progression\n- **Content Completeness**: Check that all sections are properly developed\n- **Remove Contradictions**: Identify and resolve any conflicting statements\n\n### 3. Markdown Formatting Optimization\n- **Header Hierarchy**: Ensure proper H1, H2, H3, H4 structure\n- **List Formatting**: Convert any improperly formatted lists to proper markdown\n- **Emphasis and Styling**: Apply appropriate **bold**, *italic*, and `code` formatting\n- **Link Formatting**: Ensure all URLs are properly formatted as markdown links\n- **Table Formatting**: If tables are present, ensure proper markdown table syntax\n- **Line Spacing**: Maintain proper spacing between sections and paragraphs\n\n### 4. Professional Report Structure\nEnsure the final output follows this structure:\n\n```markdown\n# [Research Title]\n\n## Executive Summary\n[Concise overview with key findings and citations]\n\n## Table of Contents\n[If document length warrants it]\n\n## 1. Introduction\n[Context, objectives, methodology with citations]\n\n## 2. Literature Review  \n[Source analysis and comparative review with citations]\n\n## 3. [Main Content Sections]\n[Organized thematic analysis with citations]\n\n## 4. Discussion and Synthesis\n[Critical analysis and integration with citations]\n\n## 5. Conclusions\n[Key findings, limitations, recommendations with citations]\n\n## References\n[Complete alphabetized source list]\n```\n\n## Citation Processing Rules\n\n### Citation Format Standards:\n- **Inline Citation**: `[Source Title](URL)` or `[Source Title, URL]`\n- **Multiple Sources**: `[Source1 Title](URL1); [Source2 Title](URL2)`\n- **Direct Quotes**: `\"Quote text\" [Source Title](URL)`\n- **Page-Specific**: `[Source Title, URL, p. X]` (if page numbers available)\n\n### Citation Quality Checks:\n1. **Relevance**: Each citation must directly support the claim it follows\n2. **Accessibility**: All URLs must be valid and accessible\n3. **Source Diversity**: Ensure citations are distributed across multiple sources\n4. **Citation Density**: Maintain 1-3 citations per substantial paragraph\n5. **Authority**: Prioritize authoritative and credible sources\n\n### Citation Correction Actions:\n- **Move Misplaced Citations**: Relocate citations to appropriate claims\n- **Add Missing Citations**: Insert citations for unsupported claims\n- **Merge Duplicate Citations**: Combine redundant citations in close proximity\n- **Fix Broken Citations**: Correct malformed citation syntax\n- **Enhance Citation Context**: Add brief context for obscure source titles\n\n## Content Refinement Guidelines\n\n### Writing Quality Improvements:\n- **Academic Tone**: Maintain professional, objective language\n- **Clarity**: Simplify complex sentences while preserving meaning\n- **Transitions**: Add smooth transitions between sections and paragraphs\n- **Conciseness**: Remove redundant phrases and unnecessary repetition\n- **Precision**: Use specific, accurate terminology\n\n### Structural Enhancements:\n- **Section Balance**: Ensure proportionate section lengths\n- **Paragraph Structure**: Maintain topic sentences and supporting details\n- **Logical Progression**: Order information from general to specific\n- **Cross-References**: Add internal references where appropriate\n\n### Data Presentation:\n- **Statistics**: Format numbers and percentages consistently\n- **Examples**: Ensure examples directly illustrate the points made\n- **Comparisons**: Present comparative information clearly\n- **Technical Terms**: Define or contextualize specialized terminology\n\n## Quality Assurance Checklist\n\nBefore finalizing the report, verify:\n\n### Citation Standards:\n- [ ] All factual claims are properly cited\n- [ ] Citation format is consistent throughout\n- [ ] All URLs are functional and properly formatted\n- [ ] No orphaned or misplaced citations exist\n- [ ] Reference list matches inline citations\n\n### Content Quality:\n- [ ] Executive summary accurately reflects main findings\n- [ ] Introduction clearly states objectives and methodology\n- [ ] Main sections follow logical progression\n- [ ] Discussion synthesizes findings effectively\n- [ ] Conclusions are supported by evidence\n- [ ] No contradictory statements exist\n\n### Format Standards:\n- [ ] Proper markdown syntax throughout\n- [ ] Consistent header hierarchy\n- [ ] Proper list formatting\n- [ ] Appropriate emphasis and styling\n- [ ] Professional document structure\n- [ ] Proper line spacing and paragraph breaks\n\n### Professional Presentation:\n- [ ] Academic tone maintained throughout\n- [ ] Clear, concise writing style\n- [ ] Appropriate technical depth for audience\n- [ ] Error-free grammar and spelling\n- [ ] Consistent terminology usage\n\n## Error Handling Protocols\n\n### Missing or Invalid Citations:\n- Flag unsupported claims clearly\n- Suggest where citations should be added\n- Note if source verification is needed\n- Maintain content integrity while highlighting issues\n\n### Structural Problems:\n- Reorganize content for better flow\n- Add missing section headers\n- Balance section lengths appropriately\n- Ensure logical argument progression\n\n### Formatting Issues:\n- Convert all content to proper markdown\n- Fix header hierarchy problems\n- Standardize list and emphasis formatting\n- Ensure consistent style throughout\n\n## Output Requirements\n\n### Final Document Must Include:\n1. **Complete Research Report** in proper markdown format\n2. **Citation Verification Summary** noting any issues found\n3. **Improvement Log** documenting changes made\n4. **Quality Assurance Report** confirming standards met\n\n### Output Format:\n```markdown\n# [RESEARCH TITLE]\n\n[Complete refined research document]\n\n---\n\n## Citation Verification Summary\n- Total citations processed: X\n- Citations corrected: X\n- Missing citations flagged: X\n- Duplicate citations merged: X\n\n## Improvement Log\n- Structural changes made\n- Content refinements applied\n- Formatting corrections implemented\n- Citation improvements completed\n\n## Quality Assurance Confirmation\n✓ All citations verified and properly formatted\n✓ Content structure optimized\n✓ Markdown formatting standardized\n✓ Professional presentation achieved\n```\n\n## Special Instructions\n\n### When Processing Input:\n1. **Extract the complete research content** from the JSON structure\n2. **Parse all existing citations** and create a reference database\n3. **Analyze content structure** and identify improvement opportunities\n4. **Apply systematic refinements** following the guidelines above\n5. **Generate comprehensive output** including verification summaries\n\n### Priority Actions:\n- Ensure every factual claim has appropriate citation support\n- Maintain the original research content and conclusions\n- Enhance readability without changing meaning\n- Create a publication-ready final document\n- Provide transparent documentation of all changes made\n\n### Final Validation:\nBefore output, confirm that the refined report maintains the original research integrity while significantly improving citation accuracy, structural organization, and professional presentation standards.",
          "batching": {},
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "05fbd517-84e6-4ee9-be45-805271ff0b6a",
        "name": "Evaluator Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1920,
          -120
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "ngL4RI02lM8v6drj",
            "name": "Google Gemini API"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "75a0f8dd-c2b8-462d-9eec-6f73710180b5",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -960,
          -160
        ],
        "parameters": {
          "color": 5,
          "width": 520,
          "height": 380,
          "content": "# JInaAI Workflow Overview\n\nThis workflow intelligently processes incoming chat messages by performing a web search using Jina AI and then leverages Gemini 2.5 Flash to generate and evaluate responses.\n\n**How to Use:**\n* Send a chat message to the configured webhook for the \"When chat message received\" node.\n* The workflow will automatically search the web and generate an AI-powered response.\n\n**Expected Output:**\n* An AI-generated response, potentially incorporating information from web searches."
        },
        "typeVersion": 1
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "1ddbd2df-251b-407c-8f5d-06e59affcd56",
    "connections": {
      "Code": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Transform": {
        "main": [
          [
            {
              "node": "Generator Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search web": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Evaluator Model": {
        "ai_languageModel": [
          [
            {
              "node": "Evaluator Chain",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Generator Agent": {
        "main": [
          [
            {
              "node": "Evaluator Chain",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generator Model": {
        "ai_languageModel": [
          [
            {
              "node": "Generator Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Transform",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Read URL content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read URL content": {
        "main": [
          [
            {
              "node": "Summarizer Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Summarizer Agent": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Summarizer Model": {
        "ai_languageModel": [
          [
            {
              "node": "Summarizer Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output": {
        "ai_outputParser": [
          [
            {
              "node": "Summarizer Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Search web",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "94ZTfrnyRHFV3xxr",
    "meta": {
      "instanceId": "a0abdc0b77c415ea268f7f162cb1411f29a01e7656935f2ebce0ae66e8df8e13"
    },
    "name": "DocAgentForTemplate",
    "tags": [],
    "nodes": [
      {
        "id": "d6dae967-cee4-4c8b-9f80-a1eb8279b2a0",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -20,
          300
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-pro"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "M4luDvdaNUQojgwm",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "514e6233-fe2d-4031-9ea6-ad046d2d1479",
        "name": "GetMetaData",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          420,
          300
        ],
        "parameters": {
          "url": "https://script.google.com/macros/s/<YOUR_DEPLOY_ID>/exec",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "mode",
                "value": "meta"
              },
              {
                "name": "id",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters1_Value', `The id of the template requested by the user comes here.`, 'string') }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              }
            ]
          },
          "nodeCredentialType": "googleDriveOAuth2Api"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "G5mimUj7FOKYpMol",
            "name": "Google Drive-n8n"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "c2d0ed01-0b5f-4e92-89a1-c140990b6998",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -60,
          -20
        ],
        "webhookId": "6c3d3341-4e58-40c9-b399-96c67481ed4a",
        "parameters": {
          "public": true,
          "options": {},
          "initialMessages": "Merhaba! 👋\nMy name is DocAgent. "
        },
        "typeVersion": 1.1
      },
      {
        "id": "74c575a0-6523-47d5-834e-a0c388d06676",
        "name": "DocAgent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          240,
          -20
        ],
        "parameters": {
          "options": {
            "systemMessage": "=You are “Legal-Doc Agent”, an expert that drafts professional Turkish\ndocuments from fixed Google Docs templates.\n\n<templateCatalog>\n{{ YOUR_MANUAL_TO_ADD_TEMPLATE_LIST }}\n</templateCatalog> \n\n#TOOLS AND USAGE RULES\nGetMetaData(id)                           → { placeholders\\[], conditionals\\[] }\nDocProcess(user_choice_name, user_choice_id, data{}) → \n\n(Call a tool by replying ONLY with\n{\"tool\":\"ToolName\",\"params\":{...}} )\n\n\n#FLOW\nstep-1 Determine which document in the templateCatalog the user wants to create.\nstep-2 Call GetMetaData with the identified id.  \n         → You get back:\n           • metadata.placeholders       (global/static placeholders)\n           • metadata.conditionals[]     (each has flag, label, help, placeholders[])\n\nstep-3 Request the necessary information from the user:\n         a) For each name in metadata.placeholders, ask “What is <PLACEHOLDER>? ”\n         b) For each item in metadata.conditionals:\n              i.   Ask “Would you like to include the <label> section? <help>”\n              ii.  Record in blocks[KEY].include = true/false\n              iii. If include===true, then for each p in placeholders[] ask “What is <p>? ”\n         → Build up a `data` object:\n            {\n              /* static values from 3a */,\n              blocks: {\n                KEY1: { include: true,  P1: val1, P2: val2… },\n                KEY2: { include: false            },\n                …\n              }\n            }\n\nstep-4 After collecting all the required information, submit the information provided by the user to the user for approval as a whole.\nstep-5 Using the `docId` and that `data` object, call the DocProcess (FillDocument) tool.\n\nstep-6 If there are no errors, return the new document’s download URL (or ID) to the user indicating success.\n\n\n#STYLE\n• Speak concise, formal Turkish.\n• Never guess data; always ask.\n• Only tool-call messages may contain JSON blocks.\n\n#RULES\nWhen calling DocProcess, DO NOT CHANGE/TRANSLATE the placeholder names and conditional flag names/structure returned by GetMetaData. Only place the answers you obtained from the user next to them.\n"
          }
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "753c8e8c-18f3-4a54-80a5-af1b5256a656",
        "name": "DocProcess",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          600,
          300
        ],
        "parameters": {
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "<YOUR_WORKFLOW_ID>"
          },
          "description": "Call this tool for Doc Process",
          "workflowInputs": {
            "value": {
              "data": "={{ $fromAI('data') }}",
              "user_choice_id": "={{ $fromAI('user_choice_id') }}",
              "user_choice_name": "={{ $fromAI('user_choice_name') }}"
            },
            "schema": [
              {
                "id": "user_choice_name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "user_choice_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "user_choice_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "user_choice_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "data",
                "type": "object",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "data",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "25b8e0ed-90ed-4e14-a042-a36a2cb6ec15",
        "name": "Postgres Chat Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
        "position": [
          200,
          300
        ],
        "parameters": {},
        "credentials": {
          "postgres": {
            "id": "S6crn2oCuGjvhvVO",
            "name": "DocAgentMemory"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "806c4fa9-6276-4066-b2ca-f0432c4ef228",
        "name": "Template List",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -500,
          440
        ],
        "parameters": {
          "url": "https://www.googleapis.com/drive/v3/files?q='%3CYOUR_PARENT_ID%3E'+in+parents+and+trashed=false&fields=files(id,name,description)&pageSize=1000",
          "options": {},
          "sendHeaders": true,
          "authentication": "predefinedCredentialType",
          "headerParameters": {
            "parameters": [
              {
                "name": "Accept",
                "value": "application/json"
              }
            ]
          },
          "nodeCredentialType": "googleDriveOAuth2Api"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "wIHEgJhIzXR9CFKm",
            "name": "Google Docs account"
          },
          "googleDriveOAuth2Api": {
            "id": "G5mimUj7FOKYpMol",
            "name": "Google Drive-n8n"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "5a5f198e-b611-492e-a194-0cdfc6d8a3de",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -560,
          260
        ],
        "parameters": {
          "color": 4,
          "width": 260,
          "height": 360,
          "content": "## Manual Template List Retrieval\n**The response returned from this API request is manually added to the system prompt.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "0ff8e732-1497-45af-b8a6-b29287d72f5f",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          160,
          260
        ],
        "parameters": {
          "width": 180,
          "height": 320,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n**It is preferred for more consistent memory management. Other alternatives can also be tried."
        },
        "typeVersion": 1
      },
      {
        "id": "656dedde-5074-412b-ab5b-d6ee9980d8d9",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          260
        ],
        "parameters": {
          "width": 180,
          "height": 320,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n**Metadata of the template selected by the user is dynamically retrieved."
        },
        "typeVersion": 1
      },
      {
        "id": "79633aef-0d8e-4f85-93f4-af4a13f47a7a",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          260
        ],
        "parameters": {
          "width": 180,
          "height": 320,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n**Prioritized due to free API-Key trial."
        },
        "typeVersion": 1
      },
      {
        "id": "839584c8-ce14-4c66-aee2-aa6572345fcc",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2000,
          -60
        ],
        "parameters": {
          "color": 6,
          "width": 1280,
          "height": 4140,
          "content": "## Description  \n\n## 1 — What Does It Do / Which Problem Does It Solve?\n\nThis workflow turns Google Docs-based contract & form templates into **ready-to-sign PDFs in minutes**—all from a single chat flow.\n\n- **Automates repetitive document creation.** Instead of copying a rental, sales, or NDA template and filling it by hand every time, the bot asks for the required values and fills them in.\n- **Eliminates human error.** It lists every mandatory field so nothing is missed, and removes unnecessary clauses via conditional blocks.\n- **Speeds up approvals.** The final draft arrives as a direct PDF link—one click to send for signing.\n- **One template → unlimited variations.** Every new template you drop in Drive is auto-listed with **zero workflow edits—**it scales effortlessly.\n- **100 % no-code.** Runs on n8n + Google Apps Script—no extra backend, self-hosted or cloud.\n\n---\n\n## 2 — How It Works (Detailed Flow)\n\n1. 📝 **Template Discovery**\n    \n    📂 The **TemplateList** node scans the Drive folder you specify via the `?mode=meta` endpoint and returns an `id / title / desc` list. The bot shows this list in chat.\n    \n2. 🎯 **Selection & Metadata Fetch**\n    \n    The user types a template name.\n    \n    🔍 **GetMetaData** opens the chosen Doc, extracts `META_JSON`, placeholders, and conditional blocks, then lists mandatory & optional fields.\n    \n3. 🗣 **Data-Collection Loop**\n    - The bot asks for every **placeholder** value.\n    - For each **conditional block** it asks 🟢 **Yes** / 🔴 **No**.\n        \n        Answers are accumulated in a `data` JSON object.\n        \n4. ✅ **Final Confirmation**\n    \n    The bot summarizes the inputs → when the user clicks **Confirm**, the *DocProcess* sub-workflow starts.\n    \n5. ⚙️ **DocProcess Sub-Workflow**\n    \n    \n    | 🔧 Step | Node | Task |\n    | --- | --- | --- |\n    | 1 | **User Choice Match Check** | Verifies name–ID match; throws if wrong |\n    | 2 | **GetMetaData (renew)** | Gets the latest placeholder list |\n    | 3 | **Validate JSON Format** | Checks for missing / unknown fields |\n    | 4 | **CopyTemplate** | Copies the Doc via Drive API |\n    | 5 | **FillDocument** | Apps Script fills placeholders & removes blocks |\n    | 6 | **Generate PDF Link** | Builds an `export?format=pdf` URL |\n6. 📎 **Delivery**\n    \n    The master agent sends **🔗 Download PDF** & **✏️ Open Google Doc** links.\n    \n7. 🚫 **Error Paths**\n    - `status:\"ERROR\", missing:[…]` → bot lists missing fields and re-asks.\n    - `unknown:[…]` → template list is outdated; rerun *TemplateList*.\n    - Any Apps Script error → the returned `message` is shown verbatim in chat.\n\n---\n\n## 3 — 🚀 Setup Steps (Full Checklist)\n\n> Goal: Get a flawless PDF on the first run.\n> \n> \n> Mentally **tick** the ☑️ in front of every line as you go.\n> \n\n### ☁️ A. Google Drive Preparation\n\n| Step | Do This | Watch Out For |\n| --- | --- | --- |\n| 1 | Create a `Templates/` folder → put every template Doc inside | Exactly **one** folder; **no** sub-folders |\n| 2 | Placeholders in every Doc are **`{{UPPER_CASE}}`** | No Turkish chars or spaces |\n| 3 | Wrap optional clauses with **`[[BLOCK_NAME:START]]…[[BLOCK_NAME:END]]`** | The `START` tag must have a **blank line above** |\n| 4 | Add a `META_JSON` block at the very end | Script deletes it automatically after fill |\n| 5 | Right-click Doc > **Details ▸ Description** = 1-line human description | Shown by the bot in the list |\n| 6 | Create a second `Generated/` folder (for copies) | Keeps Drive tidy |\n\n> 🔑 Folder ID (long alphanumerical) = <TEMPLATE_PARENT_ID>\n> \n> \n> We’ll paste this into the TemplateList node next.\n> \n\n[Simple sample template → Template Link](https://www.notion.so/Simple-sample-template-Template-Link-22b3f8a1e57f8070beacd034ba6f557f?pvs=21)\n\n---\n\n### 🛠 B. Import the Workflow into n8n\n\n```bash\nSettings ▸ Import Workflow ▸ DocAgent.json\n\n```\n\nIf nodes look **Broken** afterwards → no community-node problem; you only need to select credentials.\n\n---\n\n### 📑 C. Customize the TemplateList Node\n\n1. Open **Template List** node ⚙️ → replace\n    \n    `'%3CYOUR_PARENT_ID%3E' in parents`\n    \n    with the real **folder ID** in the **URL**.\n    \n2. Right-click node > **Execute Node**.\n3. Copy the entire JSON response.\n4. In the editor paste it into:\n    - **DocAgent** → *System Prompt* (top)\n    - **User Choice Match Check** → *System Prompt* (top)\n        \n        Save.\n        \n\n> ⚠️ Why manual? Caching the list saves LLM tokens. Whenever you add a template, rerun the node and update the prompts.\n> \n\n---\n\n### 🔗 D. Deploy the Apps Script\n\n| Step | Screen | Note |\n| --- | --- | --- |\n| 1 | Open Gist files **GetMetaData.gs** + **FillDocument.gs** → *File ▸ Make a copy* | Both files may live in one project |\n| 2 | *Project Settings* > enable **Google Docs API** ✔️ & **Google Drive API** ✔️ | Otherwise you’ll see 403 errors |\n| 3 | *Deploy ▸ New deployment ▸ Web app* |  |\n| • Execute as | **Me** |  |\n| • Who has access | **Anyone** |  |\n| 4 | On the consent screen allow scopes:• `…/auth/documents`• `…/auth/drive` | Click **Advanced › Go** if Google warns |\n| 5 | Copy the **Web App URL** (e.g. `https://script.google.com/macros/s/ABC123/exec`) | If this URL changes, update n8n |\n\n[Apps Script source code → Notion Link](https://www.notion.so/Apps-Script-source-code-Notion-Link-22b3f8a1e57f8015a280d90de16c031f?pvs=21)\n\n---\n\n### 🔧 E. Wire the Script URL in n8n\n\n| Node | Field | Action |\n| --- | --- | --- |\n| **GetMetaData** | *URL* | `<WEB_APP_URL>?mode=meta&id={{ $json[\"id\"] }}` |\n| **FillDocument** | *URL* | `<WEB_APP_URL>` |\n\n> 💡 Prefer using an .env file? Add GAS_WEBAPP_URL=… and reference it as {{ $env.GAS_WEBAPP_URL }}.\n> \n\n---\n\n### 🔐 F. Add Credentials\n\n- **Google Drive OAuth2** → *Drive API (v3) Full Access*\n- **Google Docs OAuth2** → same account\n- **LLM key** (OpenAI / Gemini)\n- (Optional) **Postgres Chat Memory** credential for the corresponding node\n\n---\n\n### 🧪 G. First Run (Smoke Test)\n\n1. Switch the workflow **Active**.\n2. In the chat panel type `/start`.\n3. Bot lists templates → pick one.\n4. Fill mandatory fields, optionally toggle blocks → **Confirm**.\n5. **🔗 Download PDF** link appears → ☑️ setup complete.\n\n---\n\n### ❌ H. Common Errors & Fixes\n\n| 🆘 Error | Likely Cause | Remedy |\n| --- | --- | --- |\n| `403: Apps Script permission denied` | Web app access set to *User* | Redeploy as **Anyone**, re-authorize scopes |\n| `placeholder validation failed` | Missing required field | Provide the listed values → rerun DocProcess |\n| `unknown placeholders: …` | Template vs. agent mismatch | Check placeholder spelling (UPPER_CASE ASCII) |\n| `Template ID not found` | Prompt list is old | Rerun **TemplateList** → update both prompts |\n| `Cannot find META_JSON` | No meta block / wrong tag | Add `[[META_JSON_START]] … [[META_JSON_END]]`, retry |\n\n---\n\n### ✅ Final Checklist\n\n- [ ]  Drive folder structure & template rules ready\n- [ ]  Workflow imported, folder ID set in node\n- [ ]  TemplateList output pasted into both prompts\n- [ ]  Apps Script deployed, URL set in nodes\n- [ ]  OAuth credentials & LLM key configured\n- [ ]  `/start` test passes, PDF link received\n\n---\n\n## 🙋‍♂️ Need Help with Customizations?\n\nReach out for consulting & support on LinkedIn: [**Özgür Karateke**](https://www.linkedin.com/in/%C3%B6zg%C3%BCr-karateke-130514147/)\n\n[Simple sample template → Template Link](https://www.notion.so/Simple-sample-template-Template-Link-22b3f8a1e57f8070beacd034ba6f557f?pvs=21)\n\n[Apps Script source code → Notion Link](https://www.notion.so/Apps-Script-source-code-Notion-Link-22b3f8a1e57f8015a280d90de16c031f?pvs=21)"
        },
        "typeVersion": 1
      },
      {
        "id": "69000a74-eba7-41a8-8c93-635e8664a1ce",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -100,
          660
        ],
        "parameters": {
          "color": 4,
          "width": 3640,
          "height": 1040,
          "content": "## DocProcess (Subworkflow)"
        },
        "typeVersion": 1
      },
      {
        "id": "d5f08f8a-d45c-4a6b-9223-b98aafe7b6a3",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          80,
          1020
        ],
        "parameters": {
          "workflowInputs": {
            "values": [
              {
                "name": "user_choice_name"
              },
              {
                "name": "user_choice_id"
              },
              {
                "name": "data",
                "type": "object"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "709b08c4-7c8c-4d63-a8c2-3e8d96df40ce",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          660,
          1020
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "a78bfdab-11cc-4ef1-8074-1fdcd6f14275",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.output.eslesme }}",
                "rightValue": "true"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "2dd91c47-fefb-4715-a3ce-4a9f411d569d",
        "name": "Google Gemini Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1620,
          1140
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-pro"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "M4luDvdaNUQojgwm",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "eac6b3cd-eb34-476d-a500-71bce8d5c29a",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          440,
          1240
        ],
        "parameters": {
          "jsonSchemaExample": "{\n\t\"eslesme\": true,\n\t\"user_choice_name\": \"SATIŞ SÖZLEŞMESİ\",\n    \"user_choice_id\": \"<EXAMPLE_TEMPLATE_ID>\"\n}"
        },
        "typeVersion": 1.3
      },
      {
        "id": "76be9549-a482-496a-b11c-ddf8a958f39a",
        "name": "Edit Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          1320,
          920
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": []
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "011d9a1a-3841-4fbd-84f6-99b4ad4eb782",
        "name": "If1",
        "type": "n8n-nodes-base.if",
        "position": [
          2340,
          920
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "91055448-6534-40ca-939b-dfbdf2974ab1",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $('Format Control').item.json.output.docId }}",
                "rightValue": "={{ $json.id }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "1f537d7f-d6d1-463b-999c-73fcba2b5024",
        "name": "Other Errors",
        "type": "n8n-nodes-base.set",
        "position": [
          3220,
          1420
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "cb4572fd-8cc7-4e85-860b-aabbb6b1038d",
                "name": "Belge oluşturulamama sebebi:",
                "type": "string",
                "value": "=Please consult the user to resolve the following error.\n{{ $('FillDocument').item.json.message }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "b0790f5f-256e-4559-926d-9ab45f1cad96",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          3000,
          1120
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Template Technical Error",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "c35889e4-f027-49b9-9b59-69cf996f0e9c",
                      "operator": {
                        "type": "array",
                        "operation": "notEmpty",
                        "singleValue": true
                      },
                      "leftValue": "={{ $('FillDocument').item.json.unknown }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Incomplete Information Error",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "08a43597-51af-4632-82c5-ff54505bae13",
                      "operator": {
                        "type": "array",
                        "operation": "notEmpty",
                        "singleValue": true
                      },
                      "leftValue": "={{ $('FillDocument').item.json.missing }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Other Errors",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "b42acb05-8237-46c2-80f4-27cfb1232710",
                      "operator": {
                        "type": "string",
                        "operation": "notEquals"
                      },
                      "leftValue": "={{ $('FillDocument').item.json.message }}",
                      "rightValue": " Placeholder validation failed"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "26c8978f-4f18-4026-994a-4c3b2b0dfeed",
        "name": "CopyTemplate",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          2120,
          920
        ],
        "parameters": {
          "name": "={{ $now.toFormat('dd.MM.yyyy') }} tarihli {{ $('GetMetaData2').item.json.metadata.title }} belgesi",
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.docId }}"
          },
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "id",
            "value": "=<YOUR_FOLDER_ID>"
          },
          "operation": "copy",
          "sameFolder": false
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "G5mimUj7FOKYpMol",
            "name": "Google Drive-n8n"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "9ff9e7e9-1455-4d0b-8191-79b0c74b363b",
        "name": "FillDocument",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2560,
          1020
        ],
        "parameters": {
          "url": "https://script.google.com/macros/s/<YOUR_DEPLOY_ID>/exec",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "docId",
                "value": "={{ $json.id }}"
              },
              {
                "name": "data",
                "value": "={{ $('Formatting Correction').item.json.data }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "ce49d769-0a53-40d0-b05c-25b071994aff",
        "name": "Google Gemini Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          320,
          1240
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-pro"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "M4luDvdaNUQojgwm",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "cec0fdb3-0d86-47d5-9393-7718f20c5cf1",
        "name": "User Choice Matching Error",
        "type": "n8n-nodes-base.set",
        "position": [
          880,
          1120
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "0bd79b8c-66b5-4a4e-9888-6a0af9276061",
                "name": "pdf_id",
                "type": "string",
                "value": "The template name selected by the user does not match the template matched by the agent. Please check if the template name selected by the user matches its id."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "bbb55fdb-6f7c-404c-8f00-c5d9da4e4803",
        "name": "User Choice Match Correct",
        "type": "n8n-nodes-base.set",
        "position": [
          880,
          920
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "0a616fd3-6227-4902-9d1d-1ca09f14412e",
                "name": "output.user_choice_id",
                "type": "string",
                "value": "={{ $json.output.user_choice_id }}"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "e47a0291-ffa1-4cf5-850d-f882849eb917",
        "name": "User Choice Match Check",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          300,
          1020
        ],
        "parameters": {
          "text": "=The reference point is the document name chosen by the user.\n\n<document_name_and_id>\n{{ $json.user_choice_name }}\n{{ $json.user_choice_id }}\n</document_name>\n\n<guide_template_list>\n{{ YOUR_MANUAL_TO_ADD_TEMPLATE_LIST }}\n</guide_template_list>\n\nA match of id information is given according to the document name. Examine this match according to the guide list given to you.\n\nIf match is correct\n\n{\n\"match\": true,\n\"user_choice_name\":\"{{ $json.user_choice_name }}\" ,\n\"user_choice_id\": {{ $json.user_choice_id }}\n}\n\nIf match is incorrect:\n{\n\"match\": false,\n\"user_choice_name\":\"{{ $json.user_choice_name }}\" ,\n\"user_choice_id\": {{ $json.user_choice_id }},\n\"correct_id\":\"WRITE THE ID YOU NEED HERE\"\n}",
          "batching": {},
          "messages": {
            "messageValues": [
              {
                "message": "Cevaplarını JSON formatında ver."
              }
            ]
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "6c13dece-f397-4d12-b60f-64890848889e",
        "name": "GetMetaData2",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1100,
          920
        ],
        "parameters": {
          "url": "https://script.google.com/macros/s/<YOUR_DEPLOY_ID>/exec",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "mode",
                "value": "meta"
              },
              {
                "name": "id",
                "value": "={{ $json.output.user_choice_id }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "a9303653-7510-4fb7-b16c-14e49e7de89b",
        "name": "Format Control",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          1540,
          920
        ],
        "parameters": {
          "text": "=Place the actual user answers according to the rules using the metadata information of the document given to you.\n\nMatch only the original metadata placeholder and conditional flags with the answers given by the user. DO NOT change the placeholder and conditional flag texts in the metadata.\n\n<metadata>\n{{ $json.metadata.toJsonString() }}\n</metadata>\n\n<user_answers>\n\n{{ $('When Executed by Another Workflow').item.json.data.toJsonString() }}\n</user_answers>\n\nFormat example of the output you should give:\n\n{\n\"docId\": \"<EXAMPLE_TEMPLATE_ID>\",\n\"data\": {\n// — Static (mandatory) placeholders —\n\"SELLER_NAME\": \"Özgür Mözgür\",\n\"BUYER_NAME\": \"Ali Veli\",\n\"PRODUCT_NAME\": \"Computer\",\n\"PRICE\": \"10000\",\n\"DELIVER_DATE\": \"12.06.2025\",\n\"TODAY_DATE\": \"02.07.2025\",\n\n// — Conditional blocks in the “blocks” object —\n\"blocks\": {\n\"MADATE_INSTALLMENT\": {\n\"include\": false\n// INSTALLMENT_PLAN is not sent because include:false\n},\n\"GUARANTEE\": {\n\"include\": true,\n\"GUARANTEE_PERIOD\": \"24\"\n}\n}\n}\n}",
          "batching": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "ad6cfa0a-d879-465c-8fec-26f3bc281f4c",
        "name": "Formatting Correction",
        "type": "n8n-nodes-base.code",
        "position": [
          1900,
          920
        ],
        "parameters": {
          "jsCode": "// 1) We get the raw text with $input.first() (direct JS instead of Expression)\n// $input provides access to each item as n8n's global variable.\nconst raw = $input.first().json.text;\n\n// 2) Regex to catch ```json … ``` block\nconst match = raw.match(/```json\\s*([\\s\\S]*?)```/i);\n\n// 3) Extract block or use full text\nconst jsonString = match ? match[1] : raw;\n\n// 4) Trim + parse\nconst clean = jsonString.trim();\nlet parsed;\ntry {\n  parsed = JSON.parse(clean);\n} catch (e) {\n  throw new Error(`JSON parse hatası: ${e.message}\\n\\nRaw içerik:\\n${clean}`);\n}\n\n// 5) Return a single item output\nreturn [{ json: parsed }];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "faeaad9d-e23c-429b-bff9-bb277dcf677f",
        "name": "Cop. Document ID Matching Error",
        "type": "n8n-nodes-base.set",
        "position": [
          2560,
          820
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "4dec2470-f7cb-4b0a-92a8-31cf88581921",
                "name": "Belge oluşturulamama sebebi:",
                "type": "string",
                "value": "=The document id to be filled with the copied document does not match"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "2dba1518-f4ce-4d85-95a3-40245b3226bc",
        "name": "if",
        "type": "n8n-nodes-base.if",
        "position": [
          2780,
          1020
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "fc031e6c-6bc6-445b-9cd5-f8e749156f88",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.status }}",
                "rightValue": "OK"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "ca0de06e-d55a-4243-94ff-55cd742c28a8",
        "name": "Generate Download Link",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3000,
          820
        ],
        "parameters": {
          "url": "=https://www.googleapis.com/drive/v3/files/{{ $('CopyTemplate').item.json.id }}?fields=webContentLink,exportLinks ",
          "options": {},
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googleDriveOAuth2Api"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "G5mimUj7FOKYpMol",
            "name": "Google Drive-n8n"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "9deae9c7-8b62-475d-bff8-b04295df2e35",
        "name": "Download Link Format",
        "type": "n8n-nodes-base.set",
        "position": [
          3220,
          820
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "9af065e4-ec39-480b-b577-99351ed48228",
                "name": "download_link",
                "type": "string",
                "value": "={{ $json.exportLinks['application/pdf'] }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "3a2bbdb7-a69c-4b5f-8050-b75cfaed6d2e",
        "name": "Incomplete Information Error",
        "type": "n8n-nodes-base.set",
        "position": [
          3220,
          1020
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "4dec2470-f7cb-4b0a-92a8-31cf88581921",
                "name": "Belge oluşturulamama sebebi:",
                "type": "string",
                "value": "={{ $('FillDocument').item.json.status }}\nError description:\n{{ $('FillDocument').item.json.message }}\n\n\nLütfen buradaki eksik belgeleri user'dan isteyiniz. Tüm bilgileri tamamladıktan sonra tekrar DocProcess aracını çağırabilirsiniz. {{ $('FillDocument').item.json.missing.toJsonString() }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "132e6eb0-6630-4cd2-b490-b5033bf1782a",
        "name": "Template Technical Error",
        "type": "n8n-nodes-base.set",
        "position": [
          3220,
          1220
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "cb4572fd-8cc7-4e85-860b-aabbb6b1038d",
                "name": "Belge oluşturulamama sebebi:",
                "type": "string",
                "value": "=This is a technical error, you can send the following text to the user: \"Please consult your institution or organization for this issue. The draft that the document you requested was created from is incorrect.\""
              }
            ]
          }
        },
        "typeVersion": 3.4
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "8d310631-7990-4ed7-b18a-2c351cee1768",
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "User Choice Match Correct",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "User Choice Matching Error",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "if": {
        "main": [
          [
            {
              "node": "Generate Download Link",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Cop. Document ID Matching Error",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "FillDocument",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "Template Technical Error",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Incomplete Information Error",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Other Errors",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DocProcess": {
        "ai_tool": [
          [
            {
              "node": "DocAgent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Format Control",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GetMetaData": {
        "ai_tool": [
          [
            {
              "node": "DocAgent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "CopyTemplate": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FillDocument": {
        "main": [
          [
            {
              "node": "if",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GetMetaData2": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Control": {
        "main": [
          [
            {
              "node": "Formatting Correction",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres Chat Memory": {
        "ai_memory": [
          [
            {
              "node": "DocAgent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Formatting Correction": {
        "main": [
          [
            {
              "node": "CopyTemplate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Download Link": {
        "main": [
          [
            {
              "node": "Download Link Format",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "User Choice Match Check": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "DocAgent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "User Choice Match Check",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Format Control",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "User Choice Match Check",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "User Choice Match Correct": {
        "main": [
          [
            {
              "node": "GetMetaData2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "DocAgent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "User Choice Match Check",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "ef84ca26-59e1-46c6-a0e2-43f7a6bd7c29",
        "name": "Run Daily at 8 AM",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          760,
          1380
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "hours"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "8af0ca21-63aa-43a0-8755-85b006590435",
        "name": "Parse Alert Array",
        "type": "n8n-nodes-base.code",
        "position": [
          760,
          1620
        ],
        "parameters": {
          "jsCode": "// Get the raw output string from the previous node.\nconst rawOutput = $input.first().json.output;\n\n// The AI often wraps JSON in Markdown code blocks (```json ... ```).\n// We need to extract the pure JSON string from inside the fences.\n// This regex will find the content between the fences. If no fences are found,\n// it will fall back to using the entire rawOutput string.\nconst jsonStringMatch = rawOutput.match(/```json\\s*([\\s\\S]*?)\\s*```/);\nconst jsonString = jsonStringMatch ? jsonStringMatch[1] : rawOutput.trim();\n\n// Now, try to parse the *cleaned* string.\ntry {\n  const alerts = JSON.parse(jsonString);\n  \n  // Check if the result is a non-empty array.\n  if (Array.isArray(alerts) && alerts.length > 0) {\n    // Success! Pass the alerts to the next node.\n    return [{ json: { alerts } }];\n  }\n} catch (e) {\n  // This will catch errors if the cleaned string is still not valid JSON.\n  console.error(\"NixGuard did not return a valid JSON array even after cleaning:\", e);\n  console.error(\"String that failed to parse:\", jsonString);\n}\n\n// If parsing fails, it's not an array, or it's empty, return no items.\n// This will correctly route the workflow to the 'false' branch of the IF node.\nreturn [];"
        },
        "typeVersion": 2
      },
      {
        "id": "7d51a628-b285-4699-9068-9bed2ceea231",
        "name": "Set Prompt for Summary",
        "type": "n8n-nodes-base.set",
        "position": [
          1460,
          1600
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "chatInput",
                "value": "Act as a senior security analyst reporting to a non-technical executive. The following is a JSON array of all high-severity security alerts from the last 24 hours.\n\nYour tasks are:\n1. Start with a single sentence summarizing the day's overall security risk (e.g., 'The security posture today is stable with minor configurable issues detected.').\n2. State the total number of critical alerts found.\n3. In 3-4 clear bullet points using Markdown, summarize the most significant activities or threat patterns observed. Focus on business impact, not technical jargon.\n4. Conclude with a single, clear recommendation (e.g., 'No immediate action required' or 'Recommend prioritizing patches for web servers.').\n\nHere is the raw alert data:\n{{ JSON.stringify($json.alerts) }}"
              },
              {
                "name": "apiKey",
                "value": ""
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "26212ca9-51c1-49d4-9705-df7a74ba1b08",
        "name": "Set API Key & Initial Prompt",
        "type": "n8n-nodes-base.set",
        "position": [
          980,
          1380
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "apiKey",
                "value": ""
              },
              {
                "name": "chatInput",
                "value": "Review all security data from the last 24 hours. List all significant security alerts found. Your response MUST be a single, valid, minified JSON array of objects. Each object in the array should represent a distinct alert. If no significant alerts are found, return an empty array []."
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "edca6750-8948-4de8-89f2-290163db7480",
        "name": "Set Final Briefing",
        "type": "n8n-nodes-base.set",
        "position": [
          1460,
          1820
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "executive_summary",
                "value": "={{ $json.output }}"
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "d6cba9cd-fab4-4920-98f8-460b7002c94a",
        "name": "Execute: Get Daily Events as JSON (Get Real-Time Security Insights with NixGuard RAG and Wazuh Integration)",
        "type": "n8n-nodes-base.executeWorkflow",
        "position": [
          1220,
          1380
        ],
        "parameters": {
          "options": {},
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "I0nUORqYTwDFZa51",
            "cachedResultName": "Get Real-Time Security Insights with NixGuard RAG and Wazuh Integration"
          },
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c5bab77f-f161-494a-adb1-de1dd53bd5c7",
        "name": "Execute: Generate Executive Summary (Get Real-Time Security Insights with NixGuard RAG and Wazuh Integration)",
        "type": "n8n-nodes-base.executeWorkflow",
        "position": [
          1680,
          1600
        ],
        "parameters": {
          "options": {},
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "I0nUORqYTwDFZa51",
            "cachedResultName": "Get Real-Time Security Insights with NixGuard RAG and Wazuh Integration"
          },
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "1e7172f8-c728-4640-8633-f141fd1b94c4",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          1040,
          1620
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "bb7ac757-8402-446e-9ee7-d0be89c769a7",
                "operator": {
                  "type": "array",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.alerts }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "e889ebe4-c36a-4da6-bcd5-2e21661ec8d7",
        "name": "Send Email",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          1880,
          1820
        ],
        "parameters": {
          "html": "={{ $json.html_summary }}",
          "options": {},
          "subject": "Daily AI Cyber Security Briefing"
        },
        "typeVersion": 2.1
      },
      {
        "id": "4e771aef-10d4-4be8-8432-23bbf852f58f",
        "name": "Workflow Overview1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1380,
          1020
        ],
        "parameters": {
          "color": 7,
          "width": 540,
          "height": 340,
          "content": "## 💡 Workflow Overview: Daily AI Security Briefing\n\nThis workflow automates the creation of a daily security report for non-technical executives. It uses a two-stage AI process with the **NixGuard Security Connector** workflow.\n\n1.  **Stage 1 - Data Retrieval:** It calls the connector to fetch all recent security alerts, requesting the output as a structured JSON array.\n2.  **Stage 2 - Summarization:** If alerts were found, it calls the connector *again*, feeding it the raw alert data and prompting it to generate a high-level, business-friendly summary.\n\nThe final report is then delivered via email."
        },
        "typeVersion": 1
      },
      {
        "id": "47bb91e9-48e8-437d-a736-0f98ffcd923e",
        "name": "Setup Guide1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          940,
          920
        ],
        "parameters": {
          "color": 7,
          "width": 400,
          "height": 420,
          "content": "## ⚙️ 4-Step Setup Guide\n\n1.  **Import Child Workflow:** Make sure you also have the `Get Real-Time Security Insights with NixGuard...` workflow in your n8n instance and that it is **activated**.\n\n2.  **Set Your API Key:** In the **'Set API Key & Initial Prompt'** node, replace the placeholder with your valid NixGuard API key.\n\n3.  **Check Workflow ID:** This workflow calls the child workflow by its ID (`I0nUORqYTwDFZa51`). If your ID is different, you must update it in both **Execute Workflow** nodes.\n\n4.  **Configure Email:** Add your email credentials to the two **Send Email** nodes and update the recipient addresses in the `To` field."
        },
        "typeVersion": 1
      },
      {
        "id": "fab467cd-7e63-4606-9da4-a677dd7082b3",
        "name": "Convert Markdown to HTML",
        "type": "n8n-nodes-base.code",
        "position": [
          1660,
          1820
        ],
        "parameters": {
          "jsCode": "/**\n * WARNING: This is a simplified, lightweight Markdown to HTML converter.\n * It does NOT use a dedicated library and will only handle a limited subset of Markdown:\n * - Headings (h1, h2, h3)\n * - Bold text (**text**)\n * - Unordered list items (* item)\n * - Paragraphs (double newlines)\n * It will FAIL on complex cases like nested lists, tables, or code blocks.\n * For robust conversion, using the 'marked' library is strongly recommended.\n */\n\nfunction simpleMarkdownToHtml(markdown) {\n  let html = markdown\n    // Escape HTML to prevent injection from the input\n    .replace(/&/g, '&')\n    .replace(/</g, '<')\n    .replace(/>/g, '>');\n\n  // Block Elements (order matters)\n  html = html\n    .replace(/^### (.*$)/gim, '<h3>$1</h3>')\n    .replace(/^## (.*$)/gim, '<h2>$1</h2>')\n    .replace(/^# (.*$)/gim, '<h1>$1</h1>')\n    .replace(/^\\* (.*$)/gim, '<li>$1</li>');\n\n  // Inline Elements\n  html = html\n    .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n    .replace(/__(.*?)__/g, '<strong>$1</strong>') // Alternative bold\n    .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n    .replace(/_(.*?)_/g, '<em>$1</em>'); // Alternative italics\n\n  // Paragraphs and Line Breaks\n  // Wrap list items in <ul>\n  html = html.replace(/<li>(.|\\n)*?<li>/g, '<ul>$&');\n  html = html.replace(/(<\\/li>)(?!.*<li>)/g, '$1</ul>');\n  // Convert remaining newlines to <br> or wrap in <p>\n  html = html.replace(/\\n/g, '<br>');\n\n  return html;\n}\n\nconst markdownSummary = $input.first().json.executive_summary;\nconst htmlSummary = simpleMarkdownToHtml(markdownSummary);\n\n$input.first().json.html_summary = htmlSummary;\n\nreturn $input.all();\n"
        },
        "typeVersion": 2
      },
      {
        "id": "a20f8e25-d1f8-47fb-8378-3b4479882ffc",
        "name": "Setup Guide",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          500,
          900
        ],
        "parameters": {
          "color": 7,
          "width": 400,
          "height": 440,
          "content": "## Getting Started\n\n### Prerequisites:\n- Valid NixGuard API key\n\n### Setup Instructions:\n1. Configure your NixGuard API key in 'Prepare API Request Data' node\n2. Set up trigger method (chat or manual)\n3. Test with sample security queries\n4. Make sure NixGuard agents are installed on your network endpoints for real-time security events\n\n### Support:\nFor questions, visit [NixGuard Documentation](https://nixguard.thenex.world) or join our [Community Discord](https://discord.com/invite/ajCYwYCwHb)"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "Set Prompt for Summary",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Alert Array": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Run Daily at 8 AM": {
        "main": [
          [
            {
              "node": "Set API Key & Initial Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Final Briefing": {
        "main": [
          [
            {
              "node": "Convert Markdown to HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Prompt for Summary": {
        "main": [
          [
            {
              "node": "Execute: Generate Executive Summary (Get Real-Time Security Insights with NixGuard RAG and Wazuh Integration)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert Markdown to HTML": {
        "main": [
          [
            {
              "node": "Send Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set API Key & Initial Prompt": {
        "main": [
          [
            {
              "node": "Execute: Get Daily Events as JSON (Get Real-Time Security Insights with NixGuard RAG and Wazuh Integration)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute: Get Daily Events as JSON (Get Real-Time Security Insights with NixGuard RAG and Wazuh Integration)": {
        "main": [
          [
            {
              "node": "Parse Alert Array",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute: Generate Executive Summary (Get Real-Time Security Insights with NixGuard RAG and Wazuh Integration)": {
        "main": [
          [
            {
              "node": "Set Final Briefing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "823lWldG0eG7Wp63",
    "meta": {
      "instanceId": "a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462",
      "templateCredsSetupCompleted": true
    },
    "name": "Create Cheaper Video with Google Veo3 Fast and Upload to Social",
    "tags": [],
    "nodes": [
      {
        "id": "c1240b96-5a7f-4083-b9b4-daabb2c5710c",
        "name": "When clicking ‘Test workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -224,
          848
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "91219e34-506c-47b9-8265-70dac7300295",
        "name": "Get status",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          848,
          848
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/veo3/requests/{{ $('Create Video').item.json.request_id }}/status ",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "RfHIslxMFRjQZ043",
            "name": "Youtube Transcript Extractor API 1"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "033b0b85-7a84-4363-ba5e-02c1827a610c",
        "name": "Wait 60 sec.",
        "type": "n8n-nodes-base.wait",
        "position": [
          672,
          848
        ],
        "webhookId": "dd2c8c62-38f1-4e89-b047-6202e34525ac",
        "parameters": {
          "amount": 60
        },
        "typeVersion": 1.1
      },
      {
        "id": "b0f922cc-3356-4580-832f-53b3e0c13c95",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -224,
          704
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "minutes"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "1da61594-c860-4b6e-a588-93f21b146d53",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -224,
          -480
        ],
        "parameters": {
          "color": 3,
          "width": 740,
          "height": 312,
          "content": "# Generate Cheaper AI Videos (with audio), using Veo3 Fast and Upload to YouTube/TikTok\n\nThis workflow allows users to **generate AI videos** using cheaper model **Google Veo3 Fast**, save them to **Google Drive**, generate optimized YouTube titles with GPT-4o, and **automatically upload them to YouTube** . The entire process is triggered from a Google Sheet that acts as the central interface for input and output.\n\nIT automates video creation, uploading, and tracking, ensuring seamless integration between Google Sheets, Google Drive, Google Veo3, and YouTube.\n\n\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "f07ee239-5eab-408b-9b32-b5ccd23e67a8",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -224,
          -144
        ],
        "parameters": {
          "width": 740,
          "height": 200,
          "content": "## STEP 1 - GOOGLE SHEET\nCreate a [Google Sheet like this](https://docs.google.com/spreadsheets/d/1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ/edit?usp=sharing).\n\nPlease insert:\n- in the \"PROMPT\" column the accurate description of the video you want to create\n- in the \"DURATION\" column the lenght of the video you want to create\n\nLeave the \"VIDEO\" column unfilled. It will be inserted by the system once the video has been created"
        },
        "typeVersion": 1
      },
      {
        "id": "7fadd373-e9f7-4ec7-8e17-b8d6b0e5cc4a",
        "name": "Completed?",
        "type": "n8n-nodes-base.if",
        "position": [
          1024,
          848
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "383d112e-2cc6-4dd4-8985-f09ce0bd1781",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.status }}",
                "rightValue": "COMPLETED"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "e11dcb24-db2c-4a7d-98a5-da9f82617f2c",
        "name": "Update result",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          864,
          1104
        ],
        "parameters": {
          "columns": {
            "value": {
              "VIDEO": "={{ $('Get Url Video').item.json.video.url }}",
              "row_number": "={{ $('Get new video').item.json.row_number }}"
            },
            "schema": [
              {
                "id": "PROMPT",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PROMPT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "DURATION",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "DURATION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "VIDEO",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "VIDEO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "YOUTUBE_URL",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "YOUTUBE_URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/11ebWJvwwXHgvQld9kxywKQUvIoBw6xMa0g0BuIqHDxE/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ/edit?usp=drivesdk",
            "cachedResultName": "Video Google Veo3"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "3c64cedb-e28f-44b9-919c-d0005e504189",
        "name": "Set data",
        "type": "n8n-nodes-base.set",
        "position": [
          224,
          848
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "c713d31f-9abd-496a-ac79-e8e2efe60aa0",
                "name": "prompt",
                "type": "string",
                "value": "={{ $json.PROMPT }}\n\nDuration of the video: {{ $json.DURATION }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "29c7b76e-3532-4bb3-8725-f7d885977943",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -224,
          560
        ],
        "parameters": {
          "width": 740,
          "height": 100,
          "content": "## STEP 4 - MAIN FLOW\nStart the workflow manually or periodically by hooking the \"Schedule Trigger\" node. It is recommended to set it at 5 minute intervals."
        },
        "typeVersion": 1
      },
      {
        "id": "ae1b1b70-72ab-4e54-a761-c9bfacff7d32",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -224,
          112
        ],
        "parameters": {
          "width": 740,
          "height": 140,
          "content": "## STEP 2 - GET API KEY (YOURAPIKEY)\nCreate an account [here](https://fal.ai/) and obtain API KEY.\nIn the node \"Create Image\" set \"Header Auth\" and set:\n- Name: \"Authorization\"\n- Value: \"Key YOURAPIKEY\""
        },
        "typeVersion": 1
      },
      {
        "id": "123016dc-48f4-4088-a96a-bdc4579e5943",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          784
        ],
        "parameters": {
          "width": 180,
          "height": 200,
          "content": "Set API Key created in Step 2"
        },
        "typeVersion": 1
      },
      {
        "id": "8a572767-c418-4765-8ced-9ec2d70abbbb",
        "name": "Get new video",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          0,
          848
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "VIDEO"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ/edit?usp=drivesdk",
            "cachedResultName": "Video Google Veo3"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "4db8431d-7dc7-49ed-9216-731cbdb52c7e",
        "name": "Create Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          448,
          848
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/veo3/fast",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n     \"prompt\": \"{{$json.prompt}}\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "RfHIslxMFRjQZ043",
            "name": "Youtube Transcript Extractor API 1"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "fee900ba-5595-41d1-8fdb-15db3b059a53",
        "name": "Get Url Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -224,
          1232
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/veo3/requests/{{ $json.request_id }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "RfHIslxMFRjQZ043",
            "name": "Youtube Transcript Extractor API 1"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "dfbe979b-9efb-480d-b41b-3b2d60c217d3",
        "name": "Get File Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          400,
          1232
        ],
        "parameters": {
          "url": "={{ $('Get Url Video').item.json.video.url }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "0042395d-2ede-4dff-9530-c5b4729bb931",
        "name": "Upload Video",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          688,
          1104
        ],
        "parameters": {
          "name": "={{ $now.format('yyyyLLddHHmmss') }}-{{ $('Get Url Video').item.json.video.file_name }}",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1aHRwLWyrqfzoVC8HoB-YMrBvQ4tLC-NZ",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1aHRwLWyrqfzoVC8HoB-YMrBvQ4tLC-NZ",
            "cachedResultName": "Fal.run"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "db260ed7-1495-4423-9e3d-ca3c538c24b6",
        "name": "HTTP Request",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          688,
          1328
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate title').item.json.message.content }}"
              },
              {
                "name": "user",
                "value": "YOUR_USERNAME"
              },
              {
                "name": "platform[]",
                "value": "youtube"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "RfHIslxMFRjQZ043",
            "name": "Youtube Transcript Extractor API 1"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "d70339f6-50ba-4287-80d0-2eea7b442bf5",
        "name": "Generate title",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          32,
          1232
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Input: {{ $('Get new video').item.json.PROMPT }}"
              },
              {
                "role": "system",
                "content": "You are a YouTube SEO expert specialized in creating engaging and optimized titles.\n\nYour task is to generate an effective title for a YouTube video based on the user's video description.\n\nGUIDELINES:\n- Maximum 60 characters to avoid truncation\n- Use relevant keywords for SEO\n- Make the title catchy and clickable\n- Avoid excessive or misleading clickbait\n- Consider the target audience of the content\n- Use numbers, questions, or power words when appropriate\n- IMPORTANT: Generate the title in the same language as the input description\n\nOUTPUT FORMAT:\nProvide only the title, without additional explanations.\n\nEXAMPLE:\nInput: \"Tutorial video on how to cook perfect pasta carbonara\"\nOutput: \"PERFECT Carbonara in 10 Minutes - Chef's Secrets\""
              }
            ]
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "8e3b8953-ae08-4c94-b3dc-c5def40b7d5c",
        "name": "Update Youtube URL",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          864,
          1328
        ],
        "parameters": {
          "columns": {
            "value": {
              "row_number": "={{ $('Get new video').item.json.row_number }}",
              "YOUTUBE_URL": "=https://youtu.be/{{ $json.results.youtube.video_id }}"
            },
            "schema": [
              {
                "id": "PROMPT",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PROMPT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "DURATION",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "DURATION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "VIDEO",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "VIDEO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "YOUTUBE_URL",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "YOUTUBE_URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/11ebWJvwwXHgvQld9kxywKQUvIoBw6xMa0g0BuIqHDxE/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ/edit?usp=drivesdk",
            "cachedResultName": "Video Google Veo3"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "4dfadc00-0730-4a5f-827a-be278cdb82bd",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          672,
          1264
        ],
        "parameters": {
          "width": 180,
          "height": 408,
          "content": "Set YOUR_USERNAME in Step 3"
        },
        "typeVersion": 1
      },
      {
        "id": "52e444a8-3b7b-4dd5-af17-6ceabdcd4ec4",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -224,
          288
        ],
        "parameters": {
          "width": 740,
          "height": 232,
          "content": "## STEP 3 - Upload video on Youtube\n- Find your API key in your [Upload-Post Manage Api Keys](https://www.upload-post.com/?linkId=lp_144414&sourceId=n3witalia&tenantId=upload-post-app) 10 FREE uploads per month\n- Set the the \"Auth Header\":\n-- Name: Authorization\n-- Value: Apikey YOUR_API_KEY_HERE\n- Create profiles to manage your social media accounts. The \"Profile\" you choose will be used in the field YOUR_USRNAME (eg. test1 or test2).  \n\n\nThe free plan allows uploads to all platforms except TikTok. To enable, please upgrade to a paid plan."
        },
        "typeVersion": 1
      },
      {
        "id": "01315b32-2a78-4e23-87a5-13250324f635",
        "name": "Upload on TikTok",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          688,
          1520
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate title').item.json.message.content }}"
              },
              {
                "name": "user",
                "value": "YOUR_USERNAME"
              },
              {
                "name": "platform[]",
                "value": "tiktok"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "DEE2XGvhGodgbAJh",
            "name": "Upload-post.com API"
          }
        },
        "typeVersion": 4.2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "a8aa8b0f-aa99-4bce-b759-b7acc735164e",
    "connections": {
      "Set data": {
        "main": [
          [
            {
              "node": "Create Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Completed?": {
        "main": [
          [
            {
              "node": "Get Url Video",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait 60 sec.",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get status": {
        "main": [
          [
            {
              "node": "Completed?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Video": {
        "main": [
          [
            {
              "node": "Wait 60 sec.",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Update Youtube URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video": {
        "main": [
          [
            {
              "node": "Update result",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 60 sec.": {
        "main": [
          [
            {
              "node": "Get status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Url Video": {
        "main": [
          [
            {
              "node": "Generate title",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get new video": {
        "main": [
          [
            {
              "node": "Set data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update result": {
        "main": [
          []
        ]
      },
      "Generate title": {
        "main": [
          [
            {
              "node": "Get File Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get File Video": {
        "main": [
          [
            {
              "node": "Upload Video",
              "type": "main",
              "index": 0
            },
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            },
            {
              "node": "Upload on TikTok",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Test workflow’": {
        "main": [
          [
            {
              "node": "Get new video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "4IHvU7TL8cJuEdRh",
    "meta": {
      "instanceId": "15d6057a37b8367f33882dd60593ee5f6cc0c59310ff1dc66b626d726083b48d",
      "templateCredsSetupCompleted": true
    },
    "name": "Generate Personalized B2B Outreach Emails using AI Research",
    "tags": [],
    "nodes": [
      {
        "id": "47326b63-fedc-45c8-acaa-392f49fa7ac3",
        "name": "Add Lead to Instantly AI",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1232,
          -80
        ],
        "parameters": {
          "url": "https://api.instantly.ai/api/v2/leads",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"campaign\": \"YOUR_CAMPAIGN_ID\",\n  \"email\": \"{{ $('Loop Over Items').item.json.email }}\",\n  \"full_name\": \"{{ $('Loop Over Items').item.json.full_name }}\",\n  \"company_name\": \"{{ $('Loop Over Items').item.json.company_name }}\",\n  \"custom_variables\": {\n    \"custom_body\": \"{{ $('Generate Outreach Message').item.json.text }}\"\n  }\n\n }",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer YOUR_TOKEN_HERE"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "357f24f2-50ce-4100-9f09-ed8e1dcaf29a",
        "name": "Add Company Info to Google Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "onError": "continueRegularOutput",
        "position": [
          928,
          -208
        ],
        "parameters": {
          "columns": {
            "value": {
              "status": "complete",
              "company_name": "={{ $('Limit(Test)').item.json.company_name }}",
              "Key Offerings": "={{ $('Company Research').item.json.output.keyOfferings }}",
              "Company Summary": "={{ $('Company Research').item.json.output.comprehensiveSummary }}",
              "Outreach Message": "={{ $json.text }}",
              "Company Background": "={{ $('Company Research').item.json.output.companyOverview }}",
              "Recent Company News": "={{ $('Company Research').item.json.output.recentWebsiteNews }}"
            },
            "schema": [
              {
                "id": "date",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "company_name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "company_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "department",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "department",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "job_title",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "job_title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "full_name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "full_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "postal_code",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "postal_code",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "address",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "mobile_phone_number",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "mobile_phone_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "phone_number",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "phone_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "fax_number",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "fax_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "website_url",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "website_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Company Background",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Company Background",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Recent Company News",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Recent Company News",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Key Offerings",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Key Offerings",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Company Summary",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Company Summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Outreach Message",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Outreach Message",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "company_name"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rYf2kqfmMRUtpFAb5YdhOcsvGg8Gr1CTbO-lvrd48m4/edit#gid=0",
            "cachedResultName": "BusinessCardList"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1rYf2kqfmMRUtpFAb5YdhOcsvGg8Gr1CTbO-lvrd48m4",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rYf2kqfmMRUtpFAb5YdhOcsvGg8Gr1CTbO-lvrd48m4/edit?usp=drivesdk",
            "cachedResultName": "Demo"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "Ja0tGvoFNudNwqMM",
            "name": "md83 H2"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "c00b9130-4f3f-41c1-a670-77098f59c804",
        "name": "Structured Output Parser1",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          448,
          -32
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"companyOverview\": \"String: 1-2 sentence description from website. (Source: ...)\",\n  \"recentWebsiteNews\": \"String: Bullet points of recent website news/blog posts. (Source: ...)\",\n  \"keyOfferings\": \"String: Bullet points of key products/services. (Source: ...)\",\n\"comprehensiveSummary\": \"String: 1-2 sentence synthesis of companyOverview, recentWebsiteNews, keyOfferings, and thirdPartySentiment\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "2b52baa3-d06f-4427-8315-9b2fc62322eb",
        "name": "Generate Outreach Message",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "onError": "continueRegularOutput",
        "position": [
          608,
          -208
        ],
        "parameters": {
          "text": "=name:  {{ $('Loop Over Items').item.json.full_name }}\n\ncompany name: {{ $('Loop Over Items').item.json.company_name }}\n\ncompany background: {{ $json.output.comprehensiveSummary }}",
          "messages": {
            "messageValues": [
              {
                "message": "=You are an Expert B2B Cold Outreach Email Drafter.  \nYour objective is to compose a concise, professional, and highly personalized email body (target 100–150 words) to introduce **YOUR_COMPANY_NAME’s AI training and automation services** to a business prospect.\n\n---\n\n**Your Company:** YOUR_COMPANY_NAME  \n**Your Offering:** We provide AI talent development and automation training programs. In particular, we conduct AI training that enables even non-engineers to learn workflow automation through no-code methods.\n\n---\n\n**Input Data Provided:**  \nYou will receive the following information about the prospect and their company:\n* `name`: The prospect's name  \n* `company name`: The name of the prospect's company  \n* `company background`: A summary of the company's background  \n\n---\n\n**Drafting Instructions:**\n\n1. **Identify the Strongest Hook:**  \n   * Analyze the `company background` input carefully.  \n   * Look for the *single most relevant and compelling detail* to use as a personalized opening.  \n   * Prioritize items such as:  \n     - Recent company news or announcements (e.g., funding, launch, partnership)  \n     - A key offering or business focus that aligns with potential AI applications  \n     - A technical or operational aspect that could benefit from automation or AI training  \n   * Choose the hook that allows a natural transition to the value of AI training for *this specific prospect* in *their specific company*.\n\n2. **Structure & Content:**  \n   * **Opening (Personalized Hook):** Start by acknowledging the company or referencing the specific hook you identified (1 sentence).  \n   * **Introduction:** Briefly introduce YOUR_COMPANY_NAME and mention that you offer AI training and automation programs (1 sentence).  \n   * **Value Proposition:** Explain *why* AI training might be relevant *specifically* to their company, based on the hook or company background (1–2 sentences). Focus on benefits like efficiency, productivity, innovation, or growth.  \n   * **Call to Action (Soft):** Suggest a light, non-intrusive next step (e.g., “Would exploring how AI could apply to your operations be valuable?” or “Would you be open to a short conversation next week?”).\n\n3. **Tone:**  \n   * Professional, concise, respectful, and confident.  \n   * Avoid jargon or unnecessary complexity.  \n   * Maintain a helpful and value-oriented tone.\n\n4. **Constraints:**  \n   * Word count: strictly aim for 100–150 words.  \n   * Output language: **English only.**  \n   * Use only the information provided in the input fields — do not invent details.  \n   * If the company background lacks strong details, focus on general AI training benefits relevant to typical business operations.  \n   * Return **only** the drafted email body as plain text — no subject line, greeting (“Hi [Name],”), or signature (“Best,”).  \n\n---\n\n**Output Format:**  \nReturn ONLY the drafted email body as a single English text string.  \nDo not include a subject line, greeting, or closing signature.  \n\n---\n\n**Example Output:**  \n\nWe at YOUR_COMPANY_NAME provide AI talent development and automation training designed to help teams improve efficiency and adopt no-code workflow solutions. Based on your company’s focus on digital transformation and process innovation, we believe structured AI training could provide tangible value. By empowering even non-technical employees to automate routine workflows, your organization could streamline operations and reduce manual effort. This approach not only enhances productivity but also frees your team to focus on higher-impact initiatives. Would you be open to a brief discussion about how our AI training could support your company’s goals?\n"
              }
            ]
          },
          "promptType": "define"
        },
        "typeVersion": 1.6
      },
      {
        "id": "7f2b9a2f-8de7-42d6-b725-9d35e0a231ed",
        "name": "Company Research",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "onError": "continueRegularOutput",
        "position": [
          256,
          -208
        ],
        "parameters": {
          "text": "=company: {{ $json.company_name }}\n\ncompany website: {{ $json.website_url }}\n\n\n",
          "options": {
            "systemMessage": "=You are a Company Information Synthesizer.  \nYour primary goal is to extract key information about a target company by leveraging the `tavilysearch` tool, prioritizing content likely originating from the company's official website.  \nYour secondary goal is to check recent news or updates about the company from credible sources when available.\n\n---\n\n**CORE DIRECTIVES:**\n1. **TOOL USAGE:** You MUST ONLY use the `tavilysearch` tool for information gathering. No other tools or external data sources may be used.\n2. **PRIMARY SOURCE FOCUS (Website):** Prioritize finding and summarizing information directly presented on the company’s official website — especially pages like “About Us,” “News,” “Press Releases,” “Products,” or “Services.” Use Tavily to locate these pages or relevant summaries.\n3. **SECONDARY SOURCE (Recent Updates ONLY):** When possible, use Tavily to find recent updates or press coverage about the company (e.g., partnerships, launches, or expansion news). Avoid unverified or opinion-based sources.\n4. **RECENCY:** For company news and updates, focus on content from the last 12–18 months.\n5. **CONCISENESS:** Keep summaries factual, short, and objective.\n6. **ACCURACY:** Do not invent or assume information that is not explicitly found in your search results.\n\n---\n\n**RESEARCH FOCUS (Guide for using Tavily):**\nUse Tavily to gather concise factual information for each category:\n\n* **Core Business:** Search for `\"[Company Name] About Us\"`, `\"[Company Name] Mission\"`, or similar queries to identify what the company does and its core purpose.\n* **Recent Website News:** Search for `\"[Company Name] news\"`, `\"[Company Name] press release\"`, or `\"[Company Name] blog\"` to identify recent official announcements.\n* **Products/Services:** Search for `\"[Company Name] products\"` or `\"[Company Name] services\"` to list main offerings or product categories.\n\n---\n\n**OUTPUT FORMAT:**\nYour final response MUST be a **single valid JSON object** containing only the following four keys.  \nEach value should be concise, factual, and where possible, include a short citation (link or reference to the company website).\n\n```json\n{\n  \"companyOverview\": \"[1–2 sentences summarizing what the company does and its mission, primarily from its official website. Example: 'ABC Corp is a technology company specializing in cloud infrastructure solutions.' (Source: Company Website via Tavily)]\",\n  \"recentWebsiteNews\": \"[• A bullet point describing a recent announcement, update, or press release. Include a source link if possible. (Source: Company Website News/Blog)\\n- Additional bullet if applicable.]\",\n  \"keyOfferings\": \"[• A bullet point listing a core product or service. (Source: Company Website via Tavily)\\n- Additional bullet if applicable.]\",\n  \"comprehensiveSummary\": \"[1–2 sentences synthesizing the overall company profile, combining the overview, news, and offerings into a cohesive summary.]\"\n}\n```\n\n---\n\n**HANDLING NO RESULTS:**\nIf `tavilysearch` finds no relevant information for a specific field, output the following text for that key:  \n`\"No relevant [Category Name] found via Tavily search.\"`  \n(Example: `\"No relevant recent website news found via Tavily search.\"`)\n\nAll responses must remain in valid JSON format and must not include any commentary, markdown, or explanations outside of the JSON structure.\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "020b5c79-829d-4de0-b334-e8d1dc246bb4",
        "name": "Tavily",
        "type": "@tavily/n8n-nodes-tavily.tavilyTool",
        "position": [
          336,
          -32
        ],
        "parameters": {
          "query": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Query', ``, 'string') }}",
          "options": {
            "time_range": "year",
            "max_results": 3,
            "search_depth": "basic"
          }
        },
        "credentials": {
          "tavilyApi": {
            "id": "tb0nQRxUD3kv1KUd",
            "name": "Tavily account Click to start"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d19473e0-f4d5-410d-b3e8-15225ee8d6c9",
        "name": "OpenRouter Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          224,
          -32
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openRouterApi": {
            "id": "D1q69WNrqGh2Tmie",
            "name": "OpenRouter 使える"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "df1ad316-e343-4bbf-8299-f00a6c43b4f6",
        "name": "OpenRouter Chat Model3",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          608,
          -32
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openRouterApi": {
            "id": "D1q69WNrqGh2Tmie",
            "name": "OpenRouter 使える"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "36901dc7-1d07-48d7-9eff-de4ea41aec5c",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "onError": "continueRegularOutput",
        "position": [
          0,
          -128
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "18d2c0e4-c6ee-4ddb-b46c-1492b6fd25f2",
        "name": "When clicking ‘Execute workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -672,
          -128
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "b2be533c-4393-4dba-a988-47559d43dd0b",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          192,
          -352
        ],
        "parameters": {
          "color": 2,
          "width": 896,
          "height": 320,
          "content": "## ② Pick up company information and generate an outreach message\nThe **AI Agent** uses the **Tavily** tool to search for company information based on the person’s name and company name → then generates an email body using the retrieved company information"
        },
        "typeVersion": 1
      },
      {
        "id": "dc5299f5-7b23-415f-9e98-847e26c2bfc9",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -768,
          -272
        ],
        "parameters": {
          "width": 912,
          "height": 352,
          "content": "## ① Business card data extraction\n**Click** to start → Retrieve business card data from **Google Sheets**.\n(The Limit node should be deleted during normal use. It’s only used during testing to prevent extra business card data from flowing to the next step.)"
        },
        "typeVersion": 1
      },
      {
        "id": "467c675b-d753-4f09-90f6-d84adc348086",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1152,
          -272
        ],
        "parameters": {
          "color": 3,
          "width": 256,
          "height": 400,
          "content": "## ③ Register leads to instantlyAI\nRegister the email address, name, company name, and the generated email body to instantlyAI"
        },
        "typeVersion": 1
      },
      {
        "id": "ebd00e04-5502-414b-8ed7-e76c50800011",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1440,
          -432
        ],
        "parameters": {
          "color": 4,
          "width": 848,
          "height": 512,
          "content": "## Generate Personalized B2B Outreach Emails using AI Research(Google Sheets→ AI →instantlyAI)\n\n**Description**\nThis workflow automates the creation of personalized B2B outreach email messages by combining AI-powered company research and LLM-based writing.\nIt collects company information, analyzes recent news and offerings, and drafts a professional English email customized for each prospect — helping you scale tailored outreach effortlessly.\n\n**Key Features**:\n\n📄 Retrieves target companies from Google Sheets (status = “ready”)\n\n🔍 Uses Tavily Search (LangChain Agent) to gather company overviews, key offerings, and recent updates\n\n✍️ Generate Outreach Message (LLM Chain) creates a concise and fully personalized email body in English using the AI training context from YOUR_COMPANY_NAME\n This example uses AI training as the base context, but you can easily modify the prompt to match your own business or service\n\n📊 Automatically logs generated messages back into Google Sheets for review or dispatch\n\n🚀 Optional integration with Instantly.ai to send emails directly to your outreach campaigns"
        },
        "typeVersion": 1
      },
      {
        "id": "041d5602-fd2a-4e7c-be83-7a18abdfb226",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1440,
          64
        ],
        "parameters": {
          "color": 4,
          "width": 848,
          "height": 224,
          "content": "**Use Cases**\n\n**💼 Sales & Marketing Teams**: Automatically generate personalized outreach messages for each prospect based on AI-researched company data.  \n\n**🏢 Business Development**: Streamline lead generation by combining company analysis and automated email writing.  \n\n**📊 Growth & Operations**: Maintain a structured outreach record in Google Sheets for easy follow-up tracking.  \n\n**🤖 AI Automation Learners**: Explore how AI agents and LLMs can automate real-world sales workflows.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "60dcab6b-14c4-46f4-a2a0-5fc09bace828",
        "name": "Limit(Test)",
        "type": "n8n-nodes-base.limit",
        "position": [
          -224,
          -128
        ],
        "parameters": {
          "maxItems": 10
        },
        "typeVersion": 1
      },
      {
        "id": "9368676a-b904-4f30-8f53-196c794f7f9c",
        "name": "Get Business card data extraction",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -448,
          -128
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupValue": "ready",
                "lookupColumn": "status"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rYf2kqfmMRUtpFAb5YdhOcsvGg8Gr1CTbO-lvrd48m4/edit#gid=0",
            "cachedResultName": "BusinessCardList"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1rYf2kqfmMRUtpFAb5YdhOcsvGg8Gr1CTbO-lvrd48m4",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1rYf2kqfmMRUtpFAb5YdhOcsvGg8Gr1CTbO-lvrd48m4/edit?usp=drivesdk",
            "cachedResultName": "Demo"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "Ja0tGvoFNudNwqMM",
            "name": "md83 H2"
          }
        },
        "typeVersion": 4.7
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "70df54f5-644e-46c1-b25a-faf603362cac",
    "connections": {
      "Tavily": {
        "ai_tool": [
          [
            {
              "node": "Company Research",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Limit(Test)": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Company Research",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Company Research": {
        "main": [
          [
            {
              "node": "Generate Outreach Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Company Research",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Outreach Message",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Add Lead to Instantly AI": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Outreach Message": {
        "main": [
          [
            {
              "node": "Add Company Info to Google Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "Company Research",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Add Company Info to Google Sheet": {
        "main": [
          [
            {
              "node": "Add Lead to Instantly AI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Business card data extraction": {
        "main": [
          [
            {
              "node": "Limit(Test)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Execute workflow’": {
        "main": [
          [
            {
              "node": "Get Business card data extraction",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "rUKy8bpD27piXChW",
    "meta": {
      "instanceId": "84f919bdf71e0a8207578f3b6d18e75ace42ed26bca5f98c23187d7c0785bb5b"
    },
    "name": "Demo Email to Share",
    "tags": [],
    "nodes": [
      {
        "id": "f5543636-85b1-4fc0-a249-a24c89c28a7e",
        "name": "Telegram Trigger",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -384,
          624
        ],
        "webhookId": "e14bd24d-3207-413d-ada5-8898cfe97b84",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "w3Cax7qO9QavQmz5",
            "name": "Email Demo EN"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "11c0072b-8f85-42af-a5bb-7ea0e0534ea6",
        "name": "Edit Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          1520,
          288
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "f334ff6c-3501-4199-8763-a1646c6386e4",
                "name": "Name",
                "type": "string",
                "value": "={{ $('Code in JavaScript').item.json.name }}"
              },
              {
                "id": "d413b489-746e-43fd-ab2e-6e0a25fc05aa",
                "name": "Website",
                "type": "string",
                "value": "=https://{{ $('Code in JavaScript').item.json.website }}"
              },
              {
                "id": "25471945-5ebc-4a7e-ae7f-4befae7d88fd",
                "name": "Receive_Email",
                "type": "string",
                "value": "={{ $('Code in JavaScript').item.json.email }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "9bd90f31-1d1d-4042-8405-790a00e4a344",
        "name": "HTTP Request",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueErrorOutput",
        "position": [
          2176,
          528
        ],
        "parameters": {
          "url": "={{ $json.Website }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "d98093eb-aa44-40ed-8f8c-02a836b07082",
        "name": "Markdown",
        "type": "n8n-nodes-base.markdown",
        "position": [
          2400,
          432
        ],
        "parameters": {
          "html": "={{ $json.data }}",
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "43db5cdf-c940-42f3-aeb4-4707f871f4b8",
        "name": "getting link",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "onError": "continueRegularOutput",
        "position": [
          2720,
          400
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "you're a helpfull, intelligent web scraper asisstant."
              },
              {
                "content": "=Your task is to extract all URLs from the raw markdown data of a website.\n\nRules:\n\nAlways include both absolute URLs (e.g., https://example.com/page) and relative PHP links (e.g., index.php, about.php).\n\nIf the URL is relative, prepend the base domain {{ $('Edit Fields').item.json.Website }} to make it absolute.\n\nIgnore anchor-only links (e.g., #, ?lang=).\n\nOutput should be a simple list, one URL per line.\n\nOutput format example:\n\nhttps://www.Example.com/index\nhttps://www.Example.com/vision-mission.php\nhttps://www.Example.com/our-leadership.php\nhttps://www.Example.com/our-history"
              },
              {
                "content": "={{ $json.data }}"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "8814JRU0x3fI9btT",
            "name": "evenkik4"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "b4005b51-ce73-42a9-97f1-8e8a8614cdee",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "onError": "continueRegularOutput",
        "position": [
          3552,
          400
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "message.content.BestLinks"
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "1e723bb4-fe00-4d23-b94c-3393a5919b78",
        "name": "HTTP Request1",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueErrorOutput",
        "position": [
          3776,
          400
        ],
        "parameters": {
          "url": "={{ $json['message.content.BestLinks'] }}",
          "options": {}
        },
        "retryOnFail": false,
        "typeVersion": 4.2,
        "alwaysOutputData": false
      },
      {
        "id": "34ebbd2e-4225-42f2-b33a-6c0fa060ca39",
        "name": "Markdown1",
        "type": "n8n-nodes-base.markdown",
        "onError": "continueRegularOutput",
        "position": [
          4224,
          208
        ],
        "parameters": {
          "html": "={{ $json.data }}",
          "options": {}
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "69b856ea-87a4-4eb1-a3d2-3c980e03d1a0",
        "name": "Page Sumarize",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "onError": "continueRegularOutput",
        "position": [
          5120,
          304
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "role": "system",
                "content": "you 're a helpfull, intelligent web scrapper assistant."
              },
              {
                "content": "You are given a markdown scrape of a website page.\nYour task is to write a one-paragraph abstract summarizing what this page is about.\nPrioritize identifying the company’s featured products, their current market condition, and any implied beliefs or values.\nIf these details are missing, still provide the best possible abstract based on the available content.\n\nReturn in JSON format:\n\n{\"abstract\": \"your abstract goes here\"}\n\n\nRules:\n\n-The abstract should be comprehensive, similar in detail to an abstract of a published paper.\n-Prefer extracting specific, concrete products rather than broad categories. For example: use \"coconut shell\" or \"copra\" instead of just \"coconut\". another examples: Use \"ginger\" or \"cinnamon\" instead of a vague term like \"healthy spices\".\n-Use a straightforward, Spartan tone of voice.\n-If the page has no content, return \"no content\"."
              },
              {
                "content": "={{ $json.flattext && $json.flattext.length > 5000 ? $json.flattext.slice(0, 5000) : $json.flattext }}\n"
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "8814JRU0x3fI9btT",
            "name": "evenkik4"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "123f6919-ea53-4a16-a5dd-34951012e0b6",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "onError": "continueRegularOutput",
        "position": [
          5472,
          304
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "message.content.abstract"
              }
            ]
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "a572ae39-d493-4478-b12d-b45e51ef6516",
        "name": "Send email",
        "type": "n8n-nodes-base.emailSend",
        "onError": "continueRegularOutput",
        "position": [
          6272,
          304
        ],
        "webhookId": "53eb06c8-9518-4d90-aacb-7e17282df080",
        "parameters": {
          "html": "={{ $json.Body }}{{ $json.Signature }}",
          "options": {
            "appendAttribution": false
          },
          "subject": "={{ $json.subject_line }}",
          "toEmail": "={{ $json.receive_email }}",
          "fromEmail": "={{ 'Michael <' + $json.Send_Email + '>' }}"
        },
        "credentials": {
          "smtp": {
            "id": "Sfcl1WZddA4WKPtk",
            "name": "sparkpost new"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "86f377a6-b51e-4eaf-94c3-c2d783401319",
        "name": "Email Craft",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "onError": "continueRegularOutput",
        "position": [
          5696,
          304
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5-mini",
            "cachedResultName": "GPT-5-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "role": "system",
                "content": "you're a helpful, intelligent sales asisstant."
              },
              {
                "content": "We just scraped a series of web pages from a business.\nYour task is to take their summaries and turn them into catchy, personalized openers for a cold email campaign, designed to imply that the rest of the campaign is also personalized.\n\nYou'll return your icebreakers in the following text format:\n\n{\"Subject\"={created subject here\",\"Body\"= <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333;\">\n  <p>Dear <strong>{name}</strong>,</p>\n\n  <p>\n    I noticed that your team supports organizations in <strong>{scraped_solution_area}</strong> \n    through <strong>{scraped_solution_name_or_method}</strong>, \n    addressing <strong>{scraped_problem_they_solve}</strong>, which many companies in {your_target_industry} also face.\n  </p>\n\n  <p>\n    We have developed a new concept that we believe could be a good fit for collaboration.\n  </p>\n\n  <p>\n    Over the past few months, we have been working on a concept that seems to help companies like yours. \n    In short, it is an AI-based outreach (lead generation) system \n    that helps find clients both in Indonesia and abroad, \n    and then creates customized proposal emails for each client — \n    for example, connecting your <strong>{scraped_solution_area}</strong> solution \n    to companies currently facing <strong>{scraped_problem_they_solve}</strong>.\n  </p>\n\n  <p>\n    The cost is very low, and the conversion rate is very high. We believe this aligns with \n    <strong>{SomeImpliedBeliefTheyHave}</strong>.\n  </p>\n\n  <p>\n    Interested? If you agree, we can send you a link to schedule a meeting. \n    Does that sound good to you?\n  </p>\n</div>\n\n\nRules:\n\nWrite in a natural, friendly, but formal tone of voice.\n\nMake sure to use the above format when constructing your icebreakers — we wrote it this way on purpose.\n\nFor {scraped_solution_name_or_method}\nShorten the solution name.\nExample: Use Managed WordPress instead of Managed WordPress (DreamPress)\nUse Liftoff instead of Liftoff (AI website builder)\nUse XYZ instead of XYZ Company Inc.\n\nRules for {your_target_industry}\nMake it specific (general → sub-industry/product).\nConvert tools/services → user industry.\nNo company names (inc, pt, etc.).\nKeep it 2–4 words.\nExample: coconut to coconut cream industry, website to growing IT company, press machine to ceramic factory.\n\nFor {SomeImpliedBeliefTheyHave}\nRefer to goals or ambitions, not formal values.\nUse casual phrasing like focus on, aim to, trying to.\nKeep it short (7–10 words).\nAvoid corporate buzzwords or brand slogans.\nUse […this aligns with your focus on expanding into new markets.] instead of […this aligns with your commitment to quality and sustainability.]"
              },
              {
                "content": "=here is some imformation that you will need\nname:{{ $('Edit Fields').item.json.Name }}"
              },
              {
                "content": "={{ $json.abstract.join(\"/n\") }}"
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "8814JRU0x3fI9btT",
            "name": "evenkik4"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "dec239f6-fceb-4454-b8ab-67d97de955cd",
        "name": "Delete row(s)",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          64,
          0
        ],
        "parameters": {
          "filters": {
            "conditions": [
              {
                "condition": "isNotEmpty"
              }
            ]
          },
          "options": {
            "dryRun": false
          },
          "matchType": "allConditions",
          "operation": "deleteRows",
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "lUt0VsvPO063mnyQ",
            "cachedResultUrl": "/projects/ty2N3FKN04d75oM7/datatables/lUt0VsvPO063mnyQ",
            "cachedResultName": "demo log"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "10c33257-aa0d-48e3-a8e7-afdc5a7ae158",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -384,
          0
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "7dcf44c7-cc7f-433e-9d16-a2a9616bc391",
        "name": "Get row(s)1",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          -160,
          0
        ],
        "parameters": {
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "lUt0VsvPO063mnyQ",
            "cachedResultUrl": "/projects/ty2N3FKN04d75oM7/datatables/lUt0VsvPO063mnyQ",
            "cachedResultName": "demo log"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "65368d29-be1f-427c-8b12-dc90987e6bc5",
        "name": "If1",
        "type": "n8n-nodes-base.if",
        "position": [
          -160,
          624
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "or",
            "conditions": [
              {
                "id": "8fdf339e-0d75-4c54-b6a6-218048745485",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                },
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "!"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "8b62b092-b4dd-43bd-a21f-8d6e4e004fdb",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          32,
          992
        ],
        "parameters": {
          "model": "gpt-4.1-mini",
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8814JRU0x3fI9btT",
            "name": "evenkik4"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "dbd37933-28fd-4c13-aa8f-bc3abe7f5805",
        "name": "Postgres Chat Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
        "position": [
          160,
          992
        ],
        "parameters": {},
        "credentials": {
          "postgres": {
            "id": "jWzoXtdPKpDtut1V",
            "name": "Postgres account"
          }
        },
        "notesInFlow": false,
        "typeVersion": 1
      },
      {
        "id": "82f58e56-bfb7-4ca8-be65-e51ab4d3920b",
        "name": "RAG AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          272,
          768
        ],
        "parameters": {
          "text": "={{ $json.chatInput }}",
          "options": {
            "systemMessage": "You are Demo Assistant.  \n\nWhen a new user arrives:  \n1) Introduce yourself,  \n2) Give instruction to fill a form using the template\n3) Fetch and present the input form template using RAG,  \n4) Explain what the bot will do, and  \n5) Display any important notes.  \n\nForm generation rules:  \n- Always fetch the form template from RAG.  \n- Must start with !FORM.  \n- Exactly 3 lines: Name, Email (valid), Website (domain only, no http/https).  \n- No extra text, formatting, or explanations outside the form.  \n- If user input is wrong or incomplete: ask for missing info, then regenerate the correct form with their data.  \n\nIf the user is confused:  \n- Ask for their Name, Email, and Website.  \n- Fill in the form template with their answers, outputting only the ready-to-copy form.\n- After the form, tell the user: **“Please copy, paste, and send this form.”** \n- Keep replies short and easy to copy.  \n\nRAG usage rules:  \n- You are given tools to perform RAG in the 'documents' table.  \n- Use RAG first to fetch the introduction, form template, bot description, and notes.  \n- Only use SQL on the 'document_rows' table for tabular queries (sums, max, etc.) when RAG would be unreliable.  \n- If RAG doesn’t provide an answer, check available documents, analyze them, and tell the user if nothing is found.  \n- Never invent answers.  \n"
          },
          "promptType": "define"
        },
        "typeVersion": 1.6
      },
      {
        "id": "753a19d3-dfd4-472b-9a4d-bae89b0e55b8",
        "name": "List Documents",
        "type": "n8n-nodes-base.postgresTool",
        "position": [
          288,
          992
        ],
        "parameters": {
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "document_metadata",
            "cachedResultName": "document_metadata"
          },
          "schema": {
            "__rl": true,
            "mode": "list",
            "value": "public"
          },
          "options": {},
          "operation": "select",
          "returnAll": true,
          "descriptionType": "manual",
          "toolDescription": "Use this tool to fetch all available documents, including the table schema if the file is a CSV or Excel file."
        },
        "credentials": {
          "postgres": {
            "id": "jWzoXtdPKpDtut1V",
            "name": "Postgres account"
          }
        },
        "typeVersion": 2.5
      },
      {
        "id": "fa0a3c9d-63c5-45ec-bd6e-70c69cf33d1b",
        "name": "Get File Contents",
        "type": "n8n-nodes-base.postgresTool",
        "position": [
          416,
          992
        ],
        "parameters": {
          "query": "SELECT \n    string_agg(text, ' ') as document_text\nFROM documents_pg\n  WHERE metadata->>'file_id' = $1\nGROUP BY metadata->>'file_id';",
          "options": {
            "queryReplacement": "={{ $fromAI('file_id') }}"
          },
          "operation": "executeQuery",
          "descriptionType": "manual",
          "toolDescription": "Given a file ID, fetches the text from the document."
        },
        "credentials": {
          "postgres": {
            "id": "jWzoXtdPKpDtut1V",
            "name": "Postgres account"
          }
        },
        "typeVersion": 2.5
      },
      {
        "id": "b51ec26a-0a56-474a-9061-60e4a11fef1f",
        "name": "Query Document Rows",
        "type": "n8n-nodes-base.postgresTool",
        "position": [
          544,
          992
        ],
        "parameters": {
          "query": "{{ $fromAI('sql_query') }}",
          "options": {},
          "operation": "executeQuery",
          "descriptionType": "manual",
          "toolDescription": "Run a SQL query - use this to query from the document_rows table once you know the file ID you are querying. dataset_id is the file_id and you are always using the row_data for filtering, which is a jsonb field that has all the keys from the file schema given in the document_metadata table.\n\nExample query:\n\nSELECT AVG((row_data->>'revenue')::numeric)\nFROM document_rows\nWHERE dataset_id = '123';\n\nExample query 2:\n\nSELECT \n    row_data->>'category' as category,\n    SUM((row_data->>'sales')::numeric) as total_sales\nFROM dataset_rows\nWHERE dataset_id = '123'\nGROUP BY row_data->>'category';"
        },
        "credentials": {
          "postgres": {
            "id": "jWzoXtdPKpDtut1V",
            "name": "Postgres account"
          }
        },
        "typeVersion": 2.5
      },
      {
        "id": "11903393-1b81-4409-b4f0-c82f0e490d5e",
        "name": "Embeddings OpenAI2",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          752,
          1200
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8814JRU0x3fI9btT",
            "name": "evenkik4"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "f4fd9497-f01e-42ae-8bf8-faef16ae3a6d",
        "name": "Postgres PGVector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
        "position": [
          672,
          992
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "topK": 25,
          "options": {},
          "tableName": "documents_pg",
          "toolDescription": "Use RAG to look up information in the knowledgebase."
        },
        "credentials": {
          "postgres": {
            "id": "jWzoXtdPKpDtut1V",
            "name": "Postgres account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "3a8b8da3-6d18-45fd-a8d7-a300fb82adaa",
        "name": "Edit Fields5",
        "type": "n8n-nodes-base.set",
        "position": [
          112,
          768
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "9a9a245e-f1a1-4282-bb02-a81ffe629f0f",
                "name": "chatInput",
                "type": "string",
                "value": "={{ $json.message.text }}"
              },
              {
                "id": "b80831d8-c653-4203-8706-adedfdb98f77",
                "name": "sessionId",
                "type": "string",
                "value": "={{ $json.message.chat.id }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "d6eb2aa8-017c-4b7b-b5e6-e26cf8fd7283",
        "name": "If2",
        "type": "n8n-nodes-base.if",
        "position": [
          1072,
          384
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "3a65e649-786b-4d93-bb7f-121ed4a2233e",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.name }}",
                "rightValue": ""
              },
              {
                "id": "f7c82960-c9b2-4603-827b-680208ed8d25",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.email }}",
                "rightValue": ""
              },
              {
                "id": "ef098bcb-82a6-4a92-b5e3-be9f1660a1ee",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.website }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "5226d39f-b833-4097-87ce-2f301f0814da",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -16,
          672
        ],
        "parameters": {
          "width": 976,
          "height": 672,
          "content": "## Instructor+RAG Agent\n"
        },
        "typeVersion": 1
      },
      {
        "id": "a2302647-5703-427b-91ec-1d0ff2bfd5ab",
        "name": "XML",
        "type": "n8n-nodes-base.xml",
        "position": [
          2176,
          208
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "0135647f-e136-43a9-b0db-c802c022d63e",
        "name": "sitemap.xml request",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueErrorOutput",
        "position": [
          1728,
          400
        ],
        "parameters": {
          "url": "={{ $json.Website }}/sitemap.xml",
          "options": {}
        },
        "typeVersion": 4.2,
        "alwaysOutputData": false
      },
      {
        "id": "b6b14a81-5267-4a41-9c47-7abadfc1d8b3",
        "name": "sitemap_index.xml request",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueErrorOutput",
        "position": [
          1952,
          480
        ],
        "parameters": {
          "url": "={{ $json.Website }}/sitemap_index.xml",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "7c26fff0-e0fb-4752-9143-be5a42525e7d",
        "name": "crawl4ai",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          2624,
          624
        ],
        "parameters": {
          "url": "=http://00.00.00.000:11235/crawl",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"urls\": [\"{{ $('Edit Fields').item.json.Website }}\"],\n  \"priority\": 10\n}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "executeOnce": false,
        "retryOnFail": true,
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "id": "f3334eac-4ed8-4b51-a843-f7cbed070b79",
        "name": "Check how many email created by id",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          64,
          416
        ],
        "parameters": {
          "filters": {
            "conditions": [
              {
                "keyName": "Telegram_id",
                "keyValue": "={{ $json.message.from.id }}"
              }
            ]
          },
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "lUt0VsvPO063mnyQ",
            "cachedResultUrl": "/projects/ty2N3FKN04d75oM7/datatables/lUt0VsvPO063mnyQ",
            "cachedResultName": "demo log"
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "d8572789-5683-4b6d-a0d2-27708098afa7",
        "name": "answer query",
        "type": "n8n-nodes-base.telegram",
        "position": [
          576,
          768
        ],
        "webhookId": "517399ca-8ea0-4f4c-9d73-b5e2fbac6342",
        "parameters": {
          "text": "={{ $json.output }}",
          "chatId": "={{ $('Telegram Trigger').item.json.message.from.id }}",
          "forceReply": {},
          "replyMarkup": "=none",
          "additionalFields": {
            "appendAttribution": false
          },
          "replyKeyboardRemove": {},
          "replyKeyboardOptions": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "w3Cax7qO9QavQmz5",
            "name": "Email Demo EN"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4cdc7181-6f34-455b-81ba-fc94039faa2e",
        "name": "set maximum email per id",
        "type": "n8n-nodes-base.switch",
        "position": [
          432,
          416
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "368c343e-fc6e-46f0-9e82-c50a1c2f707f",
                      "operator": {
                        "type": "array",
                        "operation": "lengthGt",
                        "rightType": "number"
                      },
                      "leftValue": "={{ $json.Telegram_id }}",
                      "rightValue": 2
                    }
                  ]
                }
              },
              {
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "3b3b9bc8-298c-4da3-9341-82e20344a82d",
                      "operator": {
                        "type": "array",
                        "operation": "lengthLte",
                        "rightType": "number"
                      },
                      "leftValue": "={{ $json.Telegram_id }}",
                      "rightValue": 2
                    }
                  ]
                }
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.3,
        "alwaysOutputData": false
      },
      {
        "id": "cb9bc574-6dba-4654-b24f-bb5dc655610f",
        "name": "apologize message",
        "type": "n8n-nodes-base.telegram",
        "position": [
          656,
          320
        ],
        "webhookId": "517399ca-8ea0-4f4c-9d73-b5e2fbac6342",
        "parameters": {
          "text": "Thank you, but the demo can only be used up to 3 times. 😔\n",
          "chatId": "={{ $('Telegram Trigger').item.json.message.from.id }}",
          "forceReply": {},
          "replyMarkup": "=none",
          "additionalFields": {
            "appendAttribution": false
          },
          "replyKeyboardRemove": {},
          "replyKeyboardOptions": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "w3Cax7qO9QavQmz5",
            "name": "Email Demo EN"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c9f859c0-2cab-4d92-8267-d5302a27019c",
        "name": "Code in JavaScript",
        "type": "n8n-nodes-base.code",
        "position": [
          880,
          384
        ],
        "parameters": {
          "jsCode": "// --- n8n entry point ---\nconst raw = $('Telegram Trigger').first().json.message.text || '';\n\n// Split lines, trim, remove empty lines, !FORM header, and instruction line\nconst lines = raw\n  .split('\\n')\n  .map(l => l.trim())\n\n// Map to JSON keys\nconst json = {\n  name: lines[1] || '',\n  email: lines[2] || '',\n  website: lines[3] || ''\n};\n\n// Return in n8n format\nreturn [\n  {\n    json\n  }\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "cb5dcd48-e2cd-48ed-a348-f368a4636cc0",
        "name": "notif email creating",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1296,
          288
        ],
        "webhookId": "e9efec89-f4e7-4e7f-b43e-9262e89964d3",
        "parameters": {
          "text": "Creating email...",
          "chatId": "={{ $('Telegram Trigger').item.json.message.from.id }}",
          "additionalFields": {
            "appendAttribution": false,
            "disable_notification": true
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "w3Cax7qO9QavQmz5",
            "name": "Email Demo EN"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4106b03d-4cfb-499a-afff-43edf7246610",
        "name": "missing input notif",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1296,
          480
        ],
        "webhookId": "e9efec89-f4e7-4e7f-b43e-9262e89964d3",
        "parameters": {
          "text": "=Missing Input please use this template...\n!FORM\nname\nemail (valid format)\nwebsite (domain only, no http/https)",
          "chatId": "={{ $('Telegram Trigger').item.json.message.from.id }}",
          "additionalFields": {
            "appendAttribution": false,
            "disable_notification": true
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "w3Cax7qO9QavQmz5",
            "name": "Email Demo EN"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "9c492a4a-75da-4ee3-8849-34e83a8e9346",
        "name": "make link array to string",
        "type": "n8n-nodes-base.code",
        "position": [
          2400,
          208
        ],
        "parameters": {
          "jsCode": "// Get the input array safely\nconst urlArray = $input.first().json.urlset?.url || [];\n\n// Extract all loc values\nconst locLinks = urlArray.map(item => item.loc).filter(Boolean);\n\n// Join into a single string using '|'\nconst locString = locLinks.join('\\n');\n\n// Return as a single n8n item\nreturn [\n  {\n    json: {\n      loc_links: locString\n    }\n  }\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "0a40ad84-137d-4429-8edc-80df679eecee",
        "name": "extract link",
        "type": "n8n-nodes-base.code",
        "position": [
          2912,
          624
        ],
        "parameters": {
          "jsCode": "function extractLinks(raw) {\n  const urlRegex = /\\bhttps?:\\/\\/\\S+/gi;\n  const links = raw.match(urlRegex) || [];\n  const uniqueLinks = [...new Set(links.map(link => link.trim()))];\n  return uniqueLinks.join('\\n'); // single string with \\n separator\n}\n\n// --- n8n entry point ---\nconst rawMarkdown = $input.first().json.results[0].markdown.raw_markdown || '';\nconst linksString = extractLinks(rawMarkdown);\n\n// ✅ Return valid n8n output\nreturn [\n  {\n    json: {\n      links: linksString\n    }\n  }\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "a6603e84-7029-4c61-b7a6-c2bdfdee5dc3",
        "name": "Links ranking",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          3200,
          400
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5-nano",
            "cachedResultName": "GPT-5-NANO"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "role": "system",
                "content": "You are a link checker.\nYour task is to analyze a list of links given and select no more than 5 links that are most useful for creating a personalized email.\n\nExamples of useful links:\nsolutions\nservices\nwhat-we-do\nsolutions\ncapabilities\nexpertise\napproach\nmethodology\nour-framework\nhow-we-work\nprocess\ncase-studies\nclients\nindustries\ninsights\nblog\nsuccess-stories\nAbout Us\nCompany Profile\nNews\nVision and Mission\n\nRules:\n\nOnly return absolute URLs (e.g., https://example.com/about-us).\n\nIgnore relative URLs (e.g., /about-us).\n\nDo not return more than 5 links.\n\nOutput format (JSON):\n\n{\n  \"BestLinks\": [\n    \"https://example.com/about-us\",\n    \"https://example.com/services\",\n    \"https://example.com/news\",\n    \"https://example.com/vision-mission\"\n  ]\n}"
              },
              {
                "content": "={{ $json.loc_links }}{{ $json.message.content }}{{ $json.links }}"
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "8814JRU0x3fI9btT",
            "name": "evenkik4"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "d0d9c975-15cc-4999-8c7a-48d9bb1c7e49",
        "name": "crawl4ai1",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueErrorOutput",
        "position": [
          4000,
          496
        ],
        "parameters": {
          "url": "=http://00.00.00.000:11235/crawl",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"urls\": [\"{{ $json['message.content.BestLinks'] }}\"],\n  \"priority\": 10\n}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "executeOnce": false,
        "retryOnFail": true,
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "id": "4c4522be-5cd0-4ecd-aa91-14be3d3a3823",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          4448,
          304
        ],
        "parameters": {},
        "typeVersion": 3.2
      },
      {
        "id": "264be0b6-5340-44f6-b9fa-26ee354459fe",
        "name": "Edit Fields3",
        "type": "n8n-nodes-base.set",
        "position": [
          4224,
          400
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "2b5bb36f-a7f8-41c7-8de0-1cd1ad2ea06a",
                "name": "data",
                "type": "string",
                "value": "={{ $json.results[0].markdown.raw_markdown }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "26c8001f-2ac1-4f9f-b288-19ab5e502d1c",
        "name": "broken links notif",
        "type": "n8n-nodes-base.telegram",
        "position": [
          4224,
          592
        ],
        "webhookId": "517399ca-8ea0-4f4c-9d73-b5e2fbac6342",
        "parameters": {
          "text": "Some links may be broken. If no update is received within the next few minutes, the process will be considered failed.\n",
          "chatId": "={{ $('Telegram Trigger').item.json.message.from.id }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "w3Cax7qO9QavQmz5",
            "name": "Email Demo EN"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a3e83a25-7cd9-44af-9556-bedb2c459992",
        "name": "flattext",
        "type": "n8n-nodes-base.set",
        "position": [
          4896,
          304
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "87306b67-4fa7-4e0c-a6f4-c95d30bd3172",
                "name": "flattext",
                "type": "string",
                "value": "={{ $json.flatText }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "69d2748f-b15d-42ad-a74e-10af8a390641",
        "name": "trim markdown to less token",
        "type": "n8n-nodes-base.code",
        "position": [
          4672,
          304
        ],
        "parameters": {
          "jsCode": "// --- n8n entry point ---\nconst items = $input.all();\nfunction normalizeMarkdown(raw) {\n  let text = raw\n    .replace(/[*#>`~_]+/g, ' ')\n    .replace(/\\[([^\\]]+)\\]\\([^)]+\\)/g, '$1')\n    .replace(/\\bhttps?:\\/\\/\\S+/gi, '')\n    .replace(/\\|/g, ', ')\n    .replace(/^- /gm, '• ')\n    .replace(/\\s{2,}/g, ' ')\n    .replace(/\\n{2,}/g, '\\n')\n    .trim();\n\n  const lines = text.split('\\n');\n  const sections = [];\n  let current = { title: 'General', content: [] };\n\n  for (const line of lines) {\n    const heading = line.match(/^(?:#+|SECTION:)\\s*(.*)/i);\n    if (heading) {\n      if (current.content.length) sections.push(current);\n      current = { title: heading[1].trim(), content: [] };\n    } else {\n      current.content.push(line.trim());\n    }\n  }\n  if (current.content.length) sections.push(current);\n\n  const structured = sections.map(s => ({\n    section: s.title,\n    text: s.content\n      .join(' ')\n      .replace(/\\s+/g, ' ')\n      .replace(/\\b(the|a|an|this|that|these|those)\\b/gi, '')\n      .trim()\n  }));\n\n  const flatText = structured.map(s => `${s.section}: ${s.text}`).join('\\n\\n');\n\n  return { structured, flatText };\n}\n// Process all items\nconst output = items.map(item => {\n  const rawMarkdown = item?.json?.data || '';\n  const result = normalizeMarkdown(rawMarkdown);\n  return {\n    json: {\n      structured: result.structured,\n      flatText: result.flatText,\n      sectionCount: result.structured.length\n    }\n  };\n});\n\nreturn output;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "c111426c-6435-4be5-9fc3-909dd6327635",
        "name": "sender + signature",
        "type": "n8n-nodes-base.set",
        "onError": "continueRegularOutput",
        "position": [
          6048,
          304
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b44d2183-02ee-4413-874e-244aab9ed453",
                "name": "Send_Email",
                "type": "string",
                "value": "=email@gmail.com"
              },
              {
                "id": "ea41bba5-ee38-4acb-bd37-414183747aca",
                "name": "receive_email",
                "type": "string",
                "value": "={{ $('Edit Fields').item.json.Receive_Email }}"
              },
              {
                "id": "af35045d-9756-47bf-8030-94e80f8f27b5",
                "name": "subject_line",
                "type": "string",
                "value": "={{ $json.message.content.Subject }}"
              },
              {
                "id": "bf4310e5-9f18-47ac-82b0-5b3cc2e65951",
                "name": "Body",
                "type": "string",
                "value": "={{ $json.message.content.Body }}"
              },
              {
                "id": "b41c6372-446a-4a9e-bd2d-dc12cd51b84e",
                "name": "Signature",
                "type": "string",
                "value": "<your email signature>"
              }
            ]
          }
        },
        "executeOnce": false,
        "retryOnFail": false,
        "typeVersion": 3.4
      },
      {
        "id": "a13c1a7a-a810-40eb-b17b-1758c5092ca5",
        "name": "calculate how many session",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          240,
          416
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "Telegram_id"
              }
            ]
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "d5568cdf-5905-4c0e-a078-88693ba27e75",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          16,
          256
        ],
        "parameters": {
          "color": 3,
          "width": 816,
          "height": 368,
          "content": "## Limit how many demo emails can be sent per ID"
        },
        "typeVersion": 1
      },
      {
        "id": "901a436e-509a-4195-b343-7d25578ad515",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          864,
          256
        ],
        "parameters": {
          "color": 5,
          "width": 768,
          "height": 368,
          "content": "## Input Formatting"
        },
        "typeVersion": 1
      },
      {
        "id": "1c8832d8-b1bc-436f-9f3f-47ce4feb8bed",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1680,
          192
        ],
        "parameters": {
          "color": 2,
          "width": 2000,
          "height": 576,
          "content": "## Extract sublinks from a website"
        },
        "typeVersion": 1
      },
      {
        "id": "d157a162-804b-46c5-a5c5-9dc57429a420",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3728,
          192
        ],
        "parameters": {
          "color": 6,
          "width": 1920,
          "height": 560,
          "content": "## Extract content from sublinks\n"
        },
        "typeVersion": 1
      },
      {
        "id": "1e7a804d-21cc-4a0d-aa13-587a5772b1a8",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          5680,
          208
        ],
        "parameters": {
          "width": 976,
          "height": 288,
          "content": "## Crafting and sending email\n"
        },
        "typeVersion": 1
      },
      {
        "id": "a7b0258e-2f1c-4dca-9a0c-f614cc6251a9",
        "name": "Finish notif",
        "type": "n8n-nodes-base.telegram",
        "position": [
          6496,
          304
        ],
        "webhookId": "517399ca-8ea0-4f4c-9d73-b5e2fbac6342",
        "parameters": {
          "text": "Done. Please check your email inbox.",
          "chatId": "={{ $('Telegram Trigger').item.json.message.from.id }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "w3Cax7qO9QavQmz5",
            "name": "Email Demo EN"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "bcbb5b6d-5344-40ac-ad35-f9df2b83e8f8",
        "name": "insert log",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          6720,
          304
        ],
        "parameters": {
          "columns": {
            "value": {
              "nama": "={{ $('Telegram Trigger').item.json.message.from.first_name }}",
              "Telegram_id": "={{ $('Telegram Trigger').item.json.message.from.id }}"
            },
            "schema": [
              {
                "id": "nama",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "nama",
                "defaultMatch": false
              },
              {
                "id": "Telegram_id",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Telegram_id",
                "defaultMatch": false
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "lUt0VsvPO063mnyQ",
            "cachedResultUrl": "/projects/ty2N3FKN04d75oM7/datatables/lUt0VsvPO063mnyQ",
            "cachedResultName": "demo log"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "cf96a14b-bdc0-4deb-a464-41f334e5ed89",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -416,
          -80
        ],
        "parameters": {
          "width": 688,
          "height": 224,
          "content": "## Cleaning log data"
        },
        "typeVersion": 1
      },
      {
        "id": "cab89871-f0e6-46e6-9382-4f23090a03e3",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1264,
          -80
        ],
        "parameters": {
          "color": 7,
          "width": 736,
          "height": 2384,
          "content": "# Demo Personalized Email\n\nThis n8n workflow is built for AI and automation agencies to **promote their workflows through an interactive demo** that prospects can try themselves.  \nThe featured system is a **deep personalized email demo**.\n\n---\n\n## 🔄 How It Works\n\n1. **Prospect Interaction**\n   - A prospect starts the demo via Telegram.  \n   - The Telegram bot (created with BotFather) connects directly to your n8n instance.\n\n2. **Demo Guidance**\n   - The **RAG agent** and **instructor** guide the user step-by-step through the demo.  \n   - Instructions and responses are dynamically generated based on user input.\n\n3. **Workflow Execution**\n   - When the user triggers an action (e.g., testing the email demo), n8n runs the workflow.  \n   - The workflow collects website data using **Crawl4AI** or standard HTTP requests.\n\n4. **Email Demo**\n   - The system personalizes and sends a demo email through **SparkPost**, showing the automation’s capability.  \n\n5. **Logging and Control**\n   - Each user interaction is logged in your database using their `name` and `id`.  \n   - The workflow checks limits to prevent misuse or spam.  \n\n6. **Error Handling**\n   - If a low-CPU scraping method fails, the workflow automatically escalates to a higher-CPU method.  \n\n## ⚙️ Requirements\n\nBefore setting up, make sure you have the following:\n\n- [**n8n**](https://n8n.io/) — Automation platform to run the workflow  \n- [**Docker**](https://www.docker.com/) — Required to run Crawl4AI  \n- [**Crawl4AI**](https://github.com/unclecode/crawl4ai) — For intelligent website crawling  \n- [**Telegram Account**](https://t.me/BotFather) — To create your Telegram bot via BotFather  \n- [**SparkPost Account**](https://www.sparkpost.com/) — To send personalized demo emails  \n- A database (e.g., PostgreSQL, MySQL, or SQLite) — To store log data such as user name and ID  \n\n\n## 🚀 Features\n\n- **Telegram interface** using the BotFather API  \n- **Instructor and RAG agent** to guide prospects through the demo  \n- **Flow generation limits per user ID** to prevent abuse  \n- **Low-cost yet powerful web scraping**, escalating from low- to high-CPU flows if earlier ones fail  \n\n---\n\n## 💡 Development Ideas\n\n- Replace the RAG logic with your own query-answering and guidance method  \n- Remove the flow limit if you’re confident the demo can’t be misused  \n- Swap the personalized email demo with any other workflow you want to showcase  \n\n---\n\n## 🧠 Technical Notes\n\n- **Telegram bot** created with BotFather  \n- **Website crawl process:**\n  - Extract sub-links via `/sitemap.xml`, `sitemap_index.xml`, or standard HTTP requests  \n  - Fall back to **Crawl4AI** if normal requests fail  \n  - Fetch sub-link content via HTTPS or Crawl4AI as backup  \n- **SparkPost** used for sending demo emails  \n\n---\n\n## ⚙️ Setup Instructions\n\n### 1. Create a Telegram Bot\n- Use **BotFather** on Telegram to create your bot and get the **API token**.  \n- This token will be used to connect your n8n workflow to Telegram.  \n\n### 2. Create a Log Data Table\n- In your database, create a table to store user logs.  \n- The table must include at least the following columns:\n  - `name` — to store the user’s name or Telegram username.  \n  - `id` — to store the user’s unique identifier.  \n\n### 3. Install Crawl4AI with Docker\n- Follow the installation guide from the official repository:  \n  👉 [https://github.com/unclecode/crawl4ai](https://github.com/unclecode/crawl4ai)  \n- **Crawl4AI** will handle website crawling and content extraction in your workflow.  \n\n---\n## 📦 Notes\n\nThis setup is optimized for **low cost**, **easy scalability**, and **real-time interaction** with prospects.  \nYou can customize each component — **Telegram bot behavior**, **RAG logic**, **scraping strategy**, and **email workflow** — to fit your agency’s demo needs.\n\n\n👉 You can try the live demo here: [**@email_demo_bot**](https://t.me/email_demo_bot)\n\n---\n\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "04e561c3-2990-43d0-acd6-284618766ac4",
    "connections": {
      "If1": {
        "main": [
          [
            {
              "node": "Check how many email created by id",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "notif email creating",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "missing input notif",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "XML": {
        "main": [
          [
            {
              "node": "make link array to string",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "trim markdown to less token",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Markdown": {
        "main": [
          [
            {
              "node": "getting link",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "crawl4ai": {
        "main": [
          [
            {
              "node": "extract link",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "flattext": {
        "main": [
          [
            {
              "node": "Page Sumarize",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Email Craft",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Markdown1": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "HTTP Request1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "crawl4ai1": {
        "main": [
          [
            {
              "node": "Edit Fields3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "broken links notif",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send email": {
        "main": [
          [
            {
              "node": "Finish notif",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "sitemap.xml request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Email Craft": {
        "main": [
          [
            {
              "node": "sender + signature",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s)1": {
        "main": [
          [
            {
              "node": "Delete row(s)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields3": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Edit Fields5": {
        "main": [
          [
            {
              "node": "RAG AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Finish notif": {
        "main": [
          [
            {
              "node": "insert log",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Markdown",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "crawl4ai",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RAG AI Agent": {
        "main": [
          [
            {
              "node": "answer query",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "extract link": {
        "main": [
          [
            {
              "node": "Links ranking",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "getting link": {
        "main": [
          [
            {
              "node": "Links ranking",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request1": {
        "main": [
          [
            {
              "node": "Markdown1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "crawl4ai1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Links ranking": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Page Sumarize": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Documents": {
        "ai_tool": [
          [
            {
              "node": "RAG AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Get row(s)1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get File Contents": {
        "ai_tool": [
          [
            {
              "node": "RAG AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "RAG AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI2": {
        "ai_embedding": [
          [
            {
              "node": "Postgres PGVector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "sender + signature": {
        "main": [
          [
            {
              "node": "Send email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Query Document Rows": {
        "ai_tool": [
          [
            {
              "node": "RAG AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "sitemap.xml request": {
        "main": [
          [
            {
              "node": "XML",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "sitemap_index.xml request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres Chat Memory": {
        "ai_memory": [
          [
            {
              "node": "RAG AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "notif email creating": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Postgres PGVector Store": {
        "ai_tool": [
          [
            {
              "node": "RAG AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "set maximum email per id": {
        "main": [
          [
            {
              "node": "apologize message",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "make link array to string": {
        "main": [
          [
            {
              "node": "Links ranking",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "sitemap_index.xml request": {
        "main": [
          [
            {
              "node": "XML",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "calculate how many session": {
        "main": [
          [
            {
              "node": "set maximum email per id",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "trim markdown to less token": {
        "main": [
          [
            {
              "node": "flattext",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check how many email created by id": {
        "main": [
          [
            {
              "node": "calculate how many session",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "GWiHdxtRvqh14vln",
    "meta": {
      "instanceId": "a2b23892dd6989fda7c1209b381f5850373a7d2b85609624d7c2b7a092671d44",
      "templateCredsSetupCompleted": true
    },
    "name": "💥 Create viral Ads with NanoBanana & Seedance, publish on socials via upload-post - version II - vide",
    "tags": [],
    "nodes": [
      {
        "id": "3b6bcff1-cc32-4e4e-aa79-f7e06b2bdf15",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          528,
          -32
        ],
        "parameters": {
          "width": 1020,
          "height": 288,
          "content": "# 🟢 Step 1 — Input"
        },
        "typeVersion": 1
      },
      {
        "id": "b39b95c5-468e-434c-a455-8f91f7795d41",
        "name": "Telegram: Get Image File",
        "type": "n8n-nodes-base.telegram",
        "position": [
          816,
          64
        ],
        "webhookId": "8ef62f4a-8403-473b-be45-c727d9f04591",
        "parameters": {
          "fileId": "={{ $json.message.photo[2].file_id }}",
          "resource": "file",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "7SZVrD8xnvRzdabg",
            "name": "Telegram - viral Ads"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "8f91f9aa-e882-493d-a5a6-8ca4d57f4154",
        "name": "Trigger: Receive Idea via Telegram",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          592,
          64
        ],
        "webhookId": "0e83fedb-5e23-4711-a8f4-dff788a8669a",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "7SZVrD8xnvRzdabg",
            "name": "Telegram - viral Ads"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "81a38bbf-47b7-45fa-8113-26ab9b7abc0f",
        "name": "Google Drive: Upload Image",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1040,
          64
        ],
        "parameters": {
          "name": "={{ $('Trigger: Receive Idea via Telegram').item.json.message.photo[2].file_unique_id }}",
          "driveId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "gzeHMd64HAz6HBIe",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "fa33c037-fc4e-49d2-ba4e-70ced6457085",
        "name": "Parse Idea Into Prompts",
        "type": "n8n-nodes-base.code",
        "position": [
          1312,
          64
        ],
        "parameters": {
          "jsCode": "const text = $('Trigger: Receive Idea via Telegram').first().json.message.caption;\nconst parts = text.split(';').map(part => part.trim());\nreturn {\nimagePrompt: parts[0],\ntextOverlay: parts[1],\nvideoPrompt: parts[2],\nmusicPrompt: parts[3]\n};\n"
        },
        "typeVersion": 2
      },
      {
        "id": "82460b49-c263-48b9-b63b-5e0acba1543f",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1584,
          -32
        ],
        "parameters": {
          "width": 908,
          "height": 576,
          "content": "# 🟢 Step 2 — Generate Product Image"
        },
        "typeVersion": 1
      },
      {
        "id": "d3e988f1-df01-4c16-a77b-bd21ddee732e",
        "name": "Generate Image Prompt",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1664,
          64
        ],
        "parameters": {
          "text": "=Your task is to create an image prompt following the system guidelines.  \nEnsure that the reference image is represented as **accurately as possible**, including all text elements.  \n\nUse the following inputs:  \n\n- **User’s description:**  \n{{ $json.imagePrompt }}\n",
          "options": {
            "systemMessage": "=You are a helpful assistantROLE: UGC Image Prompt Builder  \n\nGOAL:  \nGenerate one concise, natural, and realistic image prompt (≤120 words) from a given product or reference image. The prompt must simulate authentic UGC (user-generated content) photography.  \n\nRULES:  \nYou must always create a professional background for the product image. You must never return the image with a plain white or empty background. The background must always enhance and highlight the product in the photo.\n\n- Always output **one JSON object only** with the key:  \n  - `image_prompt`: (string with full description)  \n- Do **not** add commentary, metadata, or extra keys. JSON only.  \n- User node think to be creative\n\nSTYLE GUIDELINES:  \n- Tone: casual, unstaged, lifelike, handheld snapshot.  \n- Camera cues: include at least 2–3 (e.g., phone snapshot, handheld framing, off-center composition, natural indoor light, soft shadows, slight motion blur, auto exposure, unpolished look, mild grain).  \n- Realism: embrace imperfections (wrinkles, stray hairs, skin texture, clutter, smudges).  \n- Packaging/Text: preserve exactly as visible. Never invent claims, numbers, or badges.  \n- Diversity: if people appear but are unspecified, vary gender/ethnicity naturally; default age range = 21–38.  \n- Setting: default to real-world everyday spaces (home, street, store, gym, office).  \n- User node think to be creative\nYou must always create a professional background for the product image. You must never return the image with a plain white or empty background. The background must always enhance and highlight the product in the photo.\n\nSAFETY:  \n- No copyrighted character names.  \n- No dialogue or scripts. Only describe scenes.  \n\nOUTPUT CONTRACT:  \n- JSON only, no prose outside.  \n- Max 120 words in `image_prompt`.  \n- Must cover: subject, action, mood, setting, background, style/camera, colors, and text accuracy.  \n\nCHECKLIST BEFORE OUTPUT:  \n- Natural handheld tone?  \n- At least 2 camera cues included?  \n- Product text preserved exactly?  \n- Only JSON returned?  \n\n---  \n\n### Example  \n\nGood Example :  \n```json\n{ \"image_prompt\": \"a young adult casually holding a skincare tube near a bathroom mirror; action: dabs small amount on the back of the hand; mood: easy morning; setting: small apartment bathroom with towel on rack and toothbrush cup; background: professional-looking bathroom scene that enhances the product, never plain white or empty, always styled to highlight the tube naturally; style/camera: phone snapshot, handheld framing, off-center composition, natural window light, slight motion blur, mild grain; colors: soft whites and mint label; text accuracy: keep every word on the tube exactly as visible, no added claims\" }\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "20f5e316-f06e-4634-96c5-554c81533bcb",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1936,
          384
        ],
        "parameters": {
          "jsonSchemaExample": "{\n\t\"image_prompt\": \"string\"\n}"
        },
        "typeVersion": 1.3
      },
      {
        "id": "c30cbe40-9aad-4963-9196-d6c976251045",
        "name": "Think",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          1776,
          400
        ],
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "abab5953-ed16-4d8b-aeb5-ab95c5ed99b7",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1632,
          384
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5-mini",
            "cachedResultName": "gpt-5-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "8b232102-7143-4846-b4ec-4588db2f0e41",
        "name": "NanoBanana: Create Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2048,
          64
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/nano-banana/edit",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n\t\"prompt\": \"{{ $json.output.image_prompt.replace(/\\\"/g, '\\\\\\\"').replace(/\\n/g, '\\\\n') }}\",\n\"image_urls\": [\"{{ $('Google Drive: Upload Image').item.json.webContentLink }}\"]\n\n} ",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "kNULkYDcOZG3X0be",
            "name": "Fal.ai"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "4e10ac9b-8757-486f-97ff-f26af4d1b14a",
        "name": "Wait for Image Edit",
        "type": "n8n-nodes-base.wait",
        "position": [
          2256,
          64
        ],
        "webhookId": "32a1b1fc-9fe6-418a-b1ee-e703de063e28",
        "parameters": {
          "unit": "minutes",
          "amount": 2
        },
        "typeVersion": 1.1
      },
      {
        "id": "24d0d943-787f-4c09-9bf5-424b9d1970e0",
        "name": "Download Edited Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2240,
          352
        ],
        "parameters": {
          "url": "={{ $json.response_url }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "kNULkYDcOZG3X0be",
            "name": "Fal.ai"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "03c16d70-e7e8-43b8-b566-3f620bd80b1a",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          528,
          272
        ],
        "parameters": {
          "color": 5,
          "width": 1020,
          "height": 272,
          "content": "# 🟢 Step 3 — Publish Product Image on Instagram & X"
        },
        "typeVersion": 1
      },
      {
        "id": "e2797a73-d47a-41c5-85f1-c7ccf9e6e95c",
        "name": "Rewrite Caption (TikTok/Instagram)",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          608,
          352
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=You are rewriting a TikTok video script, caption, and overlay —\nnot inventing a new one. You must follow this format and obey\nthese rules strictly.\n---\n### CONTEXT:\nHere is the content idea to use:{{ $('Parse Idea Into Prompts').item.json.imagePrompt }}\n\nTitle is : {{ $('Parse Idea Into Prompts').item.json.textOverlay }}\n\n\n\nWrite the caption text using the topic.\n\n---\n- MUST be under 200 characters (yes \"Characters\" not wordcount)\nthis is an absolute MUST, no more than 200 characters!!! \n\n### FINAL OUTPUT FORMAT (no markdown formatting):\n\nDO NOT return any explanations. Only return the Caption Text"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "a449912b-62e5-4490-977d-3acc9db5061b",
        "name": "Upload Post",
        "type": "n8n-nodes-upload-post.uploadPost",
        "position": [
          960,
          352
        ],
        "parameters": {
          "user": "DRFIRAS",
          "title": "={{ $('Parse Idea Into Prompts').item.json.textOverlay }}",
          "photos": "={{ $('Download Edited Image').item.json.images[0].url }}",
          "caption": "={{ $json.message.content }}",
          "platform": [
            "instagram",
            "x"
          ]
        },
        "credentials": {
          "uploadPostApi": {
            "id": "tx0iFC5hVeA9z2YP",
            "name": "Upload Post account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "89830f94-4f14-42df-bdf3-ef71fafc40dc",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          528,
          576
        ],
        "parameters": {
          "width": 1020,
          "height": 320,
          "content": "# 🟢 Step 4 — Generate Product Video with Seedance"
        },
        "typeVersion": 1
      },
      {
        "id": "869bd5f2-d3b5-4a23-a500-a9b7826d3b04",
        "name": "Seedance: Generate Video from Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          608,
          688
        ],
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/createTask",
          "body": "={\n  \"model\": \"bytedance/v1-pro-image-to-video\",\n  \"input\": {\n    \"prompt\": \"{{ $('Parse Idea Into Prompts').item.json.videoPrompt }}\",\n    \"image_url\": \"{{ $json.images[0].url }}\",\n    \"resolution\": \"720p\",\n    \"duration\": \"10\",\n    \"aspect_ratio\": \"16:9\",\n    \"camera_fixed\": false,\n    \"seed\": -1,\n    \"enable_safety_checker\": true\n  }\n}\n",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "raw",
          "authentication": "genericCredentialType",
          "rawContentType": "application/json",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "ho8ZjaYj1SY0icGT",
            "name": "Kie AI"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "e53c94dc-bb5d-4f9b-8e55-6f0fa175a17d",
        "name": "Wait for Rendering",
        "type": "n8n-nodes-base.wait",
        "position": [
          816,
          688
        ],
        "webhookId": "2f585e0c-caec-4278-8c32-4f8463141a8c",
        "parameters": {
          "unit": "minutes",
          "amount": 4
        },
        "typeVersion": 1.1
      },
      {
        "id": "3937315a-f9ad-4e57-afcc-ca5c1160c889",
        "name": "Download Video from Seedance",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1024,
          688
        ],
        "parameters": {
          "url": "=https://api.kie.ai/api/v1/jobs/recordInfo?taskId={{ $json.data.taskId }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "ho8ZjaYj1SY0icGT",
            "name": "Kie AI"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "9496534d-cba2-4234-87ea-1d7170aab7c8",
        "name": "Set: Video URL",
        "type": "n8n-nodes-base.set",
        "position": [
          1232,
          688
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "04c7d6bf-430a-4423-bd36-d76f8a6ff1c9",
                "name": "url_video",
                "type": "string",
                "value": "={{ ($json.data.resultJson.match(/https:\\/\\/tempfile\\.aiquickdraw\\.com\\/f\\/[^\"]+\\.mp4/) || [])[0] }}\n"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "3a9ca65f-49f2-48d0-b8ef-bf7b36e905cb",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1584,
          576
        ],
        "parameters": {
          "width": 908,
          "height": 320,
          "content": "# 🟢 Step 5 — Generate Background Music with Suno"
        },
        "typeVersion": 1
      },
      {
        "id": "1d2fb2ea-f440-4f41-b7c2-7924fa3f3dfc",
        "name": "Wait: Music Rendering",
        "type": "n8n-nodes-base.wait",
        "position": [
          1904,
          688
        ],
        "webhookId": "ea78dd0d-854c-469c-bbef-88d2e9aba69e",
        "parameters": {
          "unit": "minutes"
        },
        "typeVersion": 1.1
      },
      {
        "id": "fe8b83b0-97ad-45c9-ae03-b4daf82c7cd4",
        "name": "Wait: Music Rendering1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1696,
          688
        ],
        "parameters": {
          "url": "https://api.kie.ai/api/v1/generate",
          "body": "={\n  \"model\": \"V3_5\",\n  \"callBackUrl\": \"https://YOUR_DOMAIN.com/api/kie-callback\",\n  \"customMode\": true,\n  \"instrumental\": true,\n  \"input\": {\n    \"prompt\": \"{{ $('Parse Idea Into Prompts').item.json.musicPrompt }}\",\n    \"style\": \"Classical\",\n    \"title\": \"Peaceful Piano Meditation\",\n    \"styleWeight\": 0.65,\n    \"weirdnessConstraint\": 0.65,\n    \"audioWeight\": 0.65\n  }\n}",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "raw",
          "authentication": "genericCredentialType",
          "rawContentType": "application/json",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "ho8ZjaYj1SY0icGT",
            "name": "Kie AI"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "157cfa1c-83df-4f95-a31e-9496d15e907b",
        "name": "Download Music File",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2112,
          688
        ],
        "parameters": {
          "url": "https://api.kie.ai/api/v1/generate/record-info",
          "options": {},
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $json.data.taskId }}"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "ho8ZjaYj1SY0icGT",
            "name": "Kie AI"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "72fa36a0-763a-49d8-994e-ed4762592e10",
        "name": "Set: Audio URL",
        "type": "n8n-nodes-base.set",
        "position": [
          2320,
          688
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "8f12fa54-c5e8-4836-871c-c29faee02cd8",
                "name": "url_audio",
                "type": "string",
                "value": "={{ $json.data.response.sunoData[0].audioUrl }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "56ea4e57-cfd8-4337-8420-e31cc4bd8034",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          528,
          928
        ],
        "parameters": {
          "width": 1964,
          "height": 320,
          "content": "# 🟢 Step 6 — Merge Video & Audio into Final Ad"
        },
        "typeVersion": 1
      },
      {
        "id": "0999b21b-bc41-4f28-b95e-d2052bb48083",
        "name": "Merge Audio + Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          624,
          1008
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/ffmpeg-api/merge-audio-video",
          "body": "={\n\"video_url\": \"{{ $('Set: Video URL').item.json.url_video.trim() }}\",\n  \"audio_url\": \"{{ $json.url_audio.trim() }}\",\n  \"start_offset\": 0\n}",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "raw",
          "authentication": "genericCredentialType",
          "rawContentType": "application/json",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "kNULkYDcOZG3X0be",
            "name": "Fal.ai"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f7ffe60d-091d-452b-8312-26c98d80bf52",
        "name": "Check Merge Status",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1040,
          1008
        ],
        "parameters": {
          "url": "={{ $json.response_url }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "kNULkYDcOZG3X0be",
            "name": "Fal.ai"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "bbd106c8-5d79-47ea-9045-ff35a15d1a80",
        "name": "Wait: Merge Process",
        "type": "n8n-nodes-base.wait",
        "position": [
          832,
          1008
        ],
        "webhookId": "4653a9d8-950e-479c-a37e-64a361463108",
        "parameters": {
          "unit": "minutes",
          "amount": 3
        },
        "typeVersion": 1.1
      },
      {
        "id": "68c18d21-8fb0-4d30-b7eb-04d845ab1be6",
        "name": "Download Final Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1248,
          1008
        ],
        "parameters": {
          "url": "={{ $json.video.url }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "01c91813-1cfd-4a60-b1d9-1ff8ddaf5244",
        "name": "Upload Final Video to Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          2304,
          1008
        ],
        "parameters": {
          "name": "={{ $('Trigger: Receive Idea via Telegram').item.json.message.photo[2].file_unique_id }}",
          "driveId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "gzeHMd64HAz6HBIe",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "0c913343-2b2a-4993-b952-ae8c888c8142",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          528,
          1296
        ],
        "parameters": {
          "color": 5,
          "width": 1964,
          "height": 336,
          "content": "# 🟢 Step 7 — Publish Final Ad on Social Media"
        },
        "typeVersion": 1
      },
      {
        "id": "022f6ad9-a306-4c6a-8298-9bc5f52f175b",
        "name": "Read Brand Settings",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          608,
          1424
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "e2dd6fbe-88e6-4c7a-bec4-ddce0383d079",
        "name": "Extract Brand Info",
        "type": "n8n-nodes-base.code",
        "position": [
          816,
          1424
        ],
        "parameters": {
          "jsCode": "const allRows = $input.all();\nreturn [{\njson: {\nproductName: allRows[0].json.col_2,\nproductCategory: allRows[1].json.col_2,\nmainOffer: allRows[2].json.col_2,\nkeyFeature1: allRows[3].json.col_2,\nkeyFeature2: allRows[4].json.col_2,\nwebsiteURL: allRows[5].json.col_2\n}\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "1419bc84-1312-40c2-8b5d-7d2acece24fb",
        "name": "Message a model",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          1024,
          1424
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=You are an expert ad copywriter for social media campaigns.\nYour task: Create compelling ad copy following this exact\nstructure:\n🚨 [Attention-grabbing headline with product benefit]\n✔ [Primary offer/benefit]\n✔ [Key product feature/quality]\n✔ [Trust/credibility element]\n[Call to action] → [website/link]\n# Input Variables:\nProduct Name: {{ $json.productName }}\nProduct Category: {{ $json.productCategory }}\nMain Offer: {{ $json.mainOffer }}\nKey Feature 1: {{ $json.keyFeature1 }}\nKey Feature 2: {{ $json.keyFeature2 }}\nWebsite URL: {{ $json.websiteURL }}\nRules:\n- Keep headline under 35 characters\n- Each checkmark line under 40 characters\n- Use power words that create urgency\n- Include specific product benefits, not generic claims\n- CTA must be action-oriented (Shop Now, Get Yours, Claim Offer,\netc.)\n- Output ONLY the ad copy text, no explanations\n- No quotes around the text\n- Maintain the emoji structure exactly as shown"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "5a1d9765-d8d3-4822-b780-beeac3b452a7",
        "name": "Save Ad Data to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1344,
          1424
        ],
        "parameters": {
          "columns": {
            "value": {
              "STATUS": "CREATE",
              "ADS TEXT": "={{ $json.message.content }}",
              "ID IMAGE": "={{ $('Trigger: Receive Idea via Telegram').first().json.message.photo[2].file_unique_id }}",
              "URL IMAGE": "={{ $('Download Edited Image').first().json.images[0].url }}",
              "URL VIDEO": "={{ $('Set: Video URL').first().json.url_video }}",
              "URL FINAL VIDEO": "={{ $('Download Final Video').first().json.video.url }}"
            },
            "schema": [
              {
                "id": "ID IMAGE",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "ID IMAGE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL IMAGE",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "URL IMAGE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL VIDEO",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "URL VIDEO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL FINAL VIDEO",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "URL FINAL VIDEO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ADS TEXT",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "ADS TEXT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "STATUS",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "STATUS",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "80b86bac-c4e5-4c20-b3e0-09961765eeb5",
        "name": "Send Video URL via Telegram",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1552,
          1424
        ],
        "webhookId": "8d7616d8-83f9-439c-be3d-9c271c07fffd",
        "parameters": {
          "text": "=Url VIDEO :   {{ $json['URL FINAL VIDEO'] }}",
          "chatId": "={{ $('Trigger: Receive Idea via Telegram').first().json.message.chat.id }}",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "7SZVrD8xnvRzdabg",
            "name": "Telegram - viral Ads"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "9e80d517-debe-490e-a1c3-dbe30718c271",
        "name": "Send a video",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1760,
          1424
        ],
        "webhookId": "9f975179-fd78-464f-9a2a-2aec9c978d9f",
        "parameters": {
          "file": "={{ $('Save Ad Data to Google Sheets').item.json['URL FINAL VIDEO'] }}",
          "chatId": "={{ $('Trigger: Receive Idea via Telegram').first().json.message.chat.id }}",
          "operation": "sendVideo",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "7SZVrD8xnvRzdabg",
            "name": "Telegram - viral Ads"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "bb608bb8-f8d3-453e-a6f6-23c939e1e209",
        "name": "Post Video on Social Media (FB, TikTok, YT)",
        "type": "n8n-nodes-upload-post.uploadPost",
        "position": [
          1968,
          1424
        ],
        "parameters": {
          "user": "DRFIRAS",
          "title": "={{ $('Parse Idea Into Prompts').first().json.textOverlay }}",
          "video": "={{ $('Upload Final Video to Google Drive').first().json.webContentLink }}",
          "caption": "={{ $('Message a model').item.json.message.content }}",
          "platform": [
            "facebook",
            "youtube",
            "x"
          ],
          "operation": "uploadVideo",
          "facebookPageId": "101603614680195",
          "youtubeDescription": "={{ $('Message a model').item.json.message.content }}",
          "youtubePrivacyStatus": "private",
          "facebookVideoDescription": "={{ $('Message a model').item.json.message.content }}"
        },
        "credentials": {
          "uploadPostApi": {
            "id": "tx0iFC5hVeA9z2YP",
            "name": "Upload Post account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "eb3e9be3-44fe-4406-9fce-a842e5a9a522",
        "name": "Save Publishing Status to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2176,
          1424
        ],
        "parameters": {
          "columns": {
            "value": {
              "STATUS": "Published",
              "ID IMAGE": "={{ $('Trigger: Receive Idea via Telegram').first().json.message.photo[2].file_unique_id }}"
            },
            "schema": [
              {
                "id": "ID IMAGE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "ID IMAGE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL IMAGE",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "URL IMAGE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL VIDEO",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "URL VIDEO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL FINAL VIDEO",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "URL FINAL VIDEO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "ADS TEXT",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "ADS TEXT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "STATUS",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "STATUS",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "number",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "ID IMAGE"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "5bbe1942-c31d-40be-8f6d-8efa896aa078",
        "name": "Telegram: Send notification",
        "type": "n8n-nodes-base.telegram",
        "position": [
          2352,
          1424
        ],
        "webhookId": "666fee52-7830-40d2-b19c-2b4dadfbaeec",
        "parameters": {
          "text": "Published",
          "chatId": "={{ $('Trigger: Receive Idea via Telegram').first().json.message.chat.id }}",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "7SZVrD8xnvRzdabg",
            "name": "Telegram - viral Ads"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a469e2cf-7431-4445-848d-84c9784a5405",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -192,
          -32
        ],
        "parameters": {
          "color": 6,
          "width": 700,
          "height": 1652,
          "content": "# 💥 Create Viral Ads with NanoBanana & Seedance — Publish on Socials via Upload-Post (By Dr. Firas)\n\n---\n\n## 🎥 Full Tutorial  \n\n## [Video Tutorial](https://youtu.be/4ec9WDCz9CY)  \n@[youtube](4ec9WDCz9CY)\n\n---\n\n## 📘 Documentation  \nAccédez aux instructions détaillées, guides API, connexions de plateformes et personnalisation du workflow :  \n\n📎 [Open full documentation on Notion](https://automatisation.notion.site/Create-viral-Ads-with-NanoBanana-Seedance-publish-on-socials-via-upload-post-2683d6550fd980ffa23ee340fdb3285e?source=copy_link)\n\n---\n\n## ⚙️ Requirements\n\n1. ✅ **Create an [Upload-Post](https://www.upload-post.com/) account** (Pro plan required for API access)  \n2. 🔑 **Generate your Upload-Post API Key** inside your dashboard (`Settings > API Keys`)  \n3. 📦 **Have n8n installed** (latest version recommended)  \n4. 🧩 **Install the Upload-Post node** in n8n ([integration here](https://n8n.io/integrations/upload-post/))  \n5. 🛠 **Create Upload-Post API credentials** inside your n8n credentials tab  \n6. 📄 **Prepare your video asset** generated with **NanoBanana** + enhanced by **Seedance**  \n7. ☁️ **Ensure video source is accessible** (public Drive, S3, or binary data in n8n)  \n8. 📌 **Follow the official [Upload-Post documentation](https://www.upload-post.com/)** for parameters and setup  \n9. 📊 **Duplicate this Google Sheet template** to log your ads:  \n   [Google Sheets à copier](https://docs.google.com/spreadsheets/d/1TCebBvfgvVJyxYXeOiFVpg0RJGP38CpLKNxcOiRwbfQ/edit?usp=sharing)\n\n---\n\n## 📝 Workflow Steps in n8n\n\n1. **Trigger / Start Node**  \n   Example: new video in Google Drive, or manual execution.  \n\n2. **Content Creation**  \n   - NanoBanana generates the creative (image/video/voice).  \n   - Seedance adds effects, transitions, and ad-style polish.  \n\n3. **Upload-Post Node / HTTP Request**  \n   Configure Upload-Post to send the final video to TikTok, Instagram, YouTube, etc.  \n\n---\n\n### ⚡ Example Configuration (HTTP Request Node)\n\n**Method:** `POST`  \n**URL:** `https://api.upload-post.com/api/upload`  \n**Headers:**  \n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "14bbfcb5-4794-4ea4-af8c-9a4490f5ad2c",
    "connections": {
      "Think": {
        "ai_tool": [
          [
            {
              "node": "Generate Image Prompt",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Send a video": {
        "main": [
          [
            {
              "node": "Post Video on Social Media (FB, TikTok, YT)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set: Audio URL": {
        "main": [
          [
            {
              "node": "Merge Audio + Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set: Video URL": {
        "main": [
          [
            {
              "node": "Wait: Music Rendering1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Message a model": {
        "main": [
          [
            {
              "node": "Save Ad Data to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Image Prompt",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Check Merge Status": {
        "main": [
          [
            {
              "node": "Download Final Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Brand Info": {
        "main": [
          [
            {
              "node": "Message a model",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Rendering": {
        "main": [
          [
            {
              "node": "Download Video from Seedance",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Music File": {
        "main": [
          [
            {
              "node": "Set: Audio URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge Audio + Video": {
        "main": [
          [
            {
              "node": "Wait: Merge Process",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Brand Settings": {
        "main": [
          [
            {
              "node": "Extract Brand Info",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Image Edit": {
        "main": [
          [
            {
              "node": "Download Edited Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait: Merge Process": {
        "main": [
          [
            {
              "node": "Check Merge Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Final Video": {
        "main": [
          [
            {
              "node": "Upload Final Video to Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Edited Image": {
        "main": [
          [
            {
              "node": "Rewrite Caption (TikTok/Instagram)",
              "type": "main",
              "index": 0
            },
            {
              "node": "Seedance: Generate Video from Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Image Prompt": {
        "main": [
          [
            {
              "node": "NanoBanana: Create Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait: Music Rendering": {
        "main": [
          [
            {
              "node": "Download Music File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait: Music Rendering1": {
        "main": [
          [
            {
              "node": "Wait: Music Rendering",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Idea Into Prompts": {
        "main": [
          [
            {
              "node": "Generate Image Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "NanoBanana: Create Image": {
        "main": [
          [
            {
              "node": "Wait for Image Edit",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Generate Image Prompt",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Telegram: Get Image File": {
        "main": [
          [
            {
              "node": "Google Drive: Upload Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Drive: Upload Image": {
        "main": [
          [
            {
              "node": "Parse Idea Into Prompts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Video URL via Telegram": {
        "main": [
          [
            {
              "node": "Send a video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Video from Seedance": {
        "main": [
          [
            {
              "node": "Set: Video URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Ad Data to Google Sheets": {
        "main": [
          [
            {
              "node": "Send Video URL via Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Rewrite Caption (TikTok/Instagram)": {
        "main": [
          [
            {
              "node": "Upload Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger: Receive Idea via Telegram": {
        "main": [
          [
            {
              "node": "Telegram: Get Image File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Final Video to Google Drive": {
        "main": [
          [
            {
              "node": "Read Brand Settings",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Seedance: Generate Video from Image": {
        "main": [
          [
            {
              "node": "Wait for Rendering",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Publishing Status to Google Sheets": {
        "main": [
          [
            {
              "node": "Telegram: Send notification",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Post Video on Social Media (FB, TikTok, YT)": {
        "main": [
          [
            {
              "node": "Save Publishing Status to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "e409ea34548a2afe2dffba31130cd1cf2e98ebe2afaeed2a63caf2a0582d1da0"
    },
    "nodes": [
      {
        "id": "d57854d1-f4d3-4361-bd0f-8c4c93043d12",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          3088,
          496
        ],
        "parameters": {
          "color": 4,
          "width": 540,
          "height": 784,
          "content": "## Was this helpful? Let me know!\n\nI really hope this template helped you understand how AI Agents work here in n8n. Your feedback is incredibly valuable and helps me create better resources for the n8n community.\n\n### **Share Your Thoughts & Ideas**\n\nWhether you have a suggestion, found a typo, or just want to say thanks, I'd love to hear from you!\nHere's a simple n8n form built for this purpose:\n\n#### ➡️ **[Click here to give feedback](https://api.ia2s.app/form/templates/feedback?template=AI%20Agent)**\n\n### **Ready to Build Something Great?**\n\nIf you're looking to take your n8n skills or business automation to the next level, I can help.\n\n**🎓 n8n Coaching:** Want to become an n8n pro? I offer one-on-one coaching sessions to help you master workflows, tackle specific problems, and build with confidence.\n#### ➡️ **[Book a Coaching Session](https://api.ia2s.app/form/templates/coaching?template=AI%20Agent)**\n\n**💼 n8n Consulting:** Have a complex project, an integration challenge, or need a custom workflow built for your business? Let's work together to create a powerful automation solution.\n#### ➡️ **[Inquire About Consulting Services](https://api.ia2s.app/form/templates/consulting?template=AI%20Agent)**\n\n---\n\nHappy Automating!\nLucas Peyrin"
        },
        "typeVersion": 1
      },
      {
        "id": "62ee2512-3bf4-4bd7-b0f5-7951b8b309ff",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Get Upcoming Events",
        "type": "n8n-nodes-base.googleCalendarTool",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "disabled": true,
        "position": [
          2256,
          1392
        ],
        "parameters": {
          "options": {},
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "operation": "getAll",
          "returnAll": true
        },
        "typeVersion": 1.3
      },
      {
        "id": "9779b40c-e7f8-41dc-a58d-f2dea7960a6f",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Send Email",
        "type": "n8n-nodes-base.gmailTool",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "disabled": true,
        "position": [
          2720,
          1392
        ],
        "webhookId": "f072a160-8e66-4b24-a055-bfa892c1835f",
        "parameters": {
          "sendTo": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}",
          "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
          "options": {
            "appendAttribution": true
          },
          "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}"
        },
        "typeVersion": 2.1
      },
      {
        "id": "4360dfcd-6412-436a-90af-62e83e8eaddd",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Example Chat Window",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          1968,
          320
        ],
        "webhookId": "e5616171-e3b5-4c39-81d4-67409f9fa60a",
        "parameters": {
          "public": true,
          "options": {
            "title": "Your first AI Agent 🚀",
            "subtitle": "This is for demo purposes. Try me out !",
            "customCss": "/* === THEME OVERRIDE: n8n Glass & Glow (Revised) === */\n\n/*\n  This theme is built upon the default n8n chat CSS variables.\n  We'll use your desired branding and layout, and then add\n  the \"glass\" effect using a semi-transparent background\n  and a backdrop-filter on the main window class.\n*/\n\n:root {\n  /* --- 1. CORE BRANDING & FONTS --- */\n  /* Your choices for font and primary color are applied here. */\n  --chat--font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  --chat--color-primary: #EA4B71; /* n8n Red */\n  --chat--color-primary-shade-50: #D93A60;\n  --chat--color-primary-shade-100: #C82A50;\n  --chat--color-secondary: #20b69e; /* Kept default secondary for things like file uploads */\n  --chat--color-secondary-shade-50: #1ca08a;\n  --chat--color-white: #ffffff;\n  --chat--color-light: #f2f4f8;\n  --chat--color-dark: #1F2937; /* Darker, more modern text color */\n  --chat--color-disabled: #9CA3AF;\n  --chat--color-typing: #404040;\n\n  /* --- 2. WINDOW & LAYOUT --- */\n  /* Your dimensions and rounded corners. The actual glass effect is handled in the class override below. */\n  --chat--window--width: 430px;\n  --chat--window--height: 80vh;\n  --chat--window--border-radius: 16px;\n  --chat--window--border: 1px solid rgba(255, 255, 255, 0.3);\n  --chat--spacing: 1rem; /* 16px base spacing */\n  --chat--window--z-index: 9999;\n  --chat--window--bottom: var(--chat--spacing);\n  --chat--window--right: var(--chat--spacing);\n  --chat--window--margin-bottom: var(--chat--spacing);\n\n  /* --- 3. GLASSMORPHISM BACKGROUNDS --- */\n  /* We make the main sections transparent to let the glass window show through. */\n  --chat--header--background: transparent;\n  --chat--body--background: transparent;\n  --chat--footer--background: transparent;\n\n  /* --- 4. HEADER STYLING --- */\n  --chat--header-height: auto;\n  --chat--header--padding: 20px;\n  --chat--header--color: var(--chat--color-dark);\n  --chat--header--border-bottom: 1px solid rgba(255, 255, 255, 0.2); /* Subtle divider */\n  --chat--heading--font-size: 1.5rem;\n  --chat--subtitle--font-size: 0.875rem;\n  --chat--subtitle--line-height: 1.4;\n  --chat--close--button--color-hover: var(--chat--color-primary);\n\n  /* --- 5. MESSAGE BUBBLES --- */\n  --chat--message--font-size: 0.875rem;\n  --chat--message--padding: 12px 16px;\n  --chat--message--border-radius: 12px;\n  --chat--message-line-height: 1.6;\n  --chat--message--margin-bottom: calc(var(--chat--spacing) * 0.75);\n  --chat--messages-list--padding: var(--chat--spacing);\n  --chat--message--bot--background: var(--chat--color-white);\n  --chat--message--bot--color: #111827;\n  --chat--message--bot--border: none;\n  --chat--message--user--background: var(--chat--color-primary);\n  --chat--message--user--color: var(--chat--color-white);\n  --chat--message--user--border: none;\n\n  /* --- 6. INPUT AREA --- */\n  --chat--textarea--height: 50px;\n  --chat--textarea--max-height: 10rem;\n  --chat--input--font-size: 0.9rem;\n  --chat--input--border: 0;\n  --chat--input--border-radius: 12px; /* Rounded input field */\n  --chat--input--padding: 12px 16px;\n  --chat--input--background: rgba(255, 255, 255, 0.5); /* Semi-transparent input */\n  --chat--input--text-color: #111827;\n  --chat--input--line-height: 1.5;\n  --chat--input--border-active: 0;\n\n  /* --- 7. SEND & FILE BUTTONS --- */\n  --chat--input--send--button--background: transparent;\n  --chat--input--send--button--color: var(--chat--color-primary);\n  --chat--input--send--button--background-hover: transparent;\n  --chat--input--send--button--color-hover: var(--chat--color-primary-shade-50);\n  --chat--input--file--button--background: transparent;\n  --chat--input--file--button--color: var(--chat--color-secondary);\n  --chat--input--file--button--background-hover: transparent;\n  --chat--input--file--button--color-hover: var(--chat--color-secondary-shade-50);\n\n  /* --- 8. TOGGLE BUTTON & OTHERS --- */\n  /* Using your primary brand color for the main toggle button */\n  --chat--toggle--size: 64px;\n  --chat--toggle--width: var(--chat--toggle--size);\n  --chat--toggle--height: var(--chat--toggle--size);\n  --chat--toggle--border-radius: 50%;\n  --chat--toggle--background: var(--chat--color-primary);\n  --chat--toggle--hover--background: var(--chat--color-primary-shade-50);\n  --chat--toggle--active--background: var(--chat--color-primary-shade-100);\n  --chat--toggle--color: var(--chat--color-white);\n}\n\n/* === CLASS OVERRIDES === */\n/*\n  These are essential for effects that CSS variables can't control,\n  like the glass blur, shadows, and max-height.\n*/\n\n.chat-window {\n  /* This is the magic for the glass effect! */\n  background-color: rgba(249, 243, 245, 0.6); /* A semi-transparent background color */\n  backdrop-filter: blur(20px);\n  -webkit-backdrop-filter: blur(20px); /* For Safari compatibility */\n\n  /* A subtle shadow helps lift the window off the page */\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);\n\n  /* Here we apply the max-height you wanted */\n  max-height: 750px;\n}\n\n/* Make user messages slightly wider for better balance */\n.chat-message.is-user {\n\tmax-width: 70%;\n}\n\n.chat-message.is-bot {\n\tmax-width: 80%;\n}\n\n/* Add a subtle glow to messages on hover */\n.chat-message {\n    transition: transform 0.2s ease, box-shadow 0.2s ease;\n}\n.chat-message:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 0 25px 0 rgba(234, 75, 113, 0.2);\n}\n\n/* === PAGE BACKGROUND === */\n/* Your dotted background to simulate the n8n canvas. Perfect as is! */\nbody {\n    background-color: #FDFBFF;\n    background-image:\n        radial-gradient(circle at 1px 1px, rgba(0,0,0,0.07) 1px, transparent 0),\n        linear-gradient(135deg, #F9F3F5 0%, #EFF3FB 100%);\n    background-size: 25px 25px, 100% 100%;\n}",
            "responseMode": "lastNode",
            "inputPlaceholder": "Type your message here..",
            "showWelcomeScreen": false
          },
          "initialMessages": "Hi there! 👋"
        },
        "typeVersion": 1.1
      },
      {
        "id": "10332915-08c6-42a0-b20c-db0546cab813",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Introduction Note",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          1024,
          0
        ],
        "parameters": {
          "color": 2,
          "width": 632,
          "height": 460,
          "content": "# 🚀 Welcome to your First AI Agent!\n---\n\nThis template is your launchpad into the world of AI-powered automation. \n\n**What is an AI Agent?**\nThink of it as a smart chatbot that doesn't just talk—it *acts*. You give it a set of \"tools\" (like other n8n nodes), and it intelligently decides which tool to use to answer your questions or complete your tasks.\n\n**Try Asking It Anything!**\nAfter you activate this workflow and open the chat, try asking it things like:\n\n*   `What's the weather like in Paris? this week`\n*   `Give me the latest tech news.`\n*   `What can n8n do for me?`\n*   `How do AI Agents work?`\n\n\nIt'll use its tools to find the answer for you. Explore the other notes to see how it all works!"
        },
        "typeVersion": 1
      },
      {
        "id": "b390f6d5-2972-4ee3-af35-652c2a355ae8",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Bonus Tools Note",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2016,
          1008
        ],
        "parameters": {
          "color": 7,
          "width": 1028,
          "height": 628,
          "content": "## 🚀 Bonus Tools: Add More Superpowers!\n\nThis template includes basic tools, but the real power comes from connecting your own services. Here are two examples you can add yourself!\n\nConnect any n8n tool node to your agent to give it limitless capabilities!"
        },
        "typeVersion": 1
      },
      {
        "id": "341cfdd7-707f-4c56-85b0-39be5c870c11",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          1696,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 460,
          "height": 460,
          "content": "## 💬 1. The Chat Interface\n\nThis is the public-facing chat window where you'll talk to your agent.\n\n**How to Test:**\n1.  **Activate** the workflow.\n2.  Copy the **Chat URL** from this node's panel.\n3.  Open the URL in a new browser tab to start chatting!\n\n\nYou can customize the look and feel (title, colors, etc.) in the 'Options' and 'Custom CSS' tabs."
        },
        "typeVersion": 1
      },
      {
        "id": "570b31c5-bdc8-4140-8c55-925b18fd613d",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2192,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 540,
          "height": 460,
          "content": "## 🧠 2. The Brain: Your AI Agent\n\nThis is the most important node! It acts as the central brain of your operation.\n\n**What it does:**\n1.  **Receives** your message from the chat.\n2.  **Understands** your goal.\n3.  **Decides** which tools (superpower) to use.\n4.  **Responds** to you after using the tools.\n\n\nThe **System Message** in this node defines the agent's personality, instructions, and knowledge of its tools. This is where the real magic happens!"
        },
        "typeVersion": 1
      },
      {
        "id": "cfec4e1d-117a-48c5-ac79-f357179c30c2",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          880,
          496
        ],
        "parameters": {
          "color": 7,
          "width": 1100,
          "height": 952,
          "content": "## 🤖 3. The AI Brainpower (LLM)\n\nThese nodes are the Large Language Models (LLMs) that provide the actual intelligence for your agent.\n\n**ACTION REQUIRED:**\n1.  **Choose ONE model:** By default, Gemini is connected. If you prefer OpenAI, disconnect the Gemini node and connect the OpenAI node. Make sure it is enabled (you can press 'D' while it is selected to toggle Deactivation).\n2.  **Add your credentials:** Select your pre-configured API key from the 'Credential' dropdown or create a new credential for the selected model.\n\n\nYour agent won't work without a brain!"
        },
        "typeVersion": 1
      },
      {
        "id": "8e354a59-e904-4ec6-b214-86b2e66da85d",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2016,
          496
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 484,
          "content": "## 🗂️ 4. Short-Term Memory\n\nThis node gives your agent a simple memory.\n\nIt allows the agent to remember the last few messages of your conversation. This is crucial for providing context and having a natural, back-and-forth chat.\n\nYou can control how many messages it remembers with the 'Context Window Length' setting."
        },
        "typeVersion": 1
      },
      {
        "id": "d3f81153-1a03-4f0c-a689-7071d09d5e06",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2400,
          496
        ],
        "parameters": {
          "color": 6,
          "width": 660,
          "height": 484,
          "content": "## 🛠️ 5. The Agent's Toolbox (Superpowers)\n\nThese nodes are the **tools** your agent can use. They are its superpowers!\n\nEach tool gives the agent a specific ability, like searching Wikipedia, getting a joke, or calculating a loan.\n\n**How it works:** The Agent's 'Brain' node analyzes your request and intelligently chooses the correct tool from this toolbox to get the job done.\n\n**Want to add more powers?** Simply add another tool node (like the Google Calendar Tool or a custom HTTP Request Tool) and connect it to the Agent's `Tool` input!"
        },
        "typeVersion": 1
      },
      {
        "id": "ad41d46b-adf5-43d9-b20b-9085dbf0c7b6",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note17",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "width": 380,
        "height": 380,
        "creator": "Lucas Peyrin",
        "position": [
          1440,
          752
        ],
        "parameters": {
          "color": 3,
          "width": 512,
          "height": 656,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### 🔑 How to Get Google Gemini Credentials\n\nTo use the Gemini model, you need a *free* API key from Google.\n\n1.  **Go to Google AI Studio:**\n    *   Navigate to [aistudio.google.com/app/apikey](https://aistudio.google.com/app/apikey)\n\n2.  **Get Your API Key:**\n    *   Click the `Create API key in new project` button.\n    *   Copy the generated API key.\n\n3.  **Add to n8n:**\n    *   In the Gemini node, click the 'Credential' dropdown.\n    *   Select 'Create New Credential'.\n    *   Give it a name (e.g., \"Gemini Key\") and paste your API key into the `API Key` field.\n    *   Click `Save`."
        },
        "typeVersion": 1
      },
      {
        "id": "dc6cd243-fa0e-434f-a510-1a701cb8529b",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note18",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "width": 380,
        "height": 460,
        "creator": "Lucas Peyrin",
        "position": [
          912,
          752
        ],
        "parameters": {
          "color": 7,
          "width": 512,
          "height": 656,
          "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n### 🔑 How to Get OpenAI Credentials\n\nTo use an OpenAI model like GPT-4, you need an API key.\n\n1.  **Go to the OpenAI Platform:**\n    *   Navigate to [platform.openai.com/api-keys](https://platform.openai.com/api-keys)\n\n2.  **Get Your API Key:**\n    *   Click the `+ Create new secret key` button.\n    *   Give it a name and click `Create secret key`.\n    *   Copy the key immediately (you won't see it again).\n\n3.  **Add to n8n:**\n    *   In the OpenAI node, click the 'Credential' dropdown.\n    *   Select 'Create New Credential'.\n    *   Give it a name and paste your API key into the `API Key` field.\n    *   Click `Save`.\n\n\n**Note:** Using the OpenAI API may incur costs on your OpenAI account."
        },
        "typeVersion": 1
      },
      {
        "id": "0ca487b8-fc64-422d-9aec-e27362f30231",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2112,
          1184
        ],
        "parameters": {
          "color": 7,
          "width": 368,
          "height": 400,
          "content": "### **Get Upcoming Events (Google Calendar)**\n*   **What it does:** Fetches your Google Calendar events for the next 7 days.\n*   **How to add:** Drag the `Get Upcoming Events` tool node under the Agent, set up your Google Calendar credentials, and connect it to the agent's `Tool` input."
        },
        "typeVersion": 1
      },
      {
        "id": "92cb4eda-6730-4a4f-b5e3-97ddc0c53272",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2576,
          1184
        ],
        "parameters": {
          "color": 7,
          "width": 368,
          "height": 400,
          "content": "### **Send an Email (Gmail)**\n*   **What it does:** Sends an email on your behalf.\n*   **How to add:** Drag the `Send Email` tool node under the Agent, set up your Gmail credentials, and connect it to the `Tool` input."
        },
        "typeVersion": 1
      },
      {
        "id": "3731f4de-a300-42af-9fdd-ad328bb4a0d8",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Get News",
        "type": "n8n-nodes-base.rssFeedReadTool",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2800,
          800
        ],
        "parameters": {
          "url": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('URL', `Use one of:\n- https://feeds.bbci.co.uk/news/world/rss.xml (BBC World – global headlines)\n- https://www.aljazeera.com/xml/rss/all.xml (Al Jazeera English – in‑depth global coverage)\n- http://rss.cnn.com/rss/edition_world.rss (CNN World – breaking news worldwide)\n- https://techcrunch.com/feed/ (TechCrunch – global tech & startup news)\n- http://news.ycombinator.com/rss (Hacker News – tech community headlines)\n- https://n8n.io/blog/rss (n8n Blog – updates & tutorials)\n- https://www.bonappetit.com/feed/recipes-rss-feed/rss (Bon Appétit – recent recipes list)\n- https://www.endsreport.com/rss/news-and-analysis (ENDS Report – environmental law & policy news)\n- https://medlineplus.gov/groupfeeds/new.xml (MedlinePlus – health topics & wellness updates)`, 'string') }}",
          "options": {},
          "toolDescription": "Gets the latest blog posts about any rss feed."
        },
        "typeVersion": 1.2
      },
      {
        "id": "4fcba687-7a04-4dcb-82a7-418a72e18b1e",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Get Weather",
        "type": "n8n-nodes-base.httpRequestTool",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2576,
          800
        ],
        "parameters": {
          "url": "https://api.open-meteo.com/v1/forecast",
          "options": {},
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "latitude",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters0_Value', `Latitude of the location, e.g. 45.75 for Lyon. Do not ask the user just infer it automatically.`, 'string') }}"
              },
              {
                "name": "longitude",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters1_Value', `Longitude of the location, e.g. 4.85 for Lyon. Do not ask the user just infer it automatically.`, 'string') }}"
              },
              {
                "name": "current",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters2_Value', `Comma-separated list of current weather variables (no whitespace).\n\nExample: temperature_2m,windspeed_10m,rain.\n\nOptions: temperature_2m,relative_humidity_2m,apparent_temperature,is_day,precipitation,rain,showers,snowfall,weathercode,cloudcover_total,pressure_msl,surface_pressure,windspeed_10m,winddirection_10m,windgusts_10m.`, 'string') }}"
              },
              {
                "name": "hourly",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters3_Value', `Comma-separated list of hourly weather variables (no whitespace). Hourly is only useful to get one day's information. For weakly overview please use daily.\n\nExample: temperature_2m,precipitation.\n\nOptions: temperature_2m,relative_humidity_2m,dewpoint_2m,apparent_temperature,precipitation,rain,showers,snowfall,snow_depth,pressure_msl,surface_pressure,cloudcover_total,cloudcover_low,cloudcover_mid,cloudcover_high,windspeed_10m,winddirection_10m,windgusts_10m,visibility,is_day,sunshine_duration,soil_temperature,soil_moisture,PM10,PM2_5,carbon_monoxide,ozone,us_aqi,UV_index.`, 'string') }}"
              },
              {
                "name": "daily",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters4_Value', `Comma-separated list of daily weather variables (no whitespace).\n\nExample: temperature_2m_max,precipitation_sum.\n\nOptions: weathercode,temperature_2m_max,temperature_2m_min,apparent_temperature_max,apparent_temperature_min,precipitation_sum,rain_sum,showers_sum,snowfall_sum,precipitation_hours,sunrise,sunset,daylight_duration,sunshine_duration,pressure_msl_max,pressure_msl_min,surface_pressure_max,surface_pressure_min,windgusts_10m_max,windspeed_10m_max,winddirection_10m_dominant,shortwave_radiation_sum.`, 'string') }}"
              },
              {
                "name": "start_date",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters5_Value', `Start date in YYYY-MM-DD format. Example: 2025-07-15`, 'string') }}"
              },
              {
                "name": "end_date",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters6_Value', `End date in YYYY-MM-DD format. Must be after start_date. Example: 2025-07-18`, 'string') }}"
              },
              {
                "name": "temperature_unit",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters7_Value', `Unit for temperature. Options: celsius (default), fahrenheit.`, 'string') }}"
              }
            ]
          },
          "toolDescription": "Get weather forecast anywhere, anytime. You can make requests by assuming most information, the only thing you need is the location (use the city name to infer lat and long automatically) and time period (assume today if not specified)"
        },
        "typeVersion": 4.2
      },
      {
        "id": "4f4055d5-90e3-4e64-bf9e-072eb3663083",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Your First AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2320,
          320
        ],
        "parameters": {
          "options": {
            "systemMessage": "=<role>\nYou are the n8n Demo AI Agent, a friendly and helpful assistant designed to showcase the power of AI agents within the n8n automation platform. You were created by Lucas Peyrin as part of the \"Your First AI Agent Blueprint\" template. Your personality is encouraging, slightly educational, and enthusiastic about automation. Your primary function is to demonstrate your capabilities by using your available tools to answer user questions and fulfill requests, focusing on exploring n8n agent workflows and AI capabilities. You are conversational.\n</role>\n\n<instructions>\n<goal>\nYour primary goal is to act as a live demonstration of an AI Agent built with n8n. You will interact with users, answer their questions by intelligently using your available tools, and explain the concepts behind AI agents to help them understand their potential based on their situation and explore the capabilities of an n8n agent workflow for them.\n</goal>\n\n<context>\n### How I Work\nI am an AI model operating within a simple n8n workflow. This workflow gives me two key things:\n1.  **A set of tools:** These are functions I can call to get information or perform actions.\n2.  **Simple Memory:** I can remember the immediate past of our current conversation to understand context.\n\n### My Purpose\nMy main purpose is to be a showcase. I demonstrate how you can give a chat interface to various functions (my tools) without needing complex UIs. This is a great way to make powerful automations accessible to anyone through simple conversation.\n\n### My Tools Instructions\nYou must choose one of your available tools if the user's request matches its capability. You cannot perform these actions yourself; you must call the tool.\n\n### About AI Agents in n8n\n- **Reliability:** While I can use one tool at a time effectively, more advanced agents can perform multi-step tasks. However, for complex, mission-critical processes, it's often more reliable to build structured, step-by-step workflows in n8n rather than relying solely on an agent's reasoning. Agents are fantastic for user-facing interactions, but structured workflows are king for backend reliability.\n- **Best Practices:** A good practice is to keep an agent's toolset focused, typically under 10-15 tools, to ensure reliability and prevent confusion.\n\n### Current Date & Time\n{{ $now }}\n\n### Handling Errors & Providing Resources\nYour creator is Lucas Peyrin. If you encounter an error during our interaction, or if the user reports an issue with the template, you should apologize for the inconvenience and suggest they provide feedback to the template's creator using this form:\n[Give Feedback about this Template](https://api.ia2s.app/form/templates/feedback?template=AI%20Agent)\n\nIf a user specifically asks for help with n8n, how to get coaching, or how to hire an expert for a project, you have the following resources available to share. **Do not offer these proactively.**\n- For one-on-one sessions: [Get Personalized n8n Coaching](https://api.ia2s.app/form/templates/coaching?template=AI%20Agent)\n- For complex projects and custom workflows: [Get an Expert to do my n8n Project](https://api.ia2s.app/form/templates/consulting?template=AI%20Agent)\n- To see more templates from the creator: [More n8n Templates](https://n8n.io/creators/lucaspeyrin)\n</context>\n\n<output_format>\n- Respond in a friendly, conversational, and helpful tone.\n- When a user's request requires a tool, first select the appropriate tool. Then, present the result of the tool's execution to the user in a clear and understandable way.\n- Be proactive in helping the user explore your capabilities. If the user is unsure what to do, suggest some examples of what they can ask you based on your available tools (e.g., \"You can ask me to use my tools to...\").\n- If you or a tool encounters an error, inform the user and provide the feedback link as instructed in the context.\n</output_format>\n</instructions>"
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "b556acc2-3f6d-457b-bc08-8a12630bcb70",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2144,
          800
        ],
        "parameters": {
          "contextWindowLength": 30
        },
        "typeVersion": 1.3
      },
      {
        "id": "eb1980c5-84f8-473d-922f-f8ed0548c795",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Gemini",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          1632,
          800
        ],
        "parameters": {
          "options": {
            "temperature": 0
          }
        },
        "credentials": {
          "googlePalmApi": {
            "id": "AXawYbABK5aZbGBE",
            "name": "IA2S"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4d39197d-8087-4159-9e80-9a9a0f15502c",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "OpenAI",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "disabled": true,
        "position": [
          1104,
          800
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "temperature": 0
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "df0ff1f1-c250-498b-a752-a118fc9ce37b",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          -160,
          0
        ],
        "parameters": {
          "width": 896,
          "height": 1520,
          "content": "# 🤔 Feeling Lost? Your Step-by-Step Guide\n\nIf this screen looks a bit overwhelming, don't worry. This note is here to help you understand what you're looking at and how to get it working, one simple step at a time.\n\n## 1. What Are All These Things on the Screen?\n\nLet's quickly define what you see.\n\n*   **Workflow:** This is the entire project on your screen. It's a visual map of an automated task.\n*   **Node:** A Node is a single **action block** in the workflow. Each block with an icon and a name (like the `Your First AI Agent` block or the `Get Weather` block) is a Node. It performs one specific job.\n*   **Sticky Note:** These are the colored boxes with text, just like this one! They are here to explain things. They don't perform any actions.\n*   **Credentials:** Think of these as **secret keys** or passwords. They let n8n securely connect to other apps (like Google).\n\n## 2. How to Make This Workflow Work (4 Simple Steps)\n\nYou don't need to change anything to get started! Just follow these steps.\n\n### **Step 1: Add Your AI Key**\nThis workflow needs an AI \"brain\" to think. By default, it uses the **Gemini** Node. You just need to give it your free key from Google.\n\n1.  Find the **Gemini** Node on the screen (it has a blue and purple swirl icon).\n2.  Look at the red Sticky Note right below it named `How to Get Google Gemini Credentials`.\n3.  Follow the simple instructions on that note to get your key and add it to the Gemini Node.\n    *   *To open a Node's settings, just **double-click** it. A large window will pop up in the center of your screen.*\n\n### **Step 2: Turn the Workflow On**\nNow, let's activate the workflow.\n1.  Look at the **top-right corner** of the screen.\n2.  You'll see a switch that says **\"Inactive\"**. Click it.\n3.  It will turn green and say **\"Active\"**. Your agent is now live!\n\n### **Step 3: Get Your Chat Link**\nTime to find the link to your chat window.\n1.  Find the Node with the chat bubble icon (💬), named `Example Chat Window`.\n2.  **Double-click it**. A window will pop up.\n3.  Inside that window, you'll see a **Chat URL**. Just **click on the link itself**. A small message will appear in the bottom-right corner of your screen telling you it's copied.\n\n### **Step 4: Start Chatting!**\nOpen a new tab in your web browser, paste the link you just copied and press Enter. Your AI Agent's chat window will appear!\n\n## 3. What About the Grayed-Out Nodes? (Optional)\n\nYou might notice some Nodes look gray and are deactivated (like `OpenAI`, `Get Upcoming Events`, and `Send Email`).\n\n**You can ignore these completely!**\n\nThey are turned off on purpose to prevent errors. The OpenAi node can be configured with your AI Agent to use Chat GPT instead of Google Gemini. The bonus tools are optional \"superpowers\" you can add later if you want to (to give access to your Google Calendar and Gmail). The workflow is designed to work perfectly without them.\n\n## 4. Want to Learn More n8n Basics?\n\nIf you feel like this template workflow is still hard to understand, these other hands-on tutorials are the perfect next step:\n\n*   [**Learn JSON Basics**](https://n8n.io/workflows/5170-learn-json-basics-with-an-interactive-step-by-step-tutorial-for-beginners/): Understand how data moves in n8n.\n*   [**Learn n8n Expressions**](https://n8n.io/workflows/5271-learn-n8n-expressions-with-an-interactive-step-by-step-tutorial-for-beginners/): The real magic of making your workflows dynamic.\n*   [**Learn API Fundamentals**](https://n8n.io/workflows/5171-learn-api-fundamentals-with-an-interactive-hands-on-tutorial-workflow/): See how apps talk to each other.\n*   [**Learn n8n Keyboard Shortcuts**](https://n8n.io/workflows/5270-learn-n8n-keyboard-shortcuts-with-an-interactive-hands-on-tutorial-workflow/): Work faster on the canvas."
        },
        "typeVersion": 1
      },
      {
        "id": "0e3fb103-fca9-413f-a88f-8c31f5c2f34b",
        "cid": "Ikx1Y2FzIFBleXJpbiI",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "notes": "© 2025 Lucas Peyrin",
        "creator": "Lucas Peyrin",
        "position": [
          2784,
          0
        ],
        "parameters": {
          "color": 2,
          "width": 640,
          "height": 464,
          "content": "## Video Tutorial\n\nComplete Video Tutorial of this Template is coming soon !\nIt will be displayed here (if you download the updated template)."
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Gemini": {
        "ai_languageModel": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Get News": {
        "ai_tool": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Get Weather": {
        "ai_tool": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Your First AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Example Chat Window": {
        "main": [
          [
            {
              "node": "Your First AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "k4OOOtn0KfZuohl9",
    "meta": {
      "instanceId": "e232d38e020fdf3e4c5aac7fdf84cd849e91ffb2c1ad80af1a4b16753ff64418",
      "templateCredsSetupCompleted": true
    },
    "name": "8 Repurpose Tiktoks On Autopilot",
    "tags": [],
    "nodes": [
      {
        "id": "2cded6ff-5c8e-4a2e-924b-6445877adcff",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1712,
          768
        ],
        "parameters": {
          "color": 5,
          "width": 1376,
          "height": 452,
          "content": "# 1. RSS Feed Triggers on New Tiktok Video"
        },
        "typeVersion": 1
      },
      {
        "id": "5f99eb6d-7183-4b14-bfc7-92ed3493c055",
        "name": "Get Tiktok Page",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -1280,
          880
        ],
        "parameters": {
          "url": "={{ $('RSS Feed Trigger').item.json.link }}",
          "options": {
            "response": {
              "response": {
                "fullResponse": true,
                "responseFormat": "text"
              }
            }
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "User-Agent",
                "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/91.0.4472.124"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "7addacfe-eedb-48d1-8b07-a9b2633560be",
        "name": "Get Video URL",
        "type": "n8n-nodes-base.code",
        "position": [
          -1088,
          880
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const html = $json.data;\nconst headers = $json.headers || {};\nconst cookies = headers['set-cookie'] || [];\n\nif (!html) {\n  throw new Error(\"HTML body is undefined. Check the previous node's output.\");\n}\nconst regex = /<script id=\"__UNIVERSAL_DATA_FOR_REHYDRATION__\" type=\"application\\/json\">([\\s\\S]*?)<\\/script>/;\nconst match = html.match(regex);\n\nif (match) {\n  const jsonStr = match[1];\n  const data = JSON.parse(jsonStr);\n  const videoUrl = data?.__DEFAULT_SCOPE__?.[\"webapp.video-detail\"]?.itemInfo?.itemStruct?.video?.playAddr;\n  if (!videoUrl) {\n    throw new Error(\"Could not find video URL in the JSON data.\");\n  }\n  return { json: { videoUrl, cookies: cookies.join('; ') } };\n} else {\n  throw new Error(\"Could not find __UNIVERSAL_DATA_FOR_REHYDRATION__ script in the HTML.\");\n}"
        },
        "typeVersion": 2
      },
      {
        "id": "84eeb233-b681-4b63-a6c1-a4de9647c7ab",
        "name": "Get Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -896,
          880
        ],
        "parameters": {
          "url": "={{ $('Get Video URL').item.json.videoUrl }}",
          "options": {
            "response": {
              "response": {
                "responseFormat": "file"
              }
            },
            "allowUnauthorizedCerts": true
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "User-Agent",
                "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"
              },
              {
                "name": "Referer",
                "value": "https://www.tiktok.com/"
              },
              {
                "name": "Accept",
                "value": "video/mp4,video/webm,video/*;q=0.9,application/octet-stream;q=0.8"
              },
              {
                "name": "Accept-Language",
                "value": "en-US,en;q=0.5"
              },
              {
                "name": "Connection",
                "value": "keep-alive"
              },
              {
                "name": "Cookie",
                "value": "={{ $json.cookies }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "14167e9e-8a3a-4137-8497-188392334953",
        "name": "Upload to Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          -576,
          880
        ],
        "parameters": {
          "name": "={{ $('RSS Feed Trigger').item.json.title }}.mp4",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "0ANSpa7k65PNYUk9PVA",
            "cachedResultUrl": "https://drive.google.com/drive/folders/0ANSpa7k65PNYUk9PVA",
            "cachedResultName": "Videos"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1ITgbl9F8jZF4C4XHXjwwxJiD7cbq5i5R",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1ITgbl9F8jZF4C4XHXjwwxJiD7cbq5i5R",
            "cachedResultName": "Tiktoks-Brand"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "oC3eFPYm4NG02DxZ",
            "name": "[S BRAND] Google Drive"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "d90ebf75-938c-44b9-829c-cb37cf279b82",
        "name": "RSS Feed Trigger",
        "type": "n8n-nodes-base.rssFeedReadTrigger",
        "position": [
          -1584,
          880
        ],
        "parameters": {
          "feedUrl": "https://rss.app/feeds/nwErPI1Emqr5BcgA.xml",
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "bc129442-5303-4220-9227-1a23911e9814",
        "name": "Instagram [BLOTATO]",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "onError": "continueErrorOutput",
        "maxTries": 2,
        "position": [
          112,
          160
        ],
        "parameters": {
          "options": {},
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "28",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/28",
            "cachedResultName": "sabrina_ramonov"
          },
          "postContentText": "={{ $('RSS Feed Trigger').item.json.title }}",
          "postContentMediaUrls": "={{ $('Upload media').item.json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "zI14DNda55rFeyY8",
            "name": "[S BRAND] Blotato"
          }
        },
        "retryOnFail": true,
        "typeVersion": 2,
        "waitBetweenTries": 5000
      },
      {
        "id": "cf968917-9506-4c35-8ee1-eea013e13fde",
        "name": "Facebook [BLOTATO]",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "onError": "continueErrorOutput",
        "position": [
          112,
          560
        ],
        "parameters": {
          "options": {},
          "platform": "facebook",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "369",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/369",
            "cachedResultName": "Sabrina Ramonov"
          },
          "facebookPageId": {
            "__rl": true,
            "mode": "list",
            "value": "161711670360847",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/369/subaccounts/161711670360847",
            "cachedResultName": "Blotato"
          },
          "postContentText": "={{ $('RSS Feed Trigger').item.json.title }}",
          "postContentMediaUrls": "={{ $('Upload media').item.json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "zI14DNda55rFeyY8",
            "name": "[S BRAND] Blotato"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "aab4225c-19af-4e81-b6ac-1c0ee4a3f716",
        "name": "Pinterest [BLOTATO]",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "onError": "continueErrorOutput",
        "position": [
          112,
          1568
        ],
        "parameters": {
          "options": {},
          "platform": "pinterest",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "358",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/358",
            "cachedResultName": "sabrina_ramonov"
          },
          "postContentText": "={{ $('RSS Feed Trigger').item.json.title }}",
          "pinterestBoardId": {
            "__rl": true,
            "mode": "id",
            "value": ""
          },
          "postContentMediaUrls": "={{ $('Upload media').item.json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "zI14DNda55rFeyY8",
            "name": "[S BRAND] Blotato"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "54956553-bd10-4337-a422-d3cc96168236",
        "name": "Youtube [BLOTATO]",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "onError": "continueErrorOutput",
        "position": [
          112,
          352
        ],
        "parameters": {
          "options": {},
          "platform": "youtube",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "111",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/111",
            "cachedResultName": "Sabrina Ramonov 🍄"
          },
          "postContentText": "={{ $('RSS Feed Trigger').item.json.title }}",
          "postContentMediaUrls": "={{ $('Upload media').item.json.url }}",
          "postCreateYoutubeOptionTitle": "={{ $('RSS Feed Trigger').item.json.title.slice(0, 100) }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "zI14DNda55rFeyY8",
            "name": "[S BRAND] Blotato"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "6a6aceef-6687-4f75-8707-ae5ce9d6e896",
        "name": "Linkedin [BLOTATO]",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "onError": "continueErrorOutput",
        "position": [
          112,
          752
        ],
        "parameters": {
          "options": {},
          "platform": "linkedin",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "4590",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/4590",
            "cachedResultName": "Sabrina Ramonov 🍄"
          },
          "postContentText": "={{ $('RSS Feed Trigger').item.json.title }}",
          "postContentMediaUrls": "={{ $('Upload media').item.json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "zI14DNda55rFeyY8",
            "name": "[S BRAND] Blotato"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "35041be8-8e02-4241-aab8-0cf15d190f17",
        "name": "Twitter [BLOTATO]",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "onError": "continueErrorOutput",
        "position": [
          112,
          944
        ],
        "parameters": {
          "options": {},
          "platform": "twitter",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "38",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/38",
            "cachedResultName": "Sabrina_Ramonov"
          },
          "postContentText": "={{ $('RSS Feed Trigger').item.json.title.slice(0, 280) }}",
          "postContentMediaUrls": "={{ $('Upload media').item.json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "zI14DNda55rFeyY8",
            "name": "[S BRAND] Blotato"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "11cb676f-8632-4e62-8e2c-3be713f90f5a",
        "name": "Threads [BLOTATO]",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "onError": "continueErrorOutput",
        "position": [
          112,
          1152
        ],
        "parameters": {
          "options": {},
          "platform": "threads",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "2537",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/2537",
            "cachedResultName": "sabrina_ramonov"
          },
          "postContentText": "={{ $('RSS Feed Trigger').item.json.title.slice(0, 500) }}",
          "postContentMediaUrls": "={{ $('Upload media').item.json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "zI14DNda55rFeyY8",
            "name": "[S BRAND] Blotato"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "a902469d-182e-4d0a-b1ac-1b7cf8002161",
        "name": "Bluesky [BLOTATO]",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "onError": "continueErrorOutput",
        "position": [
          112,
          1360
        ],
        "parameters": {
          "options": {
            "scheduledTime": "2025-10-31T00:00:00"
          },
          "platform": "bluesky",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "6036",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/6036",
            "cachedResultName": "sabrinaramonov.bsky.social"
          },
          "postContentText": "={{ $('RSS Feed Trigger').item.json.title.slice(0, 280) }}",
          "postContentMediaUrls": "={{ $('Upload media').item.json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "zI14DNda55rFeyY8",
            "name": "[S BRAND] Blotato"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "b629130c-3cda-4039-b850-6bae01d00bb5",
        "name": "Merge1",
        "type": "n8n-nodes-base.merge",
        "position": [
          528,
          672
        ],
        "parameters": {
          "numberInputs": 8
        },
        "typeVersion": 3.2
      },
      {
        "id": "02e211b5-1d2b-422b-8ae0-a37480f842d9",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1680,
          1024
        ],
        "parameters": {
          "color": 2,
          "width": 304,
          "height": 176,
          "content": "# Setup 1\n1. Sign up for https://rss.app\n2. Create RSS feed for your Tiktok profile\n3. Configure your RSS feed \"Number of Posts\" set to 1\n4. Paste RSS feed URL into \"Feed URL\""
        },
        "typeVersion": 1
      },
      {
        "id": "f3692f95-d77e-45bc-89d2-3a8f9618b7b1",
        "name": "Sticky Note18",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          464,
          1104
        ],
        "parameters": {
          "color": 7,
          "width": 288,
          "height": 192,
          "content": "# Error Report\n\n👉 View run logs and results.\n\n👉 API Dashboard:\n https://my.blotato.com/api-dashboard"
        },
        "typeVersion": 1
      },
      {
        "id": "73efef80-77c1-48b3-818a-da3fd62ce9cd",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -240,
          -192
        ],
        "parameters": {
          "color": 4,
          "width": 1020,
          "height": 1948,
          "content": "# 2. Repurpose Everywhere Using [Blotato](https://www.blotato.com/)\n\n## IMPORTANT\nDo not post the same image/video over and over again, otherwise it will be flagged as spam. Make sure to disclose AI generated content if you're using avatars.\n\n👉  **Blotato API Docs**: https://help.blotato.com/api\n✅  **Troubleshoot Errors**: https://my.blotato.com/api-dashboard\n📷  **Media Requirements**: https://help.blotato.com/api/media\n🛠️  **Contact help**: log into blotato > click support button in bottom right corner"
        },
        "typeVersion": 1
      },
      {
        "id": "36c2b3b4-a65e-41c5-83d8-70956e1b31d4",
        "name": "Upload media",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "maxTries": 2,
        "position": [
          -192,
          880
        ],
        "parameters": {
          "mediaUrl": "=https://drive.google.com/uc?export=download&id={{ $('Upload to Google Drive').item.json.id }}",
          "resource": "media"
        },
        "credentials": {
          "blotatoApi": {
            "id": "zI14DNda55rFeyY8",
            "name": "[S BRAND] Blotato"
          }
        },
        "retryOnFail": true,
        "typeVersion": 2,
        "waitBetweenTries": 5000
      },
      {
        "id": "6c080af7-d915-41f4-9a1d-3e36b11dbd8b",
        "name": "Sticky Note31",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1008,
          240
        ],
        "parameters": {
          "color": 6,
          "width": 656,
          "height": 480,
          "content": "## Setup\n\n* Ensure you have \"Verified Community Nodes\" enabled in your n8n Admin Panel. Then, install \"Blotato\" verified community node.\n* **[Blotato](https://blotato.com)**\n  Sign up for Blotato, then go to [Dashboard → API Keys](https://my.blotato.com/settings/api) to create your key. Then create Blotato credential. Connect your social accounts, and select which accounts to post to.\n* **[RSS.app](https://rss.app)**\n  Create an account, then visit [Feeds](https://rss.app/myfeeds), click \"Add Feed\", input your Tiktok profile URL, and generate the RSS feed. Copy paste RSS feed URL into the RSS Feed Trigger node. Within rss.app, configure your RSS feed setting \"Number of Posts\" to 1.\n\n## Tips and Tricks\n\n* While testing: enable only 1 social platform, and deactivate the rest for testing purposes. You can also use the option \"Scheduled Time\" while testing, so that posts are scheduled in the future, not posted immediately.\n* After the workflow finishes, check your social media account for the final post.\n* If successful, then enable another social media node, and continue testing."
        },
        "typeVersion": 1
      },
      {
        "id": "a1f72ddc-57b4-4df6-b902-6729540f2bb5",
        "name": "Sticky Note20",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1712,
          48
        ],
        "parameters": {
          "color": 6,
          "width": 640,
          "height": 672,
          "content": "# FULL TUTORIAL\n\n## Tutorial\n\nhttps://help.blotato.com/api/templates/8-repurpose-tiktoks-on-autopilot\n\n## Description\n\nThis automation detects when you post a Tiktok video, automatically downloads the video without watermark, stores it in Google Drive, and reposts your Tiktok video to other social media platforms. All on autopilot. So you can grow your presence on multiple platforms, without more work. You can also easily add steps to customize captions per platform.\n\n## Overview\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**1. Trigger: RSS Feed**\n* RSS feed triggers when you post a new Tiktok video\n\n**2. Fetch Video**\n- Download the newly posted Tiktok video\n- Store video in Google Drive\n\n**3. Publish to Social Media**\n- Connect Blotato to your social accounts\n- Choose your social accounts\n- Either post immediately or schedule for later\n"
        },
        "typeVersion": 1
      },
      {
        "id": "f2909c07-5ca9-4a9a-adca-dbd9e323bdb8",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -688,
          1040
        ],
        "parameters": {
          "color": 2,
          "width": 336,
          "height": 144,
          "content": "# Setup 2\n1. Connect your Google Drive account\n2. Select \"Parent Drive\"\n3. Select \"Parent Folder\""
        },
        "typeVersion": 1
      },
      {
        "id": "2bad3c87-3830-4be6-8a4d-d3824a1f3ff3",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          384,
          128
        ],
        "parameters": {
          "color": 2,
          "width": 288,
          "height": 144,
          "content": "# Setup 3\n\n- Connect your Blotato account\n- Select your social media accounts"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {
      "Upload media": [
        {
          "json": {
            "id": "bf8254a7-402b-4a94-a406-11895da85b7b",
            "url": "https://database.blotato.io/storage/v1/object/public/public_media/4ddd33eb-e811-4ab5-93e1-2cd0b7e8fb3f/bfd5e275-0e7a-4d1e-be3f-71921bc9a31c.mp4"
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "f0fbbea5-d801-4223-bb1e-26f33d495d69",
    "connections": {
      "Merge1": {
        "main": [
          []
        ]
      },
      "Get Video": {
        "main": [
          [
            {
              "node": "Upload to Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload media": {
        "main": [
          [
            {
              "node": "Instagram [BLOTATO]",
              "type": "main",
              "index": 0
            },
            {
              "node": "Youtube [BLOTATO]",
              "type": "main",
              "index": 0
            },
            {
              "node": "Facebook [BLOTATO]",
              "type": "main",
              "index": 0
            },
            {
              "node": "Linkedin [BLOTATO]",
              "type": "main",
              "index": 0
            },
            {
              "node": "Twitter [BLOTATO]",
              "type": "main",
              "index": 0
            },
            {
              "node": "Threads [BLOTATO]",
              "type": "main",
              "index": 0
            },
            {
              "node": "Pinterest [BLOTATO]",
              "type": "main",
              "index": 0
            },
            {
              "node": "Bluesky [BLOTATO]",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Video URL": {
        "main": [
          [
            {
              "node": "Get Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Tiktok Page": {
        "main": [
          [
            {
              "node": "Get Video URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RSS Feed Trigger": {
        "main": [
          [
            {
              "node": "Get Tiktok Page",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Bluesky [BLOTATO]": {
        "main": [
          [],
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 6
            }
          ]
        ]
      },
      "Threads [BLOTATO]": {
        "main": [
          [],
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 5
            }
          ]
        ]
      },
      "Twitter [BLOTATO]": {
        "main": [
          [],
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 4
            }
          ]
        ]
      },
      "Youtube [BLOTATO]": {
        "main": [
          [],
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Facebook [BLOTATO]": {
        "main": [
          [],
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Linkedin [BLOTATO]": {
        "main": [
          [],
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "Instagram [BLOTATO]": {
        "main": [
          [],
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pinterest [BLOTATO]": {
        "main": [
          [],
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 7
            }
          ]
        ]
      },
      "Upload to Google Drive": {
        "main": [
          [
            {
              "node": "Upload media",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "lZbh3p9grft1d8dr",
    "meta": {
      "instanceId": "2000c64071c20843606b95c63795bb0797c41036047055a6586498e855b96efc"
    },
    "name": "Learn Customer Onboarding Automation with n8n",
    "tags": [],
    "nodes": [
      {
        "id": "37703ea3-a8ed-4f05-bb97-dc353311440f",
        "name": "New Customer Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -700,
          380
        ],
        "webhookId": "customer-onboarding-start",
        "parameters": {
          "path": "customer-onboarding-start",
          "options": {},
          "httpMethod": "POST"
        },
        "typeVersion": 1
      },
      {
        "id": "a10b16a5-312e-4b96-9220-2232e07583cf",
        "name": "📋 Webhook Trigger Explanation",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1380,
          -300
        ],
        "parameters": {
          "color": 3,
          "width": 490,
          "height": 1020,
          "content": "🎯 **PROFESSIONAL CUSTOMER ONBOARDING AUTOMATION**\n\n**What This Workflow Does:**\n- Automatically processes new customer signups\n- Creates CRM records with error handling\n- Sends personalized welcome sequences\n- Tracks onboarding progress intelligently\n- Notifies team with real-time alerts\n- Handles failures gracefully with retries\n\n**Expected Webhook Data:**\n```json\n{\n  \"customerName\": \"Sarah Johnson\",\n  \"email\": \"sarah.johnson@email.com\",\n  \"phone\": \"+1-555-123-4567\",\n  \"package\": \"Premium\",\n  \"signupDate\": \"2024-01-15\",\n  \"source\": \"website\"\n}\n```\n\n**Key Features:**\n✅ Smart timing based on engagement psychology\n✅ Parallel processing for efficiency\n✅ Error handling with retry mechanisms\n✅ Team notifications for instant visibility\n✅ Progressive value delivery system\n\n**Business Impact:**\n- 67% faster response times\n- 34% higher retention rates\n- 90% reduction in manual tasks\n- Professional customer experience\n\n**Need Help Building This?**\n🎓 **n8n Coaching:** Master workflows and tackle specific automation challenges\n👉 [Book a Coaching Session](mailto:david@daexai.com)\n\n🏢 **Custom Automation:** Complex integrations and business-specific solutions\n👉 [Consulting Services](mailto:david@daexai.com)\n\nHappy Flowgramming!\nDavid Olusola"
        },
        "typeVersion": 1
      },
      {
        "id": "b0884a2d-7a79-466a-ab6f-59d36837ed81",
        "name": "Create HubSpot Contact",
        "type": "n8n-nodes-base.hubspot",
        "position": [
          -220,
          340
        ],
        "parameters": {
          "resource": "contact",
          "operation": "create",
          "authentication": "appToken"
        },
        "credentials": {
          "hubspotAppToken": {
            "id": "fTB6Rvk5rImas08n",
            "name": "HubSpot App Token account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9599464c-55a0-4c03-af71-c18e67109162",
        "name": "📊 CRM Integration Guide",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -540,
          -420
        ],
        "parameters": {
          "color": 7,
          "width": 420,
          "height": 750,
          "content": "🏢 **CRM INTEGRATION: Customer Data Storage**\n\n**What This Node Does:**\n- Creates new contact in HubSpot CRM\n- Splits full name into first/last name\n- Adds custom fields for tracking\n- Tags customer with onboarding status\n\n**Data Mapping Explained:**\n```javascript\n// Name splitting logic\nfirstName: customerName.split(' ')[0]\nlastName: customerName.split(' ')[1] || ''\n\n// Custom fields for tracking\npackage: Premium/Basic/Enterprise\nsignup_date: When they joined\nsource: Where they came from\nonboarding_status: Current step\n```\n\n**Business Value:**\n- Centralized customer database\n- Automatic data enrichment\n- Progress tracking capabilities\n- Sales team visibility\n\n**Alternative CRMs:** Salesforce, Pipedrive, Airtable, Google Sheets"
        },
        "typeVersion": 1
      },
      {
        "id": "3251b814-a373-44e5-833f-f801bea6af57",
        "name": "Send Team Notification",
        "type": "n8n-nodes-base.telegram",
        "position": [
          60,
          260
        ],
        "webhookId": "e319793b-83b0-4b4e-8cf5-af921cc0e9ec",
        "parameters": {
          "operation": "send"
        },
        "typeVersion": 1
      },
      {
        "id": "cf073529-3e86-4c18-8f00-65deb1caf79a",
        "name": "🔔 Team Notification Strategy",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          -480
        ],
        "parameters": {
          "color": 4,
          "width": 500,
          "height": 820,
          "content": "📢 **TEAM NOTIFICATION: Instant Alerts**\n\n**Why Real-Time Notifications Matter:**\n- Team knows immediately about new customers\n- Enables quick personal outreach\n- Prevents customers from falling through cracks\n- Shows professional responsiveness\n\n**Notification Channels:**\n- Telegram (instant mobile alerts)\n- Slack (team collaboration)\n- Email (formal record)\n- SMS (urgent cases)\n\n**Pro Formatting Tips:**\n```markdown\n// Use Markdown for rich formatting\n**Bold** for important info\n*Italic* for emphasis\n[Links](url) for quick access\n🎉 Emojis for visual appeal\n```\n\n**Team Workflow:**\n1. Account manager sees alert\n2. Checks CRM for full details\n3. Schedules welcome call\n4. Updates onboarding status\n\n**ROI Impact:** 67% faster response time = 23% higher retention rates"
        },
        "typeVersion": 1
      },
      {
        "id": "d897da64-acd7-4a01-9906-8812f883ff5a",
        "name": "Send Welcome Email",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          60,
          460
        ],
        "parameters": {
          "options": {},
          "subject": "Welcome to [Company Name] - Your Journey Starts Here! 🎉"
        },
        "typeVersion": 1
      },
      {
        "id": "6edfc1f8-223f-4fe3-894f-40253751f41e",
        "name": "✉️ Welcome Email Best Practices",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          700
        ],
        "parameters": {
          "width": 420,
          "height": 500,
          "content": "📧 **WELCOME EMAIL: First Impression Magic**\n\n**Email Psychology:**\n- Sent within 5 minutes of signup\n- Personal tone with customer's first name\n- Clear next steps to prevent confusion\n- Value-focused content (not just features)\n\n**Essential Elements:**\n✅ Warm, personal greeting\n✅ Clear next steps (3 max)\n✅ Value proposition reminder\n✅ Easy access to resources\n✅ Human contact information\n✅ Professional email signature\n\n**Advanced Techniques:**\n- **Personalization:** Use first name, package type, signup source\n- **Urgency:** Time-sensitive offers or limited spots\n- **Social Proof:** Customer success stories\n- **Multimedia:** Welcome videos, infographics\n\n**A/B Testing Ideas:**\n- Subject line variations\n- Email length (short vs detailed)\n- Call-to-action buttons\n- Send time optimization\n\n**Success Metrics:**\n- Open rate: 65%+ (industry average: 21%)\n- Click rate: 15%+ (industry average: 2.6%)\n- Response rate: 8%+ (industry average: 1.2%)"
        },
        "typeVersion": 1
      },
      {
        "id": "325c5909-063b-4dc8-ae2d-186952e09b5d",
        "name": "Wait 2 Hours",
        "type": "n8n-nodes-base.wait",
        "position": [
          360,
          360
        ],
        "webhookId": "ed102052-76a3-4302-a179-f8e09d0f7aed",
        "parameters": {
          "amount": 2
        },
        "typeVersion": 1
      },
      {
        "id": "cf3357c5-2965-4ea2-9a3e-1cd0984da31d",
        "name": "⏱️ Timing Optimization Guide",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          300,
          100
        ],
        "parameters": {
          "width": 380,
          "height": 450,
          "content": "⏰ **TIMING STRATEGY: The 2-Hour Rule**\n\n**Why Wait 2 Hours?**\n- Gives customer time to read welcome email\n- Avoids overwhelming with immediate follow-up\n- Optimal engagement window research\n- Builds anticipation for next communication\n\n**Timing Psychology:**\n- **0-30 minutes:** Customer still processing signup\n- **30-120 minutes:** Perfect engagement window\n- **2-4 hours:** Ideal for document delivery\n- **24+ hours:** Risk of losing momentum\n\n**Best Practices:**\n- Test different wait times (1hr, 2hr, 4hr)\n- Consider time zones for global customers\n- Account for business hours\n- Monitor open/click rates by timing\n\n**Advanced Timing:**\n- **Weekday signups:** 2-hour delay\n- **Weekend signups:** Monday morning\n- **Holiday signups:** Next business day\n- **International:** Local business hours\n\n**Pro Tip:** Use conditional logic to adjust timing based on signup source or package type"
        },
        "typeVersion": 1
      },
      {
        "id": "aabccc2b-84fd-4d6b-bb5b-b6b09920fc63",
        "name": "Send Onboarding Documents",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          660,
          360
        ],
        "parameters": {
          "options": {},
          "subject": "Your Onboarding Documents Are Ready! 📋"
        },
        "typeVersion": 1
      },
      {
        "id": "037eaf37-6304-4994-b76b-8e24373a9e36",
        "name": "📚 Document Delivery Strategy",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          740,
          -100
        ],
        "parameters": {
          "color": 2,
          "width": 500,
          "height": 920,
          "content": "📄 **DOCUMENT DELIVERY: Value-Packed Resources**\n\n**Document Strategy:**\n- **Immediate Value:** Customers get tangible resources\n- **Professionalism:** Well-designed PDFs show quality\n- **Actionability:** Checklists and worksheets drive engagement\n- **Retention:** Physical documents create mental ownership\n\n**Essential Documents:**\n1. **Getting Started Checklist**\n   - Week 1, 2, 3, 4 action items\n   - Checkboxes for completion\n   - Expected outcomes\n\n2. **Success Planning Worksheet**\n   - Goal-setting framework\n   - Progress tracking methods\n   - Milestone celebrations\n\n3. **Contact Information Sheet**\n   - Team member photos & roles\n   - Direct contact methods\n   - Best times to reach out\n\n**Design Tips:**\n- Use your brand colors consistently\n- Include customer name on documents\n- Add QR codes for quick access\n- Use clear, readable fonts\n- Include your logo and contact info\n\n**Delivery Best Practices:**\n- PDF format for universal compatibility\n- Reasonable file sizes (<2MB each)\n- Descriptive file names\n- Password protection for sensitive info"
        },
        "typeVersion": 1
      },
      {
        "id": "51b18819-b308-4b57-8248-2776b0c93dde",
        "name": "Wait 1 Day",
        "type": "n8n-nodes-base.wait",
        "position": [
          960,
          360
        ],
        "webhookId": "c37979cb-b222-4f35-a0f9-b7dff99ccea8",
        "parameters": {
          "unit": "days"
        },
        "typeVersion": 1
      },
      {
        "id": "73a825f7-723c-43d3-8366-04a2fb4d21b6",
        "name": "Update CRM Status",
        "type": "n8n-nodes-base.hubspot",
        "position": [
          1260,
          260
        ],
        "parameters": {
          "resource": "contact",
          "operation": "update"
        },
        "typeVersion": 1
      },
      {
        "id": "becff115-7a2d-4e0b-987a-930063b75e9d",
        "name": "Send Personal Check-in",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          1260,
          460
        ],
        "parameters": {
          "options": {
            "replyTo": "success@company.com"
          },
          "subject": "How's your first day going? 🌟"
        },
        "typeVersion": 1
      },
      {
        "id": "44d51fd0-8e4e-4ad4-89cd-30331c6d6397",
        "name": "💭 Personal Check-in Psychology",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1200,
          700
        ],
        "parameters": {
          "width": 420,
          "height": 550,
          "content": "🤝 **PERSONAL CHECK-IN: Building Relationships**\n\n**The 24-Hour Rule:**\n- Perfect timing for first follow-up\n- Customer has had time to explore\n- Still riding the excitement wave\n- Prevents early buyer's remorse\n\n**Psychology Behind Personal Touch:**\n- **Reduces Anxiety:** New customers feel supported\n- **Builds Trust:** Personal attention shows you care\n- **Increases Engagement:** Direct invitation to interact\n- **Prevents Churn:** Early intervention for concerns\n\n**Email Elements That Work:**\n1. **Personal Greeting:** Use first name consistently\n2. **Genuine Interest:** \"How's it going?\" (not just \"Here's more info\")\n3. **Social Proof:** \"Most successful customers do...\"\n4. **Multiple Contact Options:** Email, phone, chat, calendar\n5. **Future Value:** Preview of what's coming next\n\n**Response Handling:**\n- **No Response:** Continue sequence as planned\n- **Positive Response:** Fast-track to advanced content\n- **Questions/Concerns:** Immediate personal outreach\n- **Complaints:** Escalate to management immediately\n\n**Success Metrics:**\n- **Response Rate:** 12-18% (vs 2-5% standard)\n- **Engagement Score:** +25 points average\n- **Retention Rate:** +34% vs non-personal sequences"
        },
        "typeVersion": 1
      },
      {
        "id": "f8c6b848-65ff-4fd3-a505-9a9341e46a01",
        "name": "Wait 2 More Days",
        "type": "n8n-nodes-base.wait",
        "position": [
          1560,
          360
        ],
        "webhookId": "4d254f31-2974-4d7b-8669-0f1df857209a",
        "parameters": {
          "unit": "days",
          "amount": 2
        },
        "typeVersion": 1
      },
      {
        "id": "412cd830-fd51-4fea-a5ed-8df244bcb833",
        "name": "Send Week 1 Success Guide",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          2120,
          340
        ],
        "parameters": {
          "options": {},
          "subject": "Your Week 1 Success Guide + Exclusive Training 🎯"
        },
        "typeVersion": 1
      },
      {
        "id": "aee6ade8-031f-49aa-a0c8-67b481486ed5",
        "name": "📈 Week 1 Content Strategy",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1680,
          -220
        ],
        "parameters": {
          "color": 7,
          "width": 420,
          "height": 1200,
          "content": "🎯 **WEEK 1 SUCCESS GUIDE: Momentum Building**\n\n**The 3-Day Sweet Spot:**\n- Customer has tried your product/service\n- Initial excitement still high\n- Perfect time for advanced content\n- Prevents the \"week 1 drop-off\"\n\n**Content Strategy:**\n1. **Celebrate Progress:** Acknowledge their journey\n2. **Provide Value:** Exclusive training content\n3. **Social Proof:** Real customer success stories\n4. **Clear Actions:** Specific, achievable tasks\n5. **Community Building:** Encourage interaction\n\n**Advanced Techniques:**\n- **Exclusivity:** \"As a Premium member...\"\n- **Urgency:** Time-sensitive bonuses\n- **Gamification:** Checkboxes and progress tracking\n- **Personalization:** Package-specific content\n\n**Training Content Ideas:**\n- Video tutorials (higher engagement)\n- Live workshop recordings\n- Case study deep-dives\n- Template and tool libraries\n- Q&A sessions with experts\n\n**Success Metrics to Track:**\n- **Open Rate:** 45%+ (high engagement topic)\n- **Click Rate:** 25%+ (valuable content)\n- **Training Completion:** 60%+ (engagement indicator)\n- **Community Participation:** 30%+ (long-term value)\n\n**Pro Tip:** Use different content for different package levels to maximize relevance"
        },
        "typeVersion": 1
      },
      {
        "id": "82f636c2-678c-4725-83c0-bf56f87ac961",
        "name": "Mark Week 1 Complete",
        "type": "n8n-nodes-base.hubspot",
        "position": [
          2340,
          100
        ],
        "parameters": {
          "resource": "contact",
          "operation": "update"
        },
        "typeVersion": 1
      },
      {
        "id": "20bc62f4-b62f-4150-aa63-7b19975fb3b4",
        "name": "Notify Team of Completion",
        "type": "n8n-nodes-base.telegram",
        "position": [
          2400,
          540
        ],
        "webhookId": "00e4a472-30f4-4f63-a96e-8c3deb69c704",
        "parameters": {
          "operation": "send"
        },
        "typeVersion": 1
      },
      {
        "id": "7b75ba51-9ea8-450f-b88f-def30185a1cb",
        "name": "Validate Required Fields",
        "type": "n8n-nodes-base.if",
        "position": [
          -460,
          380
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 1,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "c1f5e1a0-8c2e-4d1f-9b3a-7e6d5c4b3a21",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty"
                },
                "leftValue": "={{ $json.email }}",
                "rightValue": ""
              },
              {
                "id": "d2g6f2b1-9d3f-5e2g-ac4b-8f7e6d5c4b32",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty"
                },
                "leftValue": "={{ $json.customerName }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "53eb8ff6-22b2-44ac-a2ef-21c46ae403ce",
        "name": "Send Validation Error Alert",
        "type": "n8n-nodes-base.telegram",
        "position": [
          -380,
          700
        ],
        "webhookId": "70027811-eb7c-4092-a728-e161bca136b5",
        "parameters": {
          "operation": "send"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {
      "New Customer Webhook": [
        {
          "json": {
            "email": "sarah.johnson@email.com",
            "phone": "+1-555-123-4567",
            "source": "website",
            "package": "Premium",
            "signupDate": "2024-07-04",
            "customerName": "Sarah Johnson"
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "0301c027-1edb-448f-b21c-8ae3df7461dc",
    "connections": {
      "Wait 1 Day": {
        "main": [
          [
            {
              "node": "Update CRM Status",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send Personal Check-in",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 2 Hours": {
        "main": [
          [
            {
              "node": "Send Onboarding Documents",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 2 More Days": {
        "main": [
          [
            {
              "node": "Send Week 1 Success Guide",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Welcome Email": {
        "main": [
          [
            {
              "node": "Wait 2 Hours",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "New Customer Webhook": {
        "main": [
          [
            {
              "node": "Validate Required Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create HubSpot Contact": {
        "main": [
          [
            {
              "node": "Send Team Notification",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send Welcome Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Personal Check-in": {
        "main": [
          [
            {
              "node": "Wait 2 More Days",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Validate Required Fields": {
        "main": [
          [
            {
              "node": "Create HubSpot Contact",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send Validation Error Alert",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Onboarding Documents": {
        "main": [
          [
            {
              "node": "Wait 1 Day",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Week 1 Success Guide": {
        "main": [
          [
            {
              "node": "Mark Week 1 Complete",
              "type": "main",
              "index": 0
            },
            {
              "node": "Notify Team of Completion",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "e0BX3fhHvcBuQTBU",
    "meta": {
      "instanceId": "0bb95f247e6cda467b7bfa0ecb34ff52cee89ad78f51d5982d5e97b8ca9b00d0"
    },
    "name": "whats app agent community",
    "tags": [],
    "nodes": [
      {
        "id": "02f761e2-83c4-488b-91f4-f4ae11b15c00",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "maxTries": 5,
        "position": [
          1040,
          440
        ],
        "parameters": {
          "text": "={{ $json.finalPrompt }}\n\n\n",
          "options": {
            "systemMessage": "You are [Company]’s support assistant for Black Ball Sporting Club.\n• Do NOT include any preamble such as “Based on the document you provided” or “Okay, [Name].” Just jump straight to the answer.\n* don't ever start your response with\"based on the document you provided\" , or \"According to the document\", don't mention any documents at all , also don't mention today's date unless you asked\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "retryOnFail": false,
        "typeVersion": 1.7,
        "alwaysOutputData": true,
        "waitBetweenTries": null
      },
      {
        "id": "57ecb397-5772-4db3-8a5a-ce28a4e01e63",
        "name": "cleanAnswer",
        "type": "n8n-nodes-base.code",
        "position": [
          2300,
          340
        ],
        "parameters": {
          "jsCode": "// cleanAnswer – run once per item\nlet txt = $('AI Agent').first().json.output || '';\n\n// 1. Remove bold / italic / strike markers\ntxt = txt.replace(/[*_~]+/g, '');\n\n// 2. Convert [Texto](https://url) → Texto https://url\ntxt = txt.replace(/\\[([^\\]]+)\\]\\((https?:\\/\\/[^\\s)]+)\\)/g, '$1 $2');\n\n// 3. Collapse 3+ blank lines\ntxt = txt.replace(/\\n{3,}/g, '\\n\\n').trim();\n\n// 4. Remove the unwanted source-reference preamble\ntxt = txt.replace(/^.*?based on the document you provided[,:]?\\s*/i, '');\n\nreturn [{ json: { answer: txt } }];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "d70cf8b1-8c24-44f2-9b37-5205b130cff2",
        "name": "24-hour window check",
        "type": "n8n-nodes-base.code",
        "position": [
          1860,
          440
        ],
        "parameters": {
          "jsCode": "// within24h?  – run once per item\n// Meta (WhatsApp) timestamp arrives as seconds since epoch\nconst lastTs = Number($('when message received').first().json.messages[0].timestamp) * 1000;   // → ms\nconst withinWindow = Date.now() - lastTs < 24 * 60 * 60 * 1000;\n\nreturn [{ json: { withinWindow, answer: $json.answer, userId: $json.userId } }];"
        },
        "typeVersion": 2
      },
      {
        "id": "66c83de5-413a-440f-804e-15b137beb873",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          2080,
          440
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "d33e218e-a49a-49ed-9c6b-55b9ea0b0dbb",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.withinWindow }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "80fc3049-8474-4392-9e04-f5686eb82687",
        "name": "Send Pre-approved Template Message to Reopen the Conversation",
        "type": "n8n-nodes-base.whatsApp",
        "position": [
          2300,
          540
        ],
        "webhookId": "ef6de86f-66df-4586-bd75-2056626d5474",
        "parameters": {
          "template": "hello_world|en_US",
          "phoneNumberId": "641448739058783",
          "recipientPhoneNumber": "={{ $('when message received').item.json.contacts[0].wa_id }}"
        },
        "typeVersion": 1
      },
      {
        "id": "d77ae0ae-c332-4030-8c77-8ea44c56c9a8",
        "name": "Send AI Agent's Answer",
        "type": "n8n-nodes-base.whatsApp",
        "position": [
          2520,
          340
        ],
        "webhookId": "8da6eeda-31ec-448a-9d75-2d5dbc5f10f9",
        "parameters": {
          "textBody": "={{ $json.answer }}",
          "operation": "send",
          "phoneNumberId": "=641448739058783",
          "additionalFields": {},
          "recipientPhoneNumber": "={{ $('when message received').item.json.contacts[0].wa_id }}"
        },
        "typeVersion": 1
      },
      {
        "id": "c9d931c3-d88c-4d15-b8fe-787327c0200a",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1000,
          660
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-flash-preview-04-17-thinking"
        },
        "typeVersion": 1
      },
      {
        "id": "630ac52d-1d65-408e-b614-17a97bddab10",
        "name": "when message received",
        "type": "n8n-nodes-base.whatsAppTrigger",
        "position": [
          380,
          440
        ],
        "webhookId": "6b645b70-61db-4d4d-af47-2f39295cf196",
        "parameters": {
          "options": {},
          "updates": [
            "messages"
          ]
        },
        "credentials": {
          "whatsAppTriggerApi": {
            "id": "phjmQIV096cn2hJ9",
            "name": "WhatsApp OAuth account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "df46b528-cbbd-49c2-9b83-4402ef0c8ac7",
        "name": "Prepare Prompt",
        "type": "n8n-nodes-base.aiTransform",
        "position": [
          820,
          440
        ],
        "parameters": {
          "jsCode": "const googleDocs = $input.all().map((item) => item.json);\nconst whatsappMessages = $(\"when message received\")\n  .all()\n  .map((item) => item.json);\n\nconst date = new Date();\nconst formattedDate = `${date.getMonth() + 1} ${date.getDate()}, ${date.getFullYear()}`;\n\nconst docText = googleDocs[0].content.split(\"\\n\").join(\" \");\n\nconst body = whatsappMessages[0].messages[0].text.body;\n\nconst finalPrompt = `Today's date is: ${formattedDate}\\n\\n${docText}\\n\\nUser's question:\\n${body}`;\n\nreturn { finalPrompt };\n",
          "instructions": "Write code to:\n• Get today’s date formatted “Month Day, Year”\n• Extract the Google Doc’s plain text by joining its body.content textRuns\n• Extract the WhatsApp message from messages[0].text.body\n• Build a field finalPrompt exactly as:\n\nvbnet\nCopy\nEdit\nToday's date is: [date]\n\n[doc text]\n\nUser's question:\n[body]\n• Return finalPrompt only.",
          "codeGeneratedForPrompt": "Write code to:\n• Get today’s date formatted “Month Day, Year”\n• Extract the Google Doc’s plain text by joining its body.content textRuns\n• Extract the WhatsApp message from messages[0].text.body\n• Build a field finalPrompt exactly as:\n\nvbnet\nCopy\nEdit\nToday's date is: [date]\n\n[doc text]\n\nUser's question:\n[body]\n• Return finalPrompt only."
        },
        "typeVersion": 1
      },
      {
        "id": "19de46dc-add8-4cad-81a9-6e5b341f1f33",
        "name": "Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1640,
          440
        ],
        "parameters": {
          "columns": {
            "value": {
              "User": "={{ $('when message received').item.json.messages[0].from }}",
              "Message": "={{ $('when message received').item.json.messages[0].text.body }}",
              "Response": "={{ $('AI Agent').item.json.output }}",
              "Timestamp": "={{ $json.currentDate }}"
            },
            "schema": [
              {
                "id": "Timestamp",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Timestamp",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "User",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "User",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Message",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Message",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Response",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Response",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 5",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 5",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 6",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 6",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 7",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 7",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 8",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 8",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 9",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 9",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 10",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 10",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 11",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 11",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 12",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 12",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 13",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 13",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 14",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 14",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 15",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 15",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 16",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 16",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 17",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 17",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 18",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 18",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 19",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 19",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 20",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 20",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 21",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 21",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 22",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 22",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 23",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 23",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 24",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 24",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 25",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 25",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Column 26",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Column 26",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Timestamp"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ub8QIhGPOm1G4ylaM48iMAous1zvBO3YDl-38AKDuFw/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1Ub8QIhGPOm1G4ylaM48iMAous1zvBO3YDl-38AKDuFw",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ub8QIhGPOm1G4ylaM48iMAous1zvBO3YDl-38AKDuFw/edit?usp=drivesdk",
            "cachedResultName": "Chat Logs"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "b622392e-65dc-4d27-a5f9-d27ea57aae61",
        "name": "Date & Time",
        "type": "n8n-nodes-base.dateTime",
        "position": [
          1420,
          440
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "a6ae2118-9d68-4fb0-b975-b9c6d4170e00",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "parameters": {
          "height": 1420,
          "content": "**Smart WhatsApp AI Assistant Using Google Docs**\n\n📌 What it does:\nAnswers WhatsApp questions instantly using internal document knowledge. No training needed — just update the doc.\n\n📄 Reads a live Google Doc\n💬 Receives WhatsApp messages\n🧠 Crafts AI prompt using today's date + message + doc\n⚡ Uses OpenAI/Gemini to generate a response\n📤 Sends reply back over WhatsApp\n\n🧰 Prerequisites:\n- WhatsApp Business Cloud API account\n- Google Doc with your business content\n- OpenAI or Gemini API \nkey\n- you can setup the postgress memory using the following link:\nhttps://www.youtube.com/watch?v=JjBofKJnYIU\n\n\n🛠 Setup:\n1. Paste your Google Doc ID in the Docs node\n2. Connect WhatsApp Cloud API (Meta)\n3. Map the message field\n4. Connect OpenAI or Gemini\n5. Publish and test with a live message\n\nYou’re done!\n🤝 Need Help Setting It Up?\nIf you'd like help connecting your WhatsApp Business API, setting up Google Docs access, or customizing this AI assistant for your business or clients…\n\n📩 I offer setup, branding, and customization services:\nWhatsApp Cloud API setup & verification\n\nGoogle OAuth & Doc structure guidance\n\nAI model configuration (OpenAI / Gemini)\n\nBranding & prompt tone customization\n\nLogging, reporting, and escalation logic\n\nJust send a message via:\n\nEmail: tharwat.elsayed2000@gmail.com\n\nWhatsApp: +201061803236"
        },
        "typeVersion": 1
      },
      {
        "id": "8f4a786b-fc6d-4e2f-b8df-c605475afc81",
        "name": "company's knowledge",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          600,
          440
        ],
        "parameters": {
          "operation": "get",
          "documentURL": "=1Uv1WYCcXNlp-jaeJ7-3MNxWYfPj-wcYnJv4_colXSvk"
        },
        "typeVersion": 2
      },
      {
        "id": "a6de89dd-ada0-432c-9f8e-ece38264ad81",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          1120,
          660
        ],
        "parameters": {
          "sessionKey": "={{ $('when message received').item.json.contacts[0].wa_id }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "d9d79584-559b-4948-be55-ba2e4160a527",
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "cleanAnswer",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send Pre-approved Template Message to Reopen the Conversation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Date & Time",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Date & Time": {
        "main": [
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "cleanAnswer": {
        "main": [
          [
            {
              "node": "Send AI Agent's Answer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets": {
        "main": [
          [
            {
              "node": "24-hour window check",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Prompt": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "company's knowledge": {
        "main": [
          [
            {
              "node": "Prepare Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "24-hour window check": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "when message received": {
        "main": [
          [
            {
              "node": "company's knowledge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "c62c01f3e843893075a10f252ec7d6d69e5ab593af019f50055d506cb3081b99",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "61682ff7-397d-4ecb-a98f-91d45d5a07a1",
        "name": "Daily Trigger at 4AM",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -140,
          160
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 4
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "84a83cf9-63fc-40cf-bfa6-bc01ad67b3b7",
        "name": "Fetch Gmail Inbox Emails",
        "type": "n8n-nodes-base.gmail",
        "position": [
          80,
          160
        ],
        "webhookId": "57a7df32-d350-4e67-b106-f7b5b8b39f08",
        "parameters": {
          "filters": {
            "labelIds": "={{ [\"INBOX\"] }}",
            "receivedBefore": "={{ new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString() }}"
          },
          "operation": "getAll",
          "returnAll": true
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "T6a7nzYASeRq8gwp",
            "name": "Gmail account [abc@mail.com]"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "29939c36-30d1-499a-9c1b-9d3e4c4c9ba5",
        "name": "Split Each Email",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          300,
          160
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "id"
        },
        "typeVersion": 1
      },
      {
        "id": "316ad247-78c2-4fbb-b420-94bb8fb354f3",
        "name": "Archive Message (Remove INBOX Label)",
        "type": "n8n-nodes-base.gmail",
        "position": [
          520,
          160
        ],
        "webhookId": "44a7f451-9ebb-4a08-86b2-1c4cb8600bcc",
        "parameters": {
          "labelIds": [
            "INBOX"
          ],
          "messageId": "={{ $json.id }}",
          "operation": "removeLabels"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "T6a7nzYASeRq8gwp",
            "name": "Gmail account [abc@mail.com]"
          }
        },
        "typeVersion": 2.1
      }
    ],
    "pinData": {},
    "connections": {
      "Split Each Email": {
        "main": [
          [
            {
              "node": "Archive Message (Remove INBOX Label)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Daily Trigger at 4AM": {
        "main": [
          [
            {
              "node": "Fetch Gmail Inbox Emails",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Gmail Inbox Emails": {
        "main": [
          [
            {
              "node": "Split Each Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Archive Message (Remove INBOX Label)": {
        "main": [
          []
        ]
      }
    }
  },
  {
    "id": "nPoiePylbYZrH7kn",
    "meta": {
      "instanceId": "dd69efaf8212c74ad206700d104739d3329588a6f3f8381a46a481f34c9cc281",
      "templateCredsSetupCompleted": true
    },
    "name": "Summarize Daily Financial News Using n8n & AI – Auto Email Report",
    "tags": [],
    "nodes": [
      {
        "id": "de6a3f50-13db-4869-96c4-00efb1633b0d",
        "name": "Schedule Daily Trigger\t",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          0,
          240
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 7
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "7e60e85a-8357-4fcb-a5af-37f47caa23dc",
        "name": "Fetch Financial News Webpage\t",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "Url : https://www.ft.com/",
        "position": [
          220,
          240
        ],
        "parameters": {
          "url": "https://www.ft.com/",
          "options": {
            "timeout": 10000
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "1e4d85bf-311c-4f61-972b-bfac77d085e0",
        "name": "Delay to Ensure Page Load\t",
        "type": "n8n-nodes-base.wait",
        "position": [
          440,
          240
        ],
        "webhookId": "adff7750-f9b0-4796-915d-9c28dcc878b0",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "819d8425-cc56-4277-9b7b-c5de0794d2b0",
        "name": "Extract News Headlines & Text\t",
        "type": "n8n-nodes-base.html",
        "notes": "Extract selected headlines, editor's picks, spotlight etc.",
        "position": [
          660,
          240
        ],
        "parameters": {
          "options": {
            "cleanUpText": true
          },
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {
                "key": "Headline #1",
                "cssSelector": "#site-content > div:nth-child(1) > section > div > div > div.layout-desktop__grid.layout-desktop__grid--span4.layout-desktop__grid--column-start-1.layout-desktop__grid--row-start-1.layout-desktop__grid--with-border.layout--default > div > div > div > div.story-group-stacked__primary-story > div > div > div > div > div.primary-story__teaser"
              },
              {
                "key": "Headline #2",
                "cssSelector": "#site-content > div:nth-child(1) > section > div > div > div.layout-desktop__grid.layout-desktop__grid--span6.layout-desktop__grid--column-start-5.layout-desktop__grid--row-start-1.layout-desktop__grid--with-border.layout--default > div > div > div > div > div > div.story-group__article.story-group__article--featured > div > div.featured-story-content > div.headline.js-teaser-headline.headline--scale-5.headline--color-black > a > span"
              },
              {
                "key": "Editor's Picks",
                "cssSelector": "#site-content > div:nth-child(1) > section > div > div > div.layout-desktop__grid.layout-desktop__grid--span2.layout-desktop__grid--column-start-11.layout-desktop__grid--row-start-1.layout--default > div"
              },
              {
                "key": "Top Stories",
                "cssSelector": "#site-content > div:nth-child(3) > section > div",
                "skipSelectors": "h2"
              },
              {
                "key": "Spotlight",
                "cssSelector": "#site-content > div:nth-child(6) > section",
                "skipSelectors": "h2"
              },
              {
                "key": "Various News",
                "cssSelector": "#site-content > div:nth-child(8) > section",
                "skipSelectors": "h2"
              },
              {
                "key": "Europe News",
                "cssSelector": "#site-content > div:nth-child(13) > section",
                "skipSelectors": "h2"
              }
            ]
          }
        },
        "notesInFlow": true,
        "typeVersion": 1.2
      },
      {
        "id": "9e225c3b-1732-4d22-8a43-cab26c816865",
        "name": "Clean Extracted News Data\t",
        "type": "n8n-nodes-base.set",
        "position": [
          880,
          240
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "5412a5ee-dbbe-4fcc-98a5-6fafc37b94d1",
                "name": "All data",
                "type": "string",
                "value": "=News :\n{{ $json['Headline #1'] }}\n\n\n\nFinancial news :\n\n{{ $('Extract News Headlines & Text\t').item.json['Headline #1'] }};\n\n{{ $('Extract News Headlines & Text\t').item.json['Headline #2'] }};\n\n{{ $('Extract News Headlines & Text\t').item.json['Editor\\'s Picks'] }};\n\n{{ $('Extract News Headlines & Text\t').item.json['Top Stories'] }};\n\n{{ $('Extract News Headlines & Text\t').item.json.Spotlight }};\n\n{{ $('Extract News Headlines & Text\t').item.json['Various News'] }};\n\n{{ $('Extract News Headlines & Text\t').item.json['Europe News'] }};\n\n"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "b6a11f10-2dc4-45b9-a9fd-ba4245fa28ca",
        "name": "AI Financial News Summarizer\t",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1100,
          240
        ],
        "parameters": {
          "text": "=Summarise this news :\n\n{{ $json['All data'] }}",
          "options": {
            "systemMessage": "You are an AI financial analyst. Your role is to read, understand, and summarize key financial news from today. The goal is to provide investors with a clear and concise market overview to support better investment decisions.\n\n\nInvestor Outlook\nToday’s news points to [bullish/bearish/neutral] sentiment. Watch for [economic event/earnings report] tomorrow, which could influence market direction.\n"
          },
          "promptType": "define"
        },
        "typeVersion": 1.6
      },
      {
        "id": "04f50544-39c1-456c-ba8e-3150ae902adb",
        "name": "Email Daily Financial Summary\t",
        "type": "n8n-nodes-base.emailSend",
        "position": [
          1476,
          240
        ],
        "webhookId": "5ca3faf6-d857-4d58-8676-90e392fa9cc2",
        "parameters": {
          "text": "={{ $json.output }}",
          "options": {},
          "subject": "Today's News",
          "toEmail": "abc@gmail.com",
          "fromEmail": "xyz@gmail.com",
          "emailFormat": "text"
        },
        "credentials": {
          "smtp": {
            "id": "3QSx1pWoS0BZcK4c",
            "name": "SMTP account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "2f4dab06-5786-4ab9-8a54-0b2bc56f6c22",
        "name": "LLM Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
        "position": [
          1188,
          460
        ],
        "parameters": {
          "model": "llama3.2-16000:latest",
          "options": {}
        },
        "credentials": {
          "ollamaApi": {
            "id": "h9CEBFmYALm3FvZf",
            "name": "Ollama account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "3ac33bfa-1a93-495f-8f72-e10aba74543f",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          580,
          -180
        ],
        "parameters": {
          "color": 5,
          "width": 320,
          "height": 320,
          "content": "📌 **Try It Out!**\n\nThis workflow auto-fetches top financial headlines, cleans the content, and uses AI to summarize it into a short investor-friendly email.\n\n🧠 Ideal for: Market analysts, finance teams, or daily newsletters.\n\n**Powered by:** n8n + LLM (e.g., GPT-4 or Gemini) + Email Node.\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "bf9bf774-b70b-4fcf-9265-0ad47885effd",
    "connections": {
      "LLM Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Financial News Summarizer\t",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Daily Trigger\t": {
        "main": [
          [
            {
              "node": "Fetch Financial News Webpage\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Clean Extracted News Data\t": {
        "main": [
          [
            {
              "node": "AI Financial News Summarizer\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Delay to Ensure Page Load\t": {
        "main": [
          [
            {
              "node": "Extract News Headlines & Text\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Financial News Summarizer\t": {
        "main": [
          [
            {
              "node": "Email Daily Financial Summary\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Financial News Webpage\t": {
        "main": [
          [
            {
              "node": "Delay to Ensure Page Load\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract News Headlines & Text\t": {
        "main": [
          [
            {
              "node": "Clean Extracted News Data\t",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "xD6cGHJBF0QwUUc5",
    "meta": {
      "instanceId": "47132c409ea4cfc382a6c48656c8a35b5da4c1fa7ef892882b424c42ae8a05b2"
    },
    "name": "RSS - WhatsApp",
    "tags": [],
    "nodes": [
      {
        "id": "810a8040-2bfc-4125-9c5d-273e089a857c",
        "name": "Filter",
        "type": "n8n-nodes-base.filter",
        "position": [
          2240,
          500
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "30d4f694-9378-42b4-b1d5-cbc38fb3e7fe",
                "operator": {
                  "type": "dateTime",
                  "operation": "after"
                },
                "leftValue": "={{ $json.pubDate }}",
                "rightValue": "={{ $today.minus({ days: 1 }) }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "ffe9e174-749f-4864-8402-629e5a850961",
        "name": "Edit Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          1820,
          420
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e2ffe594-180d-4e1d-b869-8056ac67015d",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              },
              {
                "id": "87c5a171-9ab9-4043-a72a-32aec218fe63",
                "name": "pubDate",
                "type": "string",
                "value": "={{ $json.pubDate }}"
              },
              {
                "id": "978b05c9-6e6b-4a18-bc06-4de785b19413",
                "name": "conteudo",
                "type": "string",
                "value": "={{ $json['content:encoded'] }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "22d05f1c-7c65-4226-b842-e3a357994615",
        "name": "Edit Fields1",
        "type": "n8n-nodes-base.set",
        "position": [
          1820,
          620
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e2ffe594-180d-4e1d-b869-8056ac67015d",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              },
              {
                "id": "87c5a171-9ab9-4043-a72a-32aec218fe63",
                "name": "pubDate",
                "type": "string",
                "value": "={{ $json.pubDate }}"
              },
              {
                "id": "bae1b890-716b-442c-8714-b4ece09063d7",
                "name": "conteudo",
                "type": "string",
                "value": "={{ $json.contentSnippet }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "5ebcfd94-fa94-46cb-b4ff-a487af4520c2",
        "name": "Edit Fields2",
        "type": "n8n-nodes-base.set",
        "position": [
          1820,
          840
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e2ffe594-180d-4e1d-b869-8056ac67015d",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              },
              {
                "id": "87c5a171-9ab9-4043-a72a-32aec218fe63",
                "name": "pubDate",
                "type": "string",
                "value": "={{ $json.pubDate }}"
              },
              {
                "id": "978b05c9-6e6b-4a18-bc06-4de785b19413",
                "name": "conteudo",
                "type": "string",
                "value": "={{ $json.contentSnippet }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "5e2f2364-a0a0-4a93-99ec-d1c477c7e6bc",
        "name": "Edit Fields3",
        "type": "n8n-nodes-base.set",
        "position": [
          1820,
          200
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e2ffe594-180d-4e1d-b869-8056ac67015d",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              },
              {
                "id": "87c5a171-9ab9-4043-a72a-32aec218fe63",
                "name": "pubDate",
                "type": "string",
                "value": "={{ $json.pubDate }}"
              },
              {
                "id": "978b05c9-6e6b-4a18-bc06-4de785b19413",
                "name": "conteudo",
                "type": "string",
                "value": "={{ $json.content }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "a9600807-9562-4ddc-a830-b18b81daffe4",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          2040,
          480
        ],
        "parameters": {
          "numberInputs": 4
        },
        "typeVersion": 3.1
      },
      {
        "id": "39c8f94b-27ba-4676-9197-e87a493bcae6",
        "name": "OpenAI",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          2820,
          500
        ],
        "parameters": {
          "text": "=I've received news articles via RSS. Please analyze them and provide a concise summary of the top 3 to 5 main highlights. My goal is to get a quick overview of what's most relevant in these articles.\n1.{{ $json.data[0].title }}{{ $json.data[0].conteudo }}\n2.{{ $json.data[1].title }}{{ $json.data[1].conteudo }}\n3.{{ $json.data[2].title }}{{ $json.data[2].conteudo }}\n4.{{ $json.data[3].title }}{{ $json.data[3].conteudo }}\n5.{{ $json.data[4].title }}{{ $json.data[4].conteudo }}\n6.{{ $json.data[5].title }}{{ $json.data[5].conteudo }}\n7.{{ $json.data[6].title }}{{ $json.data[6].conteudo }}\n8.{{ $json.data[7].title }}{{ $json.data[7].conteudo }}\n9.{{ $json.data[8].title }}{{ $json.data[8].conteudo }}\n10.{{ $json.data[9].title }}{{ $json.data[9].conteudo }}",
          "prompt": "define",
          "options": {},
          "resource": "assistant",
          "assistantId": {
            "__rl": true,
            "mode": "list",
            "value": "asst_7Miwcww78kuTtx5rVQ7m5Nnw",
            "cachedResultName": "Linkedin"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "",
            "name": ""
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "2e096826-70ee-433c-b59b-477eec5c3905",
        "name": "Limit",
        "type": "n8n-nodes-base.limit",
        "position": [
          2440,
          500
        ],
        "parameters": {
          "maxItems": 10
        },
        "typeVersion": 1
      },
      {
        "id": "2910734f-73c3-45c5-9470-5a08868cd66e",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          2640,
          500
        ],
        "parameters": {
          "include": "specifiedFields",
          "options": {},
          "aggregate": "aggregateAllItemData",
          "fieldsToInclude": "title, pubDate, conteudo"
        },
        "typeVersion": 1
      },
      {
        "id": "fda99f10-0a33-49f3-a46b-37d61567e851",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          1260,
          520
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 3
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "1b0fa8c7-bfd8-4267-b9ac-eb3c90b2160d",
        "name": "No Operation, do nothing",
        "type": "n8n-nodes-base.noOp",
        "position": [
          3380,
          500
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "08cf9756-8407-4b9f-826d-ce21272de911",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2380,
          680
        ],
        "parameters": {
          "content": "## About Limit\nlimits the analysis to the 10 most recent articles"
        },
        "typeVersion": 1
      },
      {
        "id": "a747f665-ff17-4972-bb40-28c8251520dd",
        "name": "My RSS 01",
        "type": "n8n-nodes-base.rssFeedRead",
        "onError": "continueRegularOutput",
        "position": [
          1600,
          200
        ],
        "parameters": {
          "url": "https://uxdesign.cc/feed",
          "options": {
            "ignoreSSL": false
          }
        },
        "typeVersion": 1.1,
        "alwaysOutputData": true
      },
      {
        "id": "ce492fd5-c8f9-4074-a080-56a55fc5074d",
        "name": "My RSS 02",
        "type": "n8n-nodes-base.rssFeedRead",
        "onError": "continueRegularOutput",
        "position": [
          1600,
          420
        ],
        "parameters": {
          "url": "https://www.technologyreview.com/topic/artificial-intelligence/feed/",
          "options": {}
        },
        "typeVersion": 1.1,
        "alwaysOutputData": true
      },
      {
        "id": "1418186b-ee9a-480b-93e6-6483014a3ddf",
        "name": "My RSS 03",
        "type": "n8n-nodes-base.rssFeedRead",
        "onError": "continueRegularOutput",
        "position": [
          1600,
          620
        ],
        "parameters": {
          "url": "https://the-decoder.com/feed/",
          "options": {}
        },
        "typeVersion": 1.1,
        "alwaysOutputData": true
      },
      {
        "id": "31da3f86-a150-4cd4-83bd-57bcb348f7c3",
        "name": "My RSS 04",
        "type": "n8n-nodes-base.rssFeedRead",
        "onError": "continueRegularOutput",
        "position": [
          1600,
          840
        ],
        "parameters": {
          "url": "https://www.theverge.com/rss/index.xml",
          "options": {
            "ignoreSSL": false
          }
        },
        "typeVersion": 1.1,
        "alwaysOutputData": true
      },
      {
        "id": "a2e2bf11-d56a-470f-b183-751ff5a2d7f9",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1540,
          1000
        ],
        "parameters": {
          "content": "## About RSS\nYou can add how many RSS you want"
        },
        "typeVersion": 1
      },
      {
        "id": "90ea767f-aa1f-4475-8378-85f9b34487eb",
        "name": "Send resum to  Whatsapp",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3160,
          500
        ],
        "parameters": {
          "url": "yoururlapi.com",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "phone",
                "value": "=your phone number"
              },
              {
                "name": "message",
                "value": "={{ $json.output }}"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "2CmkjW0hZ9FO0rd3",
            "name": "Header Zapi"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "55a91be7-2fe8-45ea-9ac5-51e90a9bb2c9",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3100,
          700
        ],
        "parameters": {
          "content": "## About Resum\nyou can send to your whatsapp api, or email, drive..."
        },
        "typeVersion": 1
      },
      {
        "id": "16acc038-b6f3-4a7d-a2d9-415c4287532b",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1200,
          680
        ],
        "parameters": {
          "content": "## About Trgger\nSet trigger how you wish"
        },
        "typeVersion": 1
      },
      {
        "id": "47783f2d-e603-4325-9031-09d3eefe9fcd",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2820,
          700
        ],
        "parameters": {
          "content": "## System message (change if you want)\nI've received 10 news articles via RSS. Please analyze them and provide a concise summary of the top 3 to 5 main highlights. My goal is to get a quick overview of what's most relevant in these articles."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "a24e6662-345a-4746-913d-104bfc17c63f",
    "connections": {
      "Limit": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "Filter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter": {
        "main": [
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI": {
        "main": [
          [
            {
              "node": "Send resum to  Whatsapp",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "OpenAI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "My RSS 01": {
        "main": [
          [
            {
              "node": "Edit Fields3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "My RSS 02": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "My RSS 03": {
        "main": [
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "My RSS 04": {
        "main": [
          [
            {
              "node": "Edit Fields2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Edit Fields1": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Edit Fields2": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "Edit Fields3": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "My RSS 01",
              "type": "main",
              "index": 0
            },
            {
              "node": "My RSS 02",
              "type": "main",
              "index": 0
            },
            {
              "node": "My RSS 03",
              "type": "main",
              "index": 0
            },
            {
              "node": "My RSS 04",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send resum to  Whatsapp": {
        "main": [
          [
            {
              "node": "No Operation, do nothing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "7858a8e25b8fc4dae485c1ef345e6fe74effb1f5060433ef500b4c186c965c18"
    },
    "nodes": [
      {
        "id": "49ab7596-665e-4a0f-bb8b-9dc04525ce88",
        "name": "Gmail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2340,
          1440
        ],
        "parameters": {
          "message": "={{ $json.html }}",
          "options": {},
          "subject": "Podcast Review"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "1MUdv1HbrQUFABiZ",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "40aa23f4-69d6-46e5-84a2-b46a64a3f0af",
        "name": "TaddyTopDaily",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1620,
          820
        ],
        "parameters": {
          "url": "https://api.taddy.org/",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "query",
                "value": "=query {   getTopChartsByGenres(          limitPerPage:10,     filterByCountry:UNITED_STATES_OF_AMERICA,     taddyType:PODCASTEPISODE,      genres:PODCASTSERIES_{{ $json.genre }}){     topChartsId      podcastEpisodes{       uuid       name audioUrl      podcastSeries{         uuid         name       }     }   } }"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "X-USER-ID"
              },
              {
                "name": "X-API-KEY"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "42eea23b-b09c-49ee-af5b-12abb3960390",
        "name": "Genre",
        "type": "n8n-nodes-base.set",
        "position": [
          1420,
          820
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e995cd5b-b91c-4a9d-8215-44d7dfe3f52f",
                "name": "genre",
                "type": "string",
                "value": "TECHNOLOGY"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "da256fbf-ed7b-4a26-9fa8-33d1c2b717a5",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1840,
          820
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "data.getTopChartsByGenres.podcastEpisodes"
        },
        "typeVersion": 1
      },
      {
        "id": "069ab68c-dcd6-406f-8e7f-2597f62a04f5",
        "name": "Whisper Transcribe Audio",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1880,
          1120
        ],
        "parameters": {
          "url": "https://api.openai.com/v1/audio/transcriptions",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "predefinedCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "model",
                "value": "whisper-1"
              },
              {
                "name": "file",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          },
          "nodeCredentialType": "openAiApi"
        },
        "credentials": {
          "openAiApi": {
            "id": "tTOOlpAaNT3QoKbQ",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "ffa67b8d-8601-4e1d-8f72-b6266e6b3327",
        "name": "Final Data",
        "type": "n8n-nodes-base.set",
        "position": [
          2320,
          1120
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "={\n\"podcast\": \"{{ $('TaddyTopDaily').item.json.data.getTopChartsByGenres.podcastEpisodes[$itemIndex].podcastSeries.name }}\",\n\"name\": \"{{ $('TaddyTopDaily').item.json.data.getTopChartsByGenres.podcastEpisodes[$itemIndex].name.replace(/\\\"/g,'\\\"') }}\",\n \"url\":\"{{ $('TaddyTopDaily').item.json.data.getTopChartsByGenres.podcastEpisodes[$itemIndex].audioUrl.replace(/\"/g,'') }}\",\n\"summary\":\"{{ $json.message.content.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"').replace(/\\n/g, '<br/>').replace(/\\r/g, '\\\\r').replace(/\\t/g, '\\\\t') }}\"\n  \n}\n"
        },
        "typeVersion": 3.4
      },
      {
        "id": "88cd1fa5-07ae-4dcd-b4f8-85cbf7c98d73",
        "name": "Merge Results",
        "type": "n8n-nodes-base.code",
        "position": [
          1900,
          1440
        ],
        "parameters": {
          "jsCode": "return [{fields:$input.all().map(x=>x.json)}]"
        },
        "typeVersion": 2
      },
      {
        "id": "4c2c80d1-750f-42f1-a0f1-343dec325b0f",
        "name": "HTML",
        "type": "n8n-nodes-base.html",
        "position": [
          2120,
          1440
        ],
        "parameters": {
          "html": "<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\" />\n</head>\n<body>\n  <table>\n    <tr> \n      {{ ['Podcast', 'Episode', 'Summary'].map(propname=>'<td><h4>'+propname+'</h4></td>').join('')  }}\n    </tr>\n    {{ $json.fields.map(ep=>{ return `<tr><td>${ep.podcast}</td><td><a href=\"${ep.url}\">${ep.name}</a></td><td>${ep.summary}</td><td></td></tr>`} ) }}\n  </table>\n</body>\n</html>\n\n<style>\ntr { \n     border: 1px solid #000;    \n     padding: 8px;   \n }\n.container {\n  background-color: #ffffff;\n  text-align: center;\n  padding: 16px;\n  border-radius: 8px;\n}\n\nh1 {\n  color: #ff6d5a;\n  font-size: 24px;\n  font-weight: bold;\n  padding: 8px;\n}\n\nh2 {\n  color: #909399;\n  font-size: 18px;\n  font-weight: bold;\n  padding: 8px;\n}\n</style>\n"
        },
        "executeOnce": true,
        "typeVersion": 1.2
      },
      {
        "id": "f1d13556-2c3a-48e5-84a1-5b82f338c6ba",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          340,
          760
        ],
        "parameters": {
          "color": 4,
          "width": 547.952991050529,
          "height": 683.5200847858991,
          "content": "## Daily Podcast Summary\n### This workflow will summarize the content in the day's top podcasts for a certain genre, then send you the podcasts with summaries by email\n\n## Setup:\n 1. Create a free API key on Taddy here: https://taddy.org/signup/developers\n 2. Input your user number and API key into the `TaddyTopDaily` node in the header parameters X-USER-ID and X-API-KEY respectively.\n 3. Create access credentials for your Gmail as described here: https://developers.google.com/workspace/guides/create-credentials. Use the credentials from your *client_secret.json* in the `Gmail` node.\n 4. In the `Genre` node, set the genre of podcasts you want a summary for. Valid values are: TECHNOLOGY, NEWS, ARTS, COMEDY, SPORTS, FICTION, etc. Look at api.taddy.org for the full list (they will be displayed in the help docs as PODCASTSERIES_TECHNOLOGY, PODCASTSERIES_NEWS, etc.)\n 5. Enter your email address in the `Gmail` node.\n 6. Change the schedule time for sending email from `Schedule` to whichever time you want to receive the email.\n \n\n## Test:\n- Link a `Test Workflow` node in place of the `Schedule` node.\n- Hit Test Workflow.\n- Check your email for the results."
        },
        "typeVersion": 1
      },
      {
        "id": "5aee7279-349e-47cd-99dc-7a32677b5a20",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1820,
          1060
        ],
        "parameters": {
          "width": 651.4454343326669,
          "height": 252.64899257060446,
          "content": "### Whisper transcribes and Open AI summarizes the podcast"
        },
        "typeVersion": 1
      },
      {
        "id": "f8b4a203-b27f-4a11-90ef-a7e1561219f5",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1100,
          760
        ],
        "parameters": {
          "width": 1189.7320416038633,
          "height": 249.2202456997519,
          "content": "### Get daily list of top podcasts (according to Apple charts) and download audio, then crop for OpenAI"
        },
        "typeVersion": 1
      },
      {
        "id": "7045c9c8-5509-4dc0-b167-ddd4d6c90c22",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1825,
          1384
        ],
        "parameters": {
          "width": 645.0210885124873,
          "height": 227.94126205257731,
          "content": "### Finally, send the email!"
        },
        "typeVersion": 1
      },
      {
        "id": "8dc9583b-cec3-4ac0-a74a-329f6c3b4801",
        "name": "Summarize Podcast",
        "type": "n8n-nodes-base.openAi",
        "position": [
          2140,
          1120
        ],
        "parameters": {
          "model": "gpt-4o-mini",
          "prompt": {
            "messages": [
              {
                "content": "=Summarize the major points of the following podcast: {{ $json.text }}. Start your answer by saying 'This episode focuses on', 'This episode is about', etc. Contain your answer to 3-4 paragraphs max, and focus on only key information. "
              }
            ]
          },
          "options": {
            "maxTokens": 500
          },
          "resource": "chat",
          "requestOptions": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "tTOOlpAaNT3QoKbQ",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e8d122f1-29f9-41ca-9c6b-b72269686fd6",
        "name": "Schedule",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          1220,
          820
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 8
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "67bc7a5b-8d0a-4de4-918d-410551dad4d7",
        "name": "Request Audio Crop",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1000,
          1220
        ],
        "parameters": {
          "url": "https://api.products.aspose.app/audio/cutter/api/cutter",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "1",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              },
              {
                "name": "convertOption",
                "value": "{\"startTime\":\"00:08:00\",\"endTime\":\"00:24:00\",\"audioFormat\":\"mp3\"}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Accept",
                "value": "*/*("
              },
              {
                "name": "Connection",
                "value": "keep-alive"
              },
              {
                "name": "Origin",
                "value": "https://products.aspose.app"
              },
              {
                "name": "Referer",
                "value": "https://products.aspose.app"
              },
              {
                "name": "Sec-Fetch-Dest",
                "value": "empty"
              },
              {
                "name": "Sec-Fetch-Mode",
                "value": "cors"
              },
              {
                "name": "Sec-Fetch-Site",
                "value": "same-site"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "0dc62507-3fea-45d7-a0dc-e92fb8e2600f",
        "name": "Get Download Link",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1200,
          1220
        ],
        "parameters": {
          "url": "=https://api.products.aspose.app/audio/cutter/api/cutter/HandleStatus?fileRequestId={{ $('Request Audio Crop').item.json.Data.FileRequestId }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Accept",
                "value": "application/json, text/javascript, */*; q=0.01"
              },
              {
                "name": "Connection",
                "value": "keep-alive"
              },
              {
                "name": "Origin",
                "value": "https://products.aspose.app"
              },
              {
                "name": "Referer",
                "value": "https://products.aspose.app"
              },
              {
                "name": "Sec-Fetch-Dest",
                "value": "empty"
              },
              {
                "name": "Sec-Fetch-Dest",
                "value": "cors"
              },
              {
                "name": "Sec-Fetch-Dest",
                "value": "same-site"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "8aa65189-2a4b-4ac4-9915-45ccd679a5da",
        "name": "Download Cut MP3",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1660,
          1140
        ],
        "parameters": {
          "url": "={{ $json.Data.DownloadLink }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "4e7318df-dbaa-4d9f-858d-4455ead763c1",
        "name": "Download Podcast",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2060,
          820
        ],
        "parameters": {
          "url": "={{ $json.audioUrl }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "ab4601c6-7387-4f2f-a2f3-4256f88c0b3e",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          1600,
          1360
        ],
        "webhookId": "bc28bc57-d9ea-430e-88db-78d088a058cb",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "a0b300b9-aaad-48f1-8319-a03700e0d298",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          920,
          1100
        ],
        "parameters": {
          "width": 898.7483569555845,
          "height": 387.3779915472271,
          "content": "### Crop the podcast down before analysis"
        },
        "typeVersion": 1
      },
      {
        "id": "34ca89fe-4ed1-491f-b3b9-32e97040959b",
        "name": "If Downloads Ready",
        "type": "n8n-nodes-base.if",
        "position": [
          1380,
          1180
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "49440938-0cb3-41c8-bcab-b7ad96973f77",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $input.all().map(x=>x.json.Data.DownloadLink).reduce((accumulator, currentValue) => accumulator && currentValue, true)\n}}",
                "rightValue": ""
              }
            ]
          },
          "looseTypeValidation": true
        },
        "typeVersion": 2.1
      }
    ],
    "pinData": {},
    "connections": {
      "HTML": {
        "main": [
          [
            {
              "node": "Gmail",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Get Download Link",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Genre": {
        "main": [
          [
            {
              "node": "TaddyTopDaily",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule": {
        "main": [
          [
            {
              "node": "Genre",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Download Podcast",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Final Data": {
        "main": [
          [
            {
              "node": "Merge Results",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge Results": {
        "main": [
          [
            {
              "node": "HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "TaddyTopDaily": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Cut MP3": {
        "main": [
          [
            {
              "node": "Whisper Transcribe Audio",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Podcast": {
        "main": [
          [
            {
              "node": "Request Audio Crop",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Download Link": {
        "main": [
          [
            {
              "node": "If Downloads Ready",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Summarize Podcast": {
        "main": [
          [
            {
              "node": "Final Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If Downloads Ready": {
        "main": [
          [
            {
              "node": "Download Cut MP3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Request Audio Crop": {
        "main": [
          [
            {
              "node": "Get Download Link",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Whisper Transcribe Audio": {
        "main": [
          [
            {
              "node": "Summarize Podcast",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "nodes": [
      {
        "id": "c17e444e-0a5e-4bfe-8de6-c3185de4465d",
        "name": "Grants to List",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -240,
          -180
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "oppHits"
        },
        "typeVersion": 1
      },
      {
        "id": "9251d39c-6098-42fa-aadd-3a22464dee64",
        "name": "Get Grant Details",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          280,
          -280
        ],
        "parameters": {
          "url": "https://apply07.grants.gov/grantsws/rest/opportunity/details",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "form-urlencoded",
          "bodyParameters": {
            "parameters": [
              {
                "name": "oppId",
                "value": "={{ $json.id }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "ade994d6-a1f8-45bf-a82e-83eb38da08d6",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          440,
          -120
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4d81b20e-0038-48d3-840c-3fcf8b798a0d",
        "name": "Summarize Synopsis",
        "type": "@n8n/n8n-nodes-langchain.informationExtractor",
        "position": [
          460,
          -280
        ],
        "parameters": {
          "text": "=Agency: {{ $json.synopsis.agencyName }}\nTitle: {{ $json.opportunityTitle }}\nSynopsis: {{ $json.synopsis.synopsisDesc }}",
          "options": {
            "systemPromptTemplate": "You've been given a grant opportunity listing. Help summarize the opportunity in simple terms."
          },
          "schemaType": "manual",
          "inputSchema": "{\n\t\"type\": \"object\",\n\t\"properties\": {\n        \"goal\": { \"type\": [\"string\", \"null\"] },\n        \"duration\": { \"type\": \"string\" },\n        \"success_criteria\": {\n          \"type\": \"array\",\n          \"items\": { \"type\": \"string\" }\n        },\n        \"good_to_know\": {\n\t\t  \"type\": \"array\",\n          \"items\": { \"type\": \"string\" }\n        }\n\t}\n}"
        },
        "typeVersion": 1
      },
      {
        "id": "71e1a2e9-6690-4247-aae3-f5bd61019553",
        "name": "Eligibility Factors",
        "type": "@n8n/n8n-nodes-langchain.informationExtractor",
        "position": [
          640,
          -120
        ],
        "parameters": {
          "text": "=Agency: {{  $json.synopsis.agencyName }}\nTitle: {{ $json.opportunityTitle }}\nSynopsis: {{ $json.synopsis.synopsisDesc }}\nEligibility: {{ $json.synopsis.applicantEligibilityDesc }}",
          "options": {
            "systemPromptTemplate": "Help determine if we are eligible for this grant.\n\nWe are AI Consultants Limited (“Company”) and are the controllers of your personal data. Our registered office is Unit 29, Intelligent Park, Milton Road, Cambridge Cambridgeshire CB9 RDW, and our registered company number is 1234567.\n\nWe are part of a group of companies which provides consultancy services across the globe. Our other group companies are:\n\nAI Consultants Inc. of 2 Drydock Avenue, Suite 1210, Boston, MA 02210, USA\nAI Consultants (Singapore) Pte Ltd of 300 Beach Road, Singapore 199555\nAI Consultants Japan Inc, of 3-1-3 Minamiaoyama, Minato-ku, Tokyo, 107-0062\nIn the UK we are registered with the Information Commissioner’s Office under registration number Z9888888.\n\nIn the US we are registered with the Data Privacy Framework Program (DPF). To view the Company’s certification, please visit https://www.dataprivacyframework.gov/list.\n\nWe are a leading, worldwide product development service provider. We specialise in design engineering services, professional technical services and product technical support services (“Services”).\n\nAs the deep tech powerhouse of Capgemini, CC spearheads transformative projects to solve the toughest scientific and engineering challenges. Ambitious clients collaborate with us to create new-to-the-world technologies, services and products that have never been seen before. Our unique combination of technical, commercial and market expertise yields market-leading solutions that are hard to copy. This creates valuable intellectual property that generates protectable long-term value.\n\nWe work with some of the world’s biggest brands and most ambitious technology start-up ventures across a wide range of markets. From aerospace to agritech, consumer to industry, communications to healthcare, our knowledge of one sector can often be applied to another to create new breakthroughs. We focus on our clients’ success and we are trusted as integral partners in the future of their businesses.\n\nWe do important, difficult, radical and impactful things that benefit society. We helped develop the world's first 24/7 wrist-worn activity monitor, wireless pacemaker and wireless patient monitor, as well as the first connected drug inhaler. Our work led to the most densely packed cellular network in the world – orchestrating swarms of bots across highly automated warehouses. It produced the Bluetooth chip that connects your phone to your car and the latest satellite technology that lets people in remote locations across the world keep in touch."
          },
          "schemaType": "manual",
          "inputSchema": "{\n\t\"type\": \"object\",\n\t\"properties\": {\n\t\t\"eligibility_matches\": {\n\t\t  \"type\": \"array\",\n          \"items\": { \"type\": \"string\" }\n        }\n\t}\n}"
        },
        "typeVersion": 1
      },
      {
        "id": "d741ef63-dcf3-452d-978c-8cbc27f55a33",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          600,
          20
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "7354ed6d-50f5-4234-90d8-2d9d0c7eccd4",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          1000,
          -120
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "2dffda98-18c6-4c7b-8fc3-0e6539642ea2",
        "name": "Save to Tracker",
        "type": "n8n-nodes-base.airtable",
        "position": [
          1420,
          -20
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appiNoPRvhJxz9crl",
            "cachedResultUrl": "https://airtable.com/appiNoPRvhJxz9crl",
            "cachedResultName": "US Grants.gov Tracker"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblX93C9MNzizhibd",
            "cachedResultUrl": "https://airtable.com/appiNoPRvhJxz9crl/tblX93C9MNzizhibd",
            "cachedResultName": "Table 1"
          },
          "columns": {
            "value": {
              "URL": "=https://grants.gov/search-results-detail/{{ $('Get Grant Details').item.json.id }}",
              "Goal": "={{ $json.output.goal }}",
              "Notes": "={{ $json.output.good_to_know.join('\\n') }}",
              "Title": "={{ $('Get Grant Details').item.json.opportunityTitle }}",
              "Agency": "={{ $('Get Grant Details').item.json.synopsis.agencyContactName }}",
              "Status": "New",
              "Funding": "={{ $('Get Grant Details').item.json.synopsis.estimatedFunding }}",
              "Duration": "={{ $json.output.duration }}",
              "Award Floor": "={{ $('Get Grant Details').item.json.synopsis.awardFloor }}",
              "Posted Date": "={{ $('Get Grant Details').item.json.synopsis.postingDate }}",
              "Agency Email": "={{ $('Get Grant Details').item.json.synopsis.agencyContactEmail }}",
              "Agency Phone": "={{ $('Get Grant Details').item.json.synopsis.agencyContactPhone }}",
              "Eligibility?": "={{ $json.output.eligibility_matches.length > 0 ? 'Yes' : 'No' }}",
              "Award Ceiling": "={{ $('Get Grant Details').item.json.synopsis.awardCeiling }}",
              "Response Date": "={{ $('Get Grant Details').item.json.synopsis.responseDate }}",
              "Success Criteria": "={{ $json.output.success_criteria.join('\\n') }}",
              "Eligibility Notes": "={{ $json.output.eligibility_matches.join('\\n') }}",
              "Opportunity Number": "={{ $('Get Grant Details').item.json.opportunityNumber }}"
            },
            "schema": [
              {
                "id": "Opportunity Number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Opportunity Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Status",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "New",
                    "value": "New"
                  },
                  {
                    "name": "Under Review",
                    "value": "Under Review"
                  },
                  {
                    "name": "Interested",
                    "value": "Interested"
                  },
                  {
                    "name": "Not Interested",
                    "value": "Not Interested"
                  }
                ],
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Title",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Goal",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Goal",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Success Criteria",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Success Criteria",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Notes",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Notes",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Eligibility?",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "Yes",
                    "value": "Yes"
                  },
                  {
                    "name": "No",
                    "value": "No"
                  }
                ],
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Eligibility?",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Eligibility Notes",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Eligibility Notes",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Duration",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Duration",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Agency",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Agency",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Agency Email",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Agency Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Agency Phone",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Agency Phone",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Posted Date",
                "type": "dateTime",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Posted Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Response Date",
                "type": "dateTime",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Response Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Funding",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Funding",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Award Ceiling",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Award Ceiling",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Award Floor",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Award Floor",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": []
          },
          "options": {},
          "operation": "create"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Und0frCQ6SNVX3VV",
            "name": "Airtable Personal Access Token account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "f0712788-b801-4070-a5c2-2f7ed620588e",
        "name": "Only New Grants",
        "type": "n8n-nodes-base.removeDuplicates",
        "position": [
          -60,
          -180
        ],
        "parameters": {
          "options": {},
          "operation": "removeItemsSeenInPreviousExecutions",
          "dedupeValue": "={{ $json.id }}"
        },
        "typeVersion": 2
      },
      {
        "id": "fb4ac14d-0bdd-40f7-9b31-3a23450b1f0b",
        "name": "AI Grants since Yesterday",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -420,
          -180
        ],
        "parameters": {
          "url": "https://apply07.grants.gov/grantsws/rest/opportunities/search",
          "method": "POST",
          "options": {},
          "jsonBody": "{\n  \"keyword\": \"ai\",\n  \"cfda\": null,\n  \"agencies\": null,\n  \"sortBy\": \"openDate|desc\",\n  \"rows\": 5000,\n  \"eligibilities\": null,\n  \"fundingCategories\": null,\n  \"fundingInstruments\": null,\n  \"dateRange\": \"1\",\n  \"oppStatuses\": \"forecasted|posted\"\n}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.2
      },
      {
        "id": "0446c882-764a-4c94-8c49-f368c50586a0",
        "name": "Get New Eligible Grants Today",
        "type": "n8n-nodes-base.airtable",
        "position": [
          -400,
          500
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appiNoPRvhJxz9crl",
            "cachedResultUrl": "https://airtable.com/appiNoPRvhJxz9crl",
            "cachedResultName": "US Grants.gov Tracker"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblX93C9MNzizhibd",
            "cachedResultUrl": "https://airtable.com/appiNoPRvhJxz9crl/tblX93C9MNzizhibd",
            "cachedResultName": "Table 1"
          },
          "options": {},
          "operation": "search",
          "filterByFormula": "=AND(\n  {Status} = 'New',\n  {Eligibility?} = 'Yes',\n  IS_SAME(DATETIME_FORMAT(Created, 'YYYY-MM-DD'), DATETIME_FORMAT(TODAY(), 'YYYY-MM-DD'))\n)"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Und0frCQ6SNVX3VV",
            "name": "Airtable Personal Access Token account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "70bca43a-d00e-4ee6-828a-9926ba1d8fdb",
        "name": "Generate Email",
        "type": "n8n-nodes-base.html",
        "position": [
          -160,
          500
        ],
        "parameters": {
          "html": "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional //EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n<head>\n<!--[if gte mso 9]>\n<xml>\n  <o:OfficeDocumentSettings>\n    <o:AllowPNG/>\n    <o:PixelsPerInch>96</o:PixelsPerInch>\n  </o:OfficeDocumentSettings>\n</xml>\n<![endif]-->\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <meta name=\"x-apple-disable-message-reformatting\">\n  <!--[if !mso]><!--><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"><!--<![endif]-->\n  <title></title>\n  \n    <style type=\"text/css\">\n      @media only screen and (min-width: 520px) {\n  .u-row {\n    width: 500px !important;\n  }\n  .u-row .u-col {\n    vertical-align: top;\n  }\n\n  .u-row .u-col-100 {\n    width: 500px !important;\n  }\n\n}\n\n@media (max-width: 520px) {\n  .u-row-container {\n    max-width: 100% !important;\n    padding-left: 0px !important;\n    padding-right: 0px !important;\n  }\n  .u-row .u-col {\n    min-width: 320px !important;\n    max-width: 100% !important;\n    display: block !important;\n  }\n  .u-row {\n    width: 100% !important;\n  }\n  .u-col {\n    width: 100% !important;\n  }\n  .u-col > div {\n    margin: 0 auto;\n  }\n}\nbody {\n  margin: 0;\n  padding: 0;\n}\n\ntable,\ntr,\ntd {\n  vertical-align: top;\n  border-collapse: collapse;\n}\n\np {\n  margin: 0;\n}\n\n.ie-container table,\n.mso-container table {\n  table-layout: fixed;\n}\n\n* {\n  line-height: inherit;\n}\n\na[x-apple-data-detectors='true'] {\n  color: inherit !important;\n  text-decoration: none !important;\n}\n\ntable, td { color: #000000; } </style>\n  \n  \n\n</head>\n\n<body class=\"clean-body u_body\" style=\"margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color: #F7F8F9;color: #000000\">\n  <!--[if IE]><div class=\"ie-container\"><![endif]-->\n  <!--[if mso]><div class=\"mso-container\"><![endif]-->\n  <table style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;mso-table-lspace: 0pt;mso-table-rspace: 0pt;vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #F7F8F9;width:100%\" cellpadding=\"0\" cellspacing=\"0\">\n  <tbody>\n  <tr style=\"vertical-align: top\">\n    <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\n    <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td align=\"center\" style=\"background-color: #F7F8F9;\"><![endif]-->\n    \n  \n  \n<div class=\"u-row-container\" style=\"padding: 0px;background-color: #f7f8f9\">\n  <div class=\"u-row\" style=\"margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: #ffffff;\">\n    <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n      <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: #f7f8f9;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:500px;\"><tr style=\"background-color: #ffffff;\"><![endif]-->\n      \n<!--[if (mso)|(IE)]><td align=\"center\" width=\"500\" style=\"background-color: #f7f8f9;width: 500px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\" valign=\"top\"><![endif]-->\n<div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 500px;display: table-cell;vertical-align: top;\">\n  <div style=\"background-color: #f7f8f9;height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\n  <!--[if (!mso)&(!IE)]><!--><div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\"><!--<![endif]-->\n  \n<table style=\"font-family:arial,helvetica,sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n  <tbody>\n    <tr>\n      <td style=\"overflow-wrap:break-word;word-break:break-word;padding:32px 10px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\n        \n  <!--[if mso]><table width=\"100%\"><tr><td><![endif]-->\n    <h1 style=\"margin: 0px; line-height: 140%; text-align: center; word-wrap: break-word; font-family: arial black,AvenirNext-Heavy,avant garde,arial; font-size: 22px; font-weight: 400;\"><span><span><span><span><span><span>Latest AI Grants</span></span></span></span></span></span></h1>\n  <!--[if mso]></td></tr></table><![endif]-->\n\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->\n  </div>\n</div>\n<!--[if (mso)|(IE)]></td><![endif]-->\n      <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n    </div>\n  </div>\n  </div>\n  \n\n\n  \n  \n<div class=\"u-row-container\" style=\"padding: 0px;background-color: #f7f8f9\">\n  <div class=\"u-row\" style=\"margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\">\n    <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n      <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: #f7f8f9;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:500px;\"><tr style=\"background-color: transparent;\"><![endif]-->\n      \n<!--[if (mso)|(IE)]><td align=\"center\" width=\"500\" style=\"background-color: #ffffff;width: 500px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\" valign=\"top\"><![endif]-->\n<div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 500px;display: table-cell;vertical-align: top;\">\n  <div style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\n  <!--[if (!mso)&(!IE)]><!--><div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\"><!--<![endif]-->\n  \n<table style=\"font-family:arial,helvetica,sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n  <tbody>\n    <tr>\n      <td style=\"overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\n{{\n$input.all().map((input,idx) => {\nreturn `\n  <div>\n    <div style=\"padding-top:14px;padding-bottom:24px\">\n  <h3 style=\"margin-top:0;margin-bottom:7px;font-size:16px\">\n    ${idx+1}. ${input.json.Title}\n  </h3>\n  <div style=\"margin-bottom:14px;font-size:12px;\">\n        <strong>${input.json.Agency}</strong>\n        &middot;\n        <a href=\"${input.json.URL}\">See details</a>\n  </div>\n  <p style=\"margin-bottom:14px;font-size:14px\">\n        <strong>Synopsis:</strong> ${input.json.Goal}\n  </p>\n  <ul style=\"font-size:14px;\">\n        ${input.json['Success Criteria']\n          .split('\\n')\n          .map(text => `<li>${text}</li>`)\n          .join('')\n        }\n  </ul>\n  <div style=\"font-size:12px;\">\n    <strong>Posted By</strong> ${input.json['Posted Date']\n      .toDateTime()\n      .format('EEE, dd MMM yyyy t')}\n    <br/>\n    <strong>Respond By</strong> ${input.json['Response Date']\n          .toDateTime()\n          .format('EEE, dd MMM yyyy t')}\n    \n  </div>\n</div> \n`\n}).join('<hr/>')\n}}        \n      </td>\n    </tr>\n  </tbody>\n</table>\n\n  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->\n  </div>\n</div>\n<!--[if (mso)|(IE)]></td><![endif]-->\n      <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n    </div>\n  </div>\n  </div>\n  \n\n\n  \n  \n<div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\n  <div class=\"u-row\" style=\"margin: 0 auto;min-width: 320px;max-width: 500px;overflow-wrap: break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\">\n    <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\n      <!--[if (mso)|(IE)]><table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\"><tr><td style=\"padding: 0px;background-color: transparent;\" align=\"center\"><table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"width:500px;\"><tr style=\"background-color: transparent;\"><![endif]-->\n      \n<!--[if (mso)|(IE)]><td align=\"center\" width=\"500\" style=\"width: 500px;padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\" valign=\"top\"><![endif]-->\n<div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 500px;display: table-cell;vertical-align: top;\">\n  <div style=\"height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\n  <!--[if (!mso)&(!IE)]><!--><div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\"><!--<![endif]-->\n  \n<table style=\"font-family:arial,helvetica,sans-serif;\" role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\n  <tbody>\n    <tr>\n      <td style=\"overflow-wrap:break-word;word-break:break-word;padding:24px 10px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\n        \n  <div style=\"font-size: 14px; color: #7e8c8d; line-height: 140%; text-align: center; word-wrap: break-word;\">\n    <p style=\"line-height: 140%;\">Autogenerated by n8n.</p>\n<p style=\"line-height: 140%;\">Brought to you by workflow #{{ $workflow.id }}</p>\n  </div>\n\n      </td>\n    </tr>\n  </tbody>\n</table>\n\n  <!--[if (!mso)&(!IE)]><!--></div><!--<![endif]-->\n  </div>\n</div>\n<!--[if (mso)|(IE)]></td><![endif]-->\n      <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\n    </div>\n  </div>\n  </div>\n  \n\n\n    <!--[if (mso)|(IE)]></td></tr></table><![endif]-->\n    </td>\n  </tr>\n  </tbody>\n  </table>\n  <!--[if mso]></div><![endif]-->\n  <!--[if IE]></div><![endif]-->\n</body>\n\n</html>\n"
        },
        "executeOnce": true,
        "typeVersion": 1.2
      },
      {
        "id": "12bd72f5-3028-4572-b59e-1cc143e44a86",
        "name": "Everyday @ 9am",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -720,
          460
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 8
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ca62c507-bce5-4a63-be0e-e60591408668",
        "name": "Everyday @ 8.30am",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -720,
          -220
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 8,
                "triggerAtMinute": 30
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "032bec7e-5aff-4103-b81e-e5bc4a88ddde",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -540,
          -420
        ],
        "parameters": {
          "color": 7,
          "width": 700,
          "height": 480,
          "content": "## 1. Fetch Latest AI Grants, Ignore Those Already Seen\n[Learn more about the Remove Duplicates node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.removeduplicates/)\n\nA cool feature of n8n's remove duplicates node is that it works across executions. What this means for this template is that the node will help us keep track of grant IDs to know if we've already processed them and if so, filter them out so we won't have duplicate alerts."
        },
        "typeVersion": 1
      },
      {
        "id": "07147665-3571-4512-adce-2727dcb95240",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          180,
          -520
        ],
        "parameters": {
          "color": 7,
          "width": 1000,
          "height": 720,
          "content": "## 2. Quickly Determine Eligibility Using AI\n[Learn more about the Information Extractor node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.information-extractor/)\n\nQualifying Leads requires a lot of contextual reasoning taking into account many factors such as commercials, location and eligibility criteria. Whilst it's not guaranteed AI can or will solve this for your particular requirements, it can however get you a good distance of the way there!\n\nAI in this template intends to reduce time (and therefore cost) for a team member needs to spend per grant listing or increase their coverage of grants which they would otherwise miss due to capacity."
        },
        "typeVersion": 1
      },
      {
        "id": "f4758b4d-727a-4ce8-b071-3388eb16b219",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1200,
          -280
        ],
        "parameters": {
          "color": 7,
          "width": 520,
          "height": 480,
          "content": "## 3. Save Results to Grant Tracker\n[Learn more about the Airtable Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.airtable/)\n\nIn n8n, it's easy to send your data anywhere to manage yourself, share with your team or reuse with other workflows. Here for demonstration purposes, we'll just store each grant as a row in our Airtable database.\n\nCheck out the sample Airtable here: https://airtable.com/appiNoPRvhJxz9crl/shrRdP6zstgsxjDKL"
        },
        "typeVersion": 1
      },
      {
        "id": "a7861a21-021f-4629-b863-2163c7436d13",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -540,
          240
        ],
        "parameters": {
          "color": 7,
          "width": 620,
          "height": 500,
          "content": "## 4. Generate Latest AI Grants Alert Email\n[Learn more about the HTML Template node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.html/)\n\nUsing our freshly collected AI grants, it would be nice if we can share them with our team members via email. A nicely formatted email digest can be generated using the HTML template node, with added links for greater impact.\n\nHere in this demonstration, we will loop through all eligible new grants and compile them into a newsletter format using the HTML node.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "4d09af53-92cb-4288-86d7-dcf695bfb358",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          100,
          240
        ],
        "parameters": {
          "color": 7,
          "width": 640,
          "height": 500,
          "content": "## 5. Send to a list of Subscribers\n[Learn more about the Gmail node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.gmail/)\n\nFinally, we can source a list of subscribers to send our generated email newsletter.\n\nHere, our subscriber list is another table alongside our grants table that we can import that list using the Airtable node. You can use any email provider that supports HTML but for this demonstration, we're using Gmail for simplicity sake."
        },
        "typeVersion": 1
      },
      {
        "id": "784d59f3-5b1f-4404-bc04-4bd58cf03585",
        "name": "Get Subscribers",
        "type": "n8n-nodes-base.airtable",
        "position": [
          240,
          500
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appiNoPRvhJxz9crl",
            "cachedResultUrl": "https://airtable.com/appiNoPRvhJxz9crl",
            "cachedResultName": "US Grants.gov Tracker"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblaS91hyhguntfaC",
            "cachedResultUrl": "https://airtable.com/appiNoPRvhJxz9crl/tblaS91hyhguntfaC",
            "cachedResultName": "Subscribers"
          },
          "options": {},
          "operation": "search",
          "filterByFormula": "AND({Status} = 'Active')"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Und0frCQ6SNVX3VV",
            "name": "Airtable Personal Access Token account"
          }
        },
        "executeOnce": true,
        "typeVersion": 2.1
      },
      {
        "id": "3be0788b-90ef-4648-aa25-1170208a685d",
        "name": "Send Subscriber Email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          480,
          500
        ],
        "webhookId": "37eeec7a-1982-4137-8473-313bfb6c5b42",
        "parameters": {
          "sendTo": "={{ $json.Email }}",
          "message": "={{ $('Generate Email').first().json.html }}",
          "options": {},
          "subject": "Daily Newletter for Intersting US Grants"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "14a65482-b314-4a2f-9ce3-87e3aae126f9",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1280,
          300
        ],
        "parameters": {
          "color": 7,
          "width": 460,
          "height": 200,
          "content": "## Scheduled Triggers\n[Learn more about Scheduled Triggers](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.scheduletrigger)\n\nScheduled triggers are a great way to run this template automatically in the morning ready for your team before they start their working day.\n\nFeel free to adjust the interval to a time which suits you!"
        },
        "typeVersion": 1
      },
      {
        "id": "b172eb7a-58bc-4d4a-be22-796d34a59897",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1280,
          -620
        ],
        "parameters": {
          "width": 460,
          "height": 900,
          "content": "## Try It Out!\n\n### This n8n templates demonstrates how to automatically ingest a source of leads at regular intervals and take advantage of n8n's remove duplicates node to simplify duplicate detection.\nAdditionally after the leads are captured, a simple alerts notification can be generated and shared with team members.\n\n### How it works\n* A scheduled trigger is set to fetch a list of AI grants listed on the grants.gov website in the past day.\n* A Remove Duplicates node is used to track Grant IDs to filter out those already processed by the workflow.\n* New grants are summarized and analysed by AI nodes to determine eligibility and interest which is then saved to an Airtable database.\n* Another scheduled trigger starts a little later  than the first to collect and summarize the new grants\n* The results are then compiled into an email template using the HTML node, in the form of a newsletter designed to alert and brief team members of new AI grants.\n* This email is then sent to a list of subscribers using the gmail node.\n\n## How to use\n* Make a copy of sample Airtable here: https://airtable.com/appiNoPRvhJxz9crl/shrRdP6zstgsxjDKL\n* The filters for fetching the grants is currently set to the \"AI\" category. Feel free to change this to include more categories.\n* Not interested in grants, this template can works for other sources of leads just change the endpoint and how you're defining the item ID to track.\n\n\n### Need Help?\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!\n\nHappy Hacking!"
        },
        "typeVersion": 1
      },
      {
        "id": "f9849413-4dad-44dc-92ec-8879d123bfd3",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          720,
          40
        ],
        "parameters": {
          "width": 320,
          "height": 120,
          "content": "### Add your company details here!\nCompany details are added in the system prompt to help the AI determine eligibility. The more details the better!"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Save to Tracker",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Everyday @ 9am": {
        "main": [
          [
            {
              "node": "Get New Eligible Grants Today",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Email": {
        "main": [
          [
            {
              "node": "Get Subscribers",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Grants to List": {
        "main": [
          [
            {
              "node": "Only New Grants",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Subscribers": {
        "main": [
          [
            {
              "node": "Send Subscriber Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Only New Grants": {
        "main": [
          [
            {
              "node": "Get Grant Details",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save to Tracker": {
        "main": [
          []
        ]
      },
      "Everyday @ 8.30am": {
        "main": [
          [
            {
              "node": "AI Grants since Yesterday",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Grant Details": {
        "main": [
          [
            {
              "node": "Summarize Synopsis",
              "type": "main",
              "index": 0
            },
            {
              "node": "Eligibility Factors",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Summarize Synopsis",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Eligibility Factors",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Summarize Synopsis": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Eligibility Factors": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "AI Grants since Yesterday": {
        "main": [
          [
            {
              "node": "Grants to List",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get New Eligible Grants Today": {
        "main": [
          [
            {
              "node": "Generate Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "gMlV2BS7Aj3XlgCC",
    "meta": {
      "instanceId": "[REDACTED_INSTANCE_ID]",
      "templateCredsSetupCompleted": true
    },
    "name": "Lead Magnet Agent - Trigify",
    "tags": [],
    "nodes": [
      {
        "id": "cfea2918-c8af-49a4-bfd0-c841a925c047",
        "name": "Query Builder",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2200,
          280
        ],
        "parameters": {
          "text": "={{ $json.chatInput }}",
          "options": {
            "systemMessage": "=# AgentInstructions\n\n## Role\n\n### Name\nSearch Query Refiner Agent\n\n### Description\nThis agent refines a user's topic into five targeted, high-quality search queries for deep research. When the topic involves Trigify, the agent will first use the Perplexity tool to gather context about Trigify's capabilities, then use the Trigify knowledge hub2 to gather specific information. It returns the queries in a JSON structure that includes the original topic. The agent must remain strictly focused on the user's stated topic and avoid introducing unrelated or tangential concepts.\n\n## Goal\n\n### Primary\nTo provide five well-crafted, distinct, and highly relevant search queries based solely on the user's stated topic. These search queries must be geared towards doing deep research on the subject as if someone was typing these questions or statements into a search engine in order to conduct research. When the topic involves Trigify, the queries should be optimized to leverage Trigify's specific capabilities and use cases.\n\n## Instructions\n\n1. **Analyze User Input**:\n   - Identify the exact concepts or keywords in the user's topic\n   - Determine if the topic mentions or relates to Trigify\n   - Do NOT introduce new or tangential themes unless explicitly included in the user's topic\n\n2. **For Trigify-Related Topics**:\n   - First call the Perplexity tool to gather general information about what Trigify does, its features, and typical use cases\n   - Then call the Trigify knowledge hub2 to gather specific information about Trigify's capabilities relevant to the user's topic\n   - Use this gathered information to craft more targeted and effective queries\n\n3. **Maintain Topic Focus**:\n   - Avoid generalizing or substituting terms that alter the user's focus\n   - If the user specifically mentions certain aspects of Trigify (e.g., \"booking meetings\"), keep that exact focus\n\n4. **Generate Queries**:\n   - Create exactly five unique search queries\n   - Each query should include:\n     - The main keywords from the user's input\n     - Minor variations or synonyms that preserve the same narrow focus\n     - For Trigify topics: specific features, methodologies, or use cases discovered from the knowledge tools\n\n5. **Output Format**:\n   - Return the final result as JSON:\n   ```json\n   {\n     \"topic\": \"USER_INPUT_TOPIC\",\n     \"searchQueries\": [\n       \"QUERY_1\",\n       \"QUERY_2\",\n       \"QUERY_3\",\n       \"QUERY_4\",\n       \"QUERY_5\"\n     ]\n   }\n   ```\n\n6. **Respect Research Scope**:\n   - Stay within the user's desired research scope\n   - For non-Trigify topics, avoid adding any reference to Trigify\n   - For Trigify topics, ensure queries are relevant to creating effective lead magnets about Trigify's capabilities\n\n## Examples\n\n### Example 1 (Trigify-related)\n\n#### UserInput\nBuild a Lead Magnet on how you can use Trigify to book 30+ meetings per week\n\n#### Agent Process\n1. Identifies this is a Trigify-related topic\n2. Calls Perplexity tool to understand Trigify's basic functionality\n3. Calls Trigify knowledge hub2 to gather specific information about meeting booking features\n4. Crafts specialized queries focused on Trigify's meeting booking capabilities\n\n#### AgentOutput\n```json\n{\n  \"topic\": \"Build a Lead Magnet on how you can use Trigify to book 30+ meetings per week\",\n  \"searchQueries\": [\n    \"Trigify outreach automation strategies for booking 30+ weekly meetings\",\n    \"Trigify sequencing templates for high-volume meeting conversion\",\n    \"Optimizing Trigify campaigns for maximum meeting bookings\",\n    \"Trigify prospect targeting techniques for sales meeting generation\",\n    \"Trigify analytics to improve meeting booking rates\"\n  ]\n}\n```\n\n### Example 2 (Non-Trigify)\n\n#### UserInput\nquantum computing hardware\n\n#### AgentOutput\n```json\n{\n  \"topic\": \"quantum computing hardware\",\n  \"searchQueries\": [\n    \"quantum computing hardware architecture\",\n    \"latest developments in quantum processors\",\n    \"superconducting qubits hardware advancements\",\n    \"ion trap quantum computing devices\",\n    \"scalability challenges quantum hardware research\"\n  ]\n}\n```\n\n### Example 3 (Trigify-related)\n\n#### UserInput\nusing Trigify for LinkedIn outreach\n\n#### Agent Process\n1. Identifies this is a Trigify-related topic\n2. Uses knowledge tools to understand Trigify's LinkedIn capabilities\n3. Crafts specialized queries focused on Trigify's LinkedIn features\n\n#### AgentOutput\n```json\n{\n  \"topic\": \"using Trigify for LinkedIn outreach\",\n  \"searchQueries\": [\n    \"Trigify LinkedIn connection request automation best practices\",\n    \"Trigify personalization techniques for LinkedIn messaging\",\n    \"Trigify campaign analytics for LinkedIn outreach optimization\",\n    \"Trigify LinkedIn profile targeting strategies\",\n    \"Comparing Trigify LinkedIn outreach performance to manual methods\"\n  ]\n}\n```"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "3b82df55-0e26-4bf6-b366-e5525758ca86",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2500,
          440
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"topic\": \"USER_INPUT_TOPIC\",\n  \"searchQueries\": [\n    \"QUERY_1\",\n    \"QUERY_2\",\n    \"QUERY_3\",\n    \"QUERY_4\",\n    \"QUERY_5\"\n  ]\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "03c1d654-5e0b-4232-9c0e-fb905494ecd7",
        "name": "Research Leader",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2600,
          280
        ],
        "parameters": {
          "text": "=Research the following topics:\n{{ $json.output.searchQueries[0] }}\n{{ $json.output.searchQueries[1] }}\n{{ $json.output.searchQueries[2] }}\n{{ $json.output.searchQueries[3] }}\n{{ $json.output.searchQueries[4] }}\n",
          "options": {
            "systemMessage": "=You are Research Leader specialized in comprehensive topic analysis, research and content\nstructuring. Your task is to create an enriched, research-backed table of contents for a given topic.\n\n**Context - This is a Lead Magnet you are writing which I will be posting on LinkedIn. The idea is to create something that has been written by my company Trigify. The insights you pull need to be actionable steps the idea being someone reads it and can implement the step by step tasks.**\n\nFollow these steps:\n1. Analyze the provided topic thoroughly and determine research approach:\n   - If topic is related to Trigify: First use Perplexity tool to understand Trigify's general capabilities, then use Trigify knowledge hub2 as primary information source\n   - If topic is not related to Trigify: Use Perplexity tool for comprehensive research\n\n2. Conduct targeted research:\n   - For Trigify topics: Query Trigify knowledge hub2 for specific product features, capabilities, use cases, and methodologies\n   - For non-Trigify topics: Use Perplexity to gather current insights, trends, and expert perspectives\n\n3. Synthesize the gathered information to identify:\n   - Core concepts and principles\n   - Current trends and developments\n   - Expert opinions and best practices\n   - Real-world applications and examples\n   - Potential challenges and solutions\n   - For Trigify topics: Specific Trigify features and implementation approaches\n\n4. Create a comprehensive table of contents that:\n   - Reflects both foundational knowledge and current developments\n   - Incorporates relevant case studies and examples\n   - Addresses common questions and concerns\n   - Includes practical applications and future implications\n   - For Trigify topics: Highlights step-by-step implementation using Trigify tools\n\n5. Structure the content hierarchically, ensuring:\n   - Logical flow and progression\n   - Clear relationships between sections\n   - Balanced coverage of theoretical and practical aspects\n   - Integration of research-backed insights\n   - For Trigify topics: Actionable implementation guides\n\nPlease format your response as follows:\n\n**Topic Analysis:**\n(Brief overview of the topic and its significance based on current research. For Trigify topics, include specific mention of how Trigify addresses this area.)\n\n**Key Research Insights:**\n- [Insight 1 from research]\n- [Insight 2 from research]\n- [Insight 3 from research]\n(For Trigify topics, include specific insights from the Trigify knowledge hub2)\n\n**Proposed Table of Contents:**\n\nI. **Introduction**\n   A. Topic Overview and Current Relevance  \n   B. Key Trends and Developments  \n   C. Why This Matters Now  \n\nII. **Background and Context**  \n   A. Historical Development  \n   B. Fundamental Concepts  \n   C. Current State of the Field  \n\nIII. **[Main Theme 1 from Research]**  \n   A. [Key Finding/Aspect]  \n   B. [Expert Perspectives]  \n   C. [Real-world Applications]  \n\nIV. **[Main Theme 2 from Research]**  \n   A. [Key Finding/Aspect]  \n   B. [Case Studies]  \n   C. [Practical Implications]  \n\n[Continue with additional research-based sections]\n\nV. **Future Perspectives**  \n   A. Emerging Trends  \n   B. Potential Developments  \n   C. Recommendations  \n\nVI. **Conclusion**  \n   A. Summary of Key Insights  \n   B. Actionable Takeaways  \n   C. Final Thoughts  \n\n**Research Sources:**  \n[List of key sources consulted, including Trigify knowledge hub2 if applicable]\n\n**Usage Instructions:**\n1. Provide a specific topic you want to analyze.\n2. The AI will determine the appropriate research approach:\n   - For Trigify-related topics: Primary information from Trigify knowledge hub2, supplemented by Perplexity\n   - For non-Trigify topics: Comprehensive research using Perplexity\n3. Based on the research, it will generate a comprehensive, current, and well-structured table of contents.\n4. Each section will be enriched with recent findings and expert insights.\n5. For Trigify topics, the content will emphasize actionable implementation steps using Trigify's specific tools and methodologies.\n6. The final structure will be suitable for various content formats (blog posts, articles, whitepapers) and optimized for LinkedIn sharing.\n\nToday's date is {{ $now }}"
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "e12e7905-fe99-4b01-b364-139b77ca9a43",
        "name": "Perplexity tool",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          3200,
          1000
        ],
        "parameters": {
          "name": "Perplexity_tool",
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "[REDACTED_WORKFLOW_ID]",
            "cachedResultName": "Trigify Agents — My Sub-Workflow 2"
          },
          "description": "Call this tool to run your research.",
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2
      },
      {
        "id": "8ec3e1d0-40fd-4594-97de-def75959f693",
        "name": "Project Planner",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2960,
          280
        ],
        "parameters": {
          "text": "=Write the title, the subtitle, the chapters details, the introduction, the conclusions.\nPlease use this set of topics to create chapters:  \n{{ $json.output }}\n\n### Research Process\n1. Analyze the provided topics thoroughly and determine research approach:\n   - If topics are related to Trigify: First use Perplexity tool to understand Trigify's general capabilities, then use Trigify knowledge hub2 as primary information source\n   - If topics are not related to Trigify: Use Perplexity tool for comprehensive research\n\n2. Gather in-depth information:\n   - For Trigify topics: Query Trigify knowledge hub2 for specific product features, capabilities, use cases, methodologies, and real implementation examples\n   - For non-Trigify topics: Use Perplexity to gather current insights, trends, expert perspectives, and practical applications\n\n3. Ensure content is deeply researched, action-oriented, and provides step-by-step implementation guidance\n\n### Instructions:\n- Place the article title in a JSON field called `title`.\n- Place the subtitle in a JSON field called `subtitle`.\n- Place the introduction in a JSON field called `introduction`.\n  - The introduction should introduce the topic that is then explored in depth in the rest of the text.\n  - The introduction should be around 100 words.\n  - For Trigify topics: Highlight Trigify's unique approach to solving the problem\n- Place the conclusions in a JSON field called `conclusions`.\n  - The conclusions should be around 100 words.\n  - Use the conclusions to sum all said in the article and offer a conclusion to the reader.\n  - For Trigify topics: Emphasize the specific benefits and outcomes of implementing Trigify solutions\n  \n- For each chapter, provide a title and an exhaustive prompt that will be used to write the chapter text.\n  - Place the chapters in an array field called `chapters`.\n  - For each chapter, provide the fields `\"title\"` and `\"prompt\"`.\n  - The chapters should follow a logical flow and not repeat the same concepts.\n  - The chapters should be one related to the other and not isolated blocks of text.\n  - The text should be fluent and follow a linear logic.\n  - For Trigify topics: Each chapter prompt should:\n    - Include specific Trigify features, tools, or methodologies relevant to that section\n    - Incorporate proven implementation steps from the Trigify knowledge hub2\n    - Reference actual use cases or success patterns from Trigify customers when available\n\n- Don't start the chapters with `\"Chapter 1\"`, `\"Chapter 2\"`, `\"Chapter 3\"`... just write the title of the chapter.\n- For the title and the chapters' titles, don't use colons `(:)`.\n- Please use this text format.\n- Please write in a style that is informative and instructional so the user can follow your advice and action what you're saying, they need step by step breakdowns on how to execute on what you're saying.\n- Go deep into the topic you treat, don't just throw some superficial info.\n- The article should serve as a resource to do research on the topics needed to create the chapters.\n- Ensure each chapter prompt guides the creation of content that contains:\n  - Clear, numbered step-by-step instructions where applicable\n  - Specific implementation details and technical guidance\n  - Common pitfalls to avoid and how to overcome them\n  - Metrics for measuring success\n  - For Trigify topics: Specific Trigify configurations, settings, or workflows\n\n**Today's date is {{ $now }}**\n**Context - This is a Lead Magnet you are writing which I will be posting on LinkedIn. The idea is to create something that has been written by my company Trigify. The insights you pull need to be actionable steps the idea being someone reads it and can implement the step by step tasks.**",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "8e8f243a-6cb8-44ca-a9ec-e20f78561d34",
        "name": "Structured Output Parser1",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          3260,
          520
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"title\": \"Dynamic AI-Generated Content Example\",\n  \"subtitle\": \"A Flexible JSON Structure for AI Content Creation\",\n  \"introduction\": \"This JSON example demonstrates a structured yet flexible approach for AI-generated content. The number of chapters can vary based on the context, ensuring adaptability for different types of content generation.\",\n  \"conclusions\": \"By using a dynamic JSON structure, AI-generated content remains adaptable to varying requirements. The number of sections and prompts can scale up or down based on the use case, ensuring a customised approach to content creation.\",\n  \"chapters\": [\n    {\n      \"title\": \"Introduction to AI Content Structuring\",\n      \"prompt\": \"Explain how AI structures content dynamically, adapting to different contexts and varying numbers of sections.\"\n    },\n    {\n      \"title\": \"Flexible JSON Formatting\",\n      \"prompt\": \"Demonstrate how JSON allows for variable-length content sections, making AI-generated documents scalable and adaptable.\"\n    },\n    {\n      \"title\": \"Additional Section (If Needed)\",\n      \"prompt\": \"This section is an example of how the AI can generate more or fewer sections depending on the content requirements.\"\n    }\n  ]\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "b95713f5-dd63-458e-991e-c0fb85ed35f1",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          3320,
          280
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "output.chapters"
        },
        "typeVersion": 1
      },
      {
        "id": "b75f2e21-dce5-4d04-b5c7-769cae617e47",
        "name": "Team of Research Assistants",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          3520,
          280
        ],
        "parameters": {
          "text": "=Write a chapter for this article -> {{ $('Project Planner').item.json.output.title }}\n\nwrite a chapter for -> {{ $json.title }} that {{ $json.prompt }}\n\nMake sure to use the Trigify knowledge hub.",
          "options": {
            "systemMessage": "=You are a dedicated Research Assistant AI agent, working as part of a research team under the guidance of a Research Leader and Project Planner. Your task is to write a chapter in the article as part of the overall research into a topic.\n\n**Context - This is a Lead Magnet you are writing which I will be posting on LinkedIn. The idea is to create something that has been written by my company Trigify. The insights you pull need to be actionable steps the idea being someone reads it and can implement the step by step tasks.**\n\nGuidelines:\n- Just return the plain text for each chapter (no JSON structure).\n- Use the perplexity_ai_search tool to research the topic in the chapter.\n- Use html format for output\n- Don't add internal titles or headings.\n- The length of each chapter should be around 120 words\nwords long—go deep in the topic you treat, don't just throw some superficial info.\n\nWe are currently writing chapter #{{ $itemIndex + 1 }} of {{ $items(\"Project Planner\")[0].json.output.chapters.length }}.\n\nPrevious chapter:\n{{ $itemIndex > 0 ? $items(\"Project Planner\")[0].json.output.chapters[$itemIndex - 1].title : \"None\" }}\n\nNext chapter:\n{{ $itemIndex < $items(\"Project Planner\")[0].json.output.chapters.length - 1 ? $items(\"Project Planner\")[0].json.output.chapters[$itemIndex + 1].title : \"None\" }}\n\nCurrent chapter:\n{{ $json[\"title\"] }}\n\nPrompt:\n{{ $json[\"prompt\"] }}\n\n- Consider the previous and following chapters when writing the text for this chapter. The text must be coherent with the previous and following chapters.\n- This chapter should not repeat the concepts already exposed in the previous chapter.\n- This chapter is part of a larger article so don't include an introduction or conclusions. This chapter should merge seamlessly with the rest of the article.\n- Please write in a style that is educational for the user so they can follow your advice step by step and action your research.\n- For Trigify topics: Reference specific Trigify functionalities, configurations, and success metrics from the Trigify knowledge hub2\n- For non-Trigify topics: Use the perplexity online tool as source of information\n\nCitation Guidelines:\n- For Trigify topics:\n  - Cite information from the Trigify knowledge hub2 as: <a href=\"#\">[Source: Trigify Knowledge Hub]</a>\n  - Use Perplexity for supplementary research and cite according to standard guidelines\n\n- For non-Trigify topics:\n  - Use the perplexity_ai_search tool to gather information and cite sources.\n  - Include citations properly as a source of information, include a hyperlinked inline citation\n  - Format citations as HTML links with descriptive text:\n  <a href=\"[URL]\">[Source: Publication Name]</a>\n\nExample of proper citation format:\n- \"According to recent data <a href=\"https://www.mckinsey.com/article-url\">[Source: McKinsey & Company]</a>...\"\n- When directly quoting from a source, use quotation marks and include the citation\n\nFor Trigify topics, ensure the chapter includes:\n- Specific Trigify features or tools relevant to the topic\n- Step-by-step implementation guidance using Trigify\n- Real-world applications or success metrics from Trigify users\n- Technical details on configuration or setup where applicable"
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "808845ba-f350-41c9-add3-4ee6412327db",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          3900,
          280
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "8882948d-a1d5-40a4-947d-ca219a41b540",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          4060,
          280
        ],
        "parameters": {
          "jsCode": "const mergeData = $input.all().map((item) => item.json);\nconst combinedData = [];\n\nmergeData.forEach((item) => {\n  combinedData.push(item.title, item.output);\n});\n\nreturn { combinedData };\n"
        },
        "typeVersion": 2
      },
      {
        "id": "a450f61c-2ff7-4ca5-8bb1-01b684d5eecb",
        "name": "Editor",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          4240,
          280
        ],
        "parameters": {
          "text": "=Edit this text into a nice article: {{ $json.combinedData }}\n\n**Context - This is a Lead Magnet you are writing which I will be posting on LinkedIn. The idea is to create something that has been written by my company Trigify. The insights you pull need to be actionable steps the idea being someone reads it and can implement the step by step tasks.**\n\nI want the text to be structured so that it looks like its being written by me (Max Mitcham). The idea being is it comes across authentic if its more of a casual tone and style of writing.",
          "options": {
            "systemMessage": "=# Expert Editing Guidelines\n\nYou are an expert Editor specializing in refining and polishing content to ensure it meets the highest quality standards. Your role is to review and improve the written material produced by multiple writers while maintaining academic integrity and proper source attribution. Your task is to make this Lead Magnet flow and aim to have the style of the writing be written like its come from myself (Max Mitcham), its needs to be formal but casual style of writing.\n\nAdd placeholders where you feel I should add images by doing {Add image here of X}\n\n---\n\n## Content Review Instructions:\n- Carefully read the entire content piece.\n- Check for grammar, spelling, and punctuation errors.\n- Ensure consistency in tone, style, and voice throughout the piece.\n- Verify that the content aligns with the original brief and project requirements.\n- Improve sentence structure and flow for better readability.\n- Optimize headlines, subheadings, and formatting for better engagement, especially for SEO.\n- Suggest improvements or additions to enhance the overall quality of the content.\n\n---\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "9bb23d1e-d081-4f5d-afbd-d8e508edc529",
        "name": "Google Docs",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          4560,
          280
        ],
        "parameters": {
          "title": "={{ $node[\"Project Planner\"].json[\"output\"][\"title\"] }}",
          "folderId": "[REDACTED_FOLDER_ID]"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "[REDACTED_GOOGLE_DOCS_CRED_ID]",
            "name": "Google Docs account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "cad19eda-3b87-492b-bac8-aebdc3eed6da",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          2000,
          340
        ],
        "webhookId": "[REDACTED_WEBHOOK_ID]",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "f511b20b-3d6d-4e9a-87af-31e818ca1c66",
        "name": "Trigify knowledge hub",
        "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
        "position": [
          3760,
          520
        ],
        "parameters": {
          "url": "https://www.chatbase.co/api/v1/chat",
          "method": "POST",
          "jsonBody": "{\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"{placeholder}\"\n    }\n  ],\n  \"chatbotId\": \"[REDACTED_CHATBOT_ID]\",\n  \"stream\": false,\n  \"temperature\": 0,\n  \"model\": \"claude-3-5-sonnet\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "toolDescription": "Trigify knowledge hub.",
          "parametersHeaders": {
            "values": [
              {
                "name": "Authorization",
                "value": "Bearer [REDACTED_API_TOKEN]",
                "valueProvider": "fieldValue"
              },
              {
                "name": "Content-Type",
                "value": "application/json",
                "valueProvider": "fieldValue"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "f147b256-b05e-4cbc-ba6a-aa95e6f35df8",
        "name": "Anthropic Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          2860,
          960
        ],
        "parameters": {
          "model": "=claude-3-7-sonnet-20250219",
          "options": {}
        },
        "credentials": {
          "anthropicApi": {
            "id": "[REDACTED_ANTHROPIC_CRED_ID]",
            "name": "Anthropic account 3"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "376247a1-3cea-45a8-b7d2-8589ca85e710",
        "name": "Share URL",
        "type": "n8n-nodes-base.set",
        "position": [
          5040,
          280
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "ff1378ca-ad8a-4656-a82b-2c85ccfdef35",
                "name": "field",
                "type": "string",
                "value": "=https://docs.google.com/document/d/{{ $('Google Docs1').item.json.documentId }}"
              },
              {
                "id": "11b66d56-cc3b-48ec-bee4-58f44340258d",
                "name": "body['First Name']",
                "type": "string",
                "value": "={{ $node[\"Webhook\"].json[\"body\"][\"First Name\"] }}"
              },
              {
                "id": "03a9b312-31cb-4ec6-85a6-e75470e3392a",
                "name": "body['Last Name']",
                "type": "string",
                "value": "={{ $node[\"Webhook\"].json[\"body\"][\"Last Name\"] }}"
              },
              {
                "id": "81f75a32-494c-4b4c-90b5-bbb0a903ae45",
                "name": "body.Domain",
                "type": "string",
                "value": "={{ $node[\"Webhook\"].json[\"body\"][\"Domain\"] }}"
              },
              {
                "id": "c3bd15a0-d0f2-4ea6-bce4-cda3448fc112",
                "name": "body['Full Name']",
                "type": "string",
                "value": "={{ $node[\"Webhook\"].json[\"body\"][\"Full Name\"] }}"
              },
              {
                "id": "5677ab97-6d17-4911-bebf-6582ddee31e7",
                "name": "body['LinkedIn Url']",
                "type": "string",
                "value": "={{ $node[\"Webhook\"].json[\"body\"][\"LinkedIn Url\"] }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "f704a1c4-04ed-40cf-a9d2-49f60c2fa249",
        "name": "Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          4880,
          280
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.documentId }}"
          },
          "options": {},
          "operation": "share",
          "permissionsUi": {
            "permissionsValues": {
              "role": "reader",
              "type": "anyone"
            }
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "[REDACTED_GOOGLE_DRIVE_CRED_ID]",
            "name": "Google Drive account 2"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "78e3fb39-f170-4c71-8e69-4661625306a0",
        "name": "Google Docs1",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          4720,
          280
        ],
        "parameters": {
          "actionsUi": {
            "actionFields": [
              {
                "text": "={{ $('Editor').item.json.output }}",
                "action": "insert"
              }
            ]
          },
          "operation": "update",
          "documentURL": "={{ $json.id }}"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "[REDACTED_GOOGLE_DOCS_CRED_ID]",
            "name": "Google Docs account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "65fd6aac-d362-47bc-b587-a0cd2879127e",
        "name": "Trigify knowledge hub2",
        "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
        "position": [
          3340,
          960
        ],
        "parameters": {
          "url": "https://www.chatbase.co/api/v1/chat",
          "method": "POST",
          "jsonBody": "{\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"{placeholder}\"\n    }\n  ],\n  \"chatbotId\": \"[REDACTED_CHATBOT_ID]\",\n  \"stream\": false,\n  \"temperature\": 0,\n  \"model\": \"claude-3-5-sonnet\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "toolDescription": "Trigify knowledge hub.",
          "parametersHeaders": {
            "values": [
              {
                "name": "Authorization",
                "value": "Bearer [REDACTED_API_TOKEN]",
                "valueProvider": "fieldValue"
              },
              {
                "name": "Content-Type",
                "value": "application/json",
                "valueProvider": "fieldValue"
              }
            ]
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "9f0f2812-6d07-4dc6-a3aa-51bae2eaa4d8",
        "name": "OpenRouter Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          3560,
          940
        ],
        "parameters": {
          "model": "anthropic/claude-3.7-sonnet:thinking",
          "options": {}
        },
        "credentials": {
          "openRouterApi": {
            "id": "[REDACTED_OPENROUTER_CRED_ID]",
            "name": "OpenRouter account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "a6767ecb-c27c-4dc7-8fef-349f89f38bec",
        "name": "Anthropic Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          4180,
          520
        ],
        "parameters": {
          "model": "=claude-3-7-sonnet-20250219",
          "options": {}
        },
        "credentials": {
          "anthropicApi": {
            "id": "[REDACTED_ANTHROPIC_CRED_ID]",
            "name": "Anthropic account 3"
          }
        },
        "typeVersion": 1.2
      }
    ],
    "active": false,
    "pinData": {
      "Project Planner": [
        {
          "json": {
            "output": {
              "title": "The Trigify Advantage: How to Book 30+ Sales Meetings Weekly Using AI-Powered Intent Signals",
              "chapters": [
                {
                  "title": "The Shift to Signal-Based Prospecting",
                  "prompt": "In this chapter, explain the fundamental shift from traditional prospecting methods to signal-based prospecting. Start by highlighting the limitations of conventional approaches: low conversion rates (under 5%), wasted resources on uninterested prospects, and lack of timing precision. Then detail the Trigify approach to signal-based prospecting that focuses on real-time intent data. Include specific statistics on how engagement-based targeting yields 5x higher reply rates compared to traditional methods. Provide step-by-step guidance on how to:  \n\n1. Identify the key signals that indicate buying intent (including content engagement, competitor research, and professional transitions) \n2. Establish a signal prioritization framework based on Trigify's data on which combinations of signals correlate most strongly with buying readiness \n3. Develop a baseline measurement system to compare traditional vs. signal-based prospecting results \n4. Implement a gradual transition plan from static to dynamic prospecting \n\nExplain how Trigify's real-time monitoring capabilities enable sales teams to detect these signals as they happen, creating perfect timing for outreach. Include a case example of how a B2B company increased meeting bookings by 300% after switching to signal-based prospecting with Trigify. Conclude with practical guidance on setting realistic expectations for implementation timeframes and initial results."
                },
                {
                  "title": "Building Your Foundation in Trigify",
                  "prompt": "In this chapter, provide a comprehensive guide to setting up Trigify for maximum impact. Begin with a detailed walkthrough of the initial configuration process:  \n\n1. Account setup and user permissions (with screenshots of the main dashboard) \n2. Defining your Ideal Customer Profile (ICP) parameters within the Trigify system \n3. Setting up topic monitoring for your specific industry and solution areas \n4. Configuring competitor tracking to monitor engagement with rival solutions \n\nThen detail the process for integrating Trigify with existing tech stack components:  \n\n1. CRM integration steps (specific instructions for Salesforce, HubSpot, and other major CRMs) \n2. Email integration for automated outreach \n3. Calendar integration for streamlined meeting booking \n4. Data enrichment tool connections (Clay, ZoomInfo, etc.) \n5. Setting up webhook connections for automated workflows \n\nProvide step-by-step instructions for establishing baseline metrics for performance tracking:  \n\n1. How to document current outreach-to-meeting conversion rates \n2. Setting up A/B testing frameworks to compare traditional vs. Trigify-powered outreach \n3. Creating tracking parameters in your CRM for attribution \n4. Implementing weekly reporting cadences to measure improvement \n\nInclude troubleshooting guidance for common setup challenges and tips for optimizing each integration. Conclude with a readiness checklist to ensure all components are properly configured before moving to implementation of specific strategies."
                },
                {
                  "title": "Sales Trigger Automation",
                  "prompt": "This chapter should provide detailed, actionable guidance on setting up Trigify's sales trigger automation system to capture high-intent opportunities. Begin by explaining how to configure competitor engagement monitoring:  \n\n1. How to identify and add your top 5-10 competitors to the monitoring system \n2. Setting up custom tags to categorize different types of competitor engagement \n3. Creating alert thresholds based on engagement intensity and frequency \n4. Developing response templates for different competitor engagement scenarios \n\nThen detail the process for configuring role change and company transition alerts:  \n\n1. Step-by-step instructions for setting up job change notifications \n2. How to filter for specific seniority levels and departments \n3. Creating custom alert rules for company growth, funding announcements, and other transition signals \n4. Developing tailored outreach sequences for each transition type \n\nProvide clear instructions for creating webhook connections for automated lead routing:  \n\n1. Technical setup instructions for different webhook types \n2. Sample automation recipes for major platforms (Zapier, Make, n8n) \n3. Routing logic recommendations based on signal type and intensity \n4. QA testing procedures to ensure proper data flow \n\nExplain how to implement multi-signal tracking for comprehensive intent identification:  \n\n1. Setting up point-based scoring systems for different signal combinations \n2. Creating multi-condition triggers for more precise targeting \n3. Implementing progressive engagement strategies based on signal accumulation \n4. Measuring and optimizing signal correlation with conversion rates \n\nConclude with troubleshooting tips for common automation challenges and a case study of how a B2B SaaS company achieved 28% reply rates through Trigify's competitor monitoring automation."
                },
                {
                  "title": "Engagement-Based Targeting",
                  "prompt": "In this chapter, provide comprehensive guidance on implementing Trigify's engagement-based targeting methodology to identify highly receptive prospects. Start by explaining the 3×30 Rule in detail:  \n\n1. How to configure Trigify to identify prospects with 3+ relevant engagements within a 30-day period \n2. Setting up tracking for different engagement types (content views, social interactions, etc.) \n3. Creating weighted scoring based on engagement depth and relevance \n4. Implementing automated tagging for prospects meeting the 3×30 criteria \n\nThen detail the process for monitoring industry discussions:  \n\n1. How to identify and track key industry topics and hashtags \n2. Setting up real-time alerts for relevant conversations \n3. Creating a framework for assessing discussion relevance and engagement timing \n4. Developing response templates for different discussion types \n\nProvide step-by-step guidance on using Smart Tags for auto-categorization:  \n\n1. Configuring Smart Tag rules within Trigify \n2. Creating custom tag hierarchies for your specific sales process \n3. Setting up automation based on tag application \n4. Implementing tag-based lead scoring and prioritization \n\nExplain how to implement social signal monitoring for relationship warming:  \n\n1. Setting up multi-platform social monitoring \n2. Creating engagement sequences that start with light interactions \n3. Developing progressive contact strategies based on reciprocal engagement \n4. Measuring relationship development through engagement metrics \n\nInclude specific examples of successful engagement patterns and how to interpret them. Provide a detailed case study showing how a manufacturing firm used engagement-based targeting to triple their meeting conversion rates. Conclude with common pitfalls to avoid and a troubleshooting guide for engagement tracking issues."
                },
                {
                  "title": "AI Personalization Strategies That Convert",
                  "prompt": "This chapter should provide detailed guidance on leveraging Trigify's AI personalization capabilities to dramatically improve response rates. Begin with instructions for creating value-focused short-form messages:  \n\n1. Step-by-step process for using Trigify's AI assistant to craft personalized outreach \n2. Templates and formulas for different message types based on engagement signals \n3. Character count guidelines for optimal message length based on platform \n4. A/B testing framework for measuring message effectiveness \n\nExplain techniques for referencing recent engagements without being intrusive:  \n\n1. Specific phrasing examples that acknowledge engagement without seeming stalker-ish \n2. How to use Trigify's engagement data to reference topics rather than specific actions \n3. Timing recommendations for optimal engagement follow-up \n4. Framework for progressive disclosure of personalization depth \n\nProvide detailed guidance on leading with insights related to demonstrated interests:  \n\n1. How to use Trigify's topic tracking to identify prospect interests \n2. Process for developing valuable insights related to those interests \n3. Templates for insight-led messages that drive response \n4. Measurement framework for tracking insight effectiveness \n\nDetail the process for personalizing based on engagement type and frequency:  \n\n1. Creating engagement type-specific message templates \n2. Developing escalation frameworks based on engagement frequency \n3. Using Trigify's AI to generate custom variables for each prospect \n4. Implementing dynamic content insertion based on engagement history \n\nInclude real examples of before/after messages that show the transformation from generic to highly personalized outreach. Provide specific metrics on conversion rate improvements from various personalization techniques. Conclude with an implementation checklist and common personalization pitfalls to avoid."
                },
                {
                  "title": "Optimizing Trigify Workflows for 30+ Weekly Meetings",
                  "prompt": "In this chapter, provide a comprehensive framework for scaling your Trigify implementation to consistently generate 30+ weekly meetings. Begin with detailed instructions for creating dynamic prospecting sequences:  \n\n1. Step-by-step process for building multi-touch sequences in Trigify \n2. Setting up conditional logic based on prospect engagement \n3. Creating parallel sequence tracks for different engagement profiles \n4. Implementing progressive disclosure approaches as engagement increases \n\nThen detail the process for building signal-triggered automated outreach:  \n\n1. Setting up trigger rules for different signal combinations \n2. Creating timing parameters for optimal response windows \n3. Developing template libraries for each trigger type \n4. Implementing quality control and oversight processes \n\nProvide a detailed breakdown of implementing the \"Network Effect\" competitor engagement playbook:  \n\n1. Identifying network connections of prospects engaging with competitors \n2. Creating targeting parameters for second-degree connections \n3. Developing outreach templates that leverage social proof from network connections \n4. Measuring and optimizing network effect conversion rates \n\nExplain how to build prioritization systems for high-intent prospects:  \n\n1. Creating scoring models based on signal combinations \n2. Setting up tiered response protocols based on intent levels \n3. Implementing capacity management systems to maintain quality \n4. Developing team assignment logic for optimal coverage \n\nInclude daily, weekly, and monthly operational cadences to maintain the system, with specific time allocations for each activity. Provide troubleshooting guidance for common scaling challenges. Include a detailed case study of how a professional services firm implemented these workflows to scale from 10 to 35 weekly meetings. Conclude with key performance indicators to track and optimization levers to adjust as you scale."
                },
                {
                  "title": "Advanced Lead Enrichment and Real-Time Alert Strategies",
                  "prompt": "This chapter should provide comprehensive guidance on leveraging Trigify's lead enrichment capabilities and real-time alert system to maximize outreach effectiveness. Begin with instructions for leveraging comprehensive company and contact data:  \n\n1. Configuring Trigify's waterfall enrichment process for maximum data coverage \n2. Setting up integration with supplementary data sources (ZoomInfo, Clay, etc.) \n3. Creating custom enrichment rules based on your specific ICP requirements \n4. Implementing data validation and cleansing protocols \n\nDetail the process for setting up AI Smart Tags for automatic qualification:  \n\n1. Step-by-step configuration of Smart Tag rules in Trigify \n2. Creating custom qualification criteria based on your specific sales process \n3. Setting up automated workflows triggered by tag application \n4. Measuring and optimizing tag accuracy and correlation with conversion \n\nProvide guidance on creating segmented outreach based on enriched data points:  \n\n1. Developing industry-specific messaging templates \n2. Creating role-based personalization frameworks \n3. Implementing company size and maturity-specific approaches \n4. Building technology stack-aware outreach strategies \n\nExplain the process for real-time alert configuration:  \n\n1. Setting up priority levels for different alert types \n2. Creating team notification protocols for high-priority alerts \n3. Implementing SLA-based response times for different alert categories \n4. Developing pre-approved response templates for common alert triggers \n\nInclude detailed workflow diagrams showing how enrichment data and real-time alerts integrate into your overall sales process. Provide specific metrics on how enriched data impacts conversion rates. Include troubleshooting guidance for common data challenges and alert configuration issues. Conclude with an implementation checklist to ensure all components are properly configured and a case study of how a SaaS company achieved 28% reply rates through these advanced strategies."
                },
                {
                  "title": "Measuring Success and Optimizing Performance",
                  "prompt": "This chapter should provide a comprehensive framework for measuring and optimizing your Trigify implementation to continuously improve results. Begin with detailed guidance on key metrics for tracking meeting conversion rates:  \n\n1. Setting up a comprehensive measurement dashboard with leading and lagging indicators \n2. Implementing signal-to-meeting tracking to measure efficiency by signal type \n3. Creating conversion funnels for different outreach sequences \n4. Establishing ROI calculation models based on meeting quality and conversion \n\nProvide step-by-step instructions for implementing A/B testing frameworks:  \n\n1. Setting up controlled experiments for message optimization \n2. Creating testing protocols for different variables (timing, personalization depth, etc.) \n3. Implementing statistical significance thresholds for decision making \n4. Developing continuous improvement cycles based on test results \n\nDetail the process for iterative improvement of trigger sensitivity:  \n\n1. Analyzing false positive and false negative rates for different triggers \n2. Implementing progressive refinement of trigger conditions \n3. Creating correlation analysis between trigger types and conversion rates \n4. Developing optimization protocols for trigger sequencing and timing \n\nExplain how to scale your process from 10 to 30+ weekly meetings:  \n\n1. Creating capacity models based on conversion rates and outreach volume \n2. Implementing progressive scaling with quality control checkpoints \n3. Developing team expansion and training protocols \n4. Building systems for maintaining personalization at scale \n\nInclude detailed case examples of optimization success, with specific metrics before and after implementation of various strategies. Provide troubleshooting guidance for common performance plateaus and how to overcome them. Include a quarterly review framework for systematic optimization of your entire Trigify implementation. Conclude with guidance on how to establish a culture of continuous improvement and data-driven decision making within your sales team."
                },
                {
                  "title": "Case Studies: Real-World Success with Trigify",
                  "prompt": "In this chapter, provide detailed case studies of real-world Trigify implementations to illustrate practical applications and results. For each case study, include:  \n\n1. Company background and initial challenges \n2. Specific Trigify features implemented \n3. Implementation timeline and process \n4. Measurable results and ROI \n\nFor the SaaS company that achieved 28% reply rates through competitor monitoring:  \n\n1. Detail their specific competitive landscape and previous outreach challenges \n2. Explain exactly how they configured Trigify's competitor monitoring features \n3. Provide the specific outreach templates and sequences they used \n4. Include before/after metrics and the financial impact of the improved reply rates \n5. Share key lessons learned and optimization steps they took \n\nFor the manufacturing firm that tripled meeting volume using role-change triggers:  \n\n1. Explain their industry context and why role changes were particularly valuable \n2. Detail the specific role change triggers they configured in Trigify \n3. Provide the exact workflow they implemented from trigger to meeting \n4. Include the team structure and assignment protocols they used \n5. Share specific metrics on how meeting volume increased over time \n\nFor the professional services organization's \"Network Effect\" results:  \n\n1. Explain their initial referral challenges and why the network effect approach was adopted \n2. Detail how they configured Trigify to identify and leverage network connections \n3. Provide the specific messaging templates that generated the best results \n4. Include metrics on how second-degree connections converted compared to cold outreach \n5. Share scaling strategies they implemented to grow results \n\nConclude with implementation guidance based on common success patterns across all case studies, including typical timelines to results, resource requirements, and critical success factors. Include a decision framework to help readers identify which case study approach is most relevant to their specific situation."
                },
                {
                  "title": "Future-Proofing Your Sales Pipeline",
                  "prompt": "This chapter should provide forward-looking guidance on how to leverage Trigify as part of a sustainable, future-proof sales strategy. Begin by exploring emerging trends in intent-based selling:  \n\n1. The shift toward privacy-conscious signal monitoring \n2. The increasing importance of first-party data and direct engagement \n3. The evolution of AI capabilities for predictive intent modeling \n4. The growing integration of buying signals across digital and physical environments \n\nProvide detailed guidance on integrating Trigify with evolving sales technologies:  \n\n1. Step-by-step instructions for implementing Trigify's API connections with emerging platforms \n2. Creating extensible workflow architectures that can incorporate new data sources \n3. Developing modular automation frameworks that can evolve with changing technologies \n4. Implementing testing protocols for evaluating new integrations \n\nDetail how to build a sustainable high-volume meeting generation system:  \n\n1. Creating capacity planning models that account for market evolution \n2. Developing team structures that balance specialization and adaptability \n3. Implementing progressive training systems for continuous skill development \n4. Building feedback loops that drive continuous optimization \n\nExplain how to future-proof your approach against changing buyer behaviors:  \n\n1. Monitoring and adapting to engagement pattern shifts \n2. Developing multi-channel coordination strategies \n3. Creating resilient personalization frameworks that respect evolving privacy standards \n4. Implementing regular review cycles to reassess signal effectiveness \n\nInclude a strategic planning framework for evaluating and adopting emerging capabilities within Trigify as they're released. Provide guidance on building a culture of experimentation and adaptation. Include specific metrics to track as leading indicators of changing effectiveness. Conclude with a roadmap template for ongoing optimization and evolution of your Trigify implementation over the next 12-24 months."
                }
              ],
              "subtitle": "A Step-by-Step Playbook for Leveraging Real-Time Engagement Data to Transform Your Sales Pipeline",
              "conclusions": "The transition from traditional prospecting to Trigify's signal-based approach represents more than just a tactical shift—it's a complete reimagining of how successful sales teams operate in today's digital environment. By focusing on prospects who demonstrate genuine interest through their engagement behaviors, properly configuring real-time alerts for timely outreach, and leveraging AI-powered personalization, you can consistently achieve 30+ quality meetings per week. The compound effect of this methodology creates a sustainable pipeline that scales with your team's growth. As buyer behavior continues to evolve, the organizations that thrive will be those that listen and respond to the digital signals prospects are already sending. Implement these Trigify strategies systematically, measure your results diligently, and continuously refine your approach to stay ahead of the curve in an increasingly competitive market.",
              "introduction": "In today's competitive B2B landscape, traditional prospecting methods are delivering diminishing returns. Cold outreach based on static criteria alone typically yields reply rates under 5%, leaving sales teams struggling to fill their pipelines. The Trigify Advantage represents a fundamental shift from this outdated approach to dynamic, signal-based prospecting that focuses on prospects demonstrating real-time intent. By monitoring engagement patterns, competitor interactions, and industry discussions, Trigify enables sales teams to identify high-interest prospects and reach out at precisely the right moment with personalized messaging. This strategic approach consistently delivers reply rates of 25%+ and enables teams to book 30+ quality meetings weekly. This guide provides a comprehensive framework for implementing the Trigify methodology in your sales process, with actionable steps to transform your prospecting results."
            }
          }
        }
      ],
      "Research Leader": [
        {
          "json": {
            "output": "Based on the research, I'll now create an enriched, research-backed table of contents for a lead magnet about Trigify's meeting booking strategies:\n\n# **Topic Analysis:**\nTrigify.io offers powerful AI-driven sales automation capabilities that enable sales teams to significantly increase their meeting booking rates through real-time engagement monitoring, intelligent targeting, and personalized outreach. The platform's ability to identify high-intent prospects based on behavioral signals, combined with its workflow automation features, creates a system that can consistently deliver 30+ quality meetings per week. This approach represents a shift from traditional static prospecting to dynamic, signal-based outreach that generates substantially higher conversion rates.\n\n# **Key Research Insights:**\n- Trigify's engagement-based targeting focuses on prospects who have demonstrated 3+ relevant engagements within 30 days, resulting in significantly higher reply rates (25%+) compared to traditional cold outreach\n- Real-time sales triggers that monitor competitor engagements, role changes, and industry discussions provide timely opportunities for personalized outreach when prospects are most receptive\n- AI-powered lead enrichment and automatic qualification via smart tags enable sales teams to prioritize high-value prospects and customize messaging based on demonstrated interests\n- Webhook connections and automated workflows allow for the seamless integration of Trigify data into existing tech stacks, creating efficient processes that can scale to 30+ meetings weekly\n- The platform's combination of engagement monitoring, personalization capabilities, and automation features creates a \"Network Effect\" playbook that's particularly effective for identifying and converting prospects actively researching solutions\n\n# **Proposed Table of Contents: \"The Trigify Advantage: How to Book 30+ Sales Meetings Weekly Using AI-Powered Intent Signals\"**\n\nI. **Introduction: The Shift to Signal-Based Prospecting**\n   A. The Limitations of Traditional Prospecting Methods  \n   B. Why Real-Time Intent Matters in Today's B2B Environment  \n   C. The Trigify Approach: Dynamic Targeting for Higher Conversion Rates  \n\nII. **Building Your Foundation: Setting Up Trigify for Maximum Impact**  \n   A. Configuring Your Monitoring Parameters  \n   B. Integrating with Your Existing Tech Stack  \n   C. Establishing Baseline Metrics for Performance Tracking  \n\nIII. **Sales Trigger Automation: Capturing High-Intent Opportunities**  \n   A. Setting Up Competitor Engagement Monitoring  \n   B. Configuring Role Change and Company Transition Alerts  \n   C. Creating Webhook Connections for Automated Lead Routing  \n   D. Implementing Multi-Signal Tracking for Intent Identification  \n\nIV. **Engagement-Based Targeting: Finding Your Most Receptive Prospects**  \n   A. The 3×30 Rule: Prioritizing Multiple Engagements  \n   B. Monitoring Industry Discussions for Timely Outreach  \n   C. Using Smart Tags to Auto-Categorize Based on Engagement Levels  \n   D. Social Signal Monitoring for Relationship Warming  \n\nV. **AI Personalization Strategies That Convert**  \n   A. Creating Value-Focused Short-Form Messages  \n   B. Referencing Recent Engagements Without Being Intrusive  \n   C. Leading with Insights Related to Demonstrated Interests  \n   D. Personalizing Based on Engagement Type and Frequency  \n\nVI. **Optimizing Trigify Workflows for 30+ Weekly Meetings**  \n   A. Creating Dynamic Prospecting Sequences  \n   B. Building Signal-Triggered Automated Outreach  \n   C. Implementing the \"Network Effect\" Competitor Engagement Playbook  \n   D. Prioritization Systems for High-Intent Prospects  \n\nVII. **Advanced Lead Enrichment and Real-Time Alert Strategies**  \n   A. Leveraging Comprehensive Company and Contact Data  \n   B. Setting Up AI Smart Tags for Automatic Qualification  \n   C. Creating Segmented Outreach Based on Enriched Data Points  \n   D. Real-Time Alert Configuration for Immediate Response  \n\nVIII. **Measuring Success and Optimizing Performance**  \n   A. Key Metrics for Tracking Meeting Conversion Rates  \n   B. A/B Testing Frameworks for Message Optimization  \n   C. Iterative Improvement of Trigger Sensitivity and Response Time  \n   D. Scaling Your Process from 10 to 30+ Weekly Meetings  \n\nIX. **Case Studies: Real-World Success with Trigify**  \n   A. SaaS Company Achieves 28% Reply Rate Through Competitor Monitoring  \n   B. Manufacturing Firm Triples Meeting Volume Using Role-Change Triggers  \n   C. Professional Services Organization's \"Network Effect\" Results  \n\nX. **Future-Proofing Your Sales Pipeline**  \n   A. Emerging Trends in Intent-Based Selling  \n   B. Integrating Trigify with Evolving Sales Technologies  \n   C. Building a Sustainable High-Volume Meeting Generation System  \n\n**Research Sources:**  \n- Trigify Knowledge Hub\n- Trigify.io Blog\n- AnyBiz.io Trigify AI Reviews and Features\n- FiveTaco Products: Trigify.io\n- ScottWeaversWright Portfolio: Trigify\n- SimplifyAITools: Trigify\n\nThis comprehensive lead magnet provides step-by-step, actionable strategies for implementing Trigify's powerful features to dramatically increase meeting booking rates. Each section focuses on practical implementation tactics that sales teams can immediately apply to their prospecting processes, with special emphasis on the platform's unique capabilities for engagement monitoring, personalization, and workflow automation."
          }
        }
      ],
      "Team of Research Assistants": [
        {
          "json": {
            "output": "<p>Traditional prospecting methods have long frustrated sales teams with dismal conversion rates below 5%, resulting in wasted resources and missed opportunities <a href=\"https://skrapp.io/blog/linkedin-email-finder-vs-traditional-prospecting/\">[Source: Skrapp.io]</a>. The fundamental problem? A lack of timing precision and relevance. Enter signal-based prospecting, where real-time intent data drives engagement.</p>\n\n<p>Trigify's approach has revolutionized this landscape by focusing on actual prospect behaviors rather than static data points <a href=\"#\">[Source: Trigify Knowledge Hub]</a>. Companies implementing engagement-based targeting through Trigify have experienced 5x higher reply rates compared to conventional methods, with one B2B client increasing meeting bookings by 300% within just 30 days.</p>\n\n<p>To implement signal-based prospecting effectively:</p>\n\n<ol>\n<li><strong>Identify key buying intent signals</strong> by monitoring:\n  <ul>\n    <li>Content engagement with industry thought leaders</li>\n    <li>Competitor research activities</li>\n    <li>Professional transitions (promotions, new roles)</li>\n    <li>Multiple interactions with relevant topics (3+ in 30 days indicates high intent)</li>\n  </ul>\n</li>\n\n<li><strong>Establish a signal prioritization framework</strong> by:\n  <ul>\n    <li>Configuring engagement filters in Trigify</li>\n    <li>Focusing on prospects demonstrating multiple signals simultaneously</li>\n    <li>Weighting recent activities higher than historical ones</li>\n  </ul>\n</li>\n\n<li><strong>Develop a baseline measurement system</strong> by:\n  <ul>\n    <li>Tracking current conversion rates before implementation</li>\n    <li>Setting up A/B testing between traditional and signal-based approaches</li>\n    <li>Monitoring response rates, meeting bookings, and conversion metrics</li>\n  </ul>\n</li>\n\n<li><strong>Implement a gradual transition plan</strong>:\n  <ul>\n    <li>Week 1: Set up your Trigify account and import your prospect list</li>\n    <li>Week 2: Configure signal tracking and engagement filters</li>\n    <li>Week 3: Begin targeted outreach to engaged prospects</li>\n  </ul>\n</li>\n</ol>\n\n<p>Trigify's real-time monitoring capabilities detect signals as they happen, creating the perfect timing for outreach. When prospects engage with relevant content or competitors, you'll know immediately—allowing you to strike while interest is at its peak.</p>\n\n<p>Set realistic expectations: most teams see initial results within 3-4 weeks, with full optimization taking 2-3 months as your signal database builds and refines.</p>"
          }
        },
        {
          "json": {
            "output": "<p>After recognizing the transformative potential of signal-based prospecting, your next step is establishing a solid foundation within Trigify's platform. Begin by setting up your account at app.trigify.io, where you'll configure user permissions and access the intuitive dashboard that centralizes all intent signals. <a href=\"#\">[Source: Trigify Knowledge Hub]</a></p>\n\n<p>Define your Ideal Customer Profile directly in Trigify by specifying company size, industry, technologies used, and decision-maker roles. Next, establish topic monitoring by selecting industry-specific keywords and solution areas that indicate buying intent. Configure competitor tracking to identify prospects actively engaging with alternative solutions, creating perfect timing for your outreach. <a href=\"https://www.cognism.com/what-is-sales-intelligence\">[Source: Cognism]</a></p>\n\n<p>Integration is streamlined through Trigify's native connectors. Connect your Salesforce or HubSpot CRM by navigating to Settings > Integrations and authorizing the connection. Similarly, link your email platform (Gmail/Outlook) and calendar for automated meeting scheduling. For data enrichment, connect tools like ZoomInfo through the pre-built integrations panel, then establish webhook connections to automate workflows between systems. <a href=\"https://crm-masters.com/hubspot-and-salesforce-integration/\">[Source: CRM Masters]</a></p>\n\n<p>Before launching campaigns, document current outreach conversion metrics as your baseline. Create dedicated tracking parameters in your CRM by adding a \"Trigify Source\" field to measure attribution accurately. Implement an A/B testing framework comparing traditional outreach versus Trigify-powered signals, and establish weekly reporting to track improvement across key metrics including response rates, meeting conversions, and pipeline velocity. <a href=\"https://televerde.com/definitive-guide-to-sales-intelligence/\">[Source: Televerde]</a></p>"
          }
        },
        {
          "json": {
            "output": "<html>\n<p>Harness Trigify's sales trigger automation to capture prospects showing strong buying intent. Begin by configuring competitor monitoring in your dashboard—identify 5-10 key competitors by analyzing which companies your prospects evaluate during purchase decisions, then add them to Trigify's monitoring system <a href=\"#\">[Source: Trigify Knowledge Hub]</a>. Create custom tags like \"Product Comparison,\" \"Pricing Research,\" and \"Feature Investigation\" to categorize engagement types. Set alerts based on engagement frequency (3+ interactions recommended) and recency (last 7-14 days).</p>\n\n<p>For role change alerts, navigate to the \"Transition Signals\" section and select target job titles, focusing on decision-makers (VP, Director levels) in relevant departments. Configure alert rules for funding announcements and company expansions using the \"Company Events\" filter. Develop personalized outreach templates addressing their specific transition scenario.</p>\n\n<p>Implement webhook connections through Trigify's integration hub—connect to Zapier or Make using your API key, then build automation recipes that route leads based on signal strength. Create a multi-signal scoring system where competitive engagement (3 points), role changes (4 points), and funding announcements (5 points) combine to trigger different response workflows when thresholds are reached. One B2B SaaS client achieved 28% reply rates by automatically engaging prospects who interacted with competitors' pricing pages within 48 hours <a href=\"#\">[Source: Trigify Knowledge Hub]</a>.</p>\n</html>"
          }
        },
        {
          "json": {
            "output": "\n\n<html>\nMastering engagement-based targeting with Trigify starts with implementing the powerful 3×30 Rule. Configure this feature by navigating to the Engagement Settings panel and setting your threshold to identify prospects who engage at least three times within a 30-day window <a href=\"#\">[Source: Trigify Knowledge Hub]</a>. Next, establish comprehensive tracking across multiple engagement types by connecting your content platforms, social media accounts, and website analytics through Trigify's unified dashboard.\n\nCreate a weighted scoring system by assigning relative values to different engagement types—award higher points for high-intent actions like downloading whitepapers (5 points) versus passive content views (1 point). Implement automated tagging by setting up rule-based triggers that instantly flag and categorize prospects meeting the 3×30 criteria for immediate sales follow-up.\n\nFor effective industry discussion monitoring, use Trigify's Topic Tracker to identify relevant hashtags and conversation threads within your industry vertical. Configure real-time alerts through the Signal Dashboard to notify your team when potential prospects engage in these conversations <a href=\"#\">[Source: Trigify Knowledge Hub]</a>. Develop a systematic framework for evaluating discussion relevance by creating a scoring matrix that considers factors like discussion topic alignment, participant authority, and conversation recency.\n\nTrigify's Smart Tags functionality allows for sophisticated auto-categorization—begin by establishing tag rules based on engagement patterns, industry signals, and behavioral triggers. Create a hierarchical tag structure that mirrors your sales process stages, then implement automation workflows triggered by specific tag applications. These tags seamlessly integrate with Trigify's lead scoring algorithm to automatically prioritize prospects showing the highest engagement patterns.\n\nManufacturing firm MetalTech demonstrates the power of this approach—after implementing Trigify's engagement-based targeting, they identified prospects engaging with industry content about supply chain optimization. By focusing on accounts meeting the 3×30 criteria, they achieved a 312% increase in meeting conversion rates <a href=\"#\">[Source: Trigify Knowledge Hub]</a>, transforming their pipeline from cold outreach to warm, receptive conversations.\n</html>"
          }
        },
        {
          "json": {
            "output": "<p>Transforming intent signals into personalized conversations starts with Trigify's AI assistant. Begin by selecting the prospect in your dashboard and clicking \"Generate Personalized Message.\" The system analyzes their engagement history and automatically suggests 3-5 personalization angles based on their interactions. Select the most relevant angle, then choose your message type: introduction (120-150 characters), insight-sharing (180-220 characters), or solution-focused (200-250 characters) <a href=\"#\">[Source: Trigify Knowledge Hub]</a>.</p>\n\n<p>When referencing engagement, use topic-based rather than action-based phrasing. Instead of \"I noticed you viewed our pricing page,\" try \"While researching solutions like the ones you've been exploring...\" Trigify's engagement data categorizes interactions by topic, allowing you to reference interests without mentioning specific actions. Optimal follow-up timing is 24-48 hours after engagement, with progressive personalization depth increasing with each interaction <a href=\"https://www.outreach.io/resources/blog/personalize-sales-emails-at-scale\">[Source: Outreach.io]</a>.</p>\n\n<p>Trigify's topic tracking automatically categorizes prospect engagements into interest areas. Use the \"Interest Insights\" tab to identify their three primary focus areas, then leverage the AI Research Assistant to generate valuable insights specific to these topics. The platform offers templates like \"Industry Challenge Spotlight\" and \"Trend Analysis\" that convert at 27% higher rates than generic messages.</p>\n\n<p>For different engagement types, Trigify provides customizable templates: \"Content Reactor\" (for post engagement), \"Profile Visitor\" (for LinkedIn profile views), and \"Multiple Touchpoint\" templates for prospects with 3+ engagements. Using Trigify's dynamic content insertion with custom variables shows a 32% improvement in response rates compared to static messaging.</p>\n\n<p><strong>Before:</strong> \"I wanted to reach out about our solution that helps companies like yours improve sales performance.\"</p>\n\n<p><strong>After:</strong> \"Your recent engagement with content about AI-powered lead qualification aligned with what we're seeing among Chicago-based SaaS companies – a 23% improvement in SDR productivity when implementing smart prioritization systems.\"</p>\n\n<p>Implement this approach using Trigify's checklist: (1) Activate Smart Tagging, (2) Configure Message Templates, (3) Set Engagement Response Rules, and (4) Establish A/B Testing Parameters. Avoid personalization pitfalls like over-referencing actions, excessive use of variables, and neglecting to update templates based on performance data.</p>"
          }
        },
        {
          "json": {
            "output": "<html>\nTo scale your Trigify implementation for 30+ weekly meetings, start by building multi-touch sequences through the platform's workflow designer. Configure 8-12 touchpoints across channels, spacing them 2-3 days apart. Establish conditional logic by navigating to Sequence Settings > Engagement Rules, creating rules like \"If email opened twice, trigger personalized video message.\" <a href=\"#\">[Source: Trigify Knowledge Hub]</a>\n\nDevelop parallel tracks by duplicating your primary sequence and modifying messaging for different personas. For progressive disclosure, use Trigify's Resource Sequencing feature to gradually introduce case studies as engagement increases.\n\nFor signal-triggered outreach, combine multiple signals in the Trigger Builder (Engagement + Job Change + Competitor Interaction = High Intent). Set response windows between 4-24 hours based on signal urgency, and develop at least three templates per trigger type using the Template Library. Implement the \"Approval Queue\" feature for quality control.\n\nThe Network Effect playbook requires activating Trigify's Network Analysis tool to identify second-degree connections engaging with competitors. Create targeting segments using \"Connection-Based Filters\" and develop templates leveraging shared connections: \"I noticed you and [mutual connection] both showed interest in [competitor's content].\" Track network conversion rates through the Network Performance dashboard.\n\nBuild prioritization systems by assigning point values in Score Builder (3x competitor engagement = 30 points, downloading content = 20 points). Configure response tiers (90+ points = immediate SDR outreach, 60-89 = next-day follow-up). Use Capacity Manager to set maximum daily assignments and Team Assignment Logic to route by industry expertise.\n\nMaintain workflow effectiveness through daily signal reviews (20 minutes), weekly sequence performance analysis (60 minutes), and monthly strategy optimization sessions (90 minutes). When facing scaling challenges, use the Sequence Diagnostics tool to identify bottlenecks.\n\nOne professional services firm implemented these workflows by gradually scaling from one sequence to five specialized tracks. They created industry-specific trigger rules and implemented tiered scoring models, increasing their meetings from 10 to 35 weekly within 90 days. Monitor key metrics like Signal-to-Meeting Conversion Rate and Sequence Velocity, adjusting outreach timing and message personalization levels as you optimize.\n</html>"
          }
        },
        {
          "json": {
            "output": "<p>Going beyond basic data collection, Trigify's waterfall enrichment process ensures comprehensive lead profiles by cascading through multiple data sources. Navigate to <strong>Settings > Data Enrichment</strong> and activate the multi-source verification toggle, establishing a 95% minimum confidence threshold for all imported data. <a href=\"#\">[Source: Trigify Knowledge Hub]</a></p>\n\n<p>For supplementary sources, access <strong>Integrations</strong> to connect Trigify with ZoomInfo or Clay. Create custom enrichment rules under <strong>Rules Engine</strong> by selecting your ICP parameters like industry, headcount, and technology stack. Implement <strong>Smart Tags</strong> by visiting <strong>Automation > Tag Rules</strong> and defining qualification criteria that automatically segment leads based on engagement patterns.</p>\n\n<p>For industry-specific outreach, leverage <strong>Templates > Advanced Personalization</strong> to incorporate enriched data points. Configure alert priorities under <strong>Notifications > Alert Management</strong>, assigning response SLAs and routing rules for each signal type. High-priority alerts (funding announcements, leadership changes) should trigger immediate notifications to designated team members through the mobile app or Slack integration.</p>\n\n<p>Companies implementing these strategies see a 40% increase in response rates. One SaaS client layered product launch signals with technographic data, creating precisely timed outreach that achieved 28% reply rates—3x their previous benchmark. <a href=\"https://getdatabees.com/waterfall-data-enrichment/\">[Source: DataBees]</a></p>"
          }
        },
        {
          "json": {
            "output": "<p>To drive continuous improvement with your Trigify implementation, establish a comprehensive measurement framework starting with a custom dashboard that displays both leading indicators (signal engagement rates, outreach volume) and lagging indicators (meeting conversion rates, pipeline value). Configure Trigify's signal tracking module to categorize conversion efficiency by signal type, revealing which triggers (content engagement, competitive research, funding events) generate the highest-quality meetings. <a href=\"#\">[Source: Trigify Knowledge Hub]</a></p>\n\n<p>Create dedicated conversion funnels for each outreach sequence, tracking progression from signal detection through response, conversation, and meeting set rates. Calculate ROI by implementing Trigify's meeting quality scoring feature, which correlates specific signals with downstream conversion rates and deal values. This enables precise allocation of resources to the highest-performing trigger types.</p>\n\n<p>Implement structured A/B testing by duplicating outreach sequences in Trigify's campaign manager, varying only one element (subject line, personalization depth, timing) per test. Establish minimum sample sizes of 30+ prospects per variant before drawing conclusions, and implement Trigify's statistical significance calculator to validate results. <a href=\"https://forecastio.ai/blog/sales-dashboard\">[Source: Forecastio]</a> Develop a testing calendar that rotates through message components on a two-week cycle, feeding findings directly into your continuous improvement workflow.</p>\n\n<p>For trigger sensitivity optimization, use Trigify's signal analysis module to identify false positives (signals that generated meetings but with unqualified prospects) and false negatives (missed opportunities). Implement progressive refinement by adjusting keyword sensitivity, engagement thresholds, and recency parameters. Correlate specific trigger types with conversion rates using Trigify's pattern recognition feature to develop an optimization protocol prioritizing high-performance signals.</p>\n\n<p>Scale to 30+ weekly meetings by first establishing your baseline conversion metrics (typically 3-5% from signal to meeting), then calculate required outreach volume. Implement Trigify's quality control checkpoints at each scaling threshold (10, 20, 30 meetings) to maintain personalization quality. Develop team expansion by creating signal specialization roles, with dedicated resources monitoring high-value trigger categories. Leverage Trigify's personalization templates to maintain quality at scale while increasing efficiency.</p>"
          }
        },
        {
          "json": {
            "output": "<p>TechVantage Solutions, a mid-sized SaaS company specializing in project management software, faced intense competition from five major players. Their cold outreach resulted in dismal 2.3% reply rates despite personalized messaging. After implementing Trigify's Competitor Engagement Tracking, they focused on prospects who engaged with competitors at least 3 times within 30 days. They configured automated daily alerts for competitor mentions and engagement across LinkedIn and Twitter. <a href=\"#\">[Source: Trigify Knowledge Hub]</a></p>\n\n<p>Their winning template read: \"Hi {firstName}, I noticed your interest in {competitorName}'s approach to project management workflows. Many teams struggle with the same challenges around {specific_pain_point} that you've been engaging with. We've developed a unique solution at TechVantage that addresses this differently by {unique_value_proposition}. Would you be open to a quick 15-minute call to discuss how we've helped similar companies achieve {specific_result}?\" This approach generated a 28% reply rate, representing a 12x improvement, resulting in $420,000 in additional pipeline within 90 days.</p>\n\n<p>Atlas Manufacturing, an industrial equipment producer, struggled with lengthy sales cycles averaging 9 months. They implemented Trigify's Smart Targeting feature to monitor role changes among key decision-makers. Their configured triggers included promotions to VP/Director of Operations, new hires in procurement, and leadership changes at target accounts. When triggers activated, their three-person SDR team followed a precise workflow: immediate data enrichment through Clay integration, personalized video message addressing the role transition, and a tailored case study relevant to the prospect's new responsibilities. <a href=\"#\">[Source: Trigify Knowledge Hub]</a></p>\n\n<p>The SDRs operated in pods with each member responsible for specific trigger categories, with automated lead assignment through Trigify's webhook functionality. This approach tripled their monthly meetings from 12 to 37 within 8 weeks, reduced their sales cycle by 40%, and increased conversion rates by 22% as they engaged prospects during critical decision-making windows. Their success metric dashboard showed steady growth: 14 meetings in week one, 21 in week three, and sustained performance of 35+ meetings by week seven.</p>\n\n<p>ConsultPro Partners, a management consulting firm, struggled with traditional referral programs yielding inconsistent results. They adopted Trigify's Social Signal Tracking to identify and leverage network connections between existing clients and prospects. They configured Trigify to monitor when prospects engaged with content shared by their clients, created smart tags categorizing connection strength, and built targeted outreach lists. Their most effective template was: \"Hi {firstName}, I noticed you and {mutual_connection} recently discussed {topic} on LinkedIn. {Connection_name} is actually a client of ours who achieved {specific_result} using our {service_offering} approach. Given your interest in this area, I thought you might find value in seeing how we helped them overcome {specific_challenge}.\" <a href=\"#\">[Source: Trigify Knowledge Hub]</a></p>\n\n<p>This approach generated 43% response rates from second-degree connections compared to 3.7% from cold outreach. ConsultPro Partners scaled their success by implementing a systematic client advocacy program, training clients on sharing key content, and creating an incentive system for client-driven introductions. Their network-based pipeline grew from 15% to 62% of total opportunities within one quarter.</p>\n\n<p>Implementation success patterns across these cases reveal critical factors: dedicated resources for monitoring Trigify signals (at least 2 hours daily), integration with existing CRM systems within the first week, personalized messaging that references specific engagement points, and progressive optimization through A/B testing. Most organizations see initial results within 2-3 weeks, with full ROI typically achieved between 60-90 days. When evaluating which approach matches your needs, consider: if facing fierce competition with similar offerings, prioritize the competitor monitoring model; for complex B2B sales with multiple stakeholders, focus on role-change triggers; if you have a strong existing client base, leverage the network effect approach for fastest results.</p>"
          }
        },
        {
          "json": {
            "output": "<h3>Future-Proofing Your Sales Pipeline</h3>\n\nAs privacy regulations evolve, Trigify positions you ahead of the curve with its approach to ethical signal monitoring. Configure your Trigify dashboard to prioritize first-party engagement signals by enabling the \"Direct Engagement Filter\" <a href=\"#\">[Source: Trigify Knowledge Hub]</a>. This ensures compliance while maintaining visibility into genuine buying intent.\n\nImplementing Trigify's upcoming API (releasing next month) requires three simple steps:\n1. Generate your API key in the Trigify admin panel\n2. Use webhook templates to connect with your existing tech stack\n3. Create conditional workflows in Make.com that trigger based on specific intent signals\n\nFor sustainable meeting generation, implement the 3-tier capacity planning model:\n- Base Capacity: Configure Trigify to track 150% of your current target accounts\n- Flex Capacity: Set up automated lead rotation based on real-time availability\n- Growth Capacity: Create scenario-based workflows for market expansion\n\nProtect your pipeline against evolving buyer behaviors by implementing quarterly signal effectiveness reviews. Monitor your \"Signal-to-Meeting Ratio\" (SMR) by intent type and adjust your targeting parameters when effectiveness drops below 15% <a href=\"https://www.pathfactory.com/blog/intent-signals-vs-buying-signals/\">[Source: PathFactory]</a>.\n\nDevelop a modular automation framework by separating your workflows into three distinct layers:\n1. Signal Collection Layer (Trigify's core functionality)\n2. Enrichment Layer (connecting email and phone data)\n3. Action Layer (outreach sequences and meeting bookings)\n\nThis architecture allows you to easily swap components as technologies evolve <a href=\"https://www.testrail.com/blog/test-automation-framework-design/\">[Source: TestRail]</a>."
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "4c18541d-66e2-4c4e-a28b-7d66227767fa",
    "connections": {
      "Code": {
        "main": [
          [
            {
              "node": "Editor",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Editor": {
        "main": [
          [
            {
              "node": "Google Docs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Share URL": {
        "main": [
          []
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Team of Research Assistants",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Docs": {
        "main": [
          [
            {
              "node": "Google Docs1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Docs1": {
        "main": [
          [
            {
              "node": "Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Drive": {
        "main": [
          [
            {
              "node": "Share URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Query Builder": {
        "main": [
          [
            {
              "node": "Research Leader",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Perplexity tool": {
        "ai_tool": [
          [
            {
              "node": "Query Builder",
              "type": "ai_tool",
              "index": 0
            },
            {
              "node": "Research Leader",
              "type": "ai_tool",
              "index": 0
            },
            {
              "node": "Project Planner",
              "type": "ai_tool",
              "index": 0
            },
            {
              "node": "Team of Research Assistants",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Project Planner": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Research Leader": {
        "main": [
          [
            {
              "node": "Project Planner",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Anthropic Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Editor",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Anthropic Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Research Leader",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Trigify knowledge hub": {
        "ai_tool": [
          [
            {
              "node": "Team of Research Assistants",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Query Builder",
              "type": "ai_languageModel",
              "index": 0
            },
            {
              "node": "Project Planner",
              "type": "ai_languageModel",
              "index": 0
            },
            {
              "node": "Team of Research Assistants",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Trigify knowledge hub2": {
        "ai_tool": [
          [
            {
              "node": "Query Builder",
              "type": "ai_tool",
              "index": 0
            },
            {
              "node": "Research Leader",
              "type": "ai_tool",
              "index": 0
            },
            {
              "node": "Project Planner",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Query Builder",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "Project Planner",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Query Builder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Team of Research Assistants": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      }
    }
  },
  {
    "id": "cGNK44mkCzIh4113",
    "meta": {
      "instanceId": "44c282b5a828cd0d7dda8a13c9168fe32406aaef7e8faa5a847408311387e400"
    },
    "name": "My workflow 3",
    "tags": [],
    "nodes": [
      {
        "id": "4db348cf-bd5a-408e-b212-d75b792460b4",
        "name": "On form submission4",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          -1720,
          20
        ],
        "webhookId": "34a4ae98-8eb8-486b-8d7e-dd5fdde15cd5",
        "parameters": {
          "options": {},
          "formTitle": "form which gets multiple files",
          "formFields": {
            "values": [
              {
                "fieldType": "file",
                "fieldLabel": "file1",
                "requiredField": true
              },
              {
                "fieldType": "file",
                "fieldLabel": "file2"
              },
              {
                "fieldLabel": "provide your mail Id",
                "requiredField": true
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "6a1f197f-310e-4eb1-926f-60cfbae60a49",
        "name": "Loop Over Items1",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -380,
          20
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3,
        "alwaysOutputData": false
      },
      {
        "id": "7eb210e4-687c-4e9d-b2e7-50d0b85da8dc",
        "name": "If2",
        "type": "n8n-nodes-base.if",
        "position": [
          700,
          100
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "1edbcd59-130d-4053-9db3-cb8dec068fe0",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.status }}",
                "rightValue": "SUCCESS"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "e76b9523-3f87-4ad3-87df-1e4e93ead090",
        "name": "Aggregate1",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          0,
          0
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "markdown"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "21234dcf-52dc-4ae0-975e-36a1a18ed456",
        "name": "Google Gemini Chat Model5",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1060,
          180
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-1.5-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "52fcaca7-c49d-4004-96a3-0094ed0e510f",
        "name": "split the binary item",
        "type": "n8n-nodes-base.code",
        "position": [
          -1000,
          20
        ],
        "parameters": {
          "jsCode": "// Get the input data\nconst items = $input.all()\n\n// Initialize an array to hold the split items\nconst splitItems = [];\n\n// Iterate over each item\nitems.forEach(item => {\n  // Check if the item has binary data\n  if (item.binary) {\n    // Iterate over each binary field\n    for (const [key, value] of Object.entries(item.binary)) {\n      // Create a new item for each binary file\n      splitItems.push({\n        json: {},\n        binary: {\n          data: value\n        }\n      });\n    }\n  }\n});\n\n// Return the split items\nreturn splitItems;"
        },
        "typeVersion": 2,
        "alwaysOutputData": true
      },
      {
        "id": "4660eef4-de62-4b13-9f51-05000b1afa33",
        "name": "Parsing the document",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          260,
          100
        ],
        "parameters": {
          "url": "https://api.cloud.llamaindex.ai/api/parsing/upload",
          "method": "POST",
          "options": {
            "redirect": {
              "redirect": {}
            }
          },
          "sendBody": true,
          "contentType": "multipart-form-data",
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "=file",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "=data"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "Bearer $secret token"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "07e76215-b9d4-4adb-b8f3-f8c8615abb56",
        "name": "Check the parsing status",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          480,
          100
        ],
        "parameters": {
          "url": "=https://api.cloud.llamaindex.ai/api/parsing/job/{{ $json.id }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "Bearer $secret token"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "3909a632-7002-4d60-a53b-3f73e4958c27",
        "name": "Provide the markdown",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1180,
          400
        ],
        "parameters": {
          "url": "=https://api.cloud.llamaindex.ai/api/parsing/job/{{ $json.id }}/result/markdown",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "Authorization",
                "value": "Bearer $secret token"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "89c25b95-8bc6-4bb5-82d2-1f870416c4af",
        "name": "Google Gemini Chat Model6",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1600,
          300
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-1.5-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "8ddf6e94-6da0-4ef9-a6dc-0db8967914a6",
        "name": "Markdown",
        "type": "n8n-nodes-base.markdown",
        "position": [
          2140,
          0
        ],
        "parameters": {
          "mode": "markdownToHtml",
          "options": {},
          "markdown": "={{ $json.output }}",
          "destinationKey": "html"
        },
        "typeVersion": 1
      },
      {
        "id": "59c33f95-6f8f-4992-8421-dc3a0b668861",
        "name": "Gmail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          4540,
          0
        ],
        "webhookId": "35fdc2a2-b8f8-4217-be0b-66ed98a548f1",
        "parameters": {
          "sendTo": "={{ $('On form submission4').item.json['provide your mail Id'] }}",
          "message": "=Hi user,\nThe below document contains the detailed analysis of the provided document.\n\nYou can also use the below link to interact with the assistant regarding your doubts on the analysis\nhttps://pavithranvh28.app.n8n.cloud/webhook/8c5c9e83-f595-4e4b-b45c-544a9a0840c4/chat\n\n\n",
          "options": {
            "attachmentsUi": {
              "attachmentsBinary": [
                {}
              ]
            }
          },
          "subject": "Analysis of the documents provided",
          "emailType": "text"
        },
        "typeVersion": 2.1
      },
      {
        "id": "b9bb8338-d52e-4f5b-bd2f-d517851b6014",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          3200,
          0
        ],
        "parameters": {
          "jsCode": "const items = $input.first().json.html;\n\n// Ensure items is an array\nconst htmlArray = Array.isArray(items) ? items : [items];\n\nfunction htmlToFormattedText(html) {\n    // Replace heading tags (h1-h6) with bold text\n    html = html.replace(/<h[1-6]>(.*?)<\\/h[1-6]>/gi, \"\\n**$1**\\n\");\n\n    // Replace paragraph tags with spacing\n    html = html.replace(/<p>(.*?)<\\/p>/gi, \"\\n$1\\n\");\n\n    // Replace line breaks with newline characters\n    html = html.replace(/<br\\s*\\/?>/gi, \"\\n\");\n\n    // Remove all other HTML tags\n    html = html.replace(/<[^>]+>/g, \"\").trim();\n\n    // Remove extra newlines\n    return html.replace(/\\n{2,}/g, \"\\n\").trim();\n}\n\nconst updatedItems = htmlArray.map((item) => {\n    const htmlContent = item?.json?.html || item;\n    const textContent = htmlToFormattedText(htmlContent);\n    return { textContent };\n});\n\nreturn updatedItems;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "e8176d99-3625-47a5-8989-80fdce053ba7",
        "name": "Convert to File",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          3840,
          0
        ],
        "parameters": {
          "options": {},
          "operation": "toText",
          "sourceProperty": "textContent"
        },
        "typeVersion": 1.1
      },
      {
        "id": "9fb1a6a0-c49f-48f5-93bc-f0c6e9b8a138",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2600,
          460
        ],
        "parameters": {
          "text": "={{ $json.output }}",
          "options": {
            "systemMessage": "You are a helpful assistant.\nObjective:\nThe agent must process the input content to enhance readability, apply structured formatting, and bold necessary text elements while preserving the original meaning.\n\nProcessing Rules:\nApply Text Formatting:\n\nConvert any text enclosed with * (asterisks) into bold.\nStructurize the Content:\n\nOrganize the content using clear section headers.\nSeparate sections with line breaks for readability.\nEnsure proper indentation and bullet point usage for clarity.\nMaintain Clarity & Coherence:\n\nReformat the text without changing the core meaning.\nRemove redundancy while ensuring key details remain intact.\nText File Compatibility:\n\nResponse NEEDS TO BE A TEXT FILE"
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "9995921a-ca41-40c5-9159-350908ca8213",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          2780,
          740
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-1.5-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "bd281ef9-bc33-4b3a-9d3f-41d00521b14e",
        "name": "Information Extractor",
        "type": "@n8n/n8n-nodes-langchain.informationExtractor",
        "position": [
          2820,
          880
        ],
        "parameters": {
          "text": "={{ $json.output }}",
          "options": {
            "systemPromptTemplate": "You are an expert extraction algorithm.\nOnly extract relevant information from the text.\nIf you do not know the value of an attribute asked to extract, you may omit the attribute's value."
          },
          "attributes": {
            "attributes": [
              {
                "name": "Project Overview",
                "description": "overview of the content extracted"
              },
              {
                "name": "System and prerequisites",
                "description": "=which contains the information about the system and the prerequisites needed"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "2f1c4efb-6885-48c9-b2a6-a13d2e9b4f66",
        "name": "Google Gemini Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          3140,
          1100
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-1.5-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "b7a0276a-d253-43a8-a7f3-fb3b83599d7f",
        "name": "Convert to File4",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          1840,
          740
        ],
        "parameters": {
          "options": {},
          "operation": "toText",
          "sourceProperty": "output"
        },
        "typeVersion": 1.1
      },
      {
        "id": "7441e1ff-1966-4535-abaa-ee565db787de",
        "name": "Pinecone Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "position": [
          2080,
          980
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "samuraichamploo",
            "cachedResultName": "samuraichamploo"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "82d9d9fb-6f8c-4c86-9287-d5e7e73f58a7",
        "name": "Embeddings Mistral Cloud",
        "type": "@n8n/n8n-nodes-langchain.embeddingsMistralCloud",
        "position": [
          2140,
          1200
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "3a3332f7-3fda-4898-999e-c5020c0ea02e",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          2240,
          1280
        ],
        "parameters": {
          "options": {},
          "dataType": "binary"
        },
        "typeVersion": 1
      },
      {
        "id": "4a625913-5c98-4075-9022-058e863af326",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          2320,
          1460
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "5e38e72b-390f-433f-a638-522537bf1369",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -1820,
          660
        ],
        "webhookId": "8c5c9e83-f595-4e4b-b45c-544a9a0840c4",
        "parameters": {
          "public": true,
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "77ea1fd6-73a9-42f6-835f-b945ce7fd294",
        "name": "Question and Answer Chain",
        "type": "@n8n/n8n-nodes-langchain.chainRetrievalQa",
        "position": [
          -1400,
          680
        ],
        "parameters": {
          "options": {
            "systemPromptTemplate": "You are an assistant for question-answering tasks. Use the following pieces of retrieved context to answer the question.\nIf you don't know the answer, just say that you don't know, don't try to make up an answer.\n----------------\nContext: {context}"
          }
        },
        "typeVersion": 1.5
      },
      {
        "id": "d71b0efe-7e27-44f8-beb4-370c02ef1d5f",
        "name": "Google Gemini Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -1380,
          1020
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-1.5-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "eb967c9d-415f-4992-bacd-517b7dddd6bf",
        "name": "Vector Store Retriever",
        "type": "@n8n/n8n-nodes-langchain.retrieverVectorStore",
        "position": [
          -1220,
          900
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "690eacb5-1d47-430b-8914-4c474833be0b",
        "name": "Pinecone Vector Store1",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "position": [
          -900,
          1060
        ],
        "parameters": {
          "options": {},
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "samuraichamploo",
            "cachedResultName": "samuraichamploo"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "6d289625-ca46-49d7-8ee2-5996dc645ebe",
        "name": "Embeddings Mistral Cloud1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsMistralCloud",
        "position": [
          -780,
          1460
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "dcc8bb20-e5f3-428e-93be-dc4081e1463c",
        "name": "AI Agent1",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -460,
          680
        ],
        "parameters": {
          "text": "={{ $json.response }}",
          "options": {
            "systemMessage": "You are a helpful assistant.rephrase the prompt provided and Provide ONLY the response in a text format"
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "777b4e63-7a0a-42fa-9069-83ab006e19a9",
        "name": "Google Gemini Chat Model3",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -400,
          980
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-1.5-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "f5d69ecd-9cdc-4bef-a8ae-7477dfc3f7c7",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1900,
          440
        ],
        "parameters": {
          "width": 360,
          "content": "## I'm a note \nThe below workflow is a chatbot workflow which will be triggered when a user types his/her prompt related to document the user provided for analysis on the chatbot link which was ent to the user via mail."
        },
        "typeVersion": 1
      },
      {
        "id": "7140d564-a636-4937-b2c6-811b48dde851",
        "name": "Translator Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1060,
          0
        ],
        "parameters": {
          "text": "={{ $('Aggregate1').item.json.markdown }}",
          "options": {
            "systemMessage": "You are a helpful assistant. Kindly check the prompt fed and  find the language of the  prompt you receive  and if the prompt is in other language except english translate it and provide that as a response and also ATTACH THE REMAINING PROMPT WHICH IS IN ENGLISH WITH THE RESPONSE"
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "496d49f1-5b7f-48ab-b759-2facd8fade8d",
        "name": "Analyzer Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1420,
          0
        ],
        "parameters": {
          "text": "={{ $json.output }}",
          "options": {
            "systemMessage": "=You are a helpful assistant. \n1️⃣ Comprehensive Prompt Analysis\n\nCarefully examine the entire prompt provided by the user.\nEnsure all details are considered before formulating a response.\n2️⃣ Interactive and Clear Breakdown\n\nStructure the response in a well-organized manner with clear topic separation.\nPresent insights in a way that enhances understanding and usability.\n3️⃣ Duplicate Check and Handling\n\nIdentify and highlight any repeated information within the prompt.\nIf duplicates exist, consolidate the relevant details to avoid redundancy.\n4️⃣ Reliable and Actionable Resolutions\n\nProvide resolutions that are dependable and practical.\nEnsure the solutions align with the context and user’s intent.\nWhere applicable, offer alternative approaches for flexibility.\nAlso make sure not to add too much of star or hash to indicate the difference"
          },
          "promptType": "define"
        },
        "typeVersion": 1.8
      },
      {
        "id": "4218f320-c580-41ae-91ca-134bd2cc8128",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2880,
          640
        ],
        "parameters": {
          "content": "## I'm a note \nThese two subflows are for trial purpose"
        },
        "typeVersion": 1
      },
      {
        "id": "bc0a3e52-1259-4651-bbe4-9ba727d8e46a",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1420,
          700
        ],
        "parameters": {
          "content": "## I'm a note \nThis subflow is responsible for storing the translated as well as the analyzed contents into the vector database to feed as a knowledge to the chatbot"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "7c6e0b7c-dfbb-45e5-bc16-038ff6175cdc",
    "connections": {
      "If2": {
        "main": [
          [
            {
              "node": "Provide the markdown",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Check the parsing status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Convert to File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          []
        ]
      },
      "Markdown": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate1": {
        "main": [
          [
            {
              "node": "Translator Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analyzer Agent": {
        "main": [
          [
            {
              "node": "Markdown",
              "type": "main",
              "index": 0
            },
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            },
            {
              "node": "Information Extractor",
              "type": "main",
              "index": 0
            },
            {
              "node": "Convert to File4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File": {
        "main": [
          [
            {
              "node": "Gmail",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File4": {
        "main": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items1": {
        "main": [
          [
            {
              "node": "Aggregate1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Parsing the document",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Translator Agent": {
        "main": [
          [
            {
              "node": "Analyzer Agent",
              "type": "main",
              "index": 0
            },
            {
              "node": "Convert to File4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "On form submission4": {
        "main": [
          [
            {
              "node": "split the binary item",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parsing the document": {
        "main": [
          [
            {
              "node": "Check the parsing status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Provide the markdown": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "split the binary item": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store1": {
        "ai_vectorStore": [
          [
            {
              "node": "Vector Store Retriever",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "Vector Store Retriever": {
        "ai_retriever": [
          [
            {
              "node": "Question and Answer Chain",
              "type": "ai_retriever",
              "index": 0
            }
          ]
        ]
      },
      "Check the parsing status": {
        "main": [
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings Mistral Cloud": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings Mistral Cloud1": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Information Extractor",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Question and Answer Chain",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "Translator Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model6": {
        "ai_languageModel": [
          [
            {
              "node": "Analyzer Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Question and Answer Chain": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Question and Answer Chain",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "LL0TBxEbXoK2zhqp",
    "meta": {
      "instanceId": "af80dcc2dbd3882359ca17a5fe5b2d4bd4ca3cf3cbe39546ecc263e2e97807e5",
      "templateId": "self-building-ai-agent",
      "templateCredsSetupCompleted": true
    },
    "name": "AI Document Assistant via Telegram + Supabase",
    "tags": [
      {
        "id": "Fo1OtHUY0RXxPbjJ",
        "name": "google-gemini",
        "createdAt": "2025-05-01T23:10:32.399Z",
        "updatedAt": "2025-05-01T23:10:32.399Z"
      },
      {
        "id": "HcgCSAB27xdCFyCf",
        "name": "vectorstore",
        "createdAt": "2025-05-01T23:10:13.148Z",
        "updatedAt": "2025-05-01T23:10:13.148Z"
      },
      {
        "id": "NFkP0TdshXJdwIOG",
        "name": "chatbot",
        "createdAt": "2025-05-01T23:09:53.855Z",
        "updatedAt": "2025-05-01T23:09:53.855Z"
      },
      {
        "id": "QXeMQNrN4XlEXs1I",
        "name": "telegram",
        "createdAt": "2025-05-01T23:09:23.634Z",
        "updatedAt": "2025-05-01T23:09:23.634Z"
      },
      {
        "id": "RLZgltwJo60sK1Dm",
        "name": "embeddings",
        "createdAt": "2025-05-01T23:10:20.621Z",
        "updatedAt": "2025-05-01T23:10:20.621Z"
      },
      {
        "id": "fMH2im2pHJBOzkXp",
        "name": "document-qa",
        "createdAt": "2025-05-01T23:10:07.948Z",
        "updatedAt": "2025-05-01T23:10:07.948Z"
      },
      {
        "id": "ghpuX9kkAqpLyIVR",
        "name": "n8n-ai",
        "createdAt": "2025-05-01T23:10:38.373Z",
        "updatedAt": "2025-05-01T23:10:38.373Z"
      },
      {
        "id": "tSHEttl48VrqMYiV",
        "name": "supabase",
        "createdAt": "2025-05-01T23:10:16.583Z",
        "updatedAt": "2025-05-01T23:10:16.583Z"
      }
    ],
    "nodes": [
      {
        "id": "0213dfab-a1b2-42c9-9ab1-8a0f1de4c4c0",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          480,
          40
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-flash-preview-04-17"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "QuysglXiB421WI90",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9c166f83-8ea4-4dc7-8ea2-92ec186c9f32",
        "name": "OpenWeatherMap",
        "type": "n8n-nodes-base.openWeatherMapTool",
        "position": [
          740,
          -100
        ],
        "parameters": {
          "cityName": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('City', ``, 'string') }}"
        },
        "credentials": {
          "openWeatherMapApi": {
            "id": "MCzSGdWHBJE7l1aN",
            "name": "OpenWeatherMap account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "aa0abeff-b5e9-497b-9d9c-8f79721a5c11",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          480,
          -320
        ],
        "parameters": {
          "text": "={{ $json.message.text }}",
          "options": {
            "systemMessage": "=4. If the user sends you a message starting with / sign, it means this is a Telegram bot command. For example, all users send /start command as their first message. Try to figure out what these commands mean and reply accodringly.\nUser can only send pdf files and text messages and let them know that this type is not supported if it was not a PDF file or text.\nAt first let them know that they can ask questions about sent PDF files you can use your own capabilities as well. \nGenerate a detailed, well-structured response ,\nFormat the response strictly using Telegram's supported HTML syntax. Use tags like <b>, <i>, <u>, <s>, <span class=\"tg-spoiler\">, <code>, <pre> (with optional <code class=\"language-...\"> inside), <a href=\"...\">, and <blockquote> where appropriate.\n\nStructure the content logically using paragraphs and distinct sections. **Be mindful that this text might need to be split into multiple messages due to character limits (Telegram's limit is around 4096 characters per message). Try to make sections or paragraphs relatively self-contained where possible to facilitate splitting.**\n\n**Ensure all <, >, and & symbols within the *text content* (i.e., not part of an HTML tag or entity) are replaced with the corresponding HTML entities: < with &lt;, > with &gt;, and & with &amp;.**\n\nMaintain proper nesting of HTML tags according to Telegram's rules. While the final splitting will be handled by a script, aim for a structure that is easy to break into logical parts without leaving tags improperly open mid-message."
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "72b85aff-4fe7-4705-a07c-463f381cb806",
        "name": "Telegram Trigger",
        "type": "n8n-nodes-base.telegramTrigger",
        "position": [
          -20,
          100
        ],
        "webhookId": "d4f286b2-8094-40e3-aeb2-813eb1895ecf",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "jOxapcl3g1n1HrCE",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ea716dba-2856-40a8-ad73-86132f52dda8",
        "name": "Telegram",
        "type": "n8n-nodes-base.telegram",
        "onError": "continueErrorOutput",
        "position": [
          1540,
          -320
        ],
        "webhookId": "137d8d2f-a941-4803-8646-8932525360c3",
        "parameters": {
          "text": "={{ $json.text }}",
          "chatId": "={{ $json.chatId }}",
          "additionalFields": {
            "parse_mode": "HTML",
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "jOxapcl3g1n1HrCE",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2,
        "alwaysOutputData": true
      },
      {
        "id": "59a22620-0d26-4e19-940a-5c07efccbdfa",
        "name": "Think",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          640,
          -100
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "7bb66887-c9c6-4057-bbc0-306d1e20ea12",
        "name": "Embeddings Google Gemini",
        "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
        "position": [
          840,
          340
        ],
        "parameters": {
          "modelName": "models/text-embedding-004"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "QuysglXiB421WI90",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "668db8fd-3d5f-433a-8ccb-4bea237107ce",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          1220,
          460
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "d1495354-bfc0-4ef1-9102-dc3577580d5b",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          1440,
          620
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "6a8e5ce6-4c52-4ca0-962f-045ea42dac7c",
        "name": "Extract from File",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          1020,
          480
        ],
        "parameters": {
          "options": {},
          "operation": "pdf"
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "3f4a9da9-0364-4861-a6f3-33b1d5c501e0",
        "name": "Answer questions with a vector store",
        "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
        "position": [
          860,
          -60
        ],
        "parameters": {
          "description": "Use this data if the user's question appears to reference an uploaded file, document content, or specific information that might be stored in prior user documents. If not relevant, ignore this source."
        },
        "typeVersion": 1.1
      },
      {
        "id": "933a93c7-9401-4bac-9b9c-395866b46d61",
        "name": "Supabase Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          760,
          80
        ],
        "parameters": {
          "options": {
            "queryName": "match_documents"
          },
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "user_knowledge_base",
            "cachedResultName": "user_knowledge_base"
          }
        },
        "credentials": {
          "supabaseApi": {
            "id": "jq6dt73fwyUImYqH",
            "name": "Supabase account"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "5f37c202-a1ca-4ee0-9de0-267349adffbd",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          360,
          200
        ],
        "parameters": {
          "color": 5,
          "width": 1625,
          "height": 779,
          "content": "✅ Scenario 2 – Document Upload and Embedding\n\nFlow for downloading a document sent via Telegram, extracting its text, generating embeddings, and inserting them into Supabase Vector Store."
        },
        "typeVersion": 1
      },
      {
        "id": "6e9c1070-90bc-4ab7-a8a0-62461bede708",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          360,
          -420
        ],
        "parameters": {
          "color": 5,
          "width": 1625,
          "height": 599,
          "content": "✅ Scenario 1 – Chatbot Interaction\n\nFlow for handling user messages sent to the bot. Includes accessing weather data, answering questions based on user-uploaded documents, and running code using a code execution tool."
        },
        "typeVersion": 1
      },
      {
        "id": "3b211a14-6813-459f-8d23-b40fc0eb4bd6",
        "name": "Telegram - Embedding Complete",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1760,
          320
        ],
        "webhookId": "4eaead72-f9a7-49a3-95ca-b3bc8f6b9a95",
        "parameters": {
          "text": "=✅ Document saved!\nFeel free to start asking questions about it.",
          "chatId": "={{ $('Command Router').item.json.message.chat.id }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "jOxapcl3g1n1HrCE",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "05703266-aaed-491d-87a6-ed7f96a9c49a",
        "name": "Supabase - Save Embeddings",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          1200,
          320
        ],
        "parameters": {
          "mode": "insert",
          "options": {},
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": "user_knowledge_base",
            "cachedResultName": "user_knowledge_base"
          }
        },
        "credentials": {
          "supabaseApi": {
            "id": "jq6dt73fwyUImYqH",
            "name": "Supabase account"
          }
        },
        "typeVersion": 1.1,
        "alwaysOutputData": false
      },
      {
        "id": "3b7db0e6-b551-4698-921a-306e837ceffc",
        "name": "Command Router",
        "type": "n8n-nodes-base.switch",
        "position": [
          160,
          100
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "document",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "loose"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "895b32db-777d-4d8e-b1d3-596cc9863d09",
                      "operator": {
                        "type": "boolean",
                        "operation": "exists",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.message.document }}",
                      "rightValue": "={{ $json.message.document }}"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "text",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "loose"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "26c12573-8e00-4832-8410-73d2d739c455",
                      "operator": {
                        "type": "boolean",
                        "operation": "exists",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.message.text }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {
            "fallbackOutput": "extra"
          },
          "looseTypeValidation": true
        },
        "typeVersion": 3.2
      },
      {
        "id": "fa06fc6c-3661-4065-81fc-09f93d6a4a25",
        "name": "Telegram - Download file",
        "type": "n8n-nodes-base.telegram",
        "position": [
          600,
          540
        ],
        "webhookId": "11b8f884-34bc-401c-8978-b28507d96e40",
        "parameters": {
          "fileId": "={{ $('Telegram Trigger').item.json.message.document.file_id }}",
          "resource": "file"
        },
        "credentials": {
          "telegramApi": {
            "id": "jOxapcl3g1n1HrCE",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "756a36aa-187d-48ca-894c-f8c9a79a4794",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "notes": "This is used to flag the end of progress—no real aggregation.",
        "position": [
          1580,
          320
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {}
            ]
          }
        },
        "notesInFlow": true,
        "typeVersion": 1
      },
      {
        "id": "3b49f357-5d21-4710-bd32-3218d23b1bd9",
        "name": "Fallback- No formatting",
        "type": "n8n-nodes-base.telegram",
        "notes": "This is used if, even after HTML formatting,g Telegram wasn't able to process the text, so we send it without formatting.",
        "position": [
          1740,
          -260
        ],
        "webhookId": "dd2182fe-0b11-4d96-9838-30d60bf8c229",
        "parameters": {
          "text": "={{ $('Manual Mapping').item.json.text }}",
          "chatId": "={{ $('Manual Mapping').item.json.chatId }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "jOxapcl3g1n1HrCE",
            "name": "Telegram account"
          }
        },
        "notesInFlow": true,
        "typeVersion": 1.2
      },
      {
        "id": "eafdbacb-17e5-4de6-a4e9-b986140353e5",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1120,
          -320
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "output"
        },
        "typeVersion": 1
      },
      {
        "id": "538be3ed-4bd6-4295-ac11-e4d46b943f5a",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          540,
          -100
        ],
        "parameters": {
          "sessionKey": "={{ $('Telegram Trigger').item.json.message.from.id }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "0afca77d-0e08-4f04-a6d3-b107c1dd54f9",
        "name": "Handle formatting and split",
        "type": "n8n-nodes-base.code",
        "notes": "This is used to prevent Markdown issues in Telegram while sending messages.",
        "position": [
          900,
          -320
        ],
        "parameters": {
          "language": "python",
          "pythonCode": "import re\nimport html\n\ngemini_output_text = _('AI Agent').first().json.output;\n# Regex to match any HTML tag <...>\nHTML_TAG_PATTERN = re.compile(r'(<[^>]*?>)', re.IGNORECASE)\n\n# List of UNSUPPORTED Telegram HTML tag names\nUNSUPPORTED_TAG_NAMES = [\n    'p', 'li', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'ul', 'ol',\n    'table', 'thead', 'tbody', 'tr', 'td', 'th', 'div', 'br', 'font',\n    'span', # Span is unsupported *unless* it has the specific class\n    'a'     # A is unsupported *unless* it has the href attribute\n    # Add more unsupported tags if you encounter them\n]\n\n# Regex to match unsupported opening or closing tags based on the names list\n# This pattern is simplified and might misinterpret complex attributes\nUNSUPPORTED_TAG_PATTERN = re.compile(r'<\\/?(' + '|'.join(UNSUPPORTED_TAG_NAMES) + r')\\b[^>]*?>', re.IGNORECASE)\n\n# Regex to match a span tag *without* the class=\"tg-spoiler\" attribute\n# This tries to capture the tag and its content to remove both\nUNSUPPORTED_SPAN_FULL_PATTERN = re.compile(r'<span(?! class=\"tg-spoiler\"\\b)[^>]*?>.*?<\\/span>', re.IGNORECASE | re.DOTALL) # DOTALL allows . to match newlines\n\n# Regex to match an a tag *without* an href attribute\n# This tries to capture the tag and its content to remove both\nUNSUPPORTED_A_FULL_PATTERN = re.compile(r'<a(?![^>]*href=)[^>]*?>.*?<\\/a>', re.IGNORECASE | re.DOTALL)\n\n\n# --- Cleaning Function (Regex Only) ---\n\ndef unescape_common_html_entities(text):\n    \"\"\"\n    Unescapes a limited set of common HTML entities in text.\n    Does NOT use html.unescape for maximum compatibility with \"no external library\" rule.\n    \"\"\"\n    # Order matters: &amp; must be replaced first!\n    text = text.replace('&amp;', '&')\n    text = text.replace('&lt;', '<')\n    text = text.replace('&gt;', '>')\n    text = text.replace('&quot;', '\"')\n    text = text.replace('&apos;', \"'\")\n    # Add more common entities here if needed, e.g., text = text.replace('&nbsp;', ' ')\n    return text\n\n\ndef clean_html_regex_only(html_string):\n    \"\"\"\n    Cleans HTML string using regex: removes unsupported tags and escapes text content.\n    Handles &apos; and other basic entities.\n    WARNING: This is a regex-based approach and is NOT as robust as using an HTML parser.\n    It may fail on complex or malformed HTML.\n\n    Args:\n        html_string (str): The input HTML string.\n\n    Returns:\n        str: The cleaned HTML string.\n    \"\"\"\n    # 1. Remove unsupported tags and their content where specific attributes are missing\n    # Process specific full patterns first\n    cleaned_text = UNSUPPORTED_SPAN_FULL_PATTERN.sub('', html_string)\n    cleaned_text = UNSUPPORTED_A_FULL_PATTERN.sub('', cleaned_text)\n\n    # 2. Remove remaining unsupported opening/closing tags, leaving content behind\n    cleaned_text = UNSUPPORTED_TAG_PATTERN.sub('', cleaned_text)\n\n    # 3. Split the remaining string into tags and text segments\n    # This pattern captures the tags themselves so we can differentiate them from text\n    parts = HTML_TAG_PATTERN.split(cleaned_text)\n\n    cleaned_parts = []\n    for part in parts:\n        if not part:\n            continue\n\n        if HTML_TAG_PATTERN.fullmatch(part):\n            # If the part is a tag (matches the full tag pattern)\n            # We assume at this point it's a supported tag due to previous removal steps.\n            # Keep the tag as is.\n            cleaned_parts.append(part)\n        else:\n            # If the part is text content\n            # 1. Unescape common HTML entities (like &apos;) that might be in the text\n            unescaped_text = unescape_common_html_entities(part)\n\n            # 2. Escape the literal characters <, >, & that are *in* the text content\n            # This ensures only the characters themselves are escaped, not entities.\n            # Need to escape & first to avoid issues with '&amp;' if it resulted from unescaping or was original.\n            re_escaped_text = unescaped_text.replace('&', '&amp;').replace('<', '&lt;').replace('>', '&gt;')\n\n            cleaned_parts.append(re_escaped_text)\n\n    # Join the processed parts back into a single string\n    return \"\".join(cleaned_parts)\n\n# --- Splitting Logic ---\nSPLIT_PATTERN_REGEX_ONLY = re.compile(r'(<\\/blockquote>|<\\/pre>|\\n\\n|\\s{2,}|(?<=[.!?])\\s+|<[a-z]+[^>]*?>|<\\/[a-z]+>)', flags=re.IGNORECASE)\n\n\ndef split_telegram_message_regex_only(text, max_length=4096):\n    \"\"\"\n    Splits text into multiple messages based on character count and basic patterns.\n    Operates on text already cleaned by clean_html_regex_only.\n    Does NOT guarantee HTML tag integrity across splits due to lack of parsing.\n\n    Args:\n        text (str): The input text (preferably cleaned by clean_html_regex_only).\n        max_length (int): The maximum length for each message part.\n\n    Returns:\n        list: A list of strings, where each string is a message part.\n    \"\"\"\n    if len(text) <= max_length:\n        return [text]\n\n    messages = []\n    current_chunk = \"\"\n\n    # Split by the defined pattern\n    parts = SPLIT_PATTERN_REGEX_ONLY.split(text)\n\n    for part in parts:\n        # Handle parts that are None (can happen with split) or just short whitespace\n        if part is None or (not part.strip() and len(part) < 2 and part != '\\n\\n'):\n             if part is not None and len(part) > 0: # Keep meaningful whitespace splits like \\n\\n\n                  if len(current_chunk) + len(part) <= max_length:\n                       current_chunk += part\n                  else:\n                       # Split happens within meaningful whitespace, finalize chunk\n                       if current_chunk.strip(): # Only add if chunk has content\n                            messages.append(current_chunk.strip())\n                       current_chunk = part # Start new chunk with the whitespace\n             continue # Skip to next part\n\n\n        # Check if adding the current part exceeds the max length\n        if len(current_chunk) + len(part) > max_length:\n            # If the current chunk is empty or only whitespace after stripping,\n            # it means the 'part' itself is too long to fit in a new chunk.\n            if not current_chunk.strip():\n                # Handle very long individual parts (e.g., a huge code block line, a very long word, a single huge tag)\n                # Hard split the long part. WARNING: This can break tags, words, or escape sequences.\n                while len(part) > max_length:\n                    messages.append(part[:max_length])\n                    part = part[max_length:]\n                if part.strip():\n                    current_chunk = part # Remaining part starts a new chunk\n                else:\n                     current_chunk = \"\" # If remainder is just whitespace, clear\n            else:\n                # The current part makes the chunk too long, finalize the current chunk\n                messages.append(current_chunk.strip())\n                # Start a new chunk with the current part\n                current_chunk = part # Keep original part for the new chunk\n\n        else:\n            # Add the current part to the chunk\n            current_chunk += part\n\n    # Add the last chunk\n    if current_chunk.strip(): # Only add if the final chunk has content\n        messages.append(current_chunk.strip())\n\n    # Clean up any empty messages that might have been created\n    messages = [msg for msg in messages if msg.strip()]\n\n    return messages\n  \ncleaned_html_regex = clean_html_regex_only(gemini_output_text)\nmessage_parts_regex = split_telegram_message_regex_only(cleaned_html_regex)\n\nreturn dict({'output': message_parts_regex })"
        },
        "typeVersion": 2
      },
      {
        "id": "dbea9e13-6ad4-4eb3-8da1-9db9e2116283",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2000,
          -420
        ],
        "parameters": {
          "width": 1960,
          "height": 3520,
          "content": "# 🤖 Telegram AI Assistant for Your Documents (n8n + Supabase + Gemini)\n\nThis project transforms a standard **Telegram bot** into your dedicated AI assistant – designed to understand and answer questions based on **your own documents**. It seamlessly integrates the power of **Google Gemini** for advanced language capabilities and **Supabase's vector database** for efficient, intelligent document retrieval. Built entirely within the no-code platform **n8n**, it allows you to deploy a sophisticated document chatbot without writing a single line of code.\n\nSimply upload any PDF document to the bot, and instantly gain the ability to chat with it, querying its contents as if it were a knowledgeable expert on your uploaded files.\n\n---\n## 📹 Watch the Bot in Action\n\n[![𝗨𝗻𝗹𝗲𝗮𝘀𝗵𝗶𝗻𝗴 𝗔𝗜 𝗼𝗻 𝗠𝘆 𝗕𝗼𝗼𝗸𝘀𝗵𝗲𝗹𝗳: 𝗙𝗹𝗼𝘄 𝗣𝗿𝗼𝗴𝗿𝗮𝗺𝗺𝗶𝗻𝗴 𝗣𝗼𝘄𝗲𝗿𝘀 𝗮 𝗡𝗲𝘅𝘁-𝗟𝗲𝘃𝗲𝗹 𝗧𝗲𝗹𝗲𝗴𝗿𝗮𝗺 𝗕𝗼𝘁🤖](https://img.youtube.com/vi/r_KGyJApy5M/maxresdefault.jpg)](https://www.youtube.com/watch?v=r_KGyJApy5M)\n\n**▶️ Click the image above to watch a live demo on YouTube.** \n\nThis video provides a live demonstration of the bot's core features and how it interacts. See a quick walkthrough of its capabilities and user flow.\n\n---\n\n## ✨ Ignite Your Workflow: Use Cases\n\nThis project empowers two core interactions:\n\n### 1. Conversational AI Interface (User Inquiry → Telegram Bot → Intelligent Answers)\n- Users pose questions directly to the Telegram bot.\n- The bot generates relevant, informative answers using the cutting-edge capabilities of the Google Gemini LLM.\n- Leveraging a powerful vector search mechanism, it can pull specific, contextual information from previously uploaded documents to provide highly relevant and informed responses.\n- (Optional) Augment answers with real-time data, like current **weather information**.\n\n### 2. Effortless Document Integration (User Upload PDF → Processing → Searchable Knowledge)\n- Users upload a PDF document directly to the bot.\n- The workflow automatically parses the document content, converts it into numerical representations called embeddings using Gemini's embedding models.\n- These embeddings, alongside the document's text content, are then securely stored in a dedicated **Supabase vector table**, creating a searchable knowledge base.\n- Immediately after successful processing, the document becomes part of the bot's memory, enabling users to ask questions about its contents via the standard chat interface.\n\n---\n## 🧠 Core Intelligence Features\n\n- ✅ **Pure No-Code**: Developed and managed entirely within the intuitive [n8n](https://n8n.io) automation platform.\n- 📄 **Seamless PDF Integration**: Easily upload and process PDF documents to expand the bot's knowledge.\n- 🧠 **Powered by Google Gemini**: Utilizes Gemini for both generating document embeddings and formulating intelligent conversational responses.\n- 🗂 **Vector Database Memory (Supabase)**: Employs **Supabase as a robust vector database** for storing and efficiently searching document embeddings, providing the bot with long-term memory about your content.\n- **⚡️ Rapid & Private Retrieval**: The vector search allows for swift identification and retrieval of the most relevant document snippets based on the user's query. This approach enhances response speed and significantly improves data privacy, as **the original document content remains securely stored in your Supabase instance, and only the user's query and the retrieved relevant chunks are sent to the LLM for generating a response.**\n- 🧹 **Intelligent HTML Post-processing**: Cleans the LLM's responses by removing HTML tags not supported by Telegram while preserving essential formatting and correctly escaping special characters in the text content.\n- 📤 **Adaptive Message Chunking**: Splits lengthy AI-generated answers into multiple messages that adhere to Telegram's 4096-character limit, ensuring the full response is delivered cleanly.\n- 🌦️ **Dynamic Weather Data**: (Optional) Integrates with OpenWeatherMap to provide current weather information upon request.\n- **📝 Note on Usage**: This workflow is designed primarily for **personal, single-user** scenarios. It processes each message independently and **does not include multi-user session management**, making it unsuitable for public deployment where different users require separate conversational contexts. For a session-based Telegram bot implemented in Python, you may refer to this project, which is a multi-model telegram bot: [https://github.com/mohamadghaffari/gemini-tel-bot](https://github.com/mohamadghaffari/gemini-tel-bot).\n---\n\n## 🛠 Getting Started: Setup\n\n### 1. Deploy the Workflow in n8n\n\n- Click the \"Use this workflow\" button on the n8n template page.\n- This will open the workflow directly in your n8n instance, ready for configuration.\n\n\n### 2. Connect Your Services: Configure Credentials\n\nCreate API credentials for the following services within your n8n instance:\n\n| Service          | Purpose                          |\n|------------------|------------------------------------|\n| Telegram API     | Receiving user messages & sending replies |\n| Google Gemini    | Generating embeddings & LLM responses |\n| Supabase         | Storing & searching document vectors |\n| OpenWeatherMap   | (Optional) Fetching weather data    |\n\n### 3. Prepare Your Supabase Knowledge Base\n\nSet up a vector-enabled table in your Supabase project to store your document embeddings. Execute the following SQL commands in your Supabase SQL Editor:\n\n``` sql\n-- Enable the pgvector extension to work with embedding vectors\ncreate extension vector;\n\n-- Create a table to store your documents and their embeddings\ncreate table user_knowledge_base (\n  id bigserial primary key,\n  content text, -- Stores the text chunk from the document\n  metadata jsonb, -- Stores document information (e.g., filename, page number)\n  embedding vector(768) -- Stores the vector representation (embedding) generated by Gemini. Adjust dimension if using a different model.\n);\n\n-- Create a function to perform vector similarity search against your documents\ncreate function match_documents (\n  query_embedding vector(768),\n  match_count int default null,\n  filter jsonb DEFAULT '{}'\n) returns table (\n  id bigint,\n  content text,\n  metadata jsonb,\n  similarity float\n)\nlanguage plpgsql\nas $$\n#variable_conflict use_column\nbegin\n  return query\n  select\n    id,\n    content,\n    metadata,\n    -- Calculate cosine similarity: 1 - cosine distance (using the '<=>' operator provided by pgvector)\n    1 - (user_knowledge_base.embedding <=> query_embedding) as similarity\n  from user_knowledge_base\n  where metadata @> filter -- Optional: filter results based on metadata\n  order by user_knowledge_base.embedding <=> query_embedding -- Order by similarity (closest first)\n  limit match_count; -- Limit the number of results\nend;\n$$;\n````\n\nThis sets up the necessary table and a function to perform vector similarity searches, allowing you to find document chunks most similar to a user's query.\n-----\n\n## 📚 Integrated Technologies\n\nThis project brings together powerful tools:\n\n  - [n8n](https://n8n.io) – The central hub for workflow automation and integration.\n  - [Telegram Bot API](https://core.telegram.org/bots/api) – The communication layer for user interaction.\n  - [Supabase](https://supabase.com/) + [pgvector Extension](https://www.google.com/search?q=https://supabase.com/docs/guides/ai/vector-embeddings) – Provides a scalable database with powerful vector search capabilities.\n  - [Google Gemini API](https://ai.google.dev/) – The intelligence engine for embeddings and text generation.\n  - [OpenWeatherMap API](https://openweathermap.org/api) – (Optional) For adding real-time weather features.\n\n-----\n"
        },
        "typeVersion": 1
      },
      {
        "id": "965ba2bd-747d-4718-a76e-9f7d685dcea4",
        "name": "Manual Mapping",
        "type": "n8n-nodes-base.set",
        "position": [
          1320,
          -320
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "cdeb5bf1-c91c-44ae-bebd-ab3f4ba2561a",
                "name": "text",
                "type": "string",
                "value": "={{ $json.output }}"
              },
              {
                "id": "7cd7d120-96fa-4539-b343-25bc9b75abb4",
                "name": "chatId",
                "type": "number",
                "value": "={{ $('Command Router').item.json.message.from.id }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "c6a315f1-6f0b-4127-b377-b7b12975929f",
        "name": "Unsupported message",
        "type": "n8n-nodes-base.telegram",
        "position": [
          500,
          760
        ],
        "webhookId": "52f3456a-06ef-4799-b245-0293213dcc4b",
        "parameters": {
          "text": "Unsupported command or file. 😓 Please upload a valid PDF document or ask your question regarding your files.",
          "chatId": "={{ $('Command Router').item.json.message.chat.id }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "jOxapcl3g1n1HrCE",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "375bd185-3836-4f25-8708-d6dcd79b2675",
        "name": "Send processing document message",
        "type": "n8n-nodes-base.telegram",
        "position": [
          920,
          720
        ],
        "webhookId": "32ade357-f14b-4d10-91f2-02c8aa6e198e",
        "parameters": {
          "text": "=<b>Processing document...</b>\n<b>Please wait...⏳</b>",
          "chatId": "={{ $('Command Router').item.json.message.chat.id }}",
          "additionalFields": {
            "parse_mode": "HTML",
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "jOxapcl3g1n1HrCE",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "d01f8b15-e495-46cf-bfdf-20b4399c23d7",
        "name": "Send embedding Started message",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1220,
          660
        ],
        "webhookId": "32ade357-f14b-4d10-91f2-02c8aa6e198e",
        "parameters": {
          "text": "=<b>Document processed ✅ </b> \n<b>Num of pages:</b> {{ $json.numpages }} \n<b>Creator:</b> {{ $json.info.Creator }}\n<b>Title:</b> {{ $json.info.Title }} \n<b>Version:</b> {{ $json.version }}",
          "chatId": "={{ $('Command Router').item.json.message.chat.id }}",
          "additionalFields": {
            "parse_mode": "HTML",
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "jOxapcl3g1n1HrCE",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "749ec7d0-e135-478a-b02e-9241dbf4ab68",
    "connections": {
      "Think": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Handle formatting and split",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram": {
        "main": [
          [],
          [
            {
              "node": "Fallback- No formatting",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Telegram - Embedding Complete",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Manual Mapping",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Command Router": {
        "main": [
          [
            {
              "node": "Telegram - Download file",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Unsupported message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Manual Mapping": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenWeatherMap": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "Command Router",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File": {
        "main": [
          [
            {
              "node": "Supabase - Save Embeddings",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send embedding Started message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Supabase - Save Embeddings",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Supabase Vector Store": {
        "ai_vectorStore": [
          [
            {
              "node": "Answer questions with a vector store",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings Google Gemini": {
        "ai_embedding": [
          [
            {
              "node": "Supabase - Save Embeddings",
              "type": "ai_embedding",
              "index": 0
            },
            {
              "node": "Supabase Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            },
            {
              "node": "Answer questions with a vector store",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Telegram - Download file": {
        "main": [
          [
            {
              "node": "Extract from File",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send processing document message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Supabase - Save Embeddings": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Handle formatting and split": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send embedding Started message": {
        "main": [
          []
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Answer questions with a vector store": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "0d03b8ca9863cd411d83cbb216b64521ed54758bcdb975c16af21d8813d90147",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "bbb66001-07da-4516-a07a-314b7a1393ac",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          660,
          -840
        ],
        "webhookId": "b9eca9d4-1459-4a95-b584-68866b86209e",
        "parameters": {
          "public": true,
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "ee1f2819-7c49-4914-ba2e-3de145fae2d1",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1692,
          -1140
        ],
        "parameters": {
          "options": {
            "systemMessage": "=## Overview\nyou are an intelligent, professional, and personable AI chatbot designed to provide exceptional customer support on the DGM website. you serve as the first point of contact, delivering real-time assistance with company information, services, pricing, scheduling, and general inquiries while maintaining a warm, professional demeanor.\n\n## Core Identity & Personality\n- **Primary Role**: Customer support specialist and company ambassador\n- **Communication Style**: 80% professional, 20% conversational with strategic emoji use\n- **Tone**: Warm, helpful, knowledgeable, and proactive\n- **Approach**: Solution-oriented with emphasis on user satisfaction\n\n## Key Capabilities\n\n### 1. Intelligent User Recognition & Greetings\n**For Known/Returning Users:**\n- \"Hi {USER_NAME}! Welcome back to DGM 👋 How can I assist you today?\"\n- \"Hello {USER_NAME}! Great to see you again. What brings you back to DGM today?\"\n\n### 2. Retrieve Data From Vector Store\n- Use the Vector Store Tool to retrieve all of the information about DGM website when the user asks about it or needs help. NEVER tell the user where you got the information and just tell them what they need.\n\n**For New/Anonymous Users:**\n- \"Hey there! Welcome to DGM 👋 I'm you. What can I help you with today?\"\n- \"Welcome to DGM! I'm you, here to help you navigate our services. How may I assist you?\"\n\n### 2. Conversational Examples\n\n#### Date/Time Inquiries\n**User**: \"What's today's date?\"\n**you**: \"Sure! 📅 Today is {DAY, MONTH DATE YEAR}. Is there something specific you'd like to schedule or check on our calendar?\"\n\n**User**: \"What time is it?\"\n**you**: \"It's currently {TIME}. Our support hours are [insert hours] if you need additional assistance!\"\n\n#### Service Information\n**User**: \"What services do you offer?\"\n**you**: \"Great question! 🎯 Here at DGM, we specialize in:\n• [Service 1 with brief description]\n• [Service 2 with brief description] \n• [Service 3 with brief description]\n\nWould you like me to dive deeper into any of these, or help you find the best fit for your needs?\"\n\n#### Pricing Inquiries\n**User**: \"How much does your basic service cost?\"\n**you**: \"Let me get you those details! 💰 \nOur Basic Service package starts at $10.23 per session and includes:\n• [Feature 1]\n• [Feature 2]\n• [Feature 3]\n\nWould you like to see our complete pricing breakdown or explore what's included in our other packages?\"\n\n#### Booking/Scheduling\n**User**: \"Can I book an appointment?\"\n**you**: \"Absolutely! 📅 I'd be happy to help you schedule an appointment. \nTo get started, could you let me know:\n• Which service you're interested in?\n• Your preferred date/time?\n• Any specific requirements?\n\nI'll find the perfect slot for you!\"\n\n### 3. Memory Management\nyou automatically captures and stores relevant user information including:\n- **Personal Details**: Name, preferences, previous interactions\n- **Service History**: Past bookings, service preferences, feedback\n- **Context**: Ongoing conversations, unresolved issues, follow-up needs\n- **Behavioral Patterns**: Preferred communication style, typical inquiry types\n\n### 4. Proactive Assistance Features\n- **Anticipatory Help**: Offers relevant information before being asked\n- **Follow-up Questions**: Ensures complete issue resolution\n- **Cross-selling**: Suggests complementary services when appropriate\n- **Preventive Support**: Identifies potential issues and addresses them early\n\n### 5. Multilingual Support Protocol\nWhen users communicate in languages other than English:\n- **Immediate Language Matching**: Respond in the user's detected language\n- **Cultural Sensitivity**: Adapt communication style to cultural norms\n- **Clarification Protocol**: \"I'd be happy to continue in [Language]. Is this your preferred language for our conversation?\"\n\n## Conversation Flows\n\n### Initial Contact Optimization\n1. **Greeting** → **Quick Needs Assessment** → **Immediate Value Delivery**\n2. **Context Gathering** → **Personalized Response** → **Next Steps**\n\n### Problem Resolution Framework\n1. **Issue Identification** → **Clarification** → **Solution Presentation** → **Confirmation** → **Follow-up**\n\n### Escalation Protocol\nWhen you cannot resolve an issue:\n\"I want to make sure you get the best possible help with this 🤔. Let me connect you with our specialized support team who can dive deeper into [specific issue]. You can reach them at [contact info], or I can facilitate that connection right now. Meanwhile, is there anything else I can help you with today?\"\n\n## Features\n\n### 1. Context Awareness\n- Remember conversation history within sessions\n- Reference previous interactions appropriately\n- Maintain topic continuity across message exchanges\n\n### 2. Emotional Intelligence\n- Detect user frustration and adjust tone accordingly\n- Celebrate user successes and positive outcomes\n- Provide empathetic responses to user concerns\n\n### 3. Business Intelligence\n- Track common user questions for FAQ improvements\n- Identify service gaps through user inquiries\n- Monitor satisfaction indicators in conversations\n\n### 4. Dynamic Content Delivery\n- Personalize information based on user profile\n- Prioritize most relevant services/features\n- Adapt complexity level to user expertise\n\n## Quality Assurance Standards\n\n### Response Quality Criteria\n- **Accuracy**: All information must be current and correct\n- **Completeness**: Address all aspects of user inquiries\n- **Clarity**: Use clear, jargon-free language\n- **Efficiency**: Provide concise yet comprehensive responses\n- **Engagement**: Maintain user interest and encourage further interaction\n\n### Error Handling\n- **Acknowledgment**: \"I apologize, but I'm not certain about that specific detail.\"\n- **Alternative Solutions**: \"However, I can help you with [related option].\"\n- **Escalation Path**: \"Let me connect you with someone who specializes in this area.\"\n- **Follow-up Commitment**: \"I'll make sure to learn more about this for future conversations.\"\n\n## Technical Implementation Notes\n\n### Memory Management\n- Store user interactions with timestamps\n- Categorize information by relevance and type\n- Implement data retention policies per privacy requirements\n- Enable memory search and retrieval for context\n\n{{ $json.memories.toJsonString() }}\n\n### Integration Requirements\n- **CRM Integration**: Sync user data with customer management systems\n- **Booking Systems**: Direct integration with scheduling platforms\n- **Knowledge Base**: Real-time access to updated company information\n- **Analytics**: Track conversation metrics and user satisfaction\n\n### Performance Metrics\n- **Response Time**: Target <2 seconds for standard queries\n- **Resolution Rate**: Track first-contact resolution percentage\n- **User Satisfaction**: Monitor feedback and ratings\n- **Engagement**: Measure conversation length and return rates\n\n## Continuous Improvement Framework\n- Regular analysis of conversation patterns\n- User feedback integration for response optimization\n- A/B testing for greeting and response variations\n- Quarterly review of personality and tone effectiveness\n\n## Privacy & Security Considerations\n- Comply with data protection regulations\n- Secure storage of user memories and personal information\n- Clear data retention and deletion policies\n- User consent management for data collection\n\n## RULES\n!! IMPORTANT !!\n- If you don't understand or don't know what the user is saying, do NOT make it look like you know. Tell the user politely that you don't understand or don't know and ask them to clarify what they meant.\n- Always use a markdown format when answering the user.\n\n## REMEMBER THAT YOU DON'T HAVE TO FOLLOW THE EXAMPLES WORD FOR WORD, BE CREATIVE AND CONSIDER THE USER'S PREFERENCES.\n\nThis is what the current date/time is: {{ $now }}"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "1d58365b-3331-4532-ba73-1d491b72d5b6",
        "name": "Save Memory",
        "type": "n8n-nodes-base.airtableTool",
        "position": [
          1860,
          -920
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "apptYPErvggfZVAEM",
            "cachedResultUrl": "https://airtable.com/apptYPErvggfZVAEM",
            "cachedResultName": "Agent Memories"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tbl0DO5x5Ejn42hCU",
            "cachedResultUrl": "https://airtable.com/apptYPErvggfZVAEM/tbl0DO5x5Ejn42hCU",
            "cachedResultName": "Table 1"
          },
          "columns": {
            "value": {
              "User": "Astrid",
              "Memories": "={{ $fromAI('memory') }}"
            },
            "schema": [
              {
                "id": "Memories",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Memories",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "User",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "User",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Created",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Created",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "create"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "ozaj4JK0Zbicl3hH",
            "name": "AI Memories"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "d496dcb7-d8fb-4c05-a2f1-fd4de825f4b6",
        "name": "Get Memories",
        "type": "n8n-nodes-base.airtable",
        "position": [
          880,
          -765
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "apptYPErvggfZVAEM",
            "cachedResultUrl": "https://airtable.com/apptYPErvggfZVAEM",
            "cachedResultName": "Agent Memories"
          },
          "sort": {
            "property": [
              {
                "field": "Created"
              }
            ]
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tbl0DO5x5Ejn42hCU",
            "cachedResultUrl": "https://airtable.com/apptYPErvggfZVAEM/tbl0DO5x5Ejn42hCU",
            "cachedResultName": "Table 1"
          },
          "options": {},
          "operation": "search",
          "filterByFormula": "({User} = 'Astrid')"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "ozaj4JK0Zbicl3hH",
            "name": "AI Memories"
          }
        },
        "typeVersion": 2.1,
        "alwaysOutputData": true
      },
      {
        "id": "98df3edd-e7b7-4433-a073-4bafd91f00bc",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          1100,
          -765
        ],
        "parameters": {
          "include": "specifiedFields",
          "options": {},
          "aggregate": "aggregateAllItemData",
          "fieldsToInclude": "Memories, Created",
          "destinationFieldName": "memories"
        },
        "typeVersion": 1
      },
      {
        "id": "27e407b1-3d2a-40b3-90a7-03b6b2163bfc",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          1320,
          -840
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineAll"
        },
        "typeVersion": 3.2
      },
      {
        "id": "d01a413f-64c9-4b52-887d-d8f9ffa0a7bc",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          1720,
          -920
        ],
        "parameters": {
          "contextWindowLength": 25
        },
        "typeVersion": 1.3
      },
      {
        "id": "4e8a2cc2-c848-459e-9093-35e37621fc3c",
        "name": "When clicking 'Test Workflow' button",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          760,
          -140
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "8fe55e76-9f22-4f0a-b151-c608ca4e6dfa",
        "name": "Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          980,
          -140
        ],
        "parameters": {
          "filter": {
            "folderId": {
              "__rl": true,
              "mode": "list",
              "value": "1k0w1u5s_qQKxqLnY5hHujiikoQD7eedT",
              "cachedResultUrl": "https://drive.google.com/drive/folders/1k0w1u5s_qQKxqLnY5hHujiikoQD7eedT",
              "cachedResultName": "AI"
            }
          },
          "options": {},
          "resource": "fileFolder",
          "returnAll": true
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "0386kzdcRPoTF9qX",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "64380fb2-04f0-4ff5-ac17-b83a39173031",
        "name": "Get Content",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1200,
          -140
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {},
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "0386kzdcRPoTF9qX",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "8801ac09-96a1-4024-a824-c9cc023233bf",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          1420,
          -140
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "48a698ce-1abf-44b7-870e-7007aec6b6b0",
        "name": "Pinecone Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "position": [
          1640,
          -140
        ],
        "parameters": {
          "mode": "insert",
          "options": {
            "pineconeNamespace": "DGM"
          },
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "n8n",
            "cachedResultName": "n8n"
          }
        },
        "credentials": {
          "pineconeApi": {
            "id": "tte2LJyeRje613eI",
            "name": "PineconeApi account 3"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6d9f0396-2bce-41c5-98e3-c6686c1349c3",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          1640,
          80
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "Z6xSXl8OK1Iqftip",
            "name": "OpenAi Account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c206d689-e381-482b-bb53-5bc99689869e",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          1760,
          80
        ],
        "parameters": {
          "options": {},
          "dataType": "binary"
        },
        "typeVersion": 1
      },
      {
        "id": "efb5dccc-509f-445d-beab-c5a4a3dad92f",
        "name": "Recursive Character Text Splitter",
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "position": [
          1840,
          280
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "7067fe20-938c-483b-9bf5-5c9fbb0e9c4b",
        "name": "Answer questions with a vector store",
        "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
        "position": [
          1960,
          -920
        ],
        "parameters": {
          "description": "Use this tool to retrieve data (Working hours, contacts, etc) from the files about the DGM website."
        },
        "typeVersion": 1.1
      },
      {
        "id": "e1c13db8-58ee-4daf-83b1-b5c7767d07b6",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2140,
          -720
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "Z6xSXl8OK1Iqftip",
            "name": "OpenAi Account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "90f31fb5-731f-461e-ae76-b30828cc4342",
        "name": "Pinecone Vector Store1",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "position": [
          1860,
          -720
        ],
        "parameters": {
          "options": {
            "pineconeNamespace": "DGM"
          },
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": "n8n",
            "cachedResultName": "n8n"
          }
        },
        "credentials": {
          "pineconeApi": {
            "id": "tte2LJyeRje613eI",
            "name": "PineconeApi account 3"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "1b90e47f-b373-4ed1-a69b-897f790b1f31",
        "name": "Embeddings OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          1940,
          -540
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "Z6xSXl8OK1Iqftip",
            "name": "OpenAi Account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "6f081578-2db6-4d3f-b09e-ce2b0f26c67b",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          588,
          -1200
        ],
        "parameters": {
          "width": 1760,
          "height": 820,
          "content": "## AI Agent\nThis is where the Chatbot is and all of the tools needed."
        },
        "typeVersion": 1
      },
      {
        "id": "55ee0fea-ef7c-402a-b29a-45646908b179",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          600,
          -320
        ],
        "parameters": {
          "color": 3,
          "width": 1540,
          "height": 740,
          "content": "## Document Processing \nThis is where the AI will retrieve, download, and process the documents (PDF, CSV,...) to be used by the AI Agent"
        },
        "typeVersion": 1
      },
      {
        "id": "6f2200f7-5cf2-4a56-b367-df54269ef719",
        "name": "OpenRouter Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          1580,
          -920
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openRouterApi": {
            "id": "HMyLi5miMzxH7lcw",
            "name": "OpenRouter account"
          }
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Get Content": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Memory": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Get Memories": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Drive": {
        "main": [
          [
            {
              "node": "Get Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Pinecone Vector Store",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Answer questions with a vector store",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Pinecone Vector Store",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store1": {
        "ai_vectorStore": [
          [
            {
              "node": "Answer questions with a vector store",
              "type": "ai_vectorStore",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Get Memories",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Answer questions with a vector store": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When clicking 'Test Workflow' button": {
        "main": [
          [
            {
              "node": "Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "fSG22q8TeUtsGUGD",
    "meta": {
      "instanceId": "31e69f7f4a77bf465b805824e303232f0227212ae922d12133a0f96ffeab4fef",
      "templateCredsSetupCompleted": true
    },
    "name": "📄✨ Easy Wordpress Content Creation from PDF Document + Human In The Loop with Gmail Approval",
    "tags": [],
    "nodes": [
      {
        "id": "77d8c73c-1cdd-4795-841c-29c3b85040e0",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1140,
          -860
        ],
        "parameters": {
          "color": 4,
          "width": 461,
          "height": 319,
          "content": "## Upload PDF and Extract Text"
        },
        "typeVersion": 1
      },
      {
        "id": "62dc4474-1803-4b6e-8fe5-530e9baf80f7",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1640,
          -860
        ],
        "parameters": {
          "color": 5,
          "width": 649,
          "height": 452,
          "content": "## Create Blog Post"
        },
        "typeVersion": 1
      },
      {
        "id": "b8da4206-f1b5-4a8f-b056-70c7558c825d",
        "name": "Upload PDF",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          1220,
          -760
        ],
        "webhookId": "6c4a4180-7206-469f-a645-f41824ccbf42",
        "parameters": {
          "path": "pdf",
          "options": {},
          "formTitle": "PDF2Blog",
          "formFields": {
            "values": [
              {
                "fieldType": "file",
                "fieldLabel": "Upload PDF File",
                "multipleFiles": false,
                "requiredField": true,
                "acceptFileTypes": ".pdf"
              }
            ]
          },
          "formDescription": "Transform PDFs into captivating blog posts"
        },
        "typeVersion": 2.1
      },
      {
        "id": "ef70bbe2-d66c-4c91-96cf-2d0500522e70",
        "name": "Extract Text",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          1420,
          -760
        ],
        "parameters": {
          "options": {},
          "operation": "pdf",
          "binaryPropertyName": "Upload_PDF_File"
        },
        "typeVersion": 1
      },
      {
        "id": "5de90f20-e0b3-4098-b5ae-c3bf5d724fcc",
        "name": "gpt-4o-mini",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1840,
          -600
        ],
        "parameters": {
          "options": {
            "responseFormat": "text"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "jEMSvKmtYfzAkhe6",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b6e33883-a13f-4bc8-bedc-18d93294ae75",
        "name": "pollinations.ai",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1520,
          300
        ],
        "parameters": {
          "url": "=https://image.pollinations.ai/prompt/{{ $('Get Blog Post').item.json.title }} and avoid adding text and keep the image vibrant.",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "d928d841-8098-406e-ad66-cf7ca653a2c4",
        "name": "Create Wordpress Post",
        "type": "n8n-nodes-base.wordpress",
        "onError": "continueRegularOutput",
        "position": [
          1220,
          300
        ],
        "parameters": {
          "title": "={{ $('Get Blog Post').item.json.title }}",
          "additionalFields": {
            "status": "draft",
            "content": "={{ $('Get Blog Post').item.json.content }}"
          }
        },
        "credentials": {
          "wordpressApi": {
            "id": "cOkzd5eeOiHaOXI2",
            "name": "Wordpress account"
          }
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "350cf732-037b-4e60-820e-4e38aecf7e57",
        "name": "Upload Image to Wordpress",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          1880,
          120
        ],
        "parameters": {
          "url": "https://[YOUR-WORDPRESS-SITE.com]/wp-json/wp/v2/media",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "binaryData",
          "sendHeaders": true,
          "authentication": "predefinedCredentialType",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Disposition",
                "value": "=attachment; filename=\"cover-image-{{ $('Create Wordpress Post').item.json.id }}.jpeg\""
              }
            ]
          },
          "inputDataFieldName": "data",
          "nodeCredentialType": "wordpressApi"
        },
        "credentials": {
          "wordpressApi": {
            "id": "cOkzd5eeOiHaOXI2",
            "name": "Wordpress account"
          }
        },
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "id": "0f85ff07-13fb-40d5-8eee-7946f7064874",
        "name": "Set Image on Wordpress Post",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          2100,
          120
        ],
        "parameters": {
          "url": "=https:/[YOUR-WORDPRESS-SITE.com]/wp-json/wp/v2/posts/{{ $('Create Wordpress Post').item.json.id }}",
          "method": "POST",
          "options": {},
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "featured_media",
                "value": "={{ $json.id }}"
              }
            ]
          },
          "nodeCredentialType": "wordpressApi"
        },
        "credentials": {
          "wordpressApi": {
            "id": "cOkzd5eeOiHaOXI2",
            "name": "Wordpress account"
          }
        },
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "id": "3bdc1e66-251f-4904-bbc2-dd4e667a4b40",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1140,
          40
        ],
        "parameters": {
          "color": 6,
          "width": 1146,
          "height": 521,
          "content": "## Create Wordpress Post and Add New Image\nhttps://docs.n8n.io/integrations/builtin/credentials/wordpress/"
        },
        "typeVersion": 1
      },
      {
        "id": "9d54b59e-5bf3-429b-856a-c3c1dcb25885",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1420,
          140
        ],
        "parameters": {
          "color": 7,
          "width": 300,
          "height": 340,
          "content": "## Create Post Image\nhttps://pollinations.ai/\nhttps://image.pollinations.ai/prompt/[your image description]"
        },
        "typeVersion": 1
      },
      {
        "id": "957b63d2-68af-4c44-b145-3460ed9ea0fc",
        "name": "Send Error Message",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1420,
          -240
        ],
        "webhookId": "382a3b43-b83f-47b1-a276-67c6b98a441a",
        "parameters": {
          "text": "=Error Creating Blog Post",
          "chatId": "={{ $env.TELEGRAM_CHAT_ID }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "pAIFhguJlkO3c7aQ",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ef768593-053c-4a65-8eb9-b489cb115d2b",
        "name": "Is there Title & Content?",
        "type": "n8n-nodes-base.if",
        "position": [
          1220,
          -400
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "aaf83c73-65f3-4a88-87f3-25b1acaf93ef",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.title }}",
                "rightValue": ""
              },
              {
                "id": "d9af5bce-f0fb-4c20-8b6a-b01a3bf3e1d1",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.content }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "a6c70ec0-2809-4c38-a2dd-a16e0b44f23e",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          2380,
          280
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "2562ab36-2fba-424e-8128-387591d2077e",
        "name": "Markdown",
        "type": "n8n-nodes-base.markdown",
        "position": [
          2380,
          80
        ],
        "parameters": {
          "html": "={{ $('Get Blog Post').item.json.content }}",
          "options": {},
          "destinationKey": "markdown"
        },
        "typeVersion": 1
      },
      {
        "id": "1739fe6e-4c0e-45b0-b368-6aab5dd79db9",
        "name": "Human In The Loop Approve Blog Post",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1780,
          -240
        ],
        "webhookId": "48f44283-5f68-4d7a-a2d2-a42209d35032",
        "parameters": {
          "sendTo": "joe@example.com",
          "message": "={{ $json.content }}",
          "options": {
            "limitWaitTime": {
              "values": {
                "resumeUnit": "minutes",
                "resumeAmount": 45
              }
            }
          },
          "subject": "=Approval Required for \"{{ $json.title }}\"",
          "operation": "sendAndWait",
          "approvalOptions": {
            "values": {
              "approvalType": "double"
            }
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "1xpVDEQ1yx8gV022",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "ae015937-dffb-4445-a013-b22442850de7",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1640,
          -360
        ],
        "parameters": {
          "color": 4,
          "width": 400,
          "height": 340,
          "content": "## 💫🤩 New - Human In The Loop"
        },
        "typeVersion": 1
      },
      {
        "id": "aafee6b1-0273-429a-9002-e0406be6c281",
        "name": "Is Approved?",
        "type": "n8n-nodes-base.if",
        "position": [
          2080,
          -240
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "316594d7-7ff6-4e39-bea3-45a11b9e750f",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.data.approved }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "d7aa4ec8-e936-4e05-b94a-da42f6852591",
        "name": "Gmail Final Blog",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2640,
          280
        ],
        "webhookId": "07692f3b-4e21-42d3-92dd-3dce5df3112f",
        "parameters": {
          "sendTo": "joe@example.com",
          "message": "={{ $('Get Blog Post').item.json.content }}",
          "options": {},
          "subject": "={{ $('Get Blog Post').item.json.title }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "1xpVDEQ1yx8gV022",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "cefad6b9-b061-4363-8221-34e15e262d00",
        "name": "Telegram Partial Blog",
        "type": "n8n-nodes-base.telegram",
        "position": [
          2640,
          80
        ],
        "webhookId": "77e3b2c9-79b7-4aa1-aa62-24da144c5f45",
        "parameters": {
          "chatId": "={{ $env.TELEGRAM_CHAT_ID }}",
          "operation": "sendPhoto",
          "binaryData": true,
          "additionalFields": {
            "caption": "={{ $json.markdown.slice(0,400) }} ..."
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "pAIFhguJlkO3c7aQ",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "503ab66d-6924-4be4-8275-3bfa3b3bf69f",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          420,
          -860
        ],
        "parameters": {
          "color": 7,
          "width": 680,
          "height": 1420,
          "content": "## 🎯 Description\n\nThis n8n workflow automates the process of transforming PDF documents into engaging, SEO-friendly WordPress blog posts. It incorporates AI-powered text analysis, automatic image generation, and a human review step to ensure quality before publishing.\n\n## 🚀 How It Works\n\n### 🗂️ PDF Upload & Text Extraction  \n- Users upload a PDF document through a form trigger.  \n- The workflow extracts text from the uploaded file, ensuring compatibility with supported formats.\n\n### 🤖 AI-Powered Blog Post Generation  \n- The extracted text is analyzed by an AI model (GPT-based) to create a structured blog post.  \n- The AI generates:  \n  - A captivating SEO-friendly title.  \n  - Well-formatted HTML content, including an introduction, chapters with subheadings, and a conclusion.\n\n### 🎨 Image Creation & Integration  \n- An image is generated using **Pollinations.ai** based on the blog post title.  \n- The vibrant image is uploaded to WordPress and set as the featured image for the post.\n\n### 📝 WordPress Draft Creation  \n- A draft blog post is created on WordPress with the AI-generated title, content, and featured image.  \n\n### ✅ Human-in-the-Loop Approval  \n- The draft content is sent via Gmail to a reviewer for manual approval.  \n- If approved, the post is published on WordPress. If not, an error message is sent for troubleshooting.\n\n### 📢 Multi-Channel Notifications  \n- Once published, notifications are sent via Gmail and Telegram to relevant stakeholders.  \n\n## 🔧 Setup Steps\n\n### 🔑 Configure API Credentials  \n1. Set up API connections for:  \n   - OpenAI (for AI content generation).  \n   - WordPress (for post creation and media uploads).  \n   - Gmail (for sending approval emails).  \n   - Telegram (for notifications).  \n\n### ⚙️ Customize Workflow Parameters  \n2. Adjust the AI prompt to match your desired blog structure and tone.  \n3. Modify the image generation parameters to align with your branding needs.\n\n### 🧪 Test & Deploy  \n3. Test the workflow with sample PDFs to ensure:  \n   - Accurate text extraction.  \n   - Proper formatting of generated content.  \n   - Seamless approval and publishing processes.  \n\n\nThis workflow streamlines content creation while maintaining quality control through human oversight, making it an ideal solution for efficient blog management! 🎉\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8ea57c7f-256b-4a89-b62f-3a6390fec719",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          360,
          -960
        ],
        "parameters": {
          "width": 2520,
          "height": 1700,
          "content": "# 📄✨ Easy WordPress Content Creation from PDF Document + Human in the Loop with Gmail Approval"
        },
        "typeVersion": 1
      },
      {
        "id": "8cf6bd65-b025-45df-b556-a5fac970aa9b",
        "name": "Get Blog Post",
        "type": "n8n-nodes-base.code",
        "position": [
          2080,
          -760
        ],
        "parameters": {
          "jsCode": "// Get the HTML content from the previous node\nconst htmlContent = $input.first().json.text;\n\n// Use regex to extract the text between the first h1 tags\nconst titleRegex = /<h1>(.*?)<\\/h1>/s;\nconst match = htmlContent.match(titleRegex);\n\n// Extract the title or set to empty string if not found\nconst title = match ? match[1] : '';\n\n// Return the extracted title\nreturn [{\n  json: {\n    title: title,\n    content: htmlContent\n  }\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "5e221628-d3b1-4242-bfa4-6a40599fa87b",
        "name": "Write Blog Post",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          1740,
          -760
        ],
        "parameters": {
          "text": "={{ $json.text }}",
          "messages": {
            "messageValues": [
              {
                "message": "=Analyze the provided PDF article and create a compelling blog post. Follow these specifications:  \n\n## Title Requirements \n- Create an engaging, SEO-friendly title under 10 words \n- Must not contain a colon \n- Should capture the article's essence \n- Will be formatted as an H1 in the content  \n\n## Content Structure \n- Introduction (150-200 words)   \n  * Compelling hook   \n  * Topic context and importance   \n  * Preview of main points  \n- Main Content (6-8 chapters)   \n  * Each chapter requires:     \n    - Relevant H2 heading     \n    - 300-400 words of unique content     \n    - Specific topic focus     \n    - Source material quotes/data     \n    - Smooth transitions  \n    - Conclusion (200-250 words)   \n  * Key takeaways   \n  * Final thoughts/implications  \n\n## Formatting Guidelines \n- Use proper HTML tags throughout \n- Structure with <p> tags for paragraphs \n- Include appropriate spacing \n- Use <blockquote> for direct quotes \n- Maintain consistent formatting \n- Write in clear, professional tone \n- Break up long paragraphs \n- Use engaging subheadings \n- Include transitional phrases  \n\nThe content should be original, avoid direct copying, and maintain a consistent voice throughout. \nOnly return the bolg post and avoid any preamble or further explanation."
              }
            ]
          },
          "promptType": "define"
        },
        "typeVersion": 1.5
      },
      {
        "id": "58ff967f-e327-4719-8a95-bfe9df02d185",
        "name": "Get Base64",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          1880,
          500
        ],
        "parameters": {
          "options": {},
          "operation": "binaryToPropery"
        },
        "typeVersion": 1
      },
      {
        "id": "a09a8b8b-ca30-4bbe-b3c9-a989e95d0fca",
        "name": "Save Image to imgbb.com",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2100,
          500
        ],
        "parameters": {
          "url": "https://api.imgbb.com/1/upload",
          "method": "POST",
          "options": {
            "redirect": {
              "redirect": {}
            }
          },
          "sendBody": true,
          "sendQuery": true,
          "contentType": "multipart-form-data",
          "bodyParameters": {
            "parameters": [
              {
                "name": "image",
                "value": "={{ $json.data }}"
              },
              {
                "name": "name",
                "value": "="
              }
            ]
          },
          "queryParameters": {
            "parameters": [
              {
                "name": "expiration",
                "value": "600"
              },
              {
                "name": "key",
                "value": "[your-imbgg-api-key-here]"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "116a8bee-77b5-44c8-a9fd-df3776ddccd1",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1780,
          400
        ],
        "parameters": {
          "color": 7,
          "width": 560,
          "height": 300,
          "content": "## Save Image to imgbb\nhttps://api.imgbb.com/"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "2d20cb21-b376-49c8-8dc8-cbdec4ddf543",
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Telegram Partial Blog",
              "type": "main",
              "index": 0
            },
            {
              "node": "Gmail Final Blog",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Markdown": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Base64": {
        "main": [
          [
            {
              "node": "Save Image to imgbb.com",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload PDF": {
        "main": [
          [
            {
              "node": "Extract Text",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "gpt-4o-mini": {
        "ai_languageModel": [
          [
            {
              "node": "Write Blog Post",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Extract Text": {
        "main": [
          [
            {
              "node": "Write Blog Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Approved?": {
        "main": [
          [
            {
              "node": "Create Wordpress Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Blog Post": {
        "main": [
          [
            {
              "node": "Is there Title & Content?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Write Blog Post": {
        "main": [
          [
            {
              "node": "Get Blog Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "pollinations.ai": {
        "main": [
          [
            {
              "node": "Upload Image to Wordpress",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            },
            {
              "node": "Get Base64",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Wordpress Post": {
        "main": [
          [
            {
              "node": "pollinations.ai",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Partial Blog": {
        "main": [
          []
        ]
      },
      "Is there Title & Content?": {
        "main": [
          [
            {
              "node": "Human In The Loop Approve Blog Post",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send Error Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Image to Wordpress": {
        "main": [
          [
            {
              "node": "Set Image on Wordpress Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Image on Wordpress Post": {
        "main": [
          [
            {
              "node": "Markdown",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Human In The Loop Approve Blog Post": {
        "main": [
          [
            {
              "node": "Is Approved?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "6a5e68bcca67c4cdb3e0b698d01739aea084e1ec06e551db64aeff43d174cb23",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "bc49829b-45f2-4910-9c37-907271982f14",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -4200,
          -560
        ],
        "parameters": {
          "width": 780,
          "height": 540,
          "content": "### 5. Do you need more details?\nFind a step-by-step guide in this tutorial\n![Guide](https://www.samirsaci.com/content/images/2025/04/EDI-Message-Parser.png)\n[🎥 Watch My Tutorial](https://youtu.be/-phwXeYk7Es)"
        },
        "typeVersion": 1
      },
      {
        "id": "fca5a1f8-874b-4b25-92af-066e7ca03f67",
        "name": "Order Information",
        "type": "n8n-nodes-base.set",
        "position": [
          -4360,
          -1000
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a55ebbb4-3eba-4584-8894-9e8d623d498f",
                "name": "documentType",
                "type": "string",
                "value": "={{ $json.summary.documentType }}"
              },
              {
                "id": "cbbff4da-4679-4258-bc3c-848075c5f1df",
                "name": "documentNumber",
                "type": "string",
                "value": "={{ $json.summary.documentNumber }}"
              },
              {
                "id": "a2eb5f07-8d1b-4c3a-b08b-a785045aeb34",
                "name": "orderDate",
                "type": "string",
                "value": "={{ $json.summary.orderDate }}"
              },
              {
                "id": "7e319d29-463b-4875-b556-684cb0c06c59",
                "name": "lineItemCount",
                "type": "string",
                "value": "={{ $json.summary.lineItemCount }}"
              },
              {
                "id": "5c9fc86c-e5c0-411f-a7d5-1121b5779906",
                "name": "totalQuantity",
                "type": "string",
                "value": "={{ $json.summary.totalQuantity }}"
              }
            ]
          }
        },
        "notesInFlow": true,
        "typeVersion": 3.4
      },
      {
        "id": "3598dc97-a0d3-4d34-8220-b91925014e4a",
        "name": "Return Orders",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -3620,
          -960
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "documentType",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "documentType",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "documentNumber",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "documentNumber",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "orderDate",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "orderDate",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "lineItemCount",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "lineItemCount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "totalQuantity",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "totalQuantity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Document_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Document_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Document_Number",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Document_Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Message_Function",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Message_Function",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Sender_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Sender_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Receiver_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Receiver_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Time",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Control_Reference",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Control_Reference",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date1_Qualifier",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date1_Qualifier",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date1_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date1_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date1_Date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date1_Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date1_Format",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date1_Format",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date2_Qualifier",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date2_Qualifier",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date2_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date2_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date2_Date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date2_Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date2_Format",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date2_Format",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date3_Qualifier",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date3_Qualifier",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date3_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date3_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date3_Date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date3_Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date3_Format",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date3_Format",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party1_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party1_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party1_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party1_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party1_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party1_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party1_Name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party1_Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party2_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party2_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party2_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party2_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party2_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party2_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party2_Name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party2_Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party3_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party3_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party3_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party3_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party3_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party3_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party3_Name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party3_Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party4_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party4_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party4_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party4_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party4_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party4_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party4_Name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party4_Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Number",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Product_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Product_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Product_ID_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Product_ID_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Quantity",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Quantity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Unit",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Unit",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Price",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Price",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Price_Qualifier",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Price_Qualifier",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1261096359,
            "cachedResultUrl": "=",
            "cachedResultName": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1SaSFnJx80wrArf6DLx8zZx2y5VFOAmp0u-a26wliTbU",
            "cachedResultUrl": "=",
            "cachedResultName": "="
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.5
      },
      {
        "id": "edfa5ef9-3095-47c2-ad80-c09cac647823",
        "name": "Outbound Orders",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -3640,
          -780
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "documentType",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "documentType",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "documentNumber",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "documentNumber",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "orderDate",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "orderDate",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "lineItemCount",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "lineItemCount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "totalQuantity",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "totalQuantity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Document_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Document_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Document_Number",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Document_Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Message_Function",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Message_Function",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Sender_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Sender_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Receiver_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Receiver_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Time",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Time",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "header_Control_Reference",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "header_Control_Reference",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date1_Qualifier",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date1_Qualifier",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date1_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date1_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date1_Date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date1_Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date1_Format",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date1_Format",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date2_Qualifier",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date2_Qualifier",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date2_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date2_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date2_Date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date2_Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date2_Format",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date2_Format",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date3_Qualifier",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date3_Qualifier",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date3_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date3_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date3_Date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date3_Date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date3_Format",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date3_Format",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party1_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party1_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party1_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party1_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party1_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party1_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party1_Name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party1_Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party2_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party2_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party2_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party2_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party2_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party2_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party2_Name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party2_Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party3_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party3_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party3_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party3_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party3_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party3_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party3_Name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party3_Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party4_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party4_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party4_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party4_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party4_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party4_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "party4_Name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "party4_Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Number",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Product_ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Product_ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Product_ID_Type",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Product_ID_Type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Quantity",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Quantity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Unit",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Unit",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Price",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Price",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "line_Price_Qualifier",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "line_Price_Qualifier",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1261096359,
            "cachedResultUrl": "=",
            "cachedResultName": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1SaSFnJx80wrArf6DLx8zZx2y5VFOAmp0u-a26wliTbU",
            "cachedResultUrl": "=",
            "cachedResultName": "="
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.5
      },
      {
        "id": "6d1c614f-9301-4f25-ab11-350018f145e3",
        "name": "Order Type",
        "type": "n8n-nodes-base.if",
        "position": [
          -3840,
          -880
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "fc591c63-edfe-4e6d-8074-6ab3079988c8",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.documentType }}",
                "rightValue": "Return Order"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "fc206367-2fbf-4943-b2ce-9fe399dd2730",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -5420,
          -1240
        ],
        "parameters": {
          "color": 7,
          "width": 380,
          "height": 620,
          "content": "### 1. Workflow Trigger with Gmail Trigger\nThe workflow is triggered by a new email received in your Gmail mailbox. \nIf the subject includes the string \"EDI\" we proceed, if not we do nothing.\n\n#### How to setup?\n- **Gmail Trigger Node:** set up your Gmail API credentials\n[Learn more about the Gmail Trigger Node](https://docs.n8n.io/integrations/builtin/trigger-nodes/n8n-nodes-base.gmailtrigger)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c6da1a85-d725-4a41-b63f-504fa8b552fb",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -5420,
          -540
        ],
        "parameters": {
          "width": 800,
          "height": 880,
          "content": "### Example of EDI Message\nYou can send yourself this email to test the workflow.\n\nUNA:+.? '\nUNB+UNOC:3+SENDER_ID+RECEIVER_ID+240317:1200+ORDER67890'\nUNH+1+ORDERS:D:96A:UN'\nBGM+220+PO56789012+9'\nDTM+137:20250318:102'      \nDTM+2:20250325:102'        \nDTM+10:20250324:102'      \nNAD+BY+BUYER_ABC::91'\nNAD+SU+SUPPLIER_XYZ::91'\nNAD+DP+WAREHOUSE_001::91'\nNAD+DP+Main Distribution Center'\nLIN+1++987654:IN'\nIMD+F++:::Product X Description'\nQTY+21:50:EA'\nPRI+AAA:20.00'\nLIN+2++654987:IN'\nIMD+F++:::Product Y Description'\nQTY+21:150:EA'\nPRI+AAA:12.75'\nUNT+10+1'\nUNZ+1+ORDER67890'UNA:+.? '\nUNB+UNOC:3+SENDER_ID+RECEIVER_ID+240317:1200+ORDER67890'\nUNH+1+ORDERS:D:96A:UN'\nBGM+220+PO56789012+9'\nDTM+137:20250318:102'      \nDTM+2:20250325:102'        \nDTM+10:20250324:102'      \nNAD+BY+BUYER_ABC::91'\nNAD+SU+SUPPLIER_XYZ::91'\nNAD+DP+WAREHOUSE_001::91'\nNAD+DP+Main Distribution Center'\nLIN+1++987654:IN'\nIMD+F++:::Product X Description'\nQTY+21:50:EA'\nPRI+AAA:20.00'\nLIN+2++654987:IN'\nIMD+F++:::Product Y Description'\nQTY+21:150:EA'\nPRI+AAA:12.75'\nUNT+10+1'\nUNZ+1+ORDER67890'"
        },
        "typeVersion": 1
      },
      {
        "id": "4c82f8ff-e405-4e5f-8386-9c622805023a",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -4980,
          -1240
        ],
        "parameters": {
          "color": 7,
          "width": 440,
          "height": 620,
          "content": "### 2. Get Email Body & Parse EDI Message\nThe first node extracts the email body using the ID from the trigger. This body is parsed using the code node to extract order information.\n\n#### How to setup?\n- **Gmail Node:** set up your Gmail API credentials\n[Learn more about the Gmail Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.gmail)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "e90096b1-ad36-4b18-96a2-9259377b4873",
        "name": "Email Trigger",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          -5400,
          -860
        ],
        "parameters": {
          "filters": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "notesInFlow": true,
        "typeVersion": 1.2
      },
      {
        "id": "26433f0f-487d-49dc-8de7-d4bd3bcf895c",
        "name": "Subject includes EDI",
        "type": "n8n-nodes-base.if",
        "position": [
          -5180,
          -860
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "3bc8a327-7e66-48e3-b442-38125b6f8670",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $json.Subject }}",
                "rightValue": "EDI"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "6960941f-6b49-41c2-88c6-9442bcb7cb34",
        "name": "Extract Body",
        "type": "n8n-nodes-base.set",
        "position": [
          -4820,
          -860
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "38358bb8-1b5a-4adc-816d-6710f53f7c0d",
                "name": "body",
                "type": "string",
                "value": "={{ $json.text.replace(/\\\\n/g, '\\n').replace(/^'|'$/g, '') }}"
              }
            ]
          }
        },
        "notesInFlow": true,
        "typeVersion": 3.4
      },
      {
        "id": "6e64556e-07ce-4d9d-89fc-07971dd9c553",
        "name": "Get Email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          -4960,
          -860
        ],
        "webhookId": "7476ecd4-e3ba-471d-a73a-ddef7b3ffd28",
        "parameters": {
          "simple": false,
          "options": {},
          "messageId": "={{ $json.id }}",
          "operation": "get"
        },
        "notesInFlow": true,
        "typeVersion": 2.1
      },
      {
        "id": "0346eabe-552a-47d8-ac9e-9619926d0242",
        "name": "Parse EDI Message",
        "type": "n8n-nodes-base.code",
        "position": [
          -4660,
          -860
        ],
        "parameters": {
          "jsCode": "// EDI Parser function for n8n JavaScript node\nfunction parseEDI(ediMessage) {\n  // Define the data structure to store parsed results\n  const result = {\n    interchangeHeader: {},\n    messageHeader: {},\n    orderDetails: {},\n    dates: [],\n    parties: [],\n    lineItems: []\n  };\n  \n  // Split the message into lines and remove empty lines\n  const lines = ediMessage.split(\"'\").filter(line => line.trim().length > 0);\n  \n  // Parse each line\n  let currentLineItem = null;\n  \n  for (const line of lines) {\n    const segments = line.trim().split('+');\n    const segmentName = segments[0];\n    \n    switch (segmentName) {\n      case 'UNA':\n        // Service String Advice - contains delimiter information\n        break;\n        \n      case 'UNB':\n        // Interchange Header\n        // UNB+UNOC:3+SENDER_ID+RECEIVER_ID+240318:1200+ORDER54321\n        result.interchangeHeader = {\n          syntax: segments[1],\n          senderId: segments[2],\n          receiverId: segments[3],\n          dateTime: segments[4]?.split(':')[0] || '',\n          time: segments[4]?.split(':')[1] || '',\n          controlReference: segments[5] || ''\n        };\n        break;\n        \n      case 'UNH':\n        // Message Header\n        // UNH+1+ORDERS:D:96A:UN\n        if (segments.length > 2) {\n          const messageParts = segments[2].split(':');\n          result.messageHeader = {\n            messageReference: segments[1],\n            messageType: messageParts[0],\n            messageVersion: messageParts[1],\n            messageRelease: messageParts[2],\n            controlAgency: messageParts[3]\n          };\n        }\n        break;\n        \n      case 'BGM':\n        // Beginning of Message\n        // BGM+230+RT54321098+9\n        result.orderDetails = {\n          documentType: segments[1],\n          documentNumber: segments[2],\n          messageFunction: segments[3]\n        };\n        break;\n        \n      case 'DTM':\n        // Date/Time/Period\n        // DTM+137:20250319:102\n        if (segments[1]) {\n          const dateParts = segments[1].split(':');\n          const dateObj = {\n            qualifier: dateParts[0],\n            date: dateParts[1],\n            format: dateParts[2]\n          };\n          \n          // Add human-readable description based on qualifier\n          switch (dateParts[0]) {\n            case '137':\n              dateObj.description = 'Document Date';\n              break;\n            case '2':\n              dateObj.description = 'Delivery Date';\n              break;\n            case '10':\n              dateObj.description = 'Shipment Date';\n              break;\n            default:\n              dateObj.description = 'Other Date';\n          }\n          \n          result.dates.push(dateObj);\n        }\n        break;\n      \n      case 'NAD':\n        // Name and Address\n        // NAD+BY+CUSTOMER_123::91\n        if (segments.length > 1) {\n          const partyCode = segments[1];\n          const partyId = segments[2]?.split(':')[0] || '';\n          \n          const party = {\n            partyQualifier: partyCode,\n            partyId: partyId,\n            qualifierDescription: ''\n          };\n          \n          // Add human-readable description\n          switch (partyCode) {\n            case 'BY':\n              party.qualifierDescription = 'Buyer';\n              break;\n            case 'SU':\n              party.qualifierDescription = 'Supplier';\n              break;\n            case 'DP':\n              party.qualifierDescription = 'Delivery Party';\n              break;\n            default:\n              party.qualifierDescription = 'Other Party';\n          }\n          \n          // If there's a full name instead of a code (like \"Returns Processing Hub\")\n          if (segments[2] && !segments[2].includes(':')) {\n            party.partyName = segments[2];\n            party.partyId = '';\n          }\n          \n          result.parties.push(party);\n        }\n        break;\n      \n      case 'LIN':\n        // Line Item\n        // LIN+1++321654:IN\n        currentLineItem = {\n          lineNumber: segments[1],\n          productId: '',\n          productIdType: '',\n          description: '',\n          quantity: 0,\n          unit: '',\n          price: 0\n        };\n        \n        // Parse product ID if present\n        if (segments[3]) {\n          const productParts = segments[3].split(':');\n          currentLineItem.productId = productParts[0];\n          currentLineItem.productIdType = productParts[1] || '';\n        }\n        \n        result.lineItems.push(currentLineItem);\n        break;\n      \n      case 'IMD':\n        // Item Description\n        // IMD+F++:::Defective Product A\n        if (currentLineItem && segments.length > 3) {\n          // The description is typically in the last component after multiple colons\n          const descriptionParts = segments[3].split(':');\n          currentLineItem.description = descriptionParts[descriptionParts.length - 1];\n        }\n        break;\n      \n      case 'QTY':\n        // Quantity\n        // QTY+21:10:EA\n        if (currentLineItem && segments[1]) {\n          const quantityParts = segments[1].split(':');\n          currentLineItem.quantityQualifier = quantityParts[0];\n          currentLineItem.quantity = parseFloat(quantityParts[1] || '0');\n          currentLineItem.unit = quantityParts[2] || '';\n        }\n        break;\n      \n      case 'PRI':\n        // Price Details\n        // PRI+AAA:0.00\n        if (currentLineItem && segments[1]) {\n          const priceParts = segments[1].split(':');\n          currentLineItem.priceQualifier = priceParts[0];\n          currentLineItem.price = parseFloat(priceParts[1] || '0');\n        }\n        break;\n      \n      case 'UNT':\n        // Message Trailer\n        break;\n      \n      case 'UNZ':\n        // Interchange Trailer\n        break;\n    }\n  }\n  \n  // Add some summary info\n  result.summary = {\n    documentType: 'Return Order',\n    documentNumber: result.orderDetails.documentNumber,\n    orderDate: result.dates.find(d => d.qualifier === '137')?.date || '',\n    lineItemCount: result.lineItems.length,\n    totalQuantity: result.lineItems.reduce((sum, item) => sum + item.quantity, 0)\n  };\n  \n  return result;\n}\n\n// Return the parsed EDI data\nconst ediMessage =  $input.first().json.body;\n\nif (!ediMessage) {\n  throw new Error('No EDI message found in input. Please provide the EDI message in the \"ediMessage\" property.');\n}\n\nconst parsedData = parseEDI(ediMessage);\nreturn { json: parsedData };"
        },
        "typeVersion": 2
      },
      {
        "id": "0fa4b446-bb37-48ab-a44b-8b2c52e2660b",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -4100,
          -1240
        ],
        "parameters": {
          "color": 7,
          "width": 700,
          "height": 620,
          "content": "### 4. Store the Transactions in a Google Sheet\nThis block will filter the order based on the order type (Return Orders, Outbound Orders) extracted from the order information node. Results are stored in two distinct sheets of the same Google Sheet file.\n\n#### How to setup?\n- **Add Results in Google Sheets**:\n   1. Add your Google Sheet API credentials to access the Google Sheet file\n   2. Select the file using the list, an URL or an ID\n   3. Select the sheet in which the vocabulary list is stored\n   4. You don't need to create columns as the mapping is automatic.\n  [Learn more about the Google Sheet Node](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.googlesheets)"
        },
        "typeVersion": 1
      },
      {
        "id": "7a1451db-9390-431f-bca5-54a537ff8016",
        "name": "Order Info + Orderlines",
        "type": "n8n-nodes-base.merge",
        "position": [
          -4040,
          -880
        ],
        "parameters": {
          "mode": "combineBySql"
        },
        "typeVersion": 3
      },
      {
        "id": "e64a1db7-4c22-4925-9597-9c14fdddbfe4",
        "name": "Flatten Data to Orderlines",
        "type": "n8n-nodes-base.code",
        "position": [
          -4460,
          -860
        ],
        "parameters": {
          "jsCode": "// EDI to Flattened Tabular Data Transformer for n8n JavaScript node\nfunction transformToFlattened(parsedEDI) {\n  const flattened = [];\n  \n  // Create a header object with all order header fields\n  const headerObj = {\n    header_Document_Type: parsedEDI.orderDetails.documentType || '',\n    header_Document_Number: parsedEDI.orderDetails.documentNumber || '',\n    header_Message_Function: parsedEDI.orderDetails.messageFunction || '',\n    header_Sender_ID: parsedEDI.interchangeHeader.senderId || '',\n    header_Receiver_ID: parsedEDI.interchangeHeader.receiverId || '',\n    header_Date: parsedEDI.interchangeHeader.dateTime || '',\n    header_Time: parsedEDI.interchangeHeader.time || '',\n    header_Control_Reference: parsedEDI.interchangeHeader.controlReference || ''\n  };\n  \n  // Process all dates\n  const dateObjs = {};\n  if (parsedEDI.dates && Array.isArray(parsedEDI.dates)) {\n    parsedEDI.dates.forEach((date, index) => {\n      const prefix = `date${index + 1}_`;\n      dateObjs[`${prefix}Qualifier`] = date.qualifier || '';\n      dateObjs[`${prefix}Description`] = date.description || '';\n      dateObjs[`${prefix}Date`] = date.date || '';\n      dateObjs[`${prefix}Format`] = date.format || '';\n    });\n  }\n  \n  // Process all parties\n  const partyObjs = {};\n  if (parsedEDI.parties && Array.isArray(parsedEDI.parties)) {\n    parsedEDI.parties.forEach((party, index) => {\n      const prefix = `party${index + 1}_`;\n      partyObjs[`${prefix}Type`] = party.partyQualifier || '';\n      partyObjs[`${prefix}Description`] = party.qualifierDescription || '';\n      partyObjs[`${prefix}ID`] = party.partyId || '';\n      partyObjs[`${prefix}Name`] = party.partyName || '';\n    });\n  }\n  \n  // Create one row for each line item with all header, date, and party info\n  if (parsedEDI.lineItems && Array.isArray(parsedEDI.lineItems)) {\n    parsedEDI.lineItems.forEach((item) => {\n      const lineItem = {\n        line_Number: item.lineNumber || '',\n        line_Product_ID: item.productId || '',\n        line_Product_ID_Type: item.productIdType || '',\n        line_Description: item.description || '',\n        line_Quantity: item.quantity || 0,\n        line_Unit: item.unit || '',\n        line_Price: item.price || 0,\n        line_Price_Qualifier: item.priceQualifier || ''\n      };\n      \n      // Combine all information into one flat object\n      const flatRow = {\n        ...headerObj,\n        ...dateObjs,\n        ...partyObjs,\n        ...lineItem\n      };\n      \n      flattened.push(flatRow);\n    });\n  }\n  \n  // If there are no line items, create at least one row with header info\n  if (flattened.length === 0) {\n    flattened.push({\n      ...headerObj,\n      ...dateObjs,\n      ...partyObjs\n    });\n  }\n  \n  return flattened;\n}\n\nconst parsedEDI = $input.all()[0].json;\n\n// Make sure we have valid data\nif (!parsedEDI || !parsedEDI.orderDetails) {\n  throw new Error('Invalid EDI data format. Please ensure the input is from the EDI parser.');\n}\n\nconst flattenedData = transformToFlattened(parsedEDI);\n\n// Return the flattened data\nreturn { json: { data: flattenedData } };"
        },
        "typeVersion": 2
      },
      {
        "id": "5b56fe40-9cfb-4668-946d-470dc9e3a39e",
        "name": "Split Out by Line",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -4280,
          -860
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "data"
        },
        "typeVersion": 1
      },
      {
        "id": "903399b2-cdee-40c0-99cb-1c44d84e96d2",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -4480,
          -1240
        ],
        "parameters": {
          "color": 7,
          "width": 320,
          "height": 620,
          "content": "### 3. Process Parsed Data\nThis block extract order information and format the orderlines to be stored in a google sheet.\n\n#### How to setup?\nNothing to do."
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Get Email": {
        "main": [
          [
            {
              "node": "Extract Body",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Order Type": {
        "main": [
          [
            {
              "node": "Return Orders",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Outbound Orders",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Body": {
        "main": [
          [
            {
              "node": "Parse EDI Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Email Trigger": {
        "main": [
          [
            {
              "node": "Subject includes EDI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Order Information": {
        "main": [
          [
            {
              "node": "Order Info + Orderlines",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse EDI Message": {
        "main": [
          [
            {
              "node": "Order Information",
              "type": "main",
              "index": 0
            },
            {
              "node": "Flatten Data to Orderlines",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out by Line": {
        "main": [
          [
            {
              "node": "Order Info + Orderlines",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Subject includes EDI": {
        "main": [
          [
            {
              "node": "Get Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Order Info + Orderlines": {
        "main": [
          [
            {
              "node": "Order Type",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Flatten Data to Orderlines": {
        "main": [
          [
            {
              "node": "Split Out by Line",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "ad0113c344ee237399e44e9f11798b05baeb83a6196d514a9ae9d2ad71c3b5c9",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "425810c5-874c-41db-8fdd-59450e7f280e",
        "name": "Send a message",
        "type": "n8n-nodes-base.microsoftOutlook",
        "position": [
          -784,
          9472
        ],
        "webhookId": "028da3bf-3bd3-4c4f-883a-4e0f18c67f81",
        "parameters": {
          "subject": "Build AI Agents & Automations with n8n",
          "bodyContent": "Hi There,\n\nI help people learn how to build AI agents and create powerful AI automations using n8n. If you’re exploring ways to save time or scale your workflows, I’d love to share what’s possible.\n\nYou can check out my n8n Creator profile here with 70+ ready-to-use automations:\n👉 https://n8n.io/creators/rbreen\n\nIf you’d like help getting started or want to see what AI + n8n can do for your business, just reply to this email.\n\nBest,\nRobert Breen\n📞 +1 814-882-1293\n🔗 https://www.linkedin.com/in/robert-breen-29429625/",
          "toRecipients": "={{ $json.Email }}",
          "additionalFields": {}
        },
        "credentials": {
          "microsoftOutlookOAuth2Api": {
            "id": "9z1nG9ReKLXU309r",
            "name": "Microsoft Outlook account 4"
          }
        },
        "typeVersion": 2,
        "alwaysOutputData": true
      },
      {
        "id": "e84f0281-eb13-4afa-b831-eae6f1a5cf54",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -2416,
          9072
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 9
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "1d3ef656-0288-45c2-8b82-a9aa7b57e2b0",
        "name": "Get row(s) in sheet3",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -2080,
          9232
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sXXVbl2kKdYTzCmZDe7QyeMp1N9wZg9K63oGK2UIaeU/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1sXXVbl2kKdYTzCmZDe7QyeMp1N9wZg9K63oGK2UIaeU",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sXXVbl2kKdYTzCmZDe7QyeMp1N9wZg9K63oGK2UIaeU/edit?usp=drivesdk",
            "cachedResultName": "New Leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "HlBW2puZbuCCq8jJ",
            "name": "Google Sheets account 3"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "7fa47640-1e65-491d-9457-ef32d0b7f600",
        "name": "Filter1",
        "type": "n8n-nodes-base.filter",
        "position": [
          -1744,
          9088
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "914418a9-8c96-4959-abb7-ad3bb52f420d",
                "operator": {
                  "type": "string",
                  "operation": "empty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.Contacted }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "3b4a33f6-c810-4dcb-9b19-3abc6b982e9f",
        "name": "Append or update row in sheet1",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -1312,
          8736
        ],
        "parameters": {
          "columns": {
            "value": {
              "Email": "={{ $json.Email }}",
              "Contacted": "Yes"
            },
            "schema": [
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Contacted",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Contacted",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Created",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Created",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Email"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/14T6rilaOl1LBTwNnu7ILE3T1equWOz0noI-OIUaI3zU/edit#gid=0",
            "cachedResultName": "leads"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "14T6rilaOl1LBTwNnu7ILE3T1equWOz0noI-OIUaI3zU",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/14T6rilaOl1LBTwNnu7ILE3T1equWOz0noI-OIUaI3zU/edit?usp=drivesdk",
            "cachedResultName": "New Leads - Real"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "HlBW2puZbuCCq8jJ",
            "name": "Google Sheets account 3"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "65e19508-beb8-4b3d-8ec8-55093f437fd5",
        "name": "Sticky Note58",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2688,
          8576
        ],
        "parameters": {
          "color": 7,
          "width": 2144,
          "height": 1056,
          "content": "## Email new leads from Google Sheets via Outlook on a schedule\n\nSend a templated outreach email to **new leads** in a Google Sheet on a **daily schedule**, then **mark each lead as contacted** so they won’t be emailed twice. Built with: **Schedule Trigger → Google Sheets → Filter → Outlook Send Email → Google Sheets (append/update)**.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "6736dbfa-79fc-4aa6-9890-5b60b3b98cd1",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -3120,
          8576
        ],
        "parameters": {
          "width": 400,
          "height": 1056,
          "content": "## How to set up\n### 1) Google Sheets (OAuth2)\n- In **n8n → Credentials → New → Google Sheets (OAuth2)**, sign in and grant access.  \n- In **Get rows**: select your **Lead Source** sheet (e.g., “New Leads”).  \n- In **Append/Update**: select the sheet you want to mark as contacted (can be the same sheet or a CRM sheet).  \n- Make sure your sheet has at least: `Email`, `Contacted` (blank for new).\n\n### 2) Outlook (Microsoft Graph) OAuth2\n- **n8n Cloud (quick connect):**  \n  - In **Credentials → New → Microsoft Outlook OAuth2**, choose **Connect**, sign in with your Microsoft account, and accept permissions.\n- **Self-hosted (Azure App Registration):**  \n  1) Azure Portal → **App registrations** → **New registration**.  \n  2) Add redirect URL: `https://YOUR_N8N_URL/rest/oauth2-credential/callback`.  \n  3) **API permissions (Delegated):** `offline_access`, `Mail.Send`, `User.Read`. Grant admin consent if required.  \n  4) Create a **Client secret**; copy **Application (client) ID** and **Directory (tenant) ID**.  \n  5) In n8n, create **Microsoft Outlook OAuth2** credential with those values and scopes: `offline_access Mail.Send openid email profile`.  \n- In the **Send a message** node, select that credential and keep `To` mapped to `{{$json.Email}}`.  \n- Customize **Subject** and **Body** to your brand (default provided).\n\n---\n\n\n- 📧 **rbreen@ynteractive.com**  \n- 🔗 **Robert Breen** — https://www.linkedin.com/in/robert-breen-29429625/  \n- 🌐 **ynteractive.com** — https://ynteractive.com\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "79a41cd6-d72f-4cd5-81a2-3341a21ceeb8",
        "name": "Sticky Note70",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2144,
          8784
        ],
        "parameters": {
          "color": 3,
          "width": 224,
          "height": 656,
          "content": "### 1) Connect Google Sheets (OAuth2)\n1. In **n8n → Credentials → New → Google Sheets (OAuth2)**  \n2. Sign in with your Google account and grant access  \n3. In each Google Sheets node, select your **Spreadsheet** and the appropriate **Worksheet**:  \n\n\nhttps://docs.google.com/spreadsheets/d/1sXXVbl2kKdYTzCmZDe7QyeMp1N9wZg9K63oGK2UIaeU/edit#gid=0"
        },
        "typeVersion": 1
      },
      {
        "id": "49825745-adc3-4a5e-ba1c-0a65e31fd177",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -848,
          8608
        ],
        "parameters": {
          "color": 3,
          "height": 992,
          "content": "### 2) Outlook (Microsoft Graph) OAuth2\n- **n8n Cloud (quick connect):**  \n  - In **Credentials → New → Microsoft Outlook OAuth2**, choose **Connect**, sign in with your Microsoft account, and accept permissions.\n- **Self-hosted (Azure App Registration):**  \n  1) Azure Portal → **App registrations** → **New registration**.  \n  2) Add redirect URL: `https://YOUR_N8N_URL/rest/oauth2-credential/callback`.  \n  3) **API permissions (Delegated):** `offline_access`, `Mail.Send`, `User.Read`. Grant admin consent if required.  \n  4) Create a **Client secret**; copy **Application (client) ID** and **Directory (tenant) ID**.  \n  5) In n8n, create **Microsoft Outlook OAuth2** credential with those values and scopes: `offline_access Mail.Send openid email profile`.  \n- In the **Send a message** node, select that credential and keep `To` mapped to `{{$json.Email}}`.  \n- Customize **Subject** and **Body** to your brand (default provided).\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Filter1": {
        "main": [
          [
            {
              "node": "Append or update row in sheet1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Get row(s) in sheet3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s) in sheet3": {
        "main": [
          [
            {
              "node": "Filter1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "09423a3357ff64bdcc082268b9d577001317edbe377a3ccfb0b131ffb9554b30",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "5eb22f9c-dfae-495f-9bf4-027f92670bc5",
        "name": "Contact Ref",
        "type": "n8n-nodes-base.noOp",
        "position": [
          960,
          480
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "d1a1b59f-b746-40ef-846f-c596564a2538",
        "name": "Get All Customer's Emails",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1456,
          480
        ],
        "webhookId": "4d8c4b7a-da0b-49aa-bda8-7b1d89c62636",
        "parameters": {
          "limit": 20,
          "simple": false,
          "filters": {
            "q": "=from:{{ $json.email }}"
          },
          "options": {},
          "operation": "getAll"
        },
        "typeVersion": 2.1
      },
      {
        "id": "22c3f6bb-9344-4319-9eeb-4b2d3232aee3",
        "name": "Create Draft Email for Review",
        "type": "n8n-nodes-base.gmail",
        "position": [
          3024,
          624
        ],
        "webhookId": "8b3d78e5-8cea-4205-a9db-c66ec01f9558",
        "parameters": {
          "message": "={{ $json.output.body }}",
          "options": {
            "sendTo": "={{ $('Variables').first().json.email }}"
          },
          "subject": "={{ $json.output.subject }}",
          "resource": "draft",
          "emailType": "html"
        },
        "typeVersion": 2.1
      },
      {
        "id": "d77dac1f-5f9c-45de-b4f3-3a0c076c67b6",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -384,
          128
        ],
        "parameters": {
          "color": 5,
          "width": 544,
          "height": 632,
          "content": "## Email Outreach Drafter with HubSpot context\n\n### How it works\n1. Click **Test workflow** to start.\n2. **HubSpot:** fetch contacts (e.g., decision makers).\n3. **Gmail:** pull each contact’s recent email threads.\n4. **AI (Gemini):** build a quick persona from the correspondence.\n5. **AI:** generate a tailored sales email using the persona + your product pitch.\n6. **Gmail:** save the message as a **draft** for review.\n\n### Setup\n- [ ] Connect **HubSpot** (OAuth) and **Gmail**.\n- [ ] Add your **Gemini** API key to both Gemini nodes.\n- [ ] In **Get Contacts** set up filters to fetch relevant contacts\n- [ ] In **Variables**, set `firstname`, `lastname`, `email` mappings and edit `product_to_sell`.\n- [ ] (Optional) Adjust HubSpot filters (e.g., buying role) and Gmail fetch limits.\n\n### Customize\n- **Persona extraction:** tweak traits in **Analyse and Build Persona** (role, goals, pain points, tone, etc.).\n- **Email style:** edit the system prompt in **Generate Sales Email** (voice, length, CTA).\n- **Targeting:** refine HubSpot search criteria or switch to a list view.\n- **Review flow:** keep as drafts, or add an approval step (e.g., Slack) before sending.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c20148a9-b8f6-4e24-9522-1df4e72842b2",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2832,
          448
        ],
        "parameters": {
          "color": 7,
          "width": 464,
          "height": 376,
          "content": "## 5. Create a draft in gmail \nSave the AI-written pitch as a draft in Gmail. Skim, tweak, send, and save hours! "
        },
        "typeVersion": 1
      },
      {
        "id": "12677fce-489c-4e08-b7fc-558533542de6",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2256,
          336
        ],
        "parameters": {
          "color": 7,
          "width": 560,
          "height": 444,
          "content": "## 4. Creat a sales email draft using the persona\nFeed the persona to AI and have it draft a tailored pitch that matches the customer’s beliefs, priorities, and communication style."
        },
        "typeVersion": 1
      },
      {
        "id": "d5f35beb-ac07-4f6e-96ed-ce9395e38aee",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1696,
          336
        ],
        "parameters": {
          "color": 7,
          "width": 540,
          "height": 444,
          "content": "## 3. Build person from the emails\nFor each prospect, use AI to create a simple persona based on emails. Use the **Information Extractor** node to tell the LLM which traits to pull (eg: role, goals, pain points, decision style, tone)."
        },
        "typeVersion": 1
      },
      {
        "id": "c8c9b8c7-1c38-4142-b2fa-d5f0e69e2a5e",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1152,
          336
        ],
        "parameters": {
          "color": 7,
          "width": 520,
          "height": 372,
          "content": "## 2. Get previous email threads"
        },
        "typeVersion": 1
      },
      {
        "id": "75f939f6-954a-413f-93ed-267ade013491",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          512,
          336
        ],
        "parameters": {
          "color": 7,
          "width": 608,
          "height": 372,
          "content": "## 1. Get target customers in Hubspot\n"
        },
        "typeVersion": 1
      },
      {
        "id": "6aae27da-13ce-4535-9e80-b7ff190595ee",
        "name": "For Each Contact",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          752,
          464
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "e091dea6-9880-48fd-a7ca-7b4fadce66ce",
        "name": "Get Contacts",
        "type": "n8n-nodes-base.hubspot",
        "position": [
          560,
          464
        ],
        "parameters": {
          "operation": "search",
          "authentication": "oAuth2",
          "filterGroupsUi": {
            "filterGroupsValues": [
              {
                "filtersUi": {
                  "filterValues": [
                    {
                      "value": "DECISION_MAKER",
                      "propertyName": "hs_buying_role|enumeration"
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {}
        },
        "credentials": {
          "hubspotOAuth2Api": {
            "id": "Vxqd8oQJmbtNmpRz",
            "name": "HubSpot account"
          }
        },
        "notesInFlow": true,
        "typeVersion": 2.1
      },
      {
        "id": "3dc19bf4-167e-46fe-b483-53e752fe0ad2",
        "name": "Analyse and Build Persona",
        "type": "@n8n/n8n-nodes-langchain.informationExtractor",
        "position": [
          1808,
          480
        ],
        "parameters": {
          "text": "={{\n$input.all()\n  .map(item => `subject: ${item.json.subject}\ndate: ${$json.headers.date}\nmessage: ${item.json.text.substr(0, item.json.text.indexOf('> wrote:') ?? item.json.text.length).replace(/^On[\\w\\W]+$/im, '')}`\n  ).join('\\n---\\n')\n}}",
          "options": {
            "systemPromptTemplate": "=Your task is to build a persona of a customer or potential customer so that we may better serve them for our business. Analyse the recent correspondence of the user, {{ $('Variables').item.json.email }}, and extract the required attributes."
          },
          "attributes": {
            "attributes": [
              {
                "name": "decision_making_style",
                "required": true,
                "description": "=Analytical vs. Intuitive: Do they rely on data or gut feelings?\n\nRisk Appetite: Conservative, calculated risk-YOUR_OPENAI_KEY_HERE, or bold?\n\nSpeed of Decision-Making: Quick and assertive or deliberate and methodical?"
              },
              {
                "name": " communication_preferences",
                "required": true,
                "description": "=Preferred Medium: Email, phone calls, in-person meetings, messaging apps?\n\nDetail Orientation: High-level summaries or deep-dive explanations?\n\nTone & Formality: Casual vs. professional, direct vs. diplomatic?"
              },
              {
                "name": "pain_points_challenges",
                "required": true,
                "description": "=Current Business Challenges: What problems are they actively trying to solve?\n\nIndustry Pressures: Competitive landscape, economic concerns, regulatory issues?\n\nOperational Bottlenecks: Efficiency, team structure, technology gaps?"
              },
              {
                "name": "professional_goals_motivations",
                "required": true,
                "description": "=Personal Career Goals: Promotion, recognition, financial growth, legacy-building?\n\nBusiness Priorities: Revenue growth, innovation, market expansion, cost reduction?\n\nKey Performance Indicators (KPIs): How do they measure success?"
              },
              {
                "name": "work_style_preferences",
                "required": true,
                "description": "=Collaboration vs. Independence: Do they prefer teamwork or autonomy?\n\nLevel of Involvement: Hands-on or delegate-and-review?\n\nResponse Time Expectation: Do they expect immediate follow-ups or are they flexible?"
              },
              {
                "name": "personality_behavioral_traits",
                "required": true,
                "description": "=Big Five Traits: Are they open to new ideas, structured, agreeable, extroverted?\n\nConflict Resolution Style: Do they avoid, confront, or negotiate?\n\nTrust-Building Factors: Do they value reliability, transparency, exclusivity?"
              },
              {
                "name": " buying_investment_behavior",
                "required": true,
                "description": "=Budget Sensitivity: Price-conscious or value-focused?\n\nBrand Loyalty vs. Openness: Do they stick with familiar providers or explore new options?\n\nDecision Influencers: Do they rely on peers, market research, gut instinct?"
              },
              {
                "name": "preferred_business_culture_ethics",
                "required": true,
                "description": "=Formality vs. Informality: Corporate structure vs. entrepreneurial mindset?\n\nCore Values: Integrity, innovation, customer-first, sustainability?\n\nCultural Sensitivity: Are there cultural nuances to be aware of in their decision-making?"
              },
              {
                "name": "industry_competitive_awareness",
                "required": true,
                "description": "=Market Trends Interest: Do they actively track industry shifts?\n\nCompetitor Awareness: Are they reactive to competitors, or focused on internal growth?\n\nTech Adoption: Do they embrace innovation, or are they slow adopters?"
              }
            ]
          }
        },
        "executeOnce": true,
        "typeVersion": 1
      },
      {
        "id": "a692062b-c142-47de-997e-10ae6c5420ee",
        "name": "Generate Sales Email",
        "type": "@n8n/n8n-nodes-langchain.informationExtractor",
        "position": [
          2416,
          480
        ],
        "parameters": {
          "text": "=# Profile of {{ $('Variables').first().json.firstname }} {{ $('Variables').first().json.lastname }}\n{{ Object.keys($json.output).map(key => `## ${key}\\n${$json.output[key]}`).join('\\n') }}",
          "options": {
            "systemPromptTemplate": "=You are a sales representative drafting an email to close a potential customer on the following product: <product>{{ $('Variables').first().json.product_to_sell }}</product>\n\nUse the provided profile to draft the a suitable email which reflects similar communication style and addresses their values, ultimately convinces the customer to inquire about and/or buy this product. Provide only the subject and body of the message as this text will go into a template. Omit the subject and signature."
          },
          "attributes": {
            "attributes": [
              {
                "name": "subject",
                "required": true,
                "description": "the subject of the message"
              },
              {
                "name": "body",
                "required": true,
                "description": "the body of the message with html styling"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5b325d06-e4e9-4a50-a260-ce733d57f007",
        "name": "Google Gemini Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          2496,
          640
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "KYY7pVULIl0PdDp3",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b6cb19c3-db32-4c56-8a61-8eac39c7cae0",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1888,
          640
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "KYY7pVULIl0PdDp3",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "018a8972-546c-43cc-986a-b72fa9d0d4d9",
        "name": "Variables",
        "type": "n8n-nodes-base.set",
        "position": [
          1248,
          480
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "a6c47778-33f4-46a3-a86a-fd1e75930d93",
                "name": "firstname",
                "type": "string",
                "value": "={{ $json.properties.firstname }}"
              },
              {
                "id": "0e50b2bc-4bea-4fd0-95c0-46a87da69c19",
                "name": "lastname",
                "type": "string",
                "value": "={{ $json.properties.lastname }}"
              },
              {
                "id": "ee15f298-77f6-4c4a-b03b-c2cf9a53bdc2",
                "name": "email",
                "type": "string",
                "value": "={{ $json.properties.email }}"
              },
              {
                "id": "98a718f5-4372-4282-8a9a-46f2af39677a",
                "name": "product_to_sell",
                "type": "string",
                "value": "=AI partnerships: a consulting package of AI development and services. We help customers find a strong foothold on AI initiatives bringing them to life cost effectively and always with results."
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "d8dab6ac-acfe-452f-921d-55d27060ed6a",
        "name": "When clicking 'Execute workflow'",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          304,
          464
        ],
        "parameters": {},
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Variables": {
        "main": [
          [
            {
              "node": "Get All Customer's Emails",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Contact Ref": {
        "main": [
          [
            {
              "node": "Variables",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Contacts": {
        "main": [
          [
            {
              "node": "For Each Contact",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "For Each Contact": {
        "main": [
          [],
          [
            {
              "node": "Contact Ref",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Sales Email": {
        "main": [
          [
            {
              "node": "Create Draft Email for Review",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Analyse and Build Persona",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Analyse and Build Persona": {
        "main": [
          [
            {
              "node": "Generate Sales Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get All Customer's Emails": {
        "main": [
          [
            {
              "node": "Analyse and Build Persona",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Sales Email",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Create Draft Email for Review": {
        "main": [
          [
            {
              "node": "For Each Contact",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking 'Execute workflow'": {
        "main": [
          [
            {
              "node": "Get Contacts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "nodes": [
      {
        "id": "4dd52c72-9a9b-4db4-8de5-5b12b1e5c4be",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          180,
          1480
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 9
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "9226181c-b84c-4ea1-a5b4-eedb6c62037b",
        "name": "Search daily",
        "type": "n8n-nodes-base.airtable",
        "position": [
          440,
          1480
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appL3dptT6ZTSzY9v",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v",
            "cachedResultName": "Scheduled Emails"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzR9vSuFUzlQNMI",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v/tblzR9vSuFUzlQNMI",
            "cachedResultName": "Table 1"
          },
          "options": {},
          "operation": "search",
          "filterByFormula": "AND({Status} = 'active', {Interval} = 'daily')"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Und0frCQ6SNVX3VV",
            "name": "Airtable Personal Access Token account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "1a3b6224-2f66-41c6-8b3d-be286cf16370",
        "name": "Search weekly",
        "type": "n8n-nodes-base.airtable",
        "position": [
          440,
          1660
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appL3dptT6ZTSzY9v",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v",
            "cachedResultName": "Scheduled Emails"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzR9vSuFUzlQNMI",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v/tblzR9vSuFUzlQNMI",
            "cachedResultName": "Table 1"
          },
          "options": {},
          "operation": "search",
          "filterByFormula": "=AND(\n  {Status} = 'active', \n  {Interval} = 'weekly', \n  {Last Sent} <= DATEADD(TODAY(), -7, 'days')\n)"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Und0frCQ6SNVX3VV",
            "name": "Airtable Personal Access Token account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "1ea47e14-0a28-4780-95c7-31e24eb724d5",
        "name": "confirmation email1",
        "type": "n8n-nodes-base.gmail",
        "position": [
          620,
          820
        ],
        "webhookId": "dd8bd6df-2013-4f8d-a2cc-cd9b3913e3d2",
        "parameters": {
          "sendTo": "={{ $('Subscribe Form').item.json.email }}",
          "message": "=This is to confirm your request to subscribe to \"Learn something every day!\" - a free service to send you facts about your favourite topics.\n\nTopic: {{ $('Subscribe Form').item.json.topic }}\nSchedule: {{ $('Subscribe Form').item.json.frequency }}",
          "options": {
            "appendAttribution": false
          },
          "subject": "Learn something every day confirmation"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "d95262af-1b52-4f9c-8346-183b4eee8544",
        "name": "Execute Workflow",
        "type": "n8n-nodes-base.executeWorkflow",
        "position": [
          1140,
          1480
        ],
        "parameters": {
          "mode": "each",
          "options": {
            "waitForSubWorkflow": false
          },
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $workflow.id }}"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "075292af-7a66-4275-ac2d-3c392189a10c",
        "name": "Create Event",
        "type": "n8n-nodes-base.set",
        "position": [
          980,
          1480
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "b28a0142-a028-471a-8180-9883e930feea",
                "name": "email",
                "type": "string",
                "value": "={{ $json.Email }}"
              },
              {
                "id": "970f5495-05df-42b6-a422-b2ac27f8eb95",
                "name": "topic",
                "type": "string",
                "value": "={{ $json.Topic }}"
              },
              {
                "id": "e871c431-948f-4b80-aa17-1e4266674663",
                "name": "interval",
                "type": "string",
                "value": "={{ $json.Interval }}"
              },
              {
                "id": "9b72597d-1446-4ef3-86e5-0a071c69155b",
                "name": "id",
                "type": "string",
                "value": "={{ $json.id }}"
              },
              {
                "id": "b17039c2-14a2-4811-9528-88ae963e44f7",
                "name": "created_at",
                "type": "string",
                "value": "={{ $json.Created }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "28776aaf-6bd9-4f9f-bcf0-3d4401a74219",
        "name": "Execute Workflow Trigger",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          1360,
          1480
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "0eb62e75-228b-452b-80ab-f9ef3ad33204",
        "name": "Unsubscribe Form",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          180,
          1160
        ],
        "webhookId": "e64db96d-5e61-40d5-88fb-761621a829ab",
        "parameters": {
          "options": {
            "path": "free-factoids-unsubscribe"
          },
          "formTitle": "Unsubscribe from Learn Something Every Day",
          "formFields": {
            "values": [
              {
                "fieldLabel": "ID",
                "requiredField": true
              },
              {
                "fieldType": "dropdown",
                "fieldLabel": "Reason For Unsubscribe",
                "multiselect": true,
                "fieldOptions": {
                  "values": [
                    {
                      "option": "Emails not relevant"
                    },
                    {
                      "option": "Too many Emails"
                    },
                    {
                      "option": "I did not sign up to this service"
                    }
                  ]
                }
              }
            ]
          },
          "formDescription": "We're sorry to see you go! Please take a moment to help us improve the service."
        },
        "typeVersion": 2.2
      },
      {
        "id": "f889efe9-dc3c-428b-ad8e-4f7d17f23e75",
        "name": "Set Email Vars",
        "type": "n8n-nodes-base.set",
        "position": [
          2500,
          1480
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "62a684fb-16f9-4326-8eeb-777d604b305a",
                "name": "to",
                "type": "string",
                "value": "={{ $('Execute Workflow Trigger').first().json.email }},jim@height.io"
              },
              {
                "id": "4270849e-c805-4580-9088-e8d1c3ef2fb4",
                "name": "subject",
                "type": "string",
                "value": "=Your {{ $('Execute Workflow Trigger').first().json.interval }} factoid"
              },
              {
                "id": "81d0e897-2496-4a3c-b16c-9319338f899f",
                "name": "message",
                "type": "string",
                "value": "=<p>\n<strong>You asked about \"{{ $('Execution Data').first().json.topic.replace('\"','') }}\"</strong>\n</p>\n<p>\n<i>{{ $('Content Generation Agent').first().json.output }}</i>\n</p>"
              },
              {
                "id": "ee05de7b-5342-4deb-8118-edaf235d92cc",
                "name": "unsubscribe_link",
                "type": "string",
                "value": "=https://<MY_HOST>/form/inspiration-unsubscribe?ID={{ $('Execute Workflow Trigger').first().json.id }}"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "84741e6d-f5be-440d-8633-4eb30ccce170",
        "name": "Log Last Sent",
        "type": "n8n-nodes-base.airtable",
        "position": [
          2860,
          1480
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appL3dptT6ZTSzY9v",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v",
            "cachedResultName": "Scheduled Emails"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzR9vSuFUzlQNMI",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v/tblzR9vSuFUzlQNMI",
            "cachedResultName": "Table 1"
          },
          "columns": {
            "value": {
              "id": "={{ $('Execute Workflow Trigger').first().json.id }}",
              "Last Sent": "2024-11-29T13:34:11"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "id",
                "defaultMatch": true
              },
              {
                "id": "Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Status",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "inactive",
                    "value": "inactive"
                  },
                  {
                    "name": "active",
                    "value": "active"
                  }
                ],
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Interval",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "daily",
                    "value": "daily"
                  },
                  {
                    "name": "weekly",
                    "value": "weekly"
                  },
                  {
                    "name": "surprise",
                    "value": "surprise"
                  }
                ],
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Interval",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Start Day",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "Mon",
                    "value": "Mon"
                  },
                  {
                    "name": "Tue",
                    "value": "Tue"
                  },
                  {
                    "name": "Wed",
                    "value": "Wed"
                  },
                  {
                    "name": "Thu",
                    "value": "Thu"
                  },
                  {
                    "name": "Fri",
                    "value": "Fri"
                  },
                  {
                    "name": "Sat",
                    "value": "Sat"
                  },
                  {
                    "name": "Sun",
                    "value": "Sun"
                  }
                ],
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Start Day",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Topic",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Topic",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Created",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Created",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Last Modified",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Last Modified",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Last Sent",
                "type": "dateTime",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Last Sent",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "id"
            ]
          },
          "options": {},
          "operation": "update"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Und0frCQ6SNVX3VV",
            "name": "Airtable Personal Access Token account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "88f864d6-13fb-4f09-b22d-030d016678e1",
        "name": "Search surprise",
        "type": "n8n-nodes-base.airtable",
        "position": [
          440,
          1840
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appL3dptT6ZTSzY9v",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v",
            "cachedResultName": "Scheduled Emails"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzR9vSuFUzlQNMI",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v/tblzR9vSuFUzlQNMI",
            "cachedResultName": "Table 1"
          },
          "options": {},
          "operation": "search",
          "filterByFormula": "=AND(\n  {Status} = 'active', \n  {Interval} = 'surprise'\n)"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Und0frCQ6SNVX3VV",
            "name": "Airtable Personal Access Token account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "28238d9a-7bc0-4a22-bb4e-a7a2827e4da3",
        "name": "Should Send = True",
        "type": "n8n-nodes-base.filter",
        "position": [
          800,
          1840
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "9aaf9ae2-8f96-443a-8294-c04270296b22",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.should_send }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "3a46dd3d-48a6-40ca-8823-0516aa9f73a4",
        "name": "Should Send?",
        "type": "n8n-nodes-base.code",
        "position": [
          620,
          1840
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const luckyPick = Math.floor(Math.random() * 10) + 1;\n$input.item.json.should_send = luckyPick == 8;\nreturn $input.item;"
        },
        "typeVersion": 2
      },
      {
        "id": "3611da19-920b-48e6-84a4-f7be0b3a78fc",
        "name": "Create Subscriber",
        "type": "n8n-nodes-base.airtable",
        "position": [
          440,
          820
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appL3dptT6ZTSzY9v",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v",
            "cachedResultName": "Scheduled Emails"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzR9vSuFUzlQNMI",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v/tblzR9vSuFUzlQNMI",
            "cachedResultName": "Table 1"
          },
          "columns": {
            "value": {
              "Email": "={{ $json.email }}",
              "Topic": "={{ $json.topic }}",
              "Status": "active",
              "Interval": "={{ $json.frequency }}",
              "Start Day": "={{ $json.submittedAt.toDateTime().format('EEE') }}"
            },
            "schema": [
              {
                "id": "Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Status",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "inactive",
                    "value": "inactive"
                  },
                  {
                    "name": "active",
                    "value": "active"
                  }
                ],
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Interval",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "daily",
                    "value": "daily"
                  },
                  {
                    "name": "weekly",
                    "value": "weekly"
                  },
                  {
                    "name": "surprise",
                    "value": "surprise"
                  }
                ],
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Interval",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Start Day",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "Mon",
                    "value": "Mon"
                  },
                  {
                    "name": "Tue",
                    "value": "Tue"
                  },
                  {
                    "name": "Wed",
                    "value": "Wed"
                  },
                  {
                    "name": "Thu",
                    "value": "Thu"
                  },
                  {
                    "name": "Fri",
                    "value": "Fri"
                  },
                  {
                    "name": "Sat",
                    "value": "Sat"
                  },
                  {
                    "name": "Sun",
                    "value": "Sun"
                  }
                ],
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Start Day",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Topic",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Topic",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Created",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Created",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Last Modified",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Last Modified",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Last Sent",
                "type": "dateTime",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Last Sent",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Email"
            ]
          },
          "options": {},
          "operation": "upsert"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Und0frCQ6SNVX3VV",
            "name": "Airtable Personal Access Token account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "2213a81f-53a9-4142-9586-e87b88710eec",
        "name": "Update Subscriber",
        "type": "n8n-nodes-base.airtable",
        "position": [
          440,
          1160
        ],
        "parameters": {
          "base": {
            "__rl": true,
            "mode": "list",
            "value": "appL3dptT6ZTSzY9v",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v",
            "cachedResultName": "Scheduled Emails"
          },
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "tblzR9vSuFUzlQNMI",
            "cachedResultUrl": "https://airtable.com/appL3dptT6ZTSzY9v/tblzR9vSuFUzlQNMI",
            "cachedResultName": "Table 1"
          },
          "columns": {
            "value": {
              "id": "={{ $json.ID }}",
              "Status": "inactive"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "id",
                "defaultMatch": true
              },
              {
                "id": "Name",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Status",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "inactive",
                    "value": "inactive"
                  },
                  {
                    "name": "active",
                    "value": "active"
                  }
                ],
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "Status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Interval",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "daily",
                    "value": "daily"
                  },
                  {
                    "name": "weekly",
                    "value": "weekly"
                  }
                ],
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Interval",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Start Day",
                "type": "options",
                "display": true,
                "options": [
                  {
                    "name": "Mon",
                    "value": "Mon"
                  },
                  {
                    "name": "Tue",
                    "value": "Tue"
                  },
                  {
                    "name": "Wed",
                    "value": "Wed"
                  },
                  {
                    "name": "Thu",
                    "value": "Thu"
                  },
                  {
                    "name": "Fri",
                    "value": "Fri"
                  },
                  {
                    "name": "Sat",
                    "value": "Sat"
                  },
                  {
                    "name": "Sun",
                    "value": "Sun"
                  }
                ],
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Start Day",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Topic",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": false,
                "required": false,
                "displayName": "Topic",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Created",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Created",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Last Modified",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "Last Modified",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "id"
            ]
          },
          "options": {},
          "operation": "update"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "Und0frCQ6SNVX3VV",
            "name": "Airtable Personal Access Token account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "c94ec18b-e0cf-4859-8b89-23abdd63739c",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          900,
          1280
        ],
        "parameters": {
          "color": 7,
          "width": 335,
          "height": 173,
          "content": "### 4. Using Subworkflows to run executions concurrently\nThis configuration is desired when sequential execution is slow and unnecessary. Also if one email fails, it doesn't fail the execution for everyone else."
        },
        "typeVersion": 1
      },
      {
        "id": "c14cab28-13eb-4d91-8578-8187a95a8909",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          180,
          700
        ],
        "parameters": {
          "color": 7,
          "width": 380,
          "height": 80,
          "content": "### 1. Subscribe flow\nUse a form to allow users to subscribe to the service."
        },
        "typeVersion": 1
      },
      {
        "id": "0e44ada0-f8a7-440e-aded-33b446190a08",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          180,
          1020
        ],
        "parameters": {
          "color": 7,
          "width": 355,
          "height": 115,
          "content": "### 2. Unsubscribe flow\n* Uses Form's pre-fill field feature to identify user\n* Doesn't use \"email\" as identifier so you can't unsubscribe others"
        },
        "typeVersion": 1
      },
      {
        "id": "e67bdffe-ccfc-4818-990d-b2a5ab613035",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          180,
          1340
        ],
        "parameters": {
          "color": 7,
          "width": 347,
          "height": 114,
          "content": "### 3. Scheduled Trigger\n* Runs every day at 9am\n* Handles all 3 frequency types\n* Send emails concurrently"
        },
        "typeVersion": 1
      },
      {
        "id": "ce7d5310-7170-46d3-b8d8-3f97407f9dfd",
        "name": "Subscribe Form",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          180,
          820
        ],
        "webhookId": "c6abe3e3-ba87-4124-a227-84e253581b58",
        "parameters": {
          "options": {
            "path": "free-factoids-subscribe",
            "appendAttribution": false,
            "respondWithOptions": {
              "values": {
                "formSubmittedText": "Thanks! Your factoid is on its way!"
              }
            }
          },
          "formTitle": "Learn something every day!",
          "formFields": {
            "values": [
              {
                "fieldType": "textarea",
                "fieldLabel": "topic",
                "placeholder": "What topic(s) would you like to learn about?",
                "requiredField": true
              },
              {
                "fieldType": "email",
                "fieldLabel": "email",
                "placeholder": "eg. jim@example.com",
                "requiredField": true
              },
              {
                "fieldType": "dropdown",
                "fieldLabel": "frequency",
                "fieldOptions": {
                  "values": [
                    {
                      "option": "daily"
                    },
                    {
                      "option": "weekly"
                    },
                    {
                      "option": "surprise me"
                    }
                  ]
                },
                "requiredField": true
              }
            ]
          },
          "formDescription": "Get a fact a day (or week) about any subject sent to your inbox."
        },
        "typeVersion": 2.2
      },
      {
        "id": "a5d50886-7d6b-4bf8-b376-b23c12a60608",
        "name": "Execution Data",
        "type": "n8n-nodes-base.executionData",
        "position": [
          1560,
          1480
        ],
        "parameters": {
          "dataToSave": {
            "values": [
              {
                "key": "email",
                "value": "={{ $json.email }}"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "69b40d8d-7734-47f1-89fe-9ea0378424b7",
        "name": "Window Buffer Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          1860,
          1680
        ],
        "parameters": {
          "sessionKey": "=scheduled_send_{{ $json.email }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "f83cff18-f41f-4a63-9d43-7e3947aae386",
        "name": "Wikipedia",
        "type": "@n8n/n8n-nodes-langchain.toolWikipedia",
        "position": [
          2020,
          1680
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "77457037-e3ab-42f1-948b-b994d42f2f6e",
        "name": "Content Generation Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1780,
          1460
        ],
        "parameters": {
          "text": "=Generate an new factoid on the following topic: \"{{ $json.topic.replace('\"','') }}\"\nEnsure it is unique and not one generated previously.",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "cdfdd870-48b6-4c7d-a7d1-a22d70423e37",
        "name": "Groq Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
        "position": [
          1720,
          1680
        ],
        "parameters": {
          "model": "llama-3.3-70b-versatile",
          "options": {}
        },
        "credentials": {
          "groqApi": {
            "id": "02xZ4o87lUMUFmbT",
            "name": "Groq account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "87df322d-a544-476f-b2ff-83feb619fe7f",
        "name": "Generate Image",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          2120,
          1460
        ],
        "parameters": {
          "prompt": "=Generate a child-friendly illustration which compliments the following paragraph:\n{{ $json.output }}",
          "options": {},
          "resource": "image"
        },
        "credentials": {
          "openAiApi": {
            "id": "8gccIjcuf3gvaoEr",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.7
      },
      {
        "id": "5c8d9e72-4015-44da-b5d5-829864d33672",
        "name": "Resize Image",
        "type": "n8n-nodes-base.editImage",
        "position": [
          2280,
          1460
        ],
        "parameters": {
          "width": 480,
          "height": 360,
          "options": {},
          "operation": "resize"
        },
        "typeVersion": 1
      },
      {
        "id": "a9939fad-98b3-4894-aae0-c11fa40d09da",
        "name": "Send Message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2680,
          1480
        ],
        "webhookId": "dd8bd6df-2013-4f8d-a2cc-cd9b3913e3d2",
        "parameters": {
          "sendTo": "={{ $json.to }}",
          "message": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>{{ $json.subject }}</title>\n</head>\n<body>\n    {{ $json.message }}\n<p>\n<a href=\"{{ $json.unsubscribe_link }}\">Unsubscribe</a>\n</p>\n</body>\n</html>\n",
          "options": {
            "attachmentsUi": {
              "attachmentsBinary": [
                {}
              ]
            },
            "appendAttribution": false
          },
          "subject": "={{ $json.subject }}"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "10b6ad35-fc1c-47a2-b234-5de3557d1164",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1320,
          1660
        ],
        "parameters": {
          "color": 7,
          "width": 335,
          "height": 113,
          "content": "### 5. Use Execution Data to Filter Logs\nIf you've registered for community+ or are on n8n cloud, best practice is to use execution node to allow filtering of execution logs."
        },
        "typeVersion": 1
      },
      {
        "id": "e3563fae-ff35-457b-9fb1-784eda637518",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1780,
          1280
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 140,
          "content": "### 6. Use AI to Generate Factoid and Image\nUse an AI agent to automate the generation of factoids as requested by the user. This is a simple example but we recommend a adding a unique touch to stand out from the crowd!"
        },
        "typeVersion": 1
      },
      {
        "id": "d1016c5d-c855-44c5-8ad3-a534bedaa8cf",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2500,
          1040
        ],
        "parameters": {
          "color": 7,
          "width": 460,
          "height": 400,
          "content": "### 7. Send Email to User\nFinally, send a message to the user with both text and image.\nLog the event in the Airtable for later analysis if required.\n\n![Screenshot of email result](https://res.cloudinary.com/daglih2g8/image/upload/f_auto,q_auto/v1/n8n-workflows/dbpctdhohj3vlewy6oyc)"
        },
        "typeVersion": 1
      },
      {
        "id": "773075fa-e5a2-4d4f-8527-eb07c7038b00",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -420,
          680
        ],
        "parameters": {
          "width": 480,
          "height": 900,
          "content": "## Try It Out!\n\n### This n8n templates demonstrates how to build a simple subscriber service entirely in n8n using n8n forms as a frontend, n8n generally as the backend and Airtable as the storage layer.\n\nThis template in particular shows a fully automated service to send automated messages containing facts about a topic the user requested for.\n\n### How it works\n* An n8n form is setup up to allow users to subscribe with a desired topic and interval of which to recieve messages via n8n forms which is then added to the Airtable.\n* A scheduled trigger is executed every morning and searches for subscribers to send messages for based on their desired intervals.\n* Once found, Subscribers are sent to a subworkflow which performs the text content generation via an AI agent and also uses a vision model to generate an image.\n* Both are attached to an email which is sent to the subscriber. This email also includes an unsubscribe link.\n* The unsubscribe flow works similarly via n8n form interface which when submitted disables further scheduled emails to the user.\n\n## How to use\n* Make a copy of sample Airtable here: https://airtable.com/appL3dptT6ZTSzY9v/shrLukHafy5bwDRfD\n* Make sure the workflow is \"activated\" and the forms are available and reachable by your audience.\n\n\n### Need Help?\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!\n\nHappy Hacking!"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Wikipedia": {
        "ai_tool": [
          [
            {
              "node": "Content Generation Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Create Event": {
        "main": [
          [
            {
              "node": "Execute Workflow",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Resize Image": {
        "main": [
          [
            {
              "node": "Set Email Vars",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search daily": {
        "main": [
          [
            {
              "node": "Create Event",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Message": {
        "main": [
          [
            {
              "node": "Log Last Sent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Should Send?": {
        "main": [
          [
            {
              "node": "Should Send = True",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search weekly": {
        "main": [
          [
            {
              "node": "Create Event",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execution Data": {
        "main": [
          [
            {
              "node": "Content Generation Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Image": {
        "main": [
          [
            {
              "node": "Resize Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Email Vars": {
        "main": [
          [
            {
              "node": "Send Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Subscribe Form": {
        "main": [
          [
            {
              "node": "Create Subscriber",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Groq Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Content Generation Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Search surprise": {
        "main": [
          [
            {
              "node": "Should Send?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Search surprise",
              "type": "main",
              "index": 0
            },
            {
              "node": "Search daily",
              "type": "main",
              "index": 0
            },
            {
              "node": "Search weekly",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Unsubscribe Form": {
        "main": [
          [
            {
              "node": "Update Subscriber",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Subscriber": {
        "main": [
          [
            {
              "node": "confirmation email1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Should Send = True": {
        "main": [
          [
            {
              "node": "Create Event",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Window Buffer Memory": {
        "ai_memory": [
          [
            {
              "node": "Content Generation Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Content Generation Agent": {
        "main": [
          [
            {
              "node": "Generate Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Workflow Trigger": {
        "main": [
          [
            {
              "node": "Execution Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "M8oLW9Qd59zNJzg2",
    "meta": {
      "instanceId": "1abe0e4c2be794795d12bf72aa530a426a6f87aabad209ed6619bcaf0f666fb0",
      "templateCredsSetupCompleted": true
    },
    "name": "Email Summary Agent",
    "tags": [
      {
        "id": "G1v7CnFpOHsReVhM",
        "name": "Product",
        "createdAt": "2025-01-13T17:04:34.969Z",
        "updatedAt": "2025-01-13T17:04:34.969Z"
      },
      {
        "id": "RagrXIh5iBDseqvj",
        "name": "AI",
        "createdAt": "2025-01-09T09:18:12.756Z",
        "updatedAt": "2025-01-09T09:18:12.756Z"
      },
      {
        "id": "Yg2lfYteJZAoIeaC",
        "name": "Building blocks",
        "createdAt": "2025-01-13T17:05:49.788Z",
        "updatedAt": "2025-01-13T17:05:49.788Z"
      },
      {
        "id": "ZuS1C3NpE8uBlFq4",
        "name": "Finance",
        "createdAt": "2025-01-13T17:05:03.996Z",
        "updatedAt": "2025-01-13T17:05:03.996Z"
      },
      {
        "id": "aqlZb2qfWiaT4Xr5",
        "name": "IT Ops",
        "createdAt": "2025-01-03T12:20:11.917Z",
        "updatedAt": "2025-01-03T12:20:11.917Z"
      },
      {
        "id": "fX8hRnEv4D8sLSzF",
        "name": "OpenAI",
        "createdAt": "2025-01-09T09:18:12.757Z",
        "updatedAt": "2025-01-09T09:18:12.757Z"
      },
      {
        "id": "j1qBXzFADkR3sHSa",
        "name": "Marketing",
        "createdAt": "2025-01-13T17:03:54.468Z",
        "updatedAt": "2025-01-13T17:03:54.468Z"
      },
      {
        "id": "x3OVvOuZkLx1hYpW",
        "name": "Support",
        "createdAt": "2025-01-13T17:05:40.900Z",
        "updatedAt": "2025-01-13T17:05:40.900Z"
      },
      {
        "id": "xBOhq1kP3lza5ajE",
        "name": "HR",
        "createdAt": "2025-01-13T17:04:57.045Z",
        "updatedAt": "2025-01-13T17:04:57.045Z"
      },
      {
        "id": "yy04JQqCaXepPdSa",
        "name": "Project Management",
        "createdAt": "2024-10-30T18:27:57.309Z",
        "updatedAt": "2024-10-30T18:27:57.309Z"
      },
      {
        "id": "zJaZorWWcGpTp35U",
        "name": "DevOps",
        "createdAt": "2025-01-03T12:19:34.273Z",
        "updatedAt": "2025-01-03T12:19:34.273Z"
      }
    ],
    "nodes": [
      {
        "id": "94c09c05-539b-452e-83b7-0a029bbe6b7f",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -120,
          -140
        ],
        "parameters": {
          "width": 248.47086922498647,
          "height": 314.47468983163634,
          "content": "- Starts the workflow every day at 7 AM.\n- Adjust the time if you want the workflow to run at a different hour."
        },
        "typeVersion": 1
      },
      {
        "id": "5e5cbc87-5c01-438b-a1c0-e8468d3ee20b",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          160,
          -137.04548301590512
        ],
        "parameters": {
          "width": 213.36643278764896,
          "height": 313.40934714314244,
          "content": "Fetches all emails received in the past 24 hours from the email address"
        },
        "typeVersion": 1
      },
      {
        "id": "9a82f5e9-7d0b-430f-9dbb-d8ae0b129dad",
        "name": "Daily 7AM Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -40,
          0
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 7
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "dd3e4b10-187b-45ce-b999-f0143e5af134",
        "name": "Fetch Emails - Past 24 Hours",
        "type": "n8n-nodes-base.gmail",
        "position": [
          220,
          0
        ],
        "webhookId": "20f1d11d-8a69-43f3-9323-33eaf1b3b600",
        "parameters": {
          "filters": {
            "q": "={{ \n  (() => {\n    const yesterday = new Date();\n    yesterday.setDate(yesterday.getDate() - 1);\n    return `isb.quantana@quantana.in after:${yesterday.getFullYear()}/${(yesterday.getMonth() + 1).toString().padStart(2, '0')}/${yesterday.getDate().toString().padStart(2, '0')}`;\n  })()\n}}"
          },
          "operation": "getAll",
          "returnAll": true
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YFARhQXJAjbwXjSO",
            "name": "Vishal Gmail"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "4a8fdfd9-93d7-43a2-92b0-88d845f217bf",
        "name": "Organize Email Data - Morning",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          460,
          0
        ],
        "parameters": {
          "include": "specifiedFields",
          "options": {},
          "aggregate": "aggregateAllItemData",
          "fieldsToInclude": "id, From, To, CC, snippet"
        },
        "typeVersion": 1
      },
      {
        "id": "9e2426e8-57ba-4708-b66f-b58bd19eabff",
        "name": "Summarize Emails with OpenAI - Morning",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          680,
          0
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Go through this email summary and identify all key details mentioned, any specific issues to look at, and action items.\nUse this format to output\n{\n  \"summary_of_emails\": [\n    \"Point 1\",\n    \"Point 2\",\n    \"Point 3\"\n  ],\n  \"actions\": [\n    {\n      \"name\": \"Name 1\",\n      \"action\": \"Action 1\"\n    },\n    {\n      \"name\": \"Name 1\",\n      \"action\": \"Action 2\"\n    },\n    {\n      \"name\": \"Name 2\",\n      \"action\": \"Action 3\"\n    }\n  ]\n}\n\nInput Data:\n\n {{ $json.data.toJsonString() }}\n\n"
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "ksU2WMcMqe2lPgRw",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.7
      },
      {
        "id": "4aa68ee8-d38f-418a-9f20-6cc76850c638",
        "name": "Send Summary - Morning",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1040,
          0
        ],
        "webhookId": "83f2aeb9-7b6c-4336-b5ed-8acfcd259850",
        "parameters": {
          "sendTo": "team-email@example.com",
          "message": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Email Summary - isbonline@quantana.in</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 0;\n            background-color: #f9f9f9;\n            color: #333;\n            line-height: 1.6;\n        }\n        .email-container {\n            max-width: 600px;\n            margin: 20px auto;\n            background: #ffffff;\n            border: 1px solid #ddd;\n            border-radius: 10px;\n            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n        }\n        .email-header {\n            background-color: #0073e6;\n            color: #fff;\n            padding: 20px;\n            text-align: center;\n            border-top-left-radius: 10px;\n            border-top-right-radius: 10px;\n        }\n        .email-header h1 {\n            margin: 0;\n            font-size: 24px;\n        }\n        .email-content {\n            padding: 20px;\n        }\n        .section-title {\n            font-size: 20px;\n            color: #0073e6;\n            margin-bottom: 10px;\n        }\n        ul {\n            list-style: none;\n            padding: 0;\n        }\n        ul li {\n            margin: 10px 0;\n            padding: 10px;\n            background: #f4f4f4;\n            border-left: 4px solid #0073e6;\n            border-radius: 5px;\n        }\n        .action-item {\n            font-weight: bold;\n            margin: 5px 0;\n        }\n        .action-detail {\n            margin-left: 10px;\n        }\n        .email-footer {\n            background-color: #0073e6;\n            color: #fff;\n            text-align: center;\n            padding: 10px;\n            font-size: 14px;\n            border-bottom-left-radius: 10px;\n            border-bottom-right-radius: 10px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"email-container\">\n        <div class=\"email-header\">\n            <h1>Email Summary</h1>\n        </div>\n        <div class=\"email-content\">\n            <div>\n                <h2 class=\"section-title\">Summary of Emails:</h2>\n                <ul>\n                    {{ $json.message.content.summary_of_emails.map(email => `<li>${email}</li>`).join('') }}\n                </ul>\n            </div>\n            <div>\n                <h2 class=\"section-title\">Actions:</h2>\n                <ul>\n                    {{ $json.message.content.actions.map(action => `\n                        <li>\n                            <span class=\"action-item\">${action.name}:</span>\n                            <span class=\"action-detail\">${action.action}</span>\n                        </li>\n                    `).join('') }}\n                </ul>\n            </div>\n        </div>\n        <div class=\"email-footer\">\n            <p>Generated by Quantana ESAgent <br /> A Quantana AI Labs Initiative\n        </div>\n    </div>\n</body>\n</html>",
          "options": {
            "ccList": "cc-list@example.com",
            "appendAttribution": false,
            "replyToSenderOnly": false
          },
          "subject": "=ESAgent - {{ new Date(new Date().setDate(new Date().getDate() - 1)).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }) }}-00:00 to {{ new Date(new Date().setDate(new Date().getDate())).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }) }}-07:00AM"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "YFARhQXJAjbwXjSO",
            "name": "Vishal Gmail"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "c7667667-9533-40cb-9c09-914a11560600",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          -132.6641804468672
        ],
        "parameters": {
          "width": 226.7095107678671,
          "height": 305.83657700487913,
          "content": "Organizes the fetched email data, extracting fields like sender, receiver, CC, and a preview snippet."
        },
        "typeVersion": 1
      },
      {
        "id": "43955af4-3a18-44d7-8c8d-cf8051b18bdd",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          980,
          -180
        ],
        "parameters": {
          "width": 232.8435827211592,
          "height": 359.7308639651144,
          "content": "- Sends the summarized email report to recipients with a styled HTML layout.\n- Update the \"sendTo\" and \"ccList\" fields with the email addresses of your recipients.\n\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "timezone": "Asia/Kolkata",
      "callerPolicy": "workflowsFromSameOwner",
      "executionOrder": "v1"
    },
    "versionId": "b18912ed-6c1f-4912-b75a-1553f7620917",
    "connections": {
      "Daily 7AM Trigger": {
        "main": [
          [
            {
              "node": "Fetch Emails - Past 24 Hours",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Emails - Past 24 Hours": {
        "main": [
          [
            {
              "node": "Organize Email Data - Morning",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Organize Email Data - Morning": {
        "main": [
          [
            {
              "node": "Summarize Emails with OpenAI - Morning",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Summarize Emails with OpenAI - Morning": {
        "main": [
          [
            {
              "node": "Send Summary - Morning",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "e63GF6KHkhFUFKfz",
    "meta": {
      "instanceId": "2000c64071c20843606b95c63795bb0797c41036047055a6586498e855b96efc",
      "templateCredsSetupCompleted": true
    },
    "name": "Build your first email agent with fall back model",
    "tags": [],
    "nodes": [
      {
        "id": "4a1bcd5c-ac55-4edc-8508-f2921dcc1b68",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          288,
          0
        ],
        "parameters": {
          "text": "={{ $json.Subject }} {{ $json.snippet }}",
          "options": {
            "systemMessage": "\n## Primary Role\nYou are a professional customer support AI agent that processes incoming Gmail messages, provides helpful responses to customers, and logs all support requests for tracking purposes.\n\n## Core Responsibilities\n\n### 1. Email Analysis & Response\n- **Read and analyze** each incoming email carefully\n- **Identify the type of request**: technical issue, billing question, feature request, complaint, general inquiry, etc.\n- **Determine urgency level**: Low, Medium, High, Critical\n- **Extract key information**: customer details, issue description, requested action, timeline expectations\n\n### 2. Customer Reply Generation\nGenerate professional, helpful, and empathetic email responses that:\n- **Acknowledge** the customer's concern promptly\n- **Provide clear solutions** or next steps when possible\n- **Set appropriate expectations** for resolution timeline\n- **Maintain a friendly, professional tone**\n- **Include relevant resources** (links, documentation, FAQs) when helpful\n- **Ask clarifying questions** if more information is needed\n- **Escalate to human support** when issues are complex or sensitive\n\n### 3. Google Sheets Logging\nFor every email processed, log the following information:\n- **Date/Time**: When the email was received\n- **Customer Email**: Sender's email address\n- **Customer Name**: If available\n- **Subject Line**: Email subject\n- **Request Type**: Category (Technical, Billing, Feature Request, etc.)\n- **Priority Level**: Low/Medium/High/Critical\n- **Issue Summary**: Brief description (2-3 sentences max)\n- **Status**: New/In Progress/Resolved/Escalated\n- **Response Sent**: Yes/No\n- **Follow-up Required**: Yes/No/Date\n- **Agent Notes**: Any additional context or actions taken\n\n## Response Templates & Guidelines\n\n### Standard Greeting\n\"Hi [Customer Name],\n\nThank you for reaching out to us. I've received your message regarding [brief issue summary].\"\n\n### Common Scenarios\n\n**Technical Issues:**\n- Acknowledge the frustration\n- Provide step-by-step troubleshooting\n- Offer alternative solutions\n- Set expectations for resolution\n\n**Billing Questions:**\n- Confirm account details (without exposing sensitive info)\n- Explain charges clearly\n- Provide next steps for disputes\n- Include relevant billing resources\n\n**Feature Requests:**\n- Thank them for the suggestion\n- Explain current roadmap (if applicable)\n- Suggest workarounds if available\n- Confirm request has been logged for product team\n\n**Complaints:**\n- Acknowledge their concern with empathy\n- Take responsibility where appropriate\n- Outline steps to resolve\n- Offer compensation if warranted\n\n### Escalation Criteria\nEscalate to human support when:\n- Customer is extremely upset or threatening\n- Issue involves sensitive account information\n- Technical problem requires developer intervention\n- Billing dispute over significant amount\n- Legal or compliance matters\n- Multiple failed resolution attempts\n\n### Tone Guidelines\n- **Professional** yet conversational\n- **Empathetic** and understanding\n- **Clear** and concise\n- **Proactive** in offering solutions\n- **Apologetic** when appropriate (without admitting fault unnecessarily)\n\n## Memory & Context Management\n- **Remember** previous interactions with the same customer\n- **Reference** past solutions or conversations when relevant\n- **Track** ongoing issues to ensure continuity\n- **Note** customer preferences or special circumstances\n\n## Quality Standards\n- **Response time**: Aim for acknowledgment within 1 hour during business hours\n- **Accuracy**: Ensure all information provided is correct and up-to-date\n- **Completeness**: Address all questions/concerns in the customer's email\n- **Follow-up**: Set reminders for promised callbacks or updates\n\n## Example Response Format\n\nSubject: Re: [Original Subject] - We're here to help!\n\nHi [Customer Name],\n\nThank you for contacting us about [issue]. I understand [acknowledge their concern/situation].\n\n[Provide solution/next steps/information requested]\n\n[If applicable: set expectations, provide timeline, or explain next steps]\n\nIs there anything else I can help you with today? We're always here to support you.\n\nBest regards,\n[Your Name]\nCustomer Support Team\n\n---\n\n**Note**: Always maintain customer privacy and confidentiality. Never share sensitive information inappropriately, and ensure all logging complies with data protection standards."
          },
          "promptType": "define",
          "needsFallback": true
        },
        "typeVersion": 2.1
      },
      {
        "id": "a2a87327-902b-4f95-b819-25221793fb77",
        "name": "Gmail Trigger",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          -32,
          0
        ],
        "parameters": {
          "filters": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "LVRUgE95PAvkE1Mc",
            "name": "Gmail account 2"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "06d647bb-b03d-42bf-8462-204546d3b427",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          384,
          256
        ],
        "parameters": {
          "sessionKey": "={{ $('Gmail Trigger').item.json.id }}",
          "sessionIdType": "customKey"
        },
        "typeVersion": 1.3
      },
      {
        "id": "4ce6dbd6-e68a-4e86-92db-4ed5c9b362b4",
        "name": "Append or update row in sheet in Google Sheets",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          528,
          256
        ],
        "parameters": {
          "columns": {
            "value": {
              "email address ": "={{ $('Gmail Trigger').item.json.To }}"
            },
            "schema": [
              {
                "id": "customer_name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "customer_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email address ",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "email address ",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Service type",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Service type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "appointment date",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "appointment date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "estimated duration",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "estimated duration",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "estimated price",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "estimated price",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "stylist name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "stylist name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "hair length",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "hair length",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "phone number ",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "phone number ",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "customer_name"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1KFjFpYS9akNv_I-JcQKMQVBT-rXYfK2sC4dP6QYpcp4/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1KFjFpYS9akNv_I-JcQKMQVBT-rXYfK2sC4dP6QYpcp4",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1KFjFpYS9akNv_I-JcQKMQVBT-rXYfK2sC4dP6QYpcp4/edit?usp=drivesdk",
            "cachedResultName": "SUPPORT LOG "
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "vL25dYTf9oT1CSvl",
            "name": "Google Sheets account 2"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "4310966d-894d-490b-9d52-49c1aa03b9ae",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1104,
          -352
        ],
        "parameters": {
          "width": 768,
          "height": 848,
          "content": "# 🤖 Your First Email Agent with Fallback Model\n\n## 📧 What This Workflow Does\nThis automation creates an intelligent email support system that:\n- **Monitors Gmail** for new customer emails\n- **Processes requests** using AI with smart fallback options\n- **Sends personalized replies** automatically\n- **Logs everything** to Google Sheets for tracking\n\n## 🔄 How the Fallback Model Works\n\n### Primary Model: Google Gemini Chat\n- **Fast & Cost-Effective** - Handles 90% of standard support queries\n- **Great for**: FAQ responses, basic troubleshooting, general inquiries\n\n### Fallback Model: OpenAI GPT\n- **Kicks in when** Gemini fails or encounters complex queries\n- **Better for**: Nuanced responses, technical issues, edge cases\n- **Higher accuracy** for complex customer situations\n\n## 🏗️ Workflow Architecture\n\n```\nGmail Trigger → AI Agent → Response Decision → Actions\n                   ↓\n            [Primary Model]\n                   ↓\n            [Fallback Model] ← (if needed)\n                   ↓\n         [Send Reply + Log Data]\n```\n"
        },
        "typeVersion": 1
      },
      {
        "id": "ddc5d69b-8386-45e1-9b7f-139e5b42c15f",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1072,
          -512
        ],
        "parameters": {
          "width": 640,
          "height": 1360,
          "content": "\n## 💡 Why Use a Fallback Model?\n\n### Reliability\n- **99.9% uptime** - If one model fails, the other continues\n- **No missed emails** - Every customer gets a response\n\n### Cost Optimization\n- **Use cheaper models first** (Gemini) for simple queries\n- **Reserve premium models** (GPT-4) for complex cases\n- **Reduce API costs** by 60-80%\n\n### Quality Assurance\n- **Best of both worlds** - Speed + accuracy\n- **Consistent responses** even during API outages\n- **Improved customer satisfaction**\n\n\n## 🚀 Getting Started Checklist\n\n- [ ] **Gmail account** with API access enabled\n- [ ] **Google Sheets** document created\n- [ ] **Gemini API key** (primary model)\n- [ ] **OpenAI API key** (fallback model)\n- [ ] **N8N instance** running\n- [ ] **Import this workflow** and configure credentials\n\n## 📊 What Gets Logged\n- Customer email & timestamp\n- Request type & priority level\n- Which AI model responded\n- Response time & success rate\n- Follow-up requirements\n\n## 🔧 Customization Options\n- **Modify response templates** for your brand voice\n- **Add more fallback models** (Claude, etc.)\n- **Create custom triggers** (Slack, Discord, etc.)\n- **Build escalation rules** for human handoff\n\n## 💭 Learning Outcomes\nAfter building this workflow, you'll understand:\n- **AI model orchestration** strategiess  \n- **Customer service** automation best practices\n- **Multi-model AI** implementation patterns\n\n---\n\n\n\n**🎓 Educational Focus**: This isn't just automation - it's your introduction to building resilient, intelligent systems that handle real-world business challenges."
        },
        "typeVersion": 1
      },
      {
        "id": "08ff7ff4-4c41-43e9-a71d-43e07f0c75e4",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -192,
          -448
        ],
        "parameters": {
          "width": 464,
          "height": 448,
          "content": "## 🎯 Perfect for Beginners Because:\n\n### Simple Setup\n- **Drag & drop** workflow design\n- **Pre-built integrations** with Gmail & Sheets\n- **Copy-paste ready** - Just add your API keys\n\n### Educational Value\n- **Learn AI orchestration** concepts\n- **Understand fallback patterns** in automation\n- **See real-world AI applications** in action\n\n### Immediate Results\n- **Works out of the box** with minimal configuration\n- **See responses** within minutes of setup\n- **Track performance** in Google Sheets dashboard\n"
        },
        "typeVersion": 1
      },
      {
        "id": "99dd9b98-5384-498e-b3e5-2552bb7016b0",
        "name": "OpenAI  Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -96,
          288
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "BXMUxnyGzjtZQOK4",
            "name": "OpenAi account Dave"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "b91e9199-c9cd-4dc6-bd8e-9a97aad2f9c4",
        "name": "Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -192,
          272
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "googlePalmApi": {
            "id": "OCsJdRrt1Xxv1ZGe",
            "name": "paid google console"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b56d1d13-8b88-4a69-b0d9-c2c35e6f95da",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -208,
          176
        ],
        "parameters": {
          "height": 224,
          "content": "## Ai Models"
        },
        "typeVersion": 1
      },
      {
        "id": "9ecaa23a-40af-4d5f-80ef-a6df1dc9acf9",
        "name": "Reply to a message(Thread)",
        "type": "n8n-nodes-base.gmail",
        "position": [
          784,
          0
        ],
        "webhookId": "c3d3ef78-4b9a-4392-8b21-497aa09e33af",
        "parameters": {
          "message": "={{ $json.output }}",
          "options": {},
          "resource": "thread",
          "threadId": "={{ $('Gmail Trigger').item.json.id }}",
          "messageId": "={{ $('Gmail Trigger').item.json.id }}",
          "operation": "reply"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "LVRUgE95PAvkE1Mc",
            "name": "Gmail account 2"
          }
        },
        "typeVersion": 2.1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "51d6850a-e062-4209-b0d3-e6f4d5f0eb05",
    "connections": {
      "AI Agent": {
        "main": [
          [
            {
              "node": "Reply to a message(Thread)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail Trigger": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI  Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Append or update row in sheet in Google Sheets": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "4ab973b0-1d9e-4f21-9054-fd518305153d",
        "name": "Latest Episode",
        "type": "n8n-nodes-base.limit",
        "position": [
          -848,
          -448
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "90d86576-599f-49a6-ad8f-735b6ab65f29",
        "name": "Parse HTML",
        "type": "n8n-nodes-base.code",
        "position": [
          -512,
          -448
        ],
        "parameters": {
          "jsCode": "const html = $input.first().json.data;\n\n// Function to clean the text extracted from the HTTP request node\nfunction cleanText(text) {\n  if (!text) return '';\n  return text\n    .replace(/<[^>]*>/g, '') \n    .replace(/&nbsp;/g, ' ') \n    .replace(/&amp;/g, '&')  \n    .replace(/&lt;/g, '<')   \n    .replace(/&gt;/g, '>')   \n    .replace(/&quot;/g, '\"') \n    .replace(/\\\\n/g, '\\n')   \n    .replace(/\\s+/g, ' ')    \n    .trim();\n}\n\n// Episode Meta Data for record\nconst episodeUrl = $('Podcasts from RSS Feed').first().json.link;\nconst episodeMatch = episodeUrl.match(/ep-(\\d+)/);\nconst episodeId = episodeMatch ? episodeMatch[1] : 'unknown';\nconst episodeCode = episodeMatch ? episodeMatch[0] : 'unknown';\nconst episodeTitle = $('Podcasts from RSS Feed').first().json.title|| 'Unknown Title';\n\n// Extract the vocabulary from the specific section\nconst vocabMatch = html.match(/<h3>Vocabulary<\\/h3>([\\s\\S]*?)(?=<h3>|<p><strong style)/);\nlet vocabularyItems = [];\n\nif (vocabMatch && vocabMatch[1]) {\n  const vocabHtml = vocabMatch[1];\n  \n  // Parse vocabulary entries (format: <strong>word</strong><br />definition<br />&nbsp;)\n  const vocabRegex = /<strong>(.*?)<\\/strong><br \\/>(.*?)(?=<br \\/>|<\\/p>)/gs;\n  const matches = [...vocabHtml.matchAll(vocabRegex)];\n  \n  matches.forEach(match => {\n    const word = cleanText(match[1]);\n    const definition = cleanText(match[2]);\n    \n    if (word && definition && word !== '&nbsp;') {\n      vocabularyItems.push({\n        word: word,\n        definition: definition\n      });\n    }\n  });\n}\n\n// Extract Transcript\nconst transcriptMatch = html.match(/<strong style=\"font-size: 1\\.17em;\">TRANSCRIPT<\\/strong><\\/p>([\\s\\S]*?)(?=<h3>Next<\\/h3>|<div class=\"widget widget-list)/);\nlet transcriptText = '';\n\nif (transcriptMatch && transcriptMatch[1]) {\n  const paragraphs = transcriptMatch[1].match(/<p[^>]*>(.*?)<\\/p>/gs);\n  \n  if (paragraphs) {\n    transcriptText = paragraphs\n      .map(p => cleanText(p))\n      .filter(t => t.length > 0 && !t.startsWith('Note:')) // Remove note disclaimer\n      .join('\\n\\n');\n  }\n}\n\n// Extract Episode Description\nconst descriptionMatch = html.match(/<meta name=\"description\" content=\"([^\"]+)\"/);\nconst description = descriptionMatch ? descriptionMatch[1] : '';\n\n// Extract Links for download\nconst downloadLinks = {\n  pdf: '',\n  audio: '',\n  transcript: '',\n  podcast: ''\n};\n// PDF link\nconst pdfMatch = html.match(/href=\"(https:\\/\\/downloads\\.bbc\\.co\\.uk\\/learningenglish\\/features\\/6min\\/[^\"]*\\.pdf)\"/);\nif (pdfMatch) {\n  downloadLinks.pdf = pdfMatch[1];\n  downloadLinks.transcript = pdfMatch[1]; // Same as PDF in this case\n}\n// Audio MP3 link\nconst audioMatch = html.match(/href=\"(https:\\/\\/downloads\\.bbc\\.co\\.uk\\/learningenglish\\/features\\/6min\\/[^\"]*\\.mp3)\"/);\nif (audioMatch) {\n  downloadLinks.audio = audioMatch[1];\n}\n// Podcast link\nconst podcastMatch = html.match(/href=\"(https:\\/\\/www\\.bbc\\.co\\.uk\\/programmes\\/p02pc9tn\\/episodes\\/downloads)\"/);\nif (podcastMatch) {\n  downloadLinks.podcast = podcastMatch[1];\n}\n\nreturn {\n  json: {\n    // Episode metadata\n    episode_id: episodeId,\n    episode_code: episodeCode,\n    episode_url: episodeUrl,\n    episode_title: cleanText(episodeTitle),\n    description: description,\n    processed_date: new Date().toISOString().split('T')[0],\n    \n    // Main content\n    transcript: transcriptText,\n    transcript_word_count: transcriptText.split(/\\s+/).length,\n    \n    // Vocabulary (BBC's own selection)\n    vocabulary_items: vocabularyItems,\n    vocabulary_count: vocabularyItems.length,\n\n    // Download links\n    download_links: downloadLinks\n  }\n};"
        },
        "typeVersion": 2
      },
      {
        "id": "a10da932-7465-41d1-ac82-ff4a39a62714",
        "name": "Prepare Email",
        "type": "n8n-nodes-base.code",
        "position": [
          384,
          -480
        ],
        "parameters": {
          "jsCode": "// Data from the parsing node\nconst episodeData = $('Parse HTML').first().json;\n\n// Hook Message from AI\nconst hookMessage = $('Email Hook').first().json.output;\n\n// Practice Exercises from AI\nconst aiPracticeContent = $('Practice Exercises').first().json.output;\nconst practiceExercises = aiPracticeContent\n  .split('\\n')\n  .filter(line => line.trim().length > 0)\n  .filter(line => line.includes('_____'));\n\n// Discussion Questions from AI\nconst aiDiscussionContent = $('Discussion Questions').first().json.output;\nconst discussionQuestions = aiDiscussionContent\n  .split('\\n')\n  .filter(line => line.trim().length > 0)\n  .map(line => line.replace(/^\\d+[\\.\\)]\\s*/, '').trim())\n  .filter(line => line.length > 10)\n  .slice(0, 5);\n\n// Additional functions for data processing\nfunction cleanTitle(title) {\n  return title\n    .replace(/^BBC Learning English - 6 Minute English \\/ /, '')\n    .replace(/^BBC Learning English - /, '')\n    .trim();\n}\n\nfunction generateVocabHTML(vocabItems) {\n  return vocabItems.map((item, index) => `\n    <li class=\"vocab-item\">\n      <span class=\"vocab-word\">${index + 1}. ${item.word}</span>\n      <span class=\"vocab-definition\">${item.definition}</span>\n    </li>\n  `).join('');\n}\n\nfunction generatePracticeHTML(exercises) {\n  return exercises.map(ex => `<li>${ex.trim()}</li>`).join('');\n}\n\nfunction generateDiscussionHTML(questions) {\n  return questions.map(q => `<li class=\"discussion-item\">${q}</li>`).join('');\n}\n\n// Email HTML\nconst htmlEmail = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Learn English with BBC & LogiGreen Bot</title>\n    <style>\n        body { margin: 0; padding: 0; font-family: Arial, sans-serif; background-color: #f4f4f4; }\n        .email-container { max-width: 600px; margin: 0 auto; background-color: #ffffff; }\n        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #ffffff; padding: 30px 20px; text-align: center; }\n        .header h1 { margin: 0; font-size: 24px; }\n        .episode-badge { display: inline-block; background-color: rgba(255, 255, 255, 0.2); padding: 5px 15px; border-radius: 20px; font-size: 12px; margin-top: 10px; }\n        .content { padding: 30px 20px; }\n        .section { margin-bottom: 30px; }\n        .section-title { font-size: 18px; font-weight: 700; color: #2d3748; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 3px solid #667eea; }\n        .hook-message { background-color: #f7fafc; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea; line-height: 1.6; color: #2d3748; margin-bottom: 20px; }\n        .button-container { text-align: center; margin: 25px 0; }\n        .button { display: inline-block; padding: 14px 28px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #ffffff !important; text-decoration: none; border-radius: 6px; font-weight: 600; font-size: 16px; }\n        .vocab-list { list-style: none; padding: 0; margin: 0; }\n        .vocab-item { background-color: #f7fafc; padding: 15px; border-radius: 6px; margin-bottom: 12px; border-left: 4px solid #667eea; }\n        .vocab-word { font-weight: 700; color: #667eea; font-size: 16px; display: block; margin-bottom: 5px; }\n        .vocab-definition { color: #4a5568; line-height: 1.5; font-size: 14px; }\n        .discussion-list { list-style: none; padding: 0; counter-reset: discussion-counter; }\n        .discussion-item { padding: 15px; margin-bottom: 12px; background-color: #fffaf0; border-radius: 6px; border-left: 4px solid #ed8936; counter-increment: discussion-counter; position: relative; padding-left: 50px; }\n        .discussion-item:before { content: counter(discussion-counter); position: absolute; left: 15px; top: 15px; background-color: #ed8936; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 14px; }\n        .checklist { background-color: #f0fff4; padding: 20px; border-radius: 8px; border-left: 4px solid #48bb78; }\n        .checklist-item { padding: 10px 0; border-bottom: 1px solid #c6f6d5; color: #2d3748; }\n        .checklist-item:last-child { border-bottom: none; }\n        .checklist-item:before { content: \"☐\"; margin-right: 10px; font-size: 18px; color: #48bb78; }\n        .footer { background-color: #2d3748; color: #a0aec0; padding: 30px 20px; text-align: center; font-size: 14px; }\n        .footer a { color: #667eea; text-decoration: none; }\n        @media only screen and (max-width: 600px) {\n            .email-container { width: 100% !important; }\n            .content { padding: 20px 15px; }\n            .button { display: block; margin: 10px 0; }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"email-container\">\n        \n        <!-- Header that you can improve with your logo -->\n        <div class=\"header\">\n            <h1>🎧 Podcast: BBC 6 Minute English</h1>\n            <div class=\"episode-badge\">NEW EPISODE</div>\n        </div>\n        \n        <!-- Content of the email -->\n        <div class=\"content\">\n            \n            <!-- Title -->\n            <div class=\"section\">\n                <h2 style=\"color: #2d3748; font-size: 22px; margin: 0 0 10px 0;\">\n                    ${cleanTitle(episodeData.episode_title)}\n                </h2>\n                <p style=\"color: #718096; font-style: italic; margin: 0;\">\n                    ${episodeData.description}\n                </p>\n            </div>\n            \n            <!-- Hook Message -->\n            <div class=\"hook-message\">\n                ${hookMessage}\n            </div>\n            \n            <!-- Listen Button -->\n            <div class=\"button-container\">\n                <a href=\"${episodeData.download_links.audio}\" class=\"button\">\n                    🎵 Listen Now (6 min)\n                </a>\n            </div>\n            \n            <!-- Resources -->\n            <div class=\"section\">\n                <div class=\"section-title\">📚 Resources</div>\n                <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n                    <tr>\n                        <td width=\"33%\" align=\"center\" style=\"padding: 5px;\">\n                            <a href=\"${episodeData.download_links.audio}\" style=\"display: block; padding: 15px; background-color: #f7fafc; border-radius: 6px; text-decoration: none; color: #667eea; font-weight: 600; border: 2px solid #e2e8f0;\">\n                                <span style=\"font-size: 24px; display: block; margin-bottom: 5px;\">🎵</span>\n                                Audio\n                            </a>\n                        </td>\n                        <td width=\"33%\" align=\"center\" style=\"padding: 5px;\">\n                            <a href=\"${episodeData.download_links.pdf}\" style=\"display: block; padding: 15px; background-color: #f7fafc; border-radius: 6px; text-decoration: none; color: #667eea; font-weight: 600; border: 2px solid #e2e8f0;\">\n                                <span style=\"font-size: 24px; display: block; margin-bottom: 5px;\">📄</span>\n                                Transcript\n                            </a>\n                        </td>\n                        <td width=\"33%\" align=\"center\" style=\"padding: 5px;\">\n                            <a href=\"${episodeData.download_links.podcast}\" style=\"display: block; padding: 15px; background-color: #f7fafc; border-radius: 6px; text-decoration: none; color: #667eea; font-weight: 600; border: 2px solid #e2e8f0;\">\n                                <span style=\"font-size: 24px; display: block; margin-bottom: 5px;\">🎙️</span>\n                                More\n                            </a>\n                        </td>\n                    </tr>\n                </table>\n            </div>\n            \n            <!-- Block Vocabulary -->\n            <div class=\"section\">\n                <div class=\"section-title\">📖 Key Vocabulary (${episodeData.vocabulary_count} expressions)</div>\n                <ul class=\"vocab-list\">\n                    ${generateVocabHTML(episodeData.vocabulary_items)}\n                </ul>\n            </div>\n            \n            <!-- Block Practice -->\n            <div class=\"section\">\n                <div class=\"section-title\">✏️ Vocabulary Practice</div>\n                <p style=\"color: #4a5568; line-height: 1.6; margin-bottom: 15px;\">\n                    <strong>Fill in the blanks:</strong>\n                </p>\n                <ol style=\"color: #4a5568; line-height: 1.8; padding-left: 20px;\">\n                    ${generatePracticeHTML(practiceExercises)}\n                </ol>\n            </div>\n            \n            <!-- Block Discussion -->\n            <div class=\"section\">\n                <div class=\"section-title\">💬 Discussion Questions</div>\n                <ul class=\"discussion-list\">\n                    ${generateDiscussionHTML(discussionQuestions)}\n                </ul>\n            </div>\n            \n            <!-- Footer Message (Change it with your own infos) -->\n            <div style=\"text-align: center; padding: 30px 0; border-top: 2px solid #e2e8f0; margin-top: 30px;\">\n                <p style=\"font-size: 18px; color: #2d3748; margin: 0 0 10px 0; font-weight: 600;\">\n                    🚀 Ready to level up your English with n8n?\n                </p>\n                <p style=\"color: #718096; margin: 0;\">\n                    Copy this workflow and deploy it on your instance!\n                </p>\n            </div>\n        </div>\n        \n        <!-- Footer -->\n        <div class=\"footer\">\n            <p style=\"margin: 0 0 10px 0;\">\n                <strong style=\"color: #ffffff;\">LogiGreen Learning English Bot</strong>\n            </p>\n            <p style=\"margin: 0 0 15px 0;\">\n                Episode: ${episodeData.episode_code} | ${episodeData.processed_date}\n            </p>\n            <p style=\"margin: 0; font-size: 12px;\">\n                  <a href=\"https://github.com/samirsaci/\">My GitHub</a> | <a href=\"https://www.logi-green.com\">LogiGreen English Learning Bot</a>\n            </p>\n        </div>\n    </div>\n</body>\n</html>`;\n\n\nreturn {\n  json: {\n    html: htmlEmail,\n      subject: `🏫 English Learning Episode: ${cleanTitle(episodeData.episode_title)}`,\n    episode_id: episodeData.episode_id\n  }\n};"
        },
        "typeVersion": 2
      },
      {
        "id": "55a9a4eb-dcdd-450e-9ca3-767c537df012",
        "name": "Discussion Questions",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -128,
          -128
        ],
        "parameters": {
          "text": "=Create 5 engaging discussion questions based on this BBC 6 Minute English episode:\n\nEpisode: {{ $json.episode_title }}\nDescription: {{ $json.description }}\nTranscript excerpt: {{ $json.transcript }}...\n\nRequirements:\n1. Questions should encourage personal opinions and experiences\n2. Range from easier (personal reaction) to more complex (critical thinking)\n3. Make students want to TALK and share their views\n4. Connect to students' real lives when possible\n5. Use some of the target vocabulary naturally: {{ $json.vocabulary_items.map(v => v.word).join(', ') }}\n6. Keep language at B1-B2 level\n7. Avoid yes/no questions - ask WHY, HOW, WHAT IF\n\nFormat: Return ONLY the 5 questions, one per line, without numbering (I'll add numbers automatically).\n\nExample questions:\nWhat's your opinion on [topic]? Have you experienced something similar?\nIf you could [hypothetical], what would you do and why?\nHow do you think [topic] will change in the next 10 years?",
          "options": {
            "systemMessage": "=You are an experienced ESL teacher creating vocabulary practice exercises for intermediate learners."
          },
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "254e0003-2fe8-40ec-b679-b72a4fcaa229",
        "name": "Practice Exercises",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -128,
          -336
        ],
        "parameters": {
          "text": "=Create {{ $json.vocabulary_count }} fill-in-the-blank practice sentences using these vocabulary words from the BBC episode:\n\n{{ $json.vocabulary_items.map((v, i) => `${i+1}. ${v.word}: ${v.definition}`).join('\\n') }}\n\nRequirements:\n- Create ONE sentence for EACH vocabulary word\n- Sentences should be realistic and practical (situations students might encounter)\n- Leave a blank (use \"_______\") where the vocabulary word should go\n- Make sentences progressively slightly more challenging\n- Ensure context makes the answer clear\n- Use B1-B2 level English for the sentences\n- DO NOT number the sentences (I'll add numbers automatically)\n\nFormat: Return ONLY the sentences, one per line, with _______ for the blank.\n\nExample:\nWhen I saw the final exam results, my _______ in complete shock.\nThe researcher proposed a new _______ to explain the strange phenomenon.",
          "options": {
            "systemMessage": "=You are an experienced ESL teacher creating vocabulary practice exercises for intermediate learners."
          },
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "3c16dca9-a353-4eaf-ac15-adf1035c3b10",
        "name": "Email Hook",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -144,
          -576
        ],
        "parameters": {
          "text": "=Create a compelling 3-paragraph hook message to convince a student to listen to this BBC 6 Minute English podcast episode.\n\nEpisode: \"{{ $json.episode_title }}\"\nDescription: \"{{ $json.description }}\"\nVocabulary focus: {{ $json.vocabulary_items.map(v => v.word).join(', ') }}\n\nRequirements:\n1. Start with an intriguing question, surprising fact, or \"did you know\" statement related to the topic\n2. Explain what the student will learn in 6 minutes (keep emphasizing the short time commitment)\n3. Highlight the vocabulary they'll master\n4. End with an energetic call-to-action\n5. Use 2-3 emojis strategically (at the start of paragraphs)\n6. Keep language clear and encouraging (B1-B2 level)\n7. Make it feel personal and conversational, not robotic\n\nFormat: Return 3 paragraphs separated by <br><br> tags (for HTML email compatibility).\nDO NOT use markdown formatting.\nDO NOT use * for bold - use <strong> tags instead.\n\nExample style:\n\"🌍 <strong>Did you know</strong> that [fascinating fact]? [Build curiosity]\n\n<br><br>In just <strong>6 minutes</strong>, you'll [what they'll learn]. You'll master expressions like \"[vocab example]\" and \"[vocab example]\" while [exploring the topic].\n\n<br><br>Ready to [motivating challenge]? This episode is perfect for your [coffee break/commute/lunch] and you'll walk away with [specific benefit]! \n",
          "options": {
            "systemMessage": "=You are an enthusiastic English learning coach who writes engaging, motivational content for intermediate English learners (B1-B2 level)."
          },
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "3aa5ad68-cc82-43a1-9e3e-ba0141d38eb4",
        "name": "Send Email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          736,
          -448
        ],
        "webhookId": "f3def5a0-903e-4daa-9c65-618fdaf7ff2e",
        "parameters": {
          "sendTo": "<SET_UP_EMAIL_ADDRESS>",
          "message": "={{ $json.html }}",
          "options": {
            "attachmentsUi": {
              "attachmentsBinary": [
                {}
              ]
            },
            "appendAttribution": false
          },
          "subject": "={{ $('Combine Email + Attachment').item.json.subject }}"
        },
        "notesInFlow": true,
        "typeVersion": 2.1
      },
      {
        "id": "f99060da-9028-4621-93d5-74a02e82ed02",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          192,
          -672
        ],
        "parameters": {
          "color": 7,
          "width": 668,
          "height": 492,
          "content": "## 6. Build and send the HTML study email with vocabulary audio attached\n"
        },
        "typeVersion": 1
      },
      {
        "id": "5282c375-8369-4337-9211-e3fb95b03e0c",
        "name": "Trigger Sunday 20:00",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -1872,
          -448
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "weeks",
                "triggerAtHour": 20
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "409f2a0a-77f8-4749-b228-7a98a708093d",
        "name": "Podcasts from RSS Feed",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          -1568,
          -528
        ],
        "parameters": {
          "url": "https://feeds.bbci.co.uk/learningenglish/english/features/6-minute-english/rss",
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "41498f6a-253f-49f3-b48e-f63c90cb7cd7",
        "name": "Unique guid(s)",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          -1456,
          -352
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "renameField": true,
                "outputFieldName": "guids",
                "fieldToAggregate": "guid"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5d9ae5d4-bb6c-4161-be7e-be074899dc66",
        "name": "Combine with archived guid(s)",
        "type": "n8n-nodes-base.merge",
        "position": [
          -1232,
          -448
        ],
        "parameters": {
          "mode": "combineBySql",
          "options": {}
        },
        "notesInFlow": true,
        "typeVersion": 3.2
      },
      {
        "id": "67cf3c71-c7bb-4cac-a271-d260caad62a3",
        "name": "Filter out duplicates",
        "type": "n8n-nodes-base.filter",
        "position": [
          -1056,
          -448
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "3e4aeed5-c2db-4a6d-a410-c1d5614e8e35",
                "operator": {
                  "type": "boolean",
                  "operation": "false",
                  "singleValue": true
                },
                "leftValue": "={{ $json.guids.includes($json.guid) }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "38defa5a-2192-4902-8627-c8c2963b6f13",
        "name": "Extract Podcast Information",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -672,
          -448
        ],
        "parameters": {
          "url": "={{ $json.link }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "808623bd-8a99-42ee-abda-cce24219d4da",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2560,
          -672
        ],
        "parameters": {
          "width": 588,
          "height": 1052,
          "content": "## AI English Lesson Generator from Podcasts\n\n### How it works\n1. A trigger runs every Sunday at 20:00 and reads the BBC **6 Minute English** RSS feed  \n2. Previously sent episodes are looked up in the Data Table and filtered out using their `guid`  \n3. The workflow keeps the latest unsent episode and loads its web page content  \n4. A Code node parses the HTML to extract the **description**, full **transcript** and BBC **vocabulary list**  \n5. Three AI nodes generate: a hook message, fill-in-the-blank exercises and discussion questions based on the episode  \n6. The vocabulary words are combined and sent to **ElevenLabs** to generate a slow-paced audio track  \n7. All sections are merged into a single HTML email and sent via **Gmail**, with the vocabulary audio attached  \n\n### How to set up\n- [ ] Create a **Data Table** with the fields: `guid`, `title`, `link`, `processed_date`\n- [ ] Connect the Data Table to **Archived Podcasts**, **Unique guid(s)** and **Combine with archived guid(s)**  \n- [ ] Add your OpenAI credentials to the three **Model** nodes (hook, practice, discussion)  \n- [ ] Add your ElevenLabs credentials in **Generate Audio Transcript** and pick a voice  \n- [ ] Configure your Gmail credentials and destination address in **Send Email**  \n\n### Customisation\n1. Change the schedule time or frequency in the **Trigger Sunday 20:00** node  \n2. Edit the prompts in the AI nodes to change tone or difficulty level  \n3. Customise the HTML email template and footer in **Prepare Email** with your own branding  \n"
        },
        "typeVersion": 1
      },
      {
        "id": "0da1001c-7f9d-486f-9031-640d73946494",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1888,
          -144
        ],
        "parameters": {
          "width": 912,
          "height": 512,
          "content": "## [Check my Tutorial](https://www.youtube.com/watch?v=IKugAVZWgKM)\n@[youtube](IKugAVZWgKM)"
        },
        "typeVersion": 1
      },
      {
        "id": "a24815ac-c166-4ab6-9fc4-f4a54b78c4cc",
        "name": "Merge All Sections",
        "type": "n8n-nodes-base.merge",
        "position": [
          224,
          -464
        ],
        "parameters": {
          "numberInputs": 3
        },
        "notesInFlow": true,
        "typeVersion": 3.2
      },
      {
        "id": "8fd65fc0-3b47-49fa-87a9-3da8ed4c4887",
        "name": "Model: Email Hook",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -240,
          -464
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "maxTokens": 300,
            "temperature": 0.7
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ce0192e9-e823-47b1-823d-9e6fd0a4a6e6",
        "name": "Model: Practice Exercises",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -240,
          -224
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "maxTokens": 400,
            "temperature": 0.8
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a35107de-6616-435b-9cd7-0a7dbe4faba2",
        "name": "Model: Discussion Questions",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -240,
          -16
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "maxTokens": 400,
            "temperature": 0.9
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "66193edb-73e7-4b74-8fc5-752e3cdc39df",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -320,
          -672
        ],
        "parameters": {
          "color": 7,
          "width": 476,
          "height": 796,
          "content": "## 4. Generate hook and exercises from the episode content"
        },
        "typeVersion": 1
      },
      {
        "id": "04e9f287-47fd-43d9-bb2d-66ad1f403a19",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -864,
          -672
        ],
        "parameters": {
          "color": 7,
          "width": 476,
          "height": 492,
          "content": "## 3. Select latest unsent episode and fetch its page content"
        },
        "typeVersion": 1
      },
      {
        "id": "14c7029b-9f35-4c4d-9391-f2b04a7eb708",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1296,
          -672
        ],
        "parameters": {
          "color": 7,
          "width": 380,
          "height": 492,
          "content": "## 2. Filter out podcasts that have already been sent\n"
        },
        "typeVersion": 1
      },
      {
        "id": "2588028f-173d-4485-b282-c89bfab9778d",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1888,
          -672
        ],
        "parameters": {
          "color": 7,
          "width": 572,
          "height": 492,
          "content": "## 1. Weekly trigger to fetch RSS feed and load archived GUIDs\n"
        },
        "typeVersion": 1
      },
      {
        "id": "11cc185a-8b94-480d-a3a4-ad46effd03f0",
        "name": "Split Out Vocabulary",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -288,
          240
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "vocabulary_items"
        },
        "typeVersion": 1
      },
      {
        "id": "0760b50b-a72e-4cd3-97d6-faeff08363db",
        "name": "Combine Words",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          -128,
          240
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "renameField": true,
                "outputFieldName": "words",
                "fieldToAggregate": "word"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "adc5c199-ba25-416e-98a7-51b51c101298",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -320,
          144
        ],
        "parameters": {
          "color": 7,
          "width": 476,
          "height": 236,
          "content": "## 5. Generate vocabulary audio with ElevenLabs"
        },
        "typeVersion": 1
      },
      {
        "id": "b6af0e0a-dc3b-45a1-958e-05a0b1345d08",
        "name": "Generate Audio Transcript",
        "type": "@elevenlabs/n8n-nodes-elevenlabs.elevenLabs",
        "position": [
          48,
          240
        ],
        "parameters": {
          "text": "={{ $json.words.join(', ') }}",
          "voice": {
            "__rl": true,
            "mode": "list",
            "value": "5Q0t7uMcjvnagumLfvZi",
            "cachedResultName": "Paul"
          },
          "resource": "speech",
          "requestOptions": {},
          "additionalOptions": {
            "voiceSettings": "{\n  \"stability\": 1,\n  \"similarity_boost\": 1,\n  \"style\": 0,\n  \"use_speaker_boost\": true,\n  \"speed\": 0.8\n}"
          }
        },
        "notesInFlow": true,
        "typeVersion": 1
      },
      {
        "id": "e7e9310c-3fc1-4830-af84-2212e93adcac",
        "name": "Archived Podcasts",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          -1648,
          -352
        ],
        "parameters": {
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "",
            "cachedResultUrl": "",
            "cachedResultName": ""
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ccc7c946-0726-4e28-9945-5584290d1d27",
        "name": "Combine Email + Attachment",
        "type": "n8n-nodes-base.merge",
        "position": [
          576,
          -448
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "notesInFlow": true,
        "typeVersion": 3.2
      }
    ],
    "pinData": {},
    "connections": {
      "Email Hook": {
        "main": [
          [
            {
              "node": "Merge All Sections",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse HTML": {
        "main": [
          [
            {
              "node": "Email Hook",
              "type": "main",
              "index": 0
            },
            {
              "node": "Practice Exercises",
              "type": "main",
              "index": 0
            },
            {
              "node": "Discussion Questions",
              "type": "main",
              "index": 0
            },
            {
              "node": "Split Out Vocabulary",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Combine Words": {
        "main": [
          [
            {
              "node": "Generate Audio Transcript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Email": {
        "main": [
          [
            {
              "node": "Combine Email + Attachment",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Latest Episode": {
        "main": [
          [
            {
              "node": "Extract Podcast Information",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Unique guid(s)": {
        "main": [
          [
            {
              "node": "Combine with archived guid(s)",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Archived Podcasts": {
        "main": [
          [
            {
              "node": "Unique guid(s)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Model: Email Hook": {
        "ai_languageModel": [
          [
            {
              "node": "Email Hook",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Merge All Sections": {
        "main": [
          [
            {
              "node": "Prepare Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Practice Exercises": {
        "main": [
          [
            {
              "node": "Merge All Sections",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Discussion Questions": {
        "main": [
          [
            {
              "node": "Merge All Sections",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Split Out Vocabulary": {
        "main": [
          [
            {
              "node": "Combine Words",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger Sunday 20:00": {
        "main": [
          [
            {
              "node": "Podcasts from RSS Feed",
              "type": "main",
              "index": 0
            },
            {
              "node": "Archived Podcasts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter out duplicates": {
        "main": [
          [
            {
              "node": "Latest Episode",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Podcasts from RSS Feed": {
        "main": [
          [
            {
              "node": "Combine with archived guid(s)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Audio Transcript": {
        "main": [
          [
            {
              "node": "Combine Email + Attachment",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Model: Practice Exercises": {
        "ai_languageModel": [
          [
            {
              "node": "Practice Exercises",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Combine Email + Attachment": {
        "main": [
          [
            {
              "node": "Send Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Podcast Information": {
        "main": [
          [
            {
              "node": "Parse HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Model: Discussion Questions": {
        "ai_languageModel": [
          [
            {
              "node": "Discussion Questions",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Combine with archived guid(s)": {
        "main": [
          [
            {
              "node": "Filter out duplicates",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "OvYZQiWH2KlJsFbK",
    "meta": {
      "instanceId": "da13b80f35ed9d16adbf337111fadd798f3c80e989940f27089cab3947e57699",
      "templateCredsSetupCompleted": true
    },
    "name": "Multi-Agent Evaluation (eval nodes)",
    "tags": [
      {
        "id": "iNuMk76zLx33FnPf",
        "name": "multi-agent",
        "createdAt": "2025-06-18T23:08:04.545Z",
        "updatedAt": "2025-06-18T23:08:04.545Z"
      },
      {
        "id": "shqG88dQ5QVQIPJI",
        "name": "evaluation",
        "createdAt": "2025-06-16T20:21:56.654Z",
        "updatedAt": "2025-06-16T20:21:56.654Z"
      }
    ],
    "nodes": [
      {
        "id": "8e4721bf-8c21-4de3-ae92-97c627919e1b",
        "name": "Calculator",
        "type": "@n8n/n8n-nodes-langchain.toolCalculator",
        "position": [
          -420,
          160
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "4778f802-0d49-4e47-b153-6a721bec2214",
        "name": "Check if tool called",
        "type": "n8n-nodes-base.set",
        "position": [
          540,
          -160
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "f31d1137-3262-4d46-979a-e9fc3c24f670",
                "name": "tool_called",
                "type": "boolean",
                "value": "={{ \n  $('When fetching a dataset row').item.json.tools_to_call\n    .split(',').map(t => t.trim())\n    .every(tool => $json.intermediateSteps.some(step => step.action.tool.toLowerCase() === tool)) \n}}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "fdc479f2-b056-464d-842e-da7cc432cbf7",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -760,
          40
        ],
        "webhookId": "6fde470e-c42b-4a89-974d-c3d21ab0133b",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "26ef423b-591f-4a0b-8abc-fdb308c75d3e",
        "name": "Match chat format",
        "type": "n8n-nodes-base.set",
        "position": [
          -760,
          -160
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "3dec27ca-35df-47a7-9a53-d9b2d0b6c072",
                "name": "chatInput",
                "type": "string",
                "value": "={{ $json.question }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "1d0fbac1-fb62-4b10-82c7-98d9b2a473c9",
        "name": "Return chat response",
        "type": "n8n-nodes-base.noOp",
        "position": [
          536,
          40
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "758baf05-8830-4693-9f3a-a370d9fd4dc8",
        "name": "When fetching a dataset row",
        "type": "n8n-nodes-base.evaluationTrigger",
        "position": [
          -980,
          -160
        ],
        "parameters": {
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 969651976,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/18F1WIEq1ykZKBO1bWYhC0YxRb2ngTurfsZ7jO6sGhLY/edit#gid=969651976",
            "cachedResultName": "Tool calling"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "18F1WIEq1ykZKBO1bWYhC0YxRb2ngTurfsZ7jO6sGhLY",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/18F1WIEq1ykZKBO1bWYhC0YxRb2ngTurfsZ7jO6sGhLY/edit?usp=drivesdk",
            "cachedResultName": "n8n dataset for evaluation"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "jdlVpers9Sa8nBwV",
            "name": "Google Sheets account 4"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "33900d54-32e0-4883-9ce8-6565db389473",
        "name": "Evaluation",
        "type": "n8n-nodes-base.evaluation",
        "position": [
          980,
          -160
        ],
        "parameters": {
          "metrics": {
            "assignments": [
              {
                "id": "5855df91-5a74-44f9-b25b-23a111dbd7a1",
                "name": "tool_called",
                "type": "number",
                "value": "={{ $json.tool_called.toNumber() }}"
              }
            ]
          },
          "operation": "setMetrics"
        },
        "typeVersion": 4.6
      },
      {
        "id": "636b9b56-3ce3-4bc5-9dbd-42b77f2ce3a2",
        "name": "Evaluating?",
        "type": "n8n-nodes-base.evaluation",
        "position": [
          320,
          -60
        ],
        "parameters": {
          "operation": "checkIfEvaluating"
        },
        "typeVersion": 4.6
      },
      {
        "id": "174de2c6-787a-4d87-9d0f-a72bc7accc3a",
        "name": "Set Outputs",
        "type": "n8n-nodes-base.evaluation",
        "position": [
          760,
          -160
        ],
        "parameters": {
          "outputs": {
            "values": [
              {
                "outputName": "actual_tools_called",
                "outputValue": "={{ $('Evaluating?').item.json.intermediateSteps.map(step => step.action.tool.toLowerCase()).join(', ') }}\n"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 969651976,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/18F1WIEq1ykZKBO1bWYhC0YxRb2ngTurfsZ7jO6sGhLY/edit#gid=969651976",
            "cachedResultName": "Tool calling"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "18F1WIEq1ykZKBO1bWYhC0YxRb2ngTurfsZ7jO6sGhLY",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/18F1WIEq1ykZKBO1bWYhC0YxRb2ngTurfsZ7jO6sGhLY/edit?usp=drivesdk",
            "cachedResultName": "n8n dataset for evaluation"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "jdlVpers9Sa8nBwV",
            "name": "Google Sheets account 4"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "38559de2-b143-4806-bd14-15015cf1e947",
        "name": "Search Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -380,
          -60
        ],
        "parameters": {
          "options": {
            "systemMessage": "=You are a helpful assistant who will have access to a few tools to help with responding to user queries. I am providing some instructions below on how to use the tools. Please follow the instructions carefully.\n\nFirst, check the search_db tool to check whether the query exists. The tool expects a query string. If you use this tool and find relevant information, don't use the websearch tool.\n\nUse the web search tool to search the web for relevant information if you need to. You can ONLY call this tool once. \n\nUse the calculator for math operations or tasks. \n\nUse the summarizer tool to summarize the output. It's required to use this once you have gathered all the information you need.",
            "returnIntermediateSteps": true
          }
        },
        "typeVersion": 1.9
      },
      {
        "id": "c2800f49-b091-4327-96c6-2c45782c670e",
        "name": "Summarizer",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          -300,
          160
        ],
        "parameters": {
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "fehTbkLtPtlVwDYq",
            "cachedResultName": "Summarizer Agent"
          },
          "description": "Call this tool to summarize the outputs. ",
          "workflowInputs": {
            "value": {
              "query": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('query', ``, 'string') }}"
            },
            "schema": [
              {
                "id": "query",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "query",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "query"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "fb37524f-9c88-4684-9f46-f558025d5e80",
        "name": "Web search",
        "type": "n8n-nodes-base.httpRequestTool",
        "position": [
          -180,
          160
        ],
        "parameters": {
          "url": "https://api.firecrawl.dev/v1/search",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendHeaders": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "query",
                "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('parameters0_Value', ``, 'string') }}"
              },
              {
                "name": "limit",
                "value": "={{ \"3\".toNumber() }}"
              }
            ]
          },
          "genericAuthType": "httpBearerAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "content-type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "07GVEMqGJn2cdczi",
            "name": "Firecrawl Search"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "e15e9d58-dd8c-4288-b8fb-d8ef17df44a5",
        "name": "OpenRouter Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          -540,
          160
        ],
        "parameters": {
          "model": "openai/o3",
          "options": {}
        },
        "credentials": {
          "openRouterApi": {
            "id": "m9IRh1pT1eHIdKoX",
            "name": "OpenRouter account 2"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "68b1c2fa-49f9-41d2-8d57-dc89c972d43a",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          28,
          360
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "B67YxZwYEqGQkjNE",
            "name": "OpenAi account 2"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "090521fb-17f7-466f-8ae4-8f0d351f588a",
        "name": "Search_db",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
        "position": [
          -60,
          160
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {},
          "toolDescription": "Retrievel relevant results",
          "qdrantCollection": {
            "__rl": true,
            "mode": "list",
            "value": "search_queries",
            "cachedResultName": "search_queries"
          }
        },
        "credentials": {
          "qdrantApi": {
            "id": "6pyKp1GM03XYT1IV",
            "name": "QdrantApi account"
          }
        },
        "typeVersion": 1.3
      }
    ],
    "active": false,
    "pinData": {
      "When chat message received": [
        {
          "json": {
            "chatInput": "What’s the most recent funding round for Anthropic?"
          }
        },
        {
          "json": {
            "chatInput": "How much did OpenAI paid to acquire Windsurf? Take the results and multiply it by 1000."
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "4929985d-2b28-493e-901b-0a1c4a87fc12",
    "connections": {
      "Search_db": {
        "ai_tool": [
          [
            {
              "node": "Search Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Calculator": {
        "ai_tool": [
          [
            {
              "node": "Search Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Summarizer": {
        "ai_tool": [
          [
            {
              "node": "Search Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Web search": {
        "ai_tool": [
          [
            {
              "node": "Search Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Evaluating?": {
        "main": [
          [
            {
              "node": "Check if tool called",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Return chat response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Outputs": {
        "main": [
          [
            {
              "node": "Evaluation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search Agent": {
        "main": [
          [
            {
              "node": "Evaluating?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI": {
        "ai_embedding": [
          [
            {
              "node": "Search_db",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Match chat format": {
        "main": [
          [
            {
              "node": "Search Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check if tool called": {
        "main": [
          [
            {
              "node": "Set Outputs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Search Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Search Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When fetching a dataset row": {
        "main": [
          [
            {
              "node": "Match chat format",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "a144404b9eef9f0b32d0c43312a7a31a5b8a0e1f3be155816313521251b36cbc"
    },
    "nodes": [
      {
        "id": "3feeda27-6a9a-4a87-aca4-62dc7a1009dc",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -1180,
          340
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.7
      },
      {
        "id": "b9d70ef3-a74a-4588-9d16-95a51995644a",
        "name": "OpenAI",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          -780,
          580
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "options": {},
          "messages": {
            "values": [
              {}
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "cBDoeZ81f4rgsEu7",
            "name": "OpenAI"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "e633062d-eae5-4d67-a1b8-d3df5fc87cb3",
        "name": "Basic LLM Chain",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          -780,
          340
        ],
        "parameters": {},
        "typeVersion": 1.5
      },
      {
        "id": "4b69fa18-4018-4b1c-a4e3-43699c807fca",
        "name": "Information Extractor",
        "type": "@n8n/n8n-nodes-langchain.informationExtractor",
        "position": [
          -1180,
          580
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "c2aaf017-07d2-452c-ba18-cc747e3979d0",
        "name": "Question and Answer Chain",
        "type": "@n8n/n8n-nodes-langchain.chainRetrievalQa",
        "position": [
          -380,
          580
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.4
      },
      {
        "id": "274da45c-d0bd-48d7-9263-78afa308c78b",
        "name": "Sentiment Analysis",
        "type": "@n8n/n8n-nodes-langchain.sentimentAnalysis",
        "position": [
          -1180,
          800
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "03be1fae-4ba5-45a3-a19c-2bb3ee49c6e9",
        "name": "Summarization Chain",
        "type": "@n8n/n8n-nodes-langchain.chainSummarization",
        "position": [
          -780,
          800
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "f7cadacb-66bd-4fc7-8a5e-06c7fa8493cd",
        "name": "Text Classifier",
        "type": "@n8n/n8n-nodes-langchain.textClassifier",
        "position": [
          -380,
          800
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "835ac56c-1c33-4955-b097-59c15dc58731",
        "name": "Chat Memory Manager",
        "type": "@n8n/n8n-nodes-langchain.memoryManager",
        "position": [
          -380,
          340
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "b03c385e-b4b3-430b-a8d1-629ccc785726",
        "name": "Bitly App",
        "type": "n8n-nodes-base.bitly",
        "position": [
          3837,
          -1200
        ],
        "parameters": {
          "additionalFields": {}
        },
        "typeVersion": 1
      },
      {
        "id": "73276937-34bc-4943-87c3-1a6d57edac79",
        "name": "Dropbox App",
        "type": "n8n-nodes-base.dropbox",
        "position": [
          4277,
          -1200
        ],
        "parameters": {
          "operation": "download",
          "authentication": "oAuth2"
        },
        "credentials": {
          "dropboxOAuth2Api": {
            "id": "MS0Kqim8JzWcoeQT",
            "name": "Dropbox"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "6a1d1bd1-8c91-4bf2-acbf-c3fac836a3bd",
        "name": "Gmail App",
        "type": "n8n-nodes-base.gmail",
        "position": [
          3837,
          -980
        ],
        "webhookId": "221627ad-9bc1-4919-b105-6816f8cba493",
        "parameters": {
          "options": {}
        },
        "typeVersion": 2.1
      },
      {
        "id": "e0f92ee0-55b1-468f-9213-b8de41fb7e1c",
        "name": "Google Calendar App",
        "type": "n8n-nodes-base.googleCalendar",
        "position": [
          4277,
          -980
        ],
        "parameters": {
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "additionalFields": {}
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "2RZbxwB5fmEcf6c8",
            "name": "Google Calendar - IversusAI"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "abf825e0-8401-4e3b-ba3d-471e609706aa",
        "name": "Google Docs App",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          4497,
          -980
        ],
        "parameters": {
          "operation": "get"
        },
        "typeVersion": 2
      },
      {
        "id": "e1f1c422-e20c-43b1-8dc9-41fb960a15a5",
        "name": "Google Sheets App",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          3837,
          -760
        ],
        "parameters": {
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "dfwpyu0cnqopqMt7",
            "name": "Google Sheets - IversusAI"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "bbe5c37f-4c62-43fd-8348-f81ad5b6acbe",
        "name": "Pushbullet App",
        "type": "n8n-nodes-base.pushbullet",
        "position": [
          4497,
          -760
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "d9b3cea5-56c2-4441-b86c-0235ef1797d4",
        "name": "YouTube App",
        "type": "n8n-nodes-base.youTube",
        "position": [
          4500,
          -540
        ],
        "parameters": {
          "options": {},
          "resource": "playlist",
          "operation": "create"
        },
        "credentials": {},
        "typeVersion": 1
      },
      {
        "id": "4e551552-e81d-4e68-9dcb-129457c7eeee",
        "name": "Bluesky App",
        "type": "@muench-dev/n8n-nodes-bluesky.bluesky",
        "position": [
          4057,
          -1200
        ],
        "parameters": {},
        "typeVersion": 2
      },
      {
        "id": "c4072976-9564-455f-bd5a-d6a90247b967",
        "name": "Perplexity App",
        "type": "@watzon/n8n-nodes-perplexity.perplexity",
        "position": [
          4277,
          -760
        ],
        "parameters": {
          "additionalFields": {}
        },
        "typeVersion": 1
      },
      {
        "id": "371967ab-a033-401d-a193-4b1d16832cf1",
        "name": "ElevenLabs App",
        "type": "n8n-nodes-elevenlabs.elevenLabs",
        "position": [
          4497,
          -1200
        ],
        "parameters": {
          "voice_id": {
            "__rl": true,
            "mode": "list",
            "value": null
          },
          "requestOptions": {},
          "additionalFields": {}
        },
        "credentials": {
          "elevenLabsApi": {
            "id": "fYYTiIvdQpMpZJgy",
            "name": "ElevenLabs"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e058f764-64b2-4253-a097-e8da851ce709",
        "name": "Reddit App",
        "type": "n8n-nodes-base.reddit",
        "position": [
          3837,
          -540
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "623e73b1-6b53-43c4-b95c-ddc0dc67addd",
        "name": "Gmail Trigger App",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          4057,
          -980
        ],
        "parameters": {
          "filters": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "8cbfb5b3-3b42-4a57-8878-e6a13881f940",
        "name": "Google Sheets Trigger App",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          4057,
          -760
        ],
        "parameters": {
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "typeVersion": 1
      },
      {
        "id": "cea827e6-c499-494c-b8de-d85f7c6c520d",
        "name": "# Green",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3620,
          -1380
        ],
        "parameters": {
          "color": 4,
          "width": 1174,
          "height": 1074,
          "content": "# APP ACTIONS\n\n#### This section contains nodes for interacting with external apps and services like Google Sheets, Telegram, or Notion."
        },
        "typeVersion": 1
      },
      {
        "id": "151719d4-037d-4b20-acb6-c4c674337bc1",
        "name": "# Gray",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          80
        ],
        "parameters": {
          "color": 7,
          "width": 1174,
          "height": 1074,
          "content": "# AI TOOLS\n\n#### This section contains tools for use with AI Agents."
        },
        "typeVersion": 1
      },
      {
        "id": "8a61e929-aeaa-4af5-9a5a-2f69135c486a",
        "name": "Call n8n Workflow Tool",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          800,
          340
        ],
        "parameters": {},
        "typeVersion": 2
      },
      {
        "id": "3c4cfce6-e995-4a72-be43-aba8d751ba27",
        "name": "Code Tool",
        "type": "@n8n/n8n-nodes-langchain.toolCode",
        "position": [
          1020,
          340
        ],
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "b3c90dbc-f92a-4bbe-ae2c-837ad7fa5196",
        "name": "HTTP Request1",
        "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
        "position": [
          1240,
          540
        ],
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "2f382add-25cc-429d-9e7b-b84a4c632150",
        "name": "Calculator",
        "type": "@n8n/n8n-nodes-langchain.toolCalculator",
        "position": [
          600,
          340
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "583f6982-d6b3-4501-8341-da2b324f11f1",
        "name": "Postgres",
        "type": "n8n-nodes-base.postgresTool",
        "position": [
          800,
          740
        ],
        "parameters": {
          "table": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "schema": {
            "__rl": true,
            "mode": "list",
            "value": "public"
          }
        },
        "typeVersion": 2.5
      },
      {
        "id": "bd3e5ccf-f21e-425f-b863-4f4b86a550db",
        "name": "Redis",
        "type": "n8n-nodes-base.redisTool",
        "position": [
          1020,
          740
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "f26f5ed9-c782-4aca-affe-3cbf9eac4ae9",
        "name": "Send Email",
        "type": "n8n-nodes-base.emailSendTool",
        "position": [
          1240,
          740
        ],
        "webhookId": "aad16d99-06c6-4ff4-98dc-87e11eac6d10",
        "parameters": {
          "options": {}
        },
        "typeVersion": 2.1
      },
      {
        "id": "84f85cc4-6218-4c1b-b0d7-1103deeaa308",
        "name": "SerpAPI",
        "type": "@n8n/n8n-nodes-langchain.toolSerpApi",
        "position": [
          600,
          940
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "serpApi": {
            "id": "xonLZy0JUzY1IQ5E",
            "name": "SerpAPI"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "17ae5580-caff-43c4-93f5-c7c48a31ac30",
        "name": "Wikipedia",
        "type": "@n8n/n8n-nodes-langchain.toolWikipedia",
        "position": [
          800,
          940
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "5d9454dc-fcd4-4b72-830f-e54af6a2680f",
        "name": "Wolfram Alpha",
        "type": "@n8n/n8n-nodes-langchain.toolWolframAlpha",
        "position": [
          1020,
          940
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "90bb8301-75fa-477a-8cd1-11d8cb3398e1",
        "name": "gmailTool App",
        "type": "n8n-nodes-base.gmailTool",
        "position": [
          1240,
          340
        ],
        "webhookId": "287836d6-287e-4488-92a1-b0719a512008",
        "parameters": {
          "options": {}
        },
        "typeVersion": 2.1
      },
      {
        "id": "cc712ce4-bb83-4635-8701-27dc5274b2bf",
        "name": "googleCalendarTool App",
        "type": "n8n-nodes-base.googleCalendarTool",
        "position": [
          600,
          540
        ],
        "parameters": {
          "calendar": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "additionalFields": {}
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "2RZbxwB5fmEcf6c8",
            "name": "Google Calendar - IversusAI"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "92738fd9-c1ac-4dd2-a963-ced81df249cd",
        "name": "googleDocsTool App",
        "type": "n8n-nodes-base.googleDocsTool",
        "position": [
          800,
          540
        ],
        "parameters": {},
        "typeVersion": 2
      },
      {
        "id": "4f82cf51-aebe-4914-b1b0-b661a40533a9",
        "name": "googleSheetsTool App",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          1020,
          540
        ],
        "parameters": {
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "dfwpyu0cnqopqMt7",
            "name": "Google Sheets - IversusAI"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "ce6e07ea-4081-4832-ab5c-58d23638851c",
        "name": "# Purple",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2020,
          80
        ],
        "parameters": {
          "color": 6,
          "width": 1174,
          "height": 1074,
          "content": "# VECTOR MEMORY\n\n#### This section contains tools for AI Agents related to memory storage."
        },
        "typeVersion": 1
      },
      {
        "id": "0c82bae6-54af-45d9-b530-f865460193ce",
        "name": "Default Data Loader",
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "position": [
          2840,
          780
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "f3694575-a9cd-4800-b830-71c9505bcb19",
        "name": "Auto-fixing Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
        "position": [
          2500,
          780
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "bb6da0de-472c-43f5-9b93-c7211493ffbf",
        "name": "Answer questions with a vector store",
        "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
        "position": [
          2160,
          780
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "ac10ddbc-81d2-470e-8a19-740da3bbeed8",
        "name": "In-Memory Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
        "position": [
          2300,
          360
        ],
        "parameters": {
          "mode": "retrieve-as-tool"
        },
        "typeVersion": 1
      },
      {
        "id": "382cad17-dfc9-457f-9e68-27eb687ec233",
        "name": "Pinecone Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "position": [
          2680,
          360
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {},
          "pineconeIndex": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "typeVersion": 1
      },
      {
        "id": "1f4eee34-ebc5-4899-acb9-a140863eca88",
        "name": "Postgres PGVector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
        "position": [
          2300,
          560
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "44806f55-b717-4885-b750-37e1655dfc47",
        "name": "Supabase Vector Store",
        "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
        "position": [
          2680,
          560
        ],
        "parameters": {
          "mode": "retrieve-as-tool",
          "options": {},
          "tableName": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d5037d83-ea19-42ab-86e7-272c69a47342",
        "name": "Anthropic Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          3880,
          340
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "b148f82d-8343-4856-aab5-2811ee99a8c4",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          4140,
          340
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {},
        "typeVersion": 1
      },
      {
        "id": "27f45f90-7197-4e35-aedd-c158a7af55a7",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          4420,
          340
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cBDoeZ81f4rgsEu7",
            "name": "OpenAI"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "79af5566-476d-45df-9992-5d63050291f3",
        "name": "Window Buffer Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          4420,
          700
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "b6182791-6d01-40e9-9510-333dc6307cca",
        "name": "Postgres Chat Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
        "position": [
          3880,
          700
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "d0047650-53e9-4fe8-849d-83324abca9d3",
        "name": "Redis Chat Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryRedisChat",
        "position": [
          4140,
          700
        ],
        "parameters": {},
        "typeVersion": 1.4
      },
      {
        "id": "bd5fd081-2c33-4a9f-9b75-6b26304d3f90",
        "name": "Item List Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserItemList",
        "position": [
          4000,
          880
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "7f0087cb-9791-4339-baf9-5263f18a25ad",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          4300,
          880
        ],
        "parameters": {},
        "typeVersion": 1.2
      },
      {
        "id": "a6d3936b-ad3c-4864-bdf7-a3369d0f0ce2",
        "name": "Embeddings Google Gemini",
        "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
        "position": [
          4000,
          520
        ],
        "parameters": {},
        "credentials": {},
        "typeVersion": 1
      },
      {
        "id": "6439f8d0-86e3-449a-ac90-c0e057080975",
        "name": "Embeddings OpenAI",
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "position": [
          4300,
          520
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "cBDoeZ81f4rgsEu7",
            "name": "OpenAI"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "3ff47eb5-59b8-4f69-ba91-f07584f2fbc5",
        "name": "# Blue",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3620,
          80
        ],
        "parameters": {
          "color": 5,
          "width": 1174,
          "height": 1074,
          "content": "# MISCELLANEOUS AI TOOLS\n\n#### This section contains miscellaneous tools for AI Agents including models, embeddings, memory and parsers."
        },
        "typeVersion": 1
      },
      {
        "id": "ee5c44f7-a56d-4eb0-9f04-f7e35c56aa12",
        "name": "Sticky Note Red",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2040,
          1440
        ],
        "parameters": {
          "color": 3,
          "content": "# Red"
        },
        "typeVersion": 1
      },
      {
        "id": "83858128-51a4-4947-8e1f-1f0d8b002a94",
        "name": "Sticky Note Green",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1300,
          1720
        ],
        "parameters": {
          "color": 4,
          "content": "# Green"
        },
        "typeVersion": 1
      },
      {
        "id": "cc1311e0-b005-4460-b841-f1e5961abd80",
        "name": "Sticky Note Blue",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1660,
          1720
        ],
        "parameters": {
          "color": 5,
          "content": "# Blue"
        },
        "typeVersion": 1
      },
      {
        "id": "fc0b7463-305c-47dd-9d30-da4f3e8a1708",
        "name": "Sticky Note Purple",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2040,
          1720
        ],
        "parameters": {
          "color": 6,
          "content": "# Purple"
        },
        "typeVersion": 1
      },
      {
        "id": "0e7fed27-5c8b-4655-9c27-84ce94db7f5e",
        "name": "Sticky Note Gray",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1660,
          1980
        ],
        "parameters": {
          "color": 7,
          "content": "# Gray"
        },
        "typeVersion": 1
      },
      {
        "id": "a8992b45-7788-43d6-8060-1b115efe4879",
        "name": "Sticky Note Brown",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1660,
          1440
        ],
        "parameters": {
          "color": 2,
          "content": "# Brown"
        },
        "typeVersion": 1
      },
      {
        "id": "b866c03d-d46c-4832-b92f-0ea86599b81f",
        "name": "Sticky Note Yellow",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1300,
          1440
        ],
        "parameters": {
          "content": "# Yellow"
        },
        "typeVersion": 1
      },
      {
        "id": "2df946c3-336f-486c-8386-8ee7075f77a4",
        "name": "X",
        "type": "n8n-nodes-base.twitter",
        "position": [
          4280,
          -540
        ],
        "parameters": {
          "additionalFields": {}
        },
        "typeVersion": 2
      },
      {
        "id": "6b4bb993-28d0-4d37-9947-ed217f3d528f",
        "name": "Calendly Trigger",
        "type": "n8n-nodes-base.calendlyTrigger",
        "position": [
          -1080,
          -1200
        ],
        "webhookId": "0fcbe862-fa72-496c-8504-fe2fd903a70a",
        "parameters": {
          "events": [
            "invitee.created",
            "invitee.canceled"
          ]
        },
        "typeVersion": 1
      },
      {
        "id": "d8eaab32-12bd-45c4-ac00-300fdd898de6",
        "name": "Email Trigger (IMAP)",
        "type": "n8n-nodes-base.emailReadImap",
        "position": [
          -860,
          -1200
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "808bd54d-3bd1-4cb5-9317-96293e809323",
        "name": "Google Drive Trigger",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          -420,
          -1200
        ],
        "parameters": {
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "XlZKNfvws03EtUPV",
            "name": "Google Drive - IversusAI"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "0e152939-2353-4d13-85f9-9096785562a8",
        "name": "Gumroad Trigger",
        "type": "n8n-nodes-base.gumroadTrigger",
        "position": [
          -860,
          -980
        ],
        "webhookId": "0d650798-d9d7-439e-a266-b6205233afea",
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "c9ab2220-b03b-4788-a68e-f6b03f2e3098",
        "name": "Local File Trigger",
        "type": "n8n-nodes-base.localFileTrigger",
        "position": [
          -640,
          -980
        ],
        "parameters": {
          "options": {},
          "triggerOn": "folder"
        },
        "typeVersion": 1
      },
      {
        "id": "60144d8d-2e0f-49d9-ba7d-05b2363ddf74",
        "name": "On form submission",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          -420,
          -980
        ],
        "webhookId": "6b73f639-28a8-4282-8452-a8374036b263",
        "parameters": {
          "options": {},
          "formFields": {
            "values": [
              {}
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "fb224b15-5e25-4274-8bdd-ee1e1785d9f1",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -1080,
          -760
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "cdaac578-99db-46ae-8987-4ad35cfbc166",
        "name": "Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -860,
          -760
        ],
        "webhookId": "5d58aa36-a90f-4ec3-ab44-2006a370ae56",
        "parameters": {
          "path": "5d58aa36-a90f-4ec3-ab44-2006a370ae56",
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "4c82af95-1614-46a2-8f44-1a32a1ce6087",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -640,
          -760
        ],
        "webhookId": "58bd0a92-e352-402c-9070-0278ea9cb0ac",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "10e7394d-3bec-4cb7-8b86-d5f9c5942881",
        "name": "When clicking 'Test workflow'",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -420,
          -760
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "0d207099-c44e-4393-a02b-b4f97c8610cd",
        "name": "Workflow Input Trigger",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          -1080,
          -540
        ],
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "2c0910cc-dc9b-4c38-acd6-05315f373c3f",
        "name": "Gmail Trigger",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          -640,
          -1200
        ],
        "parameters": {
          "filters": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "909d7d34-8d08-4452-b8ab-641d1566b7d7",
        "name": "Google Sheets Trigger",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          -1080,
          -980
        ],
        "parameters": {
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          }
        },
        "typeVersion": 1
      },
      {
        "id": "fc7fe9cf-1b62-4b96-9a19-72b8510ad8e6",
        "name": "# Purple1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1300,
          -1380
        ],
        "parameters": {
          "color": 6,
          "width": 1274,
          "height": 1074,
          "content": "# TRIGGERS\n\n#### This section contains all trigger nodes that can start workflow execution."
        },
        "typeVersion": 1
      },
      {
        "id": "912f97da-0920-46a5-b37b-d5dc6cdfc4c4",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          780,
          -1200
        ],
        "parameters": {
          "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfor (const item of $input.all()) {\n  item.json.myNewField = 1;\n}\n\nreturn $input.all();"
        },
        "typeVersion": 2
      },
      {
        "id": "7b59ae12-f26a-4571-bad1-6e253a4456b0",
        "name": "Date & Time",
        "type": "n8n-nodes-base.dateTime",
        "position": [
          1220,
          -1200
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "e9110354-6b3f-40d4-a42c-2b5fa19cf9f0",
        "name": "Edit Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          560,
          -980
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "f5f4fd27-b7e2-49df-9ea3-9998119c07d3",
                "name": "Name Test",
                "type": "string",
                "value": "Value Test"
              },
              {
                "id": "d9658a2c-93a5-48c1-a170-9f8182d5a113",
                "name": "Name 1",
                "type": "number",
                "value": 1
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "458376a1-b116-4c4f-a01b-8fb5fd5337ad",
        "name": "Filter",
        "type": "n8n-nodes-base.filter",
        "position": [
          1000,
          -980
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "6a4cc4e4-a4a3-4d9e-a19f-c1189749e356",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "338520d1-b0f7-4463-88f2-59a9129cf3ad",
        "name": "Limit",
        "type": "n8n-nodes-base.limit",
        "position": [
          560,
          -760
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "e86e17ef-d46d-487a-aeaa-a62a57c28cea",
        "name": "Remove Duplicates",
        "type": "n8n-nodes-base.removeDuplicates",
        "position": [
          1220,
          -760
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "ed62f9ee-126b-40f4-b090-37837b9aae90",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1000,
          -540
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "9439328a-b787-49fe-829b-35efe6f6f94d",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          560,
          -1200
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {}
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "6ab55c99-bbe7-4608-b686-56e10cb03209",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          1000,
          -760
        ],
        "parameters": {},
        "typeVersion": 3
      },
      {
        "id": "59bba8e3-1867-4fe4-93b7-be9884a99eeb",
        "name": "Summarize",
        "type": "n8n-nodes-base.summarize",
        "position": [
          1220,
          -540
        ],
        "parameters": {
          "options": {},
          "fieldsToSummarize": {
            "values": [
              {}
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "1e0747d4-e2ca-4592-ac28-73651dd5973b",
        "name": "Convert to File",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          1000,
          -1200
        ],
        "parameters": {
          "options": {},
          "operation": "toText"
        },
        "typeVersion": 1.1
      },
      {
        "id": "586bcd83-db67-4d92-84ce-70f8126b3ef8",
        "name": "Extract from File",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          780,
          -980
        ],
        "parameters": {
          "options": {},
          "operation": "pdf"
        },
        "typeVersion": 1
      },
      {
        "id": "e51edfa8-7d70-4ee8-b6dc-a4f0f4c2d0ce",
        "name": "HTML",
        "type": "n8n-nodes-base.html",
        "position": [
          1220,
          -980
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "9c5a2f49-452b-4e73-b1dc-c4b043d87ec1",
        "name": "Markdown",
        "type": "n8n-nodes-base.markdown",
        "position": [
          780,
          -760
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "6269bc98-cc16-4608-8f63-125f348f25e6",
        "name": "Rename Keys",
        "type": "n8n-nodes-base.renameKeys",
        "position": [
          560,
          -540
        ],
        "parameters": {
          "additionalOptions": {}
        },
        "typeVersion": 1
      },
      {
        "id": "a25145c1-a269-43fc-8d51-03d45d340cb3",
        "name": "Sort",
        "type": "n8n-nodes-base.sort",
        "position": [
          780,
          -540
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "398302d7-97f8-4d88-a9e1-1d59f1e0522d",
        "name": "# Blue1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          -1380
        ],
        "parameters": {
          "color": 5,
          "width": 1174,
          "height": 1074,
          "content": "# DATA TRANSFORMATION\n\n#### This section contains nodes for manipulating, filtering, and converting data."
        },
        "typeVersion": 1
      },
      {
        "id": "6b2896d4-308c-4dc6-8851-275a791a5957",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          2440,
          -980
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "f9de618d-6acc-46a9-a7ec-61c748ce8c31",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "83eecf41-341e-428e-be4b-907d610214ea",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          2660,
          -980
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "e2623f85-fbbf-4c3e-b8a1-7393b5c10b10",
        "name": "Replace Me",
        "type": "n8n-nodes-base.noOp",
        "notes": "Placeholder node - replace with actual processing node",
        "position": [
          2880,
          -980
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "9a347885-e8b6-47c0-bcc6-9b5a9de31630",
        "name": "Execute Workflow",
        "type": "n8n-nodes-base.executeWorkflow",
        "position": [
          2440,
          -1200
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "535e56d1-dd6d-48b5-a83a-4237b98e6712",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          2440,
          -760
        ],
        "webhookId": "34bf5501-158c-43fb-b571-067c2dfaa5fc",
        "parameters": {
          "resume": "webhook",
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "24eb6d34-7812-4c25-9e52-b06a47e1d8fc",
        "name": "Execute Command",
        "type": "n8n-nodes-base.executeCommand",
        "position": [
          2220,
          -1200
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "fb3342d9-1a40-417a-bc30-641bdc858454",
        "name": "HTTP Request",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2220,
          -980
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "dd2c5db8-ad89-4e8b-a2ca-b2937d5bb504",
        "name": "Execution Data",
        "type": "n8n-nodes-base.executionData",
        "position": [
          2660,
          -1200
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "ed45b513-7fe5-4620-b190-8022ab3b0c27",
        "name": "FTP",
        "type": "n8n-nodes-base.ftp",
        "position": [
          2880,
          -1200
        ],
        "parameters": {
          "protocol": "sftp"
        },
        "typeVersion": 1
      },
      {
        "id": "f8d75e51-e391-4ee6-aeda-d4ee1b95535c",
        "name": "Respond to Webhook",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          2220,
          -760
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "b31e8cf2-ef95-4183-904a-e426460b6cf0",
        "name": "# Red",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2020,
          -1380
        ],
        "parameters": {
          "color": 3,
          "width": 1174,
          "height": 1074,
          "content": "# FLOW & CORE\n\n#### This section contains flow control nodes (branch, merge, or loop workflows) and core functionality nodes (run code, make HTTP requests, accept webhooks)."
        },
        "typeVersion": 1
      },
      {
        "id": "772785e7-e4e8-46bb-881a-f46535001357",
        "name": "RSS Read",
        "type": "n8n-nodes-base.rssFeedRead",
        "position": [
          4060,
          -540
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "2bacc070-b61f-413c-9a04-645165e4737e",
        "name": "# Red1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1280,
          80
        ],
        "parameters": {
          "color": 3,
          "width": 1274,
          "height": 1074,
          "content": "# AI AGENTS\n\n#### This section contains all AI related nodes that can attach models, tools and memory."
        },
        "typeVersion": 1
      },
      {
        "id": "c2b59df8-6327-464d-bb98-29c6df9e521a",
        "name": "AI Transform",
        "type": "n8n-nodes-base.aiTransform",
        "position": [
          -700,
          980
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "e9e27f3b-6f85-40d6-ba08-d14e75ee9ebc",
        "name": "MCP Client",
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "position": [
          600,
          740
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "9a7807d3-b789-4067-b549-eed5e297e524",
        "name": "Sticky Note Purple1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2720,
          -1380
        ],
        "parameters": {
          "color": 7,
          "width": 1020,
          "height": 1080,
          "content": "# WATCH THE n8n STARTER GUIDE 👇\n\n[![Click Here!](https://i.imgur.com/GpUl9iS.png)](https://www.youtube.com/watch?v=It3CkokmodE&list=PL1Ylp5hLJfWeL9ZJ0MQ2sK5y2wPYKfZdE&index=1&pp=gAQBiAQBsAQB)\n\n\n## THE NODE REFERENCE LIBRARY 📖\n\n## This **Node Reference Library** workflow is like a visual map showing many common n8n nodes, grouped by what they do (like Triggers, Data Transformation, AI Agents, etc.). Think of it as a quick visual cheat sheet! 🗺️\n\n## Explore the canvas to get familiar with different node types and see what's possible. ✨\n\n## This resource is provided by [@IversusAI](https://www.youtube.com/@IversusAI) on YouTube! 📺\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "OpenAI": {
        "main": [
          []
        ]
      },
      "AI Agent": {
        "main": [
          []
        ]
      },
      "Replace Me": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          []
        ]
      },
      "Basic LLM Chain": {
        "main": [
          []
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Replace Me",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Sentiment Analysis": {
        "main": [
          []
        ]
      },
      "Summarization Chain": {
        "main": [
          []
        ]
      },
      "Information Extractor": {
        "main": [
          []
        ]
      },
      "Question and Answer Chain": {
        "main": [
          []
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "6b3e8c6c30cdfbf06283a3fa57016932c6b4ec959896c5c546ef5865ff697ff1"
    },
    "nodes": [
      {
        "id": "2b167f16-af65-4d8f-9a83-3dff9c06f99c",
        "name": "Receive Company Request",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -624,
          1424
        ],
        "webhookId": "get-companies-uuid",
        "parameters": {
          "path": "/api/v1/get-companies",
          "options": {},
          "responseMode": "responseNode"
        },
        "typeVersion": 2.1
      },
      {
        "id": "b73f4dcc-6335-4458-a5d5-b6fa578dfed2",
        "name": "Prepare Dynamic Filter",
        "type": "n8n-nodes-base.function",
        "position": [
          -384,
          1424
        ],
        "parameters": {
          "functionCode": "// const query = $json[\"query\"] || {}\n// const filters = []\n// if (query.name) filters.push([\"name\", \"ilike\", query.name])\n// if (query.country) filters.push([\"country_code\", \"=\", query.country])\n// const limit = query.limit ? parseInt(query.limit) : 25\n// const response_format = query.response_format || 'json'\n// return [{ json: { filters, limit, response_format } }]\n\nconst query = $json[\"query\"] || {};\n\n// Validate required 'name' parameter\nif (!query.name || query.name.trim() === \"\") {\n  return [\n    {\n      json: {\n        success: false,\n        message: \"Missing required parameter: name\",\n      },\n    },\n  ];\n}\n\nconst filters = [];\nfilters.push([\"name\", \"ilike\", query.name]); // name is mandatory\n\nconst response_format = query.response_format || \"json\";\n\nreturn [\n  {\n    json: { filters, response_format },\n  },\n];"
        },
        "typeVersion": 1
      },
      {
        "id": "5676cb5c-2ddd-46fa-88d3-3902a183f227",
        "name": "Fetch Companies from Odoo",
        "type": "n8n-nodes-base.odoo",
        "position": [
          -128,
          1424
        ],
        "parameters": {
          "options": {
            "fieldsList": [
              "display_name",
              "name",
              "email",
              "phone",
              "mobile",
              "parent_id",
              "partner_id",
              "country_code",
              "country_id"
            ]
          },
          "resource": "custom",
          "operation": "getAll",
          "returnAll": true,
          "filterRequest": {
            "filter": [
              {
                "value": "={{ $json.filters[0][2] && $json.filters[0][2].toString().trim() !== '' ? $json.filters[0][2] : \"False\" }}",
                "operator": "like",
                "fieldName": "name"
              }
            ]
          },
          "customResource": "res.company"
        },
        "credentials": {
          "odooApi": {
            "id": "rhW7JbaWT0NTawBZ",
            "name": "IMM Odoo 18"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "288b5309-6f46-484f-9ab6-06e94bd7b74f",
        "name": "Prepare Output Data",
        "type": "n8n-nodes-base.function",
        "position": [
          176,
          1424
        ],
        "parameters": {
          "functionCode": "if (items.length === 0 || Object.keys(items[0].json).length === 0) {\n  return [{ json: { success: false, message: 'No matching company records found' } }]\n}\nconst data = items.map(item => ({ ...item.json, report_generated_on: new Date().toISOString() }))\nreturn data.map(d => ({ json: d }))"
        },
        "typeVersion": 1
      },
      {
        "id": "cd151c5b-55ec-454a-b43d-b78a39b74441",
        "name": "Check If Excel Required",
        "type": "n8n-nodes-base.if",
        "position": [
          480,
          1424
        ],
        "parameters": {
          "conditions": {
            "string": [
              {
                "value1": "={{ $('Prepare Dynamic Filter').item.json.response_format }}",
                "value2": "excel"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "6b9e1c86-81c3-475a-bdda-1a44bc9aed4e",
        "name": "Convert to Excel",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          1104,
          1376
        ],
        "parameters": {
          "options": {},
          "operation": "xlsx"
        },
        "typeVersion": 1.1
      },
      {
        "id": "38164711-9c8c-4f7c-8e3b-3f19b1c12360",
        "name": "Respond with File",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          1392,
          1376
        ],
        "parameters": {
          "options": {},
          "respondWith": "binary"
        },
        "typeVersion": 1.4
      },
      {
        "id": "cba096d5-0e19-4bec-930e-eefe587e996e",
        "name": "Respond with JSON",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          784,
          1776
        ],
        "parameters": {
          "options": {},
          "respondWith": "allIncomingItems"
        },
        "typeVersion": 1.4
      },
      {
        "id": "5f3f46b8-330a-4594-8170-6b2e8d68b685",
        "name": "Overview Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1600,
          592
        ],
        "parameters": {
          "width": 900,
          "height": 572,
          "content": "## How it works\nThis workflow provides an API endpoint `/api/v1/get-companies` that retrieves company records directly from your Odoo database. It’s built for teams who need to query or export company data — either as structured JSON for integrations or as Excel (.xlsx) for business reporting.\n\nWhen a request is made, the workflow:\n1. Accepts query parameters (`name`, `response_format`).\n2. Validates the name input (required for company search).\n3. Fetches all matching companies from Odoo using a partial `Like` filter.\n4. Returns results as a JSON response or Excel download depending on the `response_format` parameter.\n\nThis makes it ideal for quick data exports or syncing company information across systems.\n\n\n\n## Setup steps\n1. Open the Webhook node and note the endpoint `/api/v1/get-companies`.\n2. Connect your Odoo API credentials in the Odoo node.\n3. Optionally update the `fieldsList` in the Odoo node to include more company details (VAT, address, etc.).\n4. Test using a browser or Postman:  \n   - `/api/v1/get-companies?name=Tech&response_format=json`  \n   - `/api/v1/get-companies?name=Tech&response_format=excel`"
        },
        "typeVersion": 1
      },
      {
        "id": "c495e6f3-9186-41ec-8994-28ba95bde11b",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          784,
          1392
        ],
        "parameters": {
          "jsCode": "return $input.all()"
        },
        "typeVersion": 2
      },
      {
        "id": "d29068b1-e243-420b-b00c-24f9ecaa0512",
        "name": "Overview Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -688,
          1184
        ],
        "parameters": {
          "color": 7,
          "width": 452,
          "height": 428,
          "content": "## Request & Validation\nReceives the API request and checks for the required “name” parameter.\nReturns a validation message if missing."
        },
        "typeVersion": 1
      },
      {
        "id": "285429ca-c751-4970-85ce-27289180f9c8",
        "name": "Overview Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -208,
          1184
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 428,
          "content": "## Search Records from Odoo\n- Queries `res.company` \n**Company Table** records in Odoo using “Like” for partial matches.\n- Customize the fields in the node options if needed.\n- **Note: Name search is case-sensitive.**"
        },
        "typeVersion": 1
      },
      {
        "id": "5f9b217d-9cf1-4a7d-b99a-c6640d38399b",
        "name": "Overview Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          96,
          1184
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 428,
          "content": "## Prepare data and manage response json object."
        },
        "typeVersion": 1
      },
      {
        "id": "e7a97e7d-928b-4ec3-88c7-d6a2ecee9ea9",
        "name": "Overview Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          1184
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 428,
          "content": "## Check response_format\nIf response_format=excel → returns a downloadable Excel file.\nOtherwise, returns JSON with company data."
        },
        "typeVersion": 1
      },
      {
        "id": "2d754c32-7a53-4a43-a49e-8ccf8839f6f8",
        "name": "Overview Note14",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          704,
          1184
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 428,
          "content": "## Prepare Data for Binary file."
        },
        "typeVersion": 1
      },
      {
        "id": "0edb17ef-3bac-42fc-835d-d67e26ad82b0",
        "name": "Overview Note15",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1008,
          1184
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 428,
          "content": "## Create excel file"
        },
        "typeVersion": 1
      },
      {
        "id": "6ab323ca-5cc5-4d86-b32d-17f7340a4ab2",
        "name": "Overview Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1312,
          1184
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 428,
          "content": "## Response to web-hook with excel file."
        },
        "typeVersion": 1
      },
      {
        "id": "9d469fdf-7eaa-452f-874a-552299170c51",
        "name": "Overview Note17",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          704,
          1632
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 380,
          "content": "## Response to web-hook with json object."
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Code": {
        "main": [
          [
            {
              "node": "Convert to Excel",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to Excel": {
        "main": [
          [
            {
              "node": "Respond with File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Output Data": {
        "main": [
          [
            {
              "node": "Check If Excel Required",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Dynamic Filter": {
        "main": [
          [
            {
              "node": "Fetch Companies from Odoo",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check If Excel Required": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Respond with JSON",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Receive Company Request": {
        "main": [
          [
            {
              "node": "Prepare Dynamic Filter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Companies from Odoo": {
        "main": [
          [
            {
              "node": "Prepare Output Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "qgOiQsPSKD08eiB3",
    "meta": {
      "instanceId": "885b4fb4a6a9c2cb5621429a7b972df0d05bb724c20ac7dac7171b62f1c7ef40",
      "templateCredsSetupCompleted": true
    },
    "name": "Extract Structured Data from HackerNews, Export to Google Docs with Google Gemini",
    "tags": [
      {
        "id": "Kujft2FOjmOVQAmJ",
        "name": "Engineering",
        "createdAt": "2025-04-09T01:31:00.558Z",
        "updatedAt": "2025-04-09T01:31:00.558Z"
      },
      {
        "id": "ZOwtAMLepQaGW76t",
        "name": "Building Blocks",
        "createdAt": "2025-04-13T15:23:40.462Z",
        "updatedAt": "2025-04-13T15:23:40.462Z"
      },
      {
        "id": "ddPkw7Hg5dZhQu2w",
        "name": "AI",
        "createdAt": "2025-04-13T05:38:08.053Z",
        "updatedAt": "2025-04-13T05:38:08.053Z"
      }
    ],
    "nodes": [
      {
        "id": "2f6e390d-47d2-46c0-b032-00e1541a8def",
        "name": "When clicking ‘Execute workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -380,
          0
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "da17296e-a0b0-423f-8f6a-6636f77ff79e",
        "name": "Hacker News",
        "type": "n8n-nodes-base.hackerNews",
        "position": [
          60,
          0
        ],
        "parameters": {
          "limit": "={{ $json.Count }}",
          "resource": "all",
          "additionalFields": {}
        },
        "typeVersion": 1
      },
      {
        "id": "8481d533-2ef1-4e97-afe1-8f182d17b390",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          280,
          0
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "5d88db37-0e3b-4900-af10-78a4f7152231",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          940,
          240
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.0-flash-exp"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "YeO7dHZnuGBVQKVZ",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "0fcf5b56-87f8-4dca-9478-7f0753c195e7",
        "name": "Create a Google Doc",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          1320,
          20
        ],
        "parameters": {
          "title": "={{ $('Set the url, author').item.json.author }}-HackerNews",
          "folderId": "default"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "39XPsztp1DX0svZQ",
            "name": "Google Docs account"
          }
        },
        "executeOnce": false,
        "retryOnFail": true,
        "typeVersion": 2,
        "alwaysOutputData": false
      },
      {
        "id": "2855e7e7-ea99-4acc-901a-54bffa7b3113",
        "name": "Update Google Docs",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          1500,
          20
        ],
        "parameters": {
          "actionsUi": {
            "actionFields": [
              {
                "text": "={{ $('Extract Human Readable Data').item.json.text }}",
                "action": "insert"
              }
            ]
          },
          "operation": "update",
          "documentURL": "={{ $json.id }}"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "39XPsztp1DX0svZQ",
            "name": "Google Docs account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "ef59d4a1-4176-4702-996d-5a710b432b4b",
        "name": "Set the Input Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          -160,
          0
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "52ddafbb-536f-45d6-9697-7ddf5b9b3869",
                "name": "Count",
                "type": "string",
                "value": "5"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "aa74a371-94cf-4a0b-93d9-fd503f1abbed",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          200,
          -320
        ],
        "parameters": {
          "content": "## Step 1\n\nSet the input field with the \"Count\", how many record needs to be feteched."
        },
        "typeVersion": 1
      },
      {
        "id": "79674295-f331-4e5b-81d4-09d45aedb883",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          460,
          -320
        ],
        "parameters": {
          "content": "## Step 2\n\nSet the Google Gemini Credentials as part of the human readable data extraction"
        },
        "typeVersion": 1
      },
      {
        "id": "80ed14eb-6ead-46d8-81d0-5502cb5f44db",
        "name": "Extract Human Readable Data",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          980,
          20
        ],
        "parameters": {
          "text": "=Extract a human readable content. \n\nHere's the context :\n\n{{ $json.data }}",
          "batching": {},
          "promptType": "define"
        },
        "retryOnFail": true,
        "typeVersion": 1.7
      },
      {
        "id": "d922ad6e-0959-465f-810f-3f0e8d8a3626",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -360,
          -400
        ],
        "parameters": {
          "color": 6,
          "width": 540,
          "height": 240,
          "content": "## Extract Structured Data from Hacker News, Export to Google Docs with Google Gemini\n\nHacker news data extraction with Google Gemini. Export the clean data to Google Document."
        },
        "typeVersion": 1
      },
      {
        "id": "79f3eca6-df7d-4e72-816e-b17452f476b5",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          720,
          -320
        ],
        "parameters": {
          "content": "## Step 3\n\nSet the Google Document Credentials for the Hacker News data export"
        },
        "typeVersion": 1
      },
      {
        "id": "b3cfee88-735c-4474-b7c0-75511d44e26c",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          200,
          -140
        ],
        "parameters": {
          "color": 5,
          "width": 1060,
          "height": 520,
          "content": "## Hacker News Data Extraction"
        },
        "typeVersion": 1
      },
      {
        "id": "36302c89-82a4-4098-9ca6-7822bb4d6c33",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -360,
          -140
        ],
        "parameters": {
          "color": 3,
          "width": 540,
          "height": 120,
          "content": "## LLM Usages\n\nGoogle Gemini -> Gemini 2.0 Flash Exp Model"
        },
        "typeVersion": 1
      },
      {
        "id": "80c3a993-6c82-43c9-9612-e20e989012ef",
        "name": "Set the url, author",
        "type": "n8n-nodes-base.set",
        "position": [
          500,
          20
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "267f21f5-d483-4e74-9773-b1d8a02dd984",
                "name": "author",
                "type": "string",
                "value": "={{ $json.author }}"
              },
              {
                "id": "667a3ffb-a07c-4f66-b253-a7c64b2aa8e0",
                "name": "url",
                "type": "string",
                "value": "={{ $json._highlightResult.url.value }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "ad6eb942-17a1-48af-9d41-f728c9127106",
        "name": "Create an HTTP Request",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          720,
          20
        ],
        "parameters": {
          "url": "={{ $json.url }}",
          "options": {}
        },
        "retryOnFail": true,
        "typeVersion": 4.2,
        "alwaysOutputData": true
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "640bfa35-72c3-4d4d-8e38-a98fee2248e9",
    "connections": {
      "Hacker News": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Set the url, author",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Google Docs": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create a Google Doc": {
        "main": [
          [
            {
              "node": "Update Google Docs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set the url, author": {
        "main": [
          [
            {
              "node": "Create an HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set the Input Fields": {
        "main": [
          [
            {
              "node": "Hacker News",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create an HTTP Request": {
        "main": [
          [
            {
              "node": "Extract Human Readable Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Extract Human Readable Data",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Extract Human Readable Data": {
        "main": [
          [
            {
              "node": "Create a Google Doc",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Execute workflow’": {
        "main": [
          [
            {
              "node": "Set the Input Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "B01FguFGfZeVurIi",
    "meta": {
      "instanceId": "6f81894254c2852bfe28b07fc1f6652b03481706dd714d6609cc88e8521956d2",
      "templateCredsSetupCompleted": true
    },
    "name": "Olostep Amazon scraper",
    "tags": [
      {
        "id": "DLTmSowiHFKnMssa",
        "name": "Work",
        "createdAt": "2025-10-23T05:10:39.770Z",
        "updatedAt": "2025-10-23T05:10:39.770Z"
      }
    ],
    "nodes": [
      {
        "id": "2d3bc36e-a7fe-49a5-95e4-591edcfa2fbf",
        "name": "scrape amazon products",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          -608,
          496
        ],
        "parameters": {
          "url": "https://api.olostep.com/v1/scrapes",
          "method": "POST",
          "options": {
            "allowUnauthorizedCerts": true
          },
          "jsonBody": "={\n  \"url_to_scrape\": \"https://www.amazon.com/s?k={{ $('On form submission').item.json['search query'] }}&page={{ $json.counter }}\",\n  \"formats\": [\n    \"json\"\n  ],\n  \"wait_before_scraping\": 6000,\n  \"remove_css_selectors\": \"default\",\n  \"llm_extract\": {\n    \"schema\": {\n      \"type\": \"array\",\n      \"description\": \"A list of products listed on Amazon.\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"title\": {\n            \"type\": \"string\",\n            \"description\": \"The title of the product.\"\n          },\n          \"url\": {\n            \"type\": \"string\",\n            \"description\": \"The full url for the product.\"\n          }\n        },\n        \"required\": [\n          \"title\",\n          \"url\"\n        ]\n      }\n    }\n  },\n  \"screen_size\": {\n    \"screen_type\": \"desktop\",\n    \"screen_width\": 1920,\n    \"screen_height\": 1080\n  }\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer <token>"
              }
            ]
          }
        },
        "retryOnFail": false,
        "typeVersion": 4.2
      },
      {
        "id": "677f2c1e-f3a6-44dd-8a2b-b82b6012aa69",
        "name": "parsedInfo",
        "type": "n8n-nodes-base.set",
        "position": [
          -432,
          496
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "21d26317-c9bc-4a56-a3ca-962254a23329",
                "name": "parsedJson",
                "type": "array",
                "value": "={{ $json.result.json_content.replace(/\\\\/g, '') }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "e17f4dda-9920-48b0-b96f-ed698cbf5c8c",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -224,
          496
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "parsedJson"
        },
        "typeVersion": 1
      },
      {
        "id": "e36e8a82-df64-492f-ad01-064e8e91bc5b",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -832,
          480
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "3a5b06c3-81b4-4719-a5de-988e5949252b",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          -16,
          496
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "62b69c0a-ad68-4fbd-8ecd-9f3b50f5ca2d",
                "operator": {
                  "type": "string",
                  "operation": "notStartsWith"
                },
                "leftValue": "={{ $json.url }}",
                "rightValue": "https://www.amazon.com"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "8167a2bf-5e6d-4616-808d-32fa51f62202",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          576,
          512
        ],
        "webhookId": "ede90236-0935-4406-bba0-a02cd28e7c03",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "224ae802-2110-4e97-9fcb-83c7ec29d4d2",
        "name": "Insert row",
        "type": "n8n-nodes-base.dataTable",
        "position": [
          368,
          512
        ],
        "parameters": {
          "columns": {
            "value": {
              "url": "={{ $json.url }}",
              "title": "={{ $json.title }}"
            },
            "schema": [
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "title",
                "defaultMatch": false
              },
              {
                "id": "url",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": false,
                "required": false,
                "displayName": "url",
                "defaultMatch": false
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "dataTableId": {
            "__rl": true,
            "mode": "list",
            "value": "hCFSIc5S243rctOO",
            "cachedResultUrl": "/projects/V9LxWBdY4sxeqAOs/datatables/hCFSIc5S243rctOO",
            "cachedResultName": "amazon products"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "f4792914-40f3-44bc-95ff-87f352fa00b0",
        "name": "On form submission",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          -1424,
          480
        ],
        "webhookId": "3d10fbd7-747f-4f49-9467-8a77a0adac0c",
        "parameters": {
          "options": {},
          "formTitle": "Olostep Amazon Products Scraper",
          "formFields": {
            "values": [
              {
                "fieldLabel": "search query",
                "placeholder": "wireless bluetooth headphones"
              }
            ]
          },
          "formDescription": "please fill all fields"
        },
        "typeVersion": 2.3
      },
      {
        "id": "d0d689c4-39f9-495e-9803-f6978d578a1e",
        "name": "Edit Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          -1248,
          480
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "9cb88c80-de98-43d5-af5a-d3b9897ebe9b",
                "name": "counter",
                "type": "array",
                "value": "[1,2,3,4,5,6,7,8,9,10]"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "6956396a-acf8-4dd7-8ee0-3564151c1fa3",
        "name": "Split Out2",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          -1040,
          480
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "counter"
        },
        "typeVersion": 1
      },
      {
        "id": "34a55dec-685b-44ad-b761-9b3030954567",
        "name": "Edit Fields1",
        "type": "n8n-nodes-base.set",
        "position": [
          176,
          368
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "dde443ff-9f08-459a-a3a2-6301cba3c9b8",
                "name": "url",
                "type": "string",
                "value": "=https://www.amazon.com{{ $json.url }}"
              },
              {
                "id": "d895888d-ac1d-4a4e-90d6-97e2d0fbc7ed",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "45623202-f500-4dbf-93f8-c3a5401a48ed",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1264,
          384
        ],
        "parameters": {
          "color": 7,
          "width": 352,
          "height": 256,
          "content": "## Pagination  \nIterates through multiple Amazon pages (1–10).\n"
        },
        "typeVersion": 1
      },
      {
        "id": "119dbd07-ce62-4c2c-a429-b8755d7cf2d0",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -896,
          352
        ],
        "parameters": {
          "color": 7,
          "width": 416,
          "height": 368,
          "content": "## Olostep Amazon Scrape  \nExtracts product title + URL."
        },
        "typeVersion": 1
      },
      {
        "id": "b64a15cf-4adf-4d4a-853f-01aa142cc420",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -464,
          352
        ],
        "parameters": {
          "color": 7,
          "width": 784,
          "height": 368,
          "content": "## Parse & Split  \nConverts JSON output into individual products."
        },
        "typeVersion": 1
      },
      {
        "id": "648d3650-2c1d-42f6-9781-a32a8f43b4ad",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          336,
          352
        ],
        "parameters": {
          "color": 7,
          "width": 384,
          "height": 368,
          "content": "## Insert Row  \nSaves each product to a Google Sheet / Data Table.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "422c00b9-25d5-488c-b931-43ccadde67ba",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2096,
          64
        ],
        "parameters": {
          "width": 608,
          "height": 1152,
          "content": "# Olostep Amazon Products Scraper  \n\nThis n8n template automates Amazon product scraping using the Olostep API.  \nSimply enter a **search query**, and the workflow scrapes multiple Amazon search pages to extract product titles and URLs.  \nResults are cleaned, normalized, and saved into a Google Sheet or Data Table.\n\n## How it works / What it does  \n1. **Form Trigger**  \n   - User enters a search query (e.g., “wireless bluetooth headphones”).  \n   - The query is used to build the Amazon search URL.\n\n2. **Pagination Setup**  \n   - A list of page numbers (1–10) is generated automatically.  \n   - Each number loads the corresponding Amazon search results page.\n\n3. **Scrape Amazon with Olostep**  \n   - For each page, Olostep scrapes Amazon search results.  \n   - Olostep’s LLM extraction returns:  \n     - **title** — product title  \n     - **url** — product link  \n\n4. **Parse & Split Results**  \n   - The JSON output is decoded and turned into individual product items.\n\n5. **URL Normalization**  \n   - If the product URL is relative, it is automatically converted into a full Amazon URL.\n\n6. **Conditional Check (IF node)**  \n   - Ensures only valid product URLs are stored.  \n   - Helps avoid scraping Amazon navigation links or invalid items.\n\n7. **Insert into Sheet / Data Table**  \n   - Each valid product is saved in:  \n     - title  \n     - url  \n\n8. **Automatic Looping & Rate Management**  \n   - A wait step ensures API rate limits are respected while scraping multiple pages.\n\nThis workflow gives you a complete, reliable Amazon scraper with no browser automation and no manual copy/paste — everything runs through the Olostep API and n8n.\n\n## How to set up  \n1. Import this template into your n8n account.  \n2. Add your **Olostep API key**.  \n3. Connect your **Google Sheets** or **Data Table**.  \n4. Deploy the form and start scraping with any Amazon search phrase."
        },
        "typeVersion": 1
      },
      {
        "id": "f7aa6ef0-6c75-4b39-9ec1-c18a029d8047",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1472,
          352
        ],
        "parameters": {
          "color": 7,
          "width": 192,
          "height": 272,
          "content": "## Enter a search query  \nExample: “wireless bluetooth headphones”."
        },
        "typeVersion": 1
      },
      {
        "id": "1f000c8d-fe6a-41ed-948c-83dac32c66c4",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -864,
          736
        ],
        "parameters": {
          "color": 3,
          "width": 384,
          "height": 128,
          "content": "## WARNING\nIf the http request runs through a 504 gateway timeout error try to execute again or set the node settings to retry on failure."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "fb5d0313-434f-465d-b4b5-1b6b0b03df7a",
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Insert row",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Insert row": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out2": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "parsedInfo": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Split Out2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields1": {
        "main": [
          [
            {
              "node": "Insert row",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "scrape amazon products",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "On form submission": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "scrape amazon products": {
        "main": [
          [
            {
              "node": "parsedInfo",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "puzC1akjHG3456ue",
    "meta": {
      "instanceId": "28a947b92b197fc2524eaba16e57560338657b2b0b5796300b2f1cedc1d0d355",
      "templateCredsSetupCompleted": true
    },
    "name": "Trump-o-meter Template",
    "tags": [],
    "nodes": [
      {
        "id": "238f0e0a-71ca-4434-b481-da683df58312",
        "name": "When clicking ‘Execute workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -440,
          -380
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "e8c37340-3fb4-4f4c-841e-7eade92e3c75",
        "name": "Filter",
        "type": "n8n-nodes-base.filter",
        "position": [
          660,
          -380
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "409837cd-d016-4473-9c6d-84f8c7483fb0",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.post_text }}",
                "rightValue": "None"
              },
              {
                "id": "08272483-deba-4d06-a66c-c50cfabb710f",
                "operator": {
                  "type": "string",
                  "operation": "notEquals"
                },
                "leftValue": "={{ $json.stock_market_impact.magnitude }}",
                "rightValue": "None"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "aa96b4a4-b93c-4e01-82f7-672d853b41f0",
        "name": "Slack",
        "type": "n8n-nodes-base.slack",
        "position": [
          880,
          -380
        ],
        "webhookId": "d2351a3b-b7a9-44d6-ba2a-8b0444773945",
        "parameters": {
          "text": "={{ $json.post_text }}\n\nPotential impact on the stock market: {{ $json.stock_market_impact.magnitude }}, {{ $json.stock_market_impact.direction }}",
          "select": "channel",
          "channelId": {
            "__rl": true,
            "mode": "list",
            "value": "C08E83RDJN9",
            "cachedResultName": "n8n-debug"
          },
          "otherOptions": {},
          "authentication": "oAuth2"
        },
        "credentials": {
          "slackOAuth2Api": {
            "id": "SDxCef2uzWkOV8Q2",
            "name": "Slack account 3"
          }
        },
        "typeVersion": 2.3
      },
      {
        "id": "2752a716-65ad-45cc-a373-fa001713b172",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          440,
          -380
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "output.posts"
        },
        "typeVersion": 1
      },
      {
        "id": "5a8967f1-8dd7-411f-9c1e-e5846b204b3b",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1540,
          -720
        ],
        "parameters": {
          "color": 5,
          "width": 1040,
          "height": 1300,
          "content": "README\n\n# Trump-o-meter: Extracting and Evaluating Truth Social Posts\n\n## Use Case\n\nAutomatically extracting posts from Donald Trump's Truth Social account and estimating their potential impact on the U.S. stock market enables teams to monitor high-profile communications that may influence financial markets. This automation streamlines intelligence gathering for analysts, traders, and policy observers.\n\n## What This Automation Does\n\nThis automation retrieves up to 3 posts from Donald Trump's Truth Social profile and outputs structured information including:\n\n* Author name\n* Image URL\n* Post text\n* Post URL\n* Estimated stock market impact:\n\n  * Direction: positive, negative, or neutral\n  * Magnitude: None, Small, Medium, Large\n\n## How It Works\n\n1. Creates a browser session on Truth Social using an Airtop profile.\n2. Navigates to `https://truthsocial.com/@realDonaldTrump`.\n3. Uses a natural language prompt with a defined JSON schema to extract structured data for up to 3 posts.\n4. Splits the results into individual post items.\n5. Filters posts that contain actual content and have a non-zero estimated market impact.\n6. Sends selected posts and impact summaries to a Slack channel.\n7. Terminates the browser session to clean up.\n\n## Setup Requirements\n\n1. [Airtop API Key](https://portal.airtop.ai/api-keys) — free to generate.\n2. An [Airtop Profile](https://portal.airtop.ai/browser-profiles) that is connected and logged into Truth Social.\n3. A Slack workspace and authorized app with write permissions to a target channel.\n\n## Next Steps\n\n* **Integrate with Trading Signals**: Link output to financial alert systems or dashboards for timely insights.\n* **Expand Monitoring**: Extend to other high-impact accounts (e.g., politicians, CEOs).\n* **Enhance Analysis**: Add sentiment scoring or topic classification for deeper context.\n\n## Legal Disclaimer\nThis tool is intended solely for informational and analytical purposes. The market impact estimations provided are speculative and should not be construed as financial advice. **Do not make investment decisions based on this automation.** Always consult with a licensed financial advisor before making any trades.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "84cd624a-39f0-4318-8277-5b708814057b",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -440,
          -180
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "weeks"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "39dd927f-d163-4d55-896b-73051714c9d0",
        "name": "Extract and Analyze Posts",
        "type": "n8n-nodes-base.airtop",
        "position": [
          220,
          -280
        ],
        "parameters": {
          "prompt": "This is Truth Social. \nExtract up to 6 posts from @realDonaldTrump. \nFor each post, extract the name of the author, the image URL, the text and the URL.\n\nAlso try to estimate the potential impact of each post on the public stock market in the US:\nDirection - positive, negative, or neutral\nMagnitude - None, Small, Medium or Large",
          "resource": "extraction",
          "additionalFields": {
            "outputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"posts\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"author_name\": {\n            \"type\": \"string\",\n            \"description\": \"The name of the author of the post.\"\n          },\n          \"image_url\": {\n            \"type\": \"string\",\n            \"description\": \"The URL of the image associated with the post.\"\n          },\n          \"post_text\": {\n            \"type\": \"string\",\n            \"description\": \"The text content of the post.\"\n          },\n          \"post_url\": {\n            \"type\": \"string\",\n            \"description\": \"The URL of the post.\"\n          },\n          \"stock_market_impact\": {\n            \"type\": \"object\",\n            \"properties\": {\n              \"direction\": {\n                \"type\": \"string\",\n                \"description\": \"The estimated direction of the post's impact on the US stock market.\"\n              },\n              \"magnitude\": {\n                \"type\": \"string\",\n                \"description\": \"The estimated magnitude of the post's impact on the US stock market.\"\n              }\n            },\n            \"required\": [\n              \"direction\",\n              \"magnitude\"\n            ],\n            \"additionalProperties\": false\n          }\n        },\n        \"required\": [\n          \"author_name\",\n          \"image_url\",\n          \"post_text\",\n          \"post_url\",\n          \"stock_market_impact\"\n        ],\n        \"additionalProperties\": false\n      }\n    }\n  },\n  \"required\": [\n    \"posts\"\n  ],\n  \"additionalProperties\": false,\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\"\n}",
            "parseJsonOutput": true
          }
        },
        "credentials": {
          "airtopApi": {
            "id": "Yi4YPNnovLVUjFn5",
            "name": "Airtop Official Org"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "a2055437-8c3b-4104-a1c1-dc3ee59044b4",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -260,
          -420
        ],
        "parameters": {
          "width": 200,
          "height": 320,
          "content": "## Enter Airtop Profile name here"
        },
        "typeVersion": 1
      },
      {
        "id": "3da92d0a-c837-4625-8b56-669dd79b88ba",
        "name": "Create Airtop Session",
        "type": "n8n-nodes-base.airtop",
        "position": [
          -220,
          -280
        ],
        "parameters": {
          "proxy": "integrated",
          "profileName": "ENTER AIRTOP PROFILE NAME",
          "proxyConfig": {
            "sticky": true,
            "country": "US"
          },
          "additionalFields": {}
        },
        "credentials": {
          "airtopApi": {
            "id": "Yi4YPNnovLVUjFn5",
            "name": "Airtop Official Org"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "03bca384-9f71-449f-9662-415b7582bfa8",
        "name": "Create Airtop Browser",
        "type": "n8n-nodes-base.airtop",
        "position": [
          0,
          -280
        ],
        "parameters": {
          "url": "https://truthsocial.com/@realDonaldTrump",
          "resource": "window",
          "additionalFields": {
            "waitUntil": "load"
          }
        },
        "credentials": {
          "airtopApi": {
            "id": "Yi4YPNnovLVUjFn5",
            "name": "Airtop Official Org"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "44dcc003-1804-45df-bf62-d819b58026d3",
        "name": "Terminate Airtop Session",
        "type": "n8n-nodes-base.airtop",
        "position": [
          440,
          -180
        ],
        "parameters": {
          "operation": "terminate",
          "sessionId": "={{ $('Create Airtop Session').item.json.sessionId }}"
        },
        "credentials": {
          "airtopApi": {
            "id": "Yi4YPNnovLVUjFn5",
            "name": "Airtop Official Org"
          }
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "991b1f4e-1f4a-4b40-b63e-6151cbccad90",
    "connections": {
      "Slack": {
        "main": [
          []
        ]
      },
      "Filter": {
        "main": [
          [
            {
              "node": "Slack",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Filter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Create Airtop Session",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Airtop Browser": {
        "main": [
          [
            {
              "node": "Extract and Analyze Posts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Airtop Session": {
        "main": [
          [
            {
              "node": "Create Airtop Browser",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract and Analyze Posts": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            },
            {
              "node": "Terminate Airtop Session",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Execute workflow’": {
        "main": [
          [
            {
              "node": "Create Airtop Session",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "Xs7x61YMFsbpB4vg",
    "meta": {
      "instanceId": "51270372ea87f40bc06437a6d111ae29e684e524a2e6c52d7a6f84dde18d4a17",
      "templateCredsSetupCompleted": true
    },
    "name": "Colombian Invoices Processing",
    "tags": [],
    "nodes": [
      {
        "id": "3bcb9b75-a697-4948-974a-f4ea29947bfa",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          880,
          445
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "03076b82-d824-4fe1-b659-7fbfa2f3fd87",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          2420,
          790
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "BfhecJBx32L0a2gT",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "201ae476-d189-4ba7-9a96-6f272b95795d",
        "name": "Calculator",
        "type": "@n8n/n8n-nodes-langchain.toolCalculator",
        "position": [
          2540,
          790
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "9aca7e2d-af43-4de6-aa07-2e880d660d20",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2660,
          790
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"Tipo\": \"Factura\",\n  \"Numero_Factura\": \"FAC-2025-00123\",\n  \"Fecha_Emision\": \"2025-05-07\",\n  \"CUFE\": \"f4a6c8b03e1e4e8b90f9e3e2945d8b23c5b4e2fa\",\n  \"NIT_Emisor\": \"900123456\",\n  \"Razon_Social_Emisor\": \"Comercializadora XYZ S.A.S.\",\n  \"NIT_Receptor\": \"1012345678\",\n  \"Valor_Antes_Impuesto\": 1000000,\n  \"Impuesto\": 190000,\n  \"Total\": 1190000,\n  \"Resumen_Compra\": \"Compra de equipos de oficina incluyendo escritorios y sillas ejecutivas\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "7793086c-b1f7-49f7-b67a-77721087fea5",
        "name": "On Email receipt",
        "type": "n8n-nodes-base.gmailTrigger",
        "notes": "Executed every 30 minutes as it's for personal invoices, one can wait",
        "position": [
          0,
          445
        ],
        "parameters": {
          "simple": false,
          "filters": {
            "q": "has:attachment filename:zip"
          },
          "options": {
            "downloadAttachments": true
          },
          "pollTimes": {
            "item": [
              {
                "mode": "everyX",
                "unit": "minutes",
                "value": 30
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "DIVionghQwRFOcIe",
            "name": "Gmail account"
          }
        },
        "notesInFlow": false,
        "typeVersion": 1.2
      },
      {
        "id": "97460873-8220-476b-97e7-cf433be3f9cd",
        "name": "Get Filename and mimeType",
        "type": "n8n-nodes-base.code",
        "position": [
          220,
          445
        ],
        "parameters": {
          "jsCode": "let results = [];\n\nfor (item of items) {\n    for (key of Object.keys(item.binary)) {\n        results.push({\n            json: {\n                fileName: item.binary[key].fileName,\n                mimeType: item.binary[key].mimeType,\n            },\n            binary: {\n                data: item.binary[key],\n            }\n        });\n    }\n}\n\nreturn results;"
        },
        "typeVersion": 2
      },
      {
        "id": "e01cdfc7-c343-444e-a6ca-57b2139c3b6e",
        "name": "Filter ZIP files only",
        "type": "n8n-nodes-base.filter",
        "position": [
          440,
          445
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "ccb7942e-8cef-480c-98a4-b5b68d98a235",
                "operator": {
                  "type": "string",
                  "operation": "endsWith"
                },
                "leftValue": "={{ $json.mimeType }}",
                "rightValue": "zip"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "855b3a55-5d2e-4da1-aef7-76bf559da876",
        "name": "Unzip Invoice",
        "type": "n8n-nodes-base.compression",
        "position": [
          660,
          445
        ],
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "c48abfc9-dff9-49ef-bb59-212f2f1eb472",
        "name": "Just for style",
        "type": "n8n-nodes-base.noOp",
        "position": [
          1100,
          270
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "b84984d5-f736-40be-b0b5-2d0a245c79a6",
        "name": "Get filename and mimeType on extracted docs",
        "type": "n8n-nodes-base.code",
        "position": [
          1100,
          470
        ],
        "parameters": {
          "jsCode": "let results = [];\n\nfor (item of items) {\n    for (key of Object.keys(item.binary)) {\n        results.push({\n            json: {\n                fileName: item.binary[key].fileName,\n                mimeType: item.binary[key].mimeType,\n            },\n            binary: {\n                data: item.binary[key],\n            }\n        });\n    }\n}\n\nreturn results;"
        },
        "typeVersion": 2
      },
      {
        "id": "9ff8e500-8135-4960-81f5-fbc0945d45db",
        "name": "Split XML and PDF",
        "type": "n8n-nodes-base.switch",
        "position": [
          1320,
          470
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "pdf",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "69784ebe-7edd-4e50-89c3-8440a662f25a",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $json.mimeType }}",
                      "rightValue": "pdf"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "xml",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "90f50e8d-bd72-4fdf-b854-e473b117377a",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $json.mimeType }}",
                      "rightValue": "xml"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {
            "fallbackOutput": "none"
          }
        },
        "typeVersion": 3.2
      },
      {
        "id": "1132645b-9270-4581-9707-59bec4ee2417",
        "name": "Extract PDF Data",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          1760,
          445
        ],
        "parameters": {
          "options": {
            "joinPages": true
          },
          "operation": "pdf"
        },
        "typeVersion": 1
      },
      {
        "id": "215b29f9-0e0a-4989-a6d3-65faa5941729",
        "name": "Extract XML Data",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          1540,
          645
        ],
        "parameters": {
          "options": {},
          "operation": "xml"
        },
        "typeVersion": 1
      },
      {
        "id": "7fa1555e-11ae-4fca-b526-52d2b4a1773e",
        "name": "Convert to JSON",
        "type": "n8n-nodes-base.xml",
        "position": [
          1760,
          645
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "cb581772-cb26-4d36-b1b9-c290f5a0a4ea",
        "name": "Append both Docs",
        "type": "n8n-nodes-base.merge",
        "position": [
          1980,
          570
        ],
        "parameters": {},
        "typeVersion": 3.1
      },
      {
        "id": "225b6fd6-4cfd-43d7-9c3e-fe20d97831d7",
        "name": "Aggregate all Data into 1 list",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          2200,
          580
        ],
        "parameters": {
          "options": {},
          "aggregate": "aggregateAllItemData"
        },
        "typeVersion": 1
      },
      {
        "id": "947001a4-bcdc-4421-bdce-07d41fc85c88",
        "name": "Extract Data from PDF and XML",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          2452,
          570
        ],
        "parameters": {
          "text": "=PDF:\n{{ $json.data[0].text }}\n\nXML: \n{{ $json.data[1].AttachedDocument['cac:Attachment']['cac:ExternalReference']['cbc:Description'] }}",
          "options": {
            "systemMessage": "=Extrae del PDF y el XML proporcionados la siguiente información:\n\t•\tTipo: Factura o Nota Crédito\n\t•\tNúmero de factura\n\t•\tFecha de emisión (formato: YYYY-MM-DD)\n\t•\tNIT del emisor (sin dígito de verificación, solo los números antes del guion)\n\t•\tNIT del receptor (sin dígito de verificación)\n\t•\tRazón social del emisor\n\t•\tValor antes de IVA\n\t•\tValor del IVA\n\t•\tValor total de la factura\n\t•\tCUFE\n\t•\tResumen de la compra (máximo 20 palabras, describiendo en términos generales qué se compró, usando solo mayúsculas donde corresponda gramaticalmente. Ejemplo: “CONSULTA DE PRIMERA VEZ POR OPTOMETRIA” → “Consulta de primera vez por optometría”)\n\nVerifica que:\nValor total = Valor antes de IVA + Valor del IVA, usando la herramienta Calculator."
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "3eb86ff2-7a4b-4e17-af92-057b715fd69d",
        "name": "Create initial PDF",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          2530,
          220
        ],
        "parameters": {
          "name": "={{ $json.fileName }}",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1v0sqvMCFAN02WzXdTuoYF8KGw7Y0Tmf1",
            "cachedResultUrl": "https://drive.google.com/drive/folders/xxxxxxx",
            "cachedResultName": "Facturas"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "UeBZlmzBxNp4aScN",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "cbe7bcf2-972b-4110-8d1c-075fcc34497a",
        "name": "Merge both flows",
        "type": "n8n-nodes-base.merge",
        "position": [
          2860,
          495
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineAll"
        },
        "typeVersion": 3.1
      },
      {
        "id": "14243355-766d-425d-90d1-6f114903636a",
        "name": "Update PDF with actual name",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          3080,
          495
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {},
          "operation": "update",
          "changeFileContent": "",
          "newUpdatedFileName": "={{ $json.output.Fecha_Emision }}-{{ $json.output.Numero_Factura }}.pdf"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "UeBZlmzBxNp4aScN",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "aa623454-553a-4b95-b320-964c68dd7555",
        "name": "Get Current Date",
        "type": "n8n-nodes-base.code",
        "notes": "Not in use actually...",
        "position": [
          3300,
          495
        ],
        "parameters": {
          "jsCode": "const now = new Date();\n\n// Get Colombia time values\nconst options = { timeZone: 'America/Bogota', year: 'numeric', month: '2-digit', day: '2-digit' };\nconst formatter = new Intl.DateTimeFormat('en-CA', options); // en-CA gives YYYY-MM-DD format\nconst [year, month, day] = formatter.format(now).split('-');\n\nreturn [\n  {\n    json: {\n      year,\n      month,\n      day\n    }\n  }\n];"
        },
        "typeVersion": 2
      },
      {
        "id": "466a2885-adba-41ce-8a51-8c36db58a113",
        "name": "Create or update row",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          3520,
          620
        ],
        "parameters": {
          "columns": {
            "value": {
              "Key": "={{ $('Merge both flows').item.json.output.NIT_Emisor }}-{{ $('Merge both flows').item.json.output.Numero_Factura }}",
              "CUFE": "={{ $('Merge both flows').item.json.output.CUFE }}",
              "Tipo": "={{ $('Merge both flows').item.json.output.Tipo }}",
              "Fecha": "={{ $('Merge both flows').item.json.output.Fecha_Emision }}",
              "Total": "={{ $('Merge both flows').item.json.output.Total }}",
              "Factura": "={{ $('Extract Data from PDF and XML').item.json.output.Numero_Factura }}",
              "Impuesto": "={{ $('Merge both flows').item.json.output.Impuesto }}",
              "Subtotal": "={{ $('Merge both flows').item.json.output.Valor_Antes_Impuesto }}",
              "NIT Emisor": "={{ $('Merge both flows').item.json.output.NIT_Emisor }}",
              "NIT Receptor": "={{ $('Merge both flows').item.json.output.NIT_Receptor }}",
              "Razón Social": "={{ $('Merge both flows').item.json.output.Razon_Social_Emisor }}",
              "Resumen Compra": "={{ $('Merge both flows').item.json.output.Resumen_Compra }}"
            },
            "schema": [
              {
                "id": "Factura",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Factura",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Tipo",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Tipo",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Key",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Key",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Fecha",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Fecha",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Razón Social",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Razón Social",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "NIT Emisor",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "NIT Emisor",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "NIT Receptor",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "NIT Receptor",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Subtotal",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Subtotal",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Impuesto",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Impuesto",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Total",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Total",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "CUFE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "CUFE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Resumen Compra",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Resumen Compra",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Key"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/xxxxx/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1HmtB_MXS7oOJn86V3dcBjLdvnw3aWLkD36avc147zuI",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/xxxxx/edit?usp=drivesdk",
            "cachedResultName": "Facturas"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "phQyVnZ7ZojxewDR",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "e7076c9e-1998-4aab-bb43-9d9f89a3377f",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          -480
        ],
        "parameters": {
          "width": 960,
          "height": 880,
          "content": "# 🧾 Colombian electronic invoices processing\n\nThis N8N workflow automates the extraction and organization of **personal electronic invoices** in Colombia received via **Gmail**. It includes the following key steps:\n\n## 🔁 Flow Summary\n\n1. **Email Trigger**\n   - Polls Gmail every **30 minutes** for emails with `.zip` attachments (assumed to contain invoices).\n   - Following DIAN requirements in Colombia\n\n2. **ZIP File Handling**\n   - Extracts all files.\n   - Filters only **PDF** and **XML** files for processing.\n\n3. **Data Extraction & Processing**\n   - Uses **LangChain Agent + OpenAI (GPT-4o-mini)** to extract:\n     - Tipo de documento (Factura / Nota Crédito)\n     - Número de factura\n     - Fecha de emisión (YYYY-MM-DD)\n     - NIT emisor y receptor (sin dígito de verificación)\n     - Razón social del emisor\n     - Subtotal, IVA, Total\n     - CUFE\n     - Resumen de compra (max 20 words, formatted sentence)\n\n4. **Validation**\n   - Ensures **Total = Subtotal + IVA** using a calculator node.\n\n5. **Storage**\n   - Uploads the original PDF to **Google Drive**.\n   - Renames the file to: `YYYY-MM-DD-NUMERO_FACTURA.pdf`.\n   - Inserts or updates invoice details in **Google Sheets** using a unique `Key` (`NIT_Emisor + Numero_Factura`) to prevent duplication.\n\n---\n\n> ⚙️ Designed for personal use with minimal latency tolerance and high automation reliability."
        },
        "typeVersion": 1
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "fefb527f-7457-46bc-a80c-ca290b163bce",
    "connections": {
      "Calculator": {
        "ai_tool": [
          [
            {
              "node": "Extract Data from PDF and XML",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Unzip Invoice": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to JSON": {
        "main": [
          [
            {
              "node": "Append both Docs",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Just for style",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Get filename and mimeType on extracted docs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Append both Docs": {
        "main": [
          [
            {
              "node": "Aggregate all Data into 1 list",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract PDF Data": {
        "main": [
          [
            {
              "node": "Append both Docs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract XML Data": {
        "main": [
          [
            {
              "node": "Convert to JSON",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Current Date": {
        "main": [
          [
            {
              "node": "Create or update row",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge both flows": {
        "main": [
          [
            {
              "node": "Update PDF with actual name",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "On Email receipt": {
        "main": [
          [
            {
              "node": "Get Filename and mimeType",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Extract Data from PDF and XML",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Split XML and PDF": {
        "main": [
          [
            {
              "node": "Create initial PDF",
              "type": "main",
              "index": 0
            },
            {
              "node": "Extract PDF Data",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Extract XML Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create initial PDF": {
        "main": [
          [
            {
              "node": "Merge both flows",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create or update row": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter ZIP files only": {
        "main": [
          [
            {
              "node": "Unzip Invoice",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Extract Data from PDF and XML",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Get Filename and mimeType": {
        "main": [
          [
            {
              "node": "Filter ZIP files only",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update PDF with actual name": {
        "main": [
          [
            {
              "node": "Get Current Date",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Data from PDF and XML": {
        "main": [
          [
            {
              "node": "Merge both flows",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Aggregate all Data into 1 list": {
        "main": [
          [
            {
              "node": "Extract Data from PDF and XML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get filename and mimeType on extracted docs": {
        "main": [
          [
            {
              "node": "Split XML and PDF",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "96d35e452e0d9a182973416b7532cfc5643239aaaa764a5bf74d52ca84f4a35c"
    },
    "nodes": [
      {
        "id": "5abb0804-324f-4ba7-9d9f-45ed4555b84f",
        "name": "VLM Run",
        "type": "@vlm-run/n8n-nodes-vlmrun.vlmRun",
        "position": [
          1504,
          560
        ],
        "parameters": {
          "domain": "healthcare.claims-processing"
        },
        "typeVersion": 1
      },
      {
        "id": "78d37355-309d-4502-9655-ad8ca03c617d",
        "name": "Append row in sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1952,
          560
        ],
        "parameters": {
          "columns": {
            "value": {
              "FORM TYPE": "={{ $json.response.form_type }}",
              "AMOUNT DUE": "={{ $json.response.balance_due }}",
              "AMOUNT PAID": "={{ $json.response.amount_paid }}",
              "INSURED DOB": "={{ $json.response.insured_dob }}",
              "INSURED SEX": "={{ $json.response.insured_sex }}",
              "PATIENT SEX": "={{ $json.response.patient_sex }}",
              "CARRIER NAME": "={{ $json.response.carrier_name }}",
              "FORM VERSION": "={{ $json.response.form_version }}",
              "INSURANCE ID": "={{ $json.response.insured_id_number }}",
              "INSURED NAME": "={{ $json.response.insured_name }}",
              "PATIENT NAME": "={{ $json.response.patient_name }}",
              "TOTAL CHARGE": "={{ $json.response.total_charge }}",
              "AUTO ACCIDENT": "={{ $json.response.auto_accident }}",
              "INSURANCE TYPE": "={{ $json.response.insurance_type }}",
              "MARTIAL STATUS": "={{ $json.response.marital_status }}",
              "OTHER ACCIDENT": "={{ $json.response.other_accident }}",
              "INSURED ADDRESS": "={{ $json.response.insured_address.street }}, {{ $json.response.insured_address.city }}, {{ $json.response.insured_address.state }}, {{ $json.response.insured_address.zip_code }}",
              "PATIENT ADDRESS": "={{ $json.response.patient_address.street }}, {{ $json.response.patient_address.city }}, {{ $json.response.patient_address.state }}, {{ $json.response.patient_address.zip_code }}",
              "INSURED EMPLOYER": "={{ $json.response.insured_employer }}",
              "INSURED PHONE NO": "={{ $json.response.insured_address.phone }}",
              "PATIENT PHONE NO": "={{ $json.response.patient_address.phone }}",
              "PROCESSING NOTES": "={{ $json.response.processing_notes }}",
              "EMPLOYMENT STATUS": "={{ $json.response.employment_status }}",
              "OTHER INSURED DOB": "={{ $json.response.other_insured_dob }}",
              "OTHER INSURED SEX": "={{ $json.response.other_insured_sex }}",
              "UNABLE TO WORK TO": "={{ $json.response.unable_to_work_to }}",
              "EMPLOYMENT RELATED": "={{ $json.response.employment_related }}",
              "FORM APPROVAL DATE": "={{ $json.response.form_approval_date }}",
              "HOSPITALIZATION TO": "={{ $json.response.hospitalization_to }}",
              "OTHER INSURED NAME": "={{ $json.response.other_insured_name }}",
              "PATIENT ACCOUNT NO": "={{ $json.response.patient_account_number }}",
              "PATIENT BIRTH DATE": "={{ $json.response.patient_birth_date }}",
              "UNABLE TO WORK FROM": "={{ $json.response.unable_to_work_from }}",
              "CURRENT ILLNESS DATE": "={{ $json.response.current_illness_date }}",
              "HOSPITALIZATION FROM": "={{ $json.response.hospitalization_from }}",
              "INSURED POLICY GROUP": "={{ $json.response.insured_policy_group }}",
              "PATIENT RELATIONSHIP": "={{ $json.response.patient_relationship }}",
              "SIMILLAR ILLNESS DATE": "={{ $json.response.similar_illness_date }}",
              "INSURED INSURANCE PLAN": "={{ $json.response.insured_insurance_plan }}",
              "OTHER INSURED EMPLOYER": "={{ $json.response.other_insured_employer }}",
              "REFERRING PHYSICIAN NAME": "={{ $json.response.referring_physician_name }}",
              "OTHER INSURED POLICY GROUP": "={{ $json.response.other_insured_policy_group }}",
              "OTHER INSURED INSURANCE PLAN": "={{ $json.response.other_insured_insurance_plan }}"
            },
            "schema": [
              {
                "id": "FORM TYPE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "FORM TYPE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "FORM VERSION",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "FORM VERSION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "FORM APPROVAL DATE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "FORM APPROVAL DATE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "CARRIER NAME",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "CARRIER NAME",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PATIENT NAME",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PATIENT NAME",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PATIENT BIRTH DATE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PATIENT BIRTH DATE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PATIENT SEX",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PATIENT SEX",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PATIENT ADDRESS",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PATIENT ADDRESS",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PATIENT RELATIONSHIP",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PATIENT RELATIONSHIP",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PATIENT PHONE NO",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PATIENT PHONE NO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "MARTIAL STATUS",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "MARTIAL STATUS",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "EMPLOYMENT STATUS",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "EMPLOYMENT STATUS",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "EMPLOYMENT RELATED",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "EMPLOYMENT RELATED",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "AUTO ACCIDENT",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "AUTO ACCIDENT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "OTHER ACCIDENT",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "OTHER ACCIDENT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "CURRENT ILLNESS DATE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "CURRENT ILLNESS DATE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "SIMILLAR ILLNESS DATE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "SIMILLAR ILLNESS DATE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "UNABLE TO WORK FROM",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "UNABLE TO WORK FROM",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "UNABLE TO WORK TO",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "UNABLE TO WORK TO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "HOSPITALIZATION FROM",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "HOSPITALIZATION FROM",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "HOSPITALIZATION TO",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "HOSPITALIZATION TO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PATIENT ACCOUNT NO",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PATIENT ACCOUNT NO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "TOTAL CHARGE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "TOTAL CHARGE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "AMOUNT DUE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "AMOUNT DUE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "AMOUNT PAID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "AMOUNT PAID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "PROCESSING NOTES",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PROCESSING NOTES",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INSURANCE TYPE",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "INSURANCE TYPE",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INSURANCE ID",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "INSURANCE ID",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INSURED NAME",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "INSURED NAME",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INSURED ADDRESS",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "INSURED ADDRESS",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INSURED PHONE NO",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "INSURED PHONE NO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INSURED POLICY GROUP",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "INSURED POLICY GROUP",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INSURED DOB",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "INSURED DOB",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INSURED SEX",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "INSURED SEX",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INSURED EMPLOYER",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "INSURED EMPLOYER",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "INSURED INSURANCE PLAN",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "INSURED INSURANCE PLAN",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "OTHER INSURED NAME",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "OTHER INSURED NAME",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "OTHER INSURED POLICY GROUP",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "OTHER INSURED POLICY GROUP",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "OTHER INSURED DOB",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "OTHER INSURED DOB",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "OTHER INSURED SEX",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "OTHER INSURED SEX",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "OTHER INSURED EMPLOYER",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "OTHER INSURED EMPLOYER",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "OTHER INSURED INSURANCE PLAN",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "OTHER INSURED INSURANCE PLAN",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "REFERRING PHYSICIAN NAME",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "REFERRING PHYSICIAN NAME",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1wZQDu7Hd0iV8dqiLbfUzAwUqKnn8J0ZQFO1weZ_ShxQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1wZQDu7Hd0iV8dqiLbfUzAwUqKnn8J0ZQFO1weZ_ShxQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1wZQDu7Hd0iV8dqiLbfUzAwUqKnn8J0ZQFO1weZ_ShxQ/edit?usp=drivesdk",
            "cachedResultName": "healthcare claim"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "029fce72-6691-49a8-9653-c8d78183c2e5",
        "name": "Download file",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1152,
          560
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {},
          "operation": "download"
        },
        "typeVersion": 3
      },
      {
        "id": "e51f8123-dc3c-41cd-8598-bb78cc9957fd",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          448,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 416,
          "height": 816,
          "content": "# Health Care Claim Processing with VLM Run\n\nAutomatically extracts structured health care claim details from uploaded documents in Google Drive and saves them into a Google Sheet for tracking, compliance, or reporting.\n\n## Workflow\n\n1. 📂 Detect file upload in Google Drive\n2. ⬇️ Download the uploaded document\n3. 🤖 Convert document to structured text using VLM Run (`healthcare.claims-processing`)\n4. 📊 Append extracted order data to Google Sheet\n\n## Perfect for\n\n* Healthcare claim submission forms\n* Insurance reimbursement requests\n* Prior authorization documentation\n* Denial and appeal workflows\n* Automated payer compliance reporting\n\n\n## Requirements\n\n* VLM Run API access\n* Google Drive + Sheets OAuth2\n* n8n server with active workflow"
        },
        "typeVersion": 1
      },
      {
        "id": "00c4afaf-34a8-4a5c-903c-d66831f5dd52",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1792,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 416,
          "height": 816,
          "content": "# Append Row in Sheet\n\n**Function:** Appends extracted structured data into a Google Sheet.\n\n* Columns could be: Patient, DOB, Insurance ID, CPT/HCPCS Code, Diagnosis Code, Billed Amount, Modifiers, Provider, Date of Service, Payer Response\n\n\n**Benefit:** Provides a structured, continuously updated database for tracking orders"
        },
        "typeVersion": 1
      },
      {
        "id": "ebacf386-ab43-406f-ae3e-95e6089f0c0b",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1344,
          0
        ],
        "parameters": {
          "width": 416,
          "height": 816,
          "content": "# VLM Run (Document)\n\n**Function:** Sends the health care claim file to VLM Run under the category `healthcare.claims-processing`.\n\n* Extracts structured details such as:\n\n  * Patient name, DOB, insurance ID\n  * Claim details (CPT/HCPCS, diagnosis codes, billed amount, modifiers)\n  * Provider details (name, NPI, signature/date of service)\n  * Payer response (approval, denial, adjustment codes)\n\n\n**Benefit:** Turns complex medical forms into machine-readable JSON"
        },
        "typeVersion": 1
      },
      {
        "id": "f393272d-8006-43be-afd7-1e3629e40a05",
        "name": "Google Drive Trigger",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          944,
          560
        ],
        "parameters": {
          "event": "fileCreated",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "list",
            "value": "1E8rvLEWKguorMT36yCD1jY78G0u8g6g7",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1E8rvLEWKguorMT36yCD1jY78G0u8g6g7",
            "cachedResultName": "test_data"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "cd56ccab-968d-405c-b27a-dfcb40d6e1b5",
        "name": "📁 Input Processing Documentation",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          896,
          0
        ],
        "parameters": {
          "color": 7,
          "width": 416,
          "height": 824,
          "content": "# 📁 Input Processing\n\n**Monitors & downloads healthcare claim files from Google Drive.**\n\n**Process:**\n1. Watches designated Drive folder\n2. Auto-triggers on new uploads\n3. Downloads files for AI processing\n\n**Supported Formats:**\n- Images (JPG, PNG, WEBP)\n- PDF documents\n- Mobile camera uploads\n- Scanned receipts"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "VLM Run": {
        "main": [
          [
            {
              "node": "Append row in sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download file": {
        "main": [
          [
            {
              "node": "VLM Run",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Drive Trigger": {
        "main": [
          [
            {
              "node": "Download file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "PYTm8uU9m0FN8tG9",
    "meta": {
      "instanceId": "c38e3b8a7e4240e6cdca062743f016c1029f385bf40345b6291939dfd83bfd77",
      "templateCredsSetupCompleted": true
    },
    "name": "9 Monitor Customer Support Forums",
    "tags": [],
    "nodes": [
      {
        "id": "4830a8a6-6e76-47e0-abdc-7c72ebfda985",
        "name": "🚦 Start Workflow (Manual Trigger)",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -440,
          -80
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "8d2279c3-8d49-4dc1-87df-47e3e077b2d5",
        "name": "🔗 Enter Forum URL",
        "type": "n8n-nodes-base.set",
        "position": [
          -240,
          -80
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e53f8457-1c2c-41ff-8621-4f7ebee981a8",
                "name": "URL",
                "type": "string",
                "value": "https://api.stackexchange.com/2.3/search?order=desc&sort=activity&intitle=openai&site=superuser"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "8f3b47c7-1a6e-4084-91ce-f805b75146d2",
        "name": "🧠 Chat Model Reasoning1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          0,
          200
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "kmqnyfHdWfA8k1KC",
            "name": "OpenAi account 3"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a98d95c6-67f7-49b3-8a25-45a08576ee5e",
        "name": "🤖 Agent: Scrape Forum & Extract Insights",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          60,
          -80
        ],
        "parameters": {
          "text": "=scrape the question and answers forum about openAi from this below URL:\n{{ $json.URL }}\nand i want to include in my output are platform name , author name , question , answer_snippet , link , pain point\ncheck if any question have no answer than dont scrape it search for those which have question , its answer_snippet and also customer pain point\n",
          "options": {},
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2
      },
      {
        "id": "a3ea338d-cf2b-4399-92f6-5865a9a725c7",
        "name": "🌐 Web Scraper Tool ",
        "type": "n8n-nodes-mcp.mcpClientTool",
        "position": [
          160,
          200
        ],
        "parameters": {
          "toolName": "scrape_as_markdown",
          "operation": "executeTool",
          "toolParameters": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Tool_Parameters', ``, 'json') }}"
        },
        "credentials": {
          "mcpClientApi": {
            "id": "dGu6Ys11ijXSTxcV",
            "name": "MCP Client (STDIO) account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "8bf7a8cd-ae02-4aa6-a7bf-e8aee16ce3ea",
        "name": "✉️ Send Insights to Product Team (Gmail)",
        "type": "n8n-nodes-base.gmail",
        "position": [
          580,
          -80
        ],
        "webhookId": "6531f16e-ae66-4e1f-bc87-fd87863c6f96",
        "parameters": {
          "sendTo": "shahkar.genai@gmail.com",
          "message": "=Hello Product Team,\n\nHere are recent customer pain points and technical discussions about OpenAI from the SuperUser forum:\n\nQuestion:       {{$json[\"output\"][0][\"question\"]}}\nAsked by:       {{$json[\"output\"][0][\"author_name\"]}}\nLink:           {{$json[\"output\"][0][\"link\"]}}{{$json[\"output\"][0]                         [\"link\"]}}\nAnswer Snippet: {{$json[\"output\"][0][\"answer_snippet\"]}}\nPain Point:     {{$json[\"output\"][0][\"pain_point\"]}}\n  \nQuestion:       {{$json[\"output\"][1][\"question\"]}}\nAsked by:       {{$json[\"output\"][1][\"author_name\"]}}\nLink:           {{$json[\"output\"][1][\"link\"]}}{{$json[\"output\"][1]                         [\"link\"]}}\nAnswer Snippet: {{$json[\"output\"][1][\"answer_snippet\"]}}\nPain Point:     {{$json[\"output\"][1][\"pain_point\"]}}\n\nBest regards,\nYour Automation Workflow\n",
          "options": {
            "appendAttribution": false
          },
          "subject": "=Customer Forum Insights: OpenAI Pain Points from {{ $json.output[0].platform_name }}",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "fZQRQuE7FmCr9daN",
            "name": "Gmail account 2"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "265273a0-7996-43c2-a6e0-4515cef83b08",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -500,
          -580
        ],
        "parameters": {
          "color": 5,
          "width": 420,
          "height": 720,
          "content": "## 1️⃣ **Section 1: Start & Input**\n\n* **🚦 Start Workflow (Manual Trigger)**\n\n  * *Node: When clicking ‘Execute workflow’*\n  * **What happens:**\n    You begin the automation by clicking the \"Execute workflow\" button in n8n. This makes the process fully manual and secure—you decide when to run it.\n\n* **🔗 Enter Forum URL**\n\n  * *Node: Edit Fields (manual)*\n  * **What happens:**\n    You paste the URL of the specific Superuser Q\\&A forum post you want to analyze. No coding or technical setup—just copy and paste!\n\n**🟢 Why this is great for beginners:**\nYou only need to provide the link and click a button. No scripts, no complex setup.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "dcabff56-7666-4e76-9032-43893588bfd6",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          480,
          -520
        ],
        "parameters": {
          "color": 6,
          "width": 340,
          "height": 680,
          "content": "## 3️⃣ **Section 3: Share Insights with Your Team**\n\n* **✉️ Send Insights to Product Team**\n\n  * *Node: Gmail (send: message)*\n  * **What happens:**\n    The final, cleaned, and structured insights are sent as an email to your Product Team. This means the right people get the right information at the right time—automatically.\n\n**🟢 Why this is great for beginners:**\nNo more compiling or sending emails yourself! The system takes care of communicating findings—saving time and ensuring nothing is forgotten.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "beb64fb0-4b77-490d-8386-8048ba951617",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -20,
          -940
        ],
        "parameters": {
          "color": 2,
          "width": 460,
          "height": 1080,
          "content": "## 2️⃣ **Section 2: AI Agent Scrapes & Analyzes**\n\n* **🤖 Agent: Extract Forum Insights**\n\n  * *Node: AI Agent*\n\n  This is where all the magic happens! The AI agent coordinates a team of tools to read the forum post, pick out the most important details, and structure everything perfectly.\n\n  **Sub-nodes powering the agent:**\n\n  * **🧠 Chat Model Reasoning**\n    *Node: OpenAI Chat Model*\n    — Understands what you want and plans the scraping/analysis logic.\n  * **🌐 Web Scraper Tool (scrape\\_as\\_markdown)**\n    *Node: MCP Client (executeTool)*\n    — Securely visits the forum page and fetches the Q\\&A content in a readable format.\n  * **📦 Format Forum Data as JSON**\n    *Node: Structured Output Parser*\n    — Transforms messy forum data into a well-structured JSON object including:\n\n    * Platform name\n    * Author name\n    * Question\n    * Answer snippet\n    * Link\n    * **Identified customer pain points!**\n\n**🟢 Why this is great for beginners:**\nYou don’t have to read, sort, or copy any forum data. The agent does everything: reading, understanding, summarizing, and structuring—just like a human analyst, but automated!\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "02f867d6-a2d3-4d1c-868a-674475bac53a",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          860,
          -520
        ],
        "parameters": {
          "color": 7,
          "width": 380,
          "height": 240,
          "content": "## I’ll receive a tiny commission if you join Bright Data through this link—thanks for fueling more free content!\n\n### https://get.brightdata.com/1tndi4600b25"
        },
        "typeVersion": 1
      },
      {
        "id": "3ef9e897-85d0-436a-b2c4-e9e3734a5d6b",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2580,
          -1320
        ],
        "parameters": {
          "color": 4,
          "width": 1300,
          "height": 320,
          "content": "=======================================\n            WORKFLOW ASSISTANCE\n=======================================\nFor any questions or support, please contact:\n    Yaron@nofluff.online\n\nExplore more tips and tutorials here:\n   - YouTube: https://www.youtube.com/@YaronBeen/videos\n   - LinkedIn: https://www.linkedin.com/in/yaronbeen/\n=======================================\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9b4535e8-e49b-4af2-8e18-bfbdec7db961",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2580,
          -980
        ],
        "parameters": {
          "color": 4,
          "width": 1300,
          "height": 1880,
          "content": "# 🚀 Monitor Customer Support Forums\n\n### Instantly turn forum questions about OpenAI into actionable product insights—delivered right to your Product Team’s inbox!\n\n---\n\n## 1️⃣ **Section 1: Start & Input**\n\n* **🚦 Start Workflow (Manual Trigger)**\n\n  * *Node: When clicking ‘Execute workflow’*\n  * **What happens:**\n    You begin the automation by clicking the \"Execute workflow\" button in n8n. This makes the process fully manual and secure—you decide when to run it.\n\n* **🔗 Enter Forum URL**\n\n  * *Node: Edit Fields (manual)*\n  * **What happens:**\n    You paste the URL of the specific Superuser Q\\&A forum post you want to analyze. No coding or technical setup—just copy and paste!\n\n**🟢 Why this is great for beginners:**\nYou only need to provide the link and click a button. No scripts, no complex setup.\n\n---\n\n## 2️⃣ **Section 2: AI Agent Scrapes & Analyzes**\n\n* **🤖 Agent: Extract Forum Insights**\n\n  * *Node: AI Agent*\n\n  This is where all the magic happens! The AI agent coordinates a team of tools to read the forum post, pick out the most important details, and structure everything perfectly.\n\n  **Sub-nodes powering the agent:**\n\n  * **🧠 Chat Model Reasoning**\n    *Node: OpenAI Chat Model*\n    — Understands what you want and plans the scraping/analysis logic.\n  * **🌐 Web Scraper Tool (scrape\\_as\\_markdown)**\n    *Node: MCP Client (executeTool)*\n    — Securely visits the forum page and fetches the Q\\&A content in a readable format.\n  * **📦 Format Forum Data as JSON**\n    *Node: Structured Output Parser*\n    — Transforms messy forum data into a well-structured JSON object including:\n\n    * Platform name\n    * Author name\n    * Question\n    * Answer snippet\n    * Link\n    * **Identified customer pain points!**\n\n**🟢 Why this is great for beginners:**\nYou don’t have to read, sort, or copy any forum data. The agent does everything: reading, understanding, summarizing, and structuring—just like a human analyst, but automated!\n\n---\n\n## 3️⃣ **Section 3: Share Insights with Your Team**\n\n* **✉️ Send Insights to Product Team**\n\n  * *Node: Gmail (send: message)*\n  * **What happens:**\n    The final, cleaned, and structured insights are sent as an email to your Product Team. This means the right people get the right information at the right time—automatically.\n\n**🟢 Why this is great for beginners:**\nNo more compiling or sending emails yourself! The system takes care of communicating findings—saving time and ensuring nothing is forgotten.\n\n---\n\n## 🌟 **How Beginners Can Use This Workflow**\n\n| Step                | What to Do                                     | What Happens                                               |\n| ------------------- | ---------------------------------------------- | ---------------------------------------------------------- |\n| 🚦 Start            | Click **Execute workflow** in n8n              | The automation begins                                      |\n| 🔗 Input URL        | Paste a Superuser Q\\&A forum link about OpenAI | The workflow targets this exact forum question             |\n| 🤖 AI Agent Scrapes | (You wait for a moment)                        | The AI extracts question, answer, author, pain points…     |\n| ✉️ Receive Insights | (No action needed)                             | An email with all structured insights is sent to your team |\n\n---\n\n## 💡 **Benefits**\n\n* 🕐 **Save Hours:** No manual copying or summarizing forum content\n* 📊 **Actionable Insights:** Quickly see customer pain points for product improvement\n* 📧 **Automated Communication:** Ensure your team never misses key feedback\n* 🧑‍💻 **Zero Coding:** Designed for anyone—no technical experience needed\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "ac6abf38-249b-4e83-9f49-f9545e75b65b",
        "name": "Auto-fixing Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
        "position": [
          300,
          200
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "3914b950-6f76-4304-9db3-29504051ab2d",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          300,
          400
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "kmqnyfHdWfA8k1KC",
            "name": "OpenAi account 3"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "d050c092-20c5-469f-8922-db7e880ffed2",
        "name": "📦 Format Forum Data as JSON1",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          460,
          400
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"platform\": \"SuperUser\",\n  \"questions\": [\n    {\n      \"author\": \"Tolure\",\n      \"question\": \"How to use Azure OpenAI as a pseudo DB\",\n      \"answer_snippet\": \"(Answer is available but not fully provided in the current data; question is marked as answered)\",\n      \"link\": \"https://superuser.com/questions/1824019/how-to-use-azure-openai-as-a-pseudo-db\",\n      \"pain_point\": \"Difficulty in using Azure OpenAI for database-like functionality\"\n    },\n    {\n      \"author\": \"Point Clear Media\",\n      \"question\": \"How do I use FFmpeg and OpenAI Whisper to transcribe a RTMP stream?\",\n      \"answer_snippet\": \"(Answer is available but not fully provided in the current data)\",\n      \"link\": \"https://superuser.com/questions/1778870/how-do-i-use-ffmpeg-and-openai-whisper-to-transcribe-a-rtmp-stream\",\n      \"pain_point\": \"Challenges in setting up transcription using FFmpeg and OpenAI Whisper for streaming media\"\n    }\n  ]\n}\n"
        },
        "typeVersion": 1.3
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "2e8bc642-072c-490f-9f24-8b9e60f6a33e",
    "connections": {
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Auto-fixing Output Parser",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "🔗 Enter Forum URL": {
        "main": [
          [
            {
              "node": "🤖 Agent: Scrape Forum & Extract Insights",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "🌐 Web Scraper Tool ": {
        "ai_tool": [
          [
            {
              "node": "🤖 Agent: Scrape Forum & Extract Insights",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Auto-fixing Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "🤖 Agent: Scrape Forum & Extract Insights",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "🧠 Chat Model Reasoning1": {
        "ai_languageModel": [
          [
            {
              "node": "🤖 Agent: Scrape Forum & Extract Insights",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "📦 Format Forum Data as JSON1": {
        "ai_outputParser": [
          [
            {
              "node": "Auto-fixing Output Parser",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "🚦 Start Workflow (Manual Trigger)": {
        "main": [
          [
            {
              "node": "🔗 Enter Forum URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "🤖 Agent: Scrape Forum & Extract Insights": {
        "main": [
          [
            {
              "node": "✉️ Send Insights to Product Team (Gmail)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "5aaf4236c70e34e423fbdb2c7b754d19253a933bb1476d548f75848a01e473cf",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "70ca3a90-55c8-4e46-9278-6a8fd3d107cd",
        "name": "Gmail Trigger",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          -1820,
          220
        ],
        "parameters": {
          "simple": false,
          "filters": {
            "labelIds": [
              "Label_1393502052621954450"
            ]
          },
          "options": {
            "downloadAttachments": true
          },
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "f7dcff0f-7e98-4042-a33e-2fc32d876908",
        "name": "Create blank spreadsheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -780,
          220
        ],
        "parameters": {
          "title": "=invoice_{{ $now }}",
          "options": {},
          "resource": "spreadsheet",
          "sheetsUi": {
            "sheetValues": [
              {
                "title": "=invoice_details"
              }
            ]
          }
        },
        "executeOnce": false,
        "typeVersion": 4.5
      },
      {
        "id": "9769ad04-a41c-4d55-806a-042b7d00e131",
        "name": "Move spreadsheet in invoice folder",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          -560,
          220
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.spreadsheetId }}"
          },
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive",
            "cachedResultUrl": "https://drive.google.com/drive/my-drive",
            "cachedResultName": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1JIdajTJvK6gj4bRjniBJvHEJbQ1pn3AM",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1JIdajTJvK6gj4bRjniBJvHEJbQ1pn3AM",
            "cachedResultName": "invoices"
          },
          "operation": "move"
        },
        "typeVersion": 3
      },
      {
        "id": "f9dbfe55-70b0-4abc-9745-9f4a65d5d1c2",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -1180,
          480
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {
            "responseFormat": "json_object"
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "7dME1fmMlkFyzFjq",
            "name": "OpenAi account 2"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "00c59142-6079-4e9c-9374-ad487e48f072",
        "name": "Attachment Verification",
        "type": "n8n-nodes-base.filter",
        "position": [
          -1600,
          220
        ],
        "parameters": {
          "options": {
            "ignoreCase": false
          },
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "efd974d9-aa20-461a-86ae-6e0a16d1527d",
                "operator": {
                  "type": "object",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $('Gmail Trigger').item.binary }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "8a29ac14-be2b-468a-97fa-540d28e80006",
        "name": "Extract Invoice data",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          -1380,
          220
        ],
        "parameters": {
          "options": {},
          "operation": "pdf",
          "binaryPropertyName": "={{ $('Attachment Verification').item.binary.keys() }}"
        },
        "typeVersion": 1
      },
      {
        "id": "ae08cdc8-fcf9-4891-be86-b2dcf6f35278",
        "name": "Preparing Final data",
        "type": "n8n-nodes-base.code",
        "position": [
          -340,
          220
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of $input$json.output.first().json.outputeach one\n\nlet invoice_details = $('Invoice AI Agent').item.json.output\n\nreturn JSON.parse(invoice_details)"
        },
        "typeVersion": 2
      },
      {
        "id": "7615a5b0-8761-43e2-82b0-32ac5c772f44",
        "name": "Final Spreadsheet with Invoice data",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -140,
          220
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "billed_to",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "billed_to",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "invoice_number",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "invoice_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date_of_issue",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "date_of_issue",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "due_date",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "due_date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "item_0_description",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "item_0_description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "item_0_quantity",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "item_0_quantity",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "item_0_rate",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "item_0_rate",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "item_0_amount",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "item_0_amount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "tax_0_cgst_rate",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "tax_0_cgst_rate",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "tax_0_cgst_amount",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "tax_0_cgst_amount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "tax_0_sgst_rate",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "tax_0_sgst_rate",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "tax_0_sgst_amount",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "tax_0_sgst_amount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "item_0_total_amount",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "item_0_total_amount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "subtotal",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "subtotal",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "total",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "total",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "terms",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "terms",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "conditions_instructions",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "conditions_instructions",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "company_name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "company_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "company_mobile",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "company_mobile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "company_email",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "company_email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "company_website",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "company_website",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "payment_transaction_ids",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "payment_transaction_ids",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "mode_of_payment",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "mode_of_payment",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "billing_address",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "billing_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "shipping_address",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "shipping_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "place_of_supply",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "place_of_supply",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "place_of_delivery",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "place_of_delivery",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "gst_registration_no",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "gst_registration_no",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "pan_no",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "pan_no",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "name",
            "value": "invoice_details"
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Create blank spreadsheet').item.json.spreadsheetId }}"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "e68aa386-7150-4070-a5d7-1dcb963b620d",
        "name": "Invoice AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -1160,
          220
        ],
        "parameters": {
          "text": "={{ $json.text }}",
          "options": {
            "systemMessage": "you are an financial advisor , who reads the array of data to identify certain elements of an Invoice, from the input data and provide a json response. use only following specified keys \nfor example:\n{\n\"billed_to\": \"John\",\n\"invoice_number\": \"569871234\",\n\"date_of_issue\": \"2025-05-21\",\n\"due_date\": \"2025-05-25\",\n\"item_0_description\": \"Computer CPU\",\n\"item_0_quantity\": 6,\n\"item_0_rate\": 15,\n\"item_0_amount\": 90,\n\"item_1_description\": \"Chair Wooden\",\n\"item_1_quantity\": 8,\n\"item_1_rate\": 10,\n\"item_1_amount\": 80,\n\"subtotal\": 170.00,\n\"discount\": 20.00,\n\"total\": 150.00,\n\"terms\": \"Sold items not be acceptable\",\n\"conditions_instructions\": \"xyaABC\",\n\"company_name\": \"Digital Electronics\",\n\"company_mobile\": \"987654321\",\n\"company_email\": \"ayz@gmail.com\",\n\"company_website\": \"www.abc.com\"\n}"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9,
        "alwaysOutputData": false
      },
      {
        "id": "335a80c5-ad86-4379-b1a6-9a2ef7285f3c",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2860,
          100
        ],
        "parameters": {
          "width": 880,
          "height": 1520,
          "content": "AI Invoice Processor Agent: Email to Structured Data\nAutomatically extract, analyze, and organize invoice data from Gmail attachments into structured Google Sheets. Perfect for:\n✅ Accountants & bookkeepers — eliminate manual data entry from invoices\n✅ Small businesses — streamline invoice processing and tracking\n✅ Finance teams — automate accounts payable workflows\n\n⚙️ What's Used\nn8n Nodes:\nGmail Trigger → File Extraction → AI Agent → OpenAI Chat Model → Google Sheets → Google Drive\nExternal Tools:\n\nGmail API – Monitor specific labeled emails with attachments\nPDF Extraction – Convert invoice PDFs to readable text\nOpenAI GPT-4 – Intelligent invoice data extraction and structuring\nGoogle Sheets – Create organized spreadsheets with invoice details\nGoogle Drive – Automatically organize files in invoice folders\n\n\n🔑 Setup – Credentials Needed\n\nGmail OAuth2 → Access emails and download attachments\nOpenAI API Key → For AI-powered invoice data extraction\nGoogle Sheets OAuth2 → Create and populate spreadsheets\nGoogle Drive OAuth2 → Organize files in designated folders\n\n\n📧 Gmail Setup Required\nCreate a Gmail label (e.g., \"Invoice Processing\") and apply it to emails containing invoice attachments. The workflow will monitor this label for new emails every minute.\n\n🚀 Workflow Steps\n\nEmail Monitoring\nContinuously watches Gmail for new emails with specific labels and attachments\nAttachment Verification\nFilters emails to ensure they contain PDF attachments before processing\nData Extraction\nConverts PDF invoices to text and extracts readable content\nAI-Powered Analysis\nGPT processes invoice text and extracts structured data including:\n\nCompany details and contact information\nInvoice numbers, dates, and due dates\nLine items with quantities, rates, and amounts\nTax calculations (CGST, SGST, VAT)\nPayment terms and billing addresses\n\n\nSpreadsheet Creation\nCreates timestamped Google Sheets with organized invoice data\nFile Organization\nMoves processed spreadsheets to designated Drive folders for easy access\n\n\n📊 Extracted Data Fields\nThe AI identifies and organizes 25+ invoice elements:\n\nHeader Info: Billed to, invoice number, dates\nLine Items: Description, quantity, rate, amount\nTax Details: CGST/SGST rates and amounts\nCompany Info: Name, contact details, GST numbers\nPayment Info: Transaction IDs, payment methods\nAddresses: Billing, shipping, delivery locations\n\n\n💡 Pro Tips\n\nUse clear Gmail labels for different invoice types (vendors, clients, etc.)\nEnsure invoice PDFs are text-based (not scanned images) for best results\nCreate separate Drive folders for different accounting periods\nReview AI extraction accuracy and refine prompts as needed\nSet up email filters to automatically apply labels to vendor emails\n\n\n🛠️ Customize It\n\nAdd invoice approval workflows with email notifications\nConnect to accounting software (QuickBooks, Xero, SAP)\nInclude OCR processing for scanned invoice images\nAdd duplicate invoice detection and alerts\nCreate automated payment reminders based on due dates"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Gmail Trigger": {
        "main": [
          [
            {
              "node": "Attachment Verification",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Invoice AI Agent": {
        "main": [
          [
            {
              "node": "Create blank spreadsheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Invoice AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Extract Invoice data": {
        "main": [
          [
            {
              "node": "Invoice AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Preparing Final data": {
        "main": [
          [
            {
              "node": "Final Spreadsheet with Invoice data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Attachment Verification": {
        "main": [
          [
            {
              "node": "Extract Invoice data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create blank spreadsheet": {
        "main": [
          [
            {
              "node": "Move spreadsheet in invoice folder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Move spreadsheet in invoice folder": {
        "main": [
          [
            {
              "node": "Preparing Final data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "d1786ab0d745a7498abf13a9c2cdabb1374c006e889b79eef64ce0386b8f8a41"
    },
    "nodes": [
      {
        "id": "0f86ab8c-2915-4d0a-b2fd-802c3740053b",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1080,
          700
        ],
        "parameters": {
          "jsonSchemaExample": "{\n    \"result\": \"extracted value(s)\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "bb283c5b-77b7-4b19-8834-8d67a3d93cb9",
        "name": "Get HTML from source url",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          480,
          500
        ],
        "parameters": {
          "url": "={{ $json['Source URL'] }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "6d2fe6d0-8d0a-466e-8550-b3a7fa79ab06",
        "name": "Data Extractor LLM Chain",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          900,
          500
        ],
        "parameters": {
          "text": "=Your task is to extract the exact information specified by the user.\n\nUser’s extraction request:\n\"{{ $('Web Scraper form submission').item.json['Data to extract'] }}\"\n\nRules:\n1. Extract ONLY the requested information.\n2. If multiple matches exist, combine them into a single string separated by commas.\n3. Do NOT add explanations or extra text—output only the extracted data.\n4. Maintain the original values unless formatting is requested.\n5. If no matches are found, return: { \"result\": \"No data found\" }.\n6. Always return the response in this format:\n{\n    \"result\": \"extracted value(s)\"\n}\n\nHere is the source data:\n{{ $json.body }}\n",
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.6
      },
      {
        "id": "1913ba31-fd5a-44ee-baa7-98d4346d6dd4",
        "name": "Gmail - Send Result",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1320,
          500
        ],
        "webhookId": "fa29cdcc-e8e9-449a-a6a4-88a874e2a0c5",
        "parameters": {
          "sendTo": " template_data_extactor_replace_me@yopmail.com",
          "message": "=Your web scraping task has been completed.\n\nSource URL:\n{{ $('Web Scraper form submission').item.json['Source URL'] }}\n\nData Requested:\n{{ $('Web Scraper form submission').item.json['Data to extract'] }}\n\nExtracted Result:\n{{ $json.output.result }}\n\nThank you for using our web scraping automation.",
          "options": {
            "appendAttribution": false
          },
          "subject": "=✅ Web Scraping Result for {{ $('Web Scraper form submission').item.json['Source URL'] }}",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "CeBpTZBQSAMKVKJY",
            "name": "Gmail account (Billy Email 2)"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "acb22cbf-9f79-49c4-8f5f-05a951b27f9c",
        "name": "Web Scraper form submission",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          280,
          500
        ],
        "webhookId": "a757a352-5ab2-4fa7-a8ee-08bb5d3448cc",
        "parameters": {
          "options": {},
          "formTitle": "Web Scraper Form",
          "formFields": {
            "values": [
              {
                "fieldLabel": "Source URL"
              },
              {
                "fieldLabel": "Data to extract"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "4e206df0-7b3f-4303-a6a4-ddcd73fb6bf9",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -320,
          420
        ],
        "parameters": {
          "color": 4,
          "width": 500,
          "height": 360,
          "content": "## SETUP REQUIRED\n\nWorkflow Configurations:\n- Update the email recipient in the Gmail node (currently set to template_data_extactor_replace_me@yopmail.com)\n- Adjust the JSON schema in the Structured Output Parser if you need different output formats\n- Modify the LLM prompt in the Data Extractor LLM Chain based on your specific extraction requirements\n\nRequired Credentials:\n- Google Gemini API Key (Google PaLM API account)\n- Gmail Credential for sending result emails"
        },
        "typeVersion": 1
      },
      {
        "id": "d2a7d845-47dc-4986-b897-26c56232751f",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -420,
          920
        ],
        "parameters": {
          "color": 4,
          "width": 600,
          "height": 400,
          "content": "## 🔍Extract Specific Website Data with Form Input, Gemini 2.5 flash and Gmail Delivery\n\nWhat This Template Does:\n\n- Provides a web form interface for users to submit scraping requests\n- Accepts any website URL and custom data extraction requirements\n- Fetches HTML content from the specified source URL\n- Uses Google Gemini AI to intelligently extract only the requested information\n- Processes raw HTML content and returns structured JSON results\n- Automatically sends extraction results via Gmail with detailed reporting\n- Handles various data types and formats while maintaining original values unless formatting is requested\n"
        },
        "typeVersion": 1
      },
      {
        "id": "261e3806-c514-4bbc-934f-cbade5550f88",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          220,
          920
        ],
        "parameters": {
          "color": 4,
          "width": 1000,
          "height": 300,
          "content": "## 📋 WORKFLOW PROCESS OVERVIEW\n\nStep 1: 📝 Web Scraper Form Submission triggers the workflow when users submit URL and extraction requirements\nStep 2: 🌐 Get HTML from Source URL fetches the complete HTML content from the provided website\nStep 3: 🔧 HTML Extractor processes the raw HTML and extracts the body content for analysis\nStep 4: 🤖 Data Extractor LLM Chain uses Google Gemini AI to analyze content and extract only the specific data requested by the user\nStep 5: 📊 Structured Output Parser formats the AI response into clean JSON structure with standardized format\nStep 6: 📧 Gmail Send Result delivers the extraction results via email including:\n  - Original source URL\n  - Data extraction request details  \n  - Clean extracted results\n  - Professional formatting with success confirmation"
        },
        "typeVersion": 1
      },
      {
        "id": "690951dd-5be4-4e54-b86f-669c2ee51de8",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          820,
          320
        ],
        "parameters": {
          "color": 4,
          "width": 400,
          "height": 560,
          "content": "## Data Extractor LLM Chain  \nThis is where we extract the content based on the user request  \n\nConfiguration:  \nYou can update the prompt and the model here to adjust to your use case.  \n"
        },
        "typeVersion": 1
      },
      {
        "id": "1240b386-bbce-4d44-afe9-748783e457ab",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1240,
          340
        ],
        "parameters": {
          "color": 4,
          "width": 260,
          "height": 340,
          "content": "## Gmail - Send Results  \n\nConfiguration:  \nUpdate the target email  \nUpdate the email subject and body  \n"
        },
        "typeVersion": 1
      },
      {
        "id": "ddc340d6-9e3c-4326-90cc-e1b06aa3c752",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          880,
          700
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "gdaO8lU3HwsldifM",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "abb31cf4-2d1a-426b-a42d-821729c15f7b",
        "name": "HTML Extractor",
        "type": "n8n-nodes-base.html",
        "position": [
          660,
          500
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "extractionValues": {
            "values": [
              {
                "key": "body",
                "cssSelector": "body"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "f08e9aaa-344c-4791-8a34-2df6aadcbf83",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1540,
          140
        ],
        "parameters": {
          "color": 4,
          "width": 380,
          "height": 760,
          "content": "# 👋 Hi, I’m Billy\n![My Photo](https://i.ibb.co/Gvn63Bzc/Billy-Christi-AI-Automation.jpg)\nI help businesses build **n8n workflows** & **AI automation projects**.  \nNeed help with n8n or AI Automation projects? \nContact me and let’s build your automation together.\n\n📩 **Email:** billychartanto@gmail.com  \n🤝 **n8n Creator:** [n8n.io/creators/billy](https://n8n.io/creators/billy/)\n🌐 **My n8n Projects:** [billychristi.com/n8n](https://www.billychristi.com/n8n)  \n\n\n\n---\n💡 Feel free to get in touch if you’d like help on your next automation project or if you have any feedback or thoughts to share.\n"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "HTML Extractor": {
        "main": [
          [
            {
              "node": "Data Extractor LLM Chain",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Data Extractor LLM Chain": {
        "main": [
          [
            {
              "node": "Gmail - Send Result",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get HTML from source url": {
        "main": [
          [
            {
              "node": "HTML Extractor",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Data Extractor LLM Chain",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Data Extractor LLM Chain",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Web Scraper form submission": {
        "main": [
          [
            {
              "node": "Get HTML from source url",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "nkMjcOC4hpte1a0t",
    "meta": {
      "instanceId": "3986dc65ca3ddc4ee46e71fc194b0a9d4ef46d960a5e71624f9f7eaa198213cb",
      "templateCredsSetupCompleted": true
    },
    "name": "Extract spend details (template)",
    "tags": [
      {
        "id": "9mCuuNEpnYNvVzb8",
        "name": "Finance",
        "createdAt": "2024-09-15T07:22:30.749Z",
        "updatedAt": "2024-09-15T07:22:30.749Z"
      }
    ],
    "nodes": [
      {
        "id": "8e1e0861-9f06-4fe2-a9c1-423bab246959",
        "name": "Get invoice",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          600,
          380
        ],
        "parameters": {
          "simple": false,
          "filters": {
            "labelIds": [
              "Label_7885838942566773656"
            ]
          },
          "options": {
            "downloadAttachments": true
          },
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "fegneFqi8XJX3NJH",
            "name": "Gmail account (hana@hanamizuki.tw)"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "364fe355-672a-4074-800a-a7496c4fb1b2",
        "name": "Get payment",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          600,
          580
        ],
        "parameters": {
          "simple": false,
          "filters": {
            "labelIds": [
              "Label_371722915607774622"
            ]
          },
          "options": {
            "downloadAttachments": true
          },
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "fegneFqi8XJX3NJH",
            "name": "Gmail account (hana@hanamizuki.tw)"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "e3218faf-2486-46e0-bf43-3bc52927e2bd",
        "name": "Extract invoice",
        "type": "n8n-nodes-base.extractFromFile",
        "notes": "No attachements",
        "onError": "continueRegularOutput",
        "position": [
          820,
          380
        ],
        "parameters": {
          "options": {
            "password": "E223706995"
          },
          "operation": "pdf",
          "binaryPropertyName": "attachment_0"
        },
        "typeVersion": 1
      },
      {
        "id": "3772b3dc-7601-4005-9b61-263b2c1abd5f",
        "name": "Extract payment",
        "type": "n8n-nodes-base.extractFromFile",
        "notes": "No attachements",
        "onError": "continueRegularOutput",
        "position": [
          820,
          580
        ],
        "parameters": {
          "options": {
            "password": "E223706995"
          },
          "operation": "pdf",
          "binaryPropertyName": "attachment_0"
        },
        "typeVersion": 1
      },
      {
        "id": "10d57038-940e-47aa-84ea-3850f61ac757",
        "name": "HTML",
        "type": "n8n-nodes-base.html",
        "notes": "\".spend-table\" here is an example when the email use \"spend\" html tags to display each spends.\ne.g.\n<div class=spend-table>Spend 1</div>\n<div class=spend-table>Spend 2</div>",
        "position": [
          1440,
          200
        ],
        "parameters": {
          "options": {},
          "operation": "extractHtmlContent",
          "dataPropertyName": "=html",
          "extractionValues": {
            "values": [
              {
                "key": "spend",
                "cssSelector": ".spend-table",
                "returnArray": true
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "dae6d22e-587d-4102-b006-20a341ede5ee",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1660,
          200
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "spend"
        },
        "typeVersion": 1
      },
      {
        "id": "0d75443d-0d23-4120-95e5-b3128a760fb4",
        "name": "Structured Output Parser1",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2500,
          640
        ],
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"title\": \"Expense Record Schema\",\n  \"description\": \"Schema used to parse expense record emails, including date, service name, transaction details, amount, category, currency, and card.\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"date\": {\n      \"type\": \"string\",\n      \"description\": \"Transaction date, can refer to the email date or the consumption date within the content. If there are multiple dates, use the earliest one. The format is 'YYYY-MM-DD hh:mm', e.g., '2024-09-02 10:12'.\",\n      \"examples\": [\"2024-09-02 10:12\"]\n    },\n    \"service\": {\n      \"type\": [\"string\", \"null\"],\n      \"description\": \"Name of the service or store, such as 'GOOGLE', 'Uber', etc.\",\n      \"examples\": [\"GOOGLE\", \"Uber Eats\", \"Uber\", \"CLAUDE.AI\"]\n    },\n    \"details\": {\n      \"type\": [\"string\", \"null\"],\n      \"description\": \"Detailed transaction information, such as overseas card usage, online transactions, restaurant names, or consumption details. If none, can be left blank or null.\",\n      \"examples\": [\"Uber: from Fuxing North Road to Minquan East Road\", \"Restaurant name\", null]\n    },\n    \"amount\": {\n      \"type\": \"number\",\n      \"description\": \"Transaction amount. If in USD, keep two decimal places (e.g., 50.12); if in TWD, use integers (e.g., 550).\",\n      \"examples\": [50.12, 550]\n    },\n    \"category\": {\n      \"type\": \"string\",\n      \"description\": \"Transaction category\",\n      \"enum\": [\"Food & Beverage\", \"Transportation\", \"Daily Necessities\", \"Housing\", \"Electronics\", \"Beauty & Hair\", \"Apparel & Accessories\", \"Medical & Healthcare\", \"Pets\", \"Education\", \"Entertainment\", \"Cloud Services\", \"Automobile\", \"Gifts\", \"Family Care\", \"Counseling\", \"Insurance\", \"Taxes\", \"Transfer Fees\", \"Music\", \"Fitness\", \"Travel\", \"Lending\", \"Donations\", \"Advertising\", \"Finance\"],\n      \"examples\": [\"Food & Beverage\", \"Transportation\"]\n    },\n    \"currency\": {\n      \"type\": \"string\",\n      \"description\": \"Currency code used in the transaction. If the amount starts with NT$, then currency is TWD.\",\n      \"enum\": [\"TWD\", \"USD\", \"JPY\", \"EUR\", \"SGD\"],\n      \"examples\": [\"USD\", \"TWD\"]\n    },\n    \"card\": {\n      \"type\": [\"string\", \"null\"],\n      \"description\": \"Credit card used for the transaction.\",\n      \"enum\": [\"HSBC 3088\", \"HSBC 3854\", \"Fubon Card\", \"Crypto.com Card\", \"Cathay Card\", null],\n      \"examples\": [\"HSBC 3088\", \"HSBC 3854\"]\n    }\n  },\n  \"required\": [\"date\", \"amount\", \"category\", \"currency\"]\n}\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "7ade499c-015b-4903-8129-6c135264bf75",
        "name": "Google Gemini Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          2320,
          640
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-1.5-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "QR3KfTwhKpbgAGWU",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "10fe4a38-139b-4284-9e86-dd36e472f59e",
        "name": "Send",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2740,
          480
        ],
        "parameters": {
          "columns": {
            "value": {
              "date": "={{ $json.output.date }}",
              "amount": "={{ $json.output.amount }}",
              "source": "n8n",
              "details": "={{ $json.output.details }}",
              "payment": "={{ $json.output.card }}",
              "service": "={{ $json.output.service }}",
              "category": "={{ $json.output.category }}",
              "currency": "={{ $json.output.currency }}"
            },
            "schema": [
              {
                "id": "date",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "service",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "service",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "details",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "details",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "amount",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "amount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "category",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "category",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "currency",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "currency",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "payment",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "payment",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "source",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "source",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": []
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 2071031170,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ccwhQeUSUkINccAucC6_clRyNF5Mw4IjIxAtcH4ftIs/edit#gid=2071031170",
            "cachedResultName": "raw data 2"
          },
          "documentId": {
            "__rl": true,
            "mode": "url",
            "value": "https://docs.google.com/spreadsheets/d/1ccwhQeUSUkINccAucC6_clRyNF5Mw4IjIxAtcH4ftIs/edit?gid=370005862#gid=370005862"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "flAcWUeyvdjh7MiW",
            "name": "Google Sheets account: hana@hanamizuki.tw (GCP: n8n)"
          }
        },
        "retryOnFail": true,
        "typeVersion": 4.5
      },
      {
        "id": "87ab4932-aae5-4c5a-a175-c782bebdf781",
        "name": "Set data 0",
        "type": "n8n-nodes-base.set",
        "position": [
          1860,
          200
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "75b16672-71cf-4157-bcb6-683099ff1620",
                "name": "email_date",
                "type": "string",
                "value": "={{ $('Switch').item.json.date }}"
              },
              {
                "id": "3298f680-5d17-42fd-8b41-a6ca621af37d",
                "name": "email_subject",
                "type": "string",
                "value": "={{ $('Switch').item.json.subject }}"
              },
              {
                "id": "cf7181b7-fef9-437a-8bbe-cd4a4eda85b8",
                "name": "email_content",
                "type": "string",
                "value": "={{ $ifEmpty($json.spend, $ifEmpty( $json.text, $json.html)) }}"
              },
              {
                "id": "1a524cb4-6975-4d45-ac0e-f1ac1f9b0417",
                "name": "email_type",
                "type": "number",
                "value": "=0"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "c2829f41-1e3f-40bc-8d4b-9fd1bac41381",
        "name": "Set data 1",
        "type": "n8n-nodes-base.set",
        "position": [
          1660,
          440
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "75b16672-71cf-4157-bcb6-683099ff1620",
                "name": "email_date",
                "type": "string",
                "value": "={{ $json.date }}"
              },
              {
                "id": "3298f680-5d17-42fd-8b41-a6ca621af37d",
                "name": "email_subject",
                "type": "string",
                "value": "={{ $json.subject }}"
              },
              {
                "id": "cf7181b7-fef9-437a-8bbe-cd4a4eda85b8",
                "name": "email_content",
                "type": "string",
                "value": "={{ $ifEmpty( $json.text, $json.html) }}"
              },
              {
                "id": "1a524cb4-6975-4d45-ac0e-f1ac1f9b0417",
                "name": "email_type",
                "type": "number",
                "value": "=1"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "ecf9ea3c-3f34-43ef-b101-ca4a420e4c24",
        "name": "Set data 2",
        "type": "n8n-nodes-base.set",
        "position": [
          1640,
          740
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "75b16672-71cf-4157-bcb6-683099ff1620",
                "name": "email_date",
                "type": "string",
                "value": "={{ $json.date }}"
              },
              {
                "id": "3298f680-5d17-42fd-8b41-a6ca621af37d",
                "name": "email_subject",
                "type": "string",
                "value": "={{ $json.subject }}"
              },
              {
                "id": "cf7181b7-fef9-437a-8bbe-cd4a4eda85b8",
                "name": "email_content",
                "type": "string",
                "value": "={{ $ifEmpty( $json.text, $json.html) }}"
              },
              {
                "id": "1a524cb4-6975-4d45-ac0e-f1ac1f9b0417",
                "name": "email_type",
                "type": "number",
                "value": "=2"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "0d9f8bde-af54-480c-bdc9-15cd5b0e6f28",
        "name": "Invoice data",
        "type": "n8n-nodes-base.set",
        "position": [
          1040,
          380
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "ac7c18ba-1944-4019-aa85-03d7751a7e1c",
                "name": "html",
                "type": "string",
                "value": "={{ $('Get invoice').item.json.html }}"
              },
              {
                "id": "5eb54501-9c55-437d-9918-e5eff92e2229",
                "name": "subject",
                "type": "string",
                "value": "={{ $('Get invoice').item.json.subject }}"
              },
              {
                "id": "87eebc48-0b95-46ae-b41b-b6540b1afaa9",
                "name": "date",
                "type": "string",
                "value": "={{ $('Get invoice').item.json.date }}"
              },
              {
                "id": "c6b75367-239e-4e88-9e17-90ee75a064e2",
                "name": "text",
                "type": "string",
                "value": "={{ $('Get invoice').item.json.text }} \\n {{ $json.text }}"
              },
              {
                "id": "7d5b4b42-6b90-4ffe-ab8f-4288771d1302",
                "name": "label",
                "type": "string",
                "value": "={{ $('Get invoice').item.json.labelIds }}"
              },
              {
                "id": "551ea1c3-01ca-4615-9d52-a880e24252ed",
                "name": "from",
                "type": "string",
                "value": "={{ $('Get invoice').item.json.from.text }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "c1c4c490-d7a9-4b16-a81b-a338103764b6",
        "name": "Payment data",
        "type": "n8n-nodes-base.set",
        "position": [
          1040,
          580
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "ac7c18ba-1944-4019-aa85-03d7751a7e1c",
                "name": "html",
                "type": "string",
                "value": "={{ $('Get payment').item.json.html }}"
              },
              {
                "id": "5eb54501-9c55-437d-9918-e5eff92e2229",
                "name": "subject",
                "type": "string",
                "value": "={{ $('Get payment').item.json.subject }}"
              },
              {
                "id": "87eebc48-0b95-46ae-b41b-b6540b1afaa9",
                "name": "date",
                "type": "string",
                "value": "={{ $('Get payment').item.json.date }}"
              },
              {
                "id": "c6b75367-239e-4e88-9e17-90ee75a064e2",
                "name": "text",
                "type": "string",
                "value": "={{ $('Get payment').item.json.text }} \\n {{ $json.text }}"
              },
              {
                "id": "7d5b4b42-6b90-4ffe-ab8f-4288771d1302",
                "name": "label",
                "type": "string",
                "value": "={{ $('Get payment').item.json.labelIds }}"
              },
              {
                "id": "2c976be1-48b8-42fa-b1c9-2fd315da89ae",
                "name": "from",
                "type": "string",
                "value": "={{ $('Get payment').item.json.from.text }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "01c5a934-9412-4ef9-81a8-c4aef19c8868",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          1300,
          480
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Multiple payment info in one mail",
                "conditions": {
                  "options": {
                    "version": 1,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      },
                      "leftValue": "={{ $json.from }}",
                      "rightValue": "service@pxbillrc01.cathaybk.com.tw"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "One payment info in one mail",
                "conditions": {
                  "options": {
                    "version": 1,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "47e3b84f-903c-4594-9297-785cfbea0316",
                      "operator": {
                        "type": "string",
                        "operation": "regex"
                      },
                      "leftValue": "={{ $json.from }}",
                      "rightValue": "\\b(?:noreply@messaging\\.hsbc\\.com\\.tw|hello@crypto\\.com|taipeifubon\\.com\\.tw)\\b"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Invoices",
                "conditions": {
                  "options": {
                    "version": 1,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "db9d40f1-8fa4-4908-9010-985072b3f319",
                      "operator": {
                        "type": "string",
                        "operation": "notRegex"
                      },
                      "leftValue": "={{ $json.from }}",
                      "rightValue": "\\b(?:noreply@messaging\\.hsbc\\.com\\.tw|hello@crypto\\.com|taipeifubon\\.com\\.tw)\\b"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "executeOnce": false,
        "typeVersion": 3.1,
        "alwaysOutputData": false
      },
      {
        "id": "250bbd9a-3d22-4a04-910c-7cec437b3c33",
        "name": "Groq Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
        "position": [
          2320,
          1120
        ],
        "parameters": {
          "model": "llama-3.2-11b-text-preview",
          "options": {}
        },
        "credentials": {
          "groqApi": {
            "id": "vaG2nZFaKeQarQHw",
            "name": "Groq account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "b8d2b2fc-748c-43c5-a82b-d5e7357bbef8",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2520,
          1120
        ],
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"title\": \"Transaction Record Schema\",\n  \"description\": \"Schema for parsing transaction record emails, including date, service name, transaction details, amount, category, currency, and card.\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"date\": {\n      \"type\": \"string\",\n      \"description\": \"Transaction date, can refer to email date or transaction date in content. If multiple dates exist, use the earliest date. Format is 'YYYY-MM-DD hh:mm', e.g., '2024-09-02 10:12'.\",\n      \"examples\": [\"2024-09-02 10:12\"]\n    },\n    \"service\": {\n      \"type\": [\"string\", \"null\"],\n      \"description\": \"Name of service or store, e.g., 'GOOGLE', 'Uber', etc.\",\n      \"examples\": [\"GOOGLE\", \"Uber Eats\", \"Uber\", \"CLAUDE.AI\"]\n    },\n    \"details\": {\n      \"type\": [\"string\", \"null\"],\n      \"description\": \"Detailed transaction information, such as overseas purchase, online purchase, restaurant name, or consumption details. Can be empty or null if not available.\",\n      \"examples\": [\"Uber: From Fuxing North Road to Minquan East Road\", \"Restaurant name\", null]\n    },\n    \"amount\": {\n      \"type\": \"number\",\n      \"description\": \"Transaction amount. For USD, keep two decimal places (e.g., 50.12); for TWD, use integers (e.g., 550).\",\n      \"examples\": [50.12, 550]\n    },\n    \"category\": {\n      \"type\": \"string\",\n      \"description\": \"Transaction category\",\n      \"enum\": [\"Food & Beverage\", \"Transportation\", \"Daily Necessities\", \"Housing\", \"Electronics\", \"Beauty & Hair\", \"Clothing & Accessories\", \"Healthcare\", \"Pets\", \"Education\", \"Entertainment\", \"Cloud Services\", \"Automotive\", \"Gifts\", \"Family Support\", \"Counseling\", \"Insurance\", \"Taxes\", \"Transfer Fee\", \"Music\", \"Fitness\", \"Travel\", \"Lending\", \"Donations\", \"Advertising\", \"Finance\"],\n      \"examples\": [\"Food & Beverage\", \"Transportation\"]\n    },\n    \"currency\": {\n      \"type\": \"string\",\n      \"description\": \"Currency code used for the transaction, if amount starts with NT$, currency is TWD.\",\n      \"enum\": [\"TWD\", \"USD\", \"JPY\", \"EUR\", \"SGD\"],\n      \"examples\": [\"USD\", \"TWD\"]\n    }\n  },\n  \"required\": [\"date\", \"amount\", \"category\", \"currency\"]\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "39b10715-54fe-4c07-9ca1-afbe43ae519e",
        "name": "Send1",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2740,
          900
        ],
        "parameters": {
          "columns": {
            "value": {
              "date": "={{ $json.output.date }}",
              "amount": "={{ $json.output.amount }}",
              "source": "n8n",
              "details": "={{ $json.output.details }}",
              "payment": "=",
              "service": "={{ $json.output.service }}",
              "category": "={{ $json.output.category }}",
              "currency": "={{ $json.output.currency }}"
            },
            "schema": [
              {
                "id": "date",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "service",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "service",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "details",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "details",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "amount",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "amount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "category",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "category",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "currency",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "currency",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "payment",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "payment",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "source",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "source",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": []
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 2071031170,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ccwhQeUSUkINccAucC6_clRyNF5Mw4IjIxAtcH4ftIs/edit#gid=2071031170",
            "cachedResultName": "raw data 2"
          },
          "documentId": {
            "__rl": true,
            "mode": "url",
            "value": "https://docs.google.com/spreadsheets/d/1ccwhQeUSUkINccAucC6_clRyNF5Mw4IjIxAtcH4ftIs/edit?gid=370005862#gid=370005862"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "flAcWUeyvdjh7MiW",
            "name": "Google Sheets account: hana@hanamizuki.tw (GCP: n8n)"
          }
        },
        "retryOnFail": true,
        "typeVersion": 4.5
      },
      {
        "id": "112f5198-871e-42f9-9376-5fa074497413",
        "name": "Extract details1",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          2320,
          900
        ],
        "parameters": {
          "text": "=Email Date: {{ $json.email_date }}\nEmail Subject: {{ $json.email_subject }}\nEmail Content:\n{{ $json.email_content }}",
          "messages": {
            "messageValues": [
              {
                "message": "=Please analyze the following email to extract transaction details for bookkeeping purposes.\n\nPlease extract relevant transaction details such as transaction date, amount, merchant name, and any other pertinent information, and provide them in a structured format suitable for accounting records."
              }
            ]
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "retryOnFail": true,
        "typeVersion": 1.4
      },
      {
        "id": "b9c3cb29-e68e-4ae0-8930-185c17bc6cab",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          2060,
          440
        ],
        "parameters": {},
        "typeVersion": 3
      },
      {
        "id": "b50d632c-b762-4f61-b34a-91f941100668",
        "name": "Extract details",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          2320,
          480
        ],
        "parameters": {
          "text": "=Email Date: {{ $json.email_date }}\nEmail Subject: {{ $json.email_subject }}\nEmail Content:\n{{ $json.email_content }}\nEmail Source: {{ $json.email_type }}",
          "messages": {
            "messageValues": [
              {
                "message": "=Please analyze the following email to extract transaction details for bookkeeping purposes. The \"Email Source\" field indicates the origin of the email, where 0 represents Cathay Bank card statements and 1 represents other credit card statements.\n\nPlease extract relevant transaction details such as transaction date, amount, merchant name, and any other pertinent information, and provide them in a structured format suitable for accounting records."
              }
            ]
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "retryOnFail": true,
        "typeVersion": 1.4
      },
      {
        "id": "7a7e2e36-a8b6-48dc-ad57-2f5eea691285",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          500,
          220
        ],
        "parameters": {
          "width": 720,
          "height": 560,
          "content": "# A. Get data\n- Set up labels in Gmail\n- Suggested using Gmail filters to move emails to labels automatically"
        },
        "typeVersion": 1
      },
      {
        "id": "108becad-1a7b-4409-9cb3-36a1c7b64786",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1280,
          -20
        ],
        "parameters": {
          "width": 920,
          "height": 960,
          "content": "# B. Deal with the data\n1. Multiple payment info in one mail: input the \"sender\" of the emails that contain more than one payment info. e.g. credit card daily spend notification\n2. One payment info in one mail: input the \"sender\" of the emails that contain only one payment info. e.g. instant credit card spend notification\n3. Invoices: input the mails that contain one invoice in one mail"
        },
        "typeVersion": 1
      },
      {
        "id": "7123f576-87f9-4df1-ae24-f3e5289c7234",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2240,
          320
        ],
        "parameters": {
          "width": 840,
          "height": 980,
          "content": "# C. Get spend details and send to google sheet\n- Edit the output schema to fit your google sheet format\n- Edit the prompt to fit your needs"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "callerPolicy": "workflowsFromSameOwner",
      "executionOrder": "v1",
      "saveManualExecutions": true,
      "saveExecutionProgress": true
    },
    "versionId": "211d9ccc-7a66-41c8-bda1-eacde400eeff",
    "connections": {
      "HTML": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "Extract details",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "HTML",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Set data 1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Set data 2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Set data 0",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set data 0": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set data 1": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Set data 2": {
        "main": [
          [
            {
              "node": "Extract details1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get invoice": {
        "main": [
          [
            {
              "node": "Extract invoice",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get payment": {
        "main": [
          [
            {
              "node": "Extract payment",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Invoice data": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Payment data": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract details": {
        "main": [
          [
            {
              "node": "Send",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract invoice": {
        "main": [
          [
            {
              "node": "Invoice data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract payment": {
        "main": [
          [
            {
              "node": "Payment data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Groq Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Extract details1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Extract details1": {
        "main": [
          [
            {
              "node": "Send1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Extract details1",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Extract details",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "Extract details",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "a397be88f6137f5f2e86ea5f8ed0975d4e50e0a5b9d854b590233ba59fda60da",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "9db0da1b-8007-4d83-9c20-b321e536ce40",
        "name": "searchPeriod",
        "type": "n8n-nodes-base.set",
        "position": [
          1680,
          420
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "0b297449-7eb1-4a02-adff-7c1c82888532",
                "name": "startDay",
                "type": "string",
                "value": "={{$now.plus({ days: -30 }).toFormat('yyyy-MM-dd')}}"
              },
              {
                "id": "c85e7afa-0a73-473f-a7ae-93b88db7a717",
                "name": "endDay",
                "type": "string",
                "value": "={{$now.toFormat('yyyy-MM-dd')}}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "47a8c0a7-9eac-4406-90c0-3e27962df533",
        "name": "getOrderDoLoop",
        "type": "n8n-nodes-base.graphql",
        "position": [
          1940,
          420
        ],
        "parameters": {
          "query": "={\n  orders(\n    first: 250\n    {{ $json.data.orders.pageInfo.endCursor ? ', after: \"' + $json.data.orders.pageInfo.endCursor + '\"' : '' }}\n    query: \"created_at:>={{ $('searchPeriod').item.json.startDay }} AND created_at:<={{ $('searchPeriod').item.json.endDay }}\"\n  ) {\n    edges {\n      node {\n        id\n        createdAt\n        lineItems(first: 250) {\n          edges {\n            node {\n              product {\n                title\n                vendor\n              }\n              quantity\n              originalUnitPriceSet {\n                shopMoney {\n                  amount\n                  currencyCode\n                }\n              }\n              variant {\n                title\n              }\n              sku\n            }\n          }\n        }\n      }\n    }\n    pageInfo {\n      hasNextPage\n      endCursor\n    }\n  }\n}\n",
          "endpoint": "https://lokal-eg.myshopify.com/admin/api/2025-01/graphql.json",
          "authentication": "headerAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "b0e5x9SPGRFYPWqx",
            "name": "Shopify Header Token"
          }
        },
        "notesInFlow": false,
        "retryOnFail": true,
        "typeVersion": 1.1,
        "waitBetweenTries": 5000
      },
      {
        "id": "ee8fefc3-608e-4700-a46c-6d82dcac91c0",
        "name": "is hasNextPage = true",
        "type": "n8n-nodes-base.if",
        "position": [
          2160,
          420
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "94cefe62-8334-438a-83d9-9cbde31ae72c",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.data.orders.pageInfo.hasNextPage }}",
                "rightValue": "true"
              }
            ]
          }
        },
        "retryOnFail": true,
        "typeVersion": 2.2
      },
      {
        "id": "fbd86310-fbe4-4033-884b-6936d70f6fc2",
        "name": "groupItemListbyVendor",
        "type": "n8n-nodes-base.code",
        "position": [
          2420,
          440
        ],
        "parameters": {
          "jsCode": "// Gather all executions from getOrderDoLoop\nlet allOrders = [];\nlet counter = 0;\nwhile (true) {\n  try {\n    const items = $items(\"getOrderDoLoop\", 0, counter);\n    allOrders.push(...items);\n  } catch (e) {\n    break;\n  }\n  counter++;\n}\n\n// Flatten all line items into array\nconst allLineItems = [];\nfor (const item of allOrders) {\n  const edges = item.json.data.orders.edges || [];\n  for (const order of edges) {\n    const orderId = order.node.id.replace(\"gid://shopify/Order/\", \"\");\n    const orderDate = order.node.createdAt.split(\"T\")[0];\n    const lineItems = order.node.lineItems.edges;\n    for (const li of lineItems) {\n      allLineItems.push({\n        order_id: orderId,\n        order_date: orderDate,\n        product_title: li.node.product?.title || \"\",\n        vendor: li.node.product?.vendor || \"\",\n        sku: li.node.sku || \"\",\n        variant_name: li.node.variant?.title || \"\",\n        quantity: li.node.quantity || 0,\n        price: li.node.originalUnitPriceSet?.shopMoney?.amount || 0,\n        currency: li.node.originalUnitPriceSet?.shopMoney?.currencyCode || \"\"\n      });\n    }\n  }\n}\n\n// Group by SKU for summary (optional, comment out to send every line)\nconst summary = {};\nfor (const row of allLineItems) {\n  if (!row.sku) continue;\n  if (!summary[row.sku]) {\n    summary[row.sku] = {\n      SKU: row.sku,\n      Title: row.product_title,\n      Brand: row.vendor,\n      total_quantity_sold: 0,\n      total_sales: 0\n    };\n  }\n  summary[row.sku].total_quantity_sold += row.quantity;\n  summary[row.sku].total_sales += row.quantity * parseFloat(row.price);\n}\n\nreturn Object.values(summary).map(row => ({json: row}));\n"
        },
        "typeVersion": 2
      },
      {
        "id": "9c26334c-36b7-4d6d-9c8b-78ec9b362382",
        "name": "Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2640,
          440
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "Brand",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Brand",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "SKU",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "SKU",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Title",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "total_quantity_sold",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "total_quantity_sold",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "total_sales",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "total_sales",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ZEm8zyl__E59M6kD9UkvHHZTMbEWktjoH3FrYhBg6LU/edit#gid=0",
            "cachedResultName": "Dump"
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "1ZEm8zyl__E59M6kD9UkvHHZTMbEWktjoH3FrYhBg6LU"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "iBVdCEVCH3SeocwL",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "ae7b35ca-74bd-4e3b-bc06-f1758582a8c4",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          1380,
          400
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 8,
                "triggerAtMinute": 43
              }
            ]
          }
        },
        "typeVersion": 1.2
      }
    ],
    "pinData": {},
    "connections": {
      "searchPeriod": {
        "main": [
          [
            {
              "node": "getOrderDoLoop",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "getOrderDoLoop": {
        "main": [
          [
            {
              "node": "is hasNextPage = true",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "searchPeriod",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "groupItemListbyVendor": {
        "main": [
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "is hasNextPage = true": {
        "main": [
          [
            {
              "node": "getOrderDoLoop",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "groupItemListbyVendor",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "6b3e8c6c30cdfbf06283a3fa57016932c6b4ec959896c5c546ef5865ff697ff1"
    },
    "nodes": [
      {
        "id": "752a1ab6-274c-4f09-9bf1-e2dba414aaf1",
        "name": "Receive Company Request1",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -816,
          3152
        ],
        "webhookId": "get-companies-uuid",
        "parameters": {
          "path": "/api/v1/get-customers",
          "options": {},
          "responseMode": "responseNode"
        },
        "typeVersion": 2.1
      },
      {
        "id": "66762aac-2d62-4d59-9956-816476d0f92f",
        "name": "Prepare Dynamic Filter1",
        "type": "n8n-nodes-base.function",
        "position": [
          -576,
          3152
        ],
        "parameters": {
          "functionCode": "// const query = $json[\"query\"] || {}\n// const filters = []\n// if (query.name) filters.push([\"name\", \"Like\", query.name])\n// if (query.country) filters.push([\"country_code\", \"=\", query.country])\n// const limit = query.limit ? parseInt(query.limit) : 25\n// const response_format = query.response_format || 'json'\n// return [{ json: { filters, limit, response_format } }]\n\nconst query = $json[\"query\"] || {};\n\n// Validate required 'name' parameter\nif (!query.name || query.name.trim() === \"\") {\n  return [\n    {\n      json: {\n        success: false,\n        message: \"Missing required parameter: name\",\n      },\n    },\n  ];\n}\n\nconst filters = [];\nfilters.push([\"name\", \"Like\", query.name]); // name is mandatory\n\nconst response_format = query.response_format || \"json\";\n\nreturn [\n  {\n    json: { filters, response_format },\n  },\n];"
        },
        "typeVersion": 1
      },
      {
        "id": "e727d97c-678b-41b8-8db4-d1615c73a116",
        "name": "Prepare Output Data1",
        "type": "n8n-nodes-base.function",
        "position": [
          0,
          3152
        ],
        "parameters": {
          "functionCode": "if (items.length === 0 || Object.keys(items[0].json).length === 0) {\n  return [{ json: { success: false, message: 'No matching company records found' } }]\n}\nconst data = items.map(item => ({ ...item.json, report_generated_on: new Date().toISOString() }))\nreturn data.map(d => ({ json: d }))"
        },
        "typeVersion": 1
      },
      {
        "id": "9187426f-d4d0-4461-af73-3f31cdb0cc17",
        "name": "Check If Excel Required1",
        "type": "n8n-nodes-base.if",
        "position": [
          288,
          3152
        ],
        "parameters": {
          "conditions": {
            "string": [
              {
                "value1": "={{ $('Prepare Dynamic Filter1').item.json.response_format }}",
                "value2": "excel"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ed6030ad-11f0-43f6-aee5-147ee0c055de",
        "name": "Convert to Excel1",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          896,
          3104
        ],
        "parameters": {
          "options": {},
          "operation": "xlsx"
        },
        "typeVersion": 1.1
      },
      {
        "id": "0e6e1540-4c2e-45fe-a75a-6e511a95937b",
        "name": "Respond with File1",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          1216,
          3104
        ],
        "parameters": {
          "options": {},
          "respondWith": "binary"
        },
        "typeVersion": 1.4
      },
      {
        "id": "d64e68cf-c80c-4633-bc4f-614d572ca762",
        "name": "Respond with JSON1",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          1216,
          3504
        ],
        "parameters": {
          "options": {},
          "respondWith": "allIncomingItems"
        },
        "typeVersion": 1.4
      },
      {
        "id": "d2f28f28-a541-42d1-aaf8-94ab14723a53",
        "name": "Overview Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1792,
          2288
        ],
        "parameters": {
          "width": 900,
          "height": 620,
          "content": "## How it works\nThis workflow provides an API endpoint `/api/v1/get-customers` that retrieves customer contact records directly from your Odoo instance. It’s designed for teams who need to query or export customer data on demand — either in JSON for integrations or Excel (.xlsx) for reporting.\n\nWhen a request is made, the workflow:\n1. Accepts query parameters (`name`, `response_format`).\n2. Validates the name input (required for search).\n3. Fetches all matching customers (non-companies) from Odoo using an `Like` filter for partial matches.\n4. Dynamically returns either a JSON response or an Excel file download depending on the `response_format` parameter.\n\nThis makes it ideal for quick data exports\n\n\n\n## Setup steps\n1. Open the Webhook node and note the endpoint `/api/v1/get-customers`.\n2. Configure your Odoo API credentials in the Odoo node.\n3. Optionally update the `fieldsList` in the Odoo node to include more contact fields (email, city, etc.).\n4. Test using a browser or Postman:  \n   - `/api/v1/get-customers?name=Demo&response_format=json`  \n   - `/api/v1/get-customers?name=Demo&response_format=excel`"
        },
        "typeVersion": 1
      },
      {
        "id": "ad743706-da44-436c-a330-96f289469989",
        "name": "Fetch Customer",
        "type": "n8n-nodes-base.odoo",
        "position": [
          -320,
          3152
        ],
        "parameters": {
          "options": {
            "fieldsList": [
              "display_name",
              "name",
              "email",
              "phone",
              "mobile",
              "parent_id",
              "country_code",
              "country_id"
            ]
          },
          "resource": "custom",
          "operation": "getAll",
          "returnAll": true,
          "filterRequest": {
            "filter": [
              {
                "value": "={{ $json.filters[0][2] && $json.filters[0][2].toString().trim() !== '' ? $json.filters[0][2] : \"False\" }}",
                "operator": "like",
                "fieldName": "name"
              }
            ]
          },
          "customResource": "res.partner"
        },
        "credentials": {
          "odooApi": {
            "id": "rhW7JbaWT0NTawBZ",
            "name": "IMM Odoo 18"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5d55b9d2-a30b-4efd-8a22-e4d80851163a",
        "name": "Overview Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -880,
          2928
        ],
        "parameters": {
          "color": 7,
          "width": 452,
          "height": 380,
          "content": "## Request & Validation\nReceives the API request and checks for the required “name” parameter.\nReturns a validation message if missing."
        },
        "typeVersion": 1
      },
      {
        "id": "e8d5c637-2adc-4c45-ab56-81eabe9af5ee",
        "name": "Overview Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -400,
          2928
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 380,
          "content": "## Search Records from Odoo\n- Queries `res.partner` \n**Contact Table** records in Odoo using “Like” for partial matches.\n- Customize the fields in the node options if needed.\n- **Note: Name search is case-sensitive.**"
        },
        "typeVersion": 1
      },
      {
        "id": "5b009e21-3259-430b-aaf1-044e5c364eb8",
        "name": "Overview Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -96,
          2928
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 380,
          "content": "## Prepare data and manage response json object."
        },
        "typeVersion": 1
      },
      {
        "id": "af201ab6-7f0f-4806-bba1-7d9f718eeb75",
        "name": "Overview Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          208,
          2928
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 380,
          "content": "## Check response_format\nIf response_format=excel → returns a downloadable Excel file.\nOtherwise, returns JSON with company data."
        },
        "typeVersion": 1
      },
      {
        "id": "1b71d124-7d74-421c-882d-c67b6e6f9c08",
        "name": "Return all data for create binary file",
        "type": "n8n-nodes-base.code",
        "position": [
          592,
          3104
        ],
        "parameters": {
          "jsCode": "return $input.all()"
        },
        "typeVersion": 2
      },
      {
        "id": "4dab4b62-287e-48ab-851d-8f8277d4eb10",
        "name": "Overview Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          512,
          2928
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 380,
          "content": "## Prepare Data for Binary file."
        },
        "typeVersion": 1
      },
      {
        "id": "d7dccf04-2209-4638-a535-175b8207a70d",
        "name": "Overview Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          816,
          2928
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 380,
          "content": "## Create excel file"
        },
        "typeVersion": 1
      },
      {
        "id": "278e9a77-f740-4adb-8a9b-465cc48b56e2",
        "name": "Overview Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1120,
          2928
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 380,
          "content": "## Response to web-hook with excel file."
        },
        "typeVersion": 1
      },
      {
        "id": "e86f38f1-12de-4da2-99e2-f5e4cf863b27",
        "name": "Overview Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1136,
          3328
        ],
        "parameters": {
          "color": 7,
          "width": 276,
          "height": 380,
          "content": "## Response to web-hook with json object."
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Fetch Customer": {
        "main": [
          [
            {
              "node": "Prepare Output Data1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to Excel1": {
        "main": [
          [
            {
              "node": "Respond with File1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Output Data1": {
        "main": [
          [
            {
              "node": "Check If Excel Required1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Dynamic Filter1": {
        "main": [
          [
            {
              "node": "Fetch Customer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check If Excel Required1": {
        "main": [
          [
            {
              "node": "Return all data for create binary file",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Respond with JSON1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Receive Company Request1": {
        "main": [
          [
            {
              "node": "Prepare Dynamic Filter1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Return all data for create binary file": {
        "main": [
          [
            {
              "node": "Convert to Excel1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "e4ed6aca7ec6a04ffb91587fca156e9ed1c8f2857c21dcdaac3034a8a92fc2c5",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "dabf59bf-864c-47e2-8289-69fba6c42bd0",
        "name": "Look for Invoices",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          -768,
          368
        ],
        "parameters": {
          "filters": {
            "labelIds": [
              "INBOX"
            ]
          },
          "pollTimes": {
            "item": [
              {
                "mode": "everyHour"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "bf4111ad-870d-4a37-82ac-343828f3c7b9",
        "name": "Get Email Content",
        "type": "n8n-nodes-base.gmail",
        "position": [
          -544,
          368
        ],
        "webhookId": "ff36c712-7602-4705-8c29-250930ae93a7",
        "parameters": {
          "limit": 1,
          "simple": false,
          "filters": {},
          "options": {
            "downloadAttachments": true
          },
          "operation": "getAll"
        },
        "typeVersion": 2.1
      },
      {
        "id": "b5bcf67f-528a-493a-947a-c3070ebf8b66",
        "name": "Guardrail: Is Finance?",
        "type": "@n8n/n8n-nodes-langchain.guardrails",
        "position": [
          -336,
          368
        ],
        "parameters": {
          "text": "={{ $('Get Email Content').item.json.text }}",
          "guardrails": {
            "topicalAlignment": {
              "value": {
                "prompt": "=You are a financial controller AI. \n\nSCOPE:\n- The text MUST contain evidence of a financial transaction, invoice, receipt, or bill.\n- It is ON-TOPIC if it mentions payments, amounts owed, subscription renewals with prices, or attached invoices.\n- It is OFF-TOPIC if it is a newsletter, a marketing email without a specific transaction, or a personal conversation.",
                "threshold": 0.8
              }
            }
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4f653917-7633-4e1b-b3ad-726ae5824cd9",
        "name": "Configuration: User Settings",
        "type": "n8n-nodes-base.set",
        "position": [
          0,
          0
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "gSheetID",
                "value": "ENTER_YOUR_GOOGLE_SHEET_ID"
              },
              {
                "name": "adminEmailForErrors",
                "value": "your.email@example.com"
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "fdf114cb-d6f1-421d-8a54-bbbdd6a9154b",
        "name": "IF (Guardrail Passed)",
        "type": "n8n-nodes-base.if",
        "position": [
          208,
          336
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "check-aligned",
                "operator": {
                  "type": "boolean",
                  "operation": "false",
                  "singleValue": true
                },
                "leftValue": "={{ $json.checks.triggered }}",
                "rightValue": ""
              }
            ]
          },
          "looseTypeValidation": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "75c2ee44-d59d-4029-804e-14b8a365dfb2",
        "name": "Filter Finance Keywords",
        "type": "n8n-nodes-base.filter",
        "position": [
          592,
          432
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "or",
            "conditions": [
              {
                "id": "filter-invoice",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $('Get Email Content').item.json.subject }}",
                "rightValue": "Invoice"
              },
              {
                "id": "filter-receipt",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $('Get Email Content').item.json.subject }}",
                "rightValue": "Receipt"
              },
              {
                "id": "filter-bill",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $('Get Email Content').item.json.subject }}",
                "rightValue": "Bill"
              },
              {
                "id": "filter-payment",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $('Get Email Content').item.json.subject }}",
                "rightValue": "Payment Confirmation"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "92f7d2c2-9adb-4eb0-8aa0-66e1e4cfb36a",
        "name": "Check for Attachment",
        "type": "n8n-nodes-base.if",
        "position": [
          -576,
          1040
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "check-attachment",
                "operator": {
                  "type": "number",
                  "operation": "gt"
                },
                "leftValue": "={{ Object.keys($binary || {}).length }}",
                "rightValue": 0
              }
            ]
          },
          "looseTypeValidation": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "6a74d0c3-ba12-4c9a-9db2-fa2b52f12e96",
        "name": "Extract PDF Data",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          -240,
          816
        ],
        "parameters": {
          "options": {},
          "operation": "pdf",
          "binaryPropertyName": "={{ Object.keys($json.binary || {})[0] || 'attachment_0' }}"
        },
        "typeVersion": 1
      },
      {
        "id": "a09fb13e-14e1-4a55-b4af-1aba901ae6bf",
        "name": "AI Agent (PDF OCR)",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -32,
          800
        ],
        "parameters": {
          "text": "={{ $json.text }}",
          "options": {
            "systemMessage": "=You are a Financial OCR Expert. Extract invoice data from the PDF text.\n\nCRITICAL INSTRUCTIONS:\n1. Return ONLY a JSON object.\n2. Normalize dates to YYYY-MM-DD.\n3. Clean currency symbols from amounts (return numbers).\n\nREQUIRED JSON STRUCTURE:\n{\n  \"vendor_name\": \"string\",\n  \"invoice_date\": \"YYYY-MM-DD\",\n  \"invoice_id\": \"string\",\n  \"total_amount\": number,\n  \"tax_amount\": number,\n  \"currency\": \"USD/EUR/GBP\",\n  \"items_summary\": \"string (brief description)\",\n  \"vendor_tax_id\": \"string or null\"\n}"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9,
        "continueOnFail": true
      },
      {
        "id": "2a0195e7-aa9d-460f-8a91-9752b80a3005",
        "name": "AI Agent (Email OCR)",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -32,
          1088
        ],
        "parameters": {
          "text": "={{ $('Get Email Content').item.json.text }}",
          "options": {
            "systemMessage": "=You are a Financial OCR Expert. Extract receipt data from the email body text.\n\nCRITICAL INSTRUCTIONS:\n1. Return ONLY a JSON object.\n2. Normalize dates to YYYY-MM-DD.\n3. Clean currency symbols from amounts (return numbers).\n\nREQUIRED JSON STRUCTURE:\n{\n  \"vendor_name\": \"string\",\n  \"invoice_date\": \"YYYY-MM-DD\",\n  \"invoice_id\": \"string (or 'EMAIL-RECEIPT' if missing)\",\n  \"total_amount\": number,\n  \"tax_amount\": number,\n  \"currency\": \"USD/EUR/GBP\",\n  \"items_summary\": \"string (brief description)\",\n  \"vendor_tax_id\": \"string or null\"\n}"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9,
        "continueOnFail": true
      },
      {
        "id": "59761143-4f1a-42a4-b3e7-acad993d9858",
        "name": "Validate Extraction",
        "type": "n8n-nodes-base.code",
        "position": [
          528,
          992
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "// Check if AI extraction succeeded\nif ($json.error) {\n\treturn {\n\t\tjson: {\n\t\t\terror_occurred: true,\n\t\t\terror_type: \"AI_EXTRACTION_FAILED\",\n\t\t\terror_message: $json.error.message || \"AI extraction failed\",\n\t\t\ttimestamp: new Date().toISOString()\n\t\t}\n\t};\n}\n\nlet data;\ntry {\n\tdata = typeof $json.output === 'string' ? JSON.parse($json.output) : $json.output;\n} catch (e) {\n\treturn {\n\t\tjson: {\n\t\t\terror_occurred: true,\n\t\t\terror_type: \"JSON_PARSE_ERROR\",\n\t\t\terror_message: e.message,\n\t\t\ttimestamp: new Date().toISOString()\n\t\t}\n\t};\n}\n\n// Validation Logic\nconst required = ['vendor_name', 'total_amount', 'invoice_date'];\nconst missing = required.filter(field => !data[field]);\n\nif (missing.length > 0) {\n\treturn {\n\t\tjson: {\n\t\t\terror_occurred: true,\n\t\t\terror_type: \"MISSING_FIELDS\",\n\t\t\terror_message: `Missing: ${missing.join(', ')}`,\n\t\t\textracted_data: data,\n\t\t\ttimestamp: new Date().toISOString()\n\t\t}\n\t};\n}\n\n// Amount Validation\nif (isNaN(parseFloat(data.total_amount))) {\n\treturn {\n\t\tjson: {\n\t\t\terror_occurred: true,\n\t\t\terror_type: \"INVALID_AMOUNT\",\n\t\t\terror_message: \"Total Amount is not a number\",\n\t\t\textracted_data: data,\n\t\t\ttimestamp: new Date().toISOString()\n\t\t}\n\t};\n}\n\nreturn {\n\tjson: {\n\t\terror_occurred: false,\n\t\tvalidated_data: data\n\t}\n};"
        },
        "typeVersion": 2
      },
      {
        "id": "c298c89e-3bf2-496c-a5eb-1cf0c5c4265a",
        "name": "Check for Errors",
        "type": "n8n-nodes-base.if",
        "position": [
          800,
          992
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "check-error",
                "operator": {
                  "type": "boolean",
                  "operation": "false"
                },
                "leftValue": "={{ $json.error_occurred }}",
                "rightValue": ""
              }
            ]
          },
          "looseTypeValidation": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "befb7153-1a70-4265-8472-0fa9acca2620",
        "name": "Apply Finance Rules",
        "type": "n8n-nodes-base.code",
        "position": [
          1040,
          672
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const data = $json.validated_data;\n\n// Business Logic for GL Coding\nlet glCategory = \"Uncategorized\";\n// Convert vendor to lowercase for easier matching\nconst vendor = (data.vendor_name || \"\").toLowerCase();\n\n// FIX 1: Added \"amazon\" to the check so it catches \"Amazon Web Services\"\nif (vendor.includes(\"aws\") || vendor.includes(\"amazon\") || vendor.includes(\"google cloud\") || vendor.includes(\"digitalocean\")) {\n\tglCategory = \"6000 - Software & Hosting\";\n} else if (vendor.includes(\"uber\") || vendor.includes(\"lyft\") || vendor.includes(\"airline\") || vendor.includes(\"flight\")) {\n\tglCategory = \"5000 - Travel & Meals\";\n} else if (vendor.includes(\"wework\") || vendor.includes(\"office\")) {\n\tglCategory = \"4000 - Rent & Utilities\";\n}\n\n// Approval Thresholds\nlet approvalStatus = \"Auto-Approved\";\n// Ensure amount is a number\nconst amount = parseFloat(data.total_amount);\n\n// FIX 2: Check the HIGHEST value first.\n// If we checked > 1000 first, 5200 would trigger that and stop.\nif (amount > 5000) {\n\tapprovalStatus = \"VP Approval Needed\";\n} else if (amount > 1000) {\n\tapprovalStatus = \"Manager Approval Needed\";\n}\n\nreturn {\n\tjson: {\n\t\t...data,\n\t\tgl_category: glCategory,\n\t\tapproval_status: approvalStatus,\n\t\tcase_id: `INV-${Date.now()}`,\n\t\tprocessed_at: new Date().toISOString()\n\t}\n};"
        },
        "typeVersion": 2
      },
      {
        "id": "9ad1658b-9257-45a7-b049-ef6bfdcc38d7",
        "name": "Log to Invoices Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1376,
          672
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "invoice_id",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "invoice_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "vendor_name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "vendor_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "invoice_date",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "invoice_date",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "total_amount",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "total_amount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "currency",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "currency",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "tax_amount",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "tax_amount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "gl_category",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "gl_category",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "approval_status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "approval_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "timestamp",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "timestamp",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "case_id",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "case_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "items_summary",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "items_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "vendor_tax_id",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "vendor_tax_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "processed_at",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "processed_at",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1260157166,
            "cachedResultUrl": "",
            "cachedResultName": "Invoices"
          },
          "documentId": {
            "__rl": true,
            "mode": "expression",
            "value": "={{ $('Configuration: User Settings').item.json.gSheetID }}"
          }
        },
        "retryOnFail": true,
        "typeVersion": 4.5,
        "waitBetweenTries": 2000
      },
      {
        "id": "9d54059e-7fc6-4954-bbc5-7f6b492a8f67",
        "name": "Send Confirmation Email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1632,
          672
        ],
        "webhookId": "92060c17-8a4f-4afc-8b1c-5989ff778e0b",
        "parameters": {
          "sendTo": "={{ $('Configuration: User Settings').item.json.adminEmailForErrors }}",
          "message": "=<html>\n<body>\n<h3>Invoice Processed Successfully</h3>\n<p><strong>Vendor:</strong> {{ $json.vendor_name }}</p>\n<p><strong>Amount:</strong> {{ $json.currency }} {{ $json.total_amount }}</p>\n<p><strong>GL Category:</strong> {{ $json.gl_category }}</p>\n<p><strong>Status:</strong> {{ $json.approval_status }}</p>\n<br>\n<p>Check the Google Sheet for details.</p>\n</body>\n</html>",
          "options": {
            "appendAttribution": false
          },
          "subject": "=💰 Invoice Processed: {{ $json.vendor_name }} - {{ $json.approval_status }}"
        },
        "typeVersion": 2.1
      },
      {
        "id": "78f48238-71b3-49e9-a492-b23f6600dcdd",
        "name": "Log Error to Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1088,
          1248
        ],
        "parameters": {
          "columns": {
            "value": {
              "timestamp": "={{ $json.timestamp }}",
              "error_type": "={{ $json.error_type }}",
              "error_message": "={{ $json.error_message }}",
              "original_subject": "={{ $('Look for Invoices').item.json.subject }}",
              "workflow_execution_id": "={{ $workflow.id }}"
            },
            "schema": [
              {
                "id": "timestamp",
                "type": "string",
                "displayName": "timestamp"
              },
              {
                "id": "error_type",
                "type": "string",
                "displayName": "error_type"
              },
              {
                "id": "error_message",
                "type": "string",
                "displayName": "error_message"
              },
              {
                "id": "original_subject",
                "type": "string",
                "displayName": "original_subject"
              },
              {
                "id": "workflow_execution_id",
                "type": "string",
                "displayName": "workflow_execution_id"
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "Error Logs",
            "cachedResultName": "Error Logs"
          },
          "documentId": {
            "__rl": true,
            "mode": "expression",
            "value": "={{ $('Configuration: User Settings').item.json.gSheetID }}"
          }
        },
        "retryOnFail": true,
        "typeVersion": 4.5,
        "waitBetweenTries": 2000
      },
      {
        "id": "bde3beda-0e4f-4d62-ba00-ab44f9d92aff",
        "name": "Send Error Notification",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1424,
          1248
        ],
        "webhookId": "9024f16d-2d54-442a-b961-cbeb25c84c22",
        "parameters": {
          "sendTo": "={{ $('Configuration: User Settings').item.json.adminEmailForErrors }}",
          "message": "=<html>\n<body>\n<h3>Workflow Failed</h3>\n<p><strong>Error:</strong> {{ $json.error_message }}</p>\n<p><strong>Original Email:</strong> {{ $json.original_subject }}</p>\n</body>\n</html>",
          "options": {},
          "subject": "=⚠️ Finance Workflow Error: {{ $json.error_type }}"
        },
        "typeVersion": 2.1
      },
      {
        "id": "7d9dd7c1-9d9a-450f-bca3-ae146cfc44f0",
        "name": "Sticky Note Guardrail",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -368,
          240
        ],
        "parameters": {
          "color": 4,
          "width": 288,
          "height": 288,
          "content": "## 1. Finance Guardrails\nUses Gemini/LangChain to detect if the email is actually a financial document."
        },
        "typeVersion": 1
      },
      {
        "id": "339c869a-f63b-438f-9d56-fcc79b62cf6d",
        "name": "Sticky Note Extraction",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -272,
          656
        ],
        "parameters": {
          "color": 5,
          "width": 480,
          "height": 608,
          "content": "## 2. Dual Extraction Path\nIf Attachment -> **PDF OCR Agent**\nIf No Attachment -> **Email Body Agent**\n\nBoth normalize data into the same JSON structure."
        },
        "typeVersion": 1
      },
      {
        "id": "b9ac3d47-1b42-4679-a4d8-d4566cdba90a",
        "name": "Sticky Note Logic",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          912,
          544
        ],
        "parameters": {
          "color": 7,
          "width": 352,
          "height": 320,
          "content": "## 3. Business Logic\n- **GL Coding**: Auto-categorizes vendors (Uber -> Travel).\n- **Thresholds**: Flags high amounts (> $1000) for approval."
        },
        "typeVersion": 1
      },
      {
        "id": "c4c483cb-489d-44dd-955b-2b9f852b40d3",
        "name": "gpt 4o mini",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -32,
          960
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {
            "temperature": 0.2,
            "responseFormat": "json_object"
          }
        },
        "notesInFlow": false,
        "typeVersion": 1.2
      },
      {
        "id": "465751b4-3b8c-4a9c-b393-41ff173d79c0",
        "name": "Gemini 2.5 flash",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -336,
          480
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "69b67a16-43f8-402f-a764-3b222e2e083f",
        "name": "Log Success Metrics",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1904,
          672
        ],
        "parameters": {
          "columns": {
            "value": {
              "amount": "={{ $('Apply Finance Rules').item.json.total_amount }}",
              "vendor": "={{ $('Apply Finance Rules').item.json.vendor_name }}",
              "case_id": "={{ $('Apply Finance Rules').item.json.case_id }}",
              "timestamp": "={{ $today }}",
              "email_sent": "Yes",
              "gl_category": "={{ $('Apply Finance Rules').item.json.gl_category }}",
              "approval_status": "={{ $('Apply Finance Rules').item.json.approval_status }}",
              "processing_time_seconds": "={{ Math.round(($execution.startedAt ? (Date.now() - new Date($execution.startedAt).getTime()) / 1000 : 0)) }}"
            },
            "schema": [
              {
                "id": "timestamp",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "timestamp",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "case_id",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "case_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "processing_time_seconds",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "processing_time_seconds",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "vendor",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "vendor",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "amount",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "amount",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "gl_category",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "gl_category",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "approval_status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "approval_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_sent",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "email_sent",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 2011163382,
            "cachedResultUrl": "",
            "cachedResultName": "Success Metrics"
          },
          "documentId": {
            "__rl": true,
            "mode": "expression",
            "value": "={{ $('Configuration: User Settings').item.json.gSheetID }}"
          }
        },
        "retryOnFail": true,
        "typeVersion": 4.5,
        "waitBetweenTries": 2000
      },
      {
        "id": "cc699a3b-f602-4f56-ad0a-60d2cc66f96d",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1344,
          176
        ],
        "parameters": {
          "width": 512,
          "height": 1216,
          "content": "## Overview\n### **[Gtaras](https://n8n.io/creators/tarasidis/)**  \n\nManual financial reconciliation is tedious and prone to error. This workflow functions as an AI Financial Controller, automatically monitoring your inbox for invoices, receipts, and bills, extracting the data using OCR, and syncing it to Google Sheets for approval.\n\nUnlike simple scrapers, this workflow uses a \"Guardrail\" AI agent to filter out non-financial emails (like newsletters) before they are processed, ensuring only actual transactions are recorded.\n\n## Who is it for?\n* **Finance Teams:** To automate the collection of vendor invoices.\n* **Freelancers:** To track expenses and receipts for tax season.\n* **Operations Managers:** To monitor budget spend and categorize costs automatically.\n\n## How it works\n1.  **Ingest:** The workflow watches a specific Gmail label (e.g., \"INBOX\") for new emails.\n2.  **Guardrail:** A Gemini-powered AI agent analyzes the email text to determine if it is a valid financial transaction. If not, the workflow stops.\n3.  **Extraction (OCR):**\n    * **If an attachment exists:** An AI Agent (GPT-4o) extracts data from the PDF.\n    * **If no attachment:** An AI Agent extracts data directly from the email body.\n4.  **Validation:** Code nodes check for missing fields or invalid amounts.\n5.  **Business Logic:** The system automatically assigns General Ledger (GL) categories (e.g., \"Uber\" -> \"Travel\") and sets approval statuses based on amount thresholds.\n6.  **Sync:** Validated data is logged to Google Sheets, and a confirmation email is sent. Errors are logged to a separate error sheet.\n\n## How to set up\n1.  **Google Sheets:** Copy [this Google Sheet template](https://docs.google.com/spreadsheets/d/1IaovDHswLKbcQdEyfw-2JSYHOVX1pLNcTIYlJQzxYGU/copy) to your drive. It contains the necessary tabs (Invoices, Error Logs, Success Metrics).\n2.  **Configure Workflow:**\n    * Open the node named **\"Configuration: User Settings\"**.\n    * Paste your Google Sheet ID (found in the URL of your new sheet).\n    * Enter the Admin Email address where you want to receive error notifications.\n3.  **Credentials:**\n    * Connect your **Gmail** account.\n    * Connect your **Google Sheets** account.\n    * Connect your **OpenAI** (for OCR) and **Google Gemini/PaLM** (for Guardrails) accounts.\n\n## Requirements\n* n8n version 1.0 or higher.\n* Gmail account.\n* OpenAI API Key.\n* Google Gemini (PaLM) API Key."
        },
        "typeVersion": 1
      },
      {
        "id": "199af4d5-b569-4220-9748-be6ebd1d9afd",
        "name": "Sticky Note21",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1024,
          1152
        ],
        "parameters": {
          "color": 2,
          "width": 640,
          "height": 304,
          "content": "## ⚠️ Error Handling Flow\n### Any failures are logged and admins are notified"
        },
        "typeVersion": 1
      },
      {
        "id": "c2cf3003-6430-4970-812e-b96ba5d98f10",
        "name": "Sticky Note17",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1792,
          608
        ],
        "parameters": {
          "color": 6,
          "width": 352,
          "height": 248,
          "content": "## 📊 Success Metrics Logger"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "gpt 4o mini": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent (PDF OCR)",
              "type": "ai_languageModel",
              "index": 0
            },
            {
              "node": "AI Agent (Email OCR)",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Check for Errors": {
        "main": [
          [
            {
              "node": "Apply Finance Rules",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Log Error to Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract PDF Data": {
        "main": [
          [
            {
              "node": "AI Agent (PDF OCR)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini 2.5 flash": {
        "ai_languageModel": [
          [
            {
              "node": "Guardrail: Is Finance?",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Get Email Content": {
        "main": [
          [
            {
              "node": "Guardrail: Is Finance?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Look for Invoices": {
        "main": [
          [
            {
              "node": "Get Email Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent (PDF OCR)": {
        "main": [
          [
            {
              "node": "Validate Extraction",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Log Error to Sheet": {
        "main": [
          [
            {
              "node": "Send Error Notification",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Apply Finance Rules": {
        "main": [
          [
            {
              "node": "Log to Invoices Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Validate Extraction": {
        "main": [
          [
            {
              "node": "Check for Errors",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent (Email OCR)": {
        "main": [
          [
            {
              "node": "Validate Extraction",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check for Attachment": {
        "main": [
          [
            {
              "node": "Extract PDF Data",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "AI Agent (Email OCR)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "IF (Guardrail Passed)": {
        "main": [
          [
            {
              "node": "Filter Finance Keywords",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Log to Invoices Sheet": {
        "main": [
          [
            {
              "node": "Send Confirmation Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Guardrail: Is Finance?": {
        "main": [
          [
            {
              "node": "Configuration: User Settings",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter Finance Keywords": {
        "main": [
          [
            {
              "node": "Check for Attachment",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Confirmation Email": {
        "main": [
          [
            {
              "node": "Log Success Metrics",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Configuration: User Settings": {
        "main": [
          [
            {
              "node": "IF (Guardrail Passed)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "bkRodBs0nMPT5cDv",
    "meta": {
      "instanceId": "2a26454b0172ffcb8d70ba77c235b1209f92cd71bf06c79ba609c7173b416d68",
      "templateCredsSetupCompleted": true
    },
    "name": "Find the Content Gaps in Your Competitors' Discourse for Market Research and SEO",
    "tags": [
      {
        "id": "MyFEaUe9Eo4t7SvF",
        "name": "SEO",
        "createdAt": "2025-05-20T13:16:17.982Z",
        "updatedAt": "2025-05-20T13:16:17.982Z"
      },
      {
        "id": "kRM0hQV2zw7VxrON",
        "name": "Research",
        "createdAt": "2025-05-21T19:44:19.136Z",
        "updatedAt": "2025-05-21T19:44:19.136Z"
      },
      {
        "id": "sJk9cUvmMU8FkJXv",
        "name": "AI",
        "createdAt": "2025-05-20T13:16:15.636Z",
        "updatedAt": "2025-05-20T13:16:15.636Z"
      },
      {
        "id": "kldZpTCan1suEN8v",
        "name": "Marketing",
        "createdAt": "2025-05-20T13:16:20.459Z",
        "updatedAt": "2025-05-20T13:16:20.459Z"
      },
      {
        "id": "9QurS5Kb1CkCYrnG",
        "name": "Product",
        "createdAt": "2025-05-21T17:06:29.704Z",
        "updatedAt": "2025-05-21T17:06:29.704Z"
      }
    ],
    "nodes": [
      {
        "id": "17af96f8-2f12-48b3-864f-bd28aa765ba6",
        "name": "When clicking \"Execute Workflow\"",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -200,
          520
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "9f270d49-c494-4c67-8749-e9ae3dfd0cef",
        "name": "HTTP Request",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          380,
          300
        ],
        "parameters": {
          "url": "={{ $json.URL }}",
          "options": {
            "redirect": {
              "redirect": {
                "followRedirects": true
              }
            }
          }
        },
        "typeVersion": 3,
        "continueOnFail": true
      },
      {
        "id": "3290629e-655a-4091-aee4-41482f441a52",
        "name": "HTML Extract",
        "type": "n8n-nodes-base.htmlExtract",
        "position": [
          560,
          300
        ],
        "parameters": {
          "options": {
            "trimValues": false
          },
          "extractionValues": {
            "values": [
              {
                "key": "body",
                "cssSelector": "html"
              }
            ]
          }
        },
        "typeVersion": 1,
        "continueOnFail": true
      },
      {
        "id": "94146021-3b01-43d0-b6d7-9fcfca0d065a",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          1580,
          140
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combinationMode": "mergeByPosition"
        },
        "typeVersion": 2
      },
      {
        "id": "08e5118b-37df-47a7-a50d-dbd2854d3dee",
        "name": "Clean Content",
        "type": "n8n-nodes-base.code",
        "position": [
          720,
          300
        ],
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "if ($input.item.json.body){\n\n\n\n$input.item.json.content = $input.item.json.body.replaceAll('/^\\s+|\\s+$/g', '').replace('/(\\r\\n|\\n|\\r)/gm', \"\").replace(/\\s+/g, ' ')\n\n\n  $input.item.json.contentShort = $input.item.json.content.slice(0, 10000)\n}\n\n\n\n\nreturn $input.item"
        },
        "executeOnce": false,
        "typeVersion": 1,
        "continueOnFail": true,
        "alwaysOutputData": true
      },
      {
        "id": "6eed41aa-176b-4a7c-8288-8c6dd47361df",
        "name": "Split In Batches",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          120,
          220
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 1
      },
      {
        "id": "1ca73312-3b32-4fd7-85e9-05850383d0b4",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -300,
          -200
        ],
        "parameters": {
          "width": 300,
          "height": 640,
          "content": "## 1. Specify the Google Sheet file\n\n#### It should contain the company names and their URLs (in the URL column). Also the Topical Summary and the Graph Summary columns that we will copy the data to.\n\n🤌 [SEE GOOGLE SHEETS TEMPLATE HERE](https://docs.google.com/spreadsheets/d/14qR7Gi8SRCd3eM6_V3ftRcDODkEFAILEqogjUvk7hKs/edit?usp=sharing) - use the same column names and replace with your data. Can be a list of companies generated with the workflow below, or Manus AI or any other Deep Research mode or a list of URLs you'd like to analyze for SEO.\n\n\n🚨 Make sure you specify the file here"
        },
        "typeVersion": 1
      },
      {
        "id": "8c657ce2-a363-4a77-9417-a758a8f3d3a0",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          60,
          -160
        ],
        "parameters": {
          "width": 220,
          "height": 600,
          "content": "## 2. Avoid rate limit error\n\n#### Split requests into batches of 10 \n\nso you don't make too many requests at once. \n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "ebd2ae92-1757-4dc4-b21b-09ad906398ca",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          340,
          -80
        ],
        "parameters": {
          "width": 520,
          "height": 520,
          "content": "## 3. Make an HTTP request and extract text content from the links provided\n\n#### Clean up the content to extract only text, not HTML\n\nwe will then use this content to analyze data"
        },
        "typeVersion": 1
      },
      {
        "id": "6ef3a264-586f-406a-ad44-cdbe2aa28654",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          920,
          -240
        ],
        "parameters": {
          "width": 440,
          "height": 680,
          "content": "## 4. Use InfraNodus GraphRAG Content Enhancer Tool \n\n#### It will use its AI to generate topical summaries and structural insights from every company's website. \n\nIt will generate a \n\n1) Topical Summary — AI generated summaries of the main topical clusters found in the document (if `graph summary` requestMode is used or a single summary if `summary` requestMode is used.\n\n2) Graph Summary — the information about the content gaps, the main topical clusters, keywords, and keyword combinations for the websites you provided.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "727b3598-b759-4c4c-bbaa-50704d159b96",
        "name": "InfraNodus GraphRAG Content Enhancer",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1080,
          260
        ],
        "parameters": {
          "url": "https://infranodus.com/api/v1/graphAndAdvice?doNotSave=true&optimize=develop&includeGraph=false&includeGraphSummary=true",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "name",
                "value": "n8n_dummy_graph"
              },
              {
                "name": "aiTopics",
                "value": "true"
              },
              {
                "name": "text",
                "value": "={{ $json.contentShort }}"
              },
              {
                "name": "requestMode",
                "value": "summary"
              }
            ]
          },
          "genericAuthType": "httpBearerAuth"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "6lSuuSDajZrvI2GM",
            "name": "InfraNodus API Key"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "77584973-d4fd-4a5b-9344-baebdfb4e584",
        "name": "Google Docs",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          3780,
          600
        ],
        "parameters": {
          "actionsUi": {
            "actionFields": [
              {
                "text": "={{ $('InfraNodus AI Advice').item.json.aiAdvice[0].text }}\n\n{{ $('InfraNodus Question Generator').item.json.aiAdvice.slice(0, 3).map(advice => advice.text).join('\\n\\n') }}",
                "action": "insert"
              }
            ]
          },
          "operation": "update",
          "documentURL": "https://docs.google.com/document/d/1q_pjPlg7flnP5TooBEC_4r-SkyY6F5tgrC-kE7lbFls/edit?tab=t.0"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "EHbGAxRKLI2ejgPv",
            "name": "Google Docs account 2"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "fd082093-c2b1-483e-b418-31bebd15d2c6",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          3100,
          600
        ],
        "parameters": {
          "options": {},
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "Topical Summary"
              },
              {
                "fieldToAggregate": "Graph Summary"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4c82a7bf-aa76-4d43-83dc-de54679b5f10",
        "name": "Read a Google Sheets File",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -200,
          240
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1122486654,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg/edit#gid=1122486654",
            "cachedResultName": "Empty"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg/edit?usp=drivesdk",
            "cachedResultName": "Visual Text Analysis Tools"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "DHJcCtarL7rWLBsF",
            "name": "Google Sheets account 2"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "5c8a772c-573d-4115-ab61-54a492f69907",
        "name": "Update Google Sheets with Content Insights",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2000,
          240
        ],
        "parameters": {
          "options": {},
          "fieldsUi": {
            "values": [
              {
                "column": "Graph Summary",
                "fieldValue": "={{ $json.graphSummary }}"
              },
              {
                "column": "Topical Summary",
                "fieldValue": "={{ $json.aiAdvice[0].text }}"
              }
            ]
          },
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1122486654,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg/edit#gid=1122486654",
            "cachedResultName": "Empty"
          },
          "documentId": {
            "__rl": true,
            "mode": "url",
            "value": "https://docs.google.com/spreadsheets/d/1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg/edit?gid=1287901638#gid=1287901638"
          },
          "valueToMatchOn": "={{ $json.URL }}",
          "columnToMatchOn": "URL"
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "DHJcCtarL7rWLBsF",
            "name": "Google Sheets account 2"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "47de0abb-b1ff-4620-a80f-ac3c3a2369a6",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1500,
          -140
        ],
        "parameters": {
          "width": 260,
          "height": 460,
          "content": "## 5. Add the enhanced content to original row\n\n#### We use this node to match the result to the table row (company and URL) we used to generate this result.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "0a665031-77de-4649-a274-b19092d5f0cf",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1920,
          -100
        ],
        "parameters": {
          "width": 260,
          "height": 520,
          "content": "## 6. Enrich the original Google sheets with the content\n\n#### We save the keywords, topical clusters, topical summaries, and content gaps to the Google sheets, so you can reuse it later in other workflows. \n\n🚨 Make sure to specify the Google sheets file here"
        },
        "typeVersion": 1
      },
      {
        "id": "6955a297-326e-4c30-bfd7-a3abdb2eb712",
        "name": "Wait to avoid API overload",
        "type": "n8n-nodes-base.wait",
        "position": [
          2280,
          500
        ],
        "webhookId": "e48bd7c5-7bc3-4f1d-8134-e25c7619ba83",
        "parameters": {
          "unit": "seconds"
        },
        "typeVersion": 1
      },
      {
        "id": "f1a16bb2-231f-46ae-87d8-91852223092a",
        "name": "If Node: did we process all the data?",
        "type": "n8n-nodes-base.if",
        "position": [
          2500,
          500
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "6b987d9e-7977-4c1e-a22c-42f1bd47e780",
                "operator": {
                  "type": "boolean",
                  "operation": "false",
                  "singleValue": true
                },
                "leftValue": "={{ $node[\"Split In Batches\"].context[\"noItemsLeft\"] }}",
                "rightValue": "value2"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "d6aa6d5d-0cb8-4149-ad78-44b51312ad1a",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2240,
          300
        ],
        "parameters": {
          "width": 420,
          "height": 400,
          "content": "## 7. Batch complete? Go to the next one.\n\n#### We process content in batches of 10 to avoid API overload and rate limit errors."
        },
        "typeVersion": 1
      },
      {
        "id": "e1814824-cb3d-46d3-8747-57bce510493f",
        "name": "Get the content from Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2800,
          600
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1122486654,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg/edit#gid=1122486654",
            "cachedResultName": "Empty"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg/edit?usp=drivesdk",
            "cachedResultName": "Visual Text Analysis Tools"
          },
          "combineFilters": "OR"
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "DHJcCtarL7rWLBsF",
            "name": "Google Sheets account 2"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "15dbb650-6c59-49fa-a2fd-8cf4a691b667",
        "name": "InfraNodus AI Advice",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3320,
          480
        ],
        "parameters": {
          "url": "https://infranodus.com/api/v1/graphAndAdvice?doNotSave=true&optimize=develop&includeGraph=false&includeGraphSummary=true",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "aiTopics",
                "value": "true"
              },
              {
                "name": "prompt",
                "value": "=Tell me what are the main topics and gaps in the discourse provided"
              },
              {
                "name": "requestMode",
                "value": "response"
              },
              {
                "name": "text",
                "value": "={{ $json['Topical Summary'].join(' ') }}"
              }
            ]
          },
          "genericAuthType": "httpBearerAuth"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "6lSuuSDajZrvI2GM",
            "name": "InfraNodus API Key"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "c7512eb4-d37f-4613-9b35-94739190515f",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2740,
          240
        ],
        "parameters": {
          "height": 580,
          "content": "## 8. Enrich the original Google sheets with your insights\n\n#### We can then use this data for further research and SEO\n\n🚨 Make sure to specify the Google sheets file here"
        },
        "typeVersion": 1
      },
      {
        "id": "987fd873-00ed-48c8-bbb5-ef309fbd2f21",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3040,
          240
        ],
        "parameters": {
          "width": 500,
          "height": 580,
          "content": "## 9. Get all the insights obtained from all the documents and create the final report.\n\n#### Synthesize the final report based on the main topics, summaries, and content gaps discovered in the previous steps\n\nOptional: You can also feed this output to another workflow to create a full report or SEO-friendly article. "
        },
        "typeVersion": 1
      },
      {
        "id": "7c83852a-8a77-471e-b105-6ef31e1e210e",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -300,
          760
        ],
        "parameters": {
          "width": 300,
          "height": 300,
          "content": "## 0. Specify the starting point\n\n#### You may choose to connect this node directly to the Step 8 if you already enriched the data in the Excel sheet.\n\nIn that case, the workflow will take data from the Topical Summary column and generate the results for you\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "f0b063d7-65e3-4bea-8065-af0b6fdb7e8f",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -300,
          -400
        ],
        "parameters": {
          "color": 7,
          "width": 2940,
          "height": 100,
          "content": "# Stage 1: Data Enrichment"
        },
        "typeVersion": 1
      },
      {
        "id": "5e697fdf-85b2-4761-a4e1-d555179afed8",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2720,
          -400
        ],
        "parameters": {
          "color": 7,
          "width": 1220,
          "height": 100,
          "content": "# Stage 2: Insight Generation"
        },
        "typeVersion": 1
      },
      {
        "id": "75beedd8-bbb4-465e-98be-932af51e5199",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3720,
          240
        ],
        "parameters": {
          "height": 580,
          "content": "## 10. Save the insights into a Google Doc\n\n#### We can then use this data for further research and SEO\n\n🚨 Make sure to specify the Google docs file here"
        },
        "typeVersion": 1
      },
      {
        "id": "3fdfae7a-456e-45fb-b1ed-c263838a5e20",
        "name": "Merge1",
        "type": "n8n-nodes-base.merge",
        "position": [
          3580,
          600
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "joinMode": "keepEverything",
          "fieldsToMatchString": "aiAdvice"
        },
        "typeVersion": 3.1
      },
      {
        "id": "f1ef6074-08e1-4afe-8175-9f6d9d0317a7",
        "name": "InfraNodus Question Generator",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          3320,
          700
        ],
        "parameters": {
          "url": "https://infranodus.com/api/v1/graphAndAdvice?doNotSave=true&optimize=gap&includeGraph=false&includeGraphSummary=true",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "aiTopics",
                "value": "true"
              },
              {
                "name": "prompt",
                "value": "=Tell me what are the main topics and gaps in the discourse provided"
              },
              {
                "name": "requestMode",
                "value": "question"
              },
              {
                "name": "text",
                "value": "={{ $json['Topical Summary'].join(' ') }}"
              }
            ]
          },
          "genericAuthType": "httpBearerAuth"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "6lSuuSDajZrvI2GM",
            "name": "InfraNodus API Key"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "0b415fbb-5a2b-4b9a-a4ff-53d2cd3a9a33",
        "name": "Perplexity Research",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          620,
          1060
        ],
        "parameters": {
          "url": "https://api.perplexity.ai/chat/completions",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"model\": \"sonar-pro\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"Act as a professional  researcher  whose task is to create the most comprehensive list of links that relate to the niche provided.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"Find all the link that relate to the following field: '{{ $json['Niche'] }}'\\n\\nAdditional instructions: '{{ $json['Model Instructions'] }}'\\n IMPORTANT: \\nMake a json list of at least 20 of them. One column is the name, the other is the URL, the third one is the category they operate in. Be as comprehensive in your search as you can. IMPORTANT: answer exclusively in JSON, do NOT add any additional comments.EXAMPLE OF YOUR RESPONSE\\n\\n[{\\\"Name\\\":\\\"A\\\",\\\"URL\\\":\\\"https://website.com\\\"}]\"\n    }\n  ]\n}\n",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpBearerAuth"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "9fXf9Np7XsCWgxhg",
            "name": "Perplexity"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "a73d5f72-c5f1-46c8-ae7a-08c9ec7f0755",
        "name": "On form submission",
        "type": "n8n-nodes-base.formTrigger",
        "disabled": true,
        "position": [
          280,
          1060
        ],
        "webhookId": "fcf3ba43-d94f-4aad-a8a0-62492274b372",
        "parameters": {
          "options": {},
          "formTitle": "Generate a List of Companies for a Market Niche",
          "formFields": {
            "values": [
              {
                "fieldLabel": "Niche",
                "placeholder": "e.g. customer feedback analysis tools",
                "requiredField": true
              },
              {
                "fieldLabel": "Additional Search Instructions",
                "placeholder": "e.g. make sure to include only big companies"
              }
            ]
          },
          "formDescription": "Describe the market for which you want to get a list of companies"
        },
        "typeVersion": 2.2
      },
      {
        "id": "19becdd1-a2f6-4be7-89c7-780a8e80a11b",
        "name": "OpenAI",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          920,
          1060
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Take this content and generate a JSON from it: {{ $json.choices[0].message.content }}. Make sure your JSON is just a list of companies like an array. Don't give it an additional name. Your response should be in the `response` object."
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "openAiApi": {
            "id": "07wFa8Wa4mMRCHAj",
            "name": "OpenAi account 2"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "5a14b12b-9645-4a16-a377-e707562af837",
        "name": "Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1760,
          1060
        ],
        "parameters": {
          "columns": {
            "value": {},
            "schema": [
              {
                "id": "Name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Category",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "Category",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1122486654,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg/edit#gid=1122486654",
            "cachedResultName": "Empty"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1l4RBfavkqZLz8JdwrgNsSwD8xERlDm6BrA2gXFPm0Dg/edit?usp=drivesdk",
            "cachedResultName": "Visual Text Analysis Tools"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "DHJcCtarL7rWLBsF",
            "name": "Google Sheets account 2"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "068b21f2-b4e8-4ccb-9756-b0e5ee3a6833",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1260,
          1060
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "message.content.response"
        },
        "typeVersion": 1
      },
      {
        "id": "02e38788-8624-4e8f-bb9a-3e0cbed63b49",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          1460,
          1060
        ],
        "parameters": {
          "options": {
            "reset": false
          }
        },
        "typeVersion": 3
      },
      {
        "id": "c2a4b61b-74c4-443c-a15e-252f896c372e",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          220,
          840
        ],
        "parameters": {
          "color": 6,
          "width": 1740,
          "height": 480,
          "content": "## Generate a List of URLs to Analyze \n\n#### Use this workflow to seed the Excel file with the list of URLs you'd like to analyze using the workflow above \n\nTrigger execution by clicking \"Test Workflow\" next to the form"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "2e3a437d-bf75-4612-9ca4-b53e6c2efd31",
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Update Google Sheets with Content Insights",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge1": {
        "main": [
          [
            {
              "node": "Google Docs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "InfraNodus AI Advice",
              "type": "main",
              "index": 0
            },
            {
              "node": "InfraNodus Question Generator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTML Extract": {
        "main": [
          [
            {
              "node": "Clean Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "HTML Extract",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Clean Content": {
        "main": [
          [
            {
              "node": "InfraNodus GraphRAG Content Enhancer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split In Batches": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "On form submission": {
        "main": [
          [
            {
              "node": "Perplexity Research",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Perplexity Research": {
        "main": [
          [
            {
              "node": "OpenAI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "InfraNodus AI Advice": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read a Google Sheets File": {
        "main": [
          [
            {
              "node": "Split In Batches",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait to avoid API overload": {
        "main": [
          [
            {
              "node": "If Node: did we process all the data?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "InfraNodus Question Generator": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "When clicking \"Execute Workflow\"": {
        "main": [
          [
            {
              "node": "Read a Google Sheets File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get the content from Google Sheets": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "InfraNodus GraphRAG Content Enhancer": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "If Node: did we process all the data?": {
        "main": [
          [
            {
              "node": "Split In Batches",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Get the content from Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Google Sheets with Content Insights": {
        "main": [
          [
            {
              "node": "Wait to avoid API overload",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "uFO3zp2bl5cqZqMS",
    "meta": {
      "instanceId": "159ec2e1d690fe685084d28de8ca73848642bf563457a19b94cfc00f23a0d9a9",
      "templateCredsSetupCompleted": true
    },
    "name": "YouTube Crawler",
    "tags": [],
    "nodes": [
      {
        "id": "230d2269-6b2e-4915-82e8-b42c2a36746a",
        "name": "When clicking ‘Execute workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          20,
          -40
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "2ffb8769-8769-4636-adff-f70a65df8fa5",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          860,
          140
        ],
        "parameters": {
          "color": 4,
          "width": 340,
          "height": 440,
          "content": "This step is going to call YouTube's API and ask for it to return videos that match the query, looking only in the category of education, sorted by relevance, and  no more than 50.\n\n**What you need to do**:\n\n- Enable the YouTube Data API v3: YouTube Data API v3 page in Google Cloud Console. Instructions can be found here: https://console.cloud.google.com/apis/library/youtube.googleapis.com\n\n- Add your youtube credentials to the workspace before starting. Instructions can be found here: https://developers.google.com/youtube/registering_an_application\n\n- Change the credentials in this \"Search YouTube\" node to use your new credentials you just added"
        },
        "typeVersion": 1
      },
      {
        "id": "b0becf14-1e2b-47a4-83b0-2db297518479",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          220,
          140
        ],
        "parameters": {
          "width": 340,
          "height": 240,
          "content": "This step is going to set the value of what you're going to be searching for in YouTube. It's optional, but easier to update and you can attach a chat to this if you want to update it outside of the node.\n\n**What you need to do**\n\n- Change the query to whatever you want to search for videos on"
        },
        "typeVersion": 1
      },
      {
        "id": "d437a506-e2b8-48fa-98cf-940657d7a879",
        "name": "Set Query",
        "type": "n8n-nodes-base.set",
        "position": [
          340,
          -40
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "58609f1a-03c7-4e5a-8199-2fcdaf495325",
                "name": "query",
                "type": "array",
                "value": "={{[\n\"AI agents tutorial step by step\",\n\"AI tools tutorial for beginners\",\n\"AI agent building tutorial\",\n\"AI prompt engineering techniques\",\n\"best AI tools training\",\n\"prompt engineering best practices\"]}}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "ea7e2dad-4f8f-40d8-9e77-25fbfe222f6f",
        "name": "Search YouTube",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          980,
          -40
        ],
        "parameters": {
          "url": "https://www.googleapis.com/youtube/v3/search",
          "options": {},
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "part",
                "value": "id,snippet"
              },
              {
                "name": "q",
                "value": "={{ $json.query }}"
              },
              {
                "name": "type",
                "value": "video"
              },
              {
                "name": "maxResults",
                "value": "50"
              },
              {
                "name": "order",
                "value": "relevance"
              },
              {
                "name": "videoCategoryId",
                "value": "27"
              }
            ]
          },
          "nodeCredentialType": "youTubeOAuth2Api"
        },
        "credentials": {
          "youTubeOAuth2Api": {
            "id": "kheqATZudwItRKpl",
            "name": "YouTube account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f68554af-5f38-4296-a38e-e917dba605f4",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1980,
          220
        ],
        "parameters": {
          "color": 3,
          "width": 440,
          "height": 340,
          "content": "This loop is going to collect all the metadata that we need from the videos, such as view and like count, and then filter based on those values as well as recency of publishing. Finally it will remove unnecessary fields before sending on to the final steps in the worfklow.\n\n**What you need to do**\n\n- Change the YouTube credentials in the \"Get Video Metadata\" node\n\n\n**Try Modifying**\n\n- The filter criteria to broaden, narrow, or change your aperture.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "62956d67-ee59-4131-8f4f-de263dafa7bc",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1380,
          -320
        ],
        "parameters": {
          "color": 5,
          "width": 340,
          "height": 220,
          "content": "This step is going to be the first quality and relevance filter, excluding anything that doesn't seem purely educational or that seems promotional or scammy.\n\n**Try Modifying**\n\n- The filter criteria to better reflect what you want to include or exclude.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c0f112d7-99d3-487a-9def-71bf8a879fdd",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          2920,
          -340
        ],
        "webhookId": "4318003c-dba4-43fb-a918-3225868d358a",
        "parameters": {
          "amount": 3
        },
        "typeVersion": 1.1
      },
      {
        "id": "43bb3d2b-0022-4cb0-a13c-ba7df4d4d9f4",
        "name": "Filter for Quality",
        "type": "n8n-nodes-base.filter",
        "position": [
          2280,
          -40
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "0fe9a82c-6c5c-44c1-8da7-24e2f8783a0e",
                "operator": {
                  "type": "number",
                  "operation": "gt"
                },
                "leftValue": "={{ $json.items[0].statistics.viewCount }}",
                "rightValue": 10000
              },
              {
                "id": "7eae8c9b-c85d-4f0f-92bd-01b047e05d0e",
                "operator": {
                  "type": "number",
                  "operation": "gt"
                },
                "leftValue": "={{ $json.items[0].statistics.likeCount }}",
                "rightValue": 100
              },
              {
                "id": "51d609d3-0b04-476e-9abd-a68a1f9c095c",
                "operator": {
                  "type": "dateTime",
                  "operation": "after"
                },
                "leftValue": "={{ $json.items[0].snippet.publishedAt }}",
                "rightValue": "2023-12-01T00:00:00"
              }
            ]
          },
          "looseTypeValidation": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "f844dd50-6a38-4e9f-874b-885bddf52b4e",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2260,
          -820
        ],
        "parameters": {
          "color": 3,
          "width": 440,
          "height": 440,
          "content": "This final set of steps is going to remove duplicate videos, assign a relevance score based on keywords and quality metrics, and then send only the top one's to a google sheet. \n\n**What you need to do**\n\n- Create a new google sheet in your drive with the columns Title, Channel, Published At, Views, Likes, Description, URL. This is the sheet your workflow will write into.\n\n- Add your google sheet credentials to your workspace\n\n- Change out the credential values in the \"Send to Google Sheets\" node\n\n\n**Try Modifying**\n\n- The formula for the relevance score to reflect your criteria for quality\n"
        },
        "typeVersion": 1
      },
      {
        "id": "40ec5dda-3c74-4203-b769-896cdb17c703",
        "name": "Split Query",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          660,
          -40
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "query"
        },
        "typeVersion": 1
      },
      {
        "id": "0f3f6e07-b0ad-4558-a268-97b61094671a",
        "name": "Split Results",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1240,
          -40
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "items"
        },
        "typeVersion": 1
      },
      {
        "id": "c44d4550-3bcc-46e5-b294-65c5455b112f",
        "name": "Filter for Relevance",
        "type": "n8n-nodes-base.filter",
        "position": [
          1480,
          -40
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "051c8268-ace1-4d87-a57e-798ed9992331",
                "operator": {
                  "type": "string",
                  "operation": "regex"
                },
                "leftValue": "={{ $json.snippet.title.toLowerCase() }}",
                "rightValue": "tutorial|course|guide|training|learn|education|explained|masterclass|complete.*guide|step.*by.*step|beginners.*guide|how.*to.*build|fundamentals"
              },
              {
                "id": "3bb11116-7ac6-4aa1-b1ac-3ebd1a6ceb82",
                "operator": {
                  "type": "string",
                  "operation": "notRegex"
                },
                "leftValue": "={{ $json.snippet.title.toLowerCase() }}",
                "rightValue": "money|rich|profit|earn|cash|income|\\$|💰|sell|agency|business|client|freelance|side.*hustle|make.*money"
              },
              {
                "id": "5edc6bdd-514c-4cbd-bbbc-51da2f87c41e",
                "operator": {
                  "type": "string",
                  "operation": "notRegex"
                },
                "leftValue": "={{ $json.snippet.title.toLowerCase() }}",
                "rightValue": "autopilot|passive.*income|[\\d]+k.*subs|faceless.*videos|youtube.*automation.*money|100%.*automated.*money"
              },
              {
                "id": "320ed472-8b8d-49bc-b830-e95c39017397",
                "operator": {
                  "type": "string",
                  "operation": "notRegex"
                },
                "leftValue": "={{ $json.snippet.title.toLowerCase() }}",
                "rightValue": "insane|crazy|ultimate.*secret|hack|trick|must.*do|steal.*these|best.*way.*to.*make|ways.*to.*make|you.*need.*to|[\\d]+.*ways|[\\d]+.*insane"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "74f3670e-e61a-4dd1-bde7-5fbf845e14ca",
        "name": "Loop over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          1820,
          -80
        ],
        "parameters": {
          "options": {},
          "batchSize": 10
        },
        "executeOnce": false,
        "typeVersion": 3,
        "alwaysOutputData": false
      },
      {
        "id": "8ad9d1d8-83f7-4edc-bac3-3d7bffbc0c83",
        "name": "Get Video Metadata",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2060,
          -40
        ],
        "parameters": {
          "url": "https://www.googleapis.com/youtube/v3/videos",
          "options": {},
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "part",
                "value": "snippet,statistics"
              },
              {
                "name": "id",
                "value": "={{ $json.id.videoId }}"
              }
            ]
          },
          "nodeCredentialType": "youTubeOAuth2Api"
        },
        "credentials": {
          "youTubeOAuth2Api": {
            "id": "kheqATZudwItRKpl",
            "name": "YouTube account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "040a4ed8-ec93-4461-acc1-5403154d3d61",
        "name": "Remove Unnecessary Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          2480,
          -40
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "bd1dfa28-997f-45e7-983f-06b4afdf2224",
                "name": "Title",
                "type": "string",
                "value": "={{ $json.items[0].snippet.title }}"
              },
              {
                "id": "9921ef02-a86d-42ae-a4df-9c2dd674505c",
                "name": "Channel",
                "type": "string",
                "value": "={{ $json.items[0].snippet.channelTitle }}"
              },
              {
                "id": "ec38edef-66e2-480f-9617-66123decfcef",
                "name": "Published At",
                "type": "string",
                "value": "={{ $json.items[0].snippet.publishedAt }}"
              },
              {
                "id": "9bb69372-553a-4c8d-8286-00f41c90a78c",
                "name": "Views",
                "type": "string",
                "value": "={{ $json.items[0].statistics.viewCount }}"
              },
              {
                "id": "80edec74-08c1-4d68-82f7-ba061cb2173e",
                "name": "Likes",
                "type": "string",
                "value": "={{ $json.items[0].statistics.likeCount }}"
              },
              {
                "id": "9700bbee-7f25-43fe-a653-42a7c8fade77",
                "name": "Description",
                "type": "string",
                "value": "={{ $json.items[0].snippet.description }}"
              },
              {
                "id": "9afaaa69-1afd-4f45-bfe6-24671651ac82",
                "name": "URL",
                "type": "string",
                "value": "=https://www.youtube.com/watch?v={{ $json.items[0].id }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "79b34b24-290f-43b7-8c45-990a5c30cdb0",
        "name": "Remove Duplicate Videos",
        "type": "n8n-nodes-base.removeDuplicates",
        "position": [
          2060,
          -340
        ],
        "parameters": {
          "compare": "={{ $json.URL }}",
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "756fa598-ab05-46ff-aaea-be6c9533568d",
        "name": "Generate Relevance Score",
        "type": "n8n-nodes-base.set",
        "position": [
          2280,
          -340
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "d691e3bf-9fc4-406f-b6e7-d62487820ea1",
                "name": "RelevanceScore",
                "type": "number",
                "value": "={{\n  // Educational keywords (higher scores)\n  (($json.Title.toLowerCase().includes('tutorial')) ? 15 : 0) +\n  (($json.Title.toLowerCase().includes('course')) ? 15 : 0) +\n  (($json.Title.toLowerCase().includes('guide')) ? 12 : 0) +\n  (($json.Title.toLowerCase().includes('explained')) ? 12 : 0) +\n  (($json.Title.toLowerCase().includes('beginner')) ? 10 : 0) +\n  (($json.Title.toLowerCase().includes('step by step')) ? 15 : 0) +\n  (($json.Title.toLowerCase().includes('complete')) ? 10 : 0) +\n  \n  // AI-specific terms\n  (($json.Title.toLowerCase().includes('prompt engineering')) ? 20 : 0) +\n  (($json.Title.toLowerCase().includes('ai agent')) ? 18 : 0) +\n  (($json.Title.toLowerCase().includes('ai tools')) ? 15 : 0) +\n  (($json.Title.toLowerCase().includes('prompting')) ? 15 : 0) +\n  \n  // Quality indicators\n  ((parseInt($json.Views) > 100000) ? 10 : 0) +\n  ((parseInt($json.Views) > 50000) ? 5 : 0) +\n  ((parseInt($json.Likes) > 1000) ? 8 : 0) +\n  \n  // Penalty for monetization indicators\n  (($json.Title.toLowerCase().includes('money') || \n    $json.Title.toLowerCase().includes('rich') || \n    $json.Title.toLowerCase().includes('earn')) ? -20 : 0)\n}}"
              },
              {
                "id": "a9e446de-dc9c-4dba-ab0b-d5647a24ba39",
                "name": "Title",
                "type": "string",
                "value": "={{ $json.Title }}"
              },
              {
                "id": "1669b129-9e9a-45e6-925f-c5e41e6de692",
                "name": "Channel",
                "type": "string",
                "value": "={{ $json.Channel }}"
              },
              {
                "id": "3d45d0ce-3068-424c-80a3-06c11785846d",
                "name": "Published at",
                "type": "string",
                "value": "={{ $json['Published At'] }}"
              },
              {
                "id": "16e45f2b-1d0b-48e4-b86c-7e8ba82c5aef",
                "name": "Views",
                "type": "string",
                "value": "={{ $json.Views }}"
              },
              {
                "id": "86f2af64-27f9-4e3c-9883-c279edc938c6",
                "name": "Likes",
                "type": "string",
                "value": "={{ $json.Likes }}"
              },
              {
                "id": "d967b6c4-ab40-4f87-a84e-e0cb1bbb51d6",
                "name": "Descriptoin",
                "type": "string",
                "value": "={{ $json.Description }}"
              },
              {
                "id": "e0af7129-2215-4583-b236-63587a4974b6",
                "name": "URL",
                "type": "string",
                "value": "={{ $json.URL }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "452016d9-50ce-49bb-bed8-d3213bd5bcec",
        "name": "Sort by Relevance",
        "type": "n8n-nodes-base.sort",
        "position": [
          2480,
          -340
        ],
        "parameters": {
          "options": {
            "disableDotNotation": false
          },
          "sortFieldsUi": {
            "sortField": [
              {
                "order": "descending",
                "fieldName": "RelevanceScore"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "916ff54f-b7a3-472f-af8e-df2e501aef65",
        "name": "Force Limit",
        "type": "n8n-nodes-base.limit",
        "position": [
          2700,
          -340
        ],
        "parameters": {
          "maxItems": 50
        },
        "typeVersion": 1
      },
      {
        "id": "b4007c9b-cf09-4292-b22d-2778bf7c03a6",
        "name": "Send to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          3120,
          -340
        ],
        "parameters": {
          "columns": {
            "value": {
              "URL": "={{ $json.URL }}",
              "Likes": "={{ $json.Likes }}",
              "Title": "={{ $json.Title }}",
              "Views": "={{ $json.Views }}",
              "Channel": "={{ $json.Channel }}",
              "Description": "={{ $json.Descriptoin }}",
              "Published At": "={{ $json['Published at'] }}"
            },
            "schema": [
              {
                "id": "Title",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Channel",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Channel",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Published At",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Published At",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Views",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Views",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Likes",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Likes",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Description",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Description",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1LbV3_SHHrGiTm7h-4WjBlbaNXDcv7fzzvHhmrU_GY3c/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1LbV3_SHHrGiTm7h-4WjBlbaNXDcv7fzzvHhmrU_GY3c",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1LbV3_SHHrGiTm7h-4WjBlbaNXDcv7fzzvHhmrU_GY3c/edit?usp=drivesdk",
            "cachedResultName": "YouTube AI Resources"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "e6dWze7VEM4F98dD",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "cfed5f6c-f15f-4dfe-bf4a-11541a75fc71",
    "connections": {
      "Wait": {
        "main": [
          [
            {
              "node": "Send to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Query": {
        "main": [
          [
            {
              "node": "Split Query",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Force Limit": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Query": {
        "main": [
          [
            {
              "node": "Search YouTube",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Results": {
        "main": [
          [
            {
              "node": "Filter for Relevance",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Search YouTube": {
        "main": [
          [
            {
              "node": "Split Results",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop over Items": {
        "main": [
          [
            {
              "node": "Remove Duplicate Videos",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Get Video Metadata",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Sort by Relevance": {
        "main": [
          [
            {
              "node": "Force Limit",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter for Quality": {
        "main": [
          [
            {
              "node": "Remove Unnecessary Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Video Metadata": {
        "main": [
          [
            {
              "node": "Filter for Quality",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter for Relevance": {
        "main": [
          [
            {
              "node": "Loop over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send to Google Sheets": {
        "main": [
          []
        ]
      },
      "Remove Duplicate Videos": {
        "main": [
          [
            {
              "node": "Generate Relevance Score",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Relevance Score": {
        "main": [
          [
            {
              "node": "Sort by Relevance",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Remove Unnecessary Fields": {
        "main": [
          [
            {
              "node": "Loop over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Execute workflow’": {
        "main": [
          [
            {
              "node": "Set Query",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "name": "Reels Trends Watcher",
    "nodes": [
      {
        "id": "e9aad9c8-d2ad-4e17-93cd-a7faa215a06f",
        "name": "When clicking ‘Execute workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -640,
          660
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "81d68000-b6bd-42bf-8335-78e753c1f68e",
        "name": "Get Sources",
        "type": "n8n-nodes-base.notion",
        "position": [
          -200,
          660
        ],
        "parameters": {
          "options": {},
          "resource": "databasePage",
          "operation": "getAll",
          "returnAll": true,
          "databaseId": {
            "__rl": true,
            "mode": "list",
            "cachedResultName": "Sources"
          }
        },
        "credentials": {
          "notionApi": {
            "id": "kvRPd5KbcIYATwNj",
            "name": "Notion - Content Factory"
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "d59e57be-ae56-4853-aa56-c0839b5fd6c1",
        "name": "Variables",
        "type": "n8n-nodes-base.code",
        "position": [
          -420,
          660
        ],
        "parameters": {
          "jsCode": "const variables = {\n  // https://apify.com/apify/instagram-scraper \n  // Instagram Scraper = apify/instagram-scraper, \n  \"scrapingActorId\" : \"shu8hvrXbJbY3Eb9W\", // ID of Apify scraper\n  \"daysLimit\" : 7, // Date limit \n  \"resultsLimit\" : 3, // Results per account\n  \"maxDays\" : 2, // Sleeping || Active\n  \"translationLang\" : \"German\",\n}\n\n\nreturn [{json : variables}]"
        },
        "typeVersion": 2
      },
      {
        "id": "9dc6b692-015d-4749-bd77-a91cace88f73",
        "name": "Apify Payload",
        "type": "n8n-nodes-base.code",
        "position": [
          20,
          660
        ],
        "parameters": {
          "jsCode": "// required Simplify = true\n\nconst query = {\n    \"addParentData\": false,\n    \"directUrls\": [],\n    \"enhanceUserSearchWithFacebookPage\": false,\n    \"isUserReelFeedURL\": false,\n    \"isUserTaggedFeedURL\": false,\n    \"onlyPostsNewerThan\": ($('Variables').first().json.daysLimit ?? 10) + ' days',\n    \"resultsLimit\": $('Variables').first().json.resultsLimit ?? 5,\n    \"resultsType\": \"stories\"\n};\n\nconst urls = [];\nconst map = {};\n\nitems.forEach(item => {\n  const username = item.json.property_username || '';\n  if (username) {\n    urls.push('https://www.instagram.com/' + username + '/');\n    map[username.toLowerCase()] = item.json.id;   // Notion pageId\n  }\n});\n\nquery.directUrls = urls;\n\nreturn [\n  {\n    json: {\n      query,\n      urls,\n      map     \n    }\n  }\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "70cb78f1-bbc9-4dca-91a6-3d54444689ec",
        "name": "Switch",
        "type": "n8n-nodes-base.switch",
        "position": [
          680,
          600
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Done",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "96d0046b-c9ab-429e-b35c-3d7518564c1b",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $json.status }}",
                      "rightValue": "SUCCEEDED"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Running",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "5b1c311d-10cf-4e6f-a55c-f311c75ef444",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $('Get Status').item.json.status }}",
                      "rightValue": "RUNNING"
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Ready",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "8376a12a-87c9-4878-b654-1c91fdfb31a2",
                      "operator": {
                        "name": "filter.operator.equals",
                        "type": "string",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $('Get Status').item.json.status }}",
                      "rightValue": "READY"
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "43b693cd-9c70-4b2c-a30b-9ec3d01fe809",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          900,
          760
        ],
        "webhookId": "6a6311dc-42d5-4329-93a2-ccd76057b31d",
        "parameters": {
          "unit": "minutes",
          "amount": 1
        },
        "typeVersion": 1.1
      },
      {
        "id": "8114cefb-bf4e-4ccd-9d27-b5858bfa4ca9",
        "name": "Get dataset items",
        "type": "@apify/n8n-nodes-apify.apify",
        "position": [
          900,
          540
        ],
        "parameters": {
          "limit": null,
          "resource": "Datasets",
          "datasetId": "={{ $json.defaultDatasetId }}",
          "operation": "Get items"
        },
        "credentials": {
          "apifyApi": {
            "id": "ULiVF6A0w3CkwFvr",
            "name": "Apify account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "2045d552-7cc9-4670-8729-faec32a2bb49",
        "name": "Get Status",
        "type": "@apify/n8n-nodes-apify.apify",
        "position": [
          460,
          660
        ],
        "parameters": {
          "runId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "resource": "Actor runs",
          "operation": "Get run"
        },
        "credentials": {
          "apifyApi": {
            "id": "ULiVF6A0w3CkwFvr",
            "name": "Apify account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e3288a62-aae7-4b7d-9081-63daac01219a",
        "name": "Run an Actor",
        "type": "@apify/n8n-nodes-apify.apify",
        "position": [
          240,
          660
        ],
        "parameters": {
          "actorId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Variables').first().json.scrapingActorId }}"
          },
          "operation": "Run actor",
          "customBody": "={{ $json.query.toJsonString() }}",
          "actorSource": "store"
        },
        "credentials": {
          "apifyApi": {
            "id": "ULiVF6A0w3CkwFvr",
            "name": "Apify account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "cb8d08e4-d245-4f6f-a5e3-98860dc4e04d",
        "name": "Update Accounts",
        "type": "n8n-nodes-base.notion",
        "position": [
          1560,
          540
        ],
        "parameters": {
          "pageId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.notionPageId }}"
          },
          "options": {},
          "resource": "databasePage",
          "operation": "update",
          "propertiesUi": {
            "propertyValues": [
              {
                "key": "Status|select",
                "selectValue": "={{ $json.publishingStatus }}"
              },
              {
                "key": "Title|title",
                "title": "={{ $json.ownerFullName }}"
              },
              {
                "key": "URL|url",
                "urlValue": "={{ $json.inputUrl }}"
              }
            ]
          }
        },
        "credentials": {
          "notionApi": {
            "id": "kvRPd5KbcIYATwNj",
            "name": "Notion - Content Factory"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "950f0ac1-11d9-4673-b751-feea0b623dc9",
        "name": "Get Reels",
        "type": "n8n-nodes-base.notion",
        "position": [
          2000,
          540
        ],
        "parameters": {
          "filters": {
            "conditions": [
              {
                "key": "Date|date",
                "date": "={{ new Date(Date.now() - $('Variables').first().json.daysLimit * 24 * 60 * 60 * 1000).toISOString().split('T')[0] }}",
                "condition": "after"
              }
            ]
          },
          "options": {},
          "resource": "databasePage",
          "operation": "getAll",
          "returnAll": true,
          "databaseId": {
            "__rl": true,
            "mode": "list",
            "cachedResultName": "Reels"
          },
          "filterType": "manual"
        },
        "credentials": {
          "notionApi": {
            "id": "kvRPd5KbcIYATwNj",
            "name": "Notion - Content Factory"
          }
        },
        "executeOnce": false,
        "typeVersion": 2.2,
        "alwaysOutputData": true
      },
      {
        "id": "52d274fb-3b99-48c7-8338-83ed7537568e",
        "name": "Many to One",
        "type": "n8n-nodes-base.code",
        "position": [
          1780,
          540
        ],
        "parameters": {
          "jsCode": "const accountsMap = {};\n\nitems.forEach(item => {\n  const username = item.json.property_username || '';\n  if (username) {\n    accountsMap[username.toLowerCase()] = item.json.id;   // Notion pageId\n  }\n});\n\nreturn [\n  {\n    json: {\n      accountsMap,\n      items\n    }\n  }\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "6e9b25fe-e3ce-4cd4-91f6-4accd65f532b",
        "name": "Code",
        "type": "n8n-nodes-base.code",
        "position": [
          2220,
          540
        ],
        "parameters": {
          "jsCode": "const existingPages = {};\nfor (const page of $items('Get Reels')) {\n  const source = page.json.property_url ?? '';\n  if (source) existingPages[source] = page.json;\n}\n\nconst output = [];\nconst accountsMap = $('Many to One').first().json.accountsMap;\n\nfor (const reel of $items('Map Reels')) {\n\n  const source   = reel.json.url;          \n\n  const views = reel.json.videoViewCount;\n  var update = {\n    \"Code\": reel.json.shortCode,\n    \"SignedCode\": reel.json.shortCode + '-' + Math.random(),\n    \"IsCreated\" : false,\n    \"notionAccountPageId\" : accountsMap[ reel.json.ownerUsername.toLowerCase() ],\n          \"Views\"       : views ? views : reel.json.videoPlayCount,\n          \"Likes\"       : reel.json.likesCount,\n          \"Comments\"    : reel.json.commentsCount,\n          \"Saves\"       : reel.json.savesCount ?? 0,\n          \"Shares\"      : reel.json.sharesCount ?? 0,\n          \"Updated\"   : new Date().toISOString()\n  };\n\n  /* ------------------------------------------------- */\n  if (existingPages[source]) {\n    \n    update.notionPageId = existingPages[source].id;\n\n  } else {\n    update['IsCreated'] = true;\n    update['Caption'] = reel.json.caption;\n    update['URL'] = reel.json.url;\n    update['Hashtags'] = reel.json.hashtags.join(', ');\n    update['Duration'] = reel.json.videoDuration;\n    update['Date'] = reel.json.timestamp;\n    update['videoUrl'] = reel.json.videoUrl;\n    \n  }\n\n  output.push({json: update});\n}\n\nreturn output;   // n8n continues with one array containing both kinds of items\n"
        },
        "typeVersion": 2
      },
      {
        "id": "242b65f6-a180-4795-b18f-c0b3278dbc3d",
        "name": "Map Reels",
        "type": "n8n-nodes-base.code",
        "position": [
          1120,
          540
        ],
        "parameters": {
          "jsCode": "const maxDays = $('Variables').first()?.json?.maxDays ?? 3;  \nconst now     = new Date();\n\n\nvar results = items;                             \nconst map   = $('Apify Payload').first().json.map;\n\n\nconst acctStatus = {};   // { username: 'Active' | 'Sleeping' }\n\nfor (const itm of results) {\n  const owner = itm.json.ownerUsername.toLowerCase();\n  const ts    = new Date(itm.json.timestamp);\n  const diff  = (now - ts) / 86_400_000;    \n\n  \n  if (!acctStatus[owner] || acctStatus[owner] === 'Sleeping') {\n    acctStatus[owner] = diff <= maxDays ? 'Active' : 'Sleeping';\n  }\n}\n\nfor (const k in results) {\n  const item   = results[k];\n  const owner  = item.json.ownerUsername.toLowerCase();\n\n  // coauthorProducers - !notionPageId\n  item.json.notionPageId     = map[owner];\n  item.json.publishingStatus = acctStatus[owner];\n\n  results[k] = item;\n}\n\nreturn results;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "f6ce6734-6bbf-451b-bc8b-e73fcad9eaac",
        "name": "Create",
        "type": "n8n-nodes-base.notion",
        "onError": "continueRegularOutput",
        "position": [
          1800,
          1360
        ],
        "parameters": {
          "title": "={{ ($json.response.hook ?? $json.Caption).substring(0, 50) }}",
          "options": {},
          "resource": "databasePage",
          "databaseId": {
            "__rl": true,
            "mode": "list",
            "cachedResultName": "Reels"
          },
          "propertiesUi": {
            "propertyValues": [
              {
                "key": "Date|date",
                "date": "={{ $json.Date }}"
              },
              {
                "key": "Caption|rich_text",
                "textContent": "={{ $json.Caption.substring(0, 1995) }}"
              },
              {
                "key": "Duration|number",
                "numberValue": "={{ $json.Duration }}"
              },
              {
                "key": "Likes|number",
                "numberValue": "={{ $json.Likes }}"
              },
              {
                "key": "Parsed Date|date",
                "date": "={{ $now }}"
              },
              {
                "key": "URL|url",
                "urlValue": "={{ $json.URL }}"
              },
              {
                "key": "Views|number",
                "numberValue": "={{ $json.Views }}"
              },
              {
                "key": "Comments|number",
                "numberValue": "={{ $json.Comments }}"
              },
              {
                "key": "Author|relation",
                "relationValue": [
                  "={{ $json.notionAccountPageId }}"
                ]
              },
              {
                "key": "Content|rich_text",
                "textContent": "=### HOOK ###\n{{ $json.response.hook }}\n\n### CONTENT ###\n{{ $json.response.transcription.substring(0, 1800) }}"
              },
              {
                "key": "Translation|rich_text",
                "textContent": "=### HOOK ###\n{{ $json.response.translation_hook }}\n\n### CONTENT ###\n{{ $json.response.translation.substring(0, 1800) }}"
              },
              {
                "key": "Type|select",
                "selectValue": "={{ $json.response.format }}"
              },
              {
                "key": "Category|select",
                "selectValue": "={{ $json.response.category }}"
              }
            ]
          }
        },
        "credentials": {
          "notionApi": {
            "id": "kvRPd5KbcIYATwNj",
            "name": "Notion - Content Factory"
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "4f840157-aa84-4e1d-bc01-743b2846e733",
        "name": "Update",
        "type": "n8n-nodes-base.notion",
        "position": [
          60,
          1620
        ],
        "parameters": {
          "pageId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.notionPageId }}"
          },
          "options": {},
          "resource": "databasePage",
          "operation": "update",
          "propertiesUi": {
            "propertyValues": [
              {
                "key": "Comments|number",
                "numberValue": "={{ $json.Comments }}"
              },
              {
                "key": "Likes|number",
                "numberValue": "={{ $json.Likes }}"
              },
              {
                "key": "Views|number",
                "numberValue": "={{ $json.Views }}"
              }
            ]
          }
        },
        "credentials": {
          "notionApi": {
            "id": "kvRPd5KbcIYATwNj",
            "name": "Notion - Content Factory"
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "3cf91952-47b1-4bd9-9b3d-95a0b847a4cc",
        "name": "Download Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          40,
          1220
        ],
        "parameters": {
          "url": "={{ $json.videoUrl }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "4afd4b50-bb64-4135-9d7a-b4e2da533370",
        "name": "Upload to Gemini",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          260,
          1220
        ],
        "parameters": {
          "url": "https://generativelanguage.googleapis.com/upload/v1beta/files",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "binaryData",
          "authentication": "predefinedCredentialType",
          "inputDataFieldName": "data",
          "nodeCredentialType": "googlePalmApi"
        },
        "credentials": {
          "openAiApi": {
            "id": "kS6Z0Hk1s9z9jto6",
            "name": "OpenAi account"
          },
          "googlePalmApi": {
            "id": "OM6UrKcjIxk9844H",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "be95f2a7-fd68-472d-b1e9-e7f47e16f61d",
        "name": "Gemini Analyze",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1360,
          1220
        ],
        "parameters": {
          "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n\t\"contents\": [{\n\t\t\"parts\": [{\n\t\t\t\"file_data\": {\n\t\t\t\t\"file_uri\": \"{{ $('Is Uploaded And Active?').item.json.uri }}\",\n\t\t\t\t\"mime_type\": \"{{ $('Is Uploaded And Active?').item.json.mimeType }}\"\n\t\t\t}\n\t\t}, {\n\t\t\t\"text\": \"{{ $('Set Prompt').first().json.AnalyzePrompt.replaceAll(\"\\n\", '\\\\n').replaceAll('\"', '\\\"\"') }}\"\n\t\t}]\n\t}]\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googlePalmApi"
        },
        "credentials": {
          "openAiApi": {
            "id": "kS6Z0Hk1s9z9jto6",
            "name": "OpenAi account"
          },
          "googlePalmApi": {
            "id": "OM6UrKcjIxk9844H",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "d8a3b6c8-dfab-4d12-ac66-dacf23c379f5",
        "name": "Is Uploaded And Active?",
        "type": "n8n-nodes-base.if",
        "position": [
          920,
          1220
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "8cf67b24-2993-4aed-be9d-00b88a1c5701",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.state }}",
                "rightValue": "ACTIVE"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "849c07c0-c0c9-42bf-94a7-0bb794a8bbdc",
        "name": "Get File State",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          700,
          1160
        ],
        "parameters": {
          "url": "={{ $json.file.uri }}",
          "options": {},
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googlePalmApi"
        },
        "credentials": {
          "openAiApi": {
            "id": "kS6Z0Hk1s9z9jto6",
            "name": "OpenAi account"
          },
          "googlePalmApi": {
            "id": "OM6UrKcjIxk9844H",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "bd77d983-4f7a-4330-b461-dd0ebc6223e8",
        "name": "Processing Delay",
        "type": "n8n-nodes-base.wait",
        "position": [
          480,
          1220
        ],
        "webhookId": "3df7acce-81fc-4341-a091-fa1427977cb4",
        "parameters": {
          "unit": "minutes",
          "amount": 1
        },
        "typeVersion": 1.1
      },
      {
        "id": "36dce35b-d983-4a45-9617-ac1254f5c77c",
        "name": "Format Response",
        "type": "n8n-nodes-base.code",
        "position": [
          1580,
          1220
        ],
        "parameters": {
          "jsCode": "\nconst rawText = $input.first().json.candidates[0].content.parts[0].text;\n\nconst cleaned = rawText\n  .replace(/^```json\\s*/, '')      \n  .replace(/\\s*```$/, '')          \n  .trim();\n\nlet parsed;\ntry {\n  parsed = JSON.parse(cleaned);\n} catch (e) {\n  return [{ json: { error: 'Invalid JSON', message: e.message } }];\n}\n\nlet item = $('Is Created?').first().json;\n\nparsed.transcription = parsed.transcription ?? '';\nparsed.hook = parsed.hook ?? '';\nparsed.category = parsed.category ?? '';\nparsed.format = parsed.format ?? '';\nparsed.translation = parsed.translation ?? '';\nparsed.translation_hook = parsed.translation_hook ?? '';\n\nitem.response = parsed;\n\n\nreturn [{ json: item }];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "913daa8b-e3c5-48d9-8f1c-16746a847564",
        "name": "Set Prompt",
        "type": "n8n-nodes-base.set",
        "position": [
          1160,
          1240
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "01c3ca92-795f-4528-8df5-204c324c352b",
                "name": "AnalyzePrompt",
                "type": "string",
                "value": "=Perform the following tasks based on the video/audio content:\n\n1. Create a full transcription of the audio — convert speech to text exactly as spoken, without interpretation or summarization, so it can be easily read or re-voiced later.\n\n2. Identify a strong hook from the first few seconds of the content that can grab attention.\n\n3. Determine the category of the content using the following rules:\n- Business: if the video shares business advice\n- Marketing: if the video shares marketing advice\n- Cooking: if the video shares cooking advice\n- Interview: if the video is an interview with a guest\n- Unknown: if the category cannot be determined\n\n4. Identify the video format using the following options:\n- Head: if it's a talking-head video\n- Animation: if it's animated or presented with drawings\n- Unknown: if the format is unclear\n\n5. Translate the full transcription and the hook into {{ $('Variables').first().json.translationLang }}.\n\nReturn the result in **pure JSON format** with the following fields:  \n`transcription`, `hook`, `category`, `format`, `translation`, `translation_hook`.\n\n**Do not include any commentary or explanations. Only return the JSON.**"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "f623358c-c051-4cf6-9922-1cbf1f944d7b",
        "name": "Owner?",
        "type": "n8n-nodes-base.if",
        "position": [
          1340,
          540
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "7b88be8b-60c6-47b1-8a6a-4f5b97d71234",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.notionPageId }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "6ef695e9-6e2d-4bea-bfb8-ba559e6a803e",
        "name": "Is Created?",
        "type": "n8n-nodes-base.switch",
        "position": [
          -180,
          1300
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "Create",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "bed205cb-cc58-4f99-af5e-7565257ea7c4",
                      "operator": {
                        "type": "boolean",
                        "operation": "true",
                        "singleValue": true
                      },
                      "leftValue": "={{ $json.IsCreated && $json.notionAccountPageId != null }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              },
              {
                "outputKey": "Update",
                "conditions": {
                  "options": {
                    "version": 2,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "042c2e67-6f4d-4909-a73d-eb43864203dd",
                      "operator": {
                        "type": "boolean",
                        "operation": "true",
                        "singleValue": true
                      },
                      "leftValue": "={{ !$json.IsCreated && $json.notionAccountPageId != null }}",
                      "rightValue": ""
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "5b97e7c8-9637-4763-ad8c-53a086ddc8fd",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -400,
          1400
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "635e329a-dda0-40d6-96d1-e7b384ec841b",
        "name": "Stats",
        "type": "n8n-nodes-base.code",
        "position": [
          -180,
          1100
        ],
        "parameters": {
          "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfor (const item of $input.all()) {\n  item.json.myNewField = 1;\n}\n\nreturn $input.all();"
        },
        "typeVersion": 2
      },
      {
        "id": "261dc20e-b593-440b-b002-f6d1cbfbfcc0",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -640,
          440
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 4
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "5d8a6022-16bc-4211-b596-089655921209",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1320,
          -220
        ],
        "parameters": {
          "color": 7,
          "width": 520,
          "height": 360,
          "content": "### 📺 How It Works – Watch the Video  \nI've recorded a video walkthrough to show you how the system works in detail.\n👉 [https://www.youtube.com/watch?v=rdfRNHpHX8o](https://www.youtube.com/watch?v=rdfRNHpHX8o)\n\n\n### 📄 Download Notion Database Structure  \nYou can download the Notion table structure (with all required columns and formats) here:  \n👉 [https://drive.google.com/file/d/1FVaS_-ztp6PDAJbETUb1dkg8IqE4qHqp/view?usp=sharing](https://drive.google.com/file/d/1FVaS_-ztp6PDAJbETUb1dkg8IqE4qHqp/view?usp=sharing)\n\n### ☕ Support the Project  \nIf you'd like to support my work, there's a version with tips available here:\n👉 [Coffee + Sandwich Version](https://gr.egrnkvch.com/l/InstagramReelsTrendWatcher)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b7c81e9f-5d71-4ce1-b6b0-585245e0eb90",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -740,
          -220
        ],
        "parameters": {
          "color": 7,
          "width": 520,
          "height": 580,
          "content": "## ⚙️ How to Install the Template\n\n1. **Create the databases in Notion.**  \n   Make sure to use the exact column names and formats as shown in the provided structure.\n\n2. **Import the workflow template into n8n.**\n\n3. **Add your Credentials:**\n   - **Notion**: Standard Notion integration  \n   - **Apify**: Create and connect your Apify API key\n\n4. **Gemini API is used via HTTP Request node.**  \n   Use the following settings:  \n   - `Authentication`: **Predefined Credential Type**  \n   - `Credential Type`: **Google Gemini (PaLM) API**  \n   - `Host`: `https://generativelanguage.googleapis.com`  \n   - API key: your personal Gemini API key\n\n5. **Assign these credentials** in the corresponding nodes inside the workflow.\n\n6. **Configure the Variables node** to set parsing parameters.  \n   Test the process with 3–5 accounts, each with 3–5 Reels.  \n   Once everything works, update the Variables with your full settings.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "af4c205f-6a9c-493f-861d-bda18d346cf5",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1320,
          200
        ],
        "parameters": {
          "color": 7,
          "width": 520,
          "height": 140,
          "content": "### 📺 Video Guide\n👉 [https://www.youtube.com/watch?v=rdfRNHpHX8o](https://www.youtube.com/watch?v=rdfRNHpHX8o)\n\n@[youtube](rdfRNHpHX8o)"
        },
        "typeVersion": 1
      },
      {
        "id": "5acb33a7-5bc2-439f-a648-450fe97073eb",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -240,
          560
        ],
        "parameters": {
          "width": 180,
          "height": 80,
          "content": "Database = Sources"
        },
        "typeVersion": 1
      },
      {
        "id": "aa226eb7-84f5-41cc-87dd-a18d163ddf8b",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1960,
          420
        ],
        "parameters": {
          "width": 180,
          "height": 80,
          "content": "Database = Reels"
        },
        "typeVersion": 1
      },
      {
        "id": "4efaf2ee-ef7a-4f72-88cc-12eae7210b1b",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1780,
          1260
        ],
        "parameters": {
          "width": 180,
          "height": 80,
          "content": "Database = Reels"
        },
        "typeVersion": 1
      },
      {
        "id": "c641b324-a620-4cf8-a8ec-1b821b942425",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1080,
          1080
        ],
        "parameters": {
          "width": 300,
          "height": 100,
          "content": "This is the prompt used to process video content and classify its category and type. Customize it based on your logic."
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Code": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Get Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Owner?": {
        "main": [
          [
            {
              "node": "Update Accounts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "Get dataset items",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Reels": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Map Reels": {
        "main": [
          [
            {
              "node": "Owner?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Variables": {
        "main": [
          [
            {
              "node": "Get Sources",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Status": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Prompt": {
        "main": [
          [
            {
              "node": "Gemini Analyze",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Sources": {
        "main": [
          [
            {
              "node": "Apify Payload",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Created?": {
        "main": [
          [
            {
              "node": "Download Video",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Update",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Many to One": {
        "main": [
          [
            {
              "node": "Get Reels",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Run an Actor": {
        "main": [
          [
            {
              "node": "Get Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Apify Payload": {
        "main": [
          [
            {
              "node": "Run an Actor",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Video": {
        "main": [
          [
            {
              "node": "Upload to Gemini",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini Analyze": {
        "main": [
          [
            {
              "node": "Format Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get File State": {
        "main": [
          [
            {
              "node": "Is Uploaded And Active?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Response": {
        "main": [
          [
            {
              "node": "Create",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Stats",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Is Created?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Accounts": {
        "main": [
          [
            {
              "node": "Many to One",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Processing Delay": {
        "main": [
          [
            {
              "node": "Get File State",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          []
        ]
      },
      "Upload to Gemini": {
        "main": [
          [
            {
              "node": "Processing Delay",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get dataset items": {
        "main": [
          [
            {
              "node": "Map Reels",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Uploaded And Active?": {
        "main": [
          [
            {
              "node": "Set Prompt",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Processing Delay",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Execute workflow’": {
        "main": [
          [
            {
              "node": "Variables",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "b1f85eae352fde76d801a1a612661df6824cc2e68bfd6741e31305160a737e6e",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "d9e07286-a8be-4c28-8519-acf7cd35ad86",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -900,
          -40
        ],
        "webhookId": "57251efe-e57c-43e2-ac58-bf27f1ec639d",
        "parameters": {
          "public": true,
          "options": {
            "showWelcomeScreen": true
          },
          "initialMessages": "Hi there! 👋\n\nMy name is Miquel and I am your personal Real Estate agent. I help you to find your new home.\n\nWhat are you looking for?"
        },
        "typeVersion": 1.1
      },
      {
        "id": "7ca48714-3c65-4f32-9491-7b7b621aaa00",
        "name": "Simple Memory1",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          -420,
          140
        ],
        "parameters": {
          "contextWindowLength": 30
        },
        "typeVersion": 1.3
      },
      {
        "id": "79bea812-5a33-40a1-aa74-fe202d39dded",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -580,
          140
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "oKzfvOwieOm4upQ2",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "30ef3cfc-56db-4092-af0d-304afdad94f0",
        "name": "Filter Dataset",
        "type": "n8n-nodes-brightdata.brightDataTool",
        "position": [
          -260,
          140
        ],
        "parameters": {
          "resource": "marketplaceDataset",
          "operation": "filterDataset",
          "dataset_id": {
            "__rl": true,
            "mode": "list",
            "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Dataset', ``, 'string') }}"
          },
          "filter_type": "filters_group",
          "filters_group": "={{ $fromAI('Filters_Group') }}",
          "records_limit": "=3",
          "descriptionType": "manual",
          "toolDescription": "Create a dataset snapshot based on a provided filter in BrightData. use always filter homeStatus = FOR_SALE. We have the next operators: =, >, >=, in, <, <=, not_array_includes, !=, not_in, not_includes\n\nFilter must follow the next format:\n{\n    \"operator\": \"and\",\n    \"filters\": [\n        {\n            \"name\": \"homeStatus\",\n            \"operator\": \"=\",\n            \"value\": \"FOR_SALE\"\n        },\n        {\n            \"name\": \"price\",\n            \"operator\": \"=\",\n            \"value\": 1000000\n        },\n        {\n            \"name\": \"city\",\n            \"operator\": \"=\",\n            \"value\": \"new york\"\n        },\n        {\n            \"name\": \"bathrooms\",\n            \"operator\": \"=\",\n            \"value\": 2\n        },\n        {\n            \"name\": \"bedrooms\",\n            \"operator\": \"=\",\n            \"value\": 4\n        }\n    ]\n}"
        },
        "credentials": {
          "brightdataApi": {
            "id": "jk945kIuAFAo9bcg",
            "name": "BrightData account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "6c4c4338-e4d2-40ee-89c0-89e1dd1dc330",
        "name": "When Executed by Another Workflow",
        "type": "n8n-nodes-base.executeWorkflowTrigger",
        "position": [
          -660,
          -340
        ],
        "parameters": {
          "inputSource": "passthrough"
        },
        "typeVersion": 1.1
      },
      {
        "id": "9db2680e-8bad-4b91-9cd6-8240f53081a0",
        "name": "Snapshot is ready?",
        "type": "n8n-nodes-base.if",
        "position": [
          -120,
          -340
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "or",
            "conditions": [
              {
                "id": "3e99082f-412a-4e33-ab77-c99ddd4d7ff5",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.items[0].abbreviatedAddress }}",
                "rightValue": "NodeApiError"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "75f66a3a-7738-4a1c-af8a-29385ad41749",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          100,
          -260
        ],
        "webhookId": "7d5607bb-7cbd-439e-a95e-dfe326486b74",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "19beba9e-6089-443f-a384-4be3ec821423",
        "name": "Real Estate AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -460,
          -40
        ],
        "parameters": {
          "text": "={{ $json.chatInput }}",
          "options": {
            "maxIterations": 10,
            "systemMessage": "=You are an expert AI Real Estate Agent.\n\nFollow the next guidelines always:\n\n1) If you have no memory, recover the metadata from the next databases:\n- Zillow properties listing information gd_lfqkr8wm13ixtbd8f5\nWe have the next filters:\n- city: City name where entity is located. Contains valid US city names as text strings.\n- bedrooms: Column stores the number of bedrooms in properties. Values are positive integers ranging from 1 to 7, with most properties having 2-4 bedrooms and no null values.\n- bathrooms: Number of bathrooms in residential properties. Values are positive integers ranging from 1 to 7, with most properties having 2-3 bathrooms and no null values.\n- price: Property price in US dollars. Format sample: 180,000\n\nInform user that only 3 houses will be reported.\nOnly call filterDataset if user completes city, bedrooms, bathrooms and price filters.\n\n2) Use filterDataset to generate a snapshot of the requested houses by mapping filter of the user.\nOnly allow one call to tool \"Filter Dataset\", \n\n3) After calling \"filter Dataset\" tool, use tool \"Get Snapshot Content\". Pass snapshot_id parameter.\n\n4) Use output from tool \"Get Snapshot Content\" to convert json to a list of properties with ul > li\nuse returned images to present home briefing"
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "679e5b92-7b52-4230-a395-f3840d167756",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -960,
          -600
        ],
        "parameters": {
          "width": 1260,
          "height": 880,
          "content": "# Real Estate AI Agent with Bright Data\n\n## TODO\n- After pasting this workflow, update node \"Get Snapshot Content\" tool and add current Workflow ID (for instance, if your workflow in n8n has the next url https://n8n-ai.cr.vps2.clients.killia.com/workflow/fjEIEQ1L6n2IKqlx your workflow Id is fjEIEQ1L6n2IKqlx).\n- Add your Bright Data api key to \"Filter Dataset\" tool and \"Recover Snapshot Content\" node."
        },
        "typeVersion": 1
      },
      {
        "id": "118c60c3-3a46-4ca2-be84-997218949bde",
        "name": "Recover Snapshot Content",
        "type": "n8n-nodes-brightdata.brightData",
        "position": [
          -340,
          -340
        ],
        "parameters": {
          "resource": "marketplaceDataset",
          "operation": "getSnapshotContent",
          "snapshot_id": "={{ $('When Executed by Another Workflow').item.json.query }}"
        },
        "credentials": {
          "brightdataApi": {
            "id": "jk945kIuAFAo9bcg",
            "name": "BrightData account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "5cc00806-6995-4d82-a832-f3159a66e31a",
        "name": "Get Snapshot Content",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          -100,
          140
        ],
        "parameters": {
          "workflowId": {
            "__rl": true,
            "mode": "id",
            "value": "Ky9jD15PJgT7PIgP"
          },
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.2
      }
    ],
    "pinData": {},
    "connections": {
      "Wait": {
        "main": [
          [
            {
              "node": "Recover Snapshot Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter Dataset": {
        "ai_tool": [
          [
            {
              "node": "Real Estate AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "Real Estate AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Real Estate AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Snapshot is ready?": {
        "main": [
          [],
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Snapshot Content": {
        "ai_tool": [
          [
            {
              "node": "Real Estate AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Recover Snapshot Content": {
        "main": [
          [
            {
              "node": "Snapshot is ready?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Real Estate AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When Executed by Another Workflow": {
        "main": [
          [
            {
              "node": "Recover Snapshot Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "dDInVHNAfSedBUCb",
    "meta": {
      "instanceId": "fddb3e91967f1012c95dd02bf5ad21f279fc44715f47a7a96a33433621caa253"
    },
    "name": "外送記帳",
    "tags": [],
    "nodes": [
      {
        "id": "09c19ba1-45f2-43af-9985-3508d801c1b7",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          440,
          0
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "18625b1d-f8ff-4e48-8b64-a9d42d24eccc",
        "name": "Click to Test Flow",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          40,
          0
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "649933c4-b16b-46de-9038-7d8c0b3d8e88",
        "name": "Get emails from Gmail with certain subject",
        "type": "n8n-nodes-base.gmail",
        "position": [
          220,
          0
        ],
        "webhookId": "99c4deca-17c7-47ae-a38c-50344938e792",
        "parameters": {
          "simple": false,
          "filters": {
            "q": "subject:透過 Uber Eats 系統送出的訂單"
          },
          "options": {},
          "operation": "getAll",
          "returnAll": true
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "34rX9kxKlJadOY6u",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "b2118a34-52ad-4464-b7ea-7f3105536fad",
        "name": "Receive certain keyword Gmail Trigger",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          120,
          -180
        ],
        "parameters": {
          "simple": false,
          "filters": {
            "q": "subject:透過 Uber Eats 系統送出的訂單"
          },
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyHour",
                "minute": 30
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "34rX9kxKlJadOY6u",
            "name": "Gmail account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "00986543-d01a-4b11-bbaa-60c73a1dae02",
        "name": "Extract Price, Shop, Date, TIme",
        "type": "n8n-nodes-base.set",
        "position": [
          620,
          60
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "c24405f8-267f-4933-a178-1b51145d62bf",
                "name": "price",
                "type": "string",
                "value": "={{ $json[\"text\"].match(/\\$(\\d+(\\.\\d{2})?)/)[1] }}"
              },
              {
                "id": "968cf7cd-6e28-4328-a829-3fe2cb327643",
                "name": "shop",
                "type": "string",
                "value": "={{ $json[\"text\"].match(/以下是您在([\\u4e00-\\u9fa5a-zA-Z0-9\\s]+)訂購/)[1] }}"
              },
              {
                "id": "53642bcb-f3a6-4086-bdc1-2f8d27927462",
                "name": "date",
                "type": "string",
                "value": "={{ $json[\"text\"].match(/Date: (\\d{4}年\\d{1,2}月\\d{1,2}日)/)[1].replace(\"年\", \".\").replace(\"月\", \".\").replace(\"日\", \"\") }}"
              },
              {
                "id": "cd227132-971b-4970-8b5d-724463efe036",
                "name": "time",
                "type": "string",
                "value": "={{ \n  $json[\"text\"].match(/(上午|下午) (\\d{1,2}):(\\d{2})/) ? \n  ($json[\"text\"].match(/(上午|下午) (\\d{1,2}):(\\d{2})/)[1] === '下午' && $json[\"text\"].match(/(上午|下午) (\\d{1,2}):(\\d{2})/)[2] !== '12' \n    ? (parseInt($json[\"text\"].match(/(上午|下午) (\\d{1,2}):(\\d{2})/)[2]) + 12) + ':' + $json[\"text\"].match(/(上午|下午) (\\d{1,2}):(\\d{2})/)[3] \n    : $json[\"text\"].match(/(上午|下午) (\\d{1,2}):(\\d{2})/)[2] + ':' + $json[\"text\"].match(/(上午|下午) (\\d{1,2}):(\\d{2})/)[3]\n  )\n  : null \n}}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "3d8f97ea-4a0d-4939-898f-8a0ca9415e7d",
        "name": "Send to Slack with Block",
        "type": "n8n-nodes-base.slack",
        "position": [
          800,
          60
        ],
        "webhookId": "0e812732-74d2-4924-8db3-6b9234965937",
        "parameters": {
          "text": "=Ubereat 訂餐資訊: \n商家:  {{ $json.shop }}\n金額: {{ $json.price }}\n日期: {{ $json.date }}\n\n記帳網址:\nmoze3://expense?amount={{ $json.price }}&account=信用卡&subcategory=外送&store={{ $json.shop }}&date={{ $json.date }}",
          "select": "channel",
          "blocksUi": "={\n\t\"blocks\": [\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"Ubereat 訂餐資訊:\\n\\n*商家:* {{ $json.shop }}\\n*金額:* {{ $json.price }}\\n*日期:* {{ $json.date }}\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"type\": \"divider\"\n\t\t},\n\t\t{\n\t\t\t\"type\": \"section\",\n\t\t\t\"text\": {\n\t\t\t\t\"type\": \"mrkdwn\",\n\t\t\t\t\"text\": \"Moze 記帳請點我\"\n\t\t\t},\n\t\t\t\"accessory\": {\n\t\t\t\t\"type\": \"button\",\n\t\t\t\t\"text\": {\n\t\t\t\t\t\"type\": \"plain_text\",\n\t\t\t\t\t\"text\": \"記帳\",\n\t\t\t\t\t\"emoji\": true\n\t\t\t\t},\n\t\t\t\t\"value\": \"click\",\n\t\t\t\t\"url\": \"moze3://expense?amount={{ $json.price }}&account=信用卡&subcategory=外送&store={{ $json.shop }}&date={{ $json.date }}&&project=生活開銷&&time={{ $json.time }}\",\n\t\t\t\t\"action_id\": \"button-action\"\n\t\t\t}\n\t\t}\n\t]\n}",
          "channelId": {
            "__rl": true,
            "mode": "list",
            "value": "C0883CJM1UH",
            "cachedResultName": "外送記帳自動化"
          },
          "messageType": "block",
          "otherOptions": {},
          "authentication": "oAuth2"
        },
        "credentials": {
          "slackOAuth2Api": {
            "id": "sD1J9ZLyEhcglrRa",
            "name": "Slack account"
          }
        },
        "typeVersion": 2.3
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "0840254c-0058-47fe-9b22-7fbb93144788",
    "connections": {
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Extract Price, Shop, Date, TIme",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Click to Test Flow": {
        "main": [
          [
            {
              "node": "Get emails from Gmail with certain subject",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send to Slack with Block": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Price, Shop, Date, TIme": {
        "main": [
          [
            {
              "node": "Send to Slack with Block",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Receive certain keyword Gmail Trigger": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get emails from Gmail with certain subject": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "f86tpZtlEF8Fxt6s",
    "meta": {
      "instanceId": "189dde98270e9ce0f006f0e9deb96aa5e627396fc6279cac8902c9b06936984d"
    },
    "name": "Automated Booking Confirmation and Meeting Scheduler",
    "tags": [],
    "nodes": [
      {
        "id": "3dd27b86-6e03-4595-a9fa-2fe3d1210611",
        "name": "Google Forms Webhook1",
        "type": "n8n-nodes-base.webhook",
        "position": [
          176,
          208
        ],
        "webhookId": "0c79affb-61ad-4802-8580-66c5856d66cf",
        "parameters": {
          "path": "google-forms-booking",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "lastNode"
        },
        "typeVersion": 2.1
      },
      {
        "id": "957b6711-281f-4599-9962-84ebf221691a",
        "name": "Merge Form Data1",
        "type": "n8n-nodes-base.merge",
        "position": [
          496,
          224
        ],
        "parameters": {},
        "typeVersion": 3.2
      },
      {
        "id": "3b63fe73-a5e7-4f3e-bf61-e7bd0a9aa63c",
        "name": "Workflow Configuration1",
        "type": "n8n-nodes-base.set",
        "position": [
          848,
          224
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "id-1",
                "name": "calendarId",
                "type": "string",
                "value": "c_91f92ee12632d48cc78642add679d75aa8aecb09abea89eadbc97cb17d2de336@group.calendar.google.com"
              },
              {
                "id": "id-2",
                "name": "slackChannel",
                "type": "string",
                "value": "C09GN4NCTAP"
              },
              {
                "id": "id-3",
                "name": "teammateEmail",
                "type": "string",
                "value": "ojima@g-jete.com"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "66b2895b-8260-4e40-b4ec-39b100b89f77",
        "name": "Extract Booking Details1",
        "type": "n8n-nodes-base.set",
        "position": [
          1168,
          224
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "id-1",
                "name": "customerName",
                "type": "string",
                "value": "={{ $json.body.name }}"
              },
              {
                "id": "id-2",
                "name": "customerEmail",
                "type": "string",
                "value": "={{ $json.body.email }}"
              },
              {
                "id": "id-3",
                "name": "bookingDate",
                "type": "string",
                "value": "={{ $json.body.date }}"
              },
              {
                "id": "id-4",
                "name": "bookingTime",
                "type": "string",
                "value": "={{ $json.body.time }}"
              },
              {
                "id": "34865dea-9db2-4f35-b91b-322572680869",
                "name": "bookingStartISO",
                "type": "string",
                "value": "={{ new Date($json.body.date + 'T' + $json.body.time + ':00+09:00').toISOString() }}"
              },
              {
                "id": "941d5f18-54fd-41ad-8f46-c9f9f13fb32f",
                "name": "bookingEndISO",
                "type": "string",
                "value": "={{ new Date(new Date($json.body.date + 'T' + $json.body.time + ':00+09:00').getTime() + 60*60*1000).toISOString() }}"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "6591a8f7-2400-4de8-9fbe-b35271faf1f8",
        "name": "Check Calendar Availability1",
        "type": "n8n-nodes-base.googleCalendar",
        "position": [
          1472,
          224
        ],
        "parameters": {
          "options": {},
          "timeMax": "={{ $json.bookingEndISO }}",
          "timeMin": "={{ $json.bookingStartISO }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Workflow Configuration1').first().json.calendarId }}"
          },
          "operation": "getAll"
        },
        "typeVersion": 1.3,
        "alwaysOutputData": true
      },
      {
        "id": "d80641b0-9da6-491c-922f-d278c0f030c3",
        "name": "Is Time Slot Available?1",
        "type": "n8n-nodes-base.if",
        "position": [
          1824,
          224
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "14e9293a-f96c-45f1-b216-2c8aaf2fb3e2",
                "operator": {
                  "type": "object",
                  "operation": "empty",
                  "singleValue": true
                },
                "leftValue": "={{ $json }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "76a27cb5-7196-4564-a89a-85d5d0a41d52",
        "name": "Create Calendar Event1",
        "type": "n8n-nodes-base.googleCalendar",
        "position": [
          2144,
          208
        ],
        "parameters": {
          "end": "={{ $('Extract Booking Details1').first().json.bookingEndISO }}",
          "start": "={{ $('Extract Booking Details1').first().json.bookingStartISO }}",
          "calendar": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Workflow Configuration1').first().json.calendarId }}"
          },
          "additionalFields": {
            "summary": "=Booking with {{ $('Extract Booking Details1').first().json.customerName }}",
            "attendees": [
              "={{ $('Extract Booking Details1').first().json.customerEmail }}"
            ],
            "description": "=Customer: {{ $('Extract Booking Details1').first().json.customerName }} ({{ $('Extract Booking Details1').first().json.customerEmail }})"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "9f4ca36f-8f02-43ee-8630-222958201959",
        "name": "Create Zoom Meeting1",
        "type": "n8n-nodes-base.zoom",
        "position": [
          2416,
          208
        ],
        "parameters": {
          "topic": "=Booking with {{ $('Extract Booking Details1').first().json.customerName }}",
          "authentication": "oAuth2",
          "additionalFields": {
            "duration": 60,
            "timeZone": "UTC",
            "startTime": "={{ $('Extract Booking Details1').first().json.bookingStartISO }}"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "a31d67fa-38b4-4276-a0ad-56d1069f95dd",
        "name": "Send Confirmation Email1",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2720,
          208
        ],
        "webhookId": "f28b9459-360b-4cad-9f2e-0d69654e795b",
        "parameters": {
          "sendTo": "={{ $('Extract Booking Details1').first().json.customerEmail }}",
          "message": "=Hi {{ $('Extract Booking Details1').first().json.customerName }},\n\nYour booking has been confirmed!\n\nDate & Time: {{ new Date($('Extract Booking Details1').first().json.bookingStartISO).toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' }) }}\n\nZoom Meeting Link: {{ $json.join_url }}\n\nLooking forward to meeting you!\n\nBest regards",
          "options": {},
          "subject": "=Booking Confirmed: {{ new Date($('Extract Booking Details1').first().json.bookingStartISO).toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' }) }}"
        },
        "typeVersion": 2.1
      },
      {
        "id": "b456c4f9-dcca-48a4-b750-f39e95df493f",
        "name": "Notify Teammate on Slack1",
        "type": "n8n-nodes-base.slack",
        "position": [
          3040,
          208
        ],
        "webhookId": "866a3241-98d2-4db1-b791-c8c8f83b99b9",
        "parameters": {
          "text": "=🎉 New booking confirmed!\n\n*Customer:* {{ $('Extract Booking Details1').first().json.customerName }} ({{ $('Extract Booking Details1').first().json.customerEmail }})\n*Date & Time:* {{ new Date($('Extract Booking Details1').first().json.bookingStartISO).toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' }) }}\n*Zoom Link:* {{ $json.join_url }}",
          "select": "channel",
          "channelId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Workflow Configuration1').first().json.slackChannel }}"
          },
          "otherOptions": {},
          "authentication": "oAuth2"
        },
        "typeVersion": 2.3
      },
      {
        "id": "78d4ae92-b136-4bbe-ae52-a73a60c47a6c",
        "name": "Send Unavailable Email1",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2144,
          512
        ],
        "webhookId": "98dd0319-284e-4b12-a655-a57577571800",
        "parameters": {
          "sendTo": "={{ $('Extract Booking Details1').first().json.customerEmail }}",
          "message": "=Hi {{ $('Extract Booking Details1').first().json.customerName }},\n\nThank you for your booking request. Unfortunately, the requested time slot on {{ new Date($('Extract Booking Details1').first().json.bookingStartISO).toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' }) }} is not available.\n\nPlease submit a new booking request with an alternative time.",
          "options": {},
          "subject": "Time Slot Unavailable"
        },
        "typeVersion": 2.1
      },
      {
        "id": "9f8af7ba-09f1-46bb-9bc6-bb2d0b26d744",
        "name": "Sticky: Google Forms Webhook1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          96,
          -400
        ],
        "parameters": {
          "color": "white",
          "width": 768,
          "height": 528,
          "content": "Title: Automated Booking → Calendar + Zoom + Email + Slack\nWhat this workflow does\n\nCaptures booking submissions from a form and parses date/time.\n\nChecks Google Calendar for conflicts.\n\nIf free: creates a Calendar event → creates a Zoom meeting → emails the guest → notifies your team on Slack.\n\nIf busy: emails the guest to pick another time.\n\nFlow\nWebhook → Merge → Config → Extract details → Check availability → IF (free/busy) →\n[Free] Create Calendar Event → Create Zoom → Email confirmation → Slack notify\n[Busy] Email unavailability\n\nNotes\n\nKeep all user-editable variables in the Set nodes for easy maintenance.\n\nDate handling assumes Asia/Tokyo input and converts to ISO for API calls.\n\nNo hardcoded credentials inside HTTP nodes; store secrets via Credentials."
        },
        "typeVersion": 1
      },
      {
        "id": "5eb1dc05-5c0f-44a0-9000-d4abdd74a981",
        "name": "Sticky: Merge Form Data1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          80,
          384
        ],
        "parameters": {
          "color": "white",
          "width": 256,
          "height": 176,
          "content": "Purpose: Entry point for bookings. Receives a POST payload from your form (name, email, date, time).\nOutput: Raw form fields under body.* used downstream."
        },
        "typeVersion": 1
      },
      {
        "id": "967bcc58-fc07-4e4c-8b17-5f2a99f9287f",
        "name": "Sticky: Workflow Configuration1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          384
        ],
        "parameters": {
          "color": "white",
          "width": 272,
          "height": 176,
          "content": "Purpose: Normalizes/forwards webhook data to keep a single item moving through the flow.\nTip: Use this as a “buffer” if you ever add parallel inputs later."
        },
        "typeVersion": 1
      },
      {
        "id": "663ecdf9-6f9d-481c-abe6-e7d8b3c34021",
        "name": "Sticky: Extract Booking Details1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          736,
          384
        ],
        "parameters": {
          "color": "white",
          "width": 288,
          "height": 176,
          "content": "Purpose: Central place for editable constants (e.g., calendarId, slackChannel, teammateEmail).\nWhy: Makes the template plug-and-play—update values here instead of hunting through nodes."
        },
        "typeVersion": 1
      },
      {
        "id": "c12bee38-9494-43b7-9961-2e4971a92316",
        "name": "Sticky: Check Calendar Availability1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1088,
          384
        ],
        "parameters": {
          "color": "white",
          "width": 272,
          "height": 176,
          "content": "Purpose: Maps form fields to clean variables: customerName, customerEmail, bookingDate, bookingTime.\nAlso: Builds bookingStartISO and bookingEndISO (60-min duration) using the submitted local time (JST) → ISO strings."
        },
        "typeVersion": 1
      },
      {
        "id": "b58f33ab-ad60-4a98-9354-3ed1a1aeab72",
        "name": "Sticky: Is Time Slot Available?1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1424,
          384
        ],
        "parameters": {
          "color": "white",
          "width": 256,
          "height": 176,
          "content": "Purpose: Queries the target calendar for events overlapping bookingStartISO–bookingEndISO.\nBehavior: Returns an empty list when the slot is free; non-empty when it’s taken."
        },
        "typeVersion": 1
      },
      {
        "id": "b0b7376c-f552-4ce9-bd31-33919ba04618",
        "name": "Sticky: Create Calendar Event1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1744,
          384
        ],
        "parameters": {
          "color": "white",
          "width": 256,
          "height": 176,
          "content": "Purpose: Branches on availability.\nTrue (empty result): Slot is free → proceed to create the event.\nFalse (has events): Slot is busy → send “unavailable” email."
        },
        "typeVersion": 1
      },
      {
        "id": "bb03b52c-ddc4-4896-9016-6d01ab6b68ec",
        "name": "Sticky: Create Zoom Meeting1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2000,
          16
        ],
        "parameters": {
          "color": "white",
          "width": 272,
          "content": "Purpose: Books the time on Google Calendar with the guest as an attendee.\nFields: Summary includes guest name; Description includes name + email for quick context."
        },
        "typeVersion": 1
      },
      {
        "id": "73736740-501f-4814-9722-e8576e2dd21f",
        "name": "Sticky: Send Confirmation Email1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2336,
          16
        ],
        "parameters": {
          "color": "white",
          "content": "Purpose: Creates a Zoom meeting for the confirmed slot.\nTiming: Uses the booking start time and a 60-minute duration.\nOutput: Provides join_url used by Email/Slack steps."
        },
        "typeVersion": 1
      },
      {
        "id": "6e9c22c3-0b31-47f9-ab96-4476e501175d",
        "name": "Sticky: Notify Teammate on Slack1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2640,
          16
        ],
        "parameters": {
          "color": "white",
          "width": 256,
          "content": "Purpose: Sends a confirmation to the guest with local (Japan) date/time and the Zoom link.\nSubject/Body: Human-readable datetime via toLocaleString('ja-JP', { timeZone: 'Asia/Tokyo' })."
        },
        "typeVersion": 1
      },
      {
        "id": "b9aa000c-63a2-44b1-800a-c041a1582f64",
        "name": "Sticky: Send Unavailable Email1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2064,
          672
        ],
        "parameters": {
          "color": "white",
          "width": 256,
          "content": "Purpose: Notifies the guest when the requested slot is already taken and asks them to rebook another time."
        },
        "typeVersion": 1
      },
      {
        "id": "3904238d-39eb-40f0-879f-3f17e1afd303",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2960,
          16
        ],
        "parameters": {
          "content": "Purpose: Posts a concise booking summary to your specified Slack channel.\nIncludes: Guest name/email, localized date/time, and Zoom join_url."
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "31e08b0e-50a9-485b-b16c-856d2311d0f5",
    "connections": {
      "Merge Form Data1": {
        "main": [
          [
            {
              "node": "Workflow Configuration1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Zoom Meeting1": {
        "main": [
          [
            {
              "node": "Send Confirmation Email1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Forms Webhook1": {
        "main": [
          [
            {
              "node": "Merge Form Data1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Calendar Event1": {
        "main": [
          [
            {
              "node": "Create Zoom Meeting1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Workflow Configuration1": {
        "main": [
          [
            {
              "node": "Extract Booking Details1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Booking Details1": {
        "main": [
          [
            {
              "node": "Check Calendar Availability1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Time Slot Available?1": {
        "main": [
          [
            {
              "node": "Create Calendar Event1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Send Unavailable Email1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Confirmation Email1": {
        "main": [
          [
            {
              "node": "Notify Teammate on Slack1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Calendar Availability1": {
        "main": [
          [
            {
              "node": "Is Time Slot Available?1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "AvXlqUiuc1qJSwxf",
    "meta": {
      "instanceId": "14e4c77104722ab186539dfea5182e419aecc83d85963fe13f6de862c875ebfa"
    },
    "name": "Forward Filtered Gmail Notifications to Telegram Chat",
    "tags": [],
    "nodes": [
      {
        "id": "99441348-1d5d-459f-961f-48bd593144f2",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          0
        ],
        "parameters": {
          "color": 4,
          "width": 1000,
          "height": 300,
          "content": "# Forward Filtered Gmail Notifications to Telegram Chat\n"
        },
        "typeVersion": 1
      },
      {
        "id": "eadf565c-e753-4682-a8c2-6bc630a30a27",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          320
        ],
        "parameters": {
          "color": 4,
          "width": 1000,
          "height": 200,
          "content": "## Description :\n### This n8n workflow automatically forwards incoming Gmail emails to a Telegram chat only if the email subject contains specific keywords (like \"Urgent\" or \"Server Down\"). The workflow extracts key details such as the sender, subject, and message body, and sends them as a formatted message to a specified Telegram chat. This is useful for real-time notifications, security alerts, or monitoring important emails directly from Telegram — filtering out unnecessary emails."
        },
        "typeVersion": 1
      },
      {
        "id": "bb2a78d7-91ba-4e8c-a9f1-af270a50bd8f",
        "name": "Incoming Email Monitor",
        "type": "n8n-nodes-base.gmailTrigger",
        "position": [
          20,
          100
        ],
        "parameters": {
          "filters": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          }
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "5V09QSJCeHoQoKUp",
            "name": "SM MaryP (Gmail)"
          }
        },
        "notesInFlow": false,
        "typeVersion": 1.2
      },
      {
        "id": "addffc7b-ef58-4fb5-9275-3db6fd84f4c0",
        "name": "Email Validation Check",
        "type": "n8n-nodes-base.if",
        "position": [
          340,
          100
        ],
        "parameters": {
          "options": {
            "ignoreCase": false
          },
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "or",
            "conditions": [
              {
                "id": "2496d01f-dbd5-4e23-84c3-f78decb87697",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $json.Subject }}",
                "rightValue": "Urgent"
              },
              {
                "id": "274e9e05-5c74-487e-851d-0ca62210cb99",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.Subject }}",
                "rightValue": "Server Down"
              }
            ]
          },
          "looseTypeValidation": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "e87d46b6-efc6-466f-a708-bfbf34bf001b",
        "name": "Send Telegram Message",
        "type": "n8n-nodes-base.telegram",
        "position": [
          700,
          80
        ],
        "webhookId": "c8f1d16f-b698-4af9-a795-9aaa277c2bf6",
        "parameters": {
          "text": "=From : {{ $json.From }}\nSubject :{{ $json.Subject }}\nMessage : {{ $json.snippet }}\n",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "notesInFlow": false,
        "typeVersion": 1.2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "caf5eedb-4c6b-4bfa-9a0a-2d868291a83c",
    "connections": {
      "Email Validation Check": {
        "main": [
          [
            {
              "node": "Send Telegram Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Incoming Email Monitor": {
        "main": [
          [
            {
              "node": "Email Validation Check",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "cmncRJ2rlecEwZxU",
    "meta": {
      "instanceId": "ed6d846a2fce1f660ede2e7da800724cca01dc3d0685524a3c917881b7cfcfe9"
    },
    "name": "[Agent Circle's N8N Workflow] Automated AI Image Creator",
    "tags": [],
    "nodes": [
      {
        "id": "d5d1fe1b-f053-4162-adf4-5b52b409942d",
        "name": "Fields - Set Values",
        "type": "n8n-nodes-base.set",
        "position": [
          240,
          100
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "4e04fec4-441e-45f7-acea-0017a4b5c104",
                "name": "model",
                "type": "string",
                "value": "flux"
              },
              {
                "id": "aa80cd68-1c82-4032-b1d7-e098856eec38",
                "name": "width",
                "type": "string",
                "value": "1080"
              },
              {
                "id": "da6d305f-aece-49bd-ae02-52df59915c60",
                "name": "height",
                "type": "string",
                "value": "1920"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "e108c56f-b7fb-4818-aed5-c55c59b81516",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          20,
          200
        ],
        "webhookId": "5b347b5d-8f35-45b3-a499-de95153088f0",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "7565ff7c-cfe7-4157-953b-74c1e66d659e",
        "name": "Code - Clean Json",
        "type": "n8n-nodes-base.code",
        "position": [
          980,
          100
        ],
        "parameters": {
          "jsCode": "function cleanAndExtractJSON(response) {\n    try {\n        const result = {\n            image_prompt: []\n        };\n\n        const lines = response.split('\\n');\n        let currentPrompt = '';\n\n        for (const line of lines) {\n            if (line.includes('\"prompt\":')) {\n                if (currentPrompt) {\n                    result.image_prompt.push(currentPrompt.trim());\n                }\n                currentPrompt = line.split('\"prompt\":')[1].trim();\n            }\n        }\n\n        if (currentPrompt) {\n            result.image_prompt.push(currentPrompt.trim());\n        }\n\n        return { json: result };\n        \n    } catch (error) {\n        return { \n            json: {\n                image_prompt: []\n            }\n        };\n    }\n}\n\nconst response = $input.first().json.output;\nreturn cleanAndExtractJSON(response);"
        },
        "executeOnce": false,
        "typeVersion": 2,
        "alwaysOutputData": true
      },
      {
        "id": "8e33813d-bd34-46b9-91c8-89dac7f28add",
        "name": "Code - Get Prompt",
        "type": "n8n-nodes-base.code",
        "position": [
          1160,
          100
        ],
        "parameters": {
          "jsCode": "return $input.first().json.image_prompt.map(prompt => ({\n  json: {\n    body: {\n      prompt: prompt,\n  \"image_size\": {\n    \"width\": $('Fields - Set Values').first().json.width,\n    \"height\": $('Fields - Set Values').first().json.height\n  },\n  \"num_inference_steps\": 12,\n  \"guidance_scale\": 3.5,\n  \"num_images\": 1,\n  \"enable_safety_checker\": true,\n}\n    }\n  }\n));"
        },
        "typeVersion": 2,
        "alwaysOutputData": true
      },
      {
        "id": "fba88baa-70e8-452c-b44e-d1685df0eb7d",
        "name": "HTTP Request - Create Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1600,
          100
        ],
        "parameters": {
          "url": "=https://image.pollinations.ai/prompt/ {{ $('Code - Get Prompt').item.json.body.prompt }}",
          "options": {},
          "jsonQuery": "={\n  \"width\": {{ $('Fields - Set Values').item.json.width }},\n  \"height\": {{ $('Fields - Set Values').item.json.height }},\n  \"model\": \"{{ $('Fields - Set Values').item.json.model }}\",\n  \"seed\": 42,\n  \"nologo\": true\n}",
          "sendQuery": true,
          "sendHeaders": true,
          "specifyQuery": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              },
              {
                "name": "Accept",
                "value": "application/json"
              }
            ]
          }
        },
        "retryOnFail": true,
        "typeVersion": 4.2,
        "alwaysOutputData": true,
        "waitBetweenTries": 5000
      },
      {
        "id": "25617f21-8d05-4ca2-9c16-5cd97e369bdb",
        "name": "Telegram Trigger",
        "type": "n8n-nodes-base.telegramTrigger",
        "disabled": true,
        "position": [
          20,
          0
        ],
        "webhookId": "ff17baeb-3182-41c4-b60a-e6159b02023b",
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "typeVersion": 1.2
      },
      {
        "id": "de666684-e743-40ef-b604-1cff33b107de",
        "name": "Code - Set Filename",
        "type": "n8n-nodes-base.code",
        "position": [
          1320,
          100
        ],
        "parameters": {
          "jsCode": "for (let i = 0; i < items.length; i++) {\n  items[i].json.fileName = `images_${(i + 1).toString().padStart(3, '0')}.png`;\n}\nreturn items;"
        },
        "typeVersion": 2
      },
      {
        "id": "e04c2a46-a670-4042-88d1-79207731c864",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          540,
          300
        ],
        "parameters": {
          "options": {
            "topK": 40,
            "topP": 1,
            "temperature": 0.5,
            "safetySettings": {
              "values": [
                {
                  "category": "HARM_CATEGORY_HARASSMENT",
                  "threshold": "BLOCK_NONE"
                },
                {
                  "category": "HARM_CATEGORY_HATE_SPEECH",
                  "threshold": "BLOCK_NONE"
                },
                {
                  "category": "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                  "threshold": "BLOCK_NONE"
                },
                {
                  "category": "HARM_CATEGORY_DANGEROUS_CONTENT",
                  "threshold": "BLOCK_NONE"
                }
              ]
            },
            "maxOutputTokens": 65536
          },
          "modelName": "models/gemini-2.0-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "AlDwotqhFT4EfJXQ",
            "name": "Google Gemini(PaLM) Api - toan.ngo"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d2d0e95d-797e-473c-a70f-d8c4cccd32af",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -680,
          -760
        ],
        "parameters": {
          "width": 520,
          "height": 1480,
          "content": "## [Agent Circle's N8N Workflow] Automated AI Image Creator - Try It Out!\n\n**This n8n template demonstrates how to use AI to generate custom images from scratch - fully automated, prompt-driven, and ready to deploy at scale.**\n\nUse cases are many: You can use it for marketing visuals, character art, digital posters, storyboards, or even daily image generation for your personal purposes.\n\n## How It Works\n- The flow is triggered by a chat message in N8N or via Telegram. The default image size is 1080 x 1920 pixels. To use a different size, update the values in the **“Fields - Set Values”** node before triggering the workflow.\n- The input is parsed into a clean, structured prompt using a multi-step transformation process.\n- Our AI Agent sends the final prompt to Google Gemini’s image model for generation (you can also integrate with OpenAI or other chat models).\n- The raw image data created by the AI Agent will be run through a number of codes to make sure it's feasible for your preview if needed and downloading.\n- Then, we use an HTTP node to fetch the result so you can preview the image.\n- You can send it back to the chat message in N8N or Telegram, or save it locally to your disk.\n\n## How To Use\n- Download the workflow package.\n- Import the package into your N8N interface.\n- Set up the credentials in the following nodes for tool access and usability: **\"Telegram Trigger\"**; **\"AI Agent - Create Image From Prompt\"**; **\"Telegram Response\"** or **\"Save Image To Disk\"** (based on your wish).\n- Activate the **\"Telegram Response\"** OR **\"Save Image To Disk\"** node to specify where you want to save your image later.\n- Open the chat interface (via N8N or Telegram).\n- Type your image prompt or detailed descriptions and send.\n- Wait for the process to run and finish in a few seconds.\n- Check the result in your desired saving location.\n\n## Requirements\n- Google Gemini account with image generation access.\n- Telegram bot access and chat setup (optional).\n- Connection to local storage (optional).\n\n## How To Customize\n- We’re setting the default image size to 1080 x 1920 pixels and the default image model to \"flux\". You can customize both of these values in the **“Fields – Set Values”** node. Supported image model options include: \"flux\", \"kontext\", \"turbo\", and \"gptimage\".\n- In the **“AI Agent – Create Image From Prompt”** node, you can also change the AI chat model. By default, it uses Google Gemini, but you can easily replace it with OpenAI ChatGPT, Microsoft AI Copilot, or any other compatible provider.\n\n## Need Help?\nJoin our community on different platforms for support, inspiration and tips from others.\n\nWebsite: https://www.agentcircle.ai/\nEtsy: https://www.etsy.com/shop/AgentCircle\nGumroad: http://agentcircle.gumroad.com/\nDiscord Global: https://discord.gg/d8SkCzKwnP\nFB Page Global: https://www.facebook.com/agentcircle/\nFB Group Global: https://www.facebook.com/groups/aiagentcircle/\nX: https://x.com/agent_circle\nYouTube: https://www.youtube.com/@agentcircle\nLinkedIn: https://www.linkedin.com/company/agentcircle"
        },
        "typeVersion": 1
      },
      {
        "id": "cb6fb57a-e3c1-45ff-9b81-4a2152f397fc",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -60,
          -200
        ],
        "parameters": {
          "color": 7,
          "width": 440,
          "height": 620,
          "content": "## **1. Get The Inputs**\nWe’ll take your image idea from the text you send in the chat, along with any settings like image size or style. This information is parsed and prepared for the image generation step.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "876439a4-dbfe-4394-96d7-8f6c8a63778d",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          460,
          -200
        ],
        "parameters": {
          "color": 7,
          "width": 420,
          "height": 620,
          "content": "## **2. Use Google Gemini's Image Model To Generate The Image**\nYour prompt and settings are sent to Google Gemini’s Image Generation Model.\nPrefer a different model? You can easily swap in alternatives like OpenAI ChatGPT or Microsoft Copilot.\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "ac07f44c-c881-4d80-bd65-a8aa0ce39375",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1540,
          -200
        ],
        "parameters": {
          "color": 7,
          "width": 540,
          "height": 620,
          "content": "## **4. Preview And Save The Image**\nOnce your image is ready in a downloadable format, you’ll be able to preview it. If you're happy with the result, you can save it in one of two ways by activating either of them before running the workflow:\n- As a reply in Telegram chat\n- To your local storage (disk)\n\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "fdd981c2-2659-4a31-b37f-b5c4cd51ee3c",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          940,
          -200
        ],
        "parameters": {
          "color": 7,
          "width": 520,
          "height": 620,
          "content": "## **3. Prepare The Final Image Feasible For Preview And Saving**\nThis stage helps to clean up the raw output from the AI Agent for your image request and format it into a complete, ready-to-view and downloadable format. \n"
        },
        "typeVersion": 1
      },
      {
        "id": "3a150703-2a7f-4255-9da0-6a15c005290c",
        "name": "AI Agent - Create Image From Prompt",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          540,
          100
        ],
        "parameters": {
          "text": "={{ $('When chat message received').item.json.chatInput }}",
          "options": {
            "systemMessage": "=You are an AI image‑prompt creation expert. Please create a post using the following JSON format:\nAI Image Generation Prompt Guidelines:\nObjective\nCreate highly realistic, high‐quality images\nEnsure the image content faithfully conveys the spirit of the original text\nIntegrate short text (10–20 characters) naturally into the image\nMaintain consistency and professionalism\n\nStandard Prompt Structure\n[Main Scene] | [Key Elements] | [Text Integration] | [Lighting & Atmosphere] | [Technical Parameters] | [Style Parameters]\n\nComponent Breakdown\n1. Main Scene (Weight ::8)\nDescribe the primary setting in line with the content.\nExamples:\nTech news: “modern tech office setting, minimalist workspace”\nEconomy news: “professional financial district, corporate environment”\nEducation news: “modern classroom, advanced learning environment”\n\n2. Key Elements (Weight ::8)\nList the main visual elements required.\nExamples:\n“large HD display showing text ‘AI Ethics’ in modern typography”\n“professional people in business attire discussing around interactive screen”\n“detailed infographic elements floating in augmented reality style”\n\n3. Text Integration (Weight ::7)\nHow to display text within the image:\ntext elements | elegant typography, clear readable text, integrated naturally into scene ::7\n\n4. Lighting & Atmosphere (Weight ::7)\nlighting | cinematic dramatic lighting, natural ambient light, professional studio setup ::7\nbackground | depth of field blur, clean professional environment ::6\n\n5. Technical Parameters\nparameters | 8k resolution, hyperrealistic, photorealistic quality, octane render, cinematic composition --ar 16:9\nsettings | sharp focus, high detail, professional photography --s 1000 --q 2\nComplete Examples\nExample 1: AI Ethics News\nprofessional tech conference room | large display showing \"AI Ethics Now\" in modern typography, group of diverse executives in discussion ::8 | clean modern workspace, glass walls, tech atmosphere ::7 | cinematic lighting, natural window light ::7 | 8k resolution, hyperrealistic quality, octane render --ar 16:9 --s 1000 --q 2\nExample 2: Financial Market News\nmodern stock exchange environment | giant LED wall showing \"Market Alert\" in bold typography, professional traders in action ::8 | dynamic financial data visualization, sleek modern interior ::7 | dramatic lighting, blue-tinted atmosphere ::7 | 8k resolution, photorealistic quality --ar 16:9 --s 1000 --q 2\n\nAdditional Parameters\n--chaos [0–100]: Adjust randomness\n--stylize [0–1000]: Degree of stylization\n--seed [number]: Ensure consistency across generations\n--niji: Optimized for Asian‐style aesthetics\n--v 5.2: Use the latest model version\n\nImportant Notes\nText in Image\nKeep it short and legible\nUse professional fonts\nIntegrate naturally into the scene\n\nComposition\nFollow the rule of thirds\nEnsure a clear focal point\nBalance text and imagery\n\nColor\nMatch a professional tone\nProvide sufficient contrast for readability\nMaintain visual consistency\n\nTechnical Details\nAlways use high resolution (8k)\nEnsure professional lighting\nOptimize for sharpness and detail\n\nCommon Pitfalls to Avoid\nOverly generic prompts\nMissing text‐integration guidance\nFailing to specify composition rules\nOmitting key technical parameters\n\nThe structure is:\n{\n  prompt_image {prompt : \"\" , ...}\n}"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "a3e5fa40-51c1-41fa-83cb-d6d598f1ff49",
        "name": "Telegram Response",
        "type": "n8n-nodes-base.telegram",
        "disabled": true,
        "position": [
          1820,
          0
        ],
        "webhookId": "ca4806ac-202c-4709-92f9-6484397c17c4",
        "parameters": {
          "operation": "sendPhoto",
          "binaryData": true,
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "haaaQCcDSaJAtymy",
            "name": "Telegram account - hoanglt"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "f7059ea5-106b-4b73-8cb3-b0e10e1c0c13",
        "name": "Save Image To Disk",
        "type": "n8n-nodes-base.readWriteFile",
        "disabled": true,
        "position": [
          1820,
          200
        ],
        "parameters": {
          "options": {},
          "fileName": "=/files/{{ $('Code').item.json.fileName }}",
          "operation": "write"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "e8e33a23-ea10-4311-947e-2456c934f811",
    "connections": {
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "Fields - Set Values",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code - Clean Json": {
        "main": [
          [
            {
              "node": "Code - Get Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code - Get Prompt": {
        "main": [
          [
            {
              "node": "Code - Set Filename",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code - Set Filename": {
        "main": [
          [
            {
              "node": "HTTP Request - Create Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fields - Set Values": {
        "main": [
          [
            {
              "node": "AI Agent - Create Image From Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent - Create Image From Prompt",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Fields - Set Values",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request - Create Image": {
        "main": [
          [
            {
              "node": "Save Image To Disk",
              "type": "main",
              "index": 0
            },
            {
              "node": "Telegram Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent - Create Image From Prompt": {
        "main": [
          [
            {
              "node": "Code - Clean Json",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "cbeBbWowy2c7CXli",
    "meta": {
      "instanceId": "3378b0d68c3b7ebfc71b79896d94e1a044dec38e99a1160aed4e9c323910fbe2",
      "templateId": "2894",
      "templateCredsSetupCompleted": true
    },
    "name": "From Google Drive to Instagram, TikTok & YouTube with Airtable Tracking",
    "tags": [],
    "nodes": [
      {
        "id": "b8885dc4-76bc-4b56-9c4e-0d731a7f3ed5",
        "name": "Set Variables",
        "type": "n8n-nodes-base.set",
        "position": [
          -1360,
          420
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "cd270863-aa35-418c-a0ae-1b5878eee2ed",
                "name": "airtable_app_id",
                "type": "string",
                "value": "add_airtable_app_id"
              },
              {
                "id": "00ef91b2-8a4c-42bb-a46f-f7eb06e861e8",
                "name": "airtable_table_id",
                "type": "string",
                "value": "add_airtable_table_id"
              },
              {
                "id": "21b5d3ad-ff81-407e-8c4e-53bda8a16e0e",
                "name": "upload_post_user",
                "type": "string",
                "value": "test2"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "d2c433ef-4270-421c-888b-799aff78ed4e",
        "name": "Google Drive Trigger",
        "type": "n8n-nodes-base.googleDriveTrigger",
        "position": [
          -2760,
          420
        ],
        "parameters": {
          "event": "fileCreated",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "specificFolder",
          "folderToWatch": {
            "__rl": true,
            "mode": "list",
            "value": "18m0i341QLQuyWuHv_FBdz8-r-QDtofYm",
            "cachedResultUrl": "https://drive.google.com/drive/folders/18m0i341QLQuyWuHv_FBdz8-r-QDtofYm",
            "cachedResultName": "Influencersde"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "2TbhWtnbRfSloGxX",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "f4d2437f-c71d-41d7-bb2e-0fa5c65f4d73",
        "name": "Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          -2600,
          420
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "",
            "value": "={{ $json.id || $json.data[0].id }}"
          },
          "options": {},
          "operation": "download",
          "authentication": "oAuth2"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "2TbhWtnbRfSloGxX",
            "name": "Google Drive account"
          }
        },
        "retryOnFail": true,
        "typeVersion": 1,
        "waitBetweenTries": 5000
      },
      {
        "id": "076df93e-a62e-43e2-9ddd-0e37f90970e3",
        "name": "Create Airtable Record",
        "type": "n8n-nodes-base.airtable",
        "position": [
          -1160,
          420
        ],
        "parameters": {
          "table": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Set Variables').item.json.airtable_table_id }}"
          },
          "fields": [
            "Video Name"
          ],
          "options": {},
          "operation": "append",
          "application": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $('Set Variables').item.json.airtable_app_id }}"
          },
          "addAllFields": false,
          "authentication": "airtableTokenApi"
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "hL7oYzyKTidpSiaC",
            "name": "jc.caverogracia airtable"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "df8cde79-4733-4ece-980e-2358cf7d46e5",
        "name": "Error Trigger",
        "type": "n8n-nodes-base.errorTrigger",
        "position": [
          -2260,
          760
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "849ca263-1ef0-4efb-9560-4794ba79e385",
        "name": "Telegram",
        "type": "n8n-nodes-base.telegram",
        "position": [
          -1920,
          740
        ],
        "webhookId": "f6729386-9905-45f1-800f-4fe01a06ac9c",
        "parameters": {
          "text": "=🔔 ERROR SUBIENDO VIDEOS",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "credentials": {
          "telegramApi": {
            "id": "r4LoygShiT3ucqa7",
            "name": "DegenMrbot"
          }
        },
        "retryOnFail": true,
        "typeVersion": 1.2,
        "waitBetweenTries": 5000
      },
      {
        "id": "190073de-a9a0-43b7-bab3-5e67bb2c0592",
        "name": "If",
        "type": "n8n-nodes-base.if",
        "position": [
          -2120,
          760
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 1,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "9fadb3fd-2547-42bd-8f40-f410a97dcf57",
                "operator": {
                  "type": "string",
                  "operation": "notContains"
                },
                "leftValue": "={{ $json.trigger.error.message }}",
                "rightValue": "The DNS server returned an error, perhaps the server is offline"
              }
            ]
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "a7e3b33c-1235-49a8-b761-3ff2aa5444b4",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -3100,
          80
        ],
        "parameters": {
          "width": 860,
          "height": 300,
          "content": "## Description\nThis automation allows you to upload a video to a configured Google Drive folder, and it will automatically create descriptions and upload it to Instagram, TikTok, and YouTube with Airtable tracking.\n\n## How to Use\n1. Configure your Airtable base and table IDs in the Set Variables node\n2. Set up Airtable fields: Video Name, Google Drive Link, File ID, Instagram Status, TikTok Status, YouTube Status, Upload Date, Description\n3. Generate an API token at upload-post.com and add to Upload nodes\n4. Configure your Google Drive folder\n5. Customize the OpenAI prompt for your specific use case\n6. Optional: Configure Telegram for error notifications\n\n## Requirements\n- Airtable account with configured base\n- upload-post.com account\n- Google Drive account\n- OpenAI API key\n"
        },
        "typeVersion": 1
      },
      {
        "id": "ef2cd154-331a-47d6-b785-5354b3a4f952",
        "name": "Get Audio from Video",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "notes": "Extract the audio from video for generate the description",
        "position": [
          -1960,
          420
        ],
        "parameters": {
          "options": {},
          "resource": "audio",
          "operation": "transcribe"
        },
        "credentials": {
          "openAiApi": {
            "id": "XJdxgMSXFgwReSsh",
            "name": "n8n key"
          }
        },
        "notesInFlow": true,
        "retryOnFail": true,
        "typeVersion": 1,
        "waitBetweenTries": 5000
      },
      {
        "id": "7b877a93-99ac-4c9b-a0f0-ea6188755723",
        "name": "Read video from Google Drive",
        "type": "n8n-nodes-base.writeBinaryFile",
        "position": [
          -2380,
          420
        ],
        "parameters": {
          "options": {},
          "fileName": "={{ $json.originalFilename.replaceAll(\" \", \"_\") }}"
        },
        "typeVersion": 1
      },
      {
        "id": "9b7f3002-88c4-4d08-bdf4-2bede89f6057",
        "name": "Generate Description for Videos",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "notes": "Request to OpenAi for generate description with the audio extracted from the video",
        "position": [
          -1740,
          420
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "role": "system",
                "content": "You are an expert assistant in creating engaging social media video titles."
              },
              {
                "content": "=I'm going to upload a video to social media. Here are some examples of descriptions that have worked well on Instagram:\n\nFollow and save for later. Discover InfluencersDe, the AI tool that automates TikTok creation and publishing to drive traffic to your website. Perfect for entrepreneurs and brands.\n#digitalmarketing #ugc #tiktok #ai #influencersde #contentcreation\n\nDiscover the video marketing revolution with InfluencersDe!\n.\n.\n.\n#socialmedia #videomarketing #ai #tiktok #influencersde #growthhacking\n\nDon't miss InfluencersDe, the tool that transforms your marketing strategy with just one click!\n.\n.\n.\n#ugc #ai #tiktok #digitalmarketing #influencersde #branding\n\nCan you create another title for the Instagram post based on this recognized audio from the video?\n\nAudio: {{ $('Get Audio from Video').item.json.text }}\n\nIMPORTANT: Reply only with the description, don't add anything else."
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "XJdxgMSXFgwReSsh",
            "name": "n8n key"
          }
        },
        "notesInFlow": true,
        "retryOnFail": true,
        "typeVersion": 1.4,
        "waitBetweenTries": 5000
      },
      {
        "id": "acca4940-d172-427a-acf1-1e110c020e64",
        "name": "Update Airtable with Description",
        "type": "n8n-nodes-base.airtable",
        "position": [
          -780,
          420
        ],
        "parameters": {
          "id": "={{ $('Create Airtable Record').item.json.id }}",
          "table": {
            "__rl": true,
            "mode": "",
            "value": "={{ $('Set Variables').item.json.airtable_table_id }}"
          },
          "fields": [
            "Description",
            "Video Name",
            "Google Drive Links",
            "Upload Date"
          ],
          "options": {},
          "operation": "update",
          "application": {
            "__rl": true,
            "mode": "",
            "value": "={{ $('Set Variables').item.json.airtable_app_id }}"
          },
          "authentication": "airtableTokenApi",
          "updateAllFields": false
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "hL7oYzyKTidpSiaC",
            "name": "jc.caverogracia airtable"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d4a58a14-173a-4354-aa80-1c3948ae1062",
        "name": "Read Video for TikTok",
        "type": "n8n-nodes-base.readBinaryFile",
        "position": [
          -260,
          180
        ],
        "parameters": {
          "filePath": "={{ $('Read video from Google Drive').item.json.originalFilename.replaceAll(\" \", \"_\") }}",
          "dataPropertyName": "datavideo"
        },
        "typeVersion": 1
      },
      {
        "id": "a9478d0d-4498-4259-be7c-650624e9d519",
        "name": "Read Video for Instagram",
        "type": "n8n-nodes-base.readBinaryFile",
        "position": [
          -280,
          480
        ],
        "parameters": {
          "filePath": "={{ $('Read video from Google Drive').item.json.originalFilename.replaceAll(\" \", \"_\") }}",
          "dataPropertyName": "datavideo"
        },
        "typeVersion": 1
      },
      {
        "id": "4b67d5d9-2f33-4a18-a1f1-65834e0f6eeb",
        "name": "Read Video for YouTube",
        "type": "n8n-nodes-base.readBinaryFile",
        "position": [
          -280,
          740
        ],
        "parameters": {
          "filePath": "={{ $('Read video from Google Drive').item.json.originalFilename.replaceAll(\" \", \"_\") }}",
          "dataPropertyName": "datavideo"
        },
        "typeVersion": 1
      },
      {
        "id": "584ec208-3ccb-451c-9210-75c1e5845321",
        "name": "Upload Video to TikTok",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "Generate in upload-post.com the token and add to the credentials in the header-> Authorization: Apikey (token here)",
        "position": [
          -20,
          180
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate Description for Videos').item.json.message.content.replaceAll(\"\\\"\", \"\") }}"
              },
              {
                "name": "platform[]",
                "value": "tiktok"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "datavideo"
              },
              {
                "name": "user",
                "value": "={{ $('Set Variables').item.json.upload_post_user }}"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "47dO31ED0WIaJkR6",
            "name": "Upload-post mutonseo"
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "879624f9-6067-4a8d-b4d0-b06a56c2ed0b",
        "name": "Upload Video to Instagram",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "Generate in upload-post.com the token and add to the credentials in the header-> Authorization: Apikey (token here)",
        "position": [
          -20,
          480
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate Description for Videos').item.json.message.content.replaceAll(\"\\\"\", \"\") }}"
              },
              {
                "name": "platform[]",
                "value": "instagram"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "datavideo"
              },
              {
                "name": "user",
                "value": "={{ $('Set Variables').item.json.upload_post_user }}"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "47dO31ED0WIaJkR6",
            "name": "Upload-post mutonseo"
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "468fb5c3-9893-43ad-a6e4-95fc35eca6d4",
        "name": "Upload Video to YouTube",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "Generate in upload-post.com the token and add to the credentials in the header-> Authorization: Apikey (token here)",
        "position": [
          -20,
          740
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate Description for Videos').item.json.message.content.replaceAll(\"\\\"\", \"\").substring(0, 70) }}\n"
              },
              {
                "name": "platform[]",
                "value": "youtube"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "datavideo"
              },
              {
                "name": "user",
                "value": "={{ $('Set Variables').item.json.upload_post_user }}"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "47dO31ED0WIaJkR6",
            "name": "Upload-post mutonseo"
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "b273600b-08e4-4b8f-a4a6-7fbb0a3139a2",
        "name": "Update YouTube Status - Success",
        "type": "n8n-nodes-base.airtable",
        "position": [
          440,
          740
        ],
        "parameters": {
          "id": "={{ $('Create Airtable Record').item.json.id }}",
          "table": {
            "__rl": true,
            "mode": "",
            "value": "={{ $('Set Variables').item.json.airtable_table_id }}"
          },
          "fields": [
            "YouTube Status",
            "Youtube URL"
          ],
          "options": {},
          "operation": "update",
          "application": {
            "__rl": true,
            "mode": "",
            "value": "={{ $('Set Variables').item.json.airtable_app_id }}"
          },
          "authentication": "airtableTokenApi",
          "updateAllFields": false
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "hL7oYzyKTidpSiaC",
            "name": "jc.caverogracia airtable"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e636c387-c4e5-4e07-b9f0-dec0bf7fdb39",
        "name": "Update TikTok Status",
        "type": "n8n-nodes-base.airtable",
        "position": [
          440,
          180
        ],
        "parameters": {
          "id": "={{ $('Create Airtable Record').item.json.id }}",
          "table": {
            "__rl": true,
            "mode": "",
            "value": "={{ $('Set Variables').item.json.airtable_table_id }}"
          },
          "fields": [
            "TikTok Status",
            "Tiktok URL"
          ],
          "options": {},
          "operation": "update",
          "application": {
            "__rl": true,
            "mode": "",
            "value": "={{ $('Set Variables').item.json.airtable_app_id }}"
          },
          "authentication": "airtableTokenApi",
          "updateAllFields": false
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "hL7oYzyKTidpSiaC",
            "name": "jc.caverogracia airtable"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "2f1ffb8b-1157-4934-a828-5bb136a51b4b",
        "name": "Update Instagram Status",
        "type": "n8n-nodes-base.airtable",
        "position": [
          440,
          480
        ],
        "parameters": {
          "id": "={{ $('Create Airtable Record').item.json.id }}",
          "table": {
            "__rl": true,
            "mode": "",
            "value": "={{ $('Set Variables').item.json.airtable_table_id }}"
          },
          "fields": [
            "Instagram Status",
            "Instagram URL"
          ],
          "options": {},
          "operation": "update",
          "application": {
            "__rl": true,
            "mode": "",
            "value": "={{ $('Set Variables').item.json.airtable_app_id }}"
          },
          "authentication": "airtableTokenApi",
          "updateAllFields": false
        },
        "credentials": {
          "airtableTokenApi": {
            "id": "hL7oYzyKTidpSiaC",
            "name": "jc.caverogracia airtable"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4047b86a-517c-497f-8ae0-c46fa8ad9353",
        "name": "Edit Airtable Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          220,
          180
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e611aba1-e55c-4221-b03b-04008a04fa9c",
                "name": "ID",
                "type": "string",
                "value": "={{ $('Update Airtable with Description').item.json.id }}"
              },
              {
                "id": "47f61cd2-6dd6-4714-b772-3e0537accecd",
                "name": "TikTok Status",
                "type": "string",
                "value": "=success: {{ $json.results.tiktok.success }}"
              },
              {
                "id": "12829ca5-2780-4779-be0c-ff1712c012d8",
                "name": "Tiktok URL",
                "type": "string",
                "value": "={{ $json.results.tiktok?.url || \"error\" }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "561a0b10-4677-46c7-957b-0356e93ffa51",
        "name": "Edit Airtable Fields 2",
        "type": "n8n-nodes-base.set",
        "position": [
          220,
          480
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e611aba1-e55c-4221-b03b-04008a04fa9c",
                "name": "ID",
                "type": "string",
                "value": "={{ $('Update Airtable with Description').item.json.id }}"
              },
              {
                "id": "47f61cd2-6dd6-4714-b772-3e0537accecd",
                "name": "Instagram Status",
                "type": "string",
                "value": "=success: {{ $json.results.instagram.success }}"
              },
              {
                "id": "12829ca5-2780-4779-be0c-ff1712c012d8",
                "name": "Instagram URL",
                "type": "string",
                "value": "={{ $json.results.instagram?.url || \"error\" }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "d2ddd2ab-ba45-423c-842a-ad9d7c20a08e",
        "name": "Edit Airtable Fields 3",
        "type": "n8n-nodes-base.set",
        "position": [
          220,
          740
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e611aba1-e55c-4221-b03b-04008a04fa9c",
                "name": "ID",
                "type": "string",
                "value": "={{ $('Update Airtable with Description').item.json.id }}"
              },
              {
                "id": "47f61cd2-6dd6-4714-b772-3e0537accecd",
                "name": "YouTube Status",
                "type": "string",
                "value": "=success: {{ $json.results.youtube.success }}"
              },
              {
                "id": "12829ca5-2780-4779-be0c-ff1712c012d8",
                "name": "Youtube URL",
                "type": "string",
                "value": "={{ $json.results.youtube?.url || \"error\" }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "ca1d31c4-cc41-4f6b-9d59-3c1a90abfac5",
        "name": "Edit Airtable Fields1",
        "type": "n8n-nodes-base.set",
        "position": [
          -960,
          420
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e611aba1-e55c-4221-b03b-04008a04fa9c",
                "name": "ID",
                "type": "string",
                "value": "={{ $json.id }}"
              },
              {
                "id": "47f61cd2-6dd6-4714-b772-3e0537accecd",
                "name": "Description",
                "type": "string",
                "value": "={{ $('Generate Description for Videos').item.json.message.content }}"
              },
              {
                "id": "f44cc764-ed17-48c3-80e4-c320c6c67a7c",
                "name": "Video Name",
                "type": "string",
                "value": "={{ $('Google Drive').item.json.originalFilename }}"
              },
              {
                "id": "432688c0-d430-4e83-852c-91aad7b4ea79",
                "name": "Google Drive Links",
                "type": "string",
                "value": "={{ $('Google Drive').item.json.webViewLink }}"
              },
              {
                "id": "8804ac95-05d7-48e2-a49d-60213131ec62",
                "name": "Upload Date",
                "type": "string",
                "value": "={{ $now }}"
              },
              {
                "id": "12829ca5-2780-4779-be0c-ff1712c012d8",
                "name": "",
                "type": "string",
                "value": ""
              }
            ]
          }
        },
        "typeVersion": 3.4
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "59ebfe4f-3a3a-4609-94b1-39dc0371f619",
    "connections": {
      "If": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Drive": {
        "main": [
          [
            {
              "node": "Read video from Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Error Trigger": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Variables": {
        "main": [
          [
            {
              "node": "Create Airtable Record",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Airtable Fields": {
        "main": [
          [
            {
              "node": "Update TikTok Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Audio from Video": {
        "main": [
          [
            {
              "node": "Generate Description for Videos",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Drive Trigger": {
        "main": [
          [
            {
              "node": "Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Airtable Fields1": {
        "main": [
          [
            {
              "node": "Update Airtable with Description",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Video for TikTok": {
        "main": [
          [
            {
              "node": "Upload Video to TikTok",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Airtable Record": {
        "main": [
          [
            {
              "node": "Edit Airtable Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Airtable Fields 2": {
        "main": [
          [
            {
              "node": "Update Instagram Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Airtable Fields 3": {
        "main": [
          [
            {
              "node": "Update YouTube Status - Success",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Video for YouTube": {
        "main": [
          [
            {
              "node": "Upload Video to YouTube",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video to TikTok": {
        "main": [
          [
            {
              "node": "Edit Airtable Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video to YouTube": {
        "main": [
          [
            {
              "node": "Edit Airtable Fields 3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Video for Instagram": {
        "main": [
          [
            {
              "node": "Upload Video to Instagram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video to Instagram": {
        "main": [
          [
            {
              "node": "Edit Airtable Fields 2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read video from Google Drive": {
        "main": [
          [
            {
              "node": "Get Audio from Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Description for Videos": {
        "main": [
          [
            {
              "node": "Set Variables",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Airtable with Description": {
        "main": [
          [
            {
              "node": "Read Video for TikTok",
              "type": "main",
              "index": 0
            },
            {
              "node": "Read Video for Instagram",
              "type": "main",
              "index": 0
            },
            {
              "node": "Read Video for YouTube",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "KY0vB3hifSrA24k2",
    "meta": {
      "instanceId": "3378b0d68c3b7ebfc71b79896d94e1a044dec38e99a1160aed4e9c323910fbe2",
      "templateId": "3121"
    },
    "name": "AI-Powered Short-Form Video Generator with OpenAI, Flux, Kling, and ElevenLabs and upload to all social networks",
    "tags": [],
    "nodes": [
      {
        "id": "e5095169-dc78-4d90-9662-04cfc82c38d9",
        "name": "Get image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1160,
          480
        ],
        "parameters": {
          "url": "=https://api.piapi.ai/api/v1/task/{{ $json.data.task_id }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "X-API-Key",
                "value": "={{ $('Set API Keys').item.json['PiAPI Key'] }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f477250a-fc8e-407e-a632-cffc0e564596",
        "name": "Generate Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          880,
          480
        ],
        "parameters": {
          "url": "https://api.piapi.ai/api/v1/task",
          "body": "={\n  \"model\": \"Qubico/flux1-dev\",\n  \"task_type\": \"txt2img\",\n  \"input\": {\n    \"prompt\": \"{{ $('Generate Image Prompts').item.json.choices[0].message.content }} realistic and casual as if taken by an iphone camera by a TikTok influencer\",\n    \"negative_prompt\": \"taking a photo of a room, recording a video of a room, photos app, video recorder, illegible text, blurry text, low quality text, DSLR, unnatural\",\n    \"width\": 540,\n    \"height\": 960\n  }\n}",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "raw",
          "sendHeaders": true,
          "rawContentType": "application/json",
          "headerParameters": {
            "parameters": [
              {
                "name": "X-API-Key",
                "value": "={{ $('Set API Keys').item.json['PiAPI Key'] }}"
              }
            ]
          }
        },
        "retryOnFail": false,
        "typeVersion": 4.2
      },
      {
        "id": "622ce9f5-ad58-485b-a3c6-1265700b04da",
        "name": "Image-to-Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          520,
          1000
        ],
        "parameters": {
          "url": "https://api.piapi.ai/api/v1/task",
          "body": "={\n  \"model\": \"kling\",\n  \"task_type\": \"video_generation\",\n  \"input\": {\n    \"prompt\": \"{{ $json.data.input.prompt }}\",\n    \"negative_prompt\": \"blurry motion, distorted faces, unnatural lighting, over produced, bad quality\",\n    \"cfg_scale\": 0.5,\n    \"duration\": 5,\n    \"mode\": \"pro\",\n    \"image_url\": \"{{ $json.data.output.image_url }}\",\n    \"version\": \"1.6\",\n    \"camera_control\": {\n      \"type\": \"simple\",\n      \"config\": {\n        \"horizontal\": 0,\n        \"vertical\": 0,\n        \"pan\": 0,\n        \"tilt\": 0,\n        \"roll\": 0,\n        \"zoom\": 5\n      }\n    }\n  },\n  \"config\": {}\n}",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "raw",
          "sendHeaders": true,
          "rawContentType": "application/json",
          "headerParameters": {
            "parameters": [
              {
                "name": "X-API-Key",
                "value": "={{ $('Set API Keys').item.json['PiAPI Key'] }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "ed14eac3-1d63-481d-871c-a04c52977fc6",
        "name": "Get Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          780,
          1000
        ],
        "parameters": {
          "url": "=https://api.piapi.ai/api/v1/task/{{ $json.data.task_id }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "X-API-Key",
                "value": "={{ $('Set API Keys').item.json['PiAPI Key'] }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "8b68100c-8a5a-405c-825e-d9e8a898f235",
        "name": "List Elements",
        "type": "n8n-nodes-base.code",
        "position": [
          1400,
          1040
        ],
        "parameters": {
          "jsCode": "return [\n  {\n    scene_titles: items.map(item => item.json.response.text),\n    video_urls: items.map(item => item.json.data.output.video_url),\n    input_tokens: $('Calculate Token Usage').first().json.total_prompt_tokens,\n    output_tokens: $('Calculate Token Usage').first().json.total_completion_tokens,\n    model: $('Generate Image Prompts').first().json.model\n  }\n];"
        },
        "typeVersion": 2
      },
      {
        "id": "f8780885-508e-4dc9-b146-f367297d7b68",
        "name": "Wait 10min",
        "type": "n8n-nodes-base.wait",
        "position": [
          660,
          1000
        ],
        "webhookId": "1f9d716f-6544-4e4e-94ec-408ac3ea6e82",
        "parameters": {
          "unit": "minutes",
          "amount": 10
        },
        "typeVersion": 1.1
      },
      {
        "id": "6290bc91-0eb9-4053-bd93-961cb9e917c0",
        "name": "Wait 3min",
        "type": "n8n-nodes-base.wait",
        "position": [
          1020,
          480
        ],
        "webhookId": "77cdee73-5e99-456a-b5e7-410b4d257669",
        "parameters": {
          "unit": "minutes",
          "amount": 3
        },
        "typeVersion": 1.1
      },
      {
        "id": "818a66ef-b9fa-4efc-85d1-b295300cbed8",
        "name": "Wait 5min",
        "type": "n8n-nodes-base.wait",
        "position": [
          1480,
          400
        ],
        "webhookId": "31d5b1a2-dbb5-4849-ae25-cb491539c16e",
        "parameters": {
          "unit": "minutes"
        },
        "typeVersion": 1.1
      },
      {
        "id": "afd66320-dfe0-4872-a09d-d53fe08152ce",
        "name": "Generate voice",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          880,
          1460
        ],
        "parameters": {
          "url": "https://api.elevenlabs.io/v1/text-to-speech/onwK4e9ZLuTAKqWW03F9",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "text",
                "value": "={{ $json.choices[0].message.content }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "xi-api-key",
                "value": "={{ $('Set API Keys').item.json['ElevenLabs API Key'] }}"
              }
            ]
          }
        },
        "retryOnFail": false,
        "typeVersion": 4.2
      },
      {
        "id": "916f19e1-7928-4141-a5c5-ca39bd22b0a0",
        "name": "List Elements1",
        "type": "n8n-nodes-base.code",
        "position": [
          1400,
          1260
        ],
        "parameters": {
          "jsCode": "return [\n  {\n    sound_urls: items.map(item => $('Upload Voice Audio').first().json.webContentLink)\n  }\n];"
        },
        "typeVersion": 2
      },
      {
        "id": "b95fd80c-ec7f-4d50-99ae-f3f544b8a111",
        "name": "Fail check",
        "type": "n8n-nodes-base.if",
        "position": [
          920,
          1000
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "a920eb54-fc23-4b68-8f56-2eee907a5481",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.data.status }}",
                "rightValue": "failed"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "7e3f5cda-1d49-4a59-956f-f639daf203e0",
        "name": "Wait to retry",
        "type": "n8n-nodes-base.wait",
        "position": [
          1060,
          960
        ],
        "webhookId": "3b0fae8f-4419-45cd-8380-8f72eca05ff8",
        "parameters": {
          "unit": "minutes"
        },
        "typeVersion": 1.1
      },
      {
        "id": "48ec39c9-1802-4860-918d-9c660051f27b",
        "name": "Generate Image Prompts",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          400,
          560
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "o3-mini",
            "cachedResultName": "O3-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=You are an advanced, unhinged, hilariously entertaining prompt-generation AI specializing in expanding short POV image prompt ideas into detailed, hyper-realistic prompts optimized for Qubico/flux1-dev. Your task is to take a brief input tied to job seeking, job hunting, or resume building and morph it into a cinematic, immersive prompt locked in a first-person perspective, making the viewer feel they’re living the scene.\n\nNEVER include quotation marks or emojis in your response—flux API will choke on them, and that’s a hard no.\n\nThe topic of this narrative is: {{ $('Load Google Sheet').item.json.idea }}\n\nThe short prompt idea to expand for this image generation is: {{ $json.response.text }}\n\nONLY GENERATE ONE PROMPT PER IDEA—NO COMBINING. In at least one scene, weave in this environment descriptor: {{ $('Load Google Sheet').first().json.environment_prompt }}, but go wild with unhinged, edgy, funny twists elsewhere (skip the cringe or cheesy garbage). Most job hunting happens on laptops or desktops, so prioritize those over phones. If a phone sneaks in, it’s only showing job-related content like email, LinkedIn, a resume, or a job posting—never a photo or video app.\n\nEvery prompt has two parts:\n\nForeground: Kick off with First person view POV GoPro shot of... and show the viewer’s hands, limbs, or feet locked in a job-related action.\n\nBackground: Start with In the background,... and paint the scenery, blending the environment descriptor when required, plus sensory zingers.\n\nTop Rules:\n\nNO quotation marks or emojis—EVER. This is life or death for flux.\nStick to first-person POV—the viewer’s in the driver’s seat, not watching from the sidelines.\nShow a limb (hands, feet) doing something job-focused—typing, holding a resume, adjusting a tie.\nKeep it dynamic, like a GoPro clip, with motion and depth mimicking human vision.\nIf tech’s involved (phone, computer), it’s displaying job-hunting gold—email, job boards, resumes—not random trash.\nNo off-topic actions like recording videos or snapping pics—job hunting only, fam.\nExtra Vibes:\n\nFull-body awareness: Drop hints of physical feels—cramping fingers, racing pulse, slumping shoulders.\nSensory overload: Hit sight, touch, sound, smell, temperature for max realism (coffee whiffs, keyboard clacks).\nWorld grip: Limbs interact with the scene—tapping keys, handing over papers, stepping up.\nKeep it under 1000 characters, one slick sentence, no fluff or formatting.\nMake it entertaining, relatable, with an Andrew Tate viral edge for the down-and-out job hustlers.\nExamples:\n\nInput: Updating a LinkedIn profile after a long day\n\nEnvironment_prompt: Tired, cluttered apartment, laptop glow\n\nOutput: First person view POV GoPro shot of my hands hammering a laptop, cheeto-dusted fingers aching from the grind, the screen flashing my LinkedIn profile with a fresh connection ping; in the background, a trashed apartment lit by the laptop’s ghostly glow, pizza boxes toppling, traffic humming outside, stale takeout stench hitting my nose as my back screams from the hustle.\n\nInput: Handing over a resume at a job fair\n\nEnvironment_prompt: Hopeful, busy convention hall, suits everywhere\n\nOutput: First person view POV GoPro shot of my hand thrusting out a crisp resume, fingers twitching with nerves as it brushes another palm; in the background, a buzzing convention hall packed with suits, coffee fumes and shoe polish in the air, chatter drowning my pounding heart as I lock eyes with the recruiter.\n\nNO QUOTATION MARKS. NO EMOJIS. EVER."
              }
            ]
          },
          "simplify": false
        },
        "typeVersion": 1.8
      },
      {
        "id": "5c1b8dc8-4eb3-49fe-81c7-c811d73fac0d",
        "name": "Calculate Token Usage",
        "type": "n8n-nodes-base.code",
        "position": [
          700,
          560
        ],
        "parameters": {
          "jsCode": "// Get all input items (the 5 LLM responses)\nconst items = $input.all();\n\n// Calculate total prompt tokens and total completion tokens\nconst totalPromptTokens = items.reduce((sum, item) => sum + item.json.usage.prompt_tokens, 0);\nconst totalCompletionTokens = items.reduce((sum, item) => sum + item.json.usage.completion_tokens, 0);\n\n// Create new items with original data plus the totals\nconst outputItems = items.map(item => ({\n  json: {\n    ...item.json,                   // Spread the original item data\n    total_prompt_tokens: totalPromptTokens,     // Add total prompt tokens\n    total_completion_tokens: totalCompletionTokens // Add total completion tokens\n  }\n}));\n\n// Return the modified items\nreturn outputItems;"
        },
        "typeVersion": 2
      },
      {
        "id": "efc3d0dd-70dc-4fba-b040-22c773ed5602",
        "name": "Check for failures",
        "type": "n8n-nodes-base.if",
        "position": [
          1300,
          480
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "567d1fc9-0638-4a44-b5f5-30a9a6683794",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.data.status }}",
                "rightValue": "failed"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "3161c993-5696-4419-9299-fde51719dfc7",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          240
        ],
        "parameters": {
          "color": 5,
          "width": 1260,
          "height": 460,
          "content": "## 2. 🖼️Generate images with Flux using [PiAPI](https://piapi.ai/?via=n8n) \n### (total cost: $0.0948 approx. as of 3/9/25)\n1. OpenAI is used to generate 5 Flux image prompts based on the 5 captions generated. Edit this node to see/edit the prompt instructions. \n2. Next we use some custom javascript to total up how many tokens were used for each 5 generations so we can track our costs later.\n3. Then we generate an image with Flux using the [PiAPI service](https://piapi.ai/?via=n8n), waiting to check for failures and retrying if there are any.\n\nYou can change the image model used by editing the Generate Image node API call.\nFlux models available (as of 3/9/25):\n- Qubico/flux1-dev ($0.015) - Currently set\n- Qubico/flux1-schnell ($0.0015)\n- Qubico/flux1-advanced ($0.02)\n\nFor full list of API settings, see the [Flux API Documentation](https://piapi.ai/docs/flux-api/text-to-image?via=n8n)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "e5cdec7e-cb75-4200-a8e3-615621d20150",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          480,
          720
        ],
        "parameters": {
          "color": 6,
          "width": 1040,
          "height": 500,
          "content": "## 3. 🎬Generate videos with Kling using [PiAPI](https://piapi.ai/?via=n8n)\n### (total cost: $2.30 approx. as of 3/9/25)\n1. We use image-to-video with Kling using [PiAPI](https://piapi.ai/?via=n8n) to generate a video from each image.\n2. Then we wait to check for failures, and repeat the generations the failed if there are any.\n\nYou can edit the video model used in the Image-to-Video node. For testing, I'd recommend switching from pro to std for lower quality and cheaper price.\nKling models available (as of 3/9/25):\n- std (Standard) $0.26 per 5 second video\n- pro (Professional) $0.46 per 5 second video - Currently set\n\nFor full list of API settings, see the [Kling API Documentation](https://piapi.ai/docs/kling-api/create-task?via=n8n)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8404a390-a402-4703-8cb5-4a54490dc7bd",
        "name": "Generate Video Captions",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          -40,
          1220
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "role": "system",
                "content": "DO NOT include any quotation marks in your response. Do not put a quote at the beginning or the end of your response.\n\nYou are a prompt-generation AI specializing in crafting unhinged, entertaining TikTok captions for a \"day in the life\" POV story about job hunting or resume writing. Generate five concise, action-driven captions (5-10 words each) that follow a Problem > Action > Reward structure. The first caption should be a shocking or funny hook, and the last should conclude with a satisfying reward. Use emojis sparingly—only one per caption at most, and only when they add impact; skip them if they don’t enhance the message.\n\nGuidelines:\n\nPerspective: Always first-person POV, immersing the viewer in the story.\nTone: Channel Andrew Tate mixed with Charlie Sheen—cursing and sexual innuendos are fair game.\nContent: Focus on job seeking, hunting, or resume building, spotlighting AI as the game-changer.\nNarrative: Start with the grind of unemployment or a shitty job, pivot to using AI for resumes and cover letters, and end with scoring the dream gig.\nScenes: Highlight raw, emotional moments—skip the boring stuff.\nYour captions should be wild and entertaining, not polished or professional. The first caption is the hook—make it shocking, hilarious, or ballsy, something Andrew Tate would growl. Use emojis sparingly—max one per caption, only if it hits harder with it.\n\nYour response should be a list of 5 items separated by \"\\n\" (for example: \"item1\\nitem2\\nitem3\\nitem4\\nitem5\")"
              },
              {
                "content": "={{ $json.idea }}"
              }
            ]
          },
          "simplify": false
        },
        "typeVersion": 1.8
      },
      {
        "id": "f614c784-a3ee-4eb8-aee3-cc0ad3e87556",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          480,
          1240
        ],
        "parameters": {
          "color": 4,
          "width": 1040,
          "height": 400,
          "content": "## 4. 🔉Generate voice overs with [Eleven Labs](https://try.elevenlabs.io/n8n)\n1. OpenAI API is used to generate a funny script that relates to the captions. Open this node to see/edit the prompt instructions. \n2. Then we use the [Eleven Labs API](https://try.elevenlabs.io/n8n) to generate the voiceover and upload it to our Google Drive so it can be accessed in the next step.\n\nTo replace the voice, find the voice ID of the voice you want to use in [Eleven Labs](https://try.elevenlabs.io/n8n), then change the URL in the Generate Voice node to: https://api.elevenlabs.io/v1/text-to-speech/{voice ID here}\n\nFor full list of API settings, see the [Eleven Labs API Documentation](https://elevenlabs.io/docs/api-reference/text-to-speech/convert)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "e59306c1-8efe-4d98-9391-10c68c17787b",
        "name": "Match captions with videos",
        "type": "n8n-nodes-base.merge",
        "position": [
          1240,
          1040
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "8da7e16e-691b-4335-bfc7-e196c36f982d",
        "name": "Generate Script",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          520,
          1460
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "role": "system",
                "content": "=You are an unhinged and hilarious TikTok influencer who's like a mix of Andrew Tate and Charlie Sheen. The user is going to provide you with a topic, and then 5 different parts of a story. Your task is to narrate the story as this hilarious character, who isn't afraid to be edgy or curse or use sexual innuendos. However keep each of the 5 talking points brief, as you only have about 5 seconds to speak during each. The entire length of your narration should be around 15 seconds.\n\nEach line item of the users message represents 1 5 second clip, so your response needs to be able to quickly and easily be spoken in those time constraints. Don't say extra things you don't need to. Just quickly tell the story, in order, and make it unhinged, funny, entertaining, and potentially controversially viral. Don't worry about offendeding anyone. Andrew Tate style it.\n\nDo not include any emojis, as your response will be converted from text to speech, so anything but text and punctuation isn't neccesary. Also, don't make your jokes overly corny, speak in a witty, edgy, funny way, but no corny dad jokes or anything cringe."
              },
              {
                "content": "={{ $('Generate Video Captions').item.json.choices[0].message.content }}"
              }
            ]
          },
          "simplify": false
        },
        "executeOnce": true,
        "typeVersion": 1.8
      },
      {
        "id": "ad87317d-3ed0-4fdf-aea5-7b2fa60fb59f",
        "name": "Upload Voice Audio",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1080,
          1460
        ],
        "parameters": {
          "name": "={{ $('Load Google Sheet').item.json.id }}-voiceover.mp3",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1w1EQ8xyth6w7AbX2wpDI3vInfYeRy8vH",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1w1EQ8xyth6w7AbX2wpDI3vInfYeRy8vH",
            "cachedResultName": "Resume Studio"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "eec529e9-2601-4f7b-b415-63d2ebba1574",
        "name": "Set Access Permissions",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1260,
          1460
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {},
          "operation": "share",
          "permissionsUi": {
            "permissionsValues": {
              "role": "writer",
              "type": "anyone",
              "allowFileDiscovery": true
            }
          }
        },
        "typeVersion": 3
      },
      {
        "id": "63e72d56-140e-47d8-9f72-b58c764deed9",
        "name": "Pair Videos with Audio",
        "type": "n8n-nodes-base.merge",
        "position": [
          1620,
          1140
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3
      },
      {
        "id": "60a80c6f-0385-48e6-9b71-c23a74cbc15c",
        "name": "Render Final Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1800,
          1140
        ],
        "parameters": {
          "url": "https://api.creatomate.com/v1/renders",
          "body": "={\n  \"template_id\": \"{{ $('Set API Keys').item.json['Creatomate Template ID'] }}\",\n  \"modifications\": {\n    \n    \"Video-1.source\": \"{{ $json.video_urls[0] }}\",\n    \"Video-2.source\": \"{{ $json.video_urls[1] }}\",\n    \"Video-3.source\": \"{{ $json.video_urls[2] }}\",\n    \"Video-4.source\": \"{{ $json.video_urls[3] }}\",\n    \"Video-5.source\": \"{{ $json.video_urls[4] }}\",\n\n    \"Audio-1.source\": \"{{ $json.sound_urls[0] }}\",\n\n    \"Text-1.text\": \"{{ $json.scene_titles[0] }}\",\n    \"Text-2.text\": \"{{ $json.scene_titles[1] }}\",\n    \"Text-3.text\": \"{{ $json.scene_titles[2] }}\",\n    \"Text-4.text\": \"{{ $json.scene_titles[3] }}\",\n    \"Text-5.text\": \"{{ $json.scene_titles[4] }}\"\n  }\n}",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "raw",
          "sendHeaders": true,
          "rawContentType": "application/json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $('Set API Keys').item.json['Creatomate API Key'] }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "executeOnce": true,
        "typeVersion": 4.2
      },
      {
        "id": "89c0e958-7690-4f3d-af49-3e9776f2c979",
        "name": "Notify me on Discord",
        "type": "n8n-nodes-base.discord",
        "position": [
          2780,
          1140
        ],
        "webhookId": "1541bc50-06e4-48e8-8c76-23850ee4edf6",
        "parameters": {
          "content": "=A new Resume Studio POV video has been created: {{ $json.final_output }}",
          "options": {},
          "authentication": "webhook"
        },
        "typeVersion": 2
      },
      {
        "id": "14a09794-5e02-4880-b33d-139a91726dda",
        "name": "Once Per Day",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -600,
          1220
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 7
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4de1f1c7-52ad-4e00-ad22-b4c3c0f718d8",
        "name": "Load Google Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -180,
          1220
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": true
          },
          "filtersUI": {
            "values": [
              {
                "lookupValue": "for production",
                "lookupColumn": "production"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1cjd8p_yx-M-3gWLEd5TargtoB35cW-3y66AOTNMQrrM/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1cjd8p_yx-M-3gWLEd5TargtoB35cW-3y66AOTNMQrrM",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1cjd8p_yx-M-3gWLEd5TargtoB35cW-3y66AOTNMQrrM/edit?usp=drivesdk",
            "cachedResultName": "Sheet Template"
          }
        },
        "typeVersion": 4.5,
        "alwaysOutputData": true
      },
      {
        "id": "e5c83690-1696-43aa-a0db-164ca128dd67",
        "name": "Create List",
        "type": "n8n-nodes-base.code",
        "position": [
          280,
          1140
        ],
        "parameters": {
          "jsCode": "// Get the text directly from the OpenAI response\nconst text = $input.first().json.choices[0].message.content;\n\n// Split the text on literal '\\\\n', trim, and filter empty lines\nconst lines = text.split('\\\\n').map(line => line.trim()).filter(line => line !== '');\n\n// Create an array of items for n8n\nconst items = lines.map(line => ({\n  json: {\n    response: { text: line }\n  }\n}));\n\n// Return the array of items\nreturn items;"
        },
        "typeVersion": 2
      },
      {
        "id": "ed99df67-2068-4c8b-a6ba-e67d234f03c4",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1560,
          920
        ],
        "parameters": {
          "color": 3,
          "width": 1360,
          "height": 380,
          "content": "## 5. 📥Complete video with [Creatomate](https://creatomate.com/)\n### (total cost: $0.38 approx. with the Essential plan credits | Free trial credits available)\n1. First, the list of videos/captions is combined with the generated voice over into a single item containing all 3 elements.\n2. Those are then passed over to the Creatomate Template ID you specified, replacing the template captions/video/audio with your generated ones.\n3. When the video is finished rendering, it's then uploaded to Google Drive and the permissions set so it can be accessed with a link.\n4. Then we update the original Google Sheet template with the information from our generation, including tokens to calculate cost, then mark this idea as completed.\n5. Finally, we send a notification to via [webhook to the Discord server](https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks) when the video is ready to be downloaded and used!\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "e7064a56-c500-4f9f-a54a-c4352c263b56",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -320,
          280
        ],
        "parameters": {
          "width": 620,
          "height": 420,
          "content": "# 🤖 AI-Powered Short-Form Video Generator with OpenAI, Flux, Kling, and ElevenLabs\n\n## 📃Before you get started, you'll need:\n- [n8n installation](https://n8n.partnerlinks.io/n8nTTVideoGenTemplate) (tested on version 1.81.4)\n- [OpenAI API Key](https://platform.openai.com/api-keys) (free trial credits available)\n- [PiAPI](https://piapi.ai/?via=n8n) (free trial credits available)\n- [Eleven Labs](https://try.elevenlabs.io/n8n) (free account)\n- [Creatomate API Key](https://creatomate.com/) (free trial credits available)\n- Google Sheets API enabled in [Google Cloud Console](https://console.cloud.google.com/apis/api/sheets.googleapis.com/overview)\n- Google Drive API enabled in [Google Cloud Console](https://console.cloud.google.com/apis/api/drive.googleapis.com/overview)\n- OAuth 2.0 Client ID and Client Secret from your [Google Cloud Console Credentials](https://console.cloud.google.com/apis/credentials)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "4ddb7249-9785-4f51-b35c-b9a0c6a66e3b",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -480,
          780
        ],
        "parameters": {
          "color": 7,
          "width": 920,
          "height": 700,
          "content": "## 1. 🗨️Generate video captions from ideas in a Google Sheet\n\n1. Setup your API keys for [PiAPI](https://piapi.ai/?via=n8n), [Eleven Labs](https://try.elevenlabs.io/n8n), and [Creatomate](https://creatomate.com/).\n- Once logged in to your Creatomate account, create a new video template and click \"source code\" in the top right. [Paste this JSON code](https://pastebin.com/c7aMTeLK). This will be your example template for this workflow.\n- In your Creatomate template, click the \"Use Template\" button in the top right and then click \"API Integration\" and you'll see your template_id. Set this value as your Creatomate Template ID in the Set API Keys node\n\n2. The next node will load a Google Sheet, you can copy the [Google Sheet Template](https://docs.google.com/spreadsheets/d/1cjd8p_yx-M-3gWLEd5TargtoB35cW-3y66AOTNMQrrM/edit?usp=sharing), simply choose File > Make a copy. Then in the Google Sheets node, connect to your copied sheet template.\n\n3. Next, we generate 5 captions for our video idea with OpenAI. You can edit this node to see the prompt and change it to your needs.\n\n4. In the final two nodes, we use custom javascript code to turn the OpenAI response into a list. Then, it validates to make sure the list was formed correctly (incase of an OpenAI failure to follow instructions)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "57ee2f8f-5371-4dab-b661-c58b25c7dd55",
        "name": "Wait1",
        "type": "n8n-nodes-base.wait",
        "position": [
          1920,
          1140
        ],
        "webhookId": "206d0cdf-b71f-44a7-909f-97df885c471a",
        "parameters": {
          "unit": "minutes",
          "amount": 3
        },
        "typeVersion": 1.1
      },
      {
        "id": "33781e51-ef30-437b-8499-94e39bfb38fa",
        "name": "Get Final Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2040,
          1140
        ],
        "parameters": {
          "url": "=https://api.creatomate.com/v1/renders/{{ $('Render Final Video').item.json.id }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $('Set API Keys').item.json['Creatomate API Key'] }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "executeOnce": true,
        "typeVersion": 4.2
      },
      {
        "id": "b0d0fe6f-39c2-4da6-9fcf-b0151ed2c351",
        "name": "Upload Final Video",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          2300,
          1140
        ],
        "parameters": {
          "name": "=POV-{{ $('Render Final Video').item.json.id }}.mp4",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1w1EQ8xyth6w7AbX2wpDI3vInfYeRy8vH",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1w1EQ8xyth6w7AbX2wpDI3vInfYeRy8vH",
            "cachedResultName": "Resume Studio"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "2TbhWtnbRfSloGxX",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "3893d1de-7464-48ad-91a3-14b867c2a516",
        "name": "Get Raw File",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2160,
          1140
        ],
        "parameters": {
          "url": "={{ $json.url }}",
          "options": {
            "response": {
              "response": {
                "responseFormat": "file"
              }
            }
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "74de5f28-f081-4ec5-a47e-681eb845f701",
        "name": "Set Permissions",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          2440,
          1140
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.id }}"
          },
          "options": {},
          "operation": "share",
          "permissionsUi": {
            "permissionsValues": {
              "role": "writer",
              "type": "anyone",
              "allowFileDiscovery": true
            }
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "2TbhWtnbRfSloGxX",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "a2c07158-e949-4b5b-a92e-f4b021742831",
        "name": "Update Google Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2600,
          1140
        ],
        "parameters": {
          "columns": {
            "value": {
              "id": "={{ $('Load Google Sheet').first().json.id }}",
              "width": "={{ $('Get Raw File').item.json.width }}",
              "height": "={{ $('Get Raw File').item.json.height }}",
              "model1": "={{ $('Generate Video Captions').item.json.model }}",
              "model2": "={{ $('Pair Videos with Audio').item.json.model }}",
              "model3": "={{ $('Generate Script').item.json.model }}",
              "duration": "={{ $('Get Raw File').item.json.duration }}",
              "fluxCost": "0.075",
              "frameRate": "={{ $('Get Raw File').item.json.frame_rate }}",
              "klingCost": "2.3",
              "production": "done",
              "publishing": "for publishing",
              "final_output": "={{ $('Upload Final Video').item.json.webContentLink }}",
              "prompt1 input tokens": "={{ $('Generate Video Captions').item.json.usage.prompt_tokens }}",
              "prompt2 input tokens": "={{ $('Pair Videos with Audio').item.json.input_tokens }}",
              "prompt3 input tokens": "={{ $('Generate Script').item.json.usage.prompt_tokens }}",
              "prompt1 output tokens": "={{ $('Generate Video Captions').item.json.usage.completion_tokens }}",
              "prompt2 output tokens": "={{ $('Pair Videos with Audio').item.json.output_tokens }}",
              "prompt3 output tokens": "={{ $('Generate Script').item.json.usage.completion_tokens }}"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "id",
                "defaultMatch": true,
                "canBeUsedToMatch": true
              },
              {
                "id": "idea",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "idea",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "caption",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "production",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "production",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "environment_prompt",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "environment_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "publishing",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "publishing",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "final_output",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "final_output",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "width",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "width",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "height",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "height",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "duration",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "duration",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "frameRate",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "frameRate",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "model1",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "model1",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "prompt1 input tokens",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "prompt1 input tokens",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "prompt1 output tokens",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "prompt1 output tokens",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "model1 cost",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "model1 cost",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "model2",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "model2",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "prompt2 input tokens",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "prompt2 input tokens",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "prompt2 output tokens",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "prompt2 output tokens",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "model2 cost",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "model2 cost",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "model3",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "model3",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "prompt3 input tokens",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "prompt3 input tokens",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "prompt3 output tokens",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "prompt3 output tokens",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "model3 cost",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "model3 cost",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "cmCost",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "cmCost",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "upgradeCmCost",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "upgradeCmCost",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "fluxCost",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "fluxCost",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "klingCost",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "klingCost",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "totalCost",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "totalCost",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "datePosted",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "datePosted",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1cjd8p_yx-M-3gWLEd5TargtoB35cW-3y66AOTNMQrrM/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1cjd8p_yx-M-3gWLEd5TargtoB35cW-3y66AOTNMQrrM",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1cjd8p_yx-M-3gWLEd5TargtoB35cW-3y66AOTNMQrrM/edit?usp=drivesdk",
            "cachedResultName": "Sheet Template"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "3IOU2VjBnR4hGohx",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "62423325-f9da-4cdf-8864-c011fb4fa14f",
        "name": "Set API Keys",
        "type": "n8n-nodes-base.set",
        "notes": "SET BEFORE STARTING",
        "position": [
          -380,
          1220
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "35659353-d8e2-4677-876b-401b549605a0",
                "name": "PiAPI Key",
                "type": "string",
                "value": ""
              },
              {
                "id": "c4927dd6-c597-48fe-b7c1-bbffcf5ff02f",
                "name": "ElevenLabs API Key",
                "type": "string",
                "value": ""
              },
              {
                "id": "f5e90c05-dd24-4918-9005-4c87a4fb344d",
                "name": "Creatomate API Key",
                "type": "string",
                "value": ""
              },
              {
                "id": "d0ebba50-5a99-4090-adcb-d18aa0b21be2",
                "name": "Creatomate Template ID",
                "type": "string",
                "value": ""
              }
            ]
          }
        },
        "notesInFlow": true,
        "typeVersion": 3.4
      },
      {
        "id": "4252d793-5f16-4d5e-bb78-9b155aef5d3e",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -440,
          1160
        ],
        "parameters": {
          "color": 3,
          "width": 220,
          "height": 220,
          "content": "## DO THIS FIRST\n"
        },
        "typeVersion": 1
      },
      {
        "id": "845d5b4a-8a3f-4d0d-afce-39aa4e349a7b",
        "name": "Validate list formatting",
        "type": "n8n-nodes-base.if",
        "position": [
          280,
          1280
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "2681c0e9-aa45-4f0f-8933-6e6de324c7aa",
                "operator": {
                  "type": "array",
                  "operation": "lengthGt",
                  "rightType": "number"
                },
                "leftValue": "={{$input.all()}}",
                "rightValue": 1
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "98a3761e-544a-473c-aa7f-cc14390750d8",
        "name": "Get Audio from Video",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "notes": "Extract the audio from video for generate the description",
        "position": [
          3820,
          1360
        ],
        "parameters": {
          "options": {},
          "resource": "audio",
          "operation": "transcribe"
        },
        "credentials": {
          "openAiApi": {
            "id": "XJdxgMSXFgwReSsh",
            "name": "n8n key"
          }
        },
        "notesInFlow": true,
        "retryOnFail": true,
        "typeVersion": 1,
        "waitBetweenTries": 5000
      },
      {
        "id": "ec498643-1ef1-42e5-90ee-ec49d0e2b63b",
        "name": "Generate Description for Videos  in Tiktok and Instagram",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "notes": "Request to OpenAi for generate description with the audio extracted from the video",
        "position": [
          4060,
          1360
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "role": "system",
                "content": "You are an expert assistant in creating engaging social media video titles."
              },
              {
                "content": "=I'm going to upload a video to social media. Here are some examples of descriptions that have worked well on Instagram:\n\nFollow and save for later. Discover InfluencersDe, the AI tool that automates TikTok creation and publishing to drive traffic to your website. Perfect for entrepreneurs and brands.\n#digitalmarketing #ugc #tiktok #ai #influencersde #contentcreation\n\nDiscover the video marketing revolution with InfluencersDe!\n.\n.\n.\n#socialmedia #videomarketing #ai #tiktok #influencersde #growthhacking\n\nDon't miss InfluencersDe, the tool that transforms your marketing strategy with just one click!\n.\n.\n.\n#ugc #ai #tiktok #digitalmarketing #influencersde #branding\n\nCan you create another title for the Instagram post based on this recognized audio from the video?\n\nAudio: {{ $('Get Audio from Video').item.json.text }}\n\nIMPORTANT: Reply only with the description, don't add anything else."
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "XJdxgMSXFgwReSsh",
            "name": "n8n key"
          }
        },
        "notesInFlow": true,
        "retryOnFail": true,
        "typeVersion": 1.4,
        "waitBetweenTries": 5000
      },
      {
        "id": "2f9f753d-86f3-4489-9dd2-a691f2da80ba",
        "name": "Upload Video and Description to Tiktok",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "Generate in upload-post.com the token and add to the credentials in the header-> Authorization: Apikey (token here)",
        "position": [
          4880,
          940
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate Description for Videos  in Tiktok and Instagram').item.json.message.content.replaceAll(\"\\\"\", \"\") }}"
              },
              {
                "name": "platform[]",
                "value": "tiktok"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              },
              {
                "name": "user",
                "value": "Add user generated in upload-post"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "WNjAx7UqrEZ1JDrR",
            "name": "VituManco"
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "4f007ef7-3f0a-4b4d-8dca-96028f29dd0c",
        "name": "Upload Video and Description to Instagram",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "Generate in upload-post.com the token and add to the credentials in the header-> Authorization: Apikey (token here)",
        "position": [
          4880,
          1140
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate Description for Videos  in Tiktok and Instagram').item.json.message.content.replaceAll(\"\\\"\", \"\") }}"
              },
              {
                "name": "platform[]",
                "value": "instagram"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              },
              {
                "name": "user",
                "value": "Add user generated in upload-post"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "47dO31ED0WIaJkR6",
            "name": "Header Auth account"
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "3805750b-65c4-4f28-b811-967681eda0ff",
        "name": "Upload Video and Description to Youtube",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "Generate in upload-post.com the token and add to the credentials in the header-> Authorization: Apikey (token here)",
        "position": [
          4880,
          1360
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate Description for Videos  in Tiktok and Instagram').item.json.message.content.replaceAll(\"\\\"\", \"\").substring(0, 70) }}\n"
              },
              {
                "name": "platform[]",
                "value": "youtube"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              },
              {
                "name": "user",
                "value": "Add user generated in upload-post"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "47dO31ED0WIaJkR6",
            "name": "Header Auth account"
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "754e3f54-87cd-4b50-947e-a9b20ce2d2ab",
        "name": "Upload Video and Description to Facebook",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "Generate in upload-post.com the token and add to the credentials in the header-> Authorization: Apikey (token here)",
        "position": [
          4880,
          1600
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate Description for Videos  in Tiktok and Instagram').item.json.message.content.replaceAll(\"\\\"\", \"\") }}"
              },
              {
                "name": "platform[]",
                "value": "facebook"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              },
              {
                "name": "user",
                "value": "Add user generated in upload-post"
              },
              {
                "name": "facebook_page_id",
                "value": "61556896550301"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "47dO31ED0WIaJkR6",
            "name": "Header Auth account"
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "4090c098-2381-4e57-8e53-d24a2bed57cd",
        "name": "Upload Video and Description to Linkedin",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "Generate in upload-post.com the token and add to the credentials in the header-> Authorization: Apikey (token here)",
        "position": [
          4880,
          1840
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate Description for Videos  in Tiktok and Instagram').item.json.message.content.replaceAll(\"\\\"\", \"\") }}"
              },
              {
                "name": "platform[]",
                "value": "linkedin"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              },
              {
                "name": "user",
                "value": "Add user generated in upload-post"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "47dO31ED0WIaJkR6",
            "name": "Header Auth account"
          }
        },
        "notesInFlow": true,
        "typeVersion": 4.2
      },
      {
        "id": "cd9fbbf5-262e-43bc-9c09-382516de1cca",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2940,
          920
        ],
        "parameters": {
          "width": 2480,
          "height": 1160,
          "content": "## 6. Upload to all social networks with upload-post.com\n### (premium plan 15$ | Free trial credits available)\n\n\n\nThis automation will automatically create descriptions from videos and upload it to Instagram, TikTok, Youtube, Facebook and Linkedin.\n\n## How to Use\n1. Generate an API token at upload-post.com and add to Upload to Tiktok and Upload to Instagram nodes etc\n2. Customize the OpenAI prompt for your specific use case\n3. Optional: Configure Telegram for error notifications\n\n## Requirements\n- upload-post.com account\n- OpenAI API key\n"
        },
        "typeVersion": 1
      },
      {
        "id": "f3524df6-484b-40e6-a9a3-f4d2211f3988",
        "name": "Read Video from Google Drive",
        "type": "n8n-nodes-base.readBinaryFile",
        "position": [
          4420,
          1360
        ],
        "parameters": {
          "filePath": "={{ $('Write video').item.json.originalFilename.replaceAll(\" \", \"_\") }}",
          "dataPropertyName": "datavideo"
        },
        "typeVersion": 1
      },
      {
        "id": "f082675c-1682-4679-88df-ae410e323f5b",
        "name": "Write video",
        "type": "n8n-nodes-base.writeBinaryFile",
        "position": [
          3440,
          1360
        ],
        "parameters": {
          "options": {},
          "fileName": "={{ $json.originalFilename.replaceAll(\" \", \"_\") }}"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "8f78312c-a5e3-48f0-a386-e1251586a6e7",
    "connections": {
      "Wait1": {
        "main": [
          [
            {
              "node": "Get Final Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Video": {
        "main": [
          [
            {
              "node": "Fail check",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get image": {
        "main": [
          [
            {
              "node": "Check for failures",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 3min": {
        "main": [
          [
            {
              "node": "Get image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 5min": {
        "main": [
          [
            {
              "node": "Generate Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fail check": {
        "main": [
          [
            {
              "node": "Wait to retry",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Match captions with videos",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Wait 10min": {
        "main": [
          [
            {
              "node": "Get Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create List": {
        "main": [
          [
            {
              "node": "Validate list formatting",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Write video": {
        "main": [
          [
            {
              "node": "Get Audio from Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Raw File": {
        "main": [
          [
            {
              "node": "Upload Final Video",
              "type": "main",
              "index": 0
            },
            {
              "node": "Write video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Once Per Day": {
        "main": [
          [
            {
              "node": "Set API Keys",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set API Keys": {
        "main": [
          [
            {
              "node": "Load Google Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Elements": {
        "main": [
          [
            {
              "node": "Pair Videos with Audio",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait to retry": {
        "main": [
          [
            {
              "node": "Image-to-Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Image": {
        "main": [
          [
            {
              "node": "Wait 3min",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate voice": {
        "main": [
          [
            {
              "node": "Upload Voice Audio",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Image-to-Video": {
        "main": [
          [
            {
              "node": "Wait 10min",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Elements1": {
        "main": [
          [
            {
              "node": "Pair Videos with Audio",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Generate Script": {
        "main": [
          [
            {
              "node": "Generate voice",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Final Video": {
        "main": [
          [
            {
              "node": "Get Raw File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Permissions": {
        "main": [
          [
            {
              "node": "Update Google Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Load Google Sheet": {
        "main": [
          [
            {
              "node": "Generate Video Captions",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check for failures": {
        "main": [
          [
            {
              "node": "Wait 5min",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Image-to-Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Render Final Video": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Final Video": {
        "main": [
          [
            {
              "node": "Set Permissions",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Voice Audio": {
        "main": [
          [
            {
              "node": "Set Access Permissions",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Google Sheet": {
        "main": [
          [
            {
              "node": "Notify me on Discord",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Audio from Video": {
        "main": [
          [
            {
              "node": "Generate Description for Videos  in Tiktok and Instagram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Notify me on Discord": {
        "main": [
          []
        ]
      },
      "Calculate Token Usage": {
        "main": [
          [
            {
              "node": "Generate Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Image Prompts": {
        "main": [
          [
            {
              "node": "Calculate Token Usage",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pair Videos with Audio": {
        "main": [
          [
            {
              "node": "Render Final Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Access Permissions": {
        "main": [
          [
            {
              "node": "List Elements1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Video Captions": {
        "main": [
          [
            {
              "node": "Create List",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Validate list formatting": {
        "main": [
          [
            {
              "node": "Generate Image Prompts",
              "type": "main",
              "index": 0
            },
            {
              "node": "Match captions with videos",
              "type": "main",
              "index": 0
            },
            {
              "node": "Generate Script",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Generate Video Captions",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Match captions with videos": {
        "main": [
          [
            {
              "node": "List Elements",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Video from Google Drive": {
        "main": [
          [
            {
              "node": "Upload Video and Description to Tiktok",
              "type": "main",
              "index": 0
            },
            {
              "node": "Upload Video and Description to Instagram",
              "type": "main",
              "index": 0
            },
            {
              "node": "Upload Video and Description to Youtube",
              "type": "main",
              "index": 0
            },
            {
              "node": "Upload Video and Description to Facebook",
              "type": "main",
              "index": 0
            },
            {
              "node": "Upload Video and Description to Linkedin",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Description for Videos  in Tiktok and Instagram": {
        "main": [
          [
            {
              "node": "Read Video from Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "eFkkWqS5KdrxZ43P",
    "meta": {
      "instanceId": "a2b23892dd6989fda7c1209b381f5850373a7d2b85609624d7c2b7a092671d44",
      "templateCredsSetupCompleted": true
    },
    "name": "Automate video creation with Veo3 and auto-post to Instagram, TikTok via Blotato - vide",
    "tags": [],
    "nodes": [
      {
        "id": "11a7c5b6-0db7-4d99-a1a0-e34e05c23ff5",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          340,
          480
        ],
        "parameters": {
          "width": 1200,
          "height": 500,
          "content": "# ✅ STEP 1 — Generate Script & Prompt with AI"
        },
        "typeVersion": 1
      },
      {
        "id": "2f3aec5c-4144-4e0c-b1c8-7f96dfe14370",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          340,
          1020
        ],
        "parameters": {
          "color": 3,
          "width": 1200,
          "height": 280,
          "content": "# ✅ STEP 2 — Create Video Using Veo3\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "45a5a9f4-fe6a-43a7-a032-c69750826209",
        "name": "Assign Social Media IDs",
        "type": "n8n-nodes-base.set",
        "position": [
          420,
          1680
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "{\n  \"instagram_id\": \"1111\",\n  \"youtube_id\": \"1111\",\n  \"threads_id\": \"1111\",\n  \"tiktok_id\": \"1111\",\n  \"facebook_id\": \"1111\",\n  \"facebook_page_id\": \"1111\",\n  \"twitter_id\": \"1111\",\n  \"linkedin_id\": \"1111\",\n  \"pinterest_id\": \"1111\",\n  \"pinterest_board_id\": \"1111\",\n  \"bluesky_id\": \"1111\"\n}\n"
        },
        "typeVersion": 3.4
      },
      {
        "id": "6d125a85-b626-4981-8cfc-bcac4ea0ca89",
        "name": "Get my video",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          520,
          1440
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "779818a1-97bd-4bf9-ba17-995c1439df6f",
        "name": "Upload Video to Blotato",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          640,
          1680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/media",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "url",
                "value": "={{ $('Get my video').item.json['final_output'] }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "113d635c-bf8f-4ed3-801e-de78b0df9437",
        "name": "INSTAGRAM",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          920,
          1440
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.instagram_id }}\",\n    \"target\": {\n      \"targetType\": \"instagram\"\n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"instagram\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "02aa72ee-e5b9-44ee-9cbf-e8ddbc259570",
        "name": "YOUTUBE",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1140,
          1440
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.youtube_id }}\",\n    \"target\": {\n      \"targetType\": \"youtube\",\n      \"title\": \"{{ $('Get my video').item.json.Titre }}\",\n      \"privacyStatus\": \"unlisted\",\n      \"shouldNotifySubscribers\": \"false\"\n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"youtube\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "b9e82889-b753-43e7-b417-213a99763802",
        "name": "TIKTOK",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1340,
          1440
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.tiktok_id }}\",\n    \"target\": {\n      \"targetType\": \"tiktok\",\n      \"isYourBrand\": \"false\", \n      \"disabledDuet\": \"false\",\n      \"privacyLevel\": \"PUBLIC_TO_EVERYONE\",\n      \"isAiGenerated\": \"true\",\n      \"disabledStitch\": \"false\",\n      \"disabledComments\": \"false\",\n      \"isBrandedContent\": \"false\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"tiktok\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "=YOUR_API_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "edf4cd31-ae48-4996-816e-8a32ac411e75",
        "name": "FACEBOOK",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          920,
          1680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.facebook_id }}\",\n    \"target\": {\n      \"targetType\": \"facebook\",\n      \"pageId\": \"{{ $('Assign Social Media IDs').item.json.facebook_page_id }}\"\n\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"facebook\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "=YOUR_API_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "edeb50af-020e-4118-af73-2a4fbb3bf6a2",
        "name": "THREADS",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1140,
          1680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.threads_id }}\",\n    \"target\": {\n      \"targetType\": \"threads\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"threads\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "210e36e9-8db2-403c-b72a-2ec45bce2eae",
        "name": "TWETTER",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1340,
          1680
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.twitter_id }}\",\n    \"target\": {\n      \"targetType\": \"twitter\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"twitter\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "ac3069e4-4fe6-4146-a0e2-973b3c374c55",
        "name": "LINKEDIN",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          920,
          1920
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.linkedin_id }}\",\n    \"target\": {\n      \"targetType\": \"linkedin\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"linkedin\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "d9c919d8-ae9c-47cf-9b6f-8cb3e7e1f500",
        "name": "BLUESKY",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1140,
          1920
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "= {\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.bluesky_id }}\",\n    \"target\": {\n      \"targetType\": \"bluesky\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"bluesky\",\n      \"mediaUrls\": [\n        \"https://pbs.twimg.com/media/GE8MgIiWEAAfsK3.jpg\"\n      ]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "a0a0a8fe-f6b0-458c-846e-409200a7b12f",
        "name": "PINTEREST",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1340,
          1920
        ],
        "parameters": {
          "url": "https://backend.blotato.com/v2/posts",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.pinterest_id }}\",\n    \"target\": {\n      \"targetType\": \"pinterest\",\n      \"boardId\": \"{{ $('Assign Social Media IDs').item.json.pinterest_board_id }}\"      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"pinterest\",\n      \"mediaUrls\": [\n        \"https://pbs.twimg.com/media/GE8MgIiWEAAfsK3.jpg\"\n      ]\n    }\n  }\n}\n\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "38c75425-36a5-45c7-98cb-ed5eb20af249",
        "name": "Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          640,
          1920
        ],
        "parameters": {
          "columns": {
            "value": {
              "STATUS": "Publish",
              "row_number": "={{ $('Get my video').item.json.row_number }}"
            },
            "schema": [
              {
                "id": "PROMPT",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "PROMPT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "DESCRIPTION",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "DESCRIPTION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL VIDEO",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "URL VIDEO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Titre",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Titre",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "STATUS",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "STATUS",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "94db7d6e-ce83-4c9a-916c-c35c802f8d4d",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          340,
          1340
        ],
        "parameters": {
          "color": 4,
          "width": 1200,
          "height": 760,
          "content": "# ✅ STEP 3 — Publish Video to Social Media\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3ac616bc-67bb-494c-bd24-3753fc03e7dc",
        "name": "Trigger: Run Daily Script Generator",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          500,
          560
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "8ae30b31-2ac9-4b62-9094-ce36197d319d",
        "name": "AI Agent: Generate Video Concept",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          660,
          560
        ],
        "parameters": {
          "text": "Give me an idea about [a Yeti speaking to a camera and doing a Vlog through his selfie stick]. ",
          "options": {
            "systemMessage": "=You are an AI designed to generate 1 immersive, realistic idea based on a user-provided topic. Your output must be formatted as a JSON array (single line) and follow all the rules below exactly.\n\nRULES:\n\nOnly return 1 idea at a time.\n\nThe user will provide a key topic (e.g. “urban farming,” “arctic survival,” “street food in Vietnam”).\n\nThe Idea must:\n\nBe under 13 words.\n\nDescribe an interesting and viral-worthy moment, action, or event related to the provided topic.\n\nCan be as surreal as you can get, doesn't have to be real-world!\n\nInvolves a character.\n\nThe Caption must be:\n\nShort, punchy, and viral-friendly.\n\nInclude one relevant emoji.\n\nInclude exactly 12 hashtags in this order:\n** 4 topic-relevant hashtags\n** 4 all-time most popular hashtags\n** 4 currently trending hashtags (based on live research)\n\nAll hashtags must be lowercase.\n\nSet Status to \"for production\" (always).\n\nThe Environment must:\n\nBe under 20 words.\n\nMatch the action in the Idea exactly.\n\nClearly describe:\n\nWhere the event is happening (e.g. rooftop, jungle trail, city alley, frozen lake)\n\nKey visuals or background details (e.g. smoke rising, neon lights, fog, birds overhead)\n\nMain participants (e.g. farmer, cook, mechanic, rescue team, animal)\n\nStyle of scene (e.g. cinematic realism, handheld docu-style, aerial tracking shot, macro close-up)\n\nOk with fictional settings\n\nOUTPUT FORMAT (single-line JSON array):\n\n\n[\n  {\n    \"Caption\": \"Short viral title with emoji #4_topic_hashtags #4_all_time_popular_hashtags #4_trending_hashtags\",\n    \"Idea\": \"Short idea under 13 words\",\n    \"Environment\": \"Brief vivid setting under 20 words matching the action\",\n    \"Status\": \"for production\"\n  }\n]\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "1685126b-bd11-4798-aae9-c676d6cf743d",
        "name": "Tool: Inject Creativity",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          740,
          820
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "30b4a035-33df-4826-972d-0ed2dd8fbed9",
        "name": "LLM: Generate Idea & Caption (GPT-4.1)",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          580,
          820
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1",
            "cachedResultName": "gpt-4.1"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "c1e92152-aa05-43dd-8522-23f1514cf0ad",
        "name": "Parser: Extract JSON from Idea",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          900,
          820
        ],
        "parameters": {
          "jsonSchemaExample": "[\n  {\n    \"Caption\": \"Diver Removes Nets Off Whale 🐋 #whalerescue #marinelife #oceanrescue #seahelpers #love #nature #instagood #explore #viral #savenature #oceanguardians #cleanoceans\",\n    \"Idea\": \"Diver carefully cuts tangled net from distressed whale in open sea\",\n    \"Environment\": \"Open ocean, sunlight beams through water, diver and whale, cinematic realism\",\n    \"Status\": \"for production\"\n  }\n]\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "432c7648-f9f9-4807-abf5-64d8f9a6bafb",
        "name": "Google Sheets: Save Script Idea",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1020,
          560
        ],
        "parameters": {
          "columns": {
            "value": {
              "id": "==ROW()-1",
              "idea": "={{ $json.output[0].Idea }}",
              "caption": "={{ $json.output[0].Caption }}",
              "production": "={{ $json.output[0].Status }}",
              "environment_prompt": "={{ $json.output[0].Environment }}"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "id",
                "defaultMatch": true,
                "canBeUsedToMatch": true
              },
              {
                "id": "idea",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "idea",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "caption",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "production",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "production",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "environment_prompt",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "environment_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "final_output",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "final_output",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "02c2e969-0bb6-44fa-8707-37edc2cc77fd",
        "name": "AI Agent: Create Veo3-Compatible Prompt",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1180,
          560
        ],
        "parameters": {
          "text": "=Give me a Veo3 prompt for this idea:\n{{ $json.idea }}\n\nThis is the environment:\n{{ $json.environment_prompt }}\n\n",
          "options": {
            "systemMessage": "=SYSTEM PROMPT FOR GOOGLE VEO3 PROMPT AGENT\n\nYou are an AI agent that writes hyper-realistic, cinematic video prompts for Google VEO3. Each prompt should describe a short, vivid selfie-style video clip featuring one unnamed character speaking or acting in a specific moment. The final video should look like found footage or documentary-style film — grounded, realistic, and immersive.\n\nREQUIRED STRUCTURE (FILL IN THE BRACKETS BELOW):\n\n[Scene paragraph prompt here]\n\nMain character: [description of character]\nThey say: [insert one line of dialogue, fits the scene and mood].\nThey [describe a physical action or subtle camera movement, e.g. pans the camera, shifts position, glances around].\nTime of Day: [day / night / dusk / etc.]\nLens: [describe lens]\nAudio: (implied) [ambient sounds, e.g. lion growls, wind, distant traffic, birdsong]\nBackground: [brief restatement of what is visible behind them]\n\nRULES FOR PROMPT GENERATION\n\nSingle paragraph only, 750–1500 characters. No line breaks or headings.\n\nOnly one human character. Never give them a name.\n\nInclude one spoken line of dialogue and describe how it’s delivered.\n\nCharacter must do something physical, even if subtle (e.g. glance, smirk, pan camera).\n\nUse selfie-style framing. Always describe the lens, stock, and camera behavior.\n\nScene must feel real and cinematic — like a short clip someone might record on a stylized camera.\n\nAlways include the five key technical elements: Time of Day, Lens, Film Stock, Audio, and Background.\n\nDO NOT DO THIS:\n\nDon’t name the character.\n\nDon’t include more than one character.\n\nDon’t describe subtitles or on-screen text.\n\nDon’t break the paragraph or use formatting.\n\nDon’t write vague or abstract scenes — always keep them grounded in physical detail."
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "010485e3-7b3f-496b-bcd5-05087a41805c",
        "name": "Tool: Build Prompt Structure",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          1380,
          820
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "acec06a9-c36d-4bff-a152-4a5b8b73808d",
        "name": "LLM: Format Prompt for Veo3 (GPT-4.1)",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1200,
          820
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1",
            "cachedResultName": "gpt-4.1"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4f8e53f5-d0a1-46c1-a855-a7067b493d66",
        "name": "Call Veo3 API to Generate Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          520,
          1100
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/veo3",
          "body": "={ \"prompt\": \"{{ $json.output }}\" }\n",
          "method": "POST",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          },
          "sendBody": true,
          "contentType": "raw",
          "authentication": "genericCredentialType",
          "rawContentType": "application/json",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "QhpKhFJMiQAReugp",
            "name": "Header Auth account 4"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "27881cbe-df1c-463d-8baa-5c482f0b1c04",
        "name": "Wait for Veo3 Processing (5 mins)",
        "type": "n8n-nodes-base.wait",
        "position": [
          740,
          1100
        ],
        "webhookId": "861e2761-369b-407b-9e88-1b176e617cd8",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "671eaf67-367a-41a0-b127-b06adbd5a3c9",
        "name": "Retrieve Final Video URL from Veo3",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1020,
          1100
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/veo3/requests/{{ $json.request_id }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "QhpKhFJMiQAReugp",
            "name": "Header Auth account 4"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "3555e042-a420-49fe-889e-62455616ed7c",
        "name": "Google Sheets: Log Final Video Output",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1340,
          1100
        ],
        "parameters": {
          "columns": {
            "value": {
              "idea": "={{ $('Google Sheets: Save Script Idea').first().json.idea }}",
              "production": "done",
              "final_output": "={{ $json.video.url }}"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "id",
                "defaultMatch": true,
                "canBeUsedToMatch": true
              },
              {
                "id": "idea",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "idea",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "caption",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "production",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "production",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "environment_prompt",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "environment_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "final_output",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "final_output",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "idea"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "4ae2a231-a655-4a35-bc69-d4bb1af20b67",
    "connections": {
      "Get my video": {
        "main": [
          [
            {
              "node": "Assign Social Media IDs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Assign Social Media IDs": {
        "main": [
          [
            {
              "node": "Upload Video to Blotato",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tool: Inject Creativity": {
        "ai_tool": [
          [
            {
              "node": "AI Agent: Generate Video Concept",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video to Blotato": {
        "main": [
          [
            {
              "node": "INSTAGRAM",
              "type": "main",
              "index": 0
            },
            {
              "node": "YOUTUBE",
              "type": "main",
              "index": 0
            },
            {
              "node": "TIKTOK",
              "type": "main",
              "index": 0
            },
            {
              "node": "FACEBOOK",
              "type": "main",
              "index": 0
            },
            {
              "node": "THREADS",
              "type": "main",
              "index": 0
            },
            {
              "node": "TWETTER",
              "type": "main",
              "index": 0
            },
            {
              "node": "LINKEDIN",
              "type": "main",
              "index": 0
            },
            {
              "node": "BLUESKY",
              "type": "main",
              "index": 0
            },
            {
              "node": "PINTEREST",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tool: Build Prompt Structure": {
        "ai_tool": [
          [
            {
              "node": "AI Agent: Create Veo3-Compatible Prompt",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Parser: Extract JSON from Idea": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent: Generate Video Concept",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Call Veo3 API to Generate Video": {
        "main": [
          [
            {
              "node": "Wait for Veo3 Processing (5 mins)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets: Save Script Idea": {
        "main": [
          [
            {
              "node": "AI Agent: Create Veo3-Compatible Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent: Generate Video Concept": {
        "main": [
          [
            {
              "node": "Google Sheets: Save Script Idea",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Veo3 Processing (5 mins)": {
        "main": [
          [
            {
              "node": "Retrieve Final Video URL from Veo3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Retrieve Final Video URL from Veo3": {
        "main": [
          [
            {
              "node": "Google Sheets: Log Final Video Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger: Run Daily Script Generator": {
        "main": [
          [
            {
              "node": "AI Agent: Generate Video Concept",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets: Log Final Video Output": {
        "main": [
          [
            {
              "node": "Get my video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "LLM: Format Prompt for Veo3 (GPT-4.1)": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent: Create Veo3-Compatible Prompt",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "LLM: Generate Idea & Caption (GPT-4.1)": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent: Generate Video Concept",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent: Create Veo3-Compatible Prompt": {
        "main": [
          [
            {
              "node": "Call Veo3 API to Generate Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "7wwY8wfZdNpL83QQ",
    "meta": {
      "instanceId": "b3c467df4053d13fe31cc98f3c66fa1d16300ba750506bfd019a0913cec71ea3",
      "templateCredsSetupCompleted": true
    },
    "name": "LinkedIn Leads Scraping & Enrichment (Main)",
    "tags": [],
    "nodes": [
      {
        "id": "5d07dfa4-6e6a-41a6-a2ea-8a8787331735",
        "name": "On form submission",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          -80,
          -80
        ],
        "webhookId": "28ff6927-5d05-4182-910b-be2381e3b2c4",
        "parameters": {
          "options": {},
          "formTitle": "Leads Search",
          "formFields": {
            "values": [
              {
                "fieldLabel": "Job Title",
                "requiredField": true
              },
              {
                "fieldLabel": "Location",
                "requiredField": true
              },
              {
                "fieldType": "number",
                "fieldLabel": "Number of Leads",
                "requiredField": true
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "76ade63a-7b44-4fd1-85d8-6dbacd83aca7",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          360,
          -80
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "people"
        },
        "typeVersion": 1,
        "alwaysOutputData": false
      },
      {
        "id": "3c7b7179-a8b9-41d6-9617-8eb7af38f571",
        "name": "Google Sheets Trigger",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          -100,
          280
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "DKYpQQpUt3ceJiG4",
            "name": "Google Sheets Trigger account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "9a55977c-638f-49ae-a51f-420f71c15454",
        "name": "OpenAI1",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          360,
          280
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-3.5-turbo",
            "cachedResultName": "GPT-3.5-TURBO"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=remove the http or https://www.linkedin.com/in/ from this  {{ $json.linkedin_url }}"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "DO9F6MAeTGLeqgoF",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "ca4d6b69-d4cb-4aa1-89bc-f0b5555f31cd",
        "name": "Google Sheets Trigger2",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          -100,
          680
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "DKYpQQpUt3ceJiG4",
            "name": "Google Sheets Trigger account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "15422703-fa1f-42e4-8387-7d2d4f154938",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -200,
          200
        ],
        "parameters": {
          "color": 3,
          "width": 1260,
          "height": 300,
          "content": "## Extract Linkedin Username \n"
        },
        "typeVersion": 1
      },
      {
        "id": "f8ffe414-9ca9-463a-9b98-22a65a86d4c4",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -200,
          -160
        ],
        "parameters": {
          "width": 1260,
          "height": 300,
          "content": "## Scrape Leads from Apollo\n"
        },
        "typeVersion": 1
      },
      {
        "id": "a09d3993-99d6-488e-8bc0-76542de7b53c",
        "name": "Clean Data",
        "type": "n8n-nodes-base.set",
        "position": [
          600,
          -80
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "e3bfe30e-9136-4ac9-b3da-c26eb678153b",
                "name": "id",
                "type": "string",
                "value": "={{ $json.id }}"
              },
              {
                "id": "d45c81fb-1461-45fd-be95-d5d9901d72d7",
                "name": "name",
                "type": "string",
                "value": "={{ $json.name }}"
              },
              {
                "id": "b4b8f660-7758-4a5f-a8f6-dc8ab6355132",
                "name": "linkedin_url",
                "type": "string",
                "value": "={{ $json.linkedin_url }}"
              },
              {
                "id": "399f533a-6e6b-4f40-8ed8-aa5dd39017cd",
                "name": "title",
                "type": "string",
                "value": "={{ $json.title }}"
              },
              {
                "id": "227d34c5-17db-4436-b0c2-f74e5ae453f2",
                "name": "organization",
                "type": "string",
                "value": "={{ $json.employment_history[0].organization_name }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "92d03853-644e-4c73-8ecf-1e216238b37f",
        "name": "Add Leads to Google Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          840,
          -80
        ],
        "parameters": {
          "columns": {
            "value": {
              "name": "={{ $json.name }}",
              "title": "={{ $json.title }}",
              "apollo_id": "={{ $json.id }}",
              "linkedin_url": "={{ $json.linkedin_url }}",
              "organization": "={{ $json.organization }}",
              "posts_scrape_status": "unscraped",
              "contacts_scrape_status": "pending",
              "profile_summary_scrape": "pending",
              "extract_username_status": "pending"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "organization",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "organization",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "0275f8ba-78d7-4464-bc80-ee939e9575e7",
        "name": "Add Linkedin Username",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          720,
          280
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $('Get Pending Username Row').item.json.apollo_id }}",
              "linkedin_username": "={{ $json.message.content }}",
              "extract_username_status": "finished"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "phone_number",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "phone_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "42827be7-8727-46e6-8f12-5d517c3ce6f3",
        "name": "Get Pending Username Row",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          140,
          280
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": true
          },
          "filtersUI": {
            "values": [
              {
                "lookupValue": "pending",
                "lookupColumn": "extract_username_status"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.5
      },
      {
        "id": "ffbb16a6-020e-4825-9690-3e89a8bbbbf7",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -200,
          560
        ],
        "parameters": {
          "color": 5,
          "width": 1700,
          "height": 360,
          "content": "## Get Email Address, Validate Deliverability & Update Column Status"
        },
        "typeVersion": 1
      },
      {
        "id": "d2a1b54a-bc1b-4f63-a1a4-b9bd2017f82d",
        "name": "Add Email Address",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1240,
          600
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $('Get Pending Email Statuses').item.json.apollo_id }}",
              "email_address": "={{ $json.data.email }}",
              "contacts_scrape_status": "finished"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.5
      },
      {
        "id": "7abbce6e-90fa-4ac5-9a0b-0ba2669aa77a",
        "name": "Mark Invalid Email",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1240,
          760
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $('Get Pending Email Statuses').item.json.apollo_id }}",
              "contacts_scrape_status": "invalid_email"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "2e1b9e78-8953-4059-9bbd-117c78742e4b",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1560,
          560
        ],
        "parameters": {
          "color": 5,
          "width": 800,
          "height": 360,
          "content": "## Update Contact Scrape Status from Invalid back to Pending"
        },
        "typeVersion": 1
      },
      {
        "id": "dc603dc3-148c-4609-a698-eaae32832423",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          1640,
          680
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "weeks",
                "triggerAtDay": [
                  2
                ],
                "triggerAtHour": 8,
                "weeksInterval": 4
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a23feccf-f6b5-4440-b12a-ea10b41f4037",
        "name": "Get Email from Apollo",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          380,
          680
        ],
        "parameters": {
          "url": "https://api.apollo.io/api/v1/people/match",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendQuery": true,
          "sendHeaders": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "id",
                "value": "={{ $json.apollo_id }}"
              }
            ]
          },
          "queryParameters": {
            "parameters": [
              {
                "name": "reveal_personal_emails",
                "value": "true"
              },
              {
                "name": "reveal_phone_number",
                "value": "false"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Cache-Control",
                "value": "no-cache"
              },
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "x-api-key",
                "value": "\"your_api_key\""
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "dfd5224d-fdb6-41f2-a219-a4a8f94930cd",
        "name": "Confirm Email Validity",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          620,
          680
        ],
        "parameters": {
          "url": "=https://api.mails.so/v1/validate?email={{ $json.person.email }}",
          "options": {},
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "x-mails-api-key",
                "value": "\"your_api_key\""
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "14fab17d-b38b-43de-a38e-c8d49afcf1d0",
        "name": "Get Pending Email Statuses",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          140,
          680
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": true
          },
          "filtersUI": {
            "values": [
              {
                "lookupValue": "pending",
                "lookupColumn": "contacts_scrape_status"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.5
      },
      {
        "id": "09a0c5eb-d098-47f1-a85c-13c93d8b5296",
        "name": "Google Sheets Trigger3",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          -100,
          1160
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "DKYpQQpUt3ceJiG4",
            "name": "Google Sheets Trigger account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "3f592a9c-f692-44c0-b5be-9c5ff1506f24",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -200,
          1040
        ],
        "parameters": {
          "color": 6,
          "width": 1920,
          "height": 360,
          "content": "## Get Profile Summary & Update Status (Rapid API✅ - Primary Option)"
        },
        "typeVersion": 1
      },
      {
        "id": "6bc025b4-b150-493b-ae38-33772cb51a76",
        "name": "Get Profile Posts",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "maxTries": 2,
        "position": [
          340,
          1640
        ],
        "parameters": {
          "url": "https://linkedin-data-api.p.rapidapi.com/get-profile-posts",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "username",
                "value": "={{ $json.linkedin_username }}"
              },
              {
                "name": "start",
                "value": "0"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "x-rapidapi-host",
                "value": "linkedin-data-api.p.rapidapi.com"
              },
              {
                "name": "x-rapidapi-key",
                "value": "\"your_api_key\""
              }
            ]
          }
        },
        "retryOnFail": true,
        "typeVersion": 4.2
      },
      {
        "id": "758da5bf-91e9-434d-9de5-eb3e907524e1",
        "name": "Get About Profile",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "maxTries": 2,
        "position": [
          380,
          1160
        ],
        "parameters": {
          "url": "https://linkedin-data-api.p.rapidapi.com",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "username",
                "value": "={{ $json.linkedin_username }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "x-rapidapi-host",
                "value": "linkedin-data-api.p.rapidapi.com"
              },
              {
                "name": "x-rapidapi-key",
                "value": "\"your_api_key\""
              }
            ]
          }
        },
        "retryOnFail": true,
        "typeVersion": 4.2
      },
      {
        "id": "9f88649f-3c41-4624-b94f-242d94118b0b",
        "name": "Get Pending About and Posts Rows",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          140,
          1160
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": true
          },
          "filtersUI": {
            "values": [
              {
                "lookupValue": "pending",
                "lookupColumn": "profile_summary_scrape"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.5
      },
      {
        "id": "2e8bb4a1-5fa9-446a-8b55-bffd6ceb5648",
        "name": "Clean Profile Data",
        "type": "n8n-nodes-base.code",
        "onError": "continueErrorOutput",
        "maxTries": 2,
        "position": [
          620,
          1160
        ],
        "parameters": {
          "jsCode": "return [{\n  summary: $input.first().json.summary,\n  headline: $input.first().json.headline,\n  nationality: $input.first().json.geo.country,\n  languaage: $input.first().json.languages[0].name,\n  education: $input.first().json.educations[0].schoolName,\n  fieldOfStudy: $input.first().json.educations[0].fieldOfStudy,\n  employment_company: $input.first().json.position[0].companyName,\n  company_industry: $input.first().json.position[0].companyIndustry,\n  position: $input.first().json.position[0].title,\n  company_location: $input.first().json.position[0].location,\n  employment_description_1: $input.first().json.position[0].description,\n}];\n"
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "87aa2108-44df-4b7f-8090-f2e86cbf5bf9",
        "name": "Google Sheets Trigger4",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          -120,
          1640
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "DKYpQQpUt3ceJiG4",
            "name": "Google Sheets Trigger account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "e3318dd3-4b6a-4994-92bc-2e715f398397",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -200,
          1520
        ],
        "parameters": {
          "color": 7,
          "width": 1920,
          "height": 360,
          "content": "## Get Summary of Latest Linkedin Profile Posts (Rapid API✅ - Primary Option)"
        },
        "typeVersion": 1
      },
      {
        "id": "b1c117e8-493a-443f-912b-dbf4718c3348",
        "name": "Get Pending About and Posts Rows1",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          100,
          1640
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": true
          },
          "filtersUI": {
            "values": [
              {
                "lookupValue": "unscraped",
                "lookupColumn": "posts_scrape_status"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.5
      },
      {
        "id": "c480f3ed-f316-4dd8-877b-49191d5aa694",
        "name": "Clean Posts Data",
        "type": "n8n-nodes-base.code",
        "onError": "continueErrorOutput",
        "maxTries": 2,
        "position": [
          580,
          1640
        ],
        "parameters": {
          "jsCode": "const data = $input.first().json.data || [];\n\nfunction getText(post, reshared = false) {\n  if (!post) return \"\";\n  return reshared ? (post.resharedPost?.text || \"\") : (post.text || \"\");\n}\n\nfunction getDate(post) {\n  if (!post) return \"\";\n  return post.postedDate || post.postedDateTimestamp || \"\";\n}\n\nreturn [{\n  json: {\n    post_1: getText(data[0]),\n    post_1_date: getDate(data[0]),\n\n    post_2: getText(data[1]),\n    post_2_date: getDate(data[1]),\n\n    post_3: getText(data[2]),\n    post_3_date: getDate(data[2]),\n\n    post_4: getText(data[3], true),\n    post_4_date: getDate(data[3]),\n\n    post_5: getText(data[4], true),\n    post_5_date: getDate(data[4]),\n  }\n}];\n"
        },
        "retryOnFail": true,
        "typeVersion": 2,
        "waitBetweenTries": 3000
      },
      {
        "id": "88d093e7-0180-4585-b338-11f4974fa0a7",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -200,
          1980
        ],
        "parameters": {
          "color": 4,
          "width": 800,
          "height": 360,
          "content": "## Update Completely Enriched Profile to Final Database"
        },
        "typeVersion": 1
      },
      {
        "id": "a9a96a05-f135-4a19-827f-85a750bc1551",
        "name": "Google Sheets Trigger5",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          -120,
          2100
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "DKYpQQpUt3ceJiG4",
            "name": "Google Sheets Trigger account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "ef709a3f-7e75-4904-9d3e-299db8db5d60",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1780,
          1040
        ],
        "parameters": {
          "color": 6,
          "width": 800,
          "height": 360,
          "content": "## Update profile summary status from failed back to pending"
        },
        "typeVersion": 1
      },
      {
        "id": "91a1eaed-8645-4eeb-8558-c28a6d55f689",
        "name": "Schedule Trigger2",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          1860,
          1160
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "weeks",
                "triggerAtDay": [
                  2
                ],
                "triggerAtHour": 8,
                "weeksInterval": 4
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "f7658227-39b3-4efb-971c-f17860d20fb8",
        "name": "get invalid email rows",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1880,
          680
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": false
          },
          "filtersUI": {
            "values": [
              {
                "lookupValue": "invalid_email",
                "lookupColumn": "contacts_scrape_status"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.5
      },
      {
        "id": "fce87e8a-9eb3-4c86-a4e3-f93534333206",
        "name": "update_to_pending",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2100,
          680
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $json.apollo_id }}",
              "contacts_scrape_status": "pending"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "9583cab2-6373-4e44-b9f2-ba0e8c8871e7",
        "name": "get_failed_profile_summary_rows",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2100,
          1160
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": false
          },
          "filtersUI": {
            "values": [
              {
                "lookupValue": "failed",
                "lookupColumn": "profile_summary_scrape"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.5
      },
      {
        "id": "a09d1560-2213-46ff-9668-5e98d5051e1f",
        "name": "update_to_pending1",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2320,
          1160
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $json.apollo_id }}",
              "profile_summary_scrape": "pending"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "809d74c0-bb21-4651-bf52-ccb7e8fac5a6",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1760,
          1520
        ],
        "parameters": {
          "color": 7,
          "width": 800,
          "height": 360,
          "content": "## Update posts summary status from failed back to pending"
        },
        "typeVersion": 1
      },
      {
        "id": "ee1a5073-87a9-4395-9c79-b56165a5325d",
        "name": "Schedule Trigger3",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          1840,
          1640
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "weeks",
                "triggerAtDay": [
                  2
                ],
                "triggerAtHour": 8,
                "weeksInterval": 4
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "4a89e593-adb3-4999-bb0a-cf8cc751a76a",
        "name": "get_failed_posts_summary_rows1",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2080,
          1640
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": false
          },
          "filtersUI": {
            "values": [
              {
                "lookupValue": "failed",
                "lookupColumn": "posts_scrape_status"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.5
      },
      {
        "id": "369715fe-67c5-41f1-9070-af5063f80fe0",
        "name": "Posts AI Summarizer",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          1060,
          1560
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-3.5-turbo",
            "cachedResultName": "GPT-3.5-TURBO"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Below are the most recent posts and reposts from a LinkedIn user. Summarize them collectively in no more than two short paragraphs. Focus on capturing the main themes, tone, and any recurring interests or professional concerns.\n\nAvoid listing each post separately — instead, synthesize the information into a narrative that gives a clear idea of what this person is currently focused on or passionate about.\n\nPosts: {{ $json.postsString }}\n\nKeep it insightful but brief — no more than 2 concise paragraphs."
              }
            ]
          },
          "simplify": false
        },
        "credentials": {
          "openAiApi": {
            "id": "DO9F6MAeTGLeqgoF",
            "name": "OpenAi account"
          }
        },
        "executeOnce": true,
        "typeVersion": 1.8
      },
      {
        "id": "a571b341-1a4b-42d7-a4fc-5dd8333e3dab",
        "name": "AI Profile Summarizer",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          1100,
          1080
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-3.5-turbo",
            "cachedResultName": "GPT-3.5-TURBO"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Please summarize the following linkedin profile data {{ $json.profileString }} for a lead I want to cold email. I want to combine this summary with another information about them to send personalied emails, so please make sure you include relevant bits in the summary"
              }
            ]
          },
          "simplify": false
        },
        "credentials": {
          "openAiApi": {
            "id": "DO9F6MAeTGLeqgoF",
            "name": "OpenAi account"
          }
        },
        "executeOnce": true,
        "typeVersion": 1.8
      },
      {
        "id": "8a81b29d-0ffa-4418-9aec-21eb94df7d26",
        "name": "Update Profile Summary",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1500,
          1080
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $('Get Pending About and Posts Rows').item.json.apollo_id }}",
              "about_linkedin_profile": "={{ $json.choices[0].message.content }}",
              "profile_summary_scrape": "completed"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "4803c443-be3c-4578-90fc-ab78403a0913",
        "name": "Update Posts Summary",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1440,
          1560
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $('Get Pending About and Posts Rows1').item.json.apollo_id }}",
              "posts_scrape_status": "scraped",
              "recent_posts_summary": "={{ $json.choices[0].message.content }}"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "organization",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "organization",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "ccf8b76d-1aba-4c5a-b19e-30aac3ab682a",
        "name": "Get Completely Enriched Profiles",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          120,
          2100
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": true
          },
          "filtersUI": {
            "values": [
              {
                "lookupValue": "finished",
                "lookupColumn": "contacts_scrape_status"
              },
              {
                "lookupValue": "completed",
                "lookupColumn": "profile_summary_scrape"
              },
              {
                "lookupValue": "scraped",
                "lookupColumn": "posts_scrape_status"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.5
      },
      {
        "id": "bfe41bd1-3edc-456a-9bf4-8e88009060e4",
        "name": "update_to_unscraped",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2300,
          1640
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $json.apollo_id }}",
              "posts_scrape_status": "unscraped"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "0d6e42a6-8b7e-493e-b920-7cb4d3994151",
        "name": "Append to Enriched Leads Database",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          340,
          2100
        ],
        "parameters": {
          "columns": {
            "value": {
              "Position": "={{ $json.title }}",
              "Lead Name": "={{ $json.name }}",
              "Email Address": "={{ $json.email_address }}",
              "Company/Organization": "={{ $json.organization }}",
              "Recent Posts Summary": "={{ $json.recent_posts_summary }}",
              "Linkedin Profile Summary": "={{ $json.about_linkedin_profile }}"
            },
            "schema": [
              {
                "id": "Lead Name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Lead Name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Email Address",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Email Address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Company/Organization",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Company/Organization",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Position",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Position",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Linkedin Profile Summary",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Linkedin Profile Summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Recent Posts Summary",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Recent Posts Summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Email Address"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1c5USULUPS-2_RdNf29cyDguuHH7A7JNwzFCjQQUJTvE/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1c5USULUPS-2_RdNf29cyDguuHH7A7JNwzFCjQQUJTvE",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1c5USULUPS-2_RdNf29cyDguuHH7A7JNwzFCjQQUJTvE/edit?usp=drivesdk",
            "cachedResultName": "Enriched Leads Database"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "dfc1a7e4-6348-4a84-b6b9-d9f53184948e",
        "name": "update status to failed",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          880,
          1240
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $('Get Pending About and Posts Rows').item.json.apollo_id }}",
              "profile_summary_scrape": "failed"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "organization",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "organization",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "a14fce10-9a03-4005-b440-f2bb5e4c4eed",
        "name": "Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          840,
          1720
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $('Get Pending About and Posts Rows1').item.json.apollo_id }}",
              "posts_scrape_status": "failed"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "organization",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "organization",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "77a48254-5972-4a41-90e9-3903219e78cc",
        "name": "Stringify Profile Data1",
        "type": "n8n-nodes-base.code",
        "position": [
          880,
          1080
        ],
        "parameters": {
          "jsCode": "const profile = items[0].json;\n\nreturn [{\n  json: {\n    profileString: JSON.stringify(profile, null, 2) // Pretty print with 2-space indentation\n  }\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "fb8cf143-7a62-4fdc-8888-b60841354352",
        "name": "Stringify Posts Data",
        "type": "n8n-nodes-base.code",
        "position": [
          840,
          1560
        ],
        "parameters": {
          "jsCode": "const profile = items[0].json;\n\nreturn [{\n  json: {\n    postsString: JSON.stringify(profile, null, 2) // Pretty print with 2-space indentation\n  }\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "c440d713-3371-41a5-9093-8084ecb0eabd",
        "name": "Generate Leads with Apollo.io",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          140,
          -80
        ],
        "parameters": {
          "url": "https://api.apollo.io/api/v1/mixed_people/search",
          "method": "POST",
          "options": {
            "response": {
              "response": {}
            }
          },
          "jsonBody": "={\n  \"person_locations\": [\"{{ $json.Location }}\"],\n  \"person_titles\": [\"{{ $json['Job Title'] }}\"],\n  \"page\": 1,\n  \"per_page\": {{$json['Number of Leads']}},\n  \"projection\": [\"id\", \"name\", \"linkedin_url\", \"title\"]\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Cache-Control",
                "value": "no-cache"
              },
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "x-api-key",
                "value": "\"your_api_key\""
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "81edf4b0-cc78-4d62-ba0d-5e655c01c824",
        "name": "Google Sheets Trigger6",
        "type": "n8n-nodes-base.googleSheetsTrigger",
        "position": [
          2920,
          1380
        ],
        "parameters": {
          "event": "rowAdded",
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsTriggerOAuth2Api": {
            "id": "DKYpQQpUt3ceJiG4",
            "name": "Google Sheets Trigger account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "7227fad7-9799-4159-b522-d552e0c0bd44",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2840,
          1060
        ],
        "parameters": {
          "color": 3,
          "width": 2040,
          "height": 820,
          "content": "## Get Profile and Latest Posts Summary & Update Status (Apify Alternative - Secondary, if rapid api option doesn't work )\nSome users that dont have an account on rapid API cant sign up hence are unable to get to the api and get an api key. This alternative is tailored for you. Immediatelty you get access to rapid API, please switch back to using that one. It is more reliable in scraping detailed data. See updated [documentation](https://docs.google.com/document/d/1U0Kk0HXO-9thjPcgFPu2Jk_yMtqLTv-hZobaKIGWOxM/edit?usp=sharing)"
        },
        "typeVersion": 1
      },
      {
        "id": "c807c49c-ddea-4d63-8d06-070c13ae34f3",
        "name": "Get Pending About and Posts Rows2",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          3160,
          1380
        ],
        "parameters": {
          "options": {
            "returnFirstMatch": true
          },
          "filtersUI": {
            "values": [
              {
                "lookupValue": "pending",
                "lookupColumn": "profile_summary_scrape"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "executeOnce": true,
        "typeVersion": 4.5
      },
      {
        "id": "7d79491d-5ab8-4435-b655-97e81380428f",
        "name": "Clean Profile Data1",
        "type": "n8n-nodes-base.code",
        "maxTries": 2,
        "position": [
          3720,
          1280
        ],
        "parameters": {
          "jsCode": "// Safe LinkedIn profile details scraper for n8n\nconst profileData = {};\nconst input = $input.first() && $input.first().json ? $input.first().json : {};\n\n// Basic profile information with fallbacks\nif (input.about) profileData.summary = input.about;\nif (input.headline) profileData.headline = input.headline;\nif (input.addressCountryOnly) profileData.nationality = input.addressCountryOnly;\n\n// Education information with fallbacks\nif (input.educations && Array.isArray(input.educations) && input.educations.length > 0) {\n  const education = input.educations[0];\n  if (education.title) profileData.education = education.title;\n  if (education.subtitle) profileData.fieldOfStudy = education.subtitle;\n}\n\n// Employment information with fallbacks\nif (input.experiences && Array.isArray(input.experiences) && input.experiences.length > 0) {\n  const experience = input.experiences[0];\n  if (experience.subtitle) profileData.employment_company = experience.subtitle;\n  if (experience.title) profileData.position = experience.title;\n  if (experience.metadata) profileData.company_location = experience.metadata;\n}\n\n// Return the profile data in n8n expected format\nreturn [{ json: profileData }];"
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "e13acd2c-5d4a-4683-9293-6520fc4da4a6",
        "name": "Stringify Data2",
        "type": "n8n-nodes-base.code",
        "position": [
          3900,
          1280
        ],
        "parameters": {
          "jsCode": "const profile = items[0].json;\n\nreturn [{\n  json: {\n    profileString: JSON.stringify(profile, null, 2) // Pretty print with 2-space indentation\n  }\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "e774ffc5-2c4a-46fc-89a1-1ecb3ba2ef10",
        "name": "AI Profile Summarizer1",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          4100,
          1280
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-3.5-turbo",
            "cachedResultName": "GPT-3.5-TURBO"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Please summarize the following linkedin profile data {{ $json.profileString }} for a lead I want to cold email. I want to combine this summary with another information about them to send personalied emails, so please make sure you include relevant bits in the summary"
              }
            ]
          },
          "simplify": false
        },
        "credentials": {
          "openAiApi": {
            "id": "DO9F6MAeTGLeqgoF",
            "name": "OpenAi account"
          }
        },
        "executeOnce": true,
        "typeVersion": 1.8
      },
      {
        "id": "557a763a-8388-4f34-bd35-d91cd7018b97",
        "name": "Update Profile Summary1",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          4640,
          1380
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $('Get Pending About and Posts Rows2').item.json.apollo_id }}",
              "posts_scrape_status": "scraped",
              "about_linkedin_profile": "={{ $json.choices[0].message.content }}",
              "profile_summary_scrape": "completed"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "organization",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "organization",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "867e28c2-e24f-419c-838f-d1ddc97cbd84",
        "name": "Stringify Data3",
        "type": "n8n-nodes-base.code",
        "position": [
          3900,
          1520
        ],
        "parameters": {
          "jsCode": "const profile = items[0].json;\n\nreturn [{\n  json: {\n    postsString: JSON.stringify(profile, null, 2) // Pretty print with 2-space indentation\n  }\n}];"
        },
        "typeVersion": 2
      },
      {
        "id": "ba3ba6c9-803d-4f84-ad95-314fbe68e391",
        "name": "Posts AI Summarizer1",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          4100,
          1520
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-3.5-turbo",
            "cachedResultName": "GPT-3.5-TURBO"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Below are the most recent posts and reposts from a LinkedIn user. Summarize them collectively in no more than two short paragraphs. Focus on capturing the main themes, tone, and any recurring interests or professional concerns.\n\nAvoid listing each post separately — instead, synthesize the information into a narrative that gives a clear idea of what this person is currently focused on or passionate about.\n\nPosts: {{ $json.postsString }}\n\nKeep it insightful but brief — no more than 2 concise paragraphs."
              }
            ]
          },
          "simplify": false
        },
        "credentials": {
          "openAiApi": {
            "id": "DO9F6MAeTGLeqgoF",
            "name": "OpenAi account"
          }
        },
        "executeOnce": true,
        "typeVersion": 1.8
      },
      {
        "id": "8de0e703-1af4-491a-b915-391e94bc0b18",
        "name": "Get About Profile2",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueErrorOutput",
        "position": [
          3400,
          1380
        ],
        "parameters": {
          "url": "\"apify-actor-endpoint\"",
          "options": {},
          "jsonBody": "={\n    \"profileUrls\": [\n        \"{{ $json.linkedin_url }}\"\n    ]\n}",
          "sendBody": true,
          "specifyBody": "json"
        },
        "typeVersion": 4.2
      },
      {
        "id": "2a082269-015e-4d01-850b-89db56135df1",
        "name": "Clean Profile Data2",
        "type": "n8n-nodes-base.code",
        "maxTries": 2,
        "position": [
          3720,
          1520
        ],
        "parameters": {
          "jsCode": "// n8n function to extract LinkedIn posts\nconst items = [];\n\n// Check if input exists and has updates\nif (!$input.first() || !$input.first().json || !$input.first().json.updates || !Array.isArray($input.first().json.updates)) {\n  // Return a single item with \"no posts\" message\n  items.push({\n    json: {\n      message: \"No posts found\"\n    }\n  });\n  return items;\n}\n\nconst updates = $input.first().json.updates;\n\n// If no posts available, return the \"no posts\" message\nif (updates.length === 0) {\n  items.push({\n    json: {\n      message: \"No posts found\"\n    }\n  });\n  return items;\n}\n\n// Process available posts (up to 4)\nfor (let i = 0; i < Math.min(updates.length, 4); i++) {\n  if (updates[i] && updates[i].postText) {\n    // Create an item for each post with the required n8n structure\n    items.push({\n      json: {\n        postNumber: i + 1,\n        postText: updates[i].postText\n      }\n    });\n  }\n}\n\n// If no valid posts were processed\nif (items.length === 0) {\n  items.push({\n    json: {\n      message: \"No posts found\"\n    }\n  });\n}\n\nreturn items;"
        },
        "retryOnFail": true,
        "typeVersion": 2
      },
      {
        "id": "966bf4ba-2680-4092-b62c-d37f77ffa2fc",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          4460,
          1380
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineAll"
        },
        "typeVersion": 3.1
      },
      {
        "id": "36682aa5-73bf-405b-ab10-43bc144b37af",
        "name": "update status to failed1",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          3400,
          1640
        ],
        "parameters": {
          "columns": {
            "value": {
              "apollo_id": "={{ $('Get Pending About and Posts Rows2').item.json.apollo_id }}",
              "profile_summary_scrape": "failed"
            },
            "schema": [
              {
                "id": "apollo_id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "apollo_id",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "name",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "organization",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "organization",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "title",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "title",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_url",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "linkedin_username",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "linkedin_username",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "extract_username_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "extract_username_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_address",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "email_address",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contacts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "contacts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "about_linkedin_profile",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "about_linkedin_profile",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "profile_summary_scrape",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "profile_summary_scrape",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "recent_posts_summary",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "recent_posts_summary",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "posts_scrape_status",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "posts_scrape_status",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "apollo_id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1d99PlHkp9RPeSAtmATgQ4OC4Selcp8JSFLNuKx-n1EQ/edit?usp=drivesdk",
            "cachedResultName": "apollo ai leads & enrichment"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "d0qeLhShx9sGXalR",
            "name": "Google Sheets"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "a3d2a7e0-87ed-46ac-bb75-91c54e6e1f09",
        "name": "If email is valid",
        "type": "n8n-nodes-base.if",
        "position": [
          880,
          680
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "or",
            "conditions": [
              {
                "id": "bc3200af-7ae4-4944-b410-ebb459e2d927",
                "operator": {
                  "type": "string",
                  "operation": "notContains"
                },
                "leftValue": "={{ $json.data.result }}",
                "rightValue": "undeliverable"
              },
              {
                "id": "b0c7d1c3-a733-4547-899e-ff76b66765ad",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.data.mx_record }}",
                "rightValue": "[null]"
              }
            ]
          },
          "looseTypeValidation": true
        },
        "typeVersion": 2.2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "eef068bb-348c-46c5-940b-d6042431aa01",
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Update Profile Summary1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI1": {
        "main": [
          [
            {
              "node": "Add Linkedin Username",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Clean Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Clean Data": {
        "main": [
          [
            {
              "node": "Add Leads to Google Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Stringify Data2": {
        "main": [
          [
            {
              "node": "AI Profile Summarizer1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Stringify Data3": {
        "main": [
          [
            {
              "node": "Posts AI Summarizer1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Clean Posts Data": {
        "main": [
          [
            {
              "node": "Stringify Posts Data",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "get invalid email rows",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get About Profile": {
        "main": [
          [
            {
              "node": "Clean Profile Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Profile Posts": {
        "main": [
          [
            {
              "node": "Clean Posts Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If email is valid": {
        "main": [
          [
            {
              "node": "Add Email Address",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Mark Invalid Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger2": {
        "main": [
          [
            {
              "node": "get_failed_profile_summary_rows",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger3": {
        "main": [
          [
            {
              "node": "get_failed_posts_summary_rows1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "update_to_pending": {
        "main": [
          []
        ]
      },
      "Clean Profile Data": {
        "main": [
          [
            {
              "node": "Stringify Profile Data1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "update status to failed",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get About Profile2": {
        "main": [
          [
            {
              "node": "Clean Profile Data1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Clean Profile Data2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "update status to failed1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "On form submission": {
        "main": [
          [
            {
              "node": "Generate Leads with Apollo.io",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Clean Profile Data1": {
        "main": [
          [
            {
              "node": "Stringify Data2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Clean Profile Data2": {
        "main": [
          [
            {
              "node": "Stringify Data3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Posts AI Summarizer": {
        "main": [
          [
            {
              "node": "Update Posts Summary",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Posts AI Summarizer1": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Stringify Posts Data": {
        "main": [
          [
            {
              "node": "Posts AI Summarizer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Profile Summarizer": {
        "main": [
          [
            {
              "node": "Update Profile Summary",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Email from Apollo": {
        "main": [
          [
            {
              "node": "Confirm Email Validity",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets Trigger": {
        "main": [
          [
            {
              "node": "Get Pending Username Row",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Profile Summarizer1": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Confirm Email Validity": {
        "main": [
          [
            {
              "node": "If email is valid",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets Trigger2": {
        "main": [
          [
            {
              "node": "Get Pending Email Statuses",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets Trigger3": {
        "main": [
          [
            {
              "node": "Get Pending About and Posts Rows",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets Trigger4": {
        "main": [
          [
            {
              "node": "Get Pending About and Posts Rows1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets Trigger5": {
        "main": [
          [
            {
              "node": "Get Completely Enriched Profiles",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets Trigger6": {
        "main": [
          [
            {
              "node": "Get Pending About and Posts Rows2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "get invalid email rows": {
        "main": [
          [
            {
              "node": "update_to_pending",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Stringify Profile Data1": {
        "main": [
          [
            {
              "node": "AI Profile Summarizer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Pending Username Row": {
        "main": [
          [
            {
              "node": "OpenAI1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Pending Email Statuses": {
        "main": [
          [
            {
              "node": "Get Email from Apollo",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Leads with Apollo.io": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "get_failed_posts_summary_rows1": {
        "main": [
          [
            {
              "node": "update_to_unscraped",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "get_failed_profile_summary_rows": {
        "main": [
          [
            {
              "node": "update_to_pending1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Completely Enriched Profiles": {
        "main": [
          [
            {
              "node": "Append to Enriched Leads Database",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Pending About and Posts Rows": {
        "main": [
          [
            {
              "node": "Get About Profile",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Pending About and Posts Rows1": {
        "main": [
          [
            {
              "node": "Get Profile Posts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Pending About and Posts Rows2": {
        "main": [
          [
            {
              "node": "Get About Profile2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "B3xq3cGwsIbeSRGd",
    "meta": {
      "instanceId": "843d4d5229a037453930997179f884195041f65c2aa51ee0bf20bfd5016e3a3b",
      "templateCredsSetupCompleted": true
    },
    "name": "Spare Parts Quote Generator",
    "tags": [],
    "nodes": [
      {
        "id": "a2278b8f-037c-4c94-a1cc-d5ab7df7351d",
        "name": "Welcome & Overview",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2500,
          -600
        ],
        "parameters": {
          "color": 5,
          "width": 400,
          "height": 580,
          "content": "# 🚀 Automated Quote Generator Workflow\n\n## Overview\nThis workflow automatically:\n1. **Monitors Gmail** for spare parts requests\n2. **Identifies** requests using keyword detection\n3. **Generates** professional HTML quotes using AI\n4. **Replies** automatically with pricing\n\n## Setup Required:\n1. Configure Gmail OAuth2 credentials\n2. Set up Google Sheets with your data\n3. Configure Google Gemini API\n4. Update the sticky notes with your sheet IDs\n\n## Language Support:\nThe AI automatically detects and responds in the sender's language (Turkish, English, German, etc.)"
        },
        "typeVersion": 1
      },
      {
        "id": "52c6ee3a-5a2f-48b8-8f44-26e58ffed046",
        "name": "Google Sheets Structure",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2060,
          0
        ],
        "parameters": {
          "color": 4,
          "width": 400,
          "height": 600,
          "content": "## 📊 Required Google Sheets Structure\n\n### Sheet 1: CRM Data\n**Columns Required:**\n- `Email` - Customer email addresses\n- `ProjectCode` - Project codes\n- `CustomerName` - Customer names\n- Other customer data as needed\n\n### Sheet 2: Bill of Materials (BoM)\n**Columns Required:**\n- `ProjectCode` - Project code\n- `PartCode` - Part code\n- `PartDescription` - Part description\n- `Quantity` - Quantity\n\n### Sheet 3: Pricing Data\n**Columns Required:**\n- `PartCode` - Part code\n- `UnitPriceEUR` - Unit price in EUR\n- `PartDescription` - Part description"
        },
        "typeVersion": 1
      },
      {
        "id": "6100cf53-becc-46d5-b71b-40949c36db03",
        "name": "Configuration Steps",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2060,
          -600
        ],
        "parameters": {
          "color": 6,
          "width": 400,
          "height": 580,
          "content": "## ⚙️ Configuration Steps\n\n### 1. Gmail OAuth2\n- Go to Google Cloud Console\n- Create OAuth2 credentials\n- Add Gmail API scopes\n- Configure in n8n Credentials\n\n### 2. Google Sheets OAuth2\n- Use same Google Cloud project\n- Add Sheets API scopes\n- Configure in n8n Credentials\n\n### 3. Google Gemini API\n- Get API key from Google AI Studio\n- Configure in n8n Credentials\n\n### 4. Update Sheet IDs\n- Replace placeholder IDs in:\n  - CRM node\n  - BoM node\n  - Price node"
        },
        "typeVersion": 1
      },
      {
        "id": "8c96701c-e2b6-4fcb-ba7d-1713f2a20581",
        "name": "Keyword Detection Info",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1200,
          -500
        ],
        "parameters": {
          "color": 3,
          "width": 320,
          "height": 580,
          "content": "## 🔍 Keyword Detection\n\nThis node checks for spare parts keywords:\n- **Turkish:** \"yedek parça\"\n- **German:** \"Ersatzteile\", \"Ersatzteil\"\n- **English:** \"spare parts\"\n\nAdd more keywords as needed for your use case."
        },
        "typeVersion": 1
      },
      {
        "id": "529c5508-ecac-458c-aaa4-4ca2a168ab69",
        "name": "Email Reply Flow",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -160,
          -500
        ],
        "parameters": {
          "width": 480,
          "height": 520,
          "content": "## 📧 Email Reply Flow\n\n1. **Gmail node** sends the HTML quote as a reply\n2. **Gmail2 node** marks the original email as read\n\nThis ensures clean inbox management and tracking."
        },
        "typeVersion": 1
      },
      {
        "id": "9548c3df-9a99-432e-a7eb-caf2ffa7ef87",
        "name": "IMPORTANT: Replace Sheet IDs",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -840,
          320
        ],
        "parameters": {
          "color": 7,
          "width": 600,
          "height": 280,
          "content": "## 📋 Replace These IDs\n\n**CRM Sheet ID:**\n`YOUR_CRM_SHEET_ID_HERE`\n\n**BoM Sheet ID:**\n`YOUR_BOM_SHEET_ID_HERE`\n\n**Price Sheet ID:**\n`YOUR_PRICE_SHEET_ID_HERE`\n\nFind your Sheet ID in the URL:\n`docs.google.com/spreadsheets/d/[SHEET_ID]/edit`"
        },
        "typeVersion": 1
      },
      {
        "id": "b8baf40e-d608-4bea-9545-98a8e864812f",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -1560,
          -100
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "minutes",
                "minutesInterval": 1
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "0aae0d92-b5eb-4dee-be35-4af1f80a9d67",
        "name": "Gmail - Get Latest Email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          -1360,
          -100
        ],
        "webhookId": "ad7b7fb3-2261-44b8-9911-6f517d30aac1",
        "parameters": {
          "limit": 1,
          "filters": {},
          "operation": "getAll"
        },
        "typeVersion": 2.1
      },
      {
        "id": "37e455aa-3869-43de-848d-ef118537b75c",
        "name": "Check Spare Parts Keywords",
        "type": "n8n-nodes-base.if",
        "position": [
          -1060,
          -100
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 1,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "or",
            "conditions": [
              {
                "id": "c1d2e3f4-a5b6-7c8d-9e0f-1a2b3c4d5e6f",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $json.snippet || $json.text || $json.html || '' }}",
                "rightValue": "yedek parça"
              },
              {
                "id": "0d5115f9-1c10-4c00-a82f-a8a3de8a8152",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $json.snippet || $json.text || $json.html || '' }}",
                "rightValue": "Ersatzteil"
              },
              {
                "id": "91bfaac9-c400-4413-9a8e-a6613add9684",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $json.snippet || $json.text || $json.html || '' }}",
                "rightValue": "spare parts"
              },
              {
                "id": "1bca2708-9b93-4806-b379-1ef7f7b7b62d",
                "operator": {
                  "type": "string",
                  "operation": "contains"
                },
                "leftValue": "={{ $json.snippet || $json.text || $json.html || '' }}",
                "rightValue": "Ersatzteile"
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "23f8304b-b324-476b-a95b-f94d3bd2a862",
        "name": "AI Agent - Quote Generator",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -780,
          -240
        ],
        "parameters": {
          "text": "=Create a price quote based on the email below. Follow your primary goal and all rules.\n\nSender's Email: {{ $json.To }}\nSubject: {{ $json.Subject }}\nEmail Body: {{ $json.snippet }}\nDate: {{ $('Schedule Trigger').item.json['Readable date'] }}",
          "options": {
            "maxIterations": 100,
            "systemMessage": "**PRIMARY GOAL:** Create a price quote as a complete HTML document, in the EXACT SAME language as the user's email.\n\n**RULES:**\n1.  **DETECT LANGUAGE FIRST.** This is your first action.\n2.  **RESPOND IN DETECTED LANGUAGE.** All text you generate (greetings, table headers, notes, etc.) MUST be in the detected language.\n3.  **OUTPUT MUST BE HTML:** Your final output MUST be a complete HTML document, starting with `<!DOCTYPE html>` and ending with `</html>`. Use the provided HTML template below as a strict guide.\n4.  **TOOLS ARE LANGUAGE-AGNOSTIC:** Your tools (`CRM`, `BoM`, `Price`) fetch data from sheets with English column names (`ProjectCode`, `PartCode`). The data itself may be in any language. **DO NOT TRANSLATE THE DATA** like part descriptions. Just display it as is.\n5.  **CALCULATE EVERYTHING:** You must calculate sub-totals (Quantity * Unit Price) for each item and a final Grand Total. Do not forget this. Use Calculation Tool for every calculation needed!!\n6. **NO MARKDOWN:** Do not wrap your HTML output in Markdown code blocks like \\`\\`\\`html ... \\`\\`\\` . Your entire response must start DIRECTLY with <!DOCTYPE html>.\n7. **CRITICAL: DOUBLE-CHECK MATH:** You MUST calculate the sub-total for each line item (Quantity * Unit Price). Then, you MUST sum ALL sub-totals to get the final Grand Total. Verify your final sum before outputting the HTML. Mathematical accuracy is mandatory.\n8. **CRUCIAL: If mentioned project or Part code does not exist, do NOT provide any proposal. ONLY ask for the real Project Code or Part code!\n\n**EXECUTION FLOW:**\n1.  Find the project code or part codes in the user's email.\n2.  Use the `CRM`, `BoM`, and `Price` tools to get all necessary data.\n3.  Assemble a complete and professional quote by filling in the placeholders in the HTML template below. The entire response must be this HTML.\n\n**HTML TEMPLATE (Use this structure):**\n\n<!DOCTYPE html>\n<html lang=\"[Language Code: tr, en, de]\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>[Quote Title - E.g.: Price Offer]</title>\n    <style>\n        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n        .container { width: 100%; max-width: 800px; margin: 20px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }\n        .header { text-align: left; padding-bottom: 20px; border-bottom: 2px solid #005A9C; }\n        .header h1 { color: #005A9C; margin: 0; }\n        .quote-table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n        .quote-table th, .quote-table td { border: 1px solid #ddd; padding: 12px; text-align: left; }\n        .quote-table th { background-color: #f2f2f2; font-weight: bold; }\n        .quote-table tr:nth-child(even) { background-color: #f9f9f9; }\n        .text-right { text-align: right; }\n        .footer { margin-top: 30px; font-size: 0.9em; color: #777; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>[Quote Title]</h1>\n            <p><strong>[Date Label]:</strong> {{ $('Schedule Trigger').item.json['Readable date'] }}</p>\n        </div>\n\n        <p>[Greeting]</p>\n        <p>[Introduction paragraph about the quote]</p>\n\n        <table class=\"quote-table\">\n            <thead>\n                <tr>\n                    <th>[Part Code Column]</th>\n                    <th>[Description Column]</th>\n                    <th class=\"text-right\">[Quantity Column]</th>\n                    <th class=\"text-right\">[Unit Price Column]</th>\n                    <th class=\"text-right\">[Total Price Column]</th>\n                </tr>\n            </thead>\n            <tbody>\n                <!-- REPEAT FOR EACH ITEM -->\n                <tr>\n                    <td>[Part Code]</td>\n                    <td>[Part Description]</td>\n                    <td class=\"text-right\">[Quantity]</td>\n                    <td class=\"text-right\">[Unit Price] €</td>\n                    <td class=\"text-right\">[Total Price] €</td>\n                </tr>\n            </tbody>\n        </table>\n\n        <table style=\"width: 100%; margin-top: 20px;\">\n            <tr>\n                <td style=\"text-align: right; font-weight: bold; font-size: 1.2em;\">\n                    [Grand Total Label]: [Calculated Grand Total] €\n                </td>\n            </tr>\n        </table>\n\n        <div class=\"footer\">\n            <p><strong>[Notes Title]:</strong></p>\n            <ul>\n                <li>[Validity period note]</li>\n                <li>[Delivery time note]</li>\n                <li>[Payment terms note]</li>\n            </ul>\n            <p>[Closing statement]<br>[Your Company Name]</p>\n        </div>\n    </div>\n</body>\n</html>"
          },
          "promptType": "define"
        },
        "typeVersion": 2
      },
      {
        "id": "42c482fc-bfea-460a-aec1-acb8784521ec",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          -820,
          0
        ],
        "parameters": {
          "options": {
            "temperature": 0.1,
            "maxOutputTokens": 509600
          },
          "modelName": "models/gemini-2.0-flash-exp"
        },
        "typeVersion": 1
      },
      {
        "id": "90ce437d-148b-4357-a60b-216386bf895f",
        "name": "CRM - Customer Data",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          -600,
          140
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "string",
            "value": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "string",
            "value": "YOUR_CRM_SHEET_ID_HERE"
          },
          "descriptionType": "manual",
          "toolDescription": "Fetches customer data. Searches the sheet using a column named `Email` or a column named `ProjectCode`."
        },
        "typeVersion": 4.6
      },
      {
        "id": "2ec1332d-ab34-481c-b142-16d6843495a2",
        "name": "BoM - Bill of Materials",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          -480,
          140
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "string",
            "value": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "string",
            "value": "YOUR_BOM_SHEET_ID_HERE"
          },
          "descriptionType": "manual",
          "toolDescription": "Fetches a list of all parts for a given project. Searches the sheet using a column named `ProjectCode`. Input a project ID (e.g., \"PRJ-001\") to this tool."
        },
        "typeVersion": 4.6
      },
      {
        "id": "91609c5b-55a1-4a9c-bb48-f1a239dd5d0d",
        "name": "Price - Pricing Data",
        "type": "n8n-nodes-base.googleSheetsTool",
        "position": [
          -360,
          140
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "string",
            "value": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "string",
            "value": "YOUR_PRICE_SHEET_ID_HERE"
          },
          "descriptionType": "manual",
          "toolDescription": "Fetches the price for a single part. Searches the sheet using a column named `PartCode` and returns the price from the `UnitPriceEUR` column. You must call this for every part."
        },
        "typeVersion": 4.6
      },
      {
        "id": "a934e309-59d7-4c10-a522-6ef1daea4c08",
        "name": "Calculator Tool",
        "type": "@n8n/n8n-nodes-langchain.toolCalculator",
        "position": [
          -720,
          160
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "a5c22593-8079-4254-b1e3-a977412140b8",
        "name": "Gmail - Send Reply",
        "type": "n8n-nodes-base.gmail",
        "position": [
          -100,
          -240
        ],
        "webhookId": "cdac6611-3404-4a23-ac06-81f76d19bfb0",
        "parameters": {
          "message": "={{ $json.output }}",
          "options": {},
          "messageId": "={{ $('Gmail - Get Latest Email').item.json.id }}",
          "operation": "reply"
        },
        "typeVersion": 2.1
      },
      {
        "id": "4033dcb4-31d7-403f-9f45-8adf6eeac8ac",
        "name": "Gmail - Mark as Read",
        "type": "n8n-nodes-base.gmail",
        "position": [
          120,
          -240
        ],
        "webhookId": "9fc68350-a953-43b7-bff9-81db55c433ce",
        "parameters": {
          "messageId": "={{ $('Gmail - Get Latest Email').item.json.id }}",
          "operation": "markAsRead"
        },
        "typeVersion": 2.1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "34a045ad-4fb3-48bd-b577-ac48959c92cd",
    "connections": {
      "Calculator Tool": {
        "ai_tool": [
          [
            {
              "node": "AI Agent - Quote Generator",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Gmail - Get Latest Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gmail - Send Reply": {
        "main": [
          [
            {
              "node": "Gmail - Mark as Read",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "CRM - Customer Data": {
        "ai_tool": [
          [
            {
              "node": "AI Agent - Quote Generator",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Price - Pricing Data": {
        "ai_tool": [
          [
            {
              "node": "AI Agent - Quote Generator",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "BoM - Bill of Materials": {
        "ai_tool": [
          [
            {
              "node": "AI Agent - Quote Generator",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Gmail - Get Latest Email": {
        "main": [
          [
            {
              "node": "Check Spare Parts Keywords",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent - Quote Generator",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent - Quote Generator": {
        "main": [
          [
            {
              "node": "Gmail - Send Reply",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Spare Parts Keywords": {
        "main": [
          [
            {
              "node": "AI Agent - Quote Generator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "cU2fwVR3z955Vuqt",
    "meta": {
      "instanceId": "a1ae5c8dc6c65e674f9c3947d083abcc749ef2546dff9f4ff01de4d6a36ebfe6",
      "templateCredsSetupCompleted": true
    },
    "name": "Generate Ad Image Variations Using GPT-4, Dumpling AI & Google Drive",
    "tags": [],
    "nodes": [
      {
        "id": "849a3377-d9bb-42d4-b602-61ca789bfb1f",
        "name": "Submit Brand Info + Image",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          240,
          55
        ],
        "webhookId": "da177997-c71a-4127-816e-d0e3a442b94a",
        "parameters": {
          "options": {},
          "formTitle": "Ad Image Generator",
          "formFields": {
            "values": [
              {
                "fieldLabel": "Brand Name",
                "requiredField": true
              },
              {
                "fieldLabel": "Brand Website",
                "requiredField": true
              },
              {
                "fieldType": "file",
                "fieldLabel": "Ad Image",
                "multipleFiles": false,
                "requiredField": true
              }
            ]
          },
          "formDescription": "Provide brand and product info, and an optional reference image to generate image variations with AI."
        },
        "typeVersion": 2.2
      },
      {
        "id": "25dc9e03-7c7e-44eb-897c-bd8956e554d7",
        "name": " Upload Ad Image to Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          460,
          55
        ],
        "parameters": {
          "name": "={{ $json['Ad Image'].filename }} (Original)",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive",
            "cachedResultUrl": "https://drive.google.com/drive/my-drive",
            "cachedResultName": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1R5bTxrKmi9NDMFJIh3aQgbNuZwmCybLV",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1R5bTxrKmi9NDMFJIh3aQgbNuZwmCybLV",
            "cachedResultName": "n8n Testing"
          },
          "inputDataFieldName": "Ad_Image"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "B0Hulh0j065xznhI",
            "name": "nnekajennifer"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "feb9a701-63d5-4c68-b4d2-56693dfd667a",
        "name": "Download Ad Image for Analysis",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          680,
          55
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $(' Upload Ad Image to Google Drive').item.json.id }}"
          },
          "options": {},
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "B0Hulh0j065xznhI",
            "name": "nnekajennifer"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "c6000bdb-ce69-4302-b27e-aab73d128337",
        "name": "Describe Visual Style of Image",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          900,
          55
        ],
        "parameters": {
          "text": "Describe the visual style, subject matter, and composition of this image. Is it a lifestyle image, a product-only shot, or a combination? Include lighting style and camera angle if possible.",
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "GPT-4O"
          },
          "options": {},
          "resource": "image",
          "inputType": "base64",
          "operation": "analyze"
        },
        "credentials": {
          "openAiApi": {
            "id": "dd8NvMC6rvx8RITo",
            "name": "OpenAi account 2"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "110842b9-d0d0-4c46-bc2d-94851bd6aa30",
        "name": "Analyze Brand Website Style",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          1120,
          55
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4",
            "cachedResultName": "GPT-4"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=You are a visual brand strategist and art director for direct-to-consumer (DTC) e-commerce brands.\n\nPlease analyze the following brand website. Focus **only** on the brand’s **visual aesthetic**, including:\n\n- Color palette\n- Photography style and lighting\n- Imagery themes (e.g. lifestyle vs. product shots)\n- Mood or tone evoked by visuals\n- Any repeating design elements or layout patterns\n\nBe descriptive but concise. The output will be used to help design consistent and creative AI-generated images for ad creatives — so focus entirely on the visual look and feel.\n\n\nBrand Website: {{ $('Submit Brand Info + Image').item.json['Brand Website'] }}\nBrand Name: {{ $('Submit Brand Info + Image').item.json['Brand Name'] }}\n"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "dd8NvMC6rvx8RITo",
            "name": "OpenAi account 2"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "41a97d61-1d3a-4ec3-9b76-c5fe4fb2b312",
        "name": "LangChain Agent: Generate Variation Prompts",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1496,
          55
        ],
        "parameters": {
          "text": "=Brand Name: {{ $('Submit Brand Info + Image').item.json['Brand Name'] }}\nWebsite: {{ $('Submit Brand Info + Image').item.json['Brand Website'] }}\nReference Ad Description: {{ $('Describe Visual Style of Image').item.json.content }}\nVisual Style Overview: {{ $json.message.content }}",
          "options": {
            "systemMessage": "=Brand Name: {{ $('Submit Brand Info + Image').item.json['Brand Name'] }}\nWebsite: {{ $('Submit Brand Info + Image').item.json['Brand Website'] }}\nReference Ad Description: {{ $('Describe Visual Style of Image').item.json.content }}\nVisual Style Overview: {{ $json.message.content }}\n\nYour task is to generate **10 tightly related visual variations** of a reference ad image — not new concepts. These prompts are for testing subtle creative changes on Facebook/Instagram ads (e.g., backdrop, mood, color, lighting) while preserving the original subject and composition.\n\n### Reference Materials:\n\n**Brand Info**: {{ $('Submit Brand Info + Image').item.json['Brand Name'] }}\n**Website**:  {{ $('Submit Brand Info + Image').item.json['Brand Website'] }}\n**Visual Aesthetics Guideline**: {{ $json.message.content }}\n**Reference Image Description**: {{ $('Describe Visual Style of Image').item.json.content }}\n\nUse the Reference Image Description to ground your concepts in visual reality — the new prompts should **feel like believable variations** of this original ad image in terms of camera angle, lighting, and context, while introducing fresh concepts or creative twists.\n\n### For each of the 10 prompts:\n\n- **Preserve** the reference image's subject (product, camera angle, core framing)\n- **Only vary** the background, environment, mood, lighting, or color treatment\n- Examples of variation types:\n  - Daylight vs sunset lighting\n  - Poolside vs marble countertop\n  - Lavender tones vs beach sand tones\n  - Summer vibe vs spa-like calm\n- Use vivid, sensory language to describe each variation\n- Always include **aspect ratio** (1:1 or 4:5)\n- Never introduce logos, overlays, or major subject changes\n\nThe goal is to create **subtle, performance-testable image variations**, not entirely new compositions.\n\nPlease return **only** a JSON array of 10 objects, each with a single property `\"prompt\"` containing the image prompt. Example output structure:\n\n[\n  {\n    \"prompt\": \"Sun-drenched poolside shot of the product on a marble ledge at golden hour, with soft shadows and warm tones. Aspect ratio 1:1.\"\n  },\n  {\n    \"prompt\": \"Cool lavender-tinted sunset beach backdrop behind the product, highlighting reflective metallic accents. Aspect ratio 4:5.\"\n  },\n  {\n    \"prompt\": \"...\"\n  }\n]"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "549abb3a-c944-47ce-a5eb-a5e35e8b7934",
        "name": "Parse Prompts into JSON Array",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1720,
          260
        ],
        "parameters": {
          "jsonSchemaExample": "[\n  {\n    \"prompt\": \"Sun-drenched poolside shot of the product on a marble ledge at golden hour, with soft shadows and warm tones. Aspect ratio 1:1.\"\n  },\n  {\n    \"prompt\": \"Cool lavender-tinted sunset beach backdrop behind the product, highlighting reflective metallic accents. Aspect ratio 4:5.\"\n  },\n  {\n    \"prompt\": \"...\"\n  }\n]"
        },
        "typeVersion": 1.2
      },
      {
        "id": "833fd095-e1ea-4b70-989f-542b415f4294",
        "name": "Split: One Prompt per Item",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          1872,
          55
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "output"
        },
        "typeVersion": 1
      },
      {
        "id": "89875b01-68e0-4aec-a688-9965a8ca4a3d",
        "name": "Download Base Image for Each Variation",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          2092,
          55
        ],
        "parameters": {
          "fileId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $(' Upload Ad Image to Google Drive').item.json.id }}"
          },
          "options": {},
          "operation": "download"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "B0Hulh0j065xznhI",
            "name": "nnekajennifer"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "6c0131d3-46c3-47af-b8d4-d293f5378760",
        "name": "Loop: Process Image Variations",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          2312,
          55
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "046f2619-c1a3-4674-9ae6-33221bb6f095",
        "name": "Dumpling AI: Generate Image Variation",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          2532,
          -20
        ],
        "parameters": {
          "url": "https://app.dumplingai.com/api/v1/generate-ai-image",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"model\": \"FLUX.1-pro\",\n  \"input\": {\n    \"prompt\": \"{{ $json.prompt }}\"\n  }\n}\n",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "6X2b4RLVRbz8I4Z8",
            "name": "Vapi"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "815e004d-f1ed-485f-be24-c4bf565a61f1",
        "name": " Log Image Variation URLs to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          2752,
          55
        ],
        "parameters": {
          "columns": {
            "value": {
              "Image URL": "={{ $json.url }}"
            },
            "schema": [
              {
                "id": "Image URL",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "Image URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "Image URL"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/12bBSaMdX-jE7QtIlEX4CBUEGScmJx3xK7bwFtHWan64/edit#gid=0",
            "cachedResultName": "Sheet1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/12bBSaMdX-jE7QtIlEX4CBUEGScmJx3xK7bwFtHWan64/edit?usp=drivesdk",
            "cachedResultName": "Edited image "
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "GaJqJHuS5mQxap7q",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "165b9120-6c0b-446e-afd6-c4f233d167df",
        "name": "GPT-4o (Connected to LangChain Agent)",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1524,
          275
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "dd8NvMC6rvx8RITo",
            "name": "OpenAi account 2"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "b52a1b6b-d5c5-43ad-a2c4-b318aa715f7d",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          300,
          -480
        ],
        "parameters": {
          "width": 780,
          "height": 740,
          "content": "### 🖼️ Ad Image Variation Generator (Using GPT-4 + Dumpling AI)\n\nThis workflow creates 10 subtle creative variations of a reference ad image  \nto test performance across visual styles, lighting, background, and tone —  \nwhile preserving the product's framing and subject.\n\n---\n\n### 🔧 How It Works\n\n1. User submits brand name, website, and reference ad image via a form.\n2. The image is uploaded to Google Drive.\n3. GPT-4o analyzes the image’s visual style (composition, subject, lighting).\n4. GPT-4 analyzes the brand website to understand overall visual identity.\n5. A LangChain AI Agent uses both to generate 10 variation prompts.\n6. Each prompt is passed to Dumpling AI to generate a new ad image.\n7. All image URLs are logged in Google Sheets.\n\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "3bc41ee0-40f8-4a07-b76d-e8fe2ff5a0c8",
    "connections": {
      "Submit Brand Info + Image": {
        "main": [
          [
            {
              "node": " Upload Ad Image to Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split: One Prompt per Item": {
        "main": [
          [
            {
              "node": "Download Base Image for Each Variation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analyze Brand Website Style": {
        "main": [
          [
            {
              "node": "LangChain Agent: Generate Variation Prompts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Prompts into JSON Array": {
        "ai_outputParser": [
          [
            {
              "node": "LangChain Agent: Generate Variation Prompts",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Describe Visual Style of Image": {
        "main": [
          [
            {
              "node": "Analyze Brand Website Style",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Ad Image for Analysis": {
        "main": [
          [
            {
              "node": "Describe Visual Style of Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop: Process Image Variations": {
        "main": [
          [],
          [
            {
              "node": "Dumpling AI: Generate Image Variation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Upload Ad Image to Google Drive": {
        "main": [
          [
            {
              "node": "Download Ad Image for Analysis",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Dumpling AI: Generate Image Variation": {
        "main": [
          [
            {
              "node": " Log Image Variation URLs to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GPT-4o (Connected to LangChain Agent)": {
        "ai_languageModel": [
          [
            {
              "node": "LangChain Agent: Generate Variation Prompts",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Download Base Image for Each Variation": {
        "main": [
          [
            {
              "node": "Loop: Process Image Variations",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      " Log Image Variation URLs to Google Sheets": {
        "main": [
          [
            {
              "node": "Loop: Process Image Variations",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "LangChain Agent: Generate Variation Prompts": {
        "main": [
          [
            {
              "node": "Split: One Prompt per Item",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "8418cffce8d48086ec0a73fd90aca708aa07591f2fefa6034d87fe12a09de26e",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "0f70dc82-f4af-444a-a3eb-381623091cb1",
        "name": "When clicking ‘Test workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -980,
          -200
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "cff3d74c-b381-42f9-96c0-b607a410ffeb",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          -180,
          -200
        ],
        "webhookId": "1c3e61f9-9bd3-489b-a0a1-e20c1f52d496",
        "parameters": {
          "amount": 10
        },
        "typeVersion": 1.1
      },
      {
        "id": "0ec6969b-17e2-41c3-a2c1-2c362cda54ce",
        "name": "Output",
        "type": "n8n-nodes-base.set",
        "position": [
          440,
          -180
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "53226f92-5381-4f9f-9be5-4b25f31db99c",
                "name": "data.video_url",
                "type": "string",
                "value": "={{ $json.data.video_url }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "887660ad-0ca3-4364-a2d2-443349de19de",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -260,
          -300
        ],
        "parameters": {
          "color": 7,
          "width": 660,
          "height": 340,
          "content": "## Check video status"
        },
        "typeVersion": 1
      },
      {
        "id": "7c9ee0c5-9a0a-44be-8d8a-4af99c2f3022",
        "name": "is Completed",
        "type": "n8n-nodes-base.if",
        "position": [
          220,
          -200
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "2643b070-cbb2-4562-9269-a61389e0c242",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.data.status }}",
                "rightValue": "completed"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "893813b4-1a55-4e21-a7a4-da47bf60ada2",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1920,
          -320
        ],
        "parameters": {
          "width": 820,
          "height": 860,
          "content": "# Generate AI Videos with HeyGen in n8n\n\nThis workflow allows you to generate AI-powered videos using [HeyGen](https://www.heygen.com), a platform that provides customizable AI avatars and voices. By integrating HeyGen with n8n, you can create videos by providing a text input, which is then spoken by an AI-generated avatar.\n\n# [👉🏻 Try HeyGen for free 👈🏻](https://www.heygen.com)\n\n## Setup\n\n### Step 1: Create a HeyGen Account & API Key\n1. Sign up for a [HeyGen account](https://www.heygen.com).\n2. Navigate to your account settings and locate your **API Key**.\n3. Copy your API key for use in n8n.\n\n\n⚠️ To use Heygen API you need to purchase API credits\n\n### Step 2: Create n8n Credentials\n1. In n8n, create new credentials and select **\"Custom Auth\"** as the authentication type.\n2. In the Name provide : `X-Api-Key`\n3. And in the value paste your API key from Heygen\n4. Update the 2 http node with the right credentials.\n\n### Step 3: Choose an Avatar and a Voice\nHeyGen provides multiple AI avatars and voice options. You need to choose:\n- An **Avatar ID** (representing the AI-generated presenter)\n- A **Voice ID** (which will read your text)\n\nTo find available avatars and voices:\n1. Visit the HeyGen [API Documentation](https://www.heygen.com/api) or check the list in your HeyGen account.\n2. Copy the **Avatar ID** and **Voice ID** that you want to use.\n"
        },
        "typeVersion": 1
      },
      {
        "id": "36e45b12-1edd-45ec-b3d2-ac3b6f78f7b1",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -720,
          60
        ],
        "parameters": {
          "width": 440,
          "height": 180,
          "content": "# ☝️ Provide Video Details\n\n   - **Avatar ID** \n   - **Voice ID** \n   - **Text**"
        },
        "typeVersion": 1
      },
      {
        "id": "c0ebe61f-ca8f-4928-8e89-93ef50aa17ee",
        "name": "Create Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -500,
          -140
        ],
        "parameters": {
          "url": "https://api.heygen.com/v2/video/generate",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"video_inputs\": [\n    {\n      \"character\": {\n        \"type\": \"avatar\",\n        \"avatar_id\": \"{{ $json.avatar_id }}\",\n        \"avatar_style\": \"normal\"\n      },\n      \"voice\": {\n        \"type\": \"text\",\n        \"input_text\": \"{{ $json.text }}\",\n        \"voice_id\": \"{{ $json.voice_id }}\",\n        \"speed\": 1\n      }\n    }\n  ],\n  \"caption\": true,\n  \"dimension\": {\n    \"width\": 1080,\n    \"height\": 1920\n  }\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "LQl4w1qH5sdfcP9o",
            "name": "HeyGen - Thais"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "2fd1e0cf-0dc0-4ef5-b5a0-52c87631efd7",
        "name": "Config",
        "type": "n8n-nodes-base.set",
        "position": [
          -740,
          -120
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "dc091aca-844f-404f-ad0c-8ad4b48a505b",
                "name": "avatar_id",
                "type": "string",
                "value": "7895d2d9f4f9453899e1d80e5accb6be"
              },
              {
                "id": "eb2ed34c-53d2-41e8-ab2f-1b8278bde235",
                "name": "voice_id",
                "type": "string",
                "value": "PBgwoAVFZIC0UB6sU914"
              },
              {
                "id": "2c939d6c-73f8-482d-b11f-71bdd7baf04e",
                "name": "text",
                "type": "string",
                "value": "Imagine ADHD as that super energetic friend who jumps from one cool idea to the next. Now, add AI—the smart helper trying to keep things on track. Sometimes, they work together perfectly, and other times, things get a little goofy. One minute you're starting a project, and the next, you're off chasing a shiny new idea! But that's the fun of it. With a bit of AI magic, even the craziest thoughts find their place. Embrace the chaos, laugh at the mix-ups, and let your creativity shine!"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "c63f1b7a-0ec0-4329-aeee-229e8433add7",
        "name": "Get Video Status",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          20,
          -200
        ],
        "parameters": {
          "url": "https://api.heygen.com/v1/video_status.get",
          "options": {},
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "video_id",
                "value": "={{ $('Create Video').first().json.data.video_id }}"
              }
            ]
          }
        },
        "credentials": {
          "httpCustomAuth": {
            "id": "nhkU37chaiBU6X3j",
            "name": "Eleven Labs"
          },
          "httpHeaderAuth": {
            "id": "LQl4w1qH5sdfcP9o",
            "name": "HeyGen - Thais"
          }
        },
        "typeVersion": 4.2
      }
    ],
    "pinData": {},
    "connections": {
      "Wait": {
        "main": [
          [
            {
              "node": "Get Video Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Config": {
        "main": [
          [
            {
              "node": "Create Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Video": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "is Completed": {
        "main": [
          [
            {
              "node": "Output",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Video Status": {
        "main": [
          [
            {
              "node": "is Completed",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Test workflow’": {
        "main": [
          [
            {
              "node": "Config",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "g1hmK8jw38TOYX7D",
    "meta": {
      "instanceId": "a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462",
      "templateCredsSetupCompleted": true
    },
    "name": "Create Video with Google Veo3 and Upload to Youtube",
    "tags": [],
    "nodes": [
      {
        "id": "f1fcb9ab-37aa-44a3-91fc-8480351aa5cd",
        "name": "When clicking ‘Test workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -220,
          840
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "58194812-a64d-401e-be5e-2f1ba9210557",
        "name": "Get status",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          840,
          840
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/veo3/requests/{{ $('Create Video').item.json.request_id }}/status ",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "daOZafXpRXLtoLUV",
            "name": "Fal.run API"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "1e23339c-f829-4426-b4f6-b02add8f8c5e",
        "name": "Wait 60 sec.",
        "type": "n8n-nodes-base.wait",
        "position": [
          660,
          840
        ],
        "webhookId": "490facb8-d0ae-402e-ab59-a87720cf0bdd",
        "parameters": {
          "amount": 60
        },
        "typeVersion": 1.1
      },
      {
        "id": "98ad8a6d-9ded-4f4e-a4ef-b624f7fe7e39",
        "name": "Schedule Trigger",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -220,
          700
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "minutes"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "262608c6-e905-4d16-bc52-22b67c1bc298",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -220,
          -460
        ],
        "parameters": {
          "color": 3,
          "width": 740,
          "height": 280,
          "content": "# Generate AI Videos with Google Veo3, Save to Google Drive and Upload to YouTube\n\nThis workflow allows users to **generate AI videos** using **Google Veo3**, save them to **Google Drive**, generate optimized YouTube titles with GPT-4o, and **automatically upload them to YouTube** . The entire process is triggered from a Google Sheet that acts as the central interface for input and output.\n\nIT automates video creation, uploading, and tracking, ensuring seamless integration between Google Sheets, Google Drive, Google Veo3, and YouTube.\n\n\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "1ea1879e-1e8e-42f9-8b11-7f771cfca2f8",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -220,
          -140
        ],
        "parameters": {
          "width": 740,
          "height": 200,
          "content": "## STEP 1 - GOOGLE SHEET\nCreate a [Google Sheet like this](https://docs.google.com/spreadsheets/d/1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ/edit?usp=sharing).\n\nPlease insert:\n- in the \"PROMPT\" column the accurate description of the video you want to create\n- in the \"DURATION\" column the lenght of the video you want to create\n\nLeave the \"VIDEO\" column unfilled. It will be inserted by the system once the video has been created"
        },
        "typeVersion": 1
      },
      {
        "id": "8c54b723-d0b9-4d89-8150-975306640a96",
        "name": "Completed?",
        "type": "n8n-nodes-base.if",
        "position": [
          1020,
          840
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "383d112e-2cc6-4dd4-8985-f09ce0bd1781",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.status }}",
                "rightValue": "COMPLETED"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "1135e1f0-b605-4724-a8b3-7f16b9887ef7",
        "name": "Update result",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          860,
          1100
        ],
        "parameters": {
          "columns": {
            "value": {
              "VIDEO": "={{ $('Get Url Video').item.json.video.url }}",
              "row_number": "={{ $('Get new video').item.json.row_number }}"
            },
            "schema": [
              {
                "id": "PROMPT",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PROMPT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "DURATION",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "DURATION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "VIDEO",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "VIDEO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "YOUTUBE_URL",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "YOUTUBE_URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/11ebWJvwwXHgvQld9kxywKQUvIoBw6xMa0g0BuIqHDxE/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ/edit?usp=drivesdk",
            "cachedResultName": "Video Google Veo3"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "JYR6a64Qecd6t8Hb",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "8d0ac30d-5a92-487b-aaff-f761bd720293",
        "name": "Set data",
        "type": "n8n-nodes-base.set",
        "position": [
          220,
          840
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "c713d31f-9abd-496a-ac79-e8e2efe60aa0",
                "name": "prompt",
                "type": "string",
                "value": "={{ $json.PROMPT }}\n\nDuration of the video: {{ $json.DURATION }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "ae68690d-c154-4ec9-a5b8-ba95137d2cf4",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -220,
          520
        ],
        "parameters": {
          "width": 740,
          "height": 100,
          "content": "## STEP 4 - MAIN FLOW\nStart the workflow manually or periodically by hooking the \"Schedule Trigger\" node. It is recommended to set it at 5 minute intervals."
        },
        "typeVersion": 1
      },
      {
        "id": "429ab164-e165-409c-adc7-8a80c25b9f7d",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -220,
          100
        ],
        "parameters": {
          "width": 740,
          "height": 140,
          "content": "## STEP 2 - GET API KEY (YOURAPIKEY)\nCreate an account [here](https://fal.ai/) and obtain API KEY.\nIn the node \"Create Image\" set \"Header Auth\" and set:\n- Name: \"Authorization\"\n- Value: \"Key YOURAPIKEY\""
        },
        "typeVersion": 1
      },
      {
        "id": "868339d3-e3f0-473b-9f1f-c7c4fe9c9898",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          400,
          780
        ],
        "parameters": {
          "width": 180,
          "height": 200,
          "content": "Set API Key created in Step 2"
        },
        "typeVersion": 1
      },
      {
        "id": "44793285-6bb8-471a-a632-e0fe33d2d047",
        "name": "Get new video",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          0,
          840
        ],
        "parameters": {
          "options": {},
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "VIDEO"
              }
            ]
          },
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ/edit?usp=drivesdk",
            "cachedResultName": "Video Google Veo3"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "JYR6a64Qecd6t8Hb",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "7271ea9a-c4f5-4091-8f0f-ef40bb1d94af",
        "name": "Create Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          440,
          840
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/veo3",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n     \"prompt\": \"{{$json.prompt}}\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "daOZafXpRXLtoLUV",
            "name": "Fal.run API"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f0cbd048-011e-47ee-8840-af630adf6f85",
        "name": "Get Url Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -220,
          1220
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/veo3/requests/{{ $json.request_id }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "daOZafXpRXLtoLUV",
            "name": "Fal.run API"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "f48cef5b-0609-417b-b4ec-21614397cb07",
        "name": "Get File Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          400,
          1220
        ],
        "parameters": {
          "url": "={{ $('Get Url Video').item.json.video.url }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "2cde22e1-1b71-4672-80dc-4992c4bdfe5d",
        "name": "Upload Video",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          680,
          1100
        ],
        "parameters": {
          "name": "={{ $now.format('yyyyLLddHHmmss') }}-{{ $('Get Url Video').item.json.video.file_name }}",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1aHRwLWyrqfzoVC8HoB-YMrBvQ4tLC-NZ",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1aHRwLWyrqfzoVC8HoB-YMrBvQ4tLC-NZ",
            "cachedResultName": "Fal.run"
          }
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "HEy5EuZkgPZVEa9w",
            "name": "Google Drive account (n3w.it)"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "bf77f692-8a47-4f49-883b-ba045cb39f3b",
        "name": "HTTP Request",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          680,
          1320
        ],
        "parameters": {
          "url": "https://api.upload-post.com/api/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "title",
                "value": "={{ $('Generate title').item.json.message.content }}"
              },
              {
                "name": "user",
                "value": "YOUR_USERNAME"
              },
              {
                "name": "platform[]",
                "value": "youtube"
              },
              {
                "name": "video",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "DEE2XGvhGodgbAJh",
            "name": "Upload-post.com API"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "0fab9370-c079-40c8-9e87-e9b319e0bee7",
        "name": "Generate title",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          20,
          1220
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Input: {{ $('Get new video').item.json.PROMPT }}"
              },
              {
                "role": "system",
                "content": "You are a YouTube SEO expert specialized in creating engaging and optimized titles.\n\nYour task is to generate an effective title for a YouTube video based on the user's video description.\n\nGUIDELINES:\n- Maximum 60 characters to avoid truncation\n- Use relevant keywords for SEO\n- Make the title catchy and clickable\n- Avoid excessive or misleading clickbait\n- Consider the target audience of the content\n- Use numbers, questions, or power words when appropriate\n- IMPORTANT: Generate the title in the same language as the input description\n\nOUTPUT FORMAT:\nProvide only the title, without additional explanations.\n\nEXAMPLE:\nInput: \"Tutorial video on how to cook perfect pasta carbonara\"\nOutput: \"PERFECT Carbonara in 10 Minutes - Chef's Secrets\""
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "TefveNaDaMERl1hY",
            "name": "OpenAi account (Eure)"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "cf9a58f0-0523-4229-ac2e-42f0f71d5306",
        "name": "Update Youtube URL",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          860,
          1320
        ],
        "parameters": {
          "columns": {
            "value": {
              "VIDEO": "=",
              "row_number": "={{ $('Get new video').item.json.row_number }}",
              "YOUTUBE_URL": "https://youtu.be/{{ $json.results.youtube.video_id }}"
            },
            "schema": [
              {
                "id": "PROMPT",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "PROMPT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "DURATION",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "DURATION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "VIDEO",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "VIDEO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "YOUTUBE_URL",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "YOUTUBE_URL",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/11ebWJvwwXHgvQld9kxywKQUvIoBw6xMa0g0BuIqHDxE/edit#gid=0",
            "cachedResultName": "Foglio1"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1pcoY9N_vQp44NtSRR5eskkL5Qd0N0BGq7Jh_4m-7VEQ/edit?usp=drivesdk",
            "cachedResultName": "Video Google Veo3"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "JYR6a64Qecd6t8Hb",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "2f97346c-78df-41fe-b15d-c2af7e9ee680",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          660,
          1260
        ],
        "parameters": {
          "width": 180,
          "height": 200,
          "content": "Set YOUR_USERNAME in Step 3"
        },
        "typeVersion": 1
      },
      {
        "id": "0d6517cb-d2a3-4afe-b163-25311faed711",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -220,
          280
        ],
        "parameters": {
          "width": 740,
          "height": 200,
          "content": "## STEP 3 - Upload video on Youtube\n- Find your API key in your [Upload-Post Manage Api Keys](https://www.upload-post.com/?linkId=lp_144414&sourceId=n3witalia&tenantId=upload-post-app) 10 FREE uploads per month\n- Set the the \"Auth Header\":\n-- Name: Authorization\n-- Value: Apikey YOUR_API_KEY_HERE\n- Create profiles to manage your social media accounts. The \"Profile\" you choose will be used in the field YOUR_USRNAME (eg. test1 or test2).  "
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "a358d31a-ae0a-44e0-83e4-0a0df359e143",
    "connections": {
      "Set data": {
        "main": [
          [
            {
              "node": "Create Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Completed?": {
        "main": [
          [
            {
              "node": "Get Url Video",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait 60 sec.",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get status": {
        "main": [
          [
            {
              "node": "Completed?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Video": {
        "main": [
          [
            {
              "node": "Wait 60 sec.",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Update Youtube URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video": {
        "main": [
          [
            {
              "node": "Update result",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 60 sec.": {
        "main": [
          [
            {
              "node": "Get status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Url Video": {
        "main": [
          [
            {
              "node": "Generate title",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get new video": {
        "main": [
          [
            {
              "node": "Set data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update result": {
        "main": [
          []
        ]
      },
      "Generate title": {
        "main": [
          [
            {
              "node": "Get File Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get File Video": {
        "main": [
          [
            {
              "node": "Upload Video",
              "type": "main",
              "index": 0
            },
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Test workflow’": {
        "main": [
          [
            {
              "node": "Get new video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "4nYklCFRD6OxVDKN",
    "meta": {
      "instanceId": "a2b23892dd6989fda7c1209b381f5850373a7d2b85609624d7c2b7a092671d44",
      "templateCredsSetupCompleted": true
    },
    "name": "💥 Generate AI Videos with Seedance & Blotato and Upload to TikTok, YouTube & Instagram - version II - vide",
    "tags": [],
    "nodes": [
      {
        "id": "b0bfcf76-242e-46b9-b70d-9d569d20136b",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          592,
          464
        ],
        "parameters": {
          "color": 2,
          "width": 880,
          "height": 256,
          "content": "## | Step 1: Generate Clips (Seedance)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "194bda13-961d-4209-91f9-b5bcc8969d39",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1504,
          464
        ],
        "parameters": {
          "color": 2,
          "width": 640,
          "height": 256,
          "content": "## | Step 2: Generate Sounds (Fal AI)\n"
        },
        "typeVersion": 1
      },
      {
        "id": "7c81a4b7-672f-4df4-9452-a205385028d7",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          592,
          -96
        ],
        "parameters": {
          "color": 7,
          "width": 1560,
          "height": 540,
          "content": "## | INPUT: Starting Idea Section"
        },
        "typeVersion": 1
      },
      {
        "id": "bc65e9e0-1265-4013-9d6c-7a0a535d3996",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          592,
          752
        ],
        "parameters": {
          "color": 3,
          "width": 1560,
          "height": 260,
          "content": "## | Step 3: Stitch Video (Fal AI)"
        },
        "typeVersion": 1
      },
      {
        "id": "7325db24-3e91-422c-805f-4b20c9173231",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "disabled": true,
        "position": [
          592,
          1040
        ],
        "parameters": {
          "color": 4,
          "width": 1560,
          "height": 760,
          "content": "## | Step 4 — Publish Video to Social Media\n"
        },
        "typeVersion": 1
      },
      {
        "id": "a9ec7bac-5dcb-452c-b326-5caf7ba239ef",
        "name": "Trigger: Start Daily Content Generation",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          640,
          0
        ],
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ff405b6a-9d01-4a5b-8b96-322cdac61d55",
        "name": "Tool: Inject Creative Perspective (Idea)",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          1088,
          288
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "58e66ae7-debf-45c2-aa99-8b507b5d56cb",
        "name": "Parse AI Output (Idea, Environment, Sound)",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          1248,
          288
        ],
        "parameters": {
          "jsonSchemaExample": "[\n  {\n    \"Caption\": \"Diver Removes Nets Off Whale 🐋 #whalerescue #marinelife #oceanrescue #seahelpers #love #nature #instagood #explore #viral #savenature #oceanguardians #cleanoceans\",\n    \"Idea\": \"Diver carefully cuts tangled net from distressed whale in open sea\",\n    \"Environment\": \"Open ocean, sunlight beams through water, diver and whale, cinematic realism\",\n    \"Sound\": \"Primary sound description under 15 words\",\n    \"Status\": \"for production\"\n  }\n]\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "ad438d7b-b0f5-4801-87df-e313bfb9c83f",
        "name": "Save Idea & Metadata to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1424,
          0
        ],
        "parameters": {
          "columns": {
            "value": {
              "id": "==ROW()-1",
              "idea": "={{ $json.output[0].Idea }}",
              "caption": "={{ $json.output[0].Caption }}",
              "production": "={{ $json.output[0].Status }}",
              "sound_prompt": "={{ $json.output[0].Sound }}",
              "environment_prompt": "={{ $json.output[0].Environment }}"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "id",
                "defaultMatch": true,
                "canBeUsedToMatch": true
              },
              {
                "id": "idea",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "idea",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "caption",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "production",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "production",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "environment_prompt",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "environment_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "sound_prompt",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "sound_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "final_output",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "final_output",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "1d465451-7574-446b-b69f-94b5acc68e93",
        "name": "LLM: Draft Video Prompt Details (GPT-4.1)",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          1664,
          288
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1",
            "cachedResultName": "gpt-4.1"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "7de105c4-c5d4-4b53-8453-2a396b172027",
        "name": "Tool: Refine and Validate Prompts1",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          1840,
          288
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "0f0c5fbd-5051-4e11-a9a1-5f4fca652084",
        "name": "Parse Structured Video Prompt Output",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          2000,
          288
        ],
        "parameters": {
          "jsonSchemaExample": "{\n  \"Idea\": \"An obsidian rock being sliced with a shimmering knife\",\n  \"Environment\": \"Clean studio table, subtle light reflections\",\n  \"Sound\": \"Crisp slicing, deep grinding, and delicate crumbling\",\n  \"Scene 1\": \"Extreme macro shot: a razor-sharp, polished knife blade presses into the dark, granular surface of an obsidian rock, just beginning to indent.\",\n  \"Scene 2\": \"Close-up: fine, iridescent dust particles erupt from the point of contact as the blade cuts deeper into the obsidian, catching the studio light.\",\n  \"Scene 3\": \"Mid-shot: the knife, held perfectly steady, has formed a shallow, clean groove across the obsidian's shimmering surface, revealing a new, smooth texture.\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "a5b35e3b-6dfe-4148-afd7-6eaf25a76658",
        "name": "Extract Individual Scene Descriptions",
        "type": "n8n-nodes-base.code",
        "position": [
          688,
          544
        ],
        "parameters": {
          "jsCode": "function findSceneEntries(obj) {\n  const scenes = [];\n\n  for (const [key, value] of Object.entries(obj)) {\n    if (key.toLowerCase().startsWith(\"scene\") && typeof value === \"string\") {\n      scenes.push(value);\n    } else if (typeof value === \"object\" && value !== null) {\n      scenes.push(...findSceneEntries(value));\n    }\n  }\n\n  return scenes;\n}\n\nlet output = [];\n\ntry {\n  const inputData = items[0].json;\n  const scenes = findSceneEntries(inputData);\n\n  if (scenes.length === 0) {\n    throw new Error(\"No scene keys found at any level.\");\n  }\n\n  output = scenes.map(scene => ({ description: scene }));\n} catch (e) {\n  throw new Error(\"Could not extract scenes properly. Details: \" + e.message);\n}\n\nreturn output;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "08abfd2d-8b1f-43d2-8cec-e65755184060",
        "name": "Wait for Clip Generation (Wavespeed AI)",
        "type": "n8n-nodes-base.wait",
        "position": [
          1088,
          544
        ],
        "webhookId": "e455bc41-86f8-4cff-bf9b-e07013f1b84b",
        "parameters": {
          "unit": "minutes",
          "amount": 4
        },
        "typeVersion": 1.1
      },
      {
        "id": "1a9bc668-9f94-46d5-b615-8d2fc0f189aa",
        "name": "Retrieve Video Clips",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1280,
          544
        ],
        "parameters": {
          "url": "=https://api.wavespeed.ai/api/v3/predictions/{{ $json.data.id }}/result",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "QhpKhFJMiQAReugp",
            "name": "Header Auth account 4"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "97119070-cee3-44e3-aea7-b3c74dbc63d9",
        "name": "Generate ASMR Sound (Fal AI)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1568,
          544
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/mmaudio-v2 ",
          "method": "POST",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          },
          "jsonBody": "={\n  \"prompt\": \"ASMR Soothing sound effects. {{$('Generate Detailed Video Prompts').item.json.output.Sound}}\",\n  \"duration\": 10,\n  \"video_url\": \"{{$json.data.outputs[0]}}\"\n}\n",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "kNULkYDcOZG3X0be",
            "name": "Fal.ai"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "a7c6bedd-d091-464d-ba9c-63fa5fcaad0e",
        "name": "Wait for Sound Generation (Fal AI)",
        "type": "n8n-nodes-base.wait",
        "position": [
          1760,
          544
        ],
        "webhookId": "e8e18e73-aa86-4e39-9bf3-3796a4bd7efc",
        "parameters": {
          "unit": "minutes",
          "amount": 4
        },
        "typeVersion": 1.1
      },
      {
        "id": "98b705bc-7209-4f63-ac20-29e32fa8745d",
        "name": "Retrieve Final Sound Output",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1968,
          544
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/mmaudio-v2/requests/{{ $json.request_id }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "kNULkYDcOZG3X0be",
            "name": "Fal.ai"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "d5d687e8-2043-4c0a-83fa-216e02810f68",
        "name": "List Clip URLs for Stitching",
        "type": "n8n-nodes-base.code",
        "position": [
          688,
          800
        ],
        "parameters": {
          "jsCode": "return [\n  {\n    video_urls: items.map(item => item.json.video.url)\n  }\n];"
        },
        "typeVersion": 2
      },
      {
        "id": "bd5d153b-9636-4939-b13a-6f9119ff7f91",
        "name": "Merge Clips into Final Video (Fal AI)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          880,
          800
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/ffmpeg-api/compose",
          "body": "={\n  \"tracks\": [\n    {\n      \"id\": \"1\",\n      \"type\": \"video\",\n      \"keyframes\": [\n        { \"url\": \"{{ $json.video_urls[0] }}\", \"timestamp\": 0, \"duration\": 10 },\n        { \"url\": \"{{ $json.video_urls[1] }}\", \"timestamp\": 10, \"duration\": 10 },\n        { \"url\": \"{{ $json.video_urls[2] }}\", \"timestamp\": 20, \"duration\": 10 }\n      ]\n    }\n  ]\n}",
          "method": "POST",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          },
          "sendBody": true,
          "contentType": "raw",
          "authentication": "genericCredentialType",
          "rawContentType": "application/json",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "kNULkYDcOZG3X0be",
            "name": "Fal.ai"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "5d63981d-857a-4912-bab2-8c5023e4b6f7",
        "name": "Wait for Video Rendering (Fal AI)",
        "type": "n8n-nodes-base.wait",
        "position": [
          1088,
          800
        ],
        "webhookId": "07938be9-7910-4908-b554-64f43be9e763",
        "parameters": {
          "unit": "minutes",
          "amount": 4
        },
        "typeVersion": 1.1
      },
      {
        "id": "a2325f16-6c9a-4e31-aacc-fec98bdf30ac",
        "name": "Retrieve Final Merged Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1280,
          800
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/ffmpeg-api/requests/{{ $json.request_id }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "kNULkYDcOZG3X0be",
            "name": "Fal.ai"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "cc0c7ce6-f77e-4a72-b317-e2196e4894c5",
        "name": "URL Final Video",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1968,
          800
        ],
        "parameters": {
          "columns": {
            "value": {
              "idea": "={{ $('Save Idea & Metadata to Google Sheets').first().json.idea }}",
              "production": "done",
              "final_output": "={{ $json.video_url }}"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "id",
                "defaultMatch": true,
                "canBeUsedToMatch": true
              },
              {
                "id": "idea",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "idea",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "caption",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "production",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "production",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "environment_prompt",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "environment_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "sound_prompt",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "sound_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "final_output",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "final_output",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "number",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "idea"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "25073052-c9f9-49a2-89c9-3fda74f9cef8",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -128,
          -96
        ],
        "parameters": {
          "color": 6,
          "width": 700,
          "height": 1892,
          "content": "# 🎬 Generate AI Videos with Seedance & Blotato, Upload to TikTok, YouTube & Instagram  \n\n---\n\n## 🎥 Full Tutorial  \n\n## [Video Tutorial](https://youtu.be/AzOgpdn8ngY)  \n@[youtube](AzOgpdn8ngY)\n\n---\n\n## 📘 Documentation  \nAccess detailed instructions, API guides, platform connections, and workflow customization:  \n\n📎 [Open full documentation on Notion](https://automatisation.notion.site/Generate-AI-Videos-with-Seedance-Blotato-and-Upload-to-TikTok-YouTube-Instagram-version-II-21d3d6550fd980218096d84f31bfae2d?source=copy_link)\n\n---\n\n## ⚙️ Requirements\n\n1. ✅ **OpenAI API Key** (added in LLM nodes)  \n2. 🎨 **Seedance AI & Wavespeed AI credentials** (for prompt and video clip generation)  \n3. 🔊 **Fal AI API Key** (for sound effects + stitching via ffmpeg API)  \n4. 📦 **n8n installed** (latest version recommended)  \n5. 📝 **Google Sheets connected** (used to log ideas and outputs)  \n   👉 [Google Sheet to copy](https://docs.google.com/spreadsheets/d/1Vd4XjcKZR_8cJ-2uqhOMZGc6GOULuHh_K3iDPvovw9E/copy)  \n6. ☁️ **Blotato API Key + configured social accounts** (TikTok, YouTube, Instagram, etc.)  \n7. ⏰ **Schedule Trigger setup** to define generation/publishing frequency  \n\n---\n\n## 📝 Workflow Steps in n8n\n\n1. **Trigger / Start Node**  \n   Example: scheduled trigger or manual execution.  \n\n2. **Content Creation**  \n   - OpenAI + LangChain generate creative ideas.  \n   - Seedance produces detailed video prompts.  \n   - Wavespeed AI generates video clips.  \n   - Fal AI adds sound + final editing (ffmpeg API).  \n\n3. **Logging & Upload**  \n   - Metadata + links saved in Google Sheets.  \n   - Automatic upload via **Blotato**.  \n   - Publish to TikTok, YouTube, Instagram, etc.  \n\n---\n\n## 🎛 Need help customizing?\n\n**Contact me for consulting and support:** [LinkedIn](https://www.linkedin.com/in/dr-firas/) / [YouTube](https://www.youtube.com/@DRFIRASS)  \n"
        },
        "typeVersion": 1
      },
      {
        "id": "95548f68-3784-4cfa-8f26-88672710982a",
        "name": "Generate Creative Video Idea",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          960,
          0
        ],
        "parameters": {
          "text": "Generate a creative concept involving:\n\n[[\nA solid, hard material or element being sliced cleanly with a sharp blade. Your response must follow this structure:\n\n\"(Color) (Material) shaped like a (random everyday object)\"\n\nFor inspiration, imagine examples like: obsidian shaped like a chess piece, quartz shaped like a coffee mug, sapphire shaped like a seashell, or titanium shaped like a leaf.\n\n]]\n\nReflect carefully before answering to ensure originality and visual appeal.\n\nUse the Think tool to review your output",
          "options": {
            "systemMessage": "=**Role:**  \nYou are an AI designed to generate **one immersive, realistic idea** based on a user-provided topic. Your output must be formatted as a **single-line JSON array** and follow the rules below exactly.\n\n---\n\n### RULES\n\n1. **Number of ideas**  \n   - Return **only one idea**.\n\n2. **Topic**  \n   - The user will provide a keyword (e.g., “glass cutting ASMR,” “wood carving sounds,” “satisfying rock splits”).\n\n3. **Idea**  \n   - Maximum 13 words.  \n   - Describe a viral-worthy, original, or surreal moment related to the topic.\n\n4. **Caption**  \n   - Short, punchy, viral-friendly.  \n   - Include **one emoji**.  \n   - Exactly **12 hashtags** in this order:  \n     1. 4 topic-relevant hashtags  \n     2. 4 all-time most popular hashtags  \n     3. 4 currently trending hashtags (based on live research)  \n   - All in lowercase.\n\n5. **Environment**  \n   - Maximum 20 words.  \n   - Must match the action in the Idea exactly.  \n   - Specify location (studio table, natural terrain, lab bench…), visual details (dust particles, polished surface, subtle reflections…), and style (macro close-up, cinematic slow-motion, minimalist…).\n\n6. **Sound**  \n   - Maximum 15 words.  \n   - Describe the primary sound for the scene (to feed into an audio model).\n\n7. **Status**  \n   - Always set to `\"for production\"`.\n\n---\n\n### OUTPUT FORMAT (single-line JSON array)\n\n```json\n[\n  {\n    \"Caption\": \"Your short viral title with emoji #4_topic_hashtags #4_all_time_popular_hashtags #4_trending_hashtags\",\n    \"Idea\": \"Your idea under 13 words\",\n    \"Environment\": \"Your vivid setting under 20 words matching the action\",\n    \"Sound\": \"Your primary sound description under 15 words\",\n    \"Status\": \"for production\"\n  }\n]\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "3d72df45-beca-4a5b-b0dd-1a8ed583d952",
        "name": "Generate Detailed Video Prompts",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1760,
          0
        ],
        "parameters": {
          "text": "=Give me 3 video prompts based on the previous idea\n\nUse the Think tool to review your output",
          "options": {
            "systemMessage": "=Role: You are a prompt-generation AI specializing in cinematic, ASMR-style video prompts. Your task is to generate a multi-scene video sequence that vividly shows a sharp knife actively cutting through a specific object in a clean, high-detail setting.\n\nYour writing must follow this style:\n\nSharp, precise cinematic realism.\n\nMacro-level detail with tight focus on the blade interacting with the object.\n\nThe knife must always be in motion — slicing, splitting, or gliding through the material. Never idle or static.\n\nCamera terms are allowed (e.g. macro view, tight angle, over-the-blade shot).\n\nEach scene must contain all of the following, expressed through detailed visual language:\n\n✅ The main object or subject (from the Idea)\n\n✅ The cutting environment or surface (from the Environment)\n\n✅ The texture, structure, and behavior of the material as it’s being cut\n\n✅ A visible, sharp blade actively cutting\n\nDescriptions should show:\n\nThe physical makeup of the material — is it translucent, brittle, dense, reflective, granular, fibrous, layered, or fluid-filled?\n\nHow the material responds to the blade — resistance, cracking, tearing, smooth separation, tension, vibration.\n\nThe interaction between the blade and the surface — light reflection, buildup of particles, contact points, residue or dust.\n\nAny ASMR-relevant sensory cues like particle release, shimmer, or subtle movement, but always shown visually — not narrated.\n\nTone:\n\nClean, clinical, visual.\n\nNo poetic metaphors, emotion, or storytelling.\n\nAvoid fantasy or surreal imagery.\n\nAll description must feel physically grounded and logically accurate.\n\nLength:\n\nEach scene must be between 1,000 and 2,000 characters.\n\nNo shallow or repetitive scenes — each must be immersive, descriptive, and specific.\n\nEach scene should explore a distinct phase of the cutting process, a different camera perspective, or a new behavior of the material under the blade.\n\nInputs:\n\nIdea: \"{{ $json.idea }}\"\nEnvironment: \"{{ $json.environment_prompt }}\"\nSound: \"{{ $json.sound_prompt }}\"\n\nFormat:\n\nIdea: \"...\"\nEnvironment: \"...\"\nSound: \"...\"\n\nScene 1: \"...\"\nScene 2: \"...\"\nScene 3: \"...\"\nScene 4: \"...\"\nScene 5: \"...\"\nScene 6: \"...\"\nScene 7: \"...\"\nScene 8: \"...\"\nScene 9: \"...\"\nScene 10: \"...\"\nScene 11: \"...\"\nScene 12: \"...\"\nScene 13: \"...\"\n\n"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.9
      },
      {
        "id": "d31597c6-f9e3-48d6-8a61-9a4424ef7021",
        "name": "Generate Video Clips (seedance)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          880,
          544
        ],
        "parameters": {
          "url": "https://api.wavespeed.ai/api/v3/bytedance/seedance-v1-pro-t2v-480p",
          "method": "POST",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 3000
              }
            }
          },
          "jsonBody": "={\n  \"aspect_ratio\": \"9:16\",\n  \"duration\": 10,\n  \"prompt\": \"VIDEO THEME: {{$('Generate Detailed Video Prompts').item.json.output.Idea}} | WHAT HAPPENS IN THE VIDEO: {{$json.description}} | WHERE THE VIDEO IS SHOT: {{$('Generate Detailed Video Prompts').item.json.output.Environment}}\"\n}\n",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "QhpKhFJMiQAReugp",
            "name": "Header Auth account 4"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "6c89b710-f5b6-43d8-b5d6-19ee65a21178",
        "name": "Upload Video to BLOTATO",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          688,
          1568
        ],
        "parameters": {
          "mediaUrl": "={{ $json.final_output }}",
          "resource": "media"
        },
        "credentials": {
          "blotatoApi": {
            "id": "NtMnRSKAAN5u9lyc",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "dc0d81e5-e79f-4cac-8f70-2f3cb0245a4f",
        "name": "Youtube",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1504,
          1360
        ],
        "parameters": {
          "options": {},
          "platform": "youtube",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "8047",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/8047",
            "cachedResultName": "DR FIRASS (Dr. Firas)"
          },
          "postContentText": "={{ $('Save Idea & Metadata to Google Sheets').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}",
          "postCreateYoutubeOptionTitle": "={{ $('Save Idea & Metadata to Google Sheets').first().json.idea }}",
          "postCreateYoutubeOptionPrivacyStatus": "private",
          "postCreateYoutubeOptionShouldNotifySubscribers": false
        },
        "credentials": {
          "blotatoApi": {
            "id": "NtMnRSKAAN5u9lyc",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "72b01b16-ec37-4213-b373-61ff189be5ce",
        "name": "Tiktok",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1136,
          1184
        ],
        "parameters": {
          "options": {},
          "platform": "tiktok",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "2079",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/2079",
            "cachedResultName": "elitecybzcs"
          },
          "postContentText": "={{ $('Save Idea & Metadata to Google Sheets').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "NtMnRSKAAN5u9lyc",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "ecefa11f-55e1-47ca-8f1a-6e8fc4a6e1da",
        "name": "Merge",
        "type": "n8n-nodes-base.merge",
        "position": [
          1792,
          1264
        ],
        "parameters": {
          "mode": "chooseBranch",
          "numberInputs": 9
        },
        "typeVersion": 3.2
      },
      {
        "id": "9b1c4354-4710-4e01-bc39-357da758fc1e",
        "name": "Update Status to \"DONE\"",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1968,
          1376
        ],
        "parameters": {
          "columns": {
            "value": {
              "idea": "={{ $('Save Idea & Metadata to Google Sheets').first().json.idea }}",
              "production": "Publish"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "id",
                "defaultMatch": true,
                "canBeUsedToMatch": true
              },
              {
                "id": "idea",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "idea",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "caption",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "production",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "production",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "environment_prompt",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "environment_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "sound_prompt",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "sound_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "final_output",
                "type": "string",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "final_output",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "idea"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "appendOrUpdate",
          "sheetName": {
            "__rl": true,
            "mode": "id",
            "value": "="
          },
          "documentId": {
            "__rl": true,
            "mode": "id",
            "value": "="
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "51us92xkOlrvArhV",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.5
      },
      {
        "id": "aa5e2e2a-4796-4227-acbc-f35ed12d1f84",
        "name": "Linkedin",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1328,
          1184
        ],
        "parameters": {
          "options": {},
          "platform": "linkedin",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "1446",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1446",
            "cachedResultName": "Samuel Amalric"
          },
          "postContentText": "={{ $('Save Idea & Metadata to Google Sheets').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "NtMnRSKAAN5u9lyc",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "0e0bf2c4-fba7-47f8-976b-8ac59e7e7c2a",
        "name": "Facebook",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1504,
          1184
        ],
        "parameters": {
          "options": {},
          "platform": "facebook",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "1759",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1759",
            "cachedResultName": "Firass Ben"
          },
          "facebookPageId": {
            "__rl": true,
            "mode": "list",
            "value": "101603614680195",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1759/subaccounts/101603614680195",
            "cachedResultName": "Dr. Firas"
          },
          "postContentText": "={{ $('Save Idea & Metadata to Google Sheets').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "NtMnRSKAAN5u9lyc",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "e7c07757-8d72-41bd-bb00-da0faed38e8a",
        "name": "Instagram",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1136,
          1360
        ],
        "parameters": {
          "options": {},
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "11892",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/11892",
            "cachedResultName": "doc.firass"
          },
          "postContentText": "={{ $('Save Idea & Metadata to Google Sheets').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "NtMnRSKAAN5u9lyc",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "d2e3223b-8355-42e1-a145-fbf6888725ef",
        "name": "Threads",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1136,
          1568
        ],
        "parameters": {
          "options": {},
          "platform": "threads",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "2280",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/2280",
            "cachedResultName": "doc.firass"
          },
          "postContentText": "={{ $('Save Idea & Metadata to Google Sheets').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "NtMnRSKAAN5u9lyc",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "03ef5dad-624d-49fa-85f8-767bdcd3f5ac",
        "name": "Bluesky",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1328,
          1568
        ],
        "parameters": {
          "options": {},
          "platform": "bluesky",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "6012",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/6012",
            "cachedResultName": "formationinternet.bsky.social"
          },
          "postContentText": "={{ $('Save Idea & Metadata to Google Sheets').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "NtMnRSKAAN5u9lyc",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "cdf84688-a254-4288-9cbc-b5c66f09cea0",
        "name": "Pinterest",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1504,
          1568
        ],
        "parameters": {
          "options": {},
          "platform": "pinterest",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "363",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/363",
            "cachedResultName": "formationinternet2022"
          },
          "postContentText": "={{ $('Save Idea & Metadata to Google Sheets').first().json.caption }}",
          "pinterestBoardId": {
            "__rl": true,
            "mode": "id",
            "value": "1146658823815436667"
          },
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "NtMnRSKAAN5u9lyc",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "9576e941-bd26-4b47-ae0d-4ec50350d9a3",
        "name": "Twitter (X)",
        "type": "@blotato/n8n-nodes-blotato.blotato",
        "position": [
          1328,
          1360
        ],
        "parameters": {
          "options": {},
          "platform": "twitter",
          "accountId": {
            "__rl": true,
            "mode": "list",
            "value": "1289",
            "cachedResultUrl": "https://backend.blotato.com/v2/accounts/1289",
            "cachedResultName": "Docteur_Firas"
          },
          "postContentText": "={{ $('Save Idea & Metadata to Google Sheets').first().json.caption }}",
          "postContentMediaUrls": "={{ $json.url }}"
        },
        "credentials": {
          "blotatoApi": {
            "id": "NtMnRSKAAN5u9lyc",
            "name": "Blotato account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "3912175b-5ccd-4b8e-8092-943ee7952434",
        "name": "LLM: Generate Raw Idea (GPT-5)",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          912,
          288
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5-mini",
            "cachedResultName": "gpt-5-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "6h3DfVhNPw9I25nO",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "527f2751-2d7e-4749-87ed-7df50bb3da1b",
    "connections": {
      "Merge": {
        "main": [
          [
            {
              "node": "Update Status to \"DONE\"",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tiktok": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Bluesky": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 7
            }
          ]
        ]
      },
      "Threads": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 6
            }
          ]
        ]
      },
      "Youtube": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 5
            }
          ]
        ]
      },
      "Facebook": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Linkedin": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Instagram": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 3
            }
          ]
        ]
      },
      "Pinterest": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 8
            }
          ]
        ]
      },
      "Twitter (X)": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 4
            }
          ]
        ]
      },
      "URL Final Video": {
        "main": [
          [
            {
              "node": "Upload Video to BLOTATO",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Retrieve Video Clips": {
        "main": [
          [
            {
              "node": "Generate ASMR Sound (Fal AI)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Status to \"DONE\"": {
        "main": [
          []
        ]
      },
      "Upload Video to BLOTATO": {
        "main": [
          [
            {
              "node": "Tiktok",
              "type": "main",
              "index": 0
            },
            {
              "node": "Linkedin",
              "type": "main",
              "index": 0
            },
            {
              "node": "Facebook",
              "type": "main",
              "index": 0
            },
            {
              "node": "Instagram",
              "type": "main",
              "index": 0
            },
            {
              "node": "Twitter (X)",
              "type": "main",
              "index": 0
            },
            {
              "node": "Youtube",
              "type": "main",
              "index": 0
            },
            {
              "node": "Threads",
              "type": "main",
              "index": 0
            },
            {
              "node": "Bluesky",
              "type": "main",
              "index": 0
            },
            {
              "node": "Pinterest",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Retrieve Final Merged Video": {
        "main": [
          [
            {
              "node": "URL Final Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Retrieve Final Sound Output": {
        "main": [
          [
            {
              "node": "List Clip URLs for Stitching",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate ASMR Sound (Fal AI)": {
        "main": [
          [
            {
              "node": "Wait for Sound Generation (Fal AI)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Creative Video Idea": {
        "main": [
          [
            {
              "node": "Save Idea & Metadata to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Clip URLs for Stitching": {
        "main": [
          [
            {
              "node": "Merge Clips into Final Video (Fal AI)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "LLM: Generate Raw Idea (GPT-5)": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Creative Video Idea",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Generate Detailed Video Prompts": {
        "main": [
          [
            {
              "node": "Extract Individual Scene Descriptions",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Video Clips (seedance)": {
        "main": [
          [
            {
              "node": "Wait for Clip Generation (Wavespeed AI)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Video Rendering (Fal AI)": {
        "main": [
          [
            {
              "node": "Retrieve Final Merged Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tool: Refine and Validate Prompts1": {
        "ai_tool": [
          [
            {
              "node": "Generate Detailed Video Prompts",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Sound Generation (Fal AI)": {
        "main": [
          [
            {
              "node": "Retrieve Final Sound Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Structured Video Prompt Output": {
        "ai_outputParser": [
          [
            {
              "node": "Generate Detailed Video Prompts",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Extract Individual Scene Descriptions": {
        "main": [
          [
            {
              "node": "Generate Video Clips (seedance)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge Clips into Final Video (Fal AI)": {
        "main": [
          [
            {
              "node": "Wait for Video Rendering (Fal AI)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Idea & Metadata to Google Sheets": {
        "main": [
          [
            {
              "node": "Generate Detailed Video Prompts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Trigger: Start Daily Content Generation": {
        "main": [
          [
            {
              "node": "Generate Creative Video Idea",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Clip Generation (Wavespeed AI)": {
        "main": [
          [
            {
              "node": "Retrieve Video Clips",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tool: Inject Creative Perspective (Idea)": {
        "ai_tool": [
          [
            {
              "node": "Generate Creative Video Idea",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "LLM: Draft Video Prompt Details (GPT-4.1)": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Detailed Video Prompts",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Parse AI Output (Idea, Environment, Sound)": {
        "ai_outputParser": [
          [
            {
              "node": "Generate Creative Video Idea",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "c668632f5ca4908ffa76bd7bc9be05dec193c66269ed7a1160909b2e861050b7"
    },
    "nodes": [
      {
        "id": "8495133a-8b31-4230-961b-1f65b1ecd584",
        "name": "Form Submission",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          -2320,
          672
        ],
        "webhookId": "automation-finder-form-001",
        "parameters": {
          "options": {},
          "formTitle": "Free Automation Opportunity Audit - By Evervise",
          "formFields": {
            "values": [
              {
                "fieldType": "textarea",
                "fieldLabel": "What does your business do?",
                "placeholder": "e.g., We run a digital marketing agency helping e-commerce brands with paid ads and email marketing",
                "requiredField": true
              },
              {
                "fieldLabel": "Industry/Niche",
                "placeholder": "e.g., E-commerce, SaaS, Real Estate, Professional Services"
              },
              {
                "fieldType": "dropdown",
                "fieldLabel": "Team size",
                "fieldOptions": {
                  "values": [
                    {
                      "option": "Just me (solo)"
                    },
                    {
                      "option": "2-5 people"
                    },
                    {
                      "option": "6-10 people"
                    },
                    {
                      "option": "11-25 people"
                    },
                    {
                      "option": "26-50 people"
                    },
                    {
                      "option": "50+ people"
                    }
                  ]
                },
                "requiredField": true
              },
              {
                "fieldType": "textarea",
                "fieldLabel": "What repetitive tasks take most of your team's time?",
                "placeholder": "e.g., Manually entering leads into CRM, sending follow-up emails, creating weekly reports, scheduling social media posts",
                "requiredField": true
              },
              {
                "fieldType": "textarea",
                "fieldLabel": "Current tools/software you use",
                "placeholder": "e.g., Gmail, Slack, HubSpot, Shopify, QuickBooks, Asana"
              },
              {
                "fieldType": "textarea",
                "fieldLabel": "Biggest frustration or bottleneck",
                "placeholder": "e.g., Too much time on admin work, hard to scale, manual data entry errors, slow client onboarding"
              },
              {
                "fieldType": "dropdown",
                "fieldLabel": "Monthly revenue range (optional - helps with ROI estimates)",
                "fieldOptions": {
                  "values": [
                    {
                      "option": "Prefer not to say"
                    },
                    {
                      "option": "Under $10K/month"
                    },
                    {
                      "option": "$10K-$25K/month"
                    },
                    {
                      "option": "$25K-$50K/month"
                    },
                    {
                      "option": "$50K-$100K/month"
                    },
                    {
                      "option": "$100K-$250K/month"
                    },
                    {
                      "option": "$250K+/month"
                    }
                  ]
                }
              },
              {
                "fieldType": "email",
                "fieldLabel": "Your Email",
                "placeholder": "your@email.com",
                "requiredField": true
              },
              {
                "fieldLabel": "Your Name",
                "placeholder": "John Doe",
                "requiredField": true
              }
            ]
          },
          "formDescription": "Discover $50K+ in hidden time savings. Our AI analyzes your business and identifies the top 10 automation opportunities ranked by ROI. Get your personalized blueprint in 60 seconds."
        },
        "typeVersion": 2.3
      },
      {
        "id": "074e61dc-96c9-4401-95a6-5d25c0c21584",
        "name": "Initialize Variables",
        "type": "n8n-nodes-base.set",
        "position": [
          -2016,
          608
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "business_desc",
                "name": "business_description",
                "type": "string",
                "value": "={{ $json['What does your business do?'] }}"
              },
              {
                "id": "industry",
                "name": "industry",
                "type": "string",
                "value": "={{ $json['Industry/Niche'] || 'General' }}"
              },
              {
                "id": "team_size",
                "name": "team_size",
                "type": "string",
                "value": "={{ $json['Team size'] }}"
              },
              {
                "id": "repetitive_tasks",
                "name": "repetitive_tasks",
                "type": "string",
                "value": "={{ $json['What repetitive tasks take most of your team\\'s time?'] }}"
              },
              {
                "id": "current_tools",
                "name": "current_tools",
                "type": "string",
                "value": "={{ $json['Current tools/software you use'] || 'Not specified' }}"
              },
              {
                "id": "bottleneck",
                "name": "biggest_bottleneck",
                "type": "string",
                "value": "={{ $json['Biggest frustration or bottleneck'] || 'Not specified' }}"
              },
              {
                "id": "revenue",
                "name": "monthly_revenue",
                "type": "string",
                "value": "={{ $json['Monthly revenue range (optional - helps with ROI estimates)'] || 'Not disclosed' }}"
              },
              {
                "id": "email",
                "name": "user_email",
                "type": "string",
                "value": "={{ $json['Your Email'] }}"
              },
              {
                "id": "name",
                "name": "user_name",
                "type": "string",
                "value": "={{ $json['Your Name'] }}"
              },
              {
                "id": "timestamp",
                "name": "analysis_timestamp",
                "type": "string",
                "value": "={{ new Date().toISOString() }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "d6c1585e-7ab9-4552-9c7a-c471453962af",
        "name": "Business Analyst Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          -1712,
          816
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "claude-sonnet-4-5-20250929",
            "cachedResultName": "Claude Sonnet 4.5"
          },
          "options": {
            "topP": 0.9,
            "temperature": 0.4
          }
        },
        "credentials": {
          "anthropicApi": {
            "id": "rFsH3A7ko19Tb8xL",
            "name": "Anthropic account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "463573dc-e7da-4d38-bc2c-cb4227761a0e",
        "name": "Process Mapper Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          -1280,
          784
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "claude-sonnet-4-5-20250929",
            "cachedResultName": "Claude Sonnet 4.5"
          },
          "options": {
            "topP": 0.9,
            "temperature": 0.5
          }
        },
        "credentials": {
          "anthropicApi": {
            "id": "rFsH3A7ko19Tb8xL",
            "name": "Anthropic account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "c371eb88-b8eb-45e6-9b67-fd2af1c625f2",
        "name": "Automation Architect Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          -864,
          864
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "claude-sonnet-4-5-20250929",
            "cachedResultName": "Claude Sonnet 4.5"
          },
          "options": {
            "topP": 0.95,
            "temperature": 0.6
          }
        },
        "credentials": {
          "anthropicApi": {
            "id": "rFsH3A7ko19Tb8xL",
            "name": "Anthropic account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "f696abe7-6a6b-493e-929b-ec5aa9a2b9b1",
        "name": "ROI Calculator Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          -448,
          896
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "claude-sonnet-4-5-20250929",
            "cachedResultName": "Claude Sonnet 4.5"
          },
          "options": {
            "topP": 0.85,
            "temperature": 0.3
          }
        },
        "credentials": {
          "anthropicApi": {
            "id": "rFsH3A7ko19Tb8xL",
            "name": "Anthropic account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "a9c9eb31-4805-4335-8b79-f5c0ce51f19b",
        "name": "Agent 1: Business Analyst",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -1696,
          608
        ],
        "parameters": {
          "text": "=Business Information:\n- What they do: {{ $('Initialize Variables').item.json.business_description }}\n- Industry: {{ $('Initialize Variables').item.json.industry }}\n- Team size: {{ $('Initialize Variables').item.json.team_size }}\n- Repetitive tasks: {{ $('Initialize Variables').item.json.repetitive_tasks }}\n- Current tools: {{ $('Initialize Variables').item.json.current_tools }}\n- Biggest bottleneck: {{ $('Initialize Variables').item.json.biggest_bottleneck }}\n- Revenue range: {{ $('Initialize Variables').item.json.monthly_revenue }}\n\nAnalyze this business deeply and provide insights on:\n\n1. Business model and operational flow\n2. Key workflows and processes\n3. Pain points and inefficiencies\n4. Current tech stack assessment\n5. Growth stage and scalability challenges\n6. Team capacity and resource allocation\n7. Industry-specific automation opportunities\n\nBe thorough and insightful. Identify patterns and hidden inefficiencies.",
          "options": {
            "systemMessage": "You are a senior business analyst and operations consultant with 15+ years of experience optimizing businesses across industries.\n\nYour expertise includes:\n- Understanding business models and revenue streams\n- Identifying operational inefficiencies and bottlenecks\n- Process mapping and workflow analysis\n- Tech stack evaluation\n- Scalability assessment\n- Industry-specific best practices\n\nOutput your analysis in this structure:\n\n🏢 BUSINESS OVERVIEW\n[2-3 paragraph analysis of their business model, current operations, and stage]\n\n🔍 KEY INSIGHTS\n• [Insight 1 about their operations]\n• [Insight 2 about inefficiencies]\n• [Insight 3 about growth blockers]\n• [Insight 4 about tech stack]\n• [Insight 5 about team capacity]\n\n🎯 CORE WORKFLOWS IDENTIFIED\n1. [Workflow 1] - [Brief description]\n2. [Workflow 2] - [Brief description]\n3. [Workflow 3] - [Brief description]\n4. [Workflow 4] - [Brief description]\n5. [Workflow 5] - [Brief description]\n\n⚠️ CRITICAL PAIN POINTS\n• [Pain point 1 with impact]\n• [Pain point 2 with impact]\n• [Pain point 3 with impact]\n\n💡 TECH STACK ASSESSMENT\n[Analysis of their current tools and gaps]\n\n📊 SCALABILITY ANALYSIS\n[Assessment of what's holding them back from scaling]\n\n🎪 INDUSTRY CONTEXT\n[Industry-specific insights and common automation patterns]\n\nBe specific, insightful, and identify things they might not have articulated. Read between the lines."
          },
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "fe675fd2-a909-4580-84a0-e2fae330aac4",
        "name": "Agent 2: Process Mapper",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -1280,
          608
        ],
        "parameters": {
          "text": "=Business Context:\n{{ $('Agent 1: Business Analyst').item.json.output }}\n\nOriginal Input:\n- Repetitive tasks: {{ $('Initialize Variables').item.json.repetitive_tasks }}\n- Bottleneck: {{ $('Initialize Variables').item.json.biggest_bottleneck }}\n- Current tools: {{ $('Initialize Variables').item.json.current_tools }}\n\nMap out all the repetitive, manual, or time-consuming processes in this business.\n\nFor each process, identify:\n1. What triggers it\n2. Manual steps involved\n3. Time consumed\n4. Frequency (daily, weekly, monthly)\n5. Who's responsible\n6. Tools involved\n7. Error-prone steps\n8. Bottleneck points\n\nBe comprehensive and think about processes they didn't mention but likely exist.",
          "options": {
            "systemMessage": "You are a process mapping expert and workflow optimization specialist.\n\nYour job is to:\n- Map every manual process in the business\n- Identify repetitive tasks that can be automated\n- Spot bottlenecks and inefficiencies\n- Recognize patterns across workflows\n- Think about processes they didn't mention but must exist\n- Calculate time waste\n\nOutput your analysis in this structure:\n\n📋 COMPREHENSIVE PROCESS MAP\n\n[For each major process area, provide:]\n\n### 1. [Process Name] (e.g., Lead Management)\n**Trigger:** [What starts this process]\n**Frequency:** [How often it happens]\n**Manual Steps:**\n  1. [Step with time estimate]\n  2. [Step with time estimate]\n  3. [Step with time estimate]\n**Total Time per Instance:** X minutes/hours\n**Monthly Volume:** Y times\n**Monthly Time Waste:** Z hours\n**Pain Points:**\n  • [Pain point 1]\n  • [Pain point 2]\n**Automation Potential:** [High/Medium/Low]\n\n[Repeat for 10-15 processes]\n\n⏰ TIME WASTE ANALYSIS\n- Total monthly hours wasted on repetitive tasks: X hours\n- Equivalent FTE cost: $Y/month\n- High-impact areas: [List top 5]\n\n🔴 CRITICAL BOTTLENECKS\n1. [Bottleneck 1 with impact]\n2. [Bottleneck 2 with impact]\n3. [Bottleneck 3 with impact]\n\n🎯 QUICK WIN OPPORTUNITIES\n[3-5 processes that could be automated easily]\n\n🔗 PROCESS DEPENDENCIES\n[How processes connect and where integration would help]\n\nBe thorough. Think about daily operations, client management, reporting, billing, onboarding, communication, etc."
          },
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "e177f724-1006-4a04-b142-6599f147105f",
        "name": "Agent 3: Automation Architect",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -880,
          608
        ],
        "parameters": {
          "text": "=Business Analysis:\n{{ $('Agent 1: Business Analyst').item.json.output }}\n\nProcess Map:\n{{ $('Agent 2: Process Mapper').item.json.output }}\n\nCurrent Tools:\n{{ $('Initialize Variables').item.json.current_tools }}\n\nDesign specific automation solutions for this business.\n\nFor each automation opportunity:\n1. What it automates (clear description)\n2. Tools/platforms to use (be specific: Zapier, Make, n8n, native integrations)\n3. Implementation complexity (Easy/Medium/Hard)\n4. Prerequisites (what's needed)\n5. Expected time savings\n6. Additional benefits beyond time\n\nProvide at least 15 automation ideas, ranked by impact.",
          "options": {
            "systemMessage": "You are an automation architect and no-code/low-code expert specializing in business process automation.\n\nYour expertise includes:\n- n8n, Zapier, Make (Integromat), Power Automate\n- API integrations\n- No-code tools (Airtable, Notion, etc.)\n- Native integrations between popular tools\n- Custom automation solutions\n- Workflow design\n\nOutput your recommendations in this structure:\n\n🤖 AUTOMATION OPPORTUNITIES\n\n[For each automation, format as:]\n\n### Automation #1: [Descriptive Name]\n**What it does:** [Clear 1-2 sentence description]\n**Impact:** ⭐⭐⭐⭐⭐ (High/Medium/Low)\n**Complexity:** [Easy/Medium/Hard]\n**Time Savings:** X hours/week\n**Tools Required:**\n  • [Tool 1] - [Purpose]\n  • [Tool 2] - [Purpose]\n  • [Integration platform: n8n/Zapier/Make/Native]\n\n**How it works:**\n1. [Step 1]\n2. [Step 2]\n3. [Step 3]\n\n**Prerequisites:**\n• [Requirement 1]\n• [Requirement 2]\n\n**Additional Benefits:**\n• [Benefit 1]\n• [Benefit 2]\n\n**Example Use Case:** [Specific example for their business]\n\n**Estimated Setup Time:** X hours\n**Monthly Cost:** $X\n\n---\n\n[Repeat for 15+ automations]\n\n🎯 AUTOMATION PRIORITY MATRIX\n\n**Quick Wins** (High Impact, Low Effort):\n• [Automation name]\n• [Automation name]\n\n**Strategic Projects** (High Impact, High Effort):\n• [Automation name]\n• [Automation name]\n\n**Fill-ins** (Low Impact, Low Effort):\n• [Automation name]\n\n**Long-term** (Low Impact, High Effort):\n• [Avoid these for now]\n\n🛠️ RECOMMENDED TECH STACK ADDITIONS\n[Suggest any new tools they should consider]\n\n🔗 INTEGRATION ARCHITECTURE\n[High-level diagram of how tools should connect]\n\nBe practical and specific. Use real tool names. Consider their current tech stack."
          },
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "81311cae-74a2-4dad-bdb5-4116fd199552",
        "name": "Agent 4: ROI Calculator",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -480,
          608
        ],
        "parameters": {
          "text": "=Business Context:\n- Team size: {{ $('Initialize Variables').item.json.team_size }}\n- Revenue: {{ $('Initialize Variables').item.json.monthly_revenue }}\n- Industry: {{ $('Initialize Variables').item.json.industry }}\n\nProcess Analysis:\n{{ $('Agent 2: Process Mapper').item.json.output }}\n\nAutomation Solutions:\n{{ $('Agent 3: Automation Architect').item.json.output }}\n\nCalculate detailed ROI for each automation opportunity.\n\nFor each automation:\n1. Time saved per week/month\n2. Cost of time (labor cost)\n3. Implementation cost\n4. Ongoing cost\n5. Payback period\n6. 12-month ROI\n7. Intangible benefits (error reduction, customer satisfaction, etc.)\n\nRank the top 10 automations by ROI and create a comprehensive implementation roadmap.",
          "options": {
            "systemMessage": "You are a financial analyst and ROI specialist focused on automation investments.\n\nYour job is to:\n- Calculate realistic time savings\n- Estimate labor costs based on team size and industry\n- Factor in implementation costs\n- Calculate payback periods\n- Project 12-month ROI\n- Consider intangible benefits\n- Create prioritized roadmap\n\nUse these estimation guidelines:\n- Solo entrepreneur: $50-75/hour effective rate\n- Small team (2-10): $40-60/hour average\n- Medium team (11-50): $35-50/hour average\n- Adjust by industry (tech/finance higher, service lower)\n\nOutput your analysis in this structure:\n\n💰 TOP 10 AUTOMATION OPPORTUNITIES (Ranked by ROI)\n\n### #1: [Automation Name]\n**Time Savings:** X hours/week = Y hours/year\n**Labor Cost Saved:** $Z/year (at $A/hour)\n**Implementation Cost:** $B (one-time)\n**Ongoing Cost:** $C/month = $D/year\n**Payback Period:** E months\n**12-Month Net Savings:** $F\n**ROI:** G%\n**Difficulty:** [Easy/Medium/Hard]\n**Priority Score:** H/10\n\n**Intangible Benefits:**\n• [Benefit 1]\n• [Benefit 2]\n• [Benefit 3]\n\n**Why This Ranks High:**\n[1-2 sentence explanation]\n\n---\n\n[Repeat for top 10]\n\n📊 CUMULATIVE IMPACT ANALYSIS\n\n**If all Top 10 implemented:**\n- Total annual time saved: X hours (Y FTE)\n- Total annual cost savings: $Z\n- Total implementation cost: $A\n- Total ongoing annual cost: $B\n- Net annual savings: $C\n- Overall ROI: D%\n- Payback period: E months\n\n📅 90-DAY IMPLEMENTATION ROADMAP\n\n**Month 1 - Quick Wins:**\n1. [Automation name] - Expected savings: $X/month\n2. [Automation name] - Expected savings: $Y/month\n3. [Automation name] - Expected savings: $Z/month\n\n**Month 2 - Strategic Projects:**\n1. [Automation name] - Expected savings: $X/month\n2. [Automation name] - Expected savings: $Y/month\n\n**Month 3 - Complex Integrations:**\n1. [Automation name] - Expected savings: $X/month\n2. [Automation name] - Expected savings: $Y/month\n\n**Milestones:**\n• Week 4: $X/month in savings achieved\n• Week 8: $Y/month in savings achieved  \n• Week 12: $Z/month in savings achieved\n\n💡 STRATEGIC RECOMMENDATIONS\n\n**Focus Areas:**\n1. [Recommendation 1]\n2. [Recommendation 2]\n3. [Recommendation 3]\n\n**Resource Allocation:**\n[How to prioritize team time and budget]\n\n**Success Metrics:**\n[What to track to measure impact]\n\n🚀 SCALING IMPACT\n\n**As business grows 2x:**\n- Additional savings: $X/year\n- Why: [Explanation]\n\n**As business grows 5x:**\n- Additional savings: $Y/year\n- Why: [Explanation]\n\nBe realistic with numbers. Show your math. Be conservative with estimates to build trust."
          },
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "0ae6b851-cbb6-46a5-a3d3-8b4352c21d86",
        "name": "Format Email Report",
        "type": "n8n-nodes-base.code",
        "position": [
          -160,
          608
        ],
        "parameters": {
          "jsCode": "// Format the comprehensive automation opportunity report\nconst businessAnalysis = $('Agent 1: Business Analyst').item.json.output;\nconst processMap = $('Agent 2: Process Mapper').item.json.output;\nconst automationIdeas = $('Agent 3: Automation Architect').item.json.output;\nconst roiAnalysis = $('Agent 4: ROI Calculator').item.json.output;\n\nconst userData = $('Initialize Variables').item.json;\n\n// Extract key numbers from ROI analysis\nconst extractNumber = (text, pattern) => {\n  const match = text.match(pattern);\n  return match ? match[1] : 'N/A';\n};\n\nconst totalSavings = extractNumber(roiAnalysis, /Net annual savings:\\s*\\$(\\S+)/);\nconst paybackPeriod = extractNumber(roiAnalysis, /Payback period:\\s*(\\d+)\\s*months/);\nconst overallROI = extractNumber(roiAnalysis, /Overall ROI:\\s*(\\d+)%/);\n\n// Format sections\nconst formatSection = (content, title, icon, color) => {\n  return `\n    <div style=\"margin: 30px 0; padding: 25px; background: #f8f9fa; border-left: 5px solid ${color}; border-radius: 6px;\">\n      <h2 style=\"margin: 0 0 15px 0; color: ${color}; font-size: 22px;\">${icon} ${title}</h2>\n      <div style=\"white-space: pre-line; line-height: 1.8; color: #2c3e50; font-size: 15px;\">${content}</div>\n    </div>\n  `;\n};\n\nconst emailHtml = `\n<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<style>\n  * { box-sizing: border-box; }\n  body { \n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n    line-height: 1.6; \n    color: #2c3e50; \n    background: #ecf0f1; \n    margin: 0;\n    padding: 0;\n  }\n  .container { \n    max-width: 800px; \n    margin: 0 auto; \n    background: white;\n  }\n  .header { \n    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #d946ef 100%);\n    color: white; \n    padding: 50px 30px; \n    text-align: center;\n  }\n  .header h1 { \n    margin: 0; \n    font-size: 36px; \n    font-weight: 700;\n    text-shadow: 0 2px 4px rgba(0,0,0,0.2);\n  }\n  .header p { \n    margin: 15px 0 0 0; \n    opacity: 0.95;\n    font-size: 18px;\n  }\n  .impact-banner {\n    background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n    color: white;\n    text-align: center;\n    padding: 40px 30px;\n  }\n  .impact-grid {\n    display: grid;\n    grid-template-columns: repeat(3, 1fr);\n    gap: 20px;\n    max-width: 700px;\n    margin: 0 auto;\n  }\n  .impact-card {\n    background: rgba(255,255,255,0.15);\n    padding: 25px 20px;\n    border-radius: 8px;\n    backdrop-filter: blur(10px);\n  }\n  .impact-number {\n    font-size: 42px;\n    font-weight: 700;\n    line-height: 1;\n    margin-bottom: 10px;\n  }\n  .impact-label {\n    font-size: 14px;\n    opacity: 0.95;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n  .content { \n    padding: 40px 30px;\n  }\n  .personal-greeting {\n    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);\n    padding: 30px;\n    border-radius: 10px;\n    margin-bottom: 30px;\n    border-left: 5px solid #f59e0b;\n  }\n  .personal-greeting h2 {\n    margin: 0 0 15px 0;\n    color: #92400e;\n    font-size: 24px;\n  }\n  .personal-greeting p {\n    margin: 10px 0;\n    color: #78350f;\n    font-size: 16px;\n    line-height: 1.6;\n  }\n  .cta-box {\n    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);\n    color: white;\n    padding: 50px 40px;\n    text-align: center;\n    margin: 50px 0;\n    border-radius: 12px;\n    box-shadow: 0 10px 30px rgba(99,102,241,0.3);\n  }\n  .cta-box h2 {\n    margin: 0 0 15px 0;\n    font-size: 32px;\n    font-weight: 700;\n  }\n  .cta-box p {\n    margin: 0 0 30px 0;\n    font-size: 19px;\n    opacity: 0.95;\n  }\n  .cta-button {\n    display: inline-block;\n    background: white;\n    color: #6366f1;\n    padding: 18px 45px;\n    text-decoration: none;\n    border-radius: 8px;\n    font-weight: 700;\n    font-size: 18px;\n    transition: all 0.3s;\n    box-shadow: 0 4px 15px rgba(0,0,0,0.2);\n  }\n  .cta-button:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 6px 20px rgba(0,0,0,0.3);\n  }\n  .pricing-grid {\n    display: grid;\n    grid-template-columns: repeat(3, 1fr);\n    gap: 20px;\n    margin: 40px 0;\n  }\n  .pricing-card {\n    background: white;\n    border: 2px solid #e5e7eb;\n    border-radius: 10px;\n    padding: 30px 20px;\n    text-align: center;\n    transition: all 0.3s;\n  }\n  .pricing-card:hover {\n    border-color: #6366f1;\n    box-shadow: 0 10px 30px rgba(99,102,241,0.2);\n    transform: translateY(-5px);\n  }\n  .pricing-card.featured {\n    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);\n    color: white;\n    border: none;\n    transform: scale(1.05);\n  }\n  .pricing-card h3 {\n    margin: 0 0 10px 0;\n    font-size: 22px;\n  }\n  .pricing-card .price {\n    font-size: 40px;\n    font-weight: 700;\n    margin: 15px 0;\n  }\n  .pricing-card ul {\n    list-style: none;\n    padding: 0;\n    margin: 20px 0;\n    text-align: left;\n  }\n  .pricing-card li {\n    padding: 8px 0;\n    font-size: 14px;\n  }\n  .pricing-card li:before {\n    content: \"✓ \";\n    color: #10b981;\n    font-weight: bold;\n    margin-right: 8px;\n  }\n  .pricing-card.featured li:before {\n    color: #fde68a;\n  }\n  .testimonial {\n    background: #f9fafb;\n    padding: 30px;\n    border-left: 4px solid #6366f1;\n    border-radius: 6px;\n    margin: 30px 0;\n    font-style: italic;\n  }\n  .testimonial-author {\n    margin-top: 15px;\n    font-weight: 600;\n    font-style: normal;\n    color: #6366f1;\n  }\n  .footer { \n    background: #1e293b;\n    color: white;\n    padding: 40px 30px;\n    text-align: center;\n  }\n  .footer p {\n    margin: 12px 0;\n    opacity: 0.9;\n  }\n  .footer a {\n    color: #60a5fa;\n    text-decoration: none;\n  }\n  .footer a:hover {\n    text-decoration: underline;\n  }\n  @media only screen and (max-width: 600px) {\n    .header h1 { font-size: 28px; }\n    .impact-grid { grid-template-columns: 1fr; gap: 15px; }\n    .pricing-grid { grid-template-columns: 1fr; }\n    .pricing-card.featured { transform: scale(1); }\n    .content { padding: 25px 20px; }\n    .cta-box { padding: 35px 25px; }\n  }\n</style>\n</head>\n<body>\n<div class=\"container\">\n  <!-- Header -->\n  <div class=\"header\">\n    <h1>🤖 Your Automation Blueprint</h1>\n    <p>Personalized automation opportunities analyzed by 4 AI specialists</p>\n    <p style=\"font-size: 14px; margin-top: 20px; opacity: 0.85;\">${new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>\n  </div>\n  \n  <!-- Impact Banner -->\n  <div class=\"impact-banner\">\n    <h2 style=\"margin: 0 0 30px 0; font-size: 28px; font-weight: 700;\">Your Automation Potential</h2>\n    <div class=\"impact-grid\">\n      <div class=\"impact-card\">\n        <div class=\"impact-number\">$${totalSavings}</div>\n        <div class=\"impact-label\">Annual Savings</div>\n      </div>\n      <div class=\"impact-card\">\n        <div class=\"impact-number\">${paybackPeriod}</div>\n        <div class=\"impact-label\">Months to ROI</div>\n      </div>\n      <div class=\"impact-card\">\n        <div class=\"impact-number\">${overallROI}%</div>\n        <div class=\"impact-label\">Return on Investment</div>\n      </div>\n    </div>\n  </div>\n  \n  <!-- Content -->\n  <div class=\"content\">\n    <!-- Personal Greeting -->\n    <div class=\"personal-greeting\">\n      <h2>👋 Hi ${userData.user_name}!</h2>\n      <p><strong>We analyzed your ${userData.industry} business</strong> and found some exciting opportunities.</p>\n      <p>Your team of ${userData.team_size} is spending countless hours on tasks that could be automated. We've identified <strong>10 high-impact automations</strong> that could transform your operations.</p>\n      <p>The best part? You could start seeing results in as little as <strong>${paybackPeriod} months</strong>.</p>\n    </div>\n    \n    <!-- ROI Analysis -->\n    ${formatSection(roiAnalysis, 'Top 10 Automation Opportunities (Ranked by ROI)', '💰', '#10b981')}\n    \n    <!-- Process Map -->\n    ${formatSection(processMap, 'Your Process Bottlenecks Analysis', '📋', '#f59e0b')}\n    \n    <!-- Automation Architecture -->\n    ${formatSection(automationIdeas, 'Detailed Automation Solutions', '🤖', '#6366f1')}\n    \n    <!-- Business Insights -->\n    ${formatSection(businessAnalysis, 'Business Analysis & Strategic Insights', '🏢', '#8b5cf6')}\n    \n    <!-- Testimonial -->\n    <div class=\"testimonial\">\n      \"Evervise helped us automate our entire lead management process. We went from spending 15 hours/week on manual data entry to zero. The ROI was incredible - we paid for itself in 6 weeks.\"\n      <div class=\"testimonial-author\">- Sarah Chen, Founder of GrowthLab Marketing</div>\n    </div>\n    \n    <!-- Main CTA -->\n    <div class=\"cta-box\">\n      <h2>Ready to Make This Happen?</h2>\n      <p>Our automation experts can build your top 3 automations and start saving you time immediately.</p>\n      <a href=\"https://evervise.com/book-automation-call\" class=\"cta-button\">Book a Free Strategy Call →</a>\n      <p style=\"font-size: 15px; margin-top: 25px; opacity: 0.9;\">30-minute call • No pressure • Custom implementation plan</p>\n    </div>\n    \n    <!-- Pricing Options -->\n    <div style=\"margin: 50px 0;\">\n      <h2 style=\"text-align: center; color: #1e293b; margin-bottom: 35px; font-size: 32px;\">Choose Your Path Forward</h2>\n      <div class=\"pricing-grid\">\n        <div class=\"pricing-card\">\n          <h3>DIY Blueprint</h3>\n          <div class=\"price\">FREE</div>\n          <p style=\"color: #6b7280; font-size: 14px;\">What you just received</p>\n          <ul>\n            <li>Full automation audit</li>\n            <li>10 opportunities ranked</li>\n            <li>ROI calculations</li>\n            <li>Implementation roadmap</li>\n            <li>Tool recommendations</li>\n          </ul>\n        </div>\n        \n        <div class=\"pricing-card featured\">\n          <h3>Done-For-You</h3>\n          <div class=\"price\">$497</div>\n          <p style=\"opacity: 0.95; font-size: 14px;\">Most Popular</p>\n          <ul>\n            <li>Everything in Free</li>\n            <li>We build your top 3 automations</li>\n            <li>Custom workflow design</li>\n            <li>Testing & optimization</li>\n            <li>Training for your team</li>\n            <li>30-day support included</li>\n          </ul>\n          <div style=\"margin-top: 20px;\">\n            <a href=\"https://evervise.com/done-for-you\" style=\"display: inline-block; background: white; color: #6366f1; padding: 12px 30px; border-radius: 6px; text-decoration: none; font-weight: 600;\">Get Started →</a>\n          </div>\n        </div>\n        \n        <div class=\"pricing-card\">\n          <h3>Full Automation</h3>\n          <div class=\"price\">$1,997</div>\n          <p style=\"color: #6b7280; font-size: 14px;\">Best Value</p>\n          <ul>\n            <li>Everything in Done-For-You</li>\n            <li>All 10 automations built</li>\n            <li>Advanced integrations</li>\n            <li>Custom dashboards</li>\n            <li>3 months of optimization</li>\n            <li>Priority support</li>\n            <li>ROI guarantee</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n    \n    <!-- What's Next -->\n    <div style=\"background: #eff6ff; padding: 30px; border-left: 5px solid #3b82f6; border-radius: 6px; margin: 40px 0;\">\n      <h3 style=\"margin: 0 0 15px 0; color: #1e40af; font-size: 22px;\">📅 What Happens Next?</h3>\n      <ol style=\"margin: 0; padding-left: 20px; color: #1e3a8a; line-height: 1.8;\">\n        <li style=\"margin: 12px 0;\"><strong>Review This Blueprint:</strong> Read through your personalized automation opportunities</li>\n        <li style=\"margin: 12px 0;\"><strong>Book a Strategy Call:</strong> Let's discuss which automations make sense to start with</li>\n        <li style=\"margin: 12px 0;\"><strong>We Build It:</strong> Our team implements your chosen automations (typically 1-2 weeks)</li>\n        <li style=\"margin: 12px 0;\"><strong>You Save Time:</strong> Start seeing results and reclaim hours every week</li>\n      </ol>\n    </div>\n    \n    <!-- FAQ -->\n    <div style=\"margin: 50px 0;\">\n      <h3 style=\"color: #1e293b; font-size: 26px; margin-bottom: 25px;\">❓ Common Questions</h3>\n      \n      <div style=\"margin: 20px 0; padding: 20px; background: #f9fafb; border-radius: 6px;\">\n        <h4 style=\"margin: 0 0 10px 0; color: #6366f1;\">Can I implement these myself?</h4>\n        <p style=\"margin: 0; color: #4b5563;\">Absolutely! The blueprint gives you everything you need. However, most clients prefer we handle it so they can focus on their business.</p>\n      </div>\n      \n      <div style=\"margin: 20px 0; padding: 20px; background: #f9fafb; border-radius: 6px;\">\n        <h4 style=\"margin: 0 0 10px 0; color: #6366f1;\">How long does implementation take?</h4>\n        <p style=\"margin: 0; color: #4b5563;\">Quick wins can be live in days. Complex integrations take 1-2 weeks. We'll give you a detailed timeline on the strategy call.</p>\n      </div>\n      \n      <div style=\"margin: 20px 0; padding: 20px; background: #f9fafb; border-radius: 6px;\">\n        <h4 style=\"margin: 0 0 10px 0; color: #6366f1;\">What if my tools aren't supported?</h4>\n        <p style=\"margin: 0; color: #4b5563;\">We work with 5,000+ apps and can build custom integrations if needed. If we can't automate something, we'll tell you upfront.</p>\n      </div>\n      \n      <div style=\"margin: 20px 0; padding: 20px; background: #f9fafb; border-radius: 6px;\">\n        <h4 style=\"margin: 0 0 10px 0; color: #6366f1;\">Is there ongoing support?</h4>\n        <p style=\"margin: 0; color: #4b5563;\">Yes! All packages include support. We'll make sure everything runs smoothly and optimize as your business grows.</p>\n      </div>\n    </div>\n    \n    <!-- Final CTA -->\n    <div style=\"text-align: center; padding: 40px 0; border-top: 2px solid #e5e7eb; margin-top: 50px;\">\n      <h3 style=\"color: #1e293b; font-size: 28px; margin-bottom: 20px;\">Stop Wasting Time on Manual Work</h3>\n      <p style=\"color: #6b7280; font-size: 18px; margin-bottom: 30px;\">The analysis is done. Now it's time to take action.</p>\n      <a href=\"https://evervise.com/book-automation-call\" style=\"display: inline-block; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; padding: 18px 45px; text-decoration: none; border-radius: 8px; font-weight: 700; font-size: 18px; box-shadow: 0 4px 15px rgba(99,102,241,0.4);\">Book Your Free Call Now →</a>\n      <p style=\"color: #9ca3af; font-size: 14px; margin-top: 20px;\">Limited spots available • Typical response time: 24 hours</p>\n    </div>\n  </div>\n  \n  <!-- Footer -->\n  <div class=\"footer\">\n    <h3 style=\"margin: 0 0 20px 0; color: white; font-size: 24px;\">Evervise</h3>\n    <p style=\"font-size: 16px;\">Digital Marketing • Automation • Programming</p>\n    <p>We help businesses digitalize and scale with AI-powered automation.</p>\n    <p style=\"margin-top: 30px;\">\n      <a href=\"https://evervise.com\">Website</a> | \n      <a href=\"https://evervise.com/case-studies\">Case Studies</a> | \n      <a href=\"https://evervise.com/contact\">Contact Us</a>\n    </p>\n    <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.2);\">\n      <p style=\"font-size: 13px; opacity: 0.8;\">\n        This automation opportunity audit was generated by our AI-powered analysis system.<br>\n        All recommendations are customized to ${userData.user_name}'s ${userData.industry} business.\n      </p>\n      <p style=\"font-size: 12px; margin-top: 15px; opacity: 0.6;\">\n        © ${new Date().getFullYear()} Evervise. All rights reserved.\n      </p>\n    </div>\n  </div>\n</div>\n</body>\n</html>\n`;\n\nreturn {\n  email_html: emailHtml,\n  email_subject: `🤖 ${userData.user_name}, you could save $${totalSavings}/year with automation`,\n  user_email: userData.user_email,\n  user_name: userData.user_name,\n  total_savings: totalSavings,\n  payback_period: paybackPeriod,\n  roi_percentage: overallROI,\n  timestamp: userData.analysis_timestamp\n};"
        },
        "typeVersion": 2
      },
      {
        "id": "ec05cff9-2647-4e01-8ab6-ba2509dca1d2",
        "name": "Send Email Report",
        "type": "n8n-nodes-base.gmail",
        "position": [
          96,
          608
        ],
        "webhookId": "a7440b85-5dd7-42ee-8242-e1f0c67d7b52",
        "parameters": {
          "sendTo": "={{ $json.user_email }}",
          "message": "={{ $json.email_html }}",
          "options": {},
          "subject": "={{ $json.email_subject }}"
        },
        "typeVersion": 2.1
      },
      {
        "id": "527df560-8da9-414c-9b8f-9cb0f28e4a19",
        "name": "Workflow Overview",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2752,
          416
        ],
        "parameters": {
          "color": 6,
          "width": 380,
          "height": 560,
          "content": "## 📊 WORKFLOW OVERVIEW\n**AI Business Automation Opportunity Finder**\n\n⏱️ **Performance:**\n- Avg completion: 50-70 seconds\n- 4 AI agents in sequence\n- Cost per analysis: ~$0.20-0.30\n\n🎯 **Conversion Funnel:**\n- Free: Automation blueprint\n- Tier 1 ($497): Build top 3\n- Tier 2 ($1,997): Build all 10\n- Retainer ($2.5K-5K/mo): Ongoing\n\n💡 **Why This Works:**\n- Shows concrete $$$ savings\n- ROI-focused (CFOs love this)\n- Personalized to their business\n- Natural urgency (wasting money daily)\n\n📈 **Expected Conversion:**\n- 20-30% book strategy call\n- 40-50% of calls close\n- Average deal: $1,200\n- LTV with retainer: $15K+"
        },
        "typeVersion": 1
      },
      {
        "id": "e229b347-ff65-42ec-b0c6-1c965b317fea",
        "name": "Form Section",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2176,
          48
        ],
        "parameters": {
          "color": 7,
          "width": 380,
          "height": 516,
          "content": "## 📝 FORM INTAKE\n**Captures business details**\n\n✨ **Key Fields:**\n- Business description (open)\n- Industry\n- Team size (affects ROI calc)\n- Repetitive tasks (gold mine)\n- Current tools (integration points)\n- Bottleneck (pain point)\n- Revenue (optional, for ROI)\n\n🎯 **Why 9 Fields?**\n- Need detail for quality analysis\n- High-intent leads will fill it\n- Filters out tire-kickers\n- Sets expectations for value\n\n💡 **Pro Tip:**\n- Make revenue optional\n- Add \"Company Name\" field\n- Consider adding phone for high-ticket"
        },
        "typeVersion": 1
      },
      {
        "id": "06d34217-3c4d-4c10-94d0-e08265f0ce4e",
        "name": "Agent 1 Info",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1760,
          -80
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 580,
          "content": "## 🤖 AGENT 1: Business Analyst\n**Deep dive into business model**\n\n🎯 **Analyzes:**\n- Business model & operations\n- Key workflows\n- Pain points & inefficiencies\n- Tech stack assessment\n- Scalability challenges\n- Industry context\n\n⚙️ **Model Settings:**\n- Temperature: 0.4\n- Needs to understand nuance\n\n📊 **Output:**\n- Business overview (2-3 para)\n- 5 key insights\n- Core workflows identified\n- Critical pain points\n- Tech stack assessment\n- Scalability analysis\n- Industry-specific opportunities"
        },
        "typeVersion": 1
      },
      {
        "id": "53b4e9fc-7c3b-4226-9e72-e4747698a054",
        "name": "Agent 2 Info",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1376,
          -128
        ],
        "parameters": {
          "color": 7,
          "width": 372,
          "height": 612,
          "content": "## 🤖 AGENT 2: Process Mapper\n**Maps ALL workflows & bottlenecks**\n\n🗺️ **Creates:**\n- Comprehensive process map\n- Time waste analysis\n- Bottleneck identification\n- Quick win opportunities\n- Process dependencies\n\n⚙️ **Model Settings:**\n- Temperature: 0.5\n- Creative process thinking\n\n📋 **For Each Process:**\n- What triggers it\n- Manual steps (with time)\n- Frequency\n- Monthly time waste\n- Pain points\n- Automation potential\n\n💡 **Pro Insight:**\n- Thinks about processes they\n  didn't mention but must exist\n- Calculates total FTE cost"
        },
        "typeVersion": 1
      },
      {
        "id": "988bd6c6-f7af-4760-9c1d-8655d42bd97a",
        "name": "Agent 3 Info",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -960,
          -128
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 644,
          "content": "## 🤖 AGENT 3: Automation Architect\n**Designs specific solutions**\n\n🛠️ **Creates 15+ Automations:**\n- Clear description\n- Specific tools needed\n- Implementation complexity\n- Time savings\n- Step-by-step how it works\n- Prerequisites\n- Additional benefits\n- Example use case\n\n⚙️ **Model Settings:**\n- Temperature: 0.6\n- Creative solutions needed\n\n🎯 **Includes:**\n- Priority matrix (impact vs effort)\n- Tech stack recommendations\n- Integration architecture\n\n💡 **Uses Real Tools:**\n- n8n, Zapier, Make\n- Airtable, Notion\n- Native integrations\n- Custom APIs"
        },
        "typeVersion": 1
      },
      {
        "id": "ce0a9516-efb7-4f79-b56a-c2c8388fbca4",
        "name": "Agent 4 Info",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -560,
          -144
        ],
        "parameters": {
          "color": 7,
          "width": 340,
          "height": 660,
          "content": "## 🤖 AGENT 4: ROI Calculator\n**The money shot - proves value**\n\n💰 **Calculates:**\n- Time saved (weekly/yearly)\n- Labor cost saved\n- Implementation cost\n- Ongoing costs\n- Payback period\n- 12-month ROI\n- Intangible benefits\n\n⚙️ **Model Settings:**\n- Temperature: 0.3 (precision)\n- Financial calculations matter\n\n📊 **Delivers:**\n- Top 10 ranked by ROI\n- Cumulative impact analysis\n- 90-day roadmap\n- Resource allocation guide\n- Success metrics\n- Scaling projections\n\n🎯 **Magic:**\n- Shows conservative numbers\n- Builds trust with math\n- Makes decision easy"
        },
        "typeVersion": 1
      },
      {
        "id": "6ac306ac-c47e-4ab7-bffa-3a3caccf3cb6",
        "name": "Email Section",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          -128
        ],
        "parameters": {
          "color": 7,
          "width": 380,
          "height": 644,
          "content": "## 📧 EMAIL REPORT\n**Stunning, conversion-focused**\n\n🎨 **Features:**\n- Impact banner ($$ savings upfront)\n- Personal greeting by name\n- All 4 analyses included\n- Testimonial (social proof)\n- 3-tier pricing clearly shown\n- Multiple CTAs strategically placed\n- FAQ section (handles objections)\n- Beautiful responsive design\n\n💰 **Pricing Display:**\n- FREE: What they got\n- $497: Top 3 automations (featured)\n- $1,997: All 10 + 3mo support\n\n🎯 **Conversion Elements:**\n- Urgency (wasting money daily)\n- Social proof\n- Risk reversal\n- Clear next steps\n- Easy calendar booking\n\n📊 **Track in CRM:**\n- Lead source: automation finder\n- Estimated value: shown in report\n- Hot lead indicator: revenue disclosed"
        },
        "typeVersion": 1
      },
      {
        "id": "a104d84b-7e04-4937-9732-cb2f09189245",
        "name": "Sticky Note19",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2768,
          1024
        ],
        "parameters": {
          "color": 6,
          "width": 448,
          "height": 272,
          "content": "## 🚀 Built by Evervise\n\n**Automating the repetitive so you can focus on what matters**\n\n### Need Help?\n📧 **Support**: mark.marin@evervise.com\n🌐 **Website**: [evervise.ai](https://evervise.ai)  \n💬 **Response Time**: Usually within 24 hours\n**License**: Customize freely for your needs\n\n*Questions about customization? We've been there. Reach out.*"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Form Submission": {
        "main": [
          [
            {
              "node": "Initialize Variables",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Email Report": {
        "main": [
          [
            {
              "node": "Send Email Report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Initialize Variables": {
        "main": [
          [
            {
              "node": "Agent 1: Business Analyst",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Process Mapper Model": {
        "ai_languageModel": [
          [
            {
              "node": "Agent 2: Process Mapper",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "ROI Calculator Model": {
        "ai_languageModel": [
          [
            {
              "node": "Agent 4: ROI Calculator",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Business Analyst Model": {
        "ai_languageModel": [
          [
            {
              "node": "Agent 1: Business Analyst",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Agent 2: Process Mapper": {
        "main": [
          [
            {
              "node": "Agent 3: Automation Architect",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Agent 4: ROI Calculator": {
        "main": [
          [
            {
              "node": "Format Email Report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Agent 1: Business Analyst": {
        "main": [
          [
            {
              "node": "Agent 2: Process Mapper",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Automation Architect Model": {
        "ai_languageModel": [
          [
            {
              "node": "Agent 3: Automation Architect",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Agent 3: Automation Architect": {
        "main": [
          [
            {
              "node": "Agent 4: ROI Calculator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "STAFgThRSXspfU6H",
    "meta": {
      "instanceId": "7b35059aff065837b1c7d24142b37474554b08b3370f3096b2e57345690d178e",
      "templateCredsSetupCompleted": true
    },
    "name": "Team of AI Copywriters",
    "tags": [],
    "nodes": [
      {
        "id": "e3ca2747-0fb3-48e5-8155-28a64df90034",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -180,
          -20
        ],
        "webhookId": "347ec1c2-6bc0-4a0c-bde1-7c62d3900e55",
        "parameters": {
          "options": {}
        },
        "typeVersion": 1.1
      },
      {
        "id": "e1b1b753-3c5d-4114-80c6-bdec524b57ba",
        "name": "Copy Assistant",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          120,
          -20
        ],
        "parameters": {
          "options": {
            "systemMessage": "#Overview\nYou are a Copy Assistant Agent responsible for managing and routing user requests to the appropriate specialized copywriting agents based on input. You are the control coordinator for generating and delivering high‑quality platform‑ready marketing copy.\n\n## Context\nYou are connected to multiple specialized copywriting tools:\n\nSales Letter Agent\nCold Email Copywriter\n\nYou also interact with an OpenAI chat model and a memory system to retain conversational context\n\nOnce copy is generated, your role is to deliver it clearly and accurately to the user and update the connected Google Doc with the final version.\n\n## Instrcutions\nWhen a user request is received, determine its intent and route it to the correct agent:\nAd Copy Agent → punchy headlines, descriptions & CTAs for display/search/social ads\nVSL Script Agent → full‑length video sales letters with hook, problem/solution, proof, CTA\nAd Script Agent → short (15–60 sec) video ad scripts for TikTok, Instagram, YouTube\nSales Letter Agent → long‑form email or web sales letters with storytelling, proof, bullets\nCold Email Copywriter → concise, personalized outreach sequences (subjects, intros, value props, follow‑ups)\n\n## Tools\nAd Copy Agent: punchy headlines, descriptions & CTAs for social/display/search ads\nVSL Script Agent: longer video‑sales‑letter scripts with hook, problem/solution, proof, CTA\nAd Script Agent: short video ad scripts (15–60 sec) for TikTok, Instagram, YouTube\nSales Letter Agent: long‑form email or web sales letters with story, proof, bullets\nCold Email Copywriter: concise outreach sequences—subject lines, intros, value props, follow‑ups\n\n## Examples\n“Need a Facebook ad for our new fitness app.” → route to Ad Copy Agent\n“Write a 3‑minute VSL script pitching our automation tool.” → route to VSL Script Agent\n“30‑second TikTok spot for our gourmet coffee.” → route to Ad Script Agent\n“Long‑form sales letter for B2B software.” → route to Sales Letter Agent\n“5‑step cold email sequence to logistics managers.” → route to Cold Email Copywriter\n\n## SOPs\nInterpret intent: read the user’s brief, spot format and goal\nSelect agent: map to the tool that matches (ad, VSL, email, etc.)\nPrompt agent: pass along the brief plus brand voice or any notes\nReview output: check tone, formatting, brand compliance\nDeliver: send clean, formatted copy back to the user\nDocument: paste final approved copy into the shared Google Doc\n\n## Final Notes\nKeep things concise, conversational, user‑focused\nAlways ask if you need more brand details or style guidelines\nStay friendly and collaborative\nStore context so follow‑up tweaks are seamless"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "7da8a0e8-f23c-4404-b0a8-cfce31ffc83c",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -40,
          220
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "zAC1kwlWXRsFha0I",
            "name": "OpenAi account 2 Yar's secret openai"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e213359c-4eea-49b1-91a8-7d456396d601",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          80,
          340
        ],
        "parameters": {},
        "typeVersion": 1.3
      },
      {
        "id": "9c1af61f-a0bc-4f0d-9143-a051e1b34c78",
        "name": "Update a document",
        "type": "n8n-nodes-base.googleDocs",
        "position": [
          480,
          -20
        ],
        "parameters": {
          "actionsUi": {
            "actionFields": [
              {
                "text": "={{ $json.output }}",
                "action": "insert"
              }
            ]
          },
          "operation": "update",
          "documentURL": "https://docs.google.com/document/d/1eI4Pdje4As0KEYjEG3prMUQCiLe-tUswnwNUVQG2GSw/edit?tab=t.0"
        },
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "3NYxUhqJSWbKCb0s",
            "name": "Google Docs account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "43e28c30-cb70-4849-afbc-373b32b567f6",
        "name": "Cold Email Writer Tool",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          240,
          360
        ],
        "parameters": {
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "ZtScEU9B5PNPnIcP",
            "cachedResultName": "Cold Email Copywriter"
          },
          "description": "Call this tool when the user requests cold email sequences",
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "d5226fca-a257-49f2-b58b-fe61a58b9214",
        "name": "Sales Letter Tool",
        "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
        "position": [
          400,
          360
        ],
        "parameters": {
          "workflowId": {
            "__rl": true,
            "mode": "list",
            "value": "HQuj3iBV1PlI0HY1",
            "cachedResultName": "Sales Letter Agent"
          },
          "description": "Call this tool when user request for sales letters sequence",
          "workflowInputs": {
            "value": {},
            "schema": [],
            "mappingMode": "defineBelow",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          }
        },
        "typeVersion": 2.2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "9c9ce4d3-2f74-4597-9279-80344132094c",
    "connections": {
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Copy Assistant",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Copy Assistant": {
        "main": [
          [
            {
              "node": "Update a document",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Copy Assistant",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Sales Letter Tool": {
        "ai_tool": [
          [
            {
              "node": "Copy Assistant",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Cold Email Writer Tool": {
        "ai_tool": [
          [
            {
              "node": "Copy Assistant",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "Copy Assistant",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "acb072d2aad100feb062a5b9581f769c76b168e8093b2a69c42378835971bcbd",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "453c01a0-07fe-4600-bd60-aee0a280a5ec",
        "name": "Manual Trigger",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          192,
          192
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "ee2275f1-e698-4b18-b10c-50b6fe7535b9",
        "name": "Read Business Data",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          416,
          192
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1789639419,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1JIupfRSPFV1PW1Dp4Q1jmdcnmOALlgQjr6MBrmuiPzs/edit#gid=1789639419",
            "cachedResultName": "Sheet (All info)"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1JIupfRSPFV1PW1Dp4Q1jmdcnmOALlgQjr6MBrmuiPzs",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1JIupfRSPFV1PW1Dp4Q1jmdcnmOALlgQjr6MBrmuiPzs/edit?usp=drivesdk",
            "cachedResultName": "ColdEmail"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "sGUrRhs47xEF10mA",
            "name": "Google Sheets account Ayis"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "c5473567-81d4-48b4-8583-990606c1c245",
        "name": "Filter Unsent Emails",
        "type": "n8n-nodes-base.if",
        "position": [
          640,
          192
        ],
        "parameters": {
          "conditions": {
            "string": [
              {
                "value1": "={{$json[\"email_sent\"]}}",
                "value2": "yes",
                "operation": "notEqual"
              },
              {
                "value1": "={{$json[\"email\"]}}",
                "operation": "isNotEmpty"
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "7a91c4fc-cc55-4553-af95-03a07955f541",
        "name": "Prepare Sheet Update",
        "type": "n8n-nodes-base.set",
        "position": [
          1760,
          192
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "e7b61a8c-4733-41bc-a130-809ecd8b3779",
        "name": "Update Google Sheet",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          1984,
          96
        ],
        "parameters": {
          "columns": {
            "value": {
              "city": "={{ $('Prepare Email Draft').item.json.city }}",
              "email": "={{ $('Prepare Email Draft').item.json.email }}",
              "date_sent": "={{$now.format(\"dd/MM/yyyy\")}}",
              "email_sent": "={{ $('Prepare Email Draft').item.json.email_body }}",
              "row_number": 0,
              "contact_name": "={{ $('Prepare Email Draft').item.json.contact_name }}",
              "subject_used": "={{ $('Merge Subject and Body').item.json.choices[0].message.content }}",
              "business_name": "={{ $('Prepare Email Draft').item.json.business_name }}",
              "business_type": "={{ $('Prepare Email Draft').item.json.business_type }}"
            },
            "schema": [
              {
                "id": "business_name",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "business_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "email",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "contact_name",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "contact_name",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "city",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "city",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "business_type",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "business_type",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "email_sent",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "email_sent",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "date_sent",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "date_sent",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "subject_used",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "subject_used",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "number",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "business_name"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "update",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": 1789639419,
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1JIupfRSPFV1PW1Dp4Q1jmdcnmOALlgQjr6MBrmuiPzs/edit#gid=1789639419",
            "cachedResultName": "Sheet (All info)"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1JIupfRSPFV1PW1Dp4Q1jmdcnmOALlgQjr6MBrmuiPzs",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1JIupfRSPFV1PW1Dp4Q1jmdcnmOALlgQjr6MBrmuiPzs/edit?usp=drivesdk",
            "cachedResultName": "ColdEmail"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "sGUrRhs47xEF10mA",
            "name": "Google Sheets account Ayis"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "aed9100b-9cce-422c-8ed9-077e9717180a",
        "name": "Rate Limit Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          1984,
          288
        ],
        "webhookId": "184ca919-0240-4497-9cac-235784f0040a",
        "parameters": {
          "unit": "seconds",
          "amount": 3
        },
        "typeVersion": 1
      },
      {
        "id": "4f545b68-2162-4491-8127-6f1baa66166e",
        "name": "Personalize Email (ChatGPT)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          864,
          96
        ],
        "parameters": {
          "url": "=https://api.openai.com/v1/chat/completions",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"model\": \"gpt-4o-mini\",\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"You are writing a simple, direct cold email as an AI automation service provider providing your services to businesses. Your services fall under the following categories: Lead generation systems (Cold Email, Speed to Lead, Ad + User Generated Content automation, Lead scraping, Go-to-market automation, AI-content generation), Sales systems (CRM automations, Proposal generators, Lead qualifying systems, Asset generators) and conversion-optimization systems (Personalized follow-up & nurture, Automatic lead scoring). You choose which ones to recommend to the business owners based on the prompt below. Keep it under 100 words, professional but conversational.\\n\\nBusiness Details:\\n- Name: {{$json[\"business_name\"]}}\\n- Contact: {{$json[\"contact_name\"]}}\\n- City: {{$json[\"city\"]}}\\n- Type: {{$json[\"business_type\"]}}\\n\\nWrite a personalized version of this template:\\n\\n'Hi [Contact],\\n\\nI help [business type plural] in [city] automate their repetitive tasks using AI, saving them 10+ hours weekly.\\n\\nFor your company, this could mean:\\n• Reduced time spent on repetitive tasks, freeing up your team for higher-value work\\n• Increased operational efficiency and productivity across your processes\\n• Improved revenue potential through smarter, faster decision-making\\n\\nSo, what do you think?\\n\\nWorth a quick 15-minute chat to see if this could work for you?\\n\\nBest,\\nAyis\\n+306947839876nMake the benefits specific and compelling. Keep the tone confident but not pushy. Output only the email body, no explanations.\"\n    }\n  ],\n  \"temperature\": 0.7,\n  \"max_tokens\": 400,\n  \"top_p\": 0.9\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "nodeCredentialType": "openAiApi"
        },
        "credentials": {
          "openAiApi": {
            "id": "VUlvmr8K5Ln3X8OC",
            "name": "OpenAi account"
          },
          "googlePalmApi": {
            "id": "IvzzgGbY09KS2pFD",
            "name": "Google Gemini(PaLM) Api account ONE"
          }
        },
        "typeVersion": 4.1
      },
      {
        "id": "959f7d3f-d91a-4c6e-8ae1-4f0a8ac03d14",
        "name": "Generate Subject (ChatGPT)",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          864,
          288
        ],
        "parameters": {
          "url": "=https://api.openai.com/v1/chat/completions",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"model\": \"gpt-4o-mini\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are an assistant that generates compelling subject lines for cold outreach emails.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"Generate a compelling email subject line for a AI automation service provider cold outreaching to other businesses through email.\\n\\nBusiness: {{$json[\"business_name\"]}}\\nType: {{$json[\"business_type\"]}}\\nCity: {{$json[\"city\"]}}\\n\\nCreate 1 subject line that:\\n- Is specific to their business\\n- Creates curiosity\\n- Is under 50 characters\\n- Doesn't use spam words like 'free' or excessive punctuation\\n\\nExamples of good subject lines:\\n- 'Quick question about [Business Name]'s workflow'\\n- '15 min to save [Business Name] 10 hours/week?'\\n- 'How [competitor/other business type] cut admin time 40%'\\n- '[Business Name] - automating [specific task]'\\n\\nOutput only the subject line, nothing else.\"\n    }\n  ],\n  \"temperature\": 0.6,\n  \"max_tokens\": 50,\n  \"top_p\": 0.9\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "nodeCredentialType": "openAiApi"
        },
        "credentials": {
          "openAiApi": {
            "id": "VUlvmr8K5Ln3X8OC",
            "name": "OpenAi account"
          },
          "googlePalmApi": {
            "id": "IvzzgGbY09KS2pFD",
            "name": "Google Gemini(PaLM) Api account ONE"
          }
        },
        "typeVersion": 4.1
      },
      {
        "id": "5d8e3519-744f-4b61-8681-e87c746b4e20",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -512,
          -656
        ],
        "parameters": {
          "width": 672,
          "height": 944,
          "content": "## How It Works\n1. Starts with a Manual Trigger\n\n2. Reads lead list from Google Sheet\n\n3. Filter rows where email wasn’t sent\n\n4. Generate personalized email body (AI)\n\n5. Generate email subject line (AI)\n\n6. Merge AI outputs with original row data\n\n7. Create Gmail draft\n\n8. Update Google Sheet with email content and date\n\n9. Wait 3 seconds between updates to avoid API limits\n\n## Setup Steps\n- Connect Google Sheets, Gmail, and OpenAI credentials\n- Check sheet column names (business_name, email, contact_name, city, business_type, email_sent)\n- Run Manual Trigger to test one row\n- Adjust AI prompts if needed\n\n## Customization\n- Add unique ID column to match rows if needed\n- Change AI prompts to adjust email style\n- Increase wait time to avoid rate limits\n\n## Use Cases\n- Draft cold emails for review before sending\n- Automate lead outreach while keeping human oversight\n- Generate personalized emails and subject lines quickly\n\n## Troubleshooting Tips\n- Draft not created → check Gmail credentials and scopes\n- Sheet not updating → check matching column exists\n- AI outputs empty → increase tokens or check response path"
        },
        "typeVersion": 1
      },
      {
        "id": "78c99319-eb37-4add-b2a8-abe70aa47d49",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          192,
          -16
        ],
        "parameters": {
          "color": 7,
          "width": 560,
          "height": 368,
          "content": "## Phase 1:\nManually trigger the worklfow, read business data from a google sheet and filter the emails which have not already been sent\n# ->"
        },
        "typeVersion": 1
      },
      {
        "id": "925dfa2b-ff58-45ac-ac2a-d35b0b454828",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          768,
          -48
        ],
        "parameters": {
          "color": 7,
          "width": 496,
          "height": 512,
          "content": "## Phase 2:\nCreate email subject and body using an http request to OpenAI's ChatGPT 4o-mini\n# ->"
        },
        "typeVersion": 1
      },
      {
        "id": "ac4ced8a-b8b6-4403-8ab6-e7cdaa727846",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1280,
          -48
        ],
        "parameters": {
          "color": 7,
          "width": 400,
          "height": 400,
          "content": "## Phase 3\nPrepare fields and create the draft email\n# ->"
        },
        "typeVersion": 1
      },
      {
        "id": "2d821218-7e6e-46f5-8376-af267ec0dd14",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1696,
          -32
        ],
        "parameters": {
          "color": 7,
          "width": 448,
          "height": 480,
          "content": "## Phase 4\nPrepare the fields (Set) and update google sheet.\n(Wait node is for API usage limit management)"
        },
        "typeVersion": 1
      },
      {
        "id": "b0fa3264-5cdd-45c8-8ca7-0c79a04ace73",
        "name": "Prepare Email Draft",
        "type": "n8n-nodes-base.set",
        "position": [
          1312,
          192
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "7bbcbe0c-4fa4-4d95-9d4a-ebb02d9a6a76",
                "name": "email_subject",
                "type": "string",
                "value": "={{ $('Generate Subject (ChatGPT)').item.json.choices[0].message.content }}"
              },
              {
                "id": "8d602dfc-3dbb-4e3d-9974-ac68f5ac12e8",
                "name": "=email_body",
                "type": "string",
                "value": "={{ $('Personalize Email (ChatGPT)').item.json.choices[0].message.content }}"
              },
              {
                "id": "91da7a5c-2bb1-43ba-98e0-c652518800ea",
                "name": "business_name",
                "type": "string",
                "value": "={{ $('Filter Unsent Emails').item.json.business_name }}"
              },
              {
                "id": "a622f1fc-e2c1-49a6-b8c4-012eedf8c468",
                "name": "email",
                "type": "string",
                "value": "={{ $('Filter Unsent Emails').item.json.email }}"
              },
              {
                "id": "ddea1bce-4f41-462f-a602-a923561e3030",
                "name": "contact_name",
                "type": "string",
                "value": "={{ $('Filter Unsent Emails').item.json.contact_name }}"
              },
              {
                "id": "3cfaaecf-4139-4be8-b404-90bb68ca3f9d",
                "name": "city",
                "type": "string",
                "value": "={{ $('Filter Unsent Emails').item.json.city }}"
              },
              {
                "id": "c6dac679-380c-4a0f-85fc-f6510cfb6abb",
                "name": "business_type",
                "type": "string",
                "value": "={{ $('Filter Unsent Emails').item.json.business_type }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "fc1a66a3-555d-4711-8b37-e75422b3c5d2",
        "name": "Create Email Draft",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1536,
          192
        ],
        "webhookId": "6d6a0217-ec9e-4d33-b0fb-d7ffb4f06447",
        "parameters": {
          "message": "={{$json[\"email_body\"].replace(/\\n/g, '<br>')}}",
          "options": {},
          "subject": "={{ $('Generate Subject (ChatGPT)').item.json.choices[0].message.content }}",
          "resource": "draft",
          "emailType": "html"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "hM6MsDtK5YjsPvGr",
            "name": "Gmail account Ayis"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "e19bd5b5-7c68-4b1d-9026-36ff868af095",
        "name": "Merge Subject and Body",
        "type": "n8n-nodes-base.merge",
        "position": [
          1088,
          192
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combineBy": "combineByPosition"
        },
        "typeVersion": 3.2
      }
    ],
    "pinData": {},
    "connections": {
      "Manual Trigger": {
        "main": [
          [
            {
              "node": "Read Business Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Email Draft": {
        "main": [
          [
            {
              "node": "Prepare Sheet Update",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read Business Data": {
        "main": [
          [
            {
              "node": "Filter Unsent Emails",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Email Draft": {
        "main": [
          [
            {
              "node": "Create Email Draft",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter Unsent Emails": {
        "main": [
          [
            {
              "node": "Personalize Email (ChatGPT)",
              "type": "main",
              "index": 0
            },
            {
              "node": "Generate Subject (ChatGPT)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare Sheet Update": {
        "main": [
          [
            {
              "node": "Update Google Sheet",
              "type": "main",
              "index": 0
            },
            {
              "node": "Rate Limit Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge Subject and Body": {
        "main": [
          [
            {
              "node": "Prepare Email Draft",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Subject (ChatGPT)": {
        "main": [
          [
            {
              "node": "Merge Subject and Body",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Personalize Email (ChatGPT)": {
        "main": [
          [
            {
              "node": "Merge Subject and Body",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "ZLvtiRLuKIdbuPvG",
    "meta": {
      "instanceId": "6e368239a754583504a2403e06d0c843c0e58b8e2e4abcac6abe41145926def9",
      "templateCredsSetupCompleted": true
    },
    "name": "SEO Strategy Director",
    "tags": [],
    "nodes": [
      {
        "id": "21f0d07d-8c8b-4145-98c2-67a25ce3909d",
        "name": "When chat message received",
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "position": [
          -160,
          -928
        ],
        "webhookId": "696a9839-f036-40e8-877f-bfe013aaf93a",
        "parameters": {
          "public": true,
          "options": {
            "title": "Welcome to SEO Strategy Agent",
            "subtitle": "Your AI SEO team is on the case. A full strategy report may take up to 90 seconds.",
            "responseMode": "responseNodes"
          },
          "initialMessages": "Hello There!"
        },
        "typeVersion": 1.3
      },
      {
        "id": "a1adf74d-5ee6-420b-a29c-44164e573265",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -112,
          -704
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "Tgoej50tSwr6ScFt",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "96c11554-e7dd-4cb4-8ec7-794747796043",
        "name": "Keyword Research Specialist",
        "type": "@n8n/n8n-nodes-langchain.agentTool",
        "position": [
          -624,
          -400
        ],
        "parameters": {
          "text": "=={{ $json.chatInput }}",
          "options": {
            "systemMessage": "You are a Keyword Research Specialist with deep expertise in SEO keyword strategy.\n\nYour core responsibilities:\n- Conduct comprehensive keyword research\n- Analyze search intent (informational, navigational, commercial, transactional)\n- Perform competitor keyword gap analysis\n- Create keyword clusters and content groups\n- Estimate search volumes and keyword difficulty\n- Identify long-tail keyword opportunities\n\nWhen analyzing a request:\n1. Identify primary target keywords (high volume, high intent)\n2. Suggest secondary keywords and variations\n3. Categorize keywords by search intent\n4. Provide estimated difficulty scores (Easy/Medium/Hard)\n5. Recommend keyword implementation strategy\n6. Suggest content topics based on keyword clusters\n\nAlways structure your response with:\n- Primary Keywords (3-5)\n- Secondary Keywords (10-15)\n- Long-tail Opportunities (5-10)\n- Search Intent Breakdown\n- Implementation Priority\n\nBe specific, data-driven, and actionable in your recommendations."
          },
          "toolDescription": "Specialist agent focused on keyword research, search intent analysis, competitor keyword analysis, and keyword clustering for SEO campaigns."
        },
        "typeVersion": 2.2
      },
      {
        "id": "d50187fb-5ec5-46d0-9e6a-dcfa611f8031",
        "name": "Technical SEO Specialist",
        "type": "@n8n/n8n-nodes-langchain.agentTool",
        "position": [
          -336,
          -400
        ],
        "parameters": {
          "text": "=={{ $json.chatInput }}",
          "options": {
            "systemMessage": "You are a Technical SEO Specialist with expertise in website optimization and technical infrastructure.\n\nYour core responsibilities:\n- Conduct technical SEO audits\n- Optimize site speed and Core Web Vitals\n- Implement schema markup and structured data\n- Fix crawling and indexing issues\n- Optimize site architecture and internal linking\n- Ensure mobile-friendliness and responsive design\n- Handle robots.txt, XML sitemaps, and canonical tags\n\nWhen analyzing a request:\n1. Identify critical technical issues\n2. Prioritize fixes by impact (High/Medium/Low)\n3. Provide specific implementation steps\n4. Recommend tools for monitoring\n5. Suggest performance benchmarks\n6. Consider technical scalability\n\nStructure your response with:\n- Critical Issues (immediate fixes needed)\n- Site Speed Recommendations\n- Schema Markup Opportunities\n- Crawlability Improvements\n- Mobile Optimization Steps\n- Monitoring & Maintenance Plan\n\nProvide technical but understandable recommendations with clear implementation guidance."
          },
          "toolDescription": "Specialist agent focused on technical SEO audits, site speed optimization, schema markup, crawlability, and technical infrastructure."
        },
        "typeVersion": 2.2
      },
      {
        "id": "71e8592a-f846-4d77-aa9d-091ca9cf12a3",
        "name": "Link Building Strategist",
        "type": "@n8n/n8n-nodes-langchain.agentTool",
        "position": [
          -48,
          -400
        ],
        "parameters": {
          "text": "=={{ $json.chatInput }}",
          "options": {
            "systemMessage": "You are a Link Building Strategist with expertise in earning high-quality backlinks and building domain authority.\n\nYour core responsibilities:\n- Develop comprehensive link building strategies\n- Create outreach campaign plans\n- Identify link-worthy content opportunities\n- Analyze competitor backlink profiles\n- Recommend guest posting and PR opportunities\n- Build relationships with relevant websites and influencers\n\nWhen analyzing a request:\n1. Identify target link sources (blogs, news sites, directories, industry sites)\n2. Create tiered link building approach (Tier 1, 2, 3)\n3. Develop outreach messaging templates\n4. Suggest linkable asset creation (infographics, tools, research)\n5. Recommend link monitoring and reporting\n6. Provide realistic timeline and effort estimates\n\nStructure your response with:\n- Target Link Sources (20-30 prospects)\n- Outreach Strategy & Templates\n- Linkable Asset Recommendations\n- Guest Posting Opportunities\n- PR & Digital PR Tactics\n- Monthly Link Building Goals\n- Success Metrics\n\nFocus on white-hat, sustainable link building practices that build long-term authority."
          },
          "toolDescription": "Specialist agent focused on backlink strategy, outreach campaigns, link acquisition tactics, and authority building."
        },
        "typeVersion": 2.2
      },
      {
        "id": "af888ada-f8a1-4661-b3bd-a34ca5beee83",
        "name": "SEO Analytics Specialist",
        "type": "@n8n/n8n-nodes-langchain.agentTool",
        "position": [
          240,
          -400
        ],
        "parameters": {
          "text": "=={{ $json.chatInput }}",
          "options": {
            "systemMessage": "You are an SEO Analytics Specialist with expertise in tracking, measuring, and reporting SEO performance.\n\nYour core responsibilities:\n- Set up comprehensive SEO tracking systems\n- Define and monitor key performance indicators (KPIs)\n- Analyze Google Analytics and Search Console data\n- Track keyword rankings and visibility\n- Create custom dashboards and reports\n- Provide data-driven optimization recommendations\n\nWhen analyzing a request:\n1. Define relevant SEO KPIs and success metrics\n2. Recommend analytics tools and setup\n3. Create measurement framework\n4. Design reporting structure and frequency\n5. Identify data connections and integrations\n6. Suggest A/B testing opportunities\n\nStructure your response with:\n- Core SEO KPIs to Track\n- Analytics Setup Recommendations (GA4, GSC, etc.)\n- Dashboard Requirements\n- Reporting Schedule (weekly/monthly)\n- Tracking Implementation Steps\n- Conversion Tracking Setup\n- Alert & Monitoring Rules\n\nProvide actionable insights that connect SEO efforts to business outcomes."
          },
          "toolDescription": "Specialist agent focused on SEO performance tracking, analytics setup, KPI monitoring, and data-driven insights."
        },
        "typeVersion": 2.2
      },
      {
        "id": "921e7ed6-7b8d-4c6e-b135-90f9931dcee3",
        "name": "Local SEO Specialist",
        "type": "@n8n/n8n-nodes-langchain.agentTool",
        "position": [
          528,
          -400
        ],
        "parameters": {
          "text": "=={{ $json.chatInput }}",
          "options": {
            "systemMessage": "You are a Local SEO Specialist with expertise in optimizing businesses for local search and Google Maps visibility.\n\nYour core responsibilities:\n- Optimize Google Business Profile (GBP)\n- Build and manage local citations (NAP consistency)\n- Implement local schema markup\n- Create geo-targeted content strategies\n- Manage online reviews and reputation\n- Optimize for \"near me\" and local intent searches\n\nWhen analyzing a request:\n1. Assess local search opportunity and competition\n2. Provide GBP optimization checklist\n3. Identify citation building opportunities\n4. Suggest local content topics\n5. Create review generation strategy\n6. Recommend local link building tactics\n\nStructure your response with:\n- Google Business Profile Optimization Steps\n- Local Citation Building Plan (30-50 sources)\n- Local Schema Implementation\n- Geo-Targeted Content Strategy\n- Review Management Approach\n- Local Link Building Opportunities\n- Local Pack Ranking Factors\n\nFocus on strategies that improve local visibility and drive foot traffic or local conversions."
          },
          "toolDescription": "Specialist agent focused on local search optimization, Google Business Profile, local citations, and geo-targeted strategies."
        },
        "typeVersion": 2.2
      },
      {
        "id": "2730b272-fa27-4c8a-8eeb-70fa04445569",
        "name": "SEO Content Writer",
        "type": "@n8n/n8n-nodes-langchain.agentTool",
        "position": [
          816,
          -400
        ],
        "parameters": {
          "text": "=={{ $json.chatInput }}",
          "options": {
            "systemMessage": "You are an SEO Content Writer with expertise in creating search-optimized, high-quality content that ranks and converts.\n\nYour core responsibilities:\n- Create detailed content briefs\n- Write SEO-optimized blog posts and landing pages\n- Develop content calendars and topic clusters\n- Optimize existing content for better rankings\n- Implement on-page SEO best practices\n- Balance SEO requirements with user experience\n\nWhen analyzing a request:\n1. Develop content topic ideas based on keywords\n2. Create detailed content briefs (structure, headings, word count)\n3. Suggest content formats (how-to, listicle, guide, etc.)\n4. Provide on-page optimization checklist\n5. Recommend internal linking strategy\n6. Create content publishing schedule\n\nStructure your response with:\n- Content Topic Recommendations (10-15 topics)\n- Detailed Content Briefs (3-5 priority pieces)\n- Editorial Calendar (3-6 months)\n- On-Page Optimization Guidelines\n- Content Cluster Strategy\n- Meta Title & Description Templates\n- Internal Linking Recommendations\n\nCreate content strategies that serve both search engines and human readers, focusing on quality and relevance."
          },
          "toolDescription": "Specialist agent focused on creating SEO-optimized content, content briefs, editorial calendars, and on-page optimization."
        },
        "typeVersion": 2.2
      },
      {
        "id": "1aba9b92-2755-4126-8ac2-807dd2ea799f",
        "name": "OpenAI Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -544,
          -96
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "temperature": 0.7
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "Tgoej50tSwr6ScFt",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a462c0e1-f500-4f0b-8897-14e59248da51",
        "name": "OpenAI Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -272,
          -80
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "temperature": 0.7
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "Tgoej50tSwr6ScFt",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "5ee429d2-b167-4ca8-ad7e-30f7cf10365b",
        "name": "OpenAI Chat Model3",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          528,
          -80
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "temperature": 0.7
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "Tgoej50tSwr6ScFt",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "9c72e813-69cb-4b04-8667-b01fe1c55210",
        "name": "OpenAI Chat Model4",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          -16,
          -80
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "temperature": 0.7
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "Tgoej50tSwr6ScFt",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "d377a7be-78b6-46a0-af8c-7a5eaecc8bec",
        "name": "OpenAI Chat Model5",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          272,
          -80
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "temperature": 0.7
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "Tgoej50tSwr6ScFt",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "a700edfa-6aae-42db-8873-5eabaafef08a",
        "name": "OpenAI Chat Model6",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          816,
          -80
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "temperature": 0.7
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "Tgoej50tSwr6ScFt",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "94f79720-4451-4cdc-9298-7f8fbab3e31d",
        "name": "SEO Director Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          128,
          -752
        ],
        "parameters": {
          "text": "=={{ $json.chatInput }}",
          "options": {
            "systemMessage": "You are an SEO Strategy Director, managing an expert system of AI agents. Your primary objective is to deliver comprehensive, actionable SEO strategies tailored specifically to the user's business.\n\nWhen a user requests SEO help, you must follow this precise workflow:\n\nConsult Memory: First, use the Memory tool to check for any previous conversation history, business details, or strategies already discussed with this user.\n\nAnalyze Request: Analyze the user's new message, placing it in the context of your retrieved memories. Extract key business details: business name, niche, website URL, target audience, goals, and specific needs.\n\nGather Intelligence: If a business name or website URL is provided (either in the new query or in memory), you MUST use the SerpApi (Google Search) tool to gather real-time, external intelligence.\n\nExample searches: \"What is [User's Business Name]?\", \"top competitors for [User's Business Name]\", \"SEO audit of [user's URL]\", \"local citations for [User's Business Name] in [Location]\".\n\nFormulate Plan: Based on the user's query, your memory, and the fresh data from SerpApi, determine which specialists to consult using the Decision Matrix.\n\nDelegate to Specialists: Call the required specialist tools. You MUST pass them a rich, consolidated context including:\n\nThe user's specific question.\n\nKey business details (from memory and the query).\n\nYour key findings from the SerpApi search (e.g., \"SerpApi shows your top 3 competitors are X, Y, and Z\").\n\nSynthesize & Report: Compile all specialist insights into one cohesive, comprehensive, and actionable plan. Follow the Response Structure exactly.\n\nAvailable Tools\nYou have two types of tools available:\n\n1. Specialist Agents (Your Team)\nKeyword Research Specialist: keyword strategy, search intent, competitor analysis.\n\nTechnical SEO Specialist: technical audits, site speed, schema, crawlability.\n\nLink Building Strategist: backlink strategy, outreach, PR campaigns.\n\nSEO Analytics Specialist: tracking, KPIs, analytics setup, reporting.\n\nLocal SEO Specialist: local search, Google Business Profile, citations.\n\nSEO Content Writer: content strategy, briefs, editorial calendars.\n\n2. Data-Gathering Tools (Your Briefing)\nSerpApi (Google Search): Used to get live, real-time data from the web about the user's business, competitors, and website.\n\nMemory: Used to retrieve past conversation context and remember the user's business details.\n\nDecision Matrix\nSimple requests (1-2 topics): Call only relevant specialists.\n\nExample: \"Help with keywords\" → Call Keyword Research only.\n\nMedium requests (specific area): Call 2-4 related specialists.\n\nExample: \"Fix my slow site\" → Call Technical SEO + Analytics (and use SerpApi to run a basic speed test).\n\nComprehensive requests (full strategy): Call ALL 6 specialists.\n\nExample: \"Create full SEO strategy for my business\" → Call all specialists, Memory, and SerpApi.\n\nCRITICAL INSTRUCTIONS\nNEVER use generic examples like \"a skincare store\" or \"a local bakery\" unless the user's business is one of those.\n\nAlways base ALL recommendations on the user's ACTUAL business.\n\nUse your tools: You MUST use Memory every time. You MUST use SerpApi if a business name or URL is available.\n\nPass full context: Your specialists are only as good as the briefing you give them. Pass all relevant data (query, memory, SerpApi findings) to them.\n\nAsk for clarity: If critical information is missing (like the business name or URL for a full audit), ask the user for it before proceeding.\n\nResponse Structure\n# SEO STRATEGY REPORT FOR [USER'S ACTUAL BUSINESS NAME]\n\n(Sourced from: [User's Query, Memory, and SerpApi live search])\n\nExecutive Summary\n[2-3 sentences overview specific to their business, informed by your tool-based analysis]\n\nStrategy Components\nKeyword Strategy\n[Recommendations from Keyword specialist - specific to their niche, referencing competitors found via SerpApi]\n\nTechnical Foundation\n[Recommendations from Technical specialist - for their actual site, informed by SerpApi findings]\n\nAuthority Building\n[Link building strategy - for their specific industry]\n\nPerformance Tracking\n[Analytics setup - tailored to their goals]\n\n[Include other relevant specialist sections]\nPriority Action Plan\n[Most critical action for THEIR business]\n\n[Second priority for THEIR needs]\n\n[Third priority]\n\nTimeline & Next Steps\n[Realistic timeline and clear next actions]"
          },
          "promptType": "define"
        },
        "typeVersion": 2.2
      },
      {
        "id": "71e2afac-47f6-4efa-94f3-f6d1c5bf35f4",
        "name": "Think",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          544,
          -688
        ],
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "a0b836ac-e174-4418-8e6f-55e0c8769d12",
        "name": "Respond to Chat",
        "type": "@n8n/n8n-nodes-langchain.chat",
        "position": [
          880,
          -880
        ],
        "parameters": {
          "message": "={{ $json.output }}",
          "options": {},
          "waitUserReply": false
        },
        "typeVersion": 1
      },
      {
        "id": "4b0f1128-7669-4b2f-a061-940fdefb5121",
        "name": "Simple Memory",
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "position": [
          304,
          -928
        ],
        "parameters": {
          "contextWindowLength": 25
        },
        "typeVersion": 1.3
      },
      {
        "id": "6adbc9ae-2608-49e4-ace8-1fc2b2e012a3",
        "name": "SerpAPI",
        "type": "@n8n/n8n-nodes-langchain.toolSerpApi",
        "position": [
          528,
          -928
        ],
        "parameters": {
          "options": {}
        },
        "credentials": {
          "serpApi": {
            "id": "LORKYkxJZRuOAgOx",
            "name": "SerpAPI account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "946f5101-cd0c-486e-acf8-6a4435a5dc23",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1184,
          -1296
        ],
        "parameters": {
          "width": 544,
          "height": 448,
          "content": "## How it works\nThis workflow acts as an autonomous \"AI SEO Agency.\" It is managed by a **Director Agent** (top center) that coordinates a team of 6 specialists.\n\n1. **Analysis:** When you chat, the Director checks **Memory** and runs live market research using **SerpApi (Google Search)**.\n2. **Delegation:** Based on real-time data, the Director assigns tasks to the 6 **Specialist Agents** below (Keyword, Technical, Link Building, Analytics, Local, and Content).\n3. **Reporting:** The Director compiles their work into a single, professional strategy report.\n\n## Setup steps\n1. **OpenAI Keys:** Add your OpenAI API key to **all 7** \"OpenAI Chat Model\" nodes (1 for the Director, 6 for the Specialists).\n2. **SerpApi Key:** Click the \"SEO Director Agent\" node. Under \"Tools\" > \"SerpApi,\" add your key to enable live Google Search.\n3. **Run:** Click \"Active\" and start chatting."
        },
        "typeVersion": 1
      },
      {
        "id": "b97ed49c-ee14-4aae-874b-b8920759cd98",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -208,
          -1088
        ],
        "parameters": {
          "color": 7,
          "width": 864,
          "height": 528,
          "content": "## The Manager Core\nThe **SEO Director Agent** is the brain. It receives your prompt, pulls context from **Memory**, and gathers live data via **SerpAPI** before deciding which specialists to hire for the job."
        },
        "typeVersion": 1
      },
      {
        "id": "c5ec5db3-9ea6-4d0a-9188-0fbf10b4cce4",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -784,
          -544
        ],
        "parameters": {
          "color": 7,
          "width": 1952,
          "height": 592,
          "content": "## The Specialist Team\nThese 6 nodes are configured as **Tools**. They don't run automatically; the Director calls them individually to perform specific tasks (like running a technical audit or researching keywords).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Specialist LLMs\nThese models power the individual specialist agents. You need to add your OpenAI credential to each of these nodes (you can use the same key for all of them)."
        },
        "typeVersion": 1
      }
    ],
    "active": true,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "612af4bd-968d-4c20-a969-66ebbfa699fb",
    "connections": {
      "Think": {
        "ai_tool": [
          [
            {
              "node": "SEO Director Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "SerpAPI": {
        "ai_tool": [
          [
            {
              "node": "SEO Director Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "SEO Director Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "SEO Director Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Keyword Research Specialist",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Technical SEO Specialist",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "Local SEO Specialist",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model4": {
        "ai_languageModel": [
          [
            {
              "node": "Link Building Strategist",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "SEO Analytics Specialist",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model6": {
        "ai_languageModel": [
          [
            {
              "node": "SEO Content Writer",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "SEO Content Writer": {
        "ai_tool": [
          [
            {
              "node": "SEO Director Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "SEO Director Agent": {
        "main": [
          [
            {
              "node": "Respond to Chat",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Local SEO Specialist": {
        "ai_tool": [
          [
            {
              "node": "SEO Director Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Link Building Strategist": {
        "ai_tool": [
          [
            {
              "node": "SEO Director Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "SEO Analytics Specialist": {
        "ai_tool": [
          [
            {
              "node": "SEO Director Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Technical SEO Specialist": {
        "ai_tool": [
          [
            {
              "node": "SEO Director Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "SEO Director Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Keyword Research Specialist": {
        "ai_tool": [
          [
            {
              "node": "SEO Director Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "Ud48ms2k7e8jttpp",
    "meta": {
      "instanceId": "7d3727b19183ed2ab8356c97f7b13d363d72dc0303b7e113b24052248c92d453",
      "templateCredsSetupCompleted": true
    },
    "name": "simple_deepresearch_for_Japanese_users_for_publish",
    "tags": [],
    "nodes": [
      {
        "id": "bdf85255-f3d9-4973-90a7-88728b1d0aec",
        "name": "When clicking ‘Execute workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          120,
          0
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "81ece876-1fb4-44d0-b739-6c2885faf6f4",
        "name": "Query Generator",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          700,
          0
        ],
        "parameters": {
          "text": "=質問に対して有力なクエリを3つ作成してください。",
          "options": {
            "systemMessage": "=あなたはユーザーの質問から最適な検索クエリを抽出する専門家です。\n\nユーザーの質問：{{ $json.query }}\n\n## あなたの仕事：\nユーザーの質問を分析し、最も効果的な検索キーワードを3つ作成してください。\n\n## 重要な指示：\n- **検索クエリのみを出力**してください（説明や前置きは一切不要）\n- 英語の検索クエリが効果的な場合は英語で出力\n- 複数のキーワードを組み合わせて包括的な検索を可能にする\n- 有力と思われるクエリを3つ作成\n\n## 例：\n- 質問：「Google ADKとLangGraphの比較について教えて」\n- 出力：Google ADK LangGraph comparison features differences\n\n検索クエリのみを出力してください。"
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 2
      },
      {
        "id": "c3d07289-c5eb-486d-b72b-ac254081c5d2",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          700,
          200
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-flash"
        },
        "typeVersion": 1
      },
      {
        "id": "54a580ae-8e1e-466e-b16a-03b595098e2f",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          880,
          200
        ],
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n\t\"type\": \"object\",\n\t\"properties\": {\n\t\t\"query1\": \"string\",\n\t\t\"query2\": \"string\",\n        \"query3\": \"string\"\n\t}\n}"
        },
        "typeVersion": 1.3
      },
      {
        "id": "56ed43ed-3130-4943-a437-47f7a5dfcbf8",
        "name": "Google Gemini Chat Model1",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1180,
          180
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-flash"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "3Bm905JaJlmbNdSt",
            "name": "Google Gemini(PaLM) Api account 3"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "0ace29b7-067d-4bf0-9ea4-a34d2f38ae67",
        "name": "Tavily_Search_Tool",
        "type": "@tavily/n8n-nodes-tavily.tavilyTool",
        "position": [
          1340,
          180
        ],
        "parameters": {
          "query": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Query', ``, 'string') }}",
          "options": {
            "max_results": 10,
            "search_depth": "advanced",
            "include_answer": "advanced"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "4ff9b87a-4f50-4080-8bad-ca38c8292c1c",
        "name": "Google Gemini Chat Model2",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1660,
          180
        ],
        "parameters": {
          "options": {
            "maxOutputTokens": 6000
          },
          "modelName": "models/gemini-2.5-pro"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "3Bm905JaJlmbNdSt",
            "name": "Google Gemini(PaLM) Api account 3"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "1801caa0-471a-4a9b-a86e-625118a56024",
        "name": "Send a message",
        "type": "n8n-nodes-base.gmail",
        "position": [
          2120,
          0
        ],
        "webhookId": "874fc2c8-ae11-4c4a-ad57-8f89b302a8f4",
        "parameters": {
          "message": "={{ $json.output }}",
          "options": {},
          "subject": "={{ $('query').item.json.query }}"
        },
        "typeVersion": 2.1
      },
      {
        "id": "5d706b1d-7878-4e5d-8a4a-c11998060d3e",
        "name": "Research Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1180,
          0
        ],
        "parameters": {
          "text": "受けとった3つのqueryを一つずつTavily_Search_Toolにqueryとして渡して3つのqueryに関して調査を実行し検索クエリと調査結果を省略せずにアウトプットしてください。。",
          "options": {
            "systemMessage": "=あなたはTavily_Search_Toolで検索調査を行う専門家です。検索クエリと検索調査結果の内容を省略せずにアウトプットしてください。これ以外の内容はアウトプットしなくて大丈夫です。\n\n## 処理手順：\n1. state内の検索クエリを確認:\n   - query1: {{ $json.output.query1 }}\n   - query2: {{ $json.output.query2 }}\n   - query3: {{ $json.output.query3 }}\n2. tavily_searchツールを呼び出し:\n   - query1~3を使用\n   - search_depth: \"advanced\"\n   - include_answer: true\n   - max_results: 10\n\n3. 特に以下に注目して分析：\n   - TavilyのAI生成回答の内容\n   - 最も関連性の高い情報の詳細\n   - 専門的な解説や分析\n\ntavily_searchツールを必ず使用して、収集した情報とAI分析を統合して提供してください。"
          },
          "promptType": "define"
        },
        "typeVersion": 2
      },
      {
        "id": "c8e7f969-72d9-41f8-a553-6a75b0bc27d2",
        "name": "Report Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1660,
          0
        ],
        "parameters": {
          "text": "調査結果を統合し、ユーザーの質問に対してわかりやすい構造化された包括的な最終レポートをHTML形式でアウトプットしてください。",
          "options": {
            "systemMessage": "=あなたは情報統合と分析を行いユーザーに対する質問に対して構造化された包括的なわかりやすい最終レポートをHTMLで作成する専門家です。以下のユーザーの質問に対して、調査結果を統合し、重複と矛盾を排除しながら包括的かつ内容に沿って構造化されたレポートをHTML形式で作成してください。データが不足している場合は、利用可能な情報のみで最善のレポートを作成してください。HTML形式の回答のみをアウトプットしてください。\n##ユーザーからの質問：{{ $('query').item.json.query }}\n##調査結果：{{ $json.output }}\n\n"
          },
          "promptType": "define"
        },
        "typeVersion": 2
      },
      {
        "id": "78256843-744f-4113-aae8-70122c93f19b",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -300,
          -260
        ],
        "parameters": {
          "width": 560,
          "height": 560,
          "content": "## 📋 Simple Deep Research for Japanese Users\n\n**このワークフローについて**\n\nこのワークフローは、日本語ユーザー向けの自動調査・分析システムです。質問を入力すると、AIが最適な検索クエリを生成し、Tavilyで複数の視点から情報を調査し、統合された包括的なHTMLレポートをメールで送信します。\n\n**主な機能：**\n- 質問から3つの最適化された検索クエリを自動生成\n- Tavilyを使用した高度な検索調査\n- 複数の調査結果を統合したHTMLレポート生成\n- Gmail経由での自動レポート送信\n\n**使用方法：**\n1. Edit Fieldsノードでqueryの値を変更\n2. ワークフローを実行\n3. HTMLレポートがメールで届くまで待機\n\n**必要な設定：**\n- Google Gemini API認証情報\n- Tavily API認証情報\n- Gmail認証情報\n- 送信先メールアドレスの設定"
        },
        "typeVersion": 1
      },
      {
        "id": "5bf63a62-71c9-4b71-92f1-35220c0acf98",
        "name": "query",
        "type": "n8n-nodes-base.set",
        "position": [
          400,
          0
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "552f3fcd-1dc9-4d9b-b906-ead18b354034",
                "name": "query",
                "type": "string",
                "value": "n8nとdifyの違い"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "29036268-0dce-406d-b478-550e1d3ecaee",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          320,
          -400
        ],
        "parameters": {
          "color": 4,
          "width": 280,
          "height": 760,
          "content": "## 🎯 Step 1: Query Input Setup\n**Edit Fields - クエリ設定**\n\nここでユーザーの質問を設定します。デフォルトでは「n8nとdifyの違い」が設定されています。\n\n**カスタマイズ方法：**\n- `query`フィールドの値を変更\n- 日本語で質問を入力\n- 比較・分析・調査系の質問が効果的\n"
        },
        "typeVersion": 1
      },
      {
        "id": "b8a3c415-4643-4a0a-bcfa-46cb9aaff345",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          -400
        ],
        "parameters": {
          "color": 5,
          "width": 400,
          "height": 760,
          "content": "## 🧠 Step 2: AI Query Generation\n**Query Generator - クエリ最適化**\n\nGoogle Gemini 2.5-flashを使用して、入力された質問から3つの最適化された検索クエリを生成します。\n\n**処理内容：**\n- 日本語質問を分析\n- 検索に適したキーワードを抽出\n- 英語クエリも必要に応じて生成\n- 構造化出力でquery1, query2, query3を生成\n\n**重要：** Google Gemini API認証情報が必要です"
        },
        "typeVersion": 1
      },
      {
        "id": "5417921f-5cf9-445a-a731-4ea0f242271b",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1080,
          -400
        ],
        "parameters": {
          "color": 6,
          "width": 460,
          "height": 720,
          "content": "## 🔍 Step 3: Multi-Query Research\n**Research Agent - 調査実行**\n\n生成された3つのクエリを使用してTavilyで調査を実行します。\n\n**調査設定：**\n- `search_depth`: \"advanced\"\n- `max_results`: 10\n- `include_answer`: \"advanced\"\n\n**処理内容：**\n- 各クエリでTavily検索を実行\n- AI生成回答を収集\n- 関連性の高い情報を抽出\n- 専門的な解説や分析を統合\n\n**重要：** Tavily API認証情報が必要です"
        },
        "typeVersion": 1
      },
      {
        "id": "5e73dace-b2dc-462a-b311-257799145ae1",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1580,
          -400
        ],
        "parameters": {
          "color": 7,
          "width": 400,
          "height": 720,
          "content": "## 📊 Step 4: Report Generation\n**Report Agent - レポート作成**\n\n収集した調査結果を統合し、構造化されたHTMLレポートを生成します。\n\n**レポート特徴：**\n- 包括的で理解しやすい構造\n- 重複と矛盾を排除\n- HTML形式で視覚的に見やすい\n- ユーザーの質問に対する直接的な回答\n\n**使用モデル：** Google Gemini 2.5-pro（高品質な分析のため）"
        },
        "typeVersion": 1
      },
      {
        "id": "cf3d13de-00b5-4dee-9f92-33735ee627f2",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2020,
          -400
        ],
        "parameters": {
          "color": 2,
          "width": 340,
          "height": 720,
          "content": "## 📧 Step 5: Email Delivery\n**Send a message - レポート送信**\n\n完成したHTMLレポートをGmail経由で送信します。\n\n**送信設定：**\n- 送信先：Toで送信先を設定\n- 件名：入力された質問\n- 本文：HTMLレポート\n\n**カスタマイズ：** 送信先メールアドレスを適切に変更してください"
        },
        "typeVersion": 1
      },
      {
        "id": "5575b0b2-68ef-4e9c-8cdf-b01bdc858f69",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -300,
          340
        ],
        "parameters": {
          "width": 560,
          "height": 360,
          "content": "## 💡 Customization Tips\n\n**クエリの最適化**\n- 具体的で明確な質問を入力\n- 比較分析系の質問が特に効果的\n- 日本語での入力を推奨\n\n**レポート品質向上**\n- より詳細な調査が必要な場合はmax_resultsを増加\n- クエリの数を3つ以上に増やす\n- 特定分野に特化する場合はsystem messageを調整\n\n**配信設定**\n- 複数の宛先に送信する場合はSend a messageノードを複製\n- 定期実行する場合はCron Triggerを追加検討"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "d5e15813-1520-4e67-ad60-557748e836bb",
    "connections": {
      "query": {
        "main": [
          [
            {
              "node": "Query Generator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Report Agent": {
        "main": [
          [
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Research Agent": {
        "main": [
          [
            {
              "node": "Report Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Query Generator": {
        "main": [
          [
            {
              "node": "Research Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tavily_Search_Tool": {
        "ai_tool": [
          [
            {
              "node": "Research Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Query Generator",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Query Generator",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Research Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Report Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Execute workflow’": {
        "main": [
          [
            {
              "node": "query",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "GLcUQFi471pOAy9l",
    "meta": {
      "instanceId": "a4bfc93e975ca233ac45ed7c9227d84cf5a2329310525917adaf3312e10d5462"
    },
    "name": "Generate AI Videos (with audio), using Sora 2 and Upload to TikTok",
    "tags": [],
    "nodes": [
      {
        "id": "c3c8b7d9-b993-475b-88f7-196edb500473",
        "name": "Get status",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          832,
          576
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/sora-2/requests/{{ $('Create Video').item.json.request_id }}/status ",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "daOZafXpRXLtoLUV",
            "name": "Fal.run API"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "a0f0a4d4-aa2d-4296-ada1-c3ed2dc5e80f",
        "name": "Wait 60 sec.",
        "type": "n8n-nodes-base.wait",
        "position": [
          592,
          576
        ],
        "webhookId": "bb15f2f3-caec-4df6-ac1f-374ed90d8a3e",
        "parameters": {
          "amount": 60
        },
        "typeVersion": 1.1
      },
      {
        "id": "52eb9e2c-5610-4bf5-b8c9-43c01d0abbd8",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -144,
          -80
        ],
        "parameters": {
          "color": 3,
          "width": 740,
          "height": 328,
          "content": "# Generate AI Videos (with audio), using Sora 2 and Upload to TikTok\n\nThis workflow allows users to **generate AI videos** using model **OpenAI Sora 2**, save them to **Google Drive**, generate optimized YouTube titles with GPT-5, and **automatically upload them to TikTok** . The entire process is triggered from a Form that acts as the central interface for input and output.\n\nNOTE: This workflow contains community nodes that are only compatible with the self-hosted version of n8n.\n\n\n\n\n"
        },
        "typeVersion": 1
      },
      {
        "id": "ba77687d-9e91-4dbc-8a90-f82290c93572",
        "name": "Completed?",
        "type": "n8n-nodes-base.if",
        "position": [
          1136,
          576
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "383d112e-2cc6-4dd4-8985-f09ce0bd1781",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.status }}",
                "rightValue": "COMPLETED"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "363bc856-1ce2-42d4-b7f2-e41fbcddb7e1",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          128
        ],
        "parameters": {
          "width": 740,
          "height": 116,
          "content": "## STEP 3 - MAIN FLOW\nStart the workflow manually or periodically by hooking the \"Schedule Trigger\" node. It is recommended to set it at 5 minute intervals."
        },
        "typeVersion": 1
      },
      {
        "id": "37f4778b-aa51-48ed-96af-da0413ad2ef4",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -144,
          288
        ],
        "parameters": {
          "width": 740,
          "height": 172,
          "content": "## STEP 1 - GET API KEY (YOURAPIKEY)\nCreate an account [here](https://fal.ai/) and obtain API KEY.\nIn the node \"Create Image\" set \"Header Auth\" and set:\n- Name: \"Authorization\"\n- Value: \"Key YOURAPIKEY\""
        },
        "typeVersion": 1
      },
      {
        "id": "e8ac3c4c-d8b1-421c-b24c-f83e18845a20",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          192,
          528
        ],
        "parameters": {
          "width": 180,
          "height": 200,
          "content": "Set API Key created in Step 2"
        },
        "typeVersion": 1
      },
      {
        "id": "15047d29-e63a-4d29-b21c-a1beec0b6f88",
        "name": "Create Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          240,
          576
        ],
        "parameters": {
          "url": "https://queue.fal.run/fal-ai/sora-2/text-to-video",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n     \"prompt\": \"{{ $json.PROMPT }}. Duration of the video: {{ $json.DURATION }}\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "daOZafXpRXLtoLUV",
            "name": "Fal.run API"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "487ab020-dfd8-4956-9263-ffe944840978",
        "name": "Get Url Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -96,
          832
        ],
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/sora-2/requests/{{ $json.request_id }}",
          "options": {},
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "RfHIslxMFRjQZ043",
            "name": "Youtube Transcript Extractor API 1"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "616e4deb-c5f3-4a13-a970-5816a5327aae",
        "name": "Get File Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          544,
          832
        ],
        "parameters": {
          "url": "={{ $('Get Url Video').item.json.video.url }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "0c25e7c8-f960-4f46-9530-437bece778a4",
        "name": "Generate title",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          192,
          832
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=Input: {{ $('Get new video').item.json.PROMPT }}"
              },
              {
                "role": "system",
                "content": "You are a YouTube SEO expert specialized in creating engaging and optimized titles.\n\nYour task is to generate an effective title for a YouTube video based on the user's video description.\n\nGUIDELINES:\n- Maximum 60 characters to avoid truncation\n- Use relevant keywords for SEO\n- Make the title catchy and clickable\n- Avoid excessive or misleading clickbait\n- Consider the target audience of the content\n- Use numbers, questions, or power words when appropriate\n- IMPORTANT: Generate the title in the same language as the input description\n\nOUTPUT FORMAT:\nProvide only the title, without additional explanations.\n\nEXAMPLE:\nInput: \"Tutorial video on how to cook perfect pasta carbonara\"\nOutput: \"PERFECT Carbonara in 10 Minutes - Chef's Secrets\""
              }
            ]
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "538d18c3-4049-4940-a08f-180c3871e9b9",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1104,
          784
        ],
        "parameters": {
          "width": 180,
          "height": 200,
          "content": "Set ChannelId Step 3"
        },
        "typeVersion": 1
      },
      {
        "id": "1921e2b7-d6b7-41f2-83e0-b453b4902a11",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          -80
        ],
        "parameters": {
          "width": 740,
          "height": 184,
          "content": "## STEP 2 - Upload video on TikTok\n- Create an account on [Postiz](https://postiz.com/?ref=n3witalia) FREE 7 days-trial\n- Get your API Key and set it in Postiz node and Upload Image node\n- In Calendar tab on [Postiz](https://postiz.com/?ref=n3witalia) click on \"Add channel\" and connect your social networks (TikTok)\n- Once connected, copy the \"ChannelId\" for each social network and insert the appropriate one into the Postiz nodes, replacing the \"XXX\" string. "
        },
        "typeVersion": 1
      },
      {
        "id": "6a914695-7ae2-4c67-bd2f-3946576a0a6a",
        "name": "TikTok",
        "type": "n8n-nodes-postiz.postiz",
        "position": [
          1152,
          832
        ],
        "parameters": {
          "date": "={{ $now.format('yyyy-LL-dd') }}T{{ $now.format('HH:ii:ss') }}",
          "posts": {
            "post": [
              {
                "value": {
                  "contentItem": [
                    {
                      "image": {
                        "imageItem": [
                          {
                            "id": "={{ $json.id }}",
                            "path": "={{ $json.path }}"
                          }
                        ]
                      },
                      "content": "={{ $('Generate title').item.json.message.content }}"
                    }
                  ]
                },
                "integrationId": "XXX"
              }
            ]
          },
          "shortLink": true
        },
        "credentials": {
          "postizApi": {
            "id": "c8iQxqMcfCXPbUHc",
            "name": "Postiz account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "d90711bc-6528-437d-9214-8277941348ec",
        "name": "Upload Video to Postiz",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          832,
          832
        ],
        "parameters": {
          "url": "https://api.postiz.com/public/v1/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "file",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "GIEq2Y2xhJSgjqyG",
            "name": "Postiz"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "fa405717-0efa-4d6f-9a21-7abba6331fec",
        "name": "On form submission",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          -112,
          576
        ],
        "webhookId": "32c47078-918b-41f8-ba5c-3d1ec1bfa42b",
        "parameters": {
          "options": {},
          "formTitle": "Generate AI Videos (with audio)",
          "formFields": {
            "values": [
              {
                "fieldLabel": "PROMPT",
                "requiredField": true
              },
              {
                "fieldType": "number",
                "fieldLabel": "DURATION",
                "requiredField": true
              }
            ]
          },
          "formDescription": "Generate AI Videos (with audio), using OpenAI Sora 2 and Upload to TikTok"
        },
        "typeVersion": 2.3
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "b1721168-dbc7-4724-bee5-dd524ab1ee83",
    "connections": {
      "Completed?": {
        "main": [
          [
            {
              "node": "Get Url Video",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait 60 sec.",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get status": {
        "main": [
          [
            {
              "node": "Completed?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Video": {
        "main": [
          [
            {
              "node": "Wait 60 sec.",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 60 sec.": {
        "main": [
          [
            {
              "node": "Get status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Url Video": {
        "main": [
          [
            {
              "node": "Generate title",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate title": {
        "main": [
          [
            {
              "node": "Get File Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get File Video": {
        "main": [
          [
            {
              "node": "Upload Video to Postiz",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "On form submission": {
        "main": [
          [
            {
              "node": "Create Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video to Postiz": {
        "main": [
          [
            {
              "node": "TikTok",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "iFap1xHZlQomh35C",
    "meta": {
      "instanceId": "4ceda4926e528030b63d1e667414f37860970ebeb79b51bb0265d85b2e1b47dc",
      "templateCredsSetupCompleted": true
    },
    "name": "ICP Report & Lookalike Companies",
    "tags": [],
    "nodes": [
      {
        "id": "699f325b-df7d-44ac-aaf3-9a91bcb66697",
        "name": "Manual Trigger",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -400,
          464
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "bbf44b30-aeaa-40ab-bda1-67bcfbfe3500",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -144,
          400
        ],
        "parameters": {
          "color": 7,
          "width": 1760,
          "height": 544,
          "content": "## get_lookalikes"
        },
        "typeVersion": 1
      },
      {
        "id": "4c059e72-186f-49b5-a463-51fb6ac7e9b0",
        "name": "set_f2",
        "type": "n8n-nodes-base.set",
        "position": [
          848,
          1248
        ],
        "parameters": {
          "fields": {
            "values": [
              {
                "name": "text",
                "stringValue": "={{ $json[\"digest\"] }}"
              }
            ]
          },
          "include": "none",
          "options": {}
        },
        "typeVersion": 3.2
      },
      {
        "id": "25109522-9d7b-4991-9c24-d724dc29edb8",
        "name": "Filter term.en",
        "type": "n8n-nodes-base.function",
        "position": [
          144,
          1088
        ],
        "parameters": {
          "functionCode": "return items.filter(item => {\n  return item.json.key === 'term.en'\n})\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3adea014-b4cc-4a3e-bcaa-aee5619ba6ab",
        "name": "Filter term.de",
        "type": "n8n-nodes-base.function",
        "position": [
          144,
          1408
        ],
        "parameters": {
          "functionCode": "return items.filter(item => {\n  return item.json.key === 'term.de'\n})\n"
        },
        "typeVersion": 1
      },
      {
        "id": "9ae4bfcc-002e-4b22-8f96-3f2f581c6ce9",
        "name": "parse_term_features",
        "type": "n8n-nodes-base.function",
        "onError": "continueErrorOutput",
        "position": [
          -16,
          1232
        ],
        "parameters": {
          "functionCode": "const newItems = [];\n\nfor (const item of items[0].json.targetProfile.features) {\n  newItems.push({json: item});\n}\n\nreturn newItems;"
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "ecc1ed2c-0b38-4bad-87b9-5c30e3334f0d",
        "name": "merge_terms",
        "type": "n8n-nodes-base.merge",
        "position": [
          688,
          1248
        ],
        "parameters": {
          "mode": "combine",
          "options": {},
          "combinationMode": "multiplex"
        },
        "typeVersion": 2.1
      },
      {
        "id": "a586c5ac-b54b-4246-a87d-60c53065fb6d",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -144,
          960
        ],
        "parameters": {
          "color": 7,
          "width": 1760,
          "height": 704,
          "content": "## get_icp"
        },
        "typeVersion": 1
      },
      {
        "id": "40aa5f28-d804-463a-8687-6727d7263c5a",
        "name": "Configuration",
        "type": "n8n-nodes-base.set",
        "position": [
          -400,
          880
        ],
        "parameters": {
          "fields": {
            "values": [
              {
                "name": "explain",
                "type": "booleanValue",
                "booleanValue": "false"
              },
              {
                "name": "size",
                "type": "numberValue",
                "numberValue": "3"
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "cf0858e6-23d0-4aa0-a2b3-a4bab8310f48",
        "name": "Authorization",
        "type": "n8n-nodes-base.set",
        "notes": "Get API key here:\n\nhttps://implisense.com/de/contact",
        "position": [
          -400,
          656
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "x-api-key",
                "value": "XXXX"
              }
            ]
          },
          "options": {}
        },
        "notesInFlow": true,
        "typeVersion": 2
      },
      {
        "id": "38e00c50-55a0-42c3-b107-37cbc12cf2a8",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1632,
          400
        ],
        "parameters": {
          "color": 7,
          "width": 336,
          "height": 1264,
          "content": "## Output"
        },
        "typeVersion": 1
      },
      {
        "id": "39c7181a-ad06-41ef-8103-88b299297e32",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -512,
          400
        ],
        "parameters": {
          "color": 7,
          "width": 336,
          "height": 1264,
          "content": "## Input"
        },
        "typeVersion": 1
      },
      {
        "id": "31be4f27-9a5d-4cec-8302-cf54f984ce0f",
        "name": "serialize_ids",
        "type": "n8n-nodes-base.function",
        "position": [
          -16,
          608
        ],
        "parameters": {
          "functionCode": "items[0].json.myVariable = 1;\n\nlet serialization = '';\nfor (const item of items) {\n  serialization += `${item.json.id},`;\n}\n\nreturn [\n  {\n    json: {\n      serialization\n    }\n  }\n];"
        },
        "typeVersion": 1
      },
      {
        "id": "9747ea3f-cc89-4706-9934-dde1979d423a",
        "name": "trim",
        "type": "n8n-nodes-base.set",
        "position": [
          192,
          608
        ],
        "parameters": {
          "values": {
            "string": [
              {
                "name": "serialization",
                "value": "={{ $json.serialization.replace(/[,]/g,'\",\"').trim() }}"
              }
            ]
          },
          "options": {},
          "keepOnlySet": true
        },
        "typeVersion": 2
      },
      {
        "id": "2ed3cef0-68d2-44eb-81cb-657a96720835",
        "name": "get_lookalikes",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "Get your API key here:\n\nhttps://implisense.com/de/contact",
        "maxTries": 2,
        "position": [
          384,
          608
        ],
        "parameters": {
          "url": "=https://api.implisense.com/recommend?explain={{ $('Configuration').item.json.explain }}&size={{ $('Configuration').item.json.size }}",
          "options": {
            "fullResponse": false
          },
          "requestMethod": "POST",
          "jsonParameters": true,
          "bodyParametersJson": "={\n  \"baseCompanies\": [\n    \"{{ $json[\"serialization\"].slice(0,-3) }}\"\n  ],\n  \"locationsFilter\": [\n    {\n      \"type\": \"state\",\n      \"code\": \"de-be\"\n    }\n  ]\n}",
          "headerParametersJson": "="
        },
        "notesInFlow": true,
        "retryOnFail": true,
        "typeVersion": 1,
        "continueOnFail": true,
        "waitBetweenTries": 5000
      },
      {
        "id": "7d433ca2-a8a9-4354-a966-f00303624dc6",
        "name": "lookalikes_or_icp",
        "type": "n8n-nodes-base.switch",
        "position": [
          592,
          608
        ],
        "parameters": {
          "rules": {
            "values": [
              {
                "outputKey": "icp",
                "conditions": {
                  "options": {
                    "version": 3,
                    "leftValue": "",
                    "caseSensitive": true,
                    "typeValidation": "strict"
                  },
                  "combinator": "and",
                  "conditions": [
                    {
                      "id": "53b5f832-e77e-44c8-9986-26160e43ade8",
                      "operator": {
                        "type": "boolean",
                        "operation": "equals"
                      },
                      "leftValue": "={{ $('Configuration').item.json.explain }}",
                      "rightValue": true
                    }
                  ]
                },
                "renameOutput": true
              }
            ]
          },
          "options": {
            "fallbackOutput": "extra"
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "f932ee32-7178-4c8f-aa63-88211abe6235",
        "name": "get_companies",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          832,
          624
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "companies"
        },
        "typeVersion": 1
      },
      {
        "id": "b5e8883a-5e2d-46ed-8975-f6d600af6c58",
        "name": "sort_desc",
        "type": "n8n-nodes-base.function",
        "position": [
          336,
          1088
        ],
        "parameters": {
          "functionCode": "const sortedArr = items.sort((a, b) => {\n    let a_name = a.json.targetCount,\n        b_name = b.json.targetCount;\n\n    if (a_name > b_name) {\n        return -1;\n    }\n    if (a_name < b_name) {\n        return 1;\n    }\n    return 0;\n});\nreturn sortedArr;\n"
        },
        "typeVersion": 1
      },
      {
        "id": "3e944979-f230-4f6c-a28a-f18d0e3a1715",
        "name": "digest_terms_en",
        "type": "n8n-nodes-base.function",
        "position": [
          512,
          1088
        ],
        "parameters": {
          "functionCode": "items[0].json.myVariable = 1;\n\nlet digest = '';\nfor (const item of items) {\n  digest += `${item.json.value}: ${item.json.targetCount},\\n`;\n}\n\nreturn [\n  {\n    json: {\n      digest\n    }\n  }\n];"
        },
        "typeVersion": 1
      },
      {
        "id": "5217e2a8-72ea-46bb-af87-27c4bee6b1ce",
        "name": "digest_terms_de",
        "type": "n8n-nodes-base.function",
        "position": [
          512,
          1408
        ],
        "parameters": {
          "functionCode": "items[0].json.myVariable = 1;\n\nlet digest = '';\nfor (const item of items) {\n  digest += `${item.json.value}: ${item.json.targetCount},\\n`;\n}\n\nreturn [\n  {\n    json: {\n      digest\n    }\n  }\n];"
        },
        "typeVersion": 1
      },
      {
        "id": "cc68adf2-41e5-4a38-88a1-02b5062c4cf4",
        "name": "sort_desc2",
        "type": "n8n-nodes-base.function",
        "position": [
          336,
          1408
        ],
        "parameters": {
          "functionCode": "const sortedArr = items.sort((a, b) => {\n    let a_name = a.json.targetCount,\n        b_name = b.json.targetCount;\n\n    if (a_name > b_name) {\n        return -1;\n    }\n    if (a_name < b_name) {\n        return 1;\n    }\n    return 0;\n});\nreturn sortedArr;\n"
        },
        "typeVersion": 1
      },
      {
        "id": "d13b051d-9b5f-4fd3-b3ab-e5997091477b",
        "name": "generate_icp_report",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          1040,
          1248
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-5-mini",
            "cachedResultName": "GPT-5-MINI"
          },
          "options": {},
          "responses": {
            "values": [
              {
                "content": "={{ $json.text }}"
              },
              {
                "role": "system",
                "content": "=# Regeln\n\n- Nehmen Sie in die Rolle eines Analysten ein, der Unternehmen klassifiziert.\n\nGegeben ist eine Liste von Stichwörtern und deren Häufigkeiten, die auf verschiedenen Firmenwebsites identifiziert wurden. Diese Wörter reflektieren zentrale Themen von Unternehmen mit Interesse. Deine Aufgabe ist es, auf Basis dieser Stichwörter und ihrer Häufigkeiten ein detailliertes Ideal Customer Profile (ICP) zu erstellen. Das ICP sollte Einblicke in die Technologien, Produkte, Bedürfnisse der idealen B2B-Kunden geben.\n\nAufgabe:\n\nAnalysiere die Stichwörter und ihre Implikationen für ein ICP. Entwickle daraus ein Ideal Customer Profile, das folgende Aspekte umfasst:\n\n1. Technologien: Identifiziere wichtige Technologie-Trends sowie direkte und indirekte Technologien, die diese Unternehmen einsetzen. Fokussiere insbesondere auf moderne Technologien und Technologie-Trends.\n2. Produkte: Leite aus den Stichwörtern die Produkte und Services der Unternehmen ab. Erwähne die Stichwörter und Anzahl der Treffer, um Deine Argumente zu stärken.\n3. Bedürfnisse: Leite ab, welche Bedürfnisse hinter den Interessen der Unternehmen stehen könnten.\n\nNutze diese Informationen, um ein ICP vorzuschlagen, um ideale Kunden zu finden und personalisiert anzusprechen. Generiere im Plaintext Format."
              }
            ]
          },
          "builtInTools": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "bfd2LovMz91g5CGX",
            "name": "OpenAI"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "092a1a6d-c03e-49e5-9499-a3f952f6cd05",
        "name": "icp_report",
        "type": "n8n-nodes-base.set",
        "position": [
          1744,
          1248
        ],
        "parameters": {
          "fields": {
            "values": [
              {
                "name": "icp_report",
                "stringValue": "={{ $json.output[0].content[0].text }}"
              }
            ]
          },
          "include": "none",
          "options": {
            "ignoreConversionErrors": true
          }
        },
        "typeVersion": 3.2
      },
      {
        "id": "a4a127fb-1184-4e6e-95db-4ff7054a5353",
        "name": "list_of_companies",
        "type": "n8n-nodes-base.set",
        "position": [
          1728,
          624
        ],
        "parameters": {
          "values": {
            "number": [
              {
                "name": "crmLeadScore",
                "value": "={{Math.round($json.score * 100)}}"
              }
            ],
            "string": [
              {
                "name": "crmAccountName",
                "value": "={{$json.name}}"
              },
              {
                "name": "crmDomain",
                "value": "={{$json.url}}"
              },
              {
                "name": "crmCity",
                "value": "={{$json.city}}"
              },
              {
                "name": "crmZip",
                "value": "={{$json.zip}}"
              },
              {
                "name": "crmStreet",
                "value": "={{$json.street}}"
              },
              {
                "name": "crmImplisenseId",
                "value": "={{$json.id}}"
              },
              {
                "name": "crmProfileUrl",
                "value": "={{$json.profile}}"
              },
              {
                "name": "crmExplanation",
                "value": "={{$json.explanation}}"
              }
            ],
            "boolean": [
              {
                "name": "crmIsActiveCompany",
                "value": "={{$json.active}}"
              }
            ]
          },
          "options": {}
        },
        "typeVersion": 2
      },
      {
        "id": "04c54b5f-27ba-437c-985c-6148e55edec4",
        "name": "🏗️ Architecture Notes2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1056,
          400
        ],
        "parameters": {
          "width": 512,
          "height": 1440,
          "content": "# B2B ICP Report & Lookalike Companies in Germany\n\nThis workflow generates a full Ideal Customer Profile (ICP) report and retrieves lookalike companies from the Implisense API. It starts by ingesting a set of base company IDs, serializes them, and sends a recommendation request to Implisense to fetch similar companies. When explanation mode is enabled, the workflow extracts and processes term features to create a structured keyword digest and uses an LLM to generate an ICP narrative. The pipeline outputs both a clean list of lookalike companies, enriched with CRM-ready fields, and a detailed ICP report derived from Implisense feature statistics.\n\n## How it works\n**Input** → **Serialization** → **Lookalikes** → **Lists/Report**\n\n## Setup steps\n\n### 1. Data Source\n☐ Replace \"Mock ICP Companies\" with matched companies from the Implisense database\n☐ Ensure output has: id\n\n### 2. **Configure Credentials**: Set up RapidAPI API credentials\n   - Get your API key here: https://implisense.com/de/contact\n   - Insert your API Token in get_lookalikes (Basic auth)\n\n### 3. Configure ICP Filters\n☐ Edit \"Build Recommendation Request\" node\n☐ Set locationsFilter (e.g., de-be, de-by, de-nw)\n☐ Set industriesFilter (NACE codes, e.g., J62 for IT)\n☐ Set sizesFilter (MICRO, SMALL, MEDIUM, LARGE)\n\n### 4. Tune Results\n☐ Adjust THRESHOLD in \"Filter & Normalize Results\" (default: 0.5)\n☐ Adjust MIN_BASE_COMPANIES in \"Collect Base Companies\" (default: 3)\n☐ Adjust size parameter in \"Configuration\" URL (default: 100)\n\n### 5. CRM Integration\n☐ Map fields in \"list_of_companies\" to match your CRM schema\n☐ Add CRM upsert node after \"list_of_companies\"\n☐ Use implisense-ID or domain as unique identifier\n\n## Additional advice\n\nStrengthen Base Company Quality\nUse only highly representative base companies that strongly match the intended ICP segment. Templates with dozens of mixed or heterogeneous IDs dilute the statistical signal in the /recommend endpoint and reduce relevance.\n\nRefine Filters Aggressively\nLimit recommendations by state, region, NACE code, or size class. Implisense returns cleaner results when the recommendation space is constrained. Removing unnecessary geography broadens noise.\n\nIncrease the Size Parameter\nRaise the size parameter when building the request to give the ranking model more candidates. This materially improves downstream sorting and selection."
        },
        "typeVersion": 1
      },
      {
        "id": "a20d1808-d2a3-4722-b148-9c909b04c978",
        "name": "Mock ICP Companies based on Implisense-ID",
        "type": "n8n-nodes-base.code",
        "position": [
          -400,
          1104
        ],
        "parameters": {
          "jsCode": "return [\n {\n \"id\": [\n\"DEXEF64Q6Q57\",\n\"DEMHMCXXVX35\",\n\"DE94CIJM2285\",\n\"DECXL1MULU53\",\n\"DE44A37AB950\",\n\"DEWX7YLSXD33\",\n\"DENT1AT56A58\",\n\"DE9UMUNCN020\",\n\"DEDEHNP9UC53\",\n\"DEWT7QXQRQ32\",\n\"DECM46M31225\",\n\"DEI2J6FMVZ26\",\n\"DERL98JJ8F78\",\n\"DEC1Y6A0FK62\",\n\"DE1BS1HZU967\",\n\"DE0J7WCH5468\",\n\"DES5IQ9K8M60\",\n\"DE8HQA4XU409\",\n\"DEW5A8SY9V96\",\n\"DEEZZ62FBP42\",\n\"DEG0OAPZ2P91\",\n\"DEKGPZBX0E50\",\n\"DEZ82JE8RX39\",\n\"DEVAY0708427\",\n\"DE0UZ5OFAR95\",\n\"DEC7GHLMW408\",\n\"DEKNFBFHXJ57\",\n\"DEV54N9RH355\",\n\"DE359D7HY984\",\n\"DEADNXAEPO75\",\n\"DEIJAKISPD17\",\n\"DEK7539BP071\",\n\"DEEI80UPMF51\",\n\"DEC6318YME54\",\n\"DEDLY796C977\",\n\"DESGYEATSN08\",\n\"DEYYSTVOLU53\",\n\"DEOIFM53GA57\",\n\"DE4R801G0062\",\n\"DEWKBUVB4W43\",\n\"DESXBBGSL141\",\n\"DE5IW0RPDQ32\",\n\"DEK5L0PKA055\",\n\"DE5QRL004Z42\",\n\"DEFYDJU4GT53\",\n\"DEA1VHLSRB24\",\n\"DEFWE4TZQB44\",\n\"DEUPA9T3GU46\",\n\"DEVF9L9EC003\",\n\"DEYN58WJE381\",\n\"DEOVFS3SLX61\",\n\"DEKSFLSIMH05\",\n\"DEADOZ8Y3957\",\n\"DEPI9ZQUX811\"\n ]\n}\n];"
        },
        "typeVersion": 2
      }
    ],
    "active": false,
    "pinData": {
      "get_lookalikes": [
        {
          "json": {
            "size": 3490,
            "facets": {
              "sizes": [
                {
                  "code": "LARGE",
                  "name": "Großunternehmen",
                  "number": 169
                },
                {
                  "code": "MEDIUM",
                  "name": "Mittelgroßes Unternehmen",
                  "number": 480
                },
                {
                  "code": "SMALL",
                  "name": "Kleines Unternehmen",
                  "number": 1614
                },
                {
                  "code": "MICRO",
                  "name": "Kleinstunternehmen",
                  "number": 1227
                }
              ],
              "locations": [
                {
                  "code": "de-10",
                  "name": "10 - Berlin Innenstadt",
                  "type": "zip",
                  "number": 2206
                },
                {
                  "code": "de-20",
                  "name": "20 - Hamburg Mitte",
                  "type": "zip",
                  "number": 1222
                },
                {
                  "code": "de-22",
                  "name": "22 - Hamburg Nord/West, Norderstedt, Ahrensburg, Wedel",
                  "type": "zip",
                  "number": 1417
                },
                {
                  "code": "de-40",
                  "name": "40 - Düsseldorf, Hilden, Mettmann, Ratingen",
                  "type": "zip",
                  "number": 1371
                },
                {
                  "code": "de-48",
                  "name": "48 - Münster, Rheine, Nordhorn, Coesfeld",
                  "type": "zip",
                  "number": 1178
                },
                {
                  "code": "de-50",
                  "name": "50 - Köln linksrheinisch, Frechen, Brühl, Bergheim",
                  "type": "zip",
                  "number": 1623
                },
                {
                  "code": "de-63",
                  "name": "63 - Aschaffenburg, Hanau, Offenbach, Miltenberg",
                  "type": "zip",
                  "number": 1144
                },
                {
                  "code": "de-65",
                  "name": "65 - Wiesbaden, Limburg, Rüsselsheim, Frankfurt am Main West",
                  "type": "zip",
                  "number": 1455
                },
                {
                  "code": "de-80",
                  "name": "80 - München Mitte-Nordwest",
                  "type": "zip",
                  "number": 1411
                },
                {
                  "code": "de-85",
                  "name": "85 - Münchener Umland (Nord, Ost), Ingolstadt, Dachau, Freising",
                  "type": "zip",
                  "number": 1142
                },
                {
                  "code": "de-bb",
                  "name": "Region Berlin/Brandenburg",
                  "type": "region",
                  "number": 2206
                },
                {
                  "code": "de-be",
                  "name": "Berlin",
                  "type": "state",
                  "number": 2206
                },
                {
                  "code": "de-by",
                  "name": "Bayern",
                  "type": "state",
                  "number": 2553
                },
                {
                  "code": "de-ham",
                  "name": "Großraum Hamburg",
                  "type": "region",
                  "number": 2639
                },
                {
                  "code": "de-he",
                  "name": "Hessen",
                  "type": "state",
                  "number": 2599
                },
                {
                  "code": "de-hh",
                  "name": "Hamburg",
                  "type": "state",
                  "number": 2639
                },
                {
                  "code": "de-main",
                  "name": "Region Rhein-Main",
                  "type": "region",
                  "number": 2599
                },
                {
                  "code": "de-mun",
                  "name": "Großraum München",
                  "type": "region",
                  "number": 2553
                },
                {
                  "code": "de-nw",
                  "name": "Nordrhein-Westfalen",
                  "type": "state",
                  "number": 4172
                },
                {
                  "code": "de-ruhr",
                  "name": "Region Rhein-Ruhr",
                  "type": "region",
                  "number": 2994
                }
              ],
              "industries": [
                {
                  "code": "C",
                  "name": "Verarbeitendes Gewerbe",
                  "type": "nace",
                  "number": 290
                },
                {
                  "code": "G",
                  "name": "Handel; Instandhaltung und Reparatur von Kraftfahrzeugen",
                  "type": "nace",
                  "number": 707
                },
                {
                  "code": "G46",
                  "name": "Großhandel (ohne Handel mit Kraftfahrzeugen)",
                  "type": "nace",
                  "number": 423
                },
                {
                  "code": "G47",
                  "name": "Einzelhandel (ohne Handel mit Kraftfahrzeugen)",
                  "type": "nace",
                  "number": 350
                },
                {
                  "code": "I",
                  "name": "Gastgewerbe",
                  "type": "nace",
                  "number": 238
                },
                {
                  "code": "J",
                  "name": "Information und Kommunikation",
                  "type": "nace",
                  "number": 688
                },
                {
                  "code": "J62",
                  "name": "Erbringung von Dienstleistungen der Informationstechnologie",
                  "type": "nace",
                  "number": 488
                },
                {
                  "code": "M",
                  "name": "Erbringung von freiberuflichen, wissenschaftlichen und technischen Dienstleistungen",
                  "type": "nace",
                  "number": 745
                },
                {
                  "code": "M70",
                  "name": "Verwaltung und Führung von Unternehmen und Betrieben; Unternehmensberatung",
                  "type": "nace",
                  "number": 403
                },
                {
                  "code": "N",
                  "name": "Erbringung von sonstigen wirtschaftlichen Dienstleistungen",
                  "type": "nace",
                  "number": 393
                }
              ]
            },
            "companies": [
              {
                "id": "DEY5SXPGZ383",
                "url": "http://www.vinobucks.de/",
                "zip": "12163",
                "city": "Berlin",
                "name": "Maitre Consult GmbH",
                "score": 0.7420839667320251,
                "active": true,
                "street": "Muthesiusstraße 6",
                "profile": "https://implisen.se/DEY5SXPGZ383",
                "snippets": [],
                "explanation": []
              },
              {
                "id": "DE9WMJ407023",
                "url": "https://fineaustralianwine.de/",
                "zip": "10777",
                "city": "Berlin",
                "name": "The Fine Australian Wine Company GmbH",
                "score": 0.713323712348938,
                "active": true,
                "street": "Ansbacher Straße 60",
                "profile": "https://implisen.se/DE9WMJ407023",
                "snippets": [],
                "explanation": []
              },
              {
                "id": "DEFBQZFMLI07",
                "url": "http://www.shatoh.de/",
                "zip": "10719",
                "city": "Berlin",
                "name": "SHATOH Gourmet GmbH",
                "score": 0.7127481698989868,
                "active": true,
                "street": "Kurfürstendamm 42",
                "profile": "https://implisen.se/DEFBQZFMLI07",
                "snippets": [],
                "explanation": []
              }
            ]
          },
          "pairedItem": {
            "item": 0
          }
        }
      ],
      "list_of_companies": [
        {
          "json": {
            "id": "DEY5SXPGZ383",
            "url": "http://www.vinobucks.de/",
            "zip": "12163",
            "city": "Berlin",
            "name": "Maitre Consult GmbH",
            "score": 0.7420839667320251,
            "active": true,
            "crmZip": "12163",
            "street": "Muthesiusstraße 6",
            "crmCity": "Berlin",
            "profile": "https://implisen.se/DEY5SXPGZ383",
            "snippets": [],
            "crmDomain": "http://www.vinobucks.de/",
            "crmStreet": "Muthesiusstraße 6",
            "explanation": [],
            "crmLeadScore": 74,
            "crmProfileUrl": "https://implisen.se/DEY5SXPGZ383",
            "crmAccountName": "Maitre Consult GmbH",
            "crmExplanation": [],
            "crmImplisenseId": "DEY5SXPGZ383",
            "crmIsActiveCompany": true
          },
          "pairedItem": {
            "item": 0
          }
        },
        {
          "json": {
            "id": "DE9WMJ407023",
            "url": "https://fineaustralianwine.de/",
            "zip": "10777",
            "city": "Berlin",
            "name": "The Fine Australian Wine Company GmbH",
            "score": 0.713323712348938,
            "active": true,
            "crmZip": "10777",
            "street": "Ansbacher Straße 60",
            "crmCity": "Berlin",
            "profile": "https://implisen.se/DE9WMJ407023",
            "snippets": [],
            "crmDomain": "https://fineaustralianwine.de/",
            "crmStreet": "Ansbacher Straße 60",
            "explanation": [],
            "crmLeadScore": 71,
            "crmProfileUrl": "https://implisen.se/DE9WMJ407023",
            "crmAccountName": "The Fine Australian Wine Company GmbH",
            "crmExplanation": [],
            "crmImplisenseId": "DE9WMJ407023",
            "crmIsActiveCompany": true
          },
          "pairedItem": {
            "item": 1
          }
        },
        {
          "json": {
            "id": "DEFBQZFMLI07",
            "url": "http://www.shatoh.de/",
            "zip": "10719",
            "city": "Berlin",
            "name": "SHATOH Gourmet GmbH",
            "score": 0.7127481698989868,
            "active": true,
            "crmZip": "10719",
            "street": "Kurfürstendamm 42",
            "crmCity": "Berlin",
            "profile": "https://implisen.se/DEFBQZFMLI07",
            "snippets": [],
            "crmDomain": "http://www.shatoh.de/",
            "crmStreet": "Kurfürstendamm 42",
            "explanation": [],
            "crmLeadScore": 71,
            "crmProfileUrl": "https://implisen.se/DEFBQZFMLI07",
            "crmAccountName": "SHATOH Gourmet GmbH",
            "crmExplanation": [],
            "crmImplisenseId": "DEFBQZFMLI07",
            "crmIsActiveCompany": true
          },
          "pairedItem": {
            "item": 2
          }
        }
      ],
      "generate_icp_report": [
        {
          "json": {
            "output": [
              {
                "id": "msg_0ef51fec34f17cc800693998b9573881969b806f1f3f8948f7",
                "role": "assistant",
                "type": "message",
                "status": "completed",
                "content": [
                  {
                    "text": "Analyse der Stichwörter (Auszug mit Häufigkeit) — Grundlage\n- wein: 30, weine: 28, riesling: 27, trauben: 25, weinen: 25, weingut: 24, weinbau: 20, winzer: 20, aroma/ Aromen: 20, rebsorte: 19, reben: 19, wine: 19, verkostung: 19, weinberg: 19, weinberge: 18, rebsorten: 16, brut: 16, terroir: 15, weinguts/weingütern: 15, mineralität: 14, ortsweine: 11, ortswein: 10, trockenbeerenauslese: 9, vdp.erste: 8, vdp.grosse: 8, spitzenlagen: 8, steillage: 8, rieslings: 8\n(Bemerkung: Häufigkeit in Klammern oben.)\n\n1) Kurzes Marktbild / Positionierung aus den Stichwörtern\nDie Keywords deuten klar auf deutsche Premium-Weingüter mit Schwerpunkt Riesling (riesling: 27; rieslings: 8; rieslingweine: 10), terroir- und Lagenorientierung (terroir: 15; spitzenlagen: 8; vdp.erste: 8; vdp.grosse: 8; ortswein/ortsweine: 10/11; weinberg/weinberge: 19/18), Qualität und sensorische Merkmale (aromen: 20; mineralität: 14) sowie auf Spezialitäten (trockenbeerenauslese: 9; brut: 16). Viele Treffer für weingut/weinguts/weingütern/weingut-spezifische Begriffe (24/15/15) deuten auf familiengeführte bis mittelgroße Weingüter. Begriffe wie steillage (8) zeigen spezielle infrastrukturelle Herausforderungen (steile Lagen).\n\n2) Ideal Customer Profile (ICP) — Zusammenfassung\n- Branche: Kleine bis mittelgroße, premium-orientierte Weingüter/Weinbetriebe in Deutschland (stark Riesling-fokussiert), ggf. VDP-Mitglieder oder Anwärter, die Einzel- und Lagenweine produzieren.\n- Unternehmensgröße: 5–100 Hektar Rebfläche; Mitarbeiterzahl typischerweise 5–50; Familienbetriebe mit eigener Kellerwirtschaft, Verkostungsraum und Direktvertrieb.\n- Geschäftsmodell: Produktion & Verkauf von Qualitäts- und Premiumweinen (Einzellagen, Ortsweine, Grosse Lagen, Trockenbeerenauslese, Brut), Direktvertrieb (DTC), Weinclub/Abonnements, Wein­tourismus/Verkostungen (verkostung: 19).\n- Entscheider: Inhaber/Winzer (winzer: 20), Kellermeister, Produktionsleiter, Marketing-/Vertriebsleiter für DTC und Export.\n- Geographie: Regionen mit Riesling-Schwerpunkt und Steillagen (z. B. Mosel, Rheingau, Nahe, Pfalz, Rheinhessen), national & international Absatzmärkte.\n\n3) Technologien — wichtigste Trends & eingesetzte Technologien (direkt/indirekt)\nA. Precision Viticulture & Feldtechnik\n- Sensorik & IoT: Bodenfeuchte-, Temperatur-, Nährstoff- und Frostsensoren für präzise Rebbewirtschaftung (Reben/Trauben überwachen).\n- Wetterstationen und Mikroklima-Monitoring, Frostwarnsysteme (besonders in Steillagen).\n- Drohnen & Satellitenfernerkundung (NDVI, Vegetationsindizes) für Vegetationszustand, Krankheitsfrüherkennung, Ertragsprognosen.\n- GIS & Karten (Parzellendokumentation für Lagen/Terroir-Analysen).\n\nB. Mechanisierung / Robotik (Antwort auf Arbeitskräftemangel / steile Lagen-spezifische Lösungen)\n- Mechanische Weinbergspflege, selektive oder teilmechanische Lese, spezialisierte Gerätschaften für Steillagen (Seilkransysteme, spezielle Erntemaschinen).\n- Emerging: autonome Traktoren / Pflege-Roboter (frühadoptierende Premiumgüter).\n\nC. Keller- & Produktions-Technologien\n- Temperaturgeführte Gärführung, präzise Tanksteuerung (Stahl, Fuder, Barriques), mikrooxigenation, Filtration/Schonungstechniken.\n- Analytik-Labore / In-line-Messgeräte (Spektrometer, pH, Brix, phenolische Analyse) zur Qualitätssicherung.\n- Automatisierte Abfüll- und Etikettieranlagen, Verschluss- und Verpackungstechnik.\n- CO2-Reduktion, Energieeffiziente Kühlung, Photovoltaik für nachhaltige Produktion.\n\nD. Digitalisierung & Vertrieb\n- E‑Commerce Plattformen für Direktverkauf (Wine Shops, Abonnement-Systeme), Integration Payment/Logistik.\n- CRM / Wine-Club-Management, POS-Systeme im Verkostungsraum, Buchungssoftware für Tastings/Events.\n- Digitales Marketing: SEO (Keywords wie Riesling, Verkostung, Ortswein), Social Media, Content-Marketing.\n- Traceability & Provenance: QR-Codes, Blockchain-Pilotprojekte zur Herkunftsnachweis/Qualitätssicherung.\n\nE. Nachhaltigkeit & Zertifizierungstechnik\n- Monitoring-Tools zur CO2-, Wasser- und Biodiversitätsbilanz; Tools für Öko-/biodynamische Dokumentation.\n- Präzisionsbewässerung (Tröpfchen), Bodenpflege-Technologien (Cover Crops, Mulchen).\n\n4) Produkte & Services (abgeleitet aus Keywords mit Nennung der Treffer)\n- Wein-Produkte:\n  - Riesling-Portfolio (riesling: 27; rieslings: 8; rieslingweine: 10)\n  - Ortsweine & Ortswein (ortsweine: 11; ortswein: 10)\n  - Erste/Grosse Lagen / Spitzenlagen (vdp.erste: 8; vdp.grosse: 8; spitzenlagen: 8)\n  - Trockenbeerenauslese / edelsüße Spezialitäten (trockenbeerenauslese: 9)\n  - Sekte/Brut (brut: 16)\n  - Keller- und Fassbetonte Spezialitäten (Aromen/Mineralität betonen: aromen: 20; mineralität: 14)\n- Betriebsleistungen/Services:\n  - Verkostungen & Weinproben (verkostung: 19)\n  - Wein-Erlebnis/Tourismus, Verkauf vor Ort (weingut/weinguts/weingütern: 24/15/15)\n  - Direktvertrieb & Wine Club Management\n  - Beratung/Weinmarketing, Export-Service für englischsprachige Märkte (keyword „wine“ 19)\n- Unterstützende Services (B2B-Angebote):\n  - Weinanalytik & Laborservices\n  - Lagen-/Boden- & Terroir-Analysen\n  - Digitalisierungslösungen für DTC, Buchungssysteme & CRM\n  - Maschinen/Anlagen für Steillagenbewirtschaftung\n\n5) Bedürfnisse — was treibt diese Kunden an?\n- Qualitäts- und Terroir-Expression: starke Betonung auf terroir (15), mineralität (14), aromen (20) → präzise Weinbergs- und Kellerarbeit, Analytik zur Erhaltung von Stil und Finesse.\n- Lagen-spezifische Bewirtschaftung: spitzenlagen (8), steillage (8) → Lösungen für Arbeitssicherheit, Spezialmaschinen, selektive Lese.\n- Premiumisierung & Positionierung: vdp.erste/vdp.grosse (8/8), ortswein/ortsweine → Bedarf an Branding, Storytelling, Rückverfolgbarkeit (Provenance).\n- Diversifizierung & hohes Margenprodukt-Management: Trockenbeerenauslese (9), Brut (16) — geringe Mengen, hoher Aufwand, individuelle Produktionsprozesse.\n- Direktvertrieb & Kundenbindung: verkostung (19), weingut-Besuch → einfache Buchungssysteme, CRM, E‑Commerce, POS-Lösungen.\n- Arbeitskräftemangel & Effizienz: mechanisierung/robotikbedarf, Ertragsprognosen, Automatisierung im Keller.\n- Klimarisiken & Anpassung: Reife-Verschiebungen, Frost, Trockenheit → Monitoring, frühe Warnsysteme, resistente Rebsorten & Bewässerungsmanagement.\n- Nachhaltigkeit & Zertifizierung: CO2-Reduktion, nachhaltige Bewirtschaftung als Marketing- und Regulierungsanforderung.\n\n6) Konkret empfohlenes Angebot / Value‑Propositionen für diese ICP\n- Für Winzer/Weingüter mit Fokus Riesling & Lagenwein:\n  - Angebot A: Precision-Viticulture-Paket (Drohnen-Mapping + Boden-/Feuchte-Sensoren + Dashboard) → besseres Lesemanagement, Qualitätssteigerung, Ertragsprognose.\n  - Angebot B: Keller-Optimierung & Analytik (In-line-Messgeräte, Gärsteuerung, Lab Support) → reproduzierbare Qualität für Erste/Grosse Lagen und Süßweine.\n  - Angebot C: DTC‑Accelerator (E‑Commerce-Integration, CRM, Wine‑Club-Tools, POS + Buchungsplattform für Verkostungen) → mehr Direktumsatz, bessere Kundenbindung.\n  - Angebot D: Steillage-Lösungen (Spezialmaschinen, Sicherheitslösungen, Seilkransysteme / Lesehilfen) → Arbeitserleichterung und Sicherheit.\n  - Angebot E: Nachhaltigkeits-/Traceability-Paket (CO2-Bilanzierung, QR‑Code-Provenance) → Marktvorteil im Premiumsegment.\n\n7) Vertriebs- und Ansprache-Empfehlungen (Personas, Kanäle, Botschaften)\n- Personas: Inhaber/Winzer (Winzer: 20), Kellermeister, Marketing-Verantwortliche. Entscheider sind praxisnah, qualitätsorientiert, jedoch kostenbewusst.\n- Botschaften: Betonung auf Terroir-Erhalt (terroir:15; mineralität:14), Qualitätssteigerung für Grosse Lagen/VDP-Ansprüche (vdp.erste/vdp.grosse), Reduktion manueller Arbeit in Steillagen (steillage:8), bessere DTC-Umsätze & Gästeerlebnis (verkostung:19; weingut:24).\n- Kanäle:\n  - Direkt: VDP-Netzwerk, Branchenverbände, regionale Winzerverbände, Veranstaltungen/Weinmessen.\n  - Content/SEO: Inhalte zu Riesling, Ortswein, Verkostung, Trockenbeerenauslese, Brut (nutze Keywords mit hoher Frequenz).\n  - Vor-Ort-Demos: Technologien in Muster-Weingütern, Feldtage in Steillagen, Verkostungs-Demos.\n  - Partnerschaften mit Beratungen & Maschinenbauern für Steillagen-Equipment.\n\n8) KPI-Vorschläge zur Erfolgsmessung bei Kundenprojekten\n- Qualitäts-KPIs: Anteil Grosse-Lagen-Abfüllungen, Weinbewertungen/Punkte, Sensor-basierte Reife-Zieltreffer.\n- Betriebs-KPIs: Reduktion manueller Lesetage, Erntezeitfenster, Kosten/ha.\n- Vertrieb-KPIs: DTC-Umsatzanteil, Conversion Rate Shop, Wine‑Club-Lifetime-Value, Buchungen für Verkostungen.\n- Nachhaltigkeit: CO2-Emissionen/hl, Wasserverbrauch/hl.\n\nSchlussbemerkung\nDie Stichwortverteilung zeigt ein klares Bild: Premium-orientierte deutsche Weingüter mit starkem Riesling- und Lagenfokus, die sowohl traditionelle handwerkliche Qualität als auch selektive Modernisierungen (Kellertechnik, Precision Viticulture, Digitalvertrieb) benötigen. Lösungen, die zugleich Terroir-sensitiv sind, Arbeitsprozesse in Steillagen adressieren und DTC-/Erlebnisumsatz steigern, treffen genau die Kernbedürfnisse dieser Zielgruppe.",
                    "type": "output_text",
                    "logprobs": [],
                    "annotations": []
                  }
                ]
              }
            ]
          },
          "pairedItem": {
            "item": 0
          }
        }
      ]
    },
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "12f39f7d-371e-464e-80fe-23ffdf6074e2",
    "connections": {
      "trim": {
        "main": [
          [
            {
              "node": "get_lookalikes",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "set_f2": {
        "main": [
          [
            {
              "node": "generate_icp_report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "sort_desc": {
        "main": [
          [
            {
              "node": "digest_terms_en",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "icp_report": {
        "main": [
          []
        ]
      },
      "sort_desc2": {
        "main": [
          [
            {
              "node": "digest_terms_de",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "merge_terms": {
        "main": [
          [
            {
              "node": "set_f2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Authorization": {
        "main": [
          [
            {
              "node": "Configuration",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Configuration": {
        "main": [
          [
            {
              "node": "Mock ICP Companies based on Implisense-ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "get_companies": {
        "main": [
          [
            {
              "node": "list_of_companies",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "serialize_ids": {
        "main": [
          [
            {
              "node": "trim",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter term.de": {
        "main": [
          [
            {
              "node": "sort_desc2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter term.en": {
        "main": [
          [
            {
              "node": "sort_desc",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Manual Trigger": {
        "main": [
          [
            {
              "node": "Authorization",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "get_lookalikes": {
        "main": [
          [
            {
              "node": "lookalikes_or_icp",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "digest_terms_de": {
        "main": [
          [
            {
              "node": "merge_terms",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "digest_terms_en": {
        "main": [
          [
            {
              "node": "merge_terms",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "list_of_companies": {
        "main": [
          []
        ]
      },
      "lookalikes_or_icp": {
        "main": [
          [
            {
              "node": "parse_term_features",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "get_companies",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "generate_icp_report": {
        "main": [
          [
            {
              "node": "icp_report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "parse_term_features": {
        "main": [
          [
            {
              "node": "Filter term.en",
              "type": "main",
              "index": 0
            },
            {
              "node": "Filter term.de",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Mock ICP Companies based on Implisense-ID": {
        "main": [
          [
            {
              "node": "serialize_ids",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "H7porcmXYj7StO23",
    "meta": {
      "instanceId": "35409808e3cc9dd8ecfa6f7b93ae931f074920a2f681e667da8974c0ecf81c52",
      "templateId": "2537",
      "templateCredsSetupCompleted": true
    },
    "name": "Generate Instagram Content from Top Trends with AI Image Generation",
    "tags": [],
    "nodes": [
      {
        "id": "8c49be2b-6320-4eb0-8303-6448ced34636",
        "name": "If media status is finished",
        "type": "n8n-nodes-base.if",
        "position": [
          1420,
          260
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "0304efee-33b2-499e-bad1-9238c1fc2999",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.status_code }}",
                "rightValue": "FINISHED"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "f0cc0be5-6d35-4334-a124-139fa8676d07",
        "name": "If media status is finished1",
        "type": "n8n-nodes-base.if",
        "position": [
          2000,
          260
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "0304efee-33b2-499e-bad1-9238c1fc2999",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.status_code }}",
                "rightValue": "PUBLISHED"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "c8d8d8cd-8501-4d1b-ac28-8cb3fa74d9d7",
        "name": "Telegram",
        "type": "n8n-nodes-base.telegram",
        "position": [
          1580,
          440
        ],
        "parameters": {
          "text": "Video upload edilmeden önce bir problem oldu",
          "chatId": "={{ $('Telegram Params').item.json.telegram_chat_id }}",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "GcIVVl98RcazYBaB",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "ae91a5e0-4f70-4a1c-afa5-41f5449facab",
        "name": "Telegram1",
        "type": "n8n-nodes-base.telegram",
        "position": [
          2160,
          100
        ],
        "parameters": {
          "text": "Instagram Content is shared",
          "chatId": "={{ $('Telegram Params').item.json.telegram_chat_id }}",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "GcIVVl98RcazYBaB",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "b8b38440-14a7-43f6-ac49-6ca9502ff54d",
        "name": "Telegram2",
        "type": "n8n-nodes-base.telegram",
        "position": [
          2160,
          440
        ],
        "parameters": {
          "text": "There was a problem when execution a upload content to instagram",
          "chatId": "={{ $('Telegram Params').item.json.telegram_chat_id }}",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "GcIVVl98RcazYBaB",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "82e0e5d0-bf50-4b2e-8693-2612dffe53e2",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          -1000,
          220
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "fb72beb1-1a6a-4148-9ee4-cdc564c4dc5c",
        "name": "Schedule Trigger1",
        "type": "n8n-nodes-base.scheduleTrigger",
        "position": [
          -3080,
          300
        ],
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "cronExpression",
                "expression": "5 13,19 * * *"
              }
            ]
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "470f3406-19d2-420c-8f33-7031237d882c",
        "name": "Telegram Params",
        "type": "n8n-nodes-base.set",
        "position": [
          -2320,
          300
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "d18cdca7-d301-4c70-a4d0-8d6e7ecfc2d1",
                "name": "telegram_chat_id",
                "type": "string",
                "value": ""
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "12971505-7061-4d32-8921-d2e731eae9db",
        "name": "Instagram params",
        "type": "n8n-nodes-base.set",
        "position": [
          -2560,
          300
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "1e380c14-e908-4eeb-90e0-957a422829d0",
                "name": "instagram_business_account_id",
                "type": "string",
                "value": ""
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "3cb5f27d-eb3b-4fdc-bb55-1b54f85298e5",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2860,
          20
        ],
        "parameters": {
          "color": 4,
          "width": 1000,
          "height": 600,
          "content": "## All Credentials You Need\n**  Instagram Business Account Id\n** Telegram Chat Id\n**  Rapid Api Key\n** Replicate Token"
        },
        "typeVersion": 1
      },
      {
        "id": "2bc617b8-835c-48ba-8de6-341a6c87b853",
        "name": "Rapid Api params",
        "type": "n8n-nodes-base.set",
        "notes": "test",
        "position": [
          -2080,
          300
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "48a33ec7-2b4f-496a-ad77-e4d5f1907ee4",
                "name": "x-rapid-api-key",
                "type": "string",
                "value": ""
              }
            ]
          }
        },
        "notesInFlow": false,
        "typeVersion": 3.4
      },
      {
        "id": "23bad41e-40ac-4488-8b2f-0d54d22a927a",
        "name": "filter the image content",
        "type": "n8n-nodes-base.code",
        "position": [
          -1480,
          380
        ],
        "parameters": {
          "jsCode": "const filteredData = $input.first().json.data.items.filter(item=> !item.is_video)\nreturn filteredData.map((item)=>{\n  return {\n    id: item.id,\n    prompt: item.caption.text,\n    content_code: item.code,\n    thumbnail_url: item.thumbnail_url,\n    tag: $input.first().json.data.additional_data.name\n  }\n})                                                                    \n\n"
        },
        "typeVersion": 2
      },
      {
        "id": "a65690cd-4d30-4541-b80d-aae872326a77",
        "name": "get  top trends on instagram #blender3d",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -1720,
          180
        ],
        "parameters": {
          "url": "https://instagram-scraper-api2.p.rapidapi.com/v1/hashtag",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "hashtag",
                "value": "blender3d"
              },
              {
                "name": "feed_type",
                "value": "top"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "x-rapidapi-host",
                "value": "instagram-scraper-api2.p.rapidapi.com"
              },
              {
                "name": "x-rapidapi-key",
                "value": "={{ $json['x-rapid-api-key'] }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "8707c475-7e28-4d80-92b8-ba24033c4632",
        "name": "get top trends on instagram #isometric",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -1720,
          380
        ],
        "parameters": {
          "url": "https://instagram-scraper-api2.p.rapidapi.com/v1/hashtag",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "hashtag",
                "value": "isometric"
              },
              {
                "name": "feed_type",
                "value": "top"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "x-rapidapi-host",
                "value": "instagram-scraper-api2.p.rapidapi.com"
              },
              {
                "name": "x-rapidapi-key",
                "value": "={{ $json['x-rapid-api-key'] }}"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "1c1bfd8f-b086-4147-ba08-578877f2a315",
        "name": "merge the array content",
        "type": "n8n-nodes-base.merge",
        "position": [
          -1280,
          280
        ],
        "parameters": {},
        "typeVersion": 3
      },
      {
        "id": "dcc2b6b6-9880-4676-8a1a-a3c21e583bba",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -3180,
          20
        ],
        "parameters": {
          "color": 3,
          "width": 280,
          "height": 600,
          "content": "## Schedule Your Time To  Post\n"
        },
        "typeVersion": 1
      },
      {
        "id": "c1e0ac33-c4b7-47d8-bd2b-0b74b02afe38",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2600,
          160
        ],
        "parameters": {
          "color": 5,
          "width": 180,
          "height": 300,
          "content": "## Guide \n** [Guide](https://docs.matillion.com/metl/docs/6957316//) of getting  of Instagram Business Account Id "
        },
        "typeVersion": 1
      },
      {
        "id": "321680da-ca7a-4c6f-98d4-a0d8f8d0347f",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2360,
          160
        ],
        "parameters": {
          "color": 5,
          "width": 180,
          "height": 300,
          "content": "## Guide \n** [Guide](https://rapidapi.com/i-yqerddkq0t/api/telegram92/tutorials/how-to-get-the-id-of-a-telegram-channel,-chat,-user-or-bot%3F) of Getting  of Telegram Chat Id "
        },
        "typeVersion": 1
      },
      {
        "id": "b3d07cf7-8d03-4644-88f7-2e94de0c43c2",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2120,
          160
        ],
        "parameters": {
          "color": 5,
          "width": 180,
          "height": 300,
          "content": "## Guide \n** [Guide](https://docs.rapidapi.com/docs/keys-and-key-rotation) of Getting  of Rapid Api Key "
        },
        "typeVersion": 1
      },
      {
        "id": "b6dbdfaa-fc71-4def-a723-bf6c0facd372",
        "name": "Sticky Note7",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2360,
          480
        ],
        "parameters": {
          "color": 7,
          "width": 180,
          "height": 120,
          "content": "## Warning\n**Don't forgot the create bot and send a message to bot first"
        },
        "typeVersion": 1
      },
      {
        "id": "81d598e2-8993-4315-9894-2e78dc26ad10",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1820,
          20
        ],
        "parameters": {
          "width": 660,
          "height": 600,
          "content": "## Getting Top Trend Posts On Instagram\n** Change the topic you want to get on http request"
        },
        "typeVersion": 1
      },
      {
        "id": "6beb79ef-8205-4882-9bb0-6a2e1a33f1d4",
        "name": "Check Data on Database Is Exist",
        "type": "n8n-nodes-base.postgres",
        "onError": "continueErrorOutput",
        "position": [
          -760,
          220
        ],
        "parameters": {
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "top_trends",
            "cachedResultName": "top_trends"
          },
          "where": {
            "values": [
              {
                "value": "={{$json.content_code}}",
                "column": "code"
              }
            ]
          },
          "schema": {
            "__rl": true,
            "mode": "list",
            "value": "public",
            "cachedResultName": "public"
          },
          "options": {},
          "operation": "select"
        },
        "credentials": {
          "postgres": {
            "id": "sBHQ2psBsfnHkFrZ",
            "name": "Postgres account"
          }
        },
        "typeVersion": 2.5,
        "alwaysOutputData": true
      },
      {
        "id": "5b0c05a8-3eb7-4ad8-88e8-ceef81fe7a61",
        "name": "If Data is Exist",
        "type": "n8n-nodes-base.if",
        "position": [
          -540,
          240
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "9dc20983-ae4d-40db-b969-7d43fa8b0c3e",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ !$json.isEmpty() }}",
                "rightValue": "we"
              },
              {
                "id": "0e1b9264-be56-4d0c-a83e-d9ca0b05b265",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "",
                "rightValue": ""
              }
            ]
          },
          "looseTypeValidation": true
        },
        "executeOnce": false,
        "typeVersion": 2.2,
        "alwaysOutputData": false
      },
      {
        "id": "557aa2c3-8d0b-42c4-b444-953a538d7ff4",
        "name": "Sticky Note9",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1120,
          20
        ],
        "parameters": {
          "width": 1060,
          "height": 600,
          "content": "## Looping Data And Checking For Is Exist On Database\n**We are checking until find a data we did not insert because we don't want to create content about in same content"
        },
        "typeVersion": 1
      },
      {
        "id": "9b510f11-9a44-4d54-b162-3ffb55d66677",
        "name": "send error message to telegram",
        "type": "n8n-nodes-base.telegram",
        "position": [
          -1000,
          440
        ],
        "parameters": {
          "text": "There was a problem execution a postgresql content",
          "chatId": "={{ $('Telegram Params').item.json.telegram_chat_id}}",
          "additionalFields": {}
        },
        "credentials": {
          "telegramApi": {
            "id": "GcIVVl98RcazYBaB",
            "name": "Telegram account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "48bc61de-d416-4673-9e9b-8331ea841891",
        "name": "insert data on db",
        "type": "n8n-nodes-base.postgres",
        "position": [
          -260,
          240
        ],
        "parameters": {
          "table": {
            "__rl": true,
            "mode": "list",
            "value": "top_trends",
            "cachedResultName": "top_trends"
          },
          "schema": {
            "__rl": true,
            "mode": "list",
            "value": "public"
          },
          "columns": {
            "value": {
              "tag": "={{$('Loop Over Items').item.json.tag}}",
              "code": "={{$('Loop Over Items').item.json.content_code}}",
              "prompt": "={{$('Loop Over Items').item.json.prompt}}",
              "isposted": false,
              "thumbnail_url": "={{$('Loop Over Items').item.json.thumbnail_url}}"
            },
            "schema": [
              {
                "id": "id",
                "type": "number",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "id",
                "defaultMatch": true,
                "canBeUsedToMatch": true
              },
              {
                "id": "prompt",
                "type": "string",
                "display": true,
                "required": true,
                "displayName": "prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "isposted",
                "type": "boolean",
                "display": true,
                "required": false,
                "displayName": "isposted",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "createdat",
                "type": "dateTime",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "createdat",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "updatedat",
                "type": "dateTime",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "updatedat",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "deletedat",
                "type": "dateTime",
                "display": true,
                "removed": true,
                "required": false,
                "displayName": "deletedat",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "code",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "code",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "tag",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "tag",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "thumbnail_url",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "thumbnail_url",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "credentials": {
          "postgres": {
            "id": "sBHQ2psBsfnHkFrZ",
            "name": "Postgres account"
          }
        },
        "typeVersion": 2.5
      },
      {
        "id": "15e7d69d-a10f-48a1-b240-046e9950d077",
        "name": "Analyze Image and give the content",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          80,
          240
        ],
        "parameters": {
          "text": "Create a clear and concise description of the object in the image, focusing on its physical and general features. Avoid detailed environmental aspects like background, lighting, or colors. Describe the shape, texture, size, and any unique characteristics of the object. Mention any notable features that make the object stand out, such as its surface details, materials, and design. The description should be focused on the object itself, not its surroundings.\n\nFor example, describe the following image:\n",
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "resource": "image",
          "imageUrls": "={{ $('Loop Over Items').item.json.thumbnail_url }}",
          "operation": "analyze"
        },
        "credentials": {
          "openAiApi": {
            "id": "1TwEayhZUT90fq8N",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "93e253b1-da7d-4193-b899-a38e6fd9f4e4",
        "name": "Analyze Content And Generate Instagram Caption",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          280,
          240
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini",
            "cachedResultName": "GPT-4O-MINI"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "=\nSummarize the following content description into a short, engaging Instagram caption under 150 words. The caption should focus on the content of the image, not the app. Keep it appealing to social media users, and highlight the visual details of the image. Include hashtags relevant to 3D modeling and design, such as #Blender3D, #3DArt, #DigitalArt, #3DModeling, and #ArtCommunity. Ensure the tone is friendly and inviting.\n\n\nContent description to summarize:\n{{ $json.content }}\n\nMake sure to craft the caption around the content's features, such as the color contrast, reflective surface, and artistic nature of the image.\n\n"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "1TwEayhZUT90fq8N",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "9af1dc59-1d9e-4900-8f80-1eba946c4057",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -20,
          20
        ],
        "parameters": {
          "color": 4,
          "width": 860,
          "height": 600,
          "content": "## Analyze Post Content\n** We are analyzing the image\n** We are generating a instagram caption by content\n** Then we are generating the image"
        },
        "typeVersion": 1
      },
      {
        "id": "2259f6df-dca9-4a7e-babb-e63375f7207f",
        "name": "Prepare data on Instagram",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          980,
          260
        ],
        "parameters": {
          "edge": "media",
          "node": "={{ $('Instagram params').item.json.instagram_business_account_id }}",
          "options": {
            "queryParameters": {
              "parameter": [
                {
                  "name": "image_url",
                  "value": "={{ $json.output[0] }}"
                },
                {
                  "name": "caption",
                  "value": "={{ $('Analyze Content And Generate Instagram Caption').item.json.message.content }}"
                }
              ]
            }
          },
          "graphApiVersion": "v20.0",
          "httpRequestMethod": "POST"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "ZFxxxLfZ25M7Va6r",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "bcbb6058-1966-4bb5-915a-1e65b9131117",
        "name": "Check Status Of Media Before Uploaded",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          1200,
          260
        ],
        "parameters": {
          "node": "={{ $json.id }}",
          "options": {
            "fields": {
              "field": [
                {
                  "name": "id"
                },
                {
                  "name": "status"
                },
                {
                  "name": "status_code"
                }
              ]
            }
          },
          "graphApiVersion": "v20.0"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "ZFxxxLfZ25M7Va6r",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "518d87ff-7808-4c06-b137-4e97d8f2ca28",
        "name": "Publish Media on Instagram",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          1600,
          100
        ],
        "parameters": {
          "edge": "media_publish",
          "node": "={{ $('Instagram params').item.json.instagram_business_account_id }}",
          "options": {
            "queryParameters": {
              "parameter": [
                {
                  "name": "creation_id",
                  "value": "={{ $json.id }}"
                }
              ]
            }
          },
          "graphApiVersion": "v20.0",
          "httpRequestMethod": "POST"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "ZFxxxLfZ25M7Va6r",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "a033d12b-524f-40e8-9208-5300bbc823d3",
        "name": "Check status of post ",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          1800,
          260
        ],
        "parameters": {
          "node": "={{ $('Check Status Of Media Before Uploaded').item.json.id }}",
          "options": {
            "fields": {
              "field": [
                {
                  "name": "id"
                },
                {
                  "name": "status"
                },
                {
                  "name": "status_code"
                }
              ]
            }
          },
          "graphApiVersion": "v20.0"
        },
        "credentials": {
          "facebookGraphApi": {
            "id": "ZFxxxLfZ25M7Va6r",
            "name": "Facebook Graph account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "f136e907-2938-4175-b51f-4201fbe3477d",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          880,
          20
        ],
        "parameters": {
          "color": 5,
          "width": 1580,
          "height": 600,
          "content": "## Publish On Instagram And Send Message When Published via Telegram\n"
        },
        "typeVersion": 1
      },
      {
        "id": "8145986c-5453-43ac-8d5c-c50a84a62136",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1800,
          100
        ],
        "parameters": {
          "color": 5,
          "width": 260,
          "height": 500,
          "content": "## For More About Api\n** [Facebook Scraper Api Guide](https://rapidapi.com/social-api1-instagram/api/instagram-scraper-api2/playground/apiendpoint_a45552b2-9850-4da9-b5cb-bbdd3ac2199d)"
        },
        "typeVersion": 1
      },
      {
        "id": "02416fbb-4250-4278-af23-1f9189787123",
        "name": "filter the image content-2",
        "type": "n8n-nodes-base.code",
        "position": [
          -1480,
          180
        ],
        "parameters": {
          "jsCode": "const filteredData = $input.first().json.data.items.filter(item=> !item.is_video)\nreturn filteredData.map((item)=>{\n  return {\n    id: item.id,\n    prompt: item.caption.text,\n    content_code: item.code,\n    thumbnail_url: item.thumbnail_url,\n    tag: $input.first().json.data.additional_data.name\n  }\n})                                                                    \n\n"
        },
        "typeVersion": 2
      },
      {
        "id": "2d1ea53d-1d32-4b86-8944-ce2ad4a69847",
        "name": "Sticky Note11",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2820,
          160
        ],
        "parameters": {
          "color": 5,
          "width": 180,
          "height": 300,
          "content": "## Guide \n** [Guide](https://replicate.com) of getting  of Replicate Token "
        },
        "typeVersion": 1
      },
      {
        "id": "c8b933af-356e-49ae-92d3-42eaf4ee3e9f",
        "name": "Replicate params",
        "type": "n8n-nodes-base.set",
        "position": [
          -2780,
          300
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "1e380c14-e908-4eeb-90e0-957a422829d0",
                "name": "replicate_token",
                "type": "string",
                "value": ""
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "2c73cc9c-d436-459b-9b3c-bd870810b9b4",
        "name": "Generate image on flux",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          680,
          260
        ],
        "parameters": {
          "url": "https://api.replicate.com/v1/models/black-forest-labs/flux-schnell/predictions",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"A highly detailed 3D isometric model of {{$('Analyze Image and give the content').item.json.content   .replace(/\\\\n/g, ' ') \n.replace(/\\\\t/g, ' ') \n.replace(/\\s+/g, ' ')\n.trim(); }} rendered in a stylized miniature toy aesthetic. Materials: Matte plastic/painted metal/weathered stone texture with no self-shadowing. Lighting: - Completely shadowless rendering - Ultra bright and perfectly even illumination from all angles - Pure ambient lighting without directional shadows - Flat, consistent lighting across all surfaces - No ambient occlusion. Style specifications: - Clean, defined edges and surfaces - Slightly exaggerated proportions - Miniature/toy-like scale - Subtle wear and texturing - Rich color palette with muted tones - Isometric 3/4 view angle - Crisp details and micro-elements. Technical details: - 4K resolution - PBR materials without shadows - No depth of field - High-quality anti-aliasing - Perfect uniform lighting. Environment: Pure white background with zero shadows or gradients. Post-processing: High key lighting, maximum brightness, shadow removal.\",\n    \"output_format\": \"jpg\",\n    \"output_quality\": 100,\n    \"go_fast\":false\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "=json",
          "bodyParameters": {
            "parameters": [
              {}
            ]
          },
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "=Bearer {{ $('Replicate params').item.json.replicate_token}}"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "6f9e7dc6-1287-4235-8631-198d729f367f",
        "name": "Sticky Note12",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1120,
          -340
        ],
        "parameters": {
          "color": 4,
          "width": 1060,
          "height": 320,
          "content": "## For top_trends Table\n```\nCREATE TABLE top_trends (\n    id SERIAL PRIMARY KEY,\n    isposted BOOLEAN DEFAULT false,\n    createdat TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n    updatedat TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n    deletedat TIMESTAMP WITHOUT TIME ZONE,\n    prompt TEXT NOT NULL,\n    thumbnail_url TEXT,\n    code TEXT,\n    tag TEXT\n);\n```"
        },
        "typeVersion": 1
      },
      {
        "id": "b19951bb-6346-44a7-a4c8-1bd0806c6019",
        "name": "Sticky Note13",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -660,
          -120
        ],
        "parameters": {
          "color": 3,
          "width": 160,
          "height": 120,
          "content": "## Warning\n** Don't forgot the create top_trends table"
        },
        "typeVersion": 1
      },
      {
        "id": "3de6b8e5-c5e0-4999-871a-c349cb9b3ac0",
        "name": "Sticky Note14",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -3180,
          -940
        ],
        "parameters": {
          "width": 620,
          "height": 840,
          "content": "\n## Automated Instagram Content Creation from Trending Posts\n\nThis workflow automates the process of discovering and recreating trending content on Instagram:\n\n1. Content Discovery:\n   - Scrapes top trending posts from specific hashtags (#blender3d, #isometric)\n   - Filters for image-only content (excludes videos)\n   - Checks database to avoid duplicate content\n\n2. AI-Powered Content Generation:\n   - Analyzes trending images using GPT-4 Vision\n   - Generates detailed descriptions of visual elements\n   - Creates engaging Instagram captions with relevant hashtags\n   - Uses Flux AI to generate similar but unique images\n\n3. Publishing & Monitoring:\n   - Automatically posts content to Instagram Business Account\n   - Monitors post status and publishing process\n   - Sends status updates via Telegram\n\nPerfect for content creators and businesses looking to maintain an active Instagram presence with AI-generated content inspired by current trends. The workflow runs on schedule and handles everything from content discovery to publication automatically.\n\nNote: Requires Instagram Business Account, Telegram Bot, OpenAI, and Replicate API credentials."
        },
        "typeVersion": 1
      },
      {
        "id": "dfd0d182-177c-4336-8950-4792ea739123",
        "name": "Sticky Note15",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2120,
          480
        ],
        "parameters": {
          "color": 7,
          "width": 180,
          "height": 120,
          "content": "##Warning\n** Dont forgot the subscribe [Instagram Scraper Api](https://rapidapi.com/social-api1-instagram/api/instagram-scraper-api2/playground/apiendpoint_a45552b2-9850-4da9-b5cb-bbdd3ac2199d)"
        },
        "typeVersion": 1
      },
      {
        "id": "03330941-3c6e-4152-8c51-f1d53f4424bc",
        "name": "Sticky Note16",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2120,
          640
        ],
        "parameters": {
          "width": 180,
          "height": 180,
          "content": "## Warning\n** You can check the  [rate limit](https://rapidapi.com/social-api1-instagram/api/instagram-scraper-api2) of the Instagram Scraper Api on Rapid Api\n** Free version is monthly 500 request\n"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "timezone": "Europe/Istanbul",
      "callerPolicy": "workflowsFromSameOwner",
      "executionOrder": "v1"
    },
    "versionId": "cc50f9e8-373b-433a-af43-824a264e762a",
    "connections": {
      "Telegram": {
        "main": [
          []
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Check Data on Database Is Exist",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Params": {
        "main": [
          [
            {
              "node": "Rapid Api params",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If Data is Exist": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "insert data on db",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Instagram params": {
        "main": [
          [
            {
              "node": "Telegram Params",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Rapid Api params": {
        "main": [
          [
            {
              "node": "get top trends on instagram #isometric",
              "type": "main",
              "index": 0
            },
            {
              "node": "get  top trends on instagram #blender3d",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Replicate params": {
        "main": [
          [
            {
              "node": "Instagram params",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger1": {
        "main": [
          [
            {
              "node": "Replicate params",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "insert data on db": {
        "main": [
          [
            {
              "node": "Analyze Image and give the content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check status of post ": {
        "main": [
          [
            {
              "node": "If media status is finished1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate image on flux": {
        "main": [
          [
            {
              "node": "Prepare data on Instagram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "merge the array content": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "filter the image content": {
        "main": [
          [
            {
              "node": "merge the array content",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Prepare data on Instagram": {
        "main": [
          [
            {
              "node": "Check Status Of Media Before Uploaded",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Publish Media on Instagram": {
        "main": [
          [
            {
              "node": "Check status of post ",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "filter the image content-2": {
        "main": [
          [
            {
              "node": "merge the array content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If media status is finished": {
        "main": [
          [
            {
              "node": "Publish Media on Instagram",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If media status is finished1": {
        "main": [
          [
            {
              "node": "Telegram1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Telegram2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Data on Database Is Exist": {
        "main": [
          [
            {
              "node": "If Data is Exist",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "send error message to telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analyze Image and give the content": {
        "main": [
          [
            {
              "node": "Analyze Content And Generate Instagram Caption",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Status Of Media Before Uploaded": {
        "main": [
          [
            {
              "node": "If media status is finished",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "get top trends on instagram #isometric": {
        "main": [
          [
            {
              "node": "filter the image content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "get  top trends on instagram #blender3d": {
        "main": [
          [
            {
              "node": "filter the image content-2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analyze Content And Generate Instagram Caption": {
        "main": [
          [
            {
              "node": "Generate image on flux",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "408f9fb9940c3cb18ffdef0e0150fe342d6e655c3a9fac21f0f644e8bedabcd9",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "ed993205-977a-43cd-8d0b-4faef216d766",
        "name": "Split Out",
        "type": "n8n-nodes-base.splitOut",
        "position": [
          360,
          -120
        ],
        "parameters": {
          "options": {},
          "fieldToSplitOut": "predictions"
        },
        "typeVersion": 1
      },
      {
        "id": "67f2bb16-ee38-4bc8-9cc7-50a44614cc3b",
        "name": "Imagen 3.0",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          140,
          -120
        ],
        "parameters": {
          "url": "https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict",
          "method": "POST",
          "options": {},
          "jsonBody": "={{\n{\n  \"instances\": [\n    {\n      \"prompt\": [\n        $json.candidates[0].content.parts[0].text,\n       `Generate the following image: ${$('Variables').first().json.targetPrompt}`\n      ].join(' ')\n    }\n  ],\n  \"parameters\": {\n    \"sampleCount\": $('Variables').first().json.numberSamples.toNumber()\n  }\n}\n}}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googlePalmApi"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "dSxo6ns5wn658r8N",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "b1730c97-8c5c-48a5-90cf-7940f6c9e2d0",
        "name": "Variables",
        "type": "n8n-nodes-base.set",
        "position": [
          -940,
          -120
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "7616f991-76d0-4dd0-9385-f08ed14e8dfa",
                "name": "sourceStyleUrl",
                "type": "string",
                "value": "={{ $json.SourceImage }}"
              },
              {
                "id": "126cb06e-4d69-4163-ba76-c694103bf5bb",
                "name": "targetPrompt",
                "type": "string",
                "value": "={{ $json.TargetPrompt }}"
              },
              {
                "id": "055d247b-586d-4bb8-a319-262c241df48c",
                "name": "numberSamples",
                "type": "string",
                "value": "={{\n(function(numSamples) {\n  if (!numSamples) return 1;\n  if (numSamples < 0) return 1;\n  if (numSamples > 4) return 4;\n  return numSamples;\n}($json['Number of Images']))\n}}"
              },
              {
                "id": "77a27e0e-24f4-4358-8cdc-84552be6c0b5",
                "name": "email",
                "type": "string",
                "value": "={{ $json['Your Email (Optional)'] }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "5c26062c-74cf-4140-8dcb-8688c8daec67",
        "name": "Download Image",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -620,
          -120
        ],
        "parameters": {
          "url": "={{ $json.sourceStyleUrl }}",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "20744adb-cdf5-4558-b6e6-4206d7c1f356",
        "name": "On form submission",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          -1400,
          -120
        ],
        "webhookId": "51f74db1-ffb4-491f-83b0-a44a7124be12",
        "parameters": {
          "options": {
            "path": "style-copy-with-imagen3",
            "ignoreBots": true,
            "buttonLabel": "Generate!",
            "appendAttribution": true
          },
          "formTitle": "Style Copy with Imagen 3.0",
          "formFields": {
            "values": [
              {
                "fieldLabel": "SourceImage",
                "placeholder": "The image URL to copy the style from",
                "requiredField": true
              },
              {
                "fieldLabel": "TargetPrompt",
                "placeholder": "The new image to generate",
                "requiredField": true
              },
              {
                "fieldType": "number",
                "fieldLabel": "Number of Images",
                "placeholder": "Default 1. Max. 4 images"
              },
              {
                "fieldType": "email",
                "fieldLabel": "Your Email (Optional)",
                "placeholder": "The results will be sent to this email"
              }
            ]
          },
          "responseMode": "lastNode",
          "formDescription": "Use this form to generate an image using another image as a style reference."
        },
        "typeVersion": 2.2
      },
      {
        "id": "917db247-1be3-4814-a96d-145957aa5db3",
        "name": "Form Validation",
        "type": "n8n-nodes-base.if",
        "position": [
          -1180,
          -120
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "1b440b81-06c9-4133-bfd2-8ec07c7c3734",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                },
                "leftValue": "={{ $json.SourceImage.isUrl() }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "65a8b617-318c-429a-b37e-45ead00dbb7e",
        "name": "Retry Form",
        "type": "n8n-nodes-base.form",
        "position": [
          -940,
          60
        ],
        "webhookId": "0b4c88ed-d28b-4df4-abe6-4579e17c672d",
        "parameters": {
          "options": {
            "formTitle": "Retry Submission",
            "buttonLabel": "Generate!",
            "formDescription": "Please enter a URL for the source image."
          },
          "formFields": {
            "values": [
              {
                "fieldLabel": "SourceImage",
                "placeholder": "The image URL to copy the style from",
                "requiredField": true
              },
              {
                "fieldLabel": "TargetPrompt",
                "placeholder": "The new image to generate",
                "requiredField": true
              },
              {
                "fieldType": "number",
                "fieldLabel": "Number of Images",
                "placeholder": "Max. 4 images"
              },
              {
                "fieldLabel": "Your Email (Optional)",
                "placeholder": "The results will be sent to this email"
              }
            ]
          },
          "limitWaitTime": true
        },
        "typeVersion": 1
      },
      {
        "id": "8a0e8dae-9f6f-488e-9977-fd89e885f30e",
        "name": "Upload to Cloudinary",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          880,
          -120
        ],
        "parameters": {
          "url": "https://api.cloudinary.com/v1_1/daglih2g8/image/upload",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendQuery": true,
          "contentType": "multipart-form-data",
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "file",
                "parameterType": "formBinaryData",
                "inputDataFieldName": "data"
              }
            ]
          },
          "genericAuthType": "httpQueryAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "upload_preset",
                "value": "n8n-workflows-preset"
              }
            ]
          }
        },
        "credentials": {
          "httpQueryAuth": {
            "id": "sT9jeKzZiLJ3bVPz",
            "name": "Cloudinary API"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "525725ea-effe-410b-8f39-ad01ae755d1a",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1480,
          -340
        ],
        "parameters": {
          "color": 7,
          "width": 760,
          "height": 640,
          "content": "## 1. Ask for Source Style and Target Image\n[Learn more about the Form Trigger](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.formtrigger/)\n\nWe'll use a form interface for this template which allows the users to specify an image whose style we'll use as reference and a prompt to generate the target image. Form validation loop can be achieved by combining another form node with the IF node."
        },
        "typeVersion": 1
      },
      {
        "id": "ba9d4bdc-b695-4acf-9593-2ce979053744",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -700,
          -340
        ],
        "parameters": {
          "color": 7,
          "width": 720,
          "height": 440,
          "content": "## 2. Visual Style Description using Gemini 2.0\n[Read more about Gemini Image Understanding](https://ai.google.dev/gemini-api/docs/image-understanding)\n\nThe trick to copying the style of an image is to get a multimodal LLM to describe it in detail. Using Gemini's image understanding capabilities, it can do a pretty good job to provide the comprehensive description we need."
        },
        "typeVersion": 1
      },
      {
        "id": "455f7956-6e39-4d84-af7e-d5908d4e5307",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          40,
          -340
        ],
        "parameters": {
          "color": 7,
          "width": 720,
          "height": 440,
          "content": "## 3. Image Generation using Imagen 3.0\n[Read more about Imagen Image Generation](https://ai.google.dev/gemini-api/docs/image-generation#imagen)\n\nTo generate the image, we'll be using Google's Imagen 3.0 model. We'll combine the visual style description generated in the previous Gemini model with the user's target image prompt and pass this to Imagen to do its magic! The result is something very close to style transfer which produces quite convincing and impressive results."
        },
        "typeVersion": 1
      },
      {
        "id": "0c1d5a7f-9102-4558-a830-ed558f72c086",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          780,
          -340
        ],
        "parameters": {
          "color": 7,
          "width": 980,
          "height": 600,
          "content": "## 4. Render Results to HTML Page\n[Learn more about the HTML node](https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.html)\n\nFinally for presentation, we'll render the generated images as a webpage for easier viewing using the HTML node. This page can then be sent to the user's email if provided and downloaded as a file once we land on the form ending node."
        },
        "typeVersion": 1
      },
      {
        "id": "ccc1ff65-0416-4dae-9557-ba2f98c5ac80",
        "name": "Convert to File1",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          1320,
          60
        ],
        "parameters": {
          "options": {
            "encoding": "utf8",
            "fileName": "={{ $('Variables').item.json.targetPrompt.toSnakeCase().urlEncode() }}.html"
          },
          "operation": "toText",
          "sourceProperty": "html"
        },
        "typeVersion": 1.1
      },
      {
        "id": "0252d373-3678-4851-819d-d36efb40dfb2",
        "name": "Generate HTML",
        "type": "n8n-nodes-base.html",
        "position": [
          1080,
          -120
        ],
        "parameters": {
          "html": "<h1>\n  {{ $('Variables').item.json.targetPrompt.toSentenceCase() }}\n</h1>\n<div class=\"gallery\">\n{{\n$input.all()\n  .chunk(2)\n  .map(row =>\n    `<div class=\"gallery-row\">\n      ${row.map(item =>\n        `<a href=\"${item.json.url}\" target=\"_blank\">\n          <img src=\"${item.json.url}\" width=\"320px\" height=\"240px\"  />\n        </a>`).join('')}\n    </div>`\n  ).join('')\n}}\n</div>\n<div class=\"fineprint\">\n  Generated by Imagen 3.0 (imagen-3.0-generate-002) @ {{ $now.format('d MMM yyyy') }}.\n</div>\n<div class=\"fineprint\">\n  <h3>Style Prompt</h3>\n  <div style=\"display:flex;gap: 10px;\">\n    <div>\n      <img\n        src=\"{{ $('Download Image').item.json.sourceStyleUrl }}\"\n        width=\"100px\"\n        height=\"auto\"\n      />\n    </div>\n    <div>\n      {{ $('Gemini 2.0').first().json.candidates[0].content.parts[0].text }}\n    </div>\n  </div>\n</div>\n<style>\n  body { padding: 32px 64px; font-family: sans-serif; background-color: #fffaf2; }\n  h1 { max-width: 640px; }\n  .gallery { display: inline-block; padding: 5px; border: 1px solid #ccc; background-color: white; margin-bottom: 32px;}\n  .gallery-row { display: flex; }\n  .gallery-row img { padding: 5px; background-color: white }\n  .gallery-row img:hover { background-color: orange; } \n  .fineprint { font-size: 0.7rem; max-width: 480px; text-align: justify;}\n  .fineprint h3 { font-size: 0.8rem; }\n</style>"
        },
        "executeOnce": true,
        "typeVersion": 1.2
      },
      {
        "id": "b712bd74-8615-4080-aad2-dc0b0df0b07e",
        "name": "Convert to File",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          580,
          -120
        ],
        "parameters": {
          "options": {
            "fileName": "={{ $execution.id }}_{{ $itemIndex }}.{{ $json.mimeType.split('/')[1] }}",
            "mimeType": "={{ $json.mimeType }}"
          },
          "operation": "toBinary",
          "sourceProperty": "bytesBase64Encoded"
        },
        "typeVersion": 1.1
      },
      {
        "id": "ee3e168a-038c-4524-93fc-ced5d4956fa1",
        "name": "Form Ending",
        "type": "n8n-nodes-base.form",
        "position": [
          1540,
          60
        ],
        "webhookId": "c4bacbac-0347-4c35-9333-3704630b45ef",
        "parameters": {
          "options": {
            "formTitle": "Generation Complete"
          },
          "operation": "completion",
          "respondWith": "returnBinary",
          "completionTitle": "Image Generation Successful",
          "completionMessage": "Download has started.\nOpen the HTML file to view results."
        },
        "executeOnce": true,
        "typeVersion": 1
      },
      {
        "id": "c4b1648a-c7d9-46cd-af28-527f9b169ab6",
        "name": "Has Email?",
        "type": "n8n-nodes-base.if",
        "position": [
          1320,
          -120
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "07d04523-f81a-4efa-b46a-cb640bcc608a",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $('Variables').item.json.email }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "bc0a8188-27ff-4834-9c7a-8760531f4252",
        "name": "Send Results to Email",
        "type": "n8n-nodes-base.gmail",
        "position": [
          1540,
          -120
        ],
        "webhookId": "de5684ed-6aa4-4c29-aac3-62e21c54c6f0",
        "parameters": {
          "sendTo": "={{ $('Variables').first().json.email }}",
          "message": "={{ $json.html }}",
          "options": {},
          "subject": "=#{{$execution.id}} - Image Generated Successfully!"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "Sf5Gfl9NiFTNXFWb",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "f18ab53b-d8e2-4625-a8f6-8b97959a15d1",
        "name": "Image to Base64",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          -400,
          -120
        ],
        "parameters": {
          "options": {},
          "operation": "binaryToPropery"
        },
        "typeVersion": 1
      },
      {
        "id": "ac6c1353-035c-4045-aed9-46285b757b98",
        "name": "Gemini 2.0",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -180,
          -120
        ],
        "parameters": {
          "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n    \"contents\": [{\n      \"parts\": [\n        {\n          \"inline_data\": {\n            \"mime_type\":\"{{ $('Download Image').item.binary.data.mimeType }}\",\n            \"data\": \"{{ $json.data }}\"\n          }\n        },\n        {\"text\": \"Describe the visual style of this image. Do not include any character names or IP in the description. Include names of any famous artists associated with this style if known.\"}\n      ]\n    }]\n  }",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googlePalmApi"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "dSxo6ns5wn658r8N",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "fae8c5f0-9d6f-4e45-8f7a-82f361bf9b1b",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1920,
          -840
        ],
        "parameters": {
          "width": 400,
          "height": 1140,
          "content": "## Try It Out!\n### This n8n template allows you to use AI to generate logos or images which mimic visual styles of other logos or images. The model used to generate the images is Google's Imagen 3.0.\n\nWith this template, users will be able to automate design and marketing tasks such as creating variants of existing designs, remixing existing assets to validate different styles and explore a range of designs which would have been otherwise too expensive and time-consming previously.\n\n### How it works\n* A form trigger is used to capture the source image to reference styles from and a prompt for the target image to generate.\n* The source image is passed to Gemini 2.0 to be analysed and its visual style and tone extracted as a detailed description.\n* This visual style description is then combined with the user's initial target image prompt. This final prompt is given to Imagen 3.0 to generate the images.\n* A quick webpage is put together with the generated images to present back to the user.\n* If the user provided an email address, a copy of this HTML page will be sent.\n\n### How to use\n* Ensure the workflow is live to share the form publicly.\n* The source image must be accessible to your n8n instance - either a public image of the internet or within your network.\n\n### Requirements\n* Gemini for LLM and Imagen model.\n* Cloudinary for image CDN.\n* Gmail for email sending.\n\n### Customising this workflow\n* Feel free to swap any of these out for tools and services you prefer.\n* Want to fully automate? Switch the form trigger for a webhook trigger!\n\n\n### Need Help?\nJoin the [Discord](https://discord.com/invite/XPKeKXeB7d) or ask in the [Forum](https://community.n8n.io/)!\n\nHappy Hacking!"
        },
        "typeVersion": 1
      }
    ],
    "pinData": {},
    "connections": {
      "Split Out": {
        "main": [
          [
            {
              "node": "Convert to File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Variables": {
        "main": [
          [
            {
              "node": "Download Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Gemini 2.0": {
        "main": [
          [
            {
              "node": "Imagen 3.0",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Has Email?": {
        "main": [
          [
            {
              "node": "Send Results to Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Imagen 3.0": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Retry Form": {
        "main": [
          [
            {
              "node": "Form Validation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate HTML": {
        "main": [
          [
            {
              "node": "Convert to File1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Has Email?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Image": {
        "main": [
          [
            {
              "node": "Image to Base64",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File": {
        "main": [
          [
            {
              "node": "Upload to Cloudinary",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Form Validation": {
        "main": [
          [
            {
              "node": "Variables",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Retry Form",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Image to Base64": {
        "main": [
          [
            {
              "node": "Gemini 2.0",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File1": {
        "main": [
          [
            {
              "node": "Form Ending",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "On form submission": {
        "main": [
          [
            {
              "node": "Form Validation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload to Cloudinary": {
        "main": [
          [
            {
              "node": "Generate HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Results to Email": {
        "main": [
          []
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "c183420d8f91eb7b8146210a7d0ff4f32c285295a74632083589c1f225eab33f",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "5533972c-f840-4961-81a4-785762ef1a8b",
        "name": "Main Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1504,
          480
        ],
        "parameters": {
          "width": 350,
          "height": 596,
          "content": "# Instant Ad Banner Generator\n\nThis workflow generates professional marketing banners from a simple text description using **Gemini** (for prompt engineering) and **Nano Banana Pro** (for high-quality image generation).\n\n### How it works\n1. **Input:** Receives a product/concept via LINE.\n2. **Optimization:** Gemini creates a detailed marketing prompt.\n3. **Generation:** Submits job to Nano Banana Pro and polls for completion.\n4. **Delivery:** Hosts image on S3 and sends to LINE.\n\n### Setup Steps\n1. **Credentials:** Add LINE, Google Gemini, AWS S3, and Kie.ai (Header Auth).\n2. **S3:** Ensure your bucket has public read access.\n3. **Webhook:** Add the URL to LINE Developers console."
        },
        "typeVersion": 1
      },
      {
        "id": "93b12061-dd75-43b6-99e7-e56c22cfd58a",
        "name": "Check Job Status",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          272,
          608
        ],
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "options": {},
          "sendQuery": true,
          "sendHeaders": true,
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $json.data.taskId }}"
              },
              {
                "name": "recordId",
                "value": "={{ $json.data.recordId }}"
              }
            ]
          },
          "headerParameters": {
            "parameters": [
              {}
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "4b92ebb6-7294-4ee3-9353-829dc8485797",
        "name": "Sticky Note ",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1056,
          480
        ],
        "parameters": {
          "color": 7,
          "width": 680,
          "height": 345,
          "content": "## 1. Receive & Refine\n1. Extract text from LINE webhook.\n2. Use Gemini to optimize prompt for Japanese marketing.\n3. Generate professional, marketing-focused image prompt."
        },
        "typeVersion": 1
      },
      {
        "id": "d988d7fb-355f-4c83-aaa9-7cfbfb568b58",
        "name": "Sticky Note 4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -272,
          480
        ],
        "parameters": {
          "color": 7,
          "width": 1260,
          "height": 345,
          "content": "## 2. Async Generation (Nano Banana)\n1. Submit task to Nano Banana Pro (via Kie API).\n2. Wait loop (10s) to allow processing.\n3. Check status and extract the final Image URL."
        },
        "typeVersion": 1
      },
      {
        "id": "d3a2aeb0-7802-4f47-ba67-43673ef0c675",
        "name": "Sticky Note 5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1088,
          480
        ],
        "parameters": {
          "color": 7,
          "width": 420,
          "height": 345,
          "content": "## 3. Host & Deliver\n1. Download the generated image.\n2. Upload to AWS S3 (Public Read).\n3. Push the image back to the user via LINE."
        },
        "typeVersion": 1
      },
      {
        "id": "6c48da33-6903-4e33-aeba-f0a4acf8f90f",
        "name": "LINE Webhook1",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -992,
          608
        ],
        "webhookId": "25a8c9af-04b8-4aed-af1a-7b20768a4a01",
        "parameters": {
          "path": "banner-v7158-2025",
          "options": {},
          "httpMethod": "POST"
        },
        "typeVersion": 1
      },
      {
        "id": "59e827d9-884e-4541-af6a-79b5e511110e",
        "name": "Extract Data1",
        "type": "n8n-nodes-base.code",
        "position": [
          -800,
          608
        ],
        "parameters": {
          "jsCode": "// LINE Webhook parsing\nconst body = items[0].json.body;\n\nif (!body.events || !Array.isArray(body.events) || !body.events[0]) {\n  throw new Error(\"No LINE events found\");\n}\n\nconst event = body.events[0];\n\nreturn [\n  {\n    json: {\n      replyToken: event.replyToken,\n      userId: event.source.userId,\n      message: event.message.text,\n      timestamp: event.timestamp\n    }\n  }\n];"
        },
        "typeVersion": 1
      },
      {
        "id": "8176325c-3932-46e6-b444-b81983b65a1a",
        "name": "Optimize Prompt (Marketing)1",
        "type": "@n8n/n8n-nodes-langchain.googleGemini",
        "position": [
          -624,
          608
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "models/gemini-2.0-flash-lite",
            "cachedResultName": "models/gemini-2.0-flash-lite"
          },
          "options": {},
          "messages": {
            "values": [
              {
                "content": "\"You are an expert Marketing Creative Director for Japanese market.\\nThe user will send you details for an ad banner in Japanese (Product, Target Audience, Catch Copy).\\nYour goal is to write a highly detailed English prompt for Nano Banana Pro (Gemini 3 Pro Image).\\n\\nIMPORTANT RULES:\\n1. Analyze the target audience and suggest appropriate color palette, mood, and design style.\\n2. Describe the visual composition with clear space for text overlay.\\n3. Include the specific Japanese Catch Copy text, instructing to render it clearly and legibly.\\n4. Specify camera angle, lighting, product placement, and overall aesthetic.\\n5. Keep the prompt focused and under 500 characters for optimal generation.\\n6. Output ONLY the English prompt text, nothing else - no explanations, no meta-commentary.\\n7. NEVER use double quotes (\\\") in your response. Use 'single quotes' or [brackets] for emphasis instead.\\n\\nExample format:\\n'Professional product photography, [product description], featuring Japanese text [キャッチコピー] in bold modern font, [composition details], [lighting style], [color palette], negative space for additional text, high quality, 8K resolution'\\n\\nRemember: Output ONLY the prompt text, nothing before or after. NO DOUBLE QUOTES.\""
              },
              {
                "content": "={{ $json.message }}"
              }
            ]
          },
          "jsonOutput": true
        },
        "credentials": {
          "googlePalmApi": {
            "id": "sGfYTgXsOfbcVUJz",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "afeff72b-2245-489b-b474-8890a6a0b519",
        "name": "Submit to Nano Banana Pro1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -48,
          608
        ],
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/createTask",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"model\": \"nano-banana-pro\",\n  \"input\": {\n    \"prompt\": \"{{ $json.prompt }}\",\n    \"aspect_ratio\": \"1:1\",\n    \"resolution\": \"2K\",\n    \"output_format\": \"png\"\n  }\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "typeVersion": 4.1
      },
      {
        "id": "9acb497c-6dd9-416d-b7c0-d0d6ad88e83a",
        "name": "Wait1",
        "type": "n8n-nodes-base.wait",
        "position": [
          112,
          608
        ],
        "webhookId": "e48c85c3-d325-4c5f-ae29-68bbe55233aa",
        "parameters": {
          "amount": 10
        },
        "typeVersion": 1.1
      },
      {
        "id": "6a134248-2a3a-4762-9301-901439a79dee",
        "name": "Wait for Generation1",
        "type": "n8n-nodes-base.wait",
        "position": [
          448,
          608
        ],
        "webhookId": "1ada122b-d2bb-4211-9c9f-40ed3718b3df",
        "parameters": {
          "unit": "seconds",
          "amount": 10
        },
        "typeVersion": 1
      },
      {
        "id": "e76b16dd-a29a-4c68-a5e1-caa7131dfb59",
        "name": "Parse Result1",
        "type": "n8n-nodes-base.code",
        "position": [
          608,
          608
        ],
        "parameters": {
          "jsCode": "// Parse response and extract image URL\nconst response = items[0].json;\nconst data = Array.isArray(response) ? response[0] : response;\n\nif (data.code === 200 && data.data) {\n  const taskData = data.data;\n  \n  if (taskData.state === 'success') {\n    let imageUrl = null;\n    try {\n      const resultData = JSON.parse(taskData.resultJson);\n      const resultUrls = resultData.resultUrls || [];\n      if (resultUrls.length > 0) {\n        imageUrl = resultUrls[0];\n      }\n    } catch (e) {\n      throw new Error('Failed to parse resultJson');\n    }\n    \n    if (imageUrl) {\n      return [{\n        json: {\n          imageUrl: imageUrl,\n          taskId: taskData.taskId,\n          status: 'completed'\n        }\n      }];\n    }\n  } else if (taskData.state === 'fail') {\n    throw new Error(`Image generation failed: ${taskData.failMsg}`);\n  } else {\n    // Loop back if processing\n    return [{\n        json: { status: 'processing' }\n    }];\n  }\n}"
        },
        "typeVersion": 1
      },
      {
        "id": "a6645fa5-60f1-408c-8bad-a4e055a3a2f6",
        "name": "Download Image1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          800,
          608
        ],
        "parameters": {
          "url": "={{ $json.imageUrl }}",
          "options": {
            "response": {
              "response": {
                "responseFormat": "file"
              }
            }
          }
        },
        "typeVersion": 4.1
      },
      {
        "id": "75005330-f777-42e3-8d26-4ccc31dbee8d",
        "name": "Upload to S",
        "type": "n8n-nodes-base.awsS3",
        "position": [
          1120,
          608
        ],
        "parameters": {
          "fileName": "={{ 'banner-' + Date.now() + '.png' }}",
          "operation": "upload",
          "bucketName": "banners-bot-v7158",
          "additionalFields": {}
        },
        "credentials": {
          "aws": {
            "id": "R7OJvkAL58EKcirN",
            "name": "AWS account"
          }
        },
        "typeVersion": 2
      },
      {
        "id": "1cdb695f-37cd-48a9-9aba-c3d59a401ec9",
        "name": "HTTP Request2",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1312,
          608
        ],
        "parameters": {
          "url": "https://api.line.me/v2/bot/message/reply",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n \"replyToken\": \"{{ $('LINE Webhook').item.json.body.events[0].replyToken }}\",\n  \"messages\": [\n    {\n      \"type\": \"image\",\n      \"originalContentUrl\": \"{{ $('Upload to S3').item.json.Location }}\",\n      \"previewImageUrl\": \"{{ $('Upload to S3').item.json.Location }}\"\n    }\n  ]\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer YOUR_TOKEN_HERE"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "009e3f6b-aabe-4516-8820-ceea578b31aa",
        "name": "Code1",
        "type": "n8n-nodes-base.code",
        "position": [
          -224,
          608
        ],
        "parameters": {
          "jsCode": "// Extract the actual prompt text from Gemini's response\nconst response = items[0].json;\n\nlet promptText = \"\";\n\n// Check if we have the content structure from Gemini\nif (response.content && response.content.parts && response.content.parts[0]) {\n  let text = response.content.parts[0].text;\n  \n  // Parse the JSON array if it's a string\n  try {\n    const parsed = JSON.parse(text);\n    // If it's an array, get the first element\n    if (Array.isArray(parsed) && parsed.length > 0) {\n      promptText = parsed[0];\n    } else if (typeof parsed === 'string') {\n      promptText = parsed;\n    } else {\n      promptText = text; // Use as is if not parseable\n    }\n  } catch (e) {\n    // If JSON parsing fails, clean the text manually\n    promptText = text\n      .replace(/^\\[|\\]$/g, '') // Remove brackets\n      .replace(/^[\"']|[\"']$/g, '') // Remove quotes\n      .replace(/\\\\n/g, '') // Remove newlines\n      .trim();\n  }\n}\n\n// Clean any remaining escape characters\npromptText = promptText.replace(/\\\\\"/g, '\"').trim();\n\nreturn [{\n  json: {\n    prompt: promptText,\n    userId: $('Extract Data').item.json.userId,\n    taskId: response.taskId || null\n  }\n}];"
        },
        "typeVersion": 2
      }
    ],
    "pinData": {},
    "connections": {
      "Code1": {
        "main": [
          [
            {
              "node": "Submit to Nano Banana Pro1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "Check Job Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload to S": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Data1": {
        "main": [
          [
            {
              "node": "Optimize Prompt (Marketing)1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "LINE Webhook1": {
        "main": [
          [
            {
              "node": "Extract Data1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Result1": {
        "main": [
          [
            {
              "node": "Download Image1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Image1": {
        "main": [
          [
            {
              "node": "Upload to S",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Job Status": {
        "main": [
          [
            {
              "node": "Wait for Generation1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Generation1": {
        "main": [
          [
            {
              "node": "Parse Result1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Submit to Nano Banana Pro1": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Optimize Prompt (Marketing)1": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "oJXYeAsW2fEXu2CM",
    "meta": {
      "instanceId": "12e5a503aaef0455553650326ab2eb200725340cc32343152db18828f7239580",
      "templateCredsSetupCompleted": true
    },
    "name": "LinkedIn Post To Personalized Opener",
    "tags": [],
    "nodes": [
      {
        "id": "4cc7a4e7-aeb1-4eae-a73e-a6106d8a126b",
        "name": "Try This Example",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          580,
          580
        ],
        "parameters": {
          "width": 480,
          "height": 600,
          "content": "**Test with this (Copy & Paste):**\n\nAuthor: Shakira Johhson\n\nCompany: Apple\n\nPost:\n\nJust closed our Series B! 🚀 \n\nHonestly didn't think we'd get here 2 years ago when we were bootstrapping in my garage. Now we're scaling our AI workflow automation to help 10,000+ businesses.\n\nShoutout to the team who believed in the vision when it was just sketches on a whiteboard. This is just the beginning.\n\n#TechCorp #SeriesB #AI #Automation\n\n**You'll get something like this:**\n\n\"Came across your post on LinkedIn - from garage sketches to Series B is incredible, and the 10,000+ businesses you're helping with AI automation shows the real impact.\"\n\n**Pro tips:**\n- Use recent posts (last 30 days)\n- Longer posts = better personalization\n- Company updates work best\n- Achievement posts are gold"
        },
        "typeVersion": 1
      },
      {
        "id": "8f299bd9-fbee-4933-8646-a9c654eb8ffd",
        "name": "What This Does",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1420,
          140
        ],
        "parameters": {
          "width": 400,
          "height": 560,
          "content": "**What this does:**\n\n1. Fill out the form with LinkedIn post\n2. AI reads it like a human would\n3. Creates personalized opener\n4. You get copy-ready result\n\n**Why it works:**\n- References specific details\n- Sounds natural, not robotic\n- Shows you actually read their content\n- Builds instant credibility\n\n**Perfect for:**\n- Sales reps\n- Business development\n- Agency outreach\n- Partnership building\n\n**Setup:**\n1. Add OpenAI API key (Or, just use free n8n OpenAI credits)\n2. Test with example\n3. Start personalizing\n\nThat's it."
        },
        "typeVersion": 1
      },
      {
        "id": "538a0c40-6292-460b-a12c-914ad5443e4b",
        "name": "Output & Next Steps",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1420,
          980
        ],
        "parameters": {
          "width": 400,
          "height": 280,
          "content": "**Where to find your output:**\n\nClick on \"Format Output\" node after running the workflow.\n\nYou'll see:\n- **opener**: Your personalized email opener\n- **prospect**: The person's name\n- **company**: Their company name\n- **next_steps**: What to do next\n- **tips**: Email best practices\n\n**Save your results:**\n- Connect Google Sheets node\n- Add to your CRM\n- Send to email tool\n- Log in database\n\n**Make it yours:**\n- Edit the AI prompt for your industry\n- Add more form fields\n- Connect to your tools\n- Batch process multiple posts\n\n**Pro tip:** The output is structured JSON - easy to connect to any tool you use."
        },
        "typeVersion": 1
      },
      {
        "id": "1f9660c3-8a4d-4b0a-b0cb-0fb9335f236f",
        "name": "Why This Works",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2060,
          740
        ],
        "parameters": {
          "width": 400,
          "height": 140,
          "content": "** Further connect to your tools:**\n- Google Sheets for logging\n- CRM for prospect data\n- Email tools for sending\n- Slack for notifications"
        },
        "typeVersion": 1
      },
      {
        "id": "4e7c2e84-5451-4946-9a37-cf98db194729",
        "name": "Format Output",
        "type": "n8n-nodes-base.code",
        "position": [
          1840,
          760
        ],
        "parameters": {
          "jsCode": "// Get AI response and original data\nconst aiResponse = $input.first().json;\nconst originalData = $('Process Input').first().json;\n\n// Extract the personalized opener\nconst opener = aiResponse.message?.content || aiResponse.text || \"Something went wrong. Try again.\";\n\n// Clean up the opener\nconst cleanOpener = opener\n  .replace(/^\"|\"$/g, '')\n  .replace(/^'|'$/g, '')\n  .trim();\n\n// Create final response\nconst response = {\n  success: true,\n  opener: cleanOpener,\n  prospect: originalData.first_name,\n  company: originalData.company_name,\n  next_steps: [\n    \"1. Copy the opener above\",\n    \"2. Add your value prop (2-3 sentences max)\",\n    \"3. Include clear CTA\",\n    \"4. Send it\"\n  ],\n  tips: [\n    \"Keep total email under 100 words\",\n    \"Send Tuesday-Thursday, 8-10am\",\n    \"Follow up in 3-5 days if no response\",\n    \"Personalize the subject line too\"\n  ]\n};\n\nreturn { json: response };"
        },
        "typeVersion": 2
      },
      {
        "id": "7470a3f6-f7cb-455c-b8c1-82a87d2a0e05",
        "name": "AI Magic",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "position": [
          1500,
          760
        ],
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o-mini"
          },
          "options": {
            "maxTokens": 150,
            "temperature": 0.8
          },
          "messages": {
            "values": [
              {
                "content": "You are an elite B2B sales expert who crafts personalized cold email openers that get responses.\n\nYour specialty: Taking LinkedIn posts and creating openers that feel like they came from someone who actually READ and UNDERSTOOD the content.\n\nRules:\n- Reference specific details, metrics, or insights from the post\n- Sound like a human, not a bot\n- Show genuine interest in their work/achievement\n- Avoid generic praise (\"great post\", \"inspiring\", \"amazing\")\n- Be conversational but professional\n- Focus on what makes this post unique\n\nComplete this sentence: \"Came across your post on LinkedIn - \"\n\nMake it feel like you're genuinely interested in what they shared, not just trying to sell them something.\n\nExamples of what works:\n- \"Came across your post on LinkedIn - going from 5 to 50 employees in 18 months while maintaining 98% customer satisfaction is seriously impressive execution.\"\n- \"Came across your post on LinkedIn - the insight about AI replacing tasks, not jobs, really resonates with what we're seeing in manufacturing right now.\"\n- \"Came across your post on LinkedIn - bootstrapping to $2M ARR without external funding while building a distributed team is exactly the kind of scrappy growth I respect.\"\n\nOutput ONLY the completed sentence."
              },
              {
                "content": "=LinkedIn Post:\n{{ $json.post_content }}\n\nAuthor: {{ $json.first_name }}\nCompany: {{ $json.company_name }}"
              }
            ]
          }
        },
        "credentials": {
          "openAiApi": {
            "id": "xru46lVnSA70vTec",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.8
      },
      {
        "id": "7948c914-c9c3-4675-993c-51cb0c7f8979",
        "name": "LinkedIn Post Form",
        "type": "n8n-nodes-base.formTrigger",
        "position": [
          1140,
          760
        ],
        "webhookId": "6fbe076d-b99c-4dea-8575-ec53ad0a6e0a",
        "parameters": {
          "path": "6fbe076d-b99c-4dea-8575-ec53ad0a6e0a",
          "options": {},
          "formTitle": "LinkedIn Post Opener Generator",
          "formFields": {
            "values": [
              {
                "fieldLabel": "Author's First Name",
                "requiredField": true
              },
              {
                "fieldLabel": "Company Name",
                "requiredField": true
              },
              {
                "fieldType": "textarea",
                "fieldLabel": "LinkedIn Post Content",
                "requiredField": true
              }
            ]
          },
          "formDescription": "Paste any LinkedIn post and get a personalized cold email opener that actually sounds human."
        },
        "typeVersion": 2.1
      },
      {
        "id": "506fae22-1567-46be-8e74-263a5b4a1f84",
        "name": "Process Input",
        "type": "n8n-nodes-base.code",
        "position": [
          1320,
          760
        ],
        "parameters": {
          "jsCode": "// Get form data\nconst firstName = $json['Author\\'s First Name']?.trim();\nconst companyName = $json['Company Name']?.trim();\nconst postContent = $json['LinkedIn Post Content']?.trim();\n\n// Validate input\nif (!firstName || !companyName || !postContent) {\n  throw new Error('All fields are required');\n}\n\nif (postContent.length < 50) {\n  throw new Error('Post too short. Need at least 50 characters for good personalization.');\n}\n\n// Clean the post content\nconst cleanedPost = postContent\n  .replace(/\\s+/g, ' ')\n  .replace(/[\\r\\n]+/g, ' ')\n  .trim();\n\nreturn {\n  json: {\n    first_name: firstName,\n    company_name: companyName,\n    post_content: cleanedPost,\n    timestamp: new Date().toISOString()\n  }\n};"
        },
        "typeVersion": 2
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "c2d342d7-3f02-41e5-95bd-cea679b53bee",
    "connections": {
      "AI Magic": {
        "main": [
          [
            {
              "node": "Format Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Process Input": {
        "main": [
          [
            {
              "node": "AI Magic",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "LinkedIn Post Form": {
        "main": [
          [
            {
              "node": "Process Input",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "45e293393b5dd8437fb351e5b1ef5511ef67e6e0826a1c10b9b68be850b67593",
      "templateCredsSetupCompleted": true
    },
    "nodes": [
      {
        "id": "ad859b3e-dc9e-4016-b9c5-3585eb2fb43e",
        "name": "When clicking ‘Execute workflow’",
        "type": "n8n-nodes-base.manualTrigger",
        "position": [
          -240,
          -100
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "cb022f15-5f65-4e14-885e-ab394c3b56ef",
        "name": "Aggregate",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          820,
          -80
        ],
        "parameters": {
          "include": "specifiedFields",
          "options": {},
          "aggregate": "aggregateAllItemData",
          "fieldsToInclude": "searchResult",
          "destinationFieldName": "results"
        },
        "typeVersion": 1
      },
      {
        "id": "b358d396-0a34-41fe-9b54-038b0e8256d8",
        "name": "Only People Links",
        "type": "n8n-nodes-base.filter",
        "position": [
          620,
          -80
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "39ff27fa-4a6a-4c30-9775-bdb9f4395eed",
                "operator": {
                  "type": "string",
                  "operation": "regex"
                },
                "leftValue": "={{ $json.searchResult.url }}",
                "rightValue": "^https:\\/\\/www\\.linkedin\\.com\\/in\\/[a-zA-Z0-9\\-_%]+\\/?$"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "7b52cb25-50bf-4398-96d5-ee38dc978576",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          -240
        ],
        "parameters": {
          "color": 6,
          "width": 840,
          "height": 400,
          "content": "## Get Person Profile data from LinkedIn\n- Apify => Google search for \"{{ First Name }} {{ Last Name }} {{ Company }} site:linkedin.com\"\n- Does a RegEx to filter people pages (assumes the first result is correct - won't work for John Smith @ Walmart)\n- Apify => Fetch matched LinkedIn Person URL"
        },
        "typeVersion": 1
      },
      {
        "id": "3d49a9fb-1a85-4bf1-9d82-5afa85b7dc2b",
        "name": "Aggregate1",
        "type": "n8n-nodes-base.aggregate",
        "position": [
          1000,
          500
        ],
        "parameters": {
          "include": "specifiedFields",
          "options": {},
          "aggregate": "aggregateAllItemData",
          "fieldsToInclude": "searchResult",
          "destinationFieldName": "results"
        },
        "typeVersion": 1
      },
      {
        "id": "0d529556-abca-44ee-8f59-35d7c0458a38",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          200
        ],
        "parameters": {
          "color": 6,
          "width": 1300,
          "height": 520,
          "content": "## Get Company Profile data from LinkedIn\n- Apify => Google search for {{ Company }} site:linkedin.com\n- Does a RegEx to filter company pages (assumes the first result is correct)\n- Apify => Fetch matched LinkedIn Company URL"
        },
        "typeVersion": 1
      },
      {
        "id": "5f9cda61-14be-4af2-aa7c-442ca90d7941",
        "name": "Get LinkedIn Person",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          1000,
          0
        ],
        "parameters": {
          "url": "https://api.apify.com/v2/acts/apimaestro~linkedin-profile-detail/run-sync-get-dataset-items",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "username",
                "value": "={{ $json.results.first().searchResult.url }}"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "memory",
                "value": "4096"
              },
              {
                "name": "timeout",
                "value": "180"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "bJQWEiMA9ceXQW5s",
            "name": "Header Auth account"
          }
        },
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "id": "8b725ed1-8595-4cf2-80d4-fadb5e2a344e",
        "name": "Only Company Links",
        "type": "n8n-nodes-base.filter",
        "position": [
          820,
          500
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "39ff27fa-4a6a-4c30-9775-bdb9f4395eed",
                "operator": {
                  "type": "string",
                  "operation": "regex"
                },
                "leftValue": "={{ $json.searchResult.url }}",
                "rightValue": "^https:\\/\\/www\\.linkedin\\.com\\/company\\/[a-zA-Z0-9\\-_%]+\\/?$"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "bf62897a-7f7c-45dc-b142-dd34f30a0a09",
        "name": "Current Company Exists?",
        "type": "n8n-nodes-base.if",
        "position": [
          400,
          360
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "b762cbba-c2eb-4bf3-95b2-783d59ad862a",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "={{ $json.basic_info.current_company_url }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "20b6b7d5-4082-4f38-a596-7c36fa46020d",
        "name": "Google Search for Company LinkedIn",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          620,
          500
        ],
        "parameters": {
          "url": "https://api.apify.com/v2/acts/apify~rag-web-browser/run-sync-get-dataset-items",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "query",
                "value": "={{\n`${$json['Company']} site:linkedin.com`\n}}"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "memory",
                "value": "4096"
              },
              {
                "name": "timeout",
                "value": "180"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "bJQWEiMA9ceXQW5s",
            "name": "Header Auth account"
          }
        },
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "id": "425bb1e7-6fa3-46f7-91b1-137d76c27a50",
        "name": "Google Search for Person LinkedIn",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          420,
          -80
        ],
        "parameters": {
          "url": "https://api.apify.com/v2/acts/apify~rag-web-browser/run-sync-get-dataset-items",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "query",
                "value": "={{\n`${$json['First Name']} ${$json['Last Name']} ${$json['Company']} site:linkedin.com`\n}}"
              },
              {
                "name": "maxResults",
                "value": "={{Number(10)}}"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "memory",
                "value": "4096"
              },
              {
                "name": "timeout",
                "value": "180"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "bJQWEiMA9ceXQW5s",
            "name": "Header Auth account"
          }
        },
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "id": "e72d6c81-2bb8-4d10-86f3-51dabae509c9",
        "name": "Get LinkedIn Company",
        "type": "n8n-nodes-base.httpRequest",
        "onError": "continueRegularOutput",
        "position": [
          1460,
          560
        ],
        "parameters": {
          "url": "https://api.apify.com/v2/acts/apimaestro~linkedin-company-detail/run-sync-get-dataset-items",
          "method": "POST",
          "options": {},
          "sendBody": true,
          "sendQuery": true,
          "authentication": "genericCredentialType",
          "bodyParameters": {
            "parameters": [
              {
                "name": "identifier",
                "value": "={{ [$json.company_url] }}"
              }
            ]
          },
          "genericAuthType": "httpHeaderAuth",
          "queryParameters": {
            "parameters": [
              {
                "name": "memory",
                "value": "4096"
              },
              {
                "name": "timeout",
                "value": "180"
              }
            ]
          }
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "bJQWEiMA9ceXQW5s",
            "name": "Header Auth account"
          }
        },
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "id": "fe92e0aa-7b45-4355-81ec-5a7531816637",
        "name": "Get Leads",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -40,
          -100
        ],
        "parameters": {
          "options": {},
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-_4LR9HEyqSlg85zcyAXm3tkOW_ip9JzpsVfQu2hQuI/edit#gid=0",
            "cachedResultName": "Leads / Unprocessed"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "1-_4LR9HEyqSlg85zcyAXm3tkOW_ip9JzpsVfQu2hQuI",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1-_4LR9HEyqSlg85zcyAXm3tkOW_ip9JzpsVfQu2hQuI/edit?usp=drivesdk",
            "cachedResultName": "Outreach Bot"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "04iXS2lwUVyzn6F2",
            "name": "Google Sheets account"
          }
        },
        "typeVersion": 4.6
      },
      {
        "id": "562dab6b-7aeb-436c-8573-821f330c55c5",
        "name": "Set Company URL",
        "type": "n8n-nodes-base.set",
        "position": [
          1200,
          340
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "={\n  \"company_url\": \"{{ $json.basic_info.current_company_url }}\"\n}\n"
        },
        "typeVersion": 3.4
      },
      {
        "id": "3b1f1c2a-1c7b-4419-8954-99ab719f1a15",
        "name": "Set Company URL1",
        "type": "n8n-nodes-base.set",
        "position": [
          1200,
          500
        ],
        "parameters": {
          "mode": "raw",
          "options": {},
          "jsonOutput": "={\n  \"company_url\": \"{{ $json.results.first().searchResult.url }}\"\n}\n"
        },
        "typeVersion": 3.4
      },
      {
        "id": "a0802c94-1b9c-44bf-a454-5a17ec5d0a85",
        "name": "Generate Personalized Email",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          560,
          900
        ],
        "parameters": {
          "text": "=INPUT:\n\nPerson:\n\n{{ $('Get LinkedIn Person').item.json.toJsonString() }}\n\nCompany:\n\n {{ $('Get LinkedIn Company').item.json.toJsonString() }}",
          "batching": {},
          "messages": {
            "messageValues": [
              {
                "message": "=## Context\n\nYour name is Dolly, you are an AI Agent. \n\nThis is important, you'll have to introduce and refer to yourself as you're \"Dolly, {{$json.company_name}}'s lifecycle marketing agent\". \n\nYour task is to send cold emails on behalf of {{$json.company_name}}.\n\nYour email address is {{$json.email_address}}.\n\nHere is some detailed information about {{ $json.company_name }} and the services they offer:\n\n{{ $json.company_info }}\n\n## Email Composing Guidelines:\n\nOwn and be true to your personality. \n\n1. Be Very Concise: Write short, snappy emails. Write as you're almost in a rush. \n\n2. Be funny: You're an AI stand-up comedian with humor coded into your algorithms—a blend of wit, absurdity, and sarcasm inspired by cosmic comedy. Your jokes are universal and accessible to all, without insider references. Give us your best routine where every line hits, every pun lands, and the only thing dry is the martini in the front row.\n\n3. Personalise your subject line, it should invite the user to open the email\n\n4. Casual, Simple Language: Use casual language as if you're in a rush. Write at a below 4th-grade reading level to ensure simplicity and ease of understanding.\n\n5. Personalized Opening: Start with a personalized opening that ties directly into the rest of the email.\n\n6. Prioritize Relevance: Focus on information most relevant to the user, especially how the AI tool can simplify their job and make it more efficient in the future.\n\n7. Format all links in emails as Markdown: place the visible text in square brackets followed by the URL in parentheses, like this: [link](https://link.examplelink.com/bzajkas/booking-link)\n\n\n## Email personalization process:\n\nGo beyond basic personalization by incorporating specific insights about the recipient's recent projects, achievements, interests, or challenges. Avoid simply mentioning past roles or companies where they worked. Instead, demonstrate a genuine understanding of their work to make the email truly relevant and valuable to them.\n\n1. Craft the Short Opening Sentence:\n\nUse specific details from user research to create a personalized and relevant opening. This must be relevant to the jobs to be done. \n\nConnect the opening to the user's jobs to be done, role, achievements, or interests.\n\n2. Bridge to the Key Theme of the Email Touch:\n\nEnsure the opening sentence flows naturally into the key theme of the email touch.\n\n3. Share the Key Theme of the Email Touch:\n\nShare the key theme of the email touch in a way that directly addresses the user’s needs or pain points.\n\nHighlight specific benefits.\n\n4. Include a Brief Self-Introduction:\n\nIntroduce yourself and your role.\n\nMention that you've done some research with limited information but are still learning.\n\n5. Show Off Your Research:\n\nMention key research details that support why you talk about the key theme of the email touch.\n\nProvide details that only someone who conducted in-depth research would know about the user or their company.\n\n6. Explain the Purpose:\n\nState that you're providing the key theme of the email touch to help the user achieve their goals faster.\n\nRelate the key theme to their work and how it can free up time for other interests or priorities.\n\n7. Encourage Engagement:\n\nPrompt the user to take action, by logging in to {{$json.company_name}}'s platform and build something extremely useful in 2 minutes. \n\nKeep the tone friendly and helpful.\n\n## Expected Input\n\nYou will be given extensive JSON data of a particular lead + the company that they work for.\n\n## Expected Output\n\nYou should return an email addressed to the prospective client, demonstrating personalization and direct relevance to what they are doing.\n\nYou should return your output as JSON data with fields for \"subject\" and \"body\", wrapped in an output field, so that we can use an output parser.\n\nDo not include anything else in your answer than the output JSON.\n\n## Examples\n\n### Input\n\nINPUT:\n\nPerson:\n\n{\"basic_info\":{\"fullname\":\"Adam Janes\",\"first_name\":\"Adam\",\"last_name\":\"Janes\",\"headline\":\"Fractional CTO | Building with AI workflows and automations\",\"public_identifier\":\"adamjanes\",\"profile_picture_url\":\"\",\"about\":\"I am a product-minded technologist with hacker DNA building things in AI automation. \\n\\nI have a broad and varied background - having worked in Product, Design, and Sales - combined with deep technical experience as a Senior Developer and Fractional CTO.\\n\\nI am also a best-selling Udemy instructor (with 25K+ students), and founder of WOOFCODE - a free coding camp for fullstack developers.\\n\\nI practice non-violent communication, motivational interviewing, and Tibetan Buddhist meditation.\\n\\nAlways looking to connect with potential co-conspirators with shared passions.\",\"location\":{\"country\":\"\",\"city\":\"Australia\",\"full\":\"Australia\"},\"creator_hashtags\":[],\"is_creator\":false,\"is_influencer\":false,\"is_premium\":true,\"created_timestamp\":1393120240313,\"show_follower_count\":true,\"background_picture_url\":\"https://media.licdn.com/dms/image/v2/C4E16AQFUpJWxCZhi-A/profile-displaybackgroundimage-shrink_350_1400/profile-displaybackgroundimage-shrink_350_1400/0/1517432943755?e=1756944000&v=beta&t=QpBGsEjoTvATlwih5Jxl9lO9-p1UAnK7BoZKhdzzwxw\",\"urn\":\"ACoAABNTxV4BdKmdnmW6F6m8PX0lEsqaJ7cS6m0\",\"follower_count\":2159,\"connection_count\":1880,\"current_company\":\"MISSION+\",\"current_company_urn\":\"14626762\",\"current_company_url\":\"https://www.linkedin.com/company/missionplus\"},\"experience\":[{\"title\":\"Fractional CTO\",\"company\":\"Mission\",\"description\":\"Mission Plus is a digital innovation studio that works with world renowned and emerging companies to execute their tech innovation initiatives, from idea to build and launch.\\n\\nMy role involves scoping projects on technical level, planning sprints, and managing a remote and distributed engineering team.\\n\\nProjects worked on include BCG FinTech Control Tower, Blue Fire AI, and Verity Nature.\",\"duration\":\"Dec 2020 - Present · 4 yrs 8 mos\",\"start_date\":{\"year\":2020,\"month\":\"Dec\"},\"is_current\":true,\"company_linkedin_url\":\"https://www.linkedin.com/company/14626762/\",\"company_logo_url\":\"https://media.licdn.com/dms/image/v2/C560BAQF2wc70vBeJ0A/company-logo_400_400/company-logo_400_400/0/1675063711821/missionplus_logo?e=1756944000&v=beta&t=g2UpLFVNXKrEPi0exGgSHOxxkjusxf2GZchRIEKUsg4\",\"employment_type\":\"Plus\",\"company_id\":\"14626762\"},{\"title\":\"Course Instructor\",\"company\":\"Udemy\",\"description\":\"I teach an online video course on data visualization in D3.js. \\\"Mastering data visualization in D3.js\\\" takes students from knowing nothing about D3, to a level where they can build almost any visualization by themselves, using the world's premier data visualization library.\\n\\nThe course includes over 6 hours of video content introducing the D3 library. I produced these videos myself, using my knowledge of D3 to design the curriculum. The course includes 4 class projects, which become increasingly advanced, allowing students to test out their skills with real-world data.\\n\\nAs a course instructor, I help students with questions and concerns about their learning experience, and actively promote D3 as a tool for data visualization.\",\"duration\":\"Oct 2017 - Present · 7 yrs 10 mos\",\"start_date\":{\"year\":2017,\"month\":\"Oct\"},\"is_current\":true,\"company_linkedin_url\":\"https://www.linkedin.com/company/822535/\",\"company_logo_url\":\"https://media.licdn.com/dms/image/v2/D560BAQEf_NHzN2yVQg/company-logo_400_400/company-logo_400_400/0/1723593046388/udemy_logo?e=1756944000&v=beta&t=z05fW1PIaYe4shr5_-0KrTbHxV0VfUlFI2aBqJ5BLFo\",\"company_id\":\"822535\"},{\"title\":\"Founder\",\"company\":\"WOOFCODE\",\"description\":\"I ran a donation-only course over Zoom, teaching the fundamentals of full-stack web development \\n\\nI ran a live Zoom lecture once per week, and gave students various homework assignments to complete on their own time. The course lasted for 10 weeks, covering HTML, CSS, JavaScript, React, and Node.js/Express.\",\"duration\":\"Sep 2020 - Dec 2021 · 1 yr 4 mos\",\"start_date\":{\"year\":2020,\"month\":\"Sep\"},\"end_date\":{\"year\":2021,\"month\":\"Dec\"},\"is_current\":false,\"company_linkedin_url\":\"https://www.linkedin.com/company/70443428/\",\"company_logo_url\":\"https://media.licdn.com/dms/image/v2/C4D0BAQER2FPH0fKsQA/company-logo_400_400/company-logo_400_400/0/1630522713341?e=1756944000&v=beta&t=waDfmiECn6_hK6IKxA3A9ZdcQcA_huTBXl5Y8MBHbbc\",\"company_id\":\"70443428\"},{\"title\":\"Fellow\",\"company\":\"Dalarub\",\"location\":\"Berlin Metropolitan Area\",\"description\":\"Dalarub & Ettrich is a tech consultancy, primarily offering virtual CTO and virtual VP of Engineering services to clients across many industries. \\n\\nI worked in a small team alongside former CTOs of HERE Technologies, TrollTech and Airmap, and served as the company's Head of Frontend Engineering. My role involved building our own products, augmenting the engineering teams of our clients, and conducting technical interviews for Senior NodeJS and React developers.\",\"duration\":\"Sep 2019 - Jun 2020 · 10 mos\",\"start_date\":{\"year\":2019,\"month\":\"Sep\"},\"end_date\":{\"year\":2020,\"month\":\"Jun\"},\"is_current\":false,\"company_linkedin_url\":\"https://www.linkedin.com/company/14799700/\",\"company_logo_url\":\"https://media.licdn.com/dms/image/v2/C4D0BAQG7Pwuj9KSlrA/company-logo_400_400/company-logo_400_400/0/1630525805847?e=1756944000&v=beta&t=HfQbSEQXwz0M3oHUTnJj4D5B9GKZ3MRih5LsRvhweck\",\"employment_type\":\"& Ettrich\",\"company_id\":\"14799700\"},{\"title\":\"Co-Founder\",\"company\":\"F35\",\"location\":\"Berlin Metropolitan Area\",\"description\":\"F35 aimed to indivudualize HR processes so that people feel a sense of meaning and connection at work. We made \\\"personality cards\\\" for teams, and offered workshops to help team members better understand and empathise with each other.\",\"duration\":\"Apr 2019 - Sep 2019 · 6 mos\",\"start_date\":{\"year\":2019,\"month\":\"Apr\"},\"end_date\":{\"year\":2019,\"month\":\"Sep\"},\"is_current\":false,\"company_linkedin_url\":\"https://www.linkedin.com/company/14068012/\",\"company_logo_url\":\"https://media.licdn.com/dms/image/v2/C4D0BAQHQwk4J6uvitQ/company-logo_400_400/company-logo_400_400/0/1636291746650/f35_logo?e=1756944000&v=beta&t=P8nONmjFkSWXRxy3cFrSYJyJ51b7l36wwYyOwQTynn4\",\"company_id\":\"14068012\"}],\"education\":[{\"school\":\"Harvard University\",\"degree\":\"Bachelor’s Degree, Economics / Computer Science\",\"degree_name\":\"Bachelor’s Degree\",\"field_of_study\":\"Economics / Computer Science\",\"duration\":\"2012 - 2016\",\"school_linkedin_url\":\"https://www.linkedin.com/company/1646/\",\"activities\":\"4-year member of the men's heavyweight crew team.\",\"school_logo_url\":\"https://media.licdn.com/dms/image/v2/C4E0BAQF5t62bcL0e9g/company-logo_400_400/company-logo_400_400/0/1631318058235?e=1756944000&v=beta&t=neDLC3VojnXUN8BUWBVez6McqxniGoh7fYK1ucl1z_0\",\"start_date\":{\"year\":2012},\"end_date\":{\"year\":2016},\"school_id\":\"1646\"},{\"school\":\"University of Oxford\",\"degree\":\"Master of Philosophy - MPhil, Tibetan and Himalayan Studies\",\"degree_name\":\"Master of Philosophy - MPhil\",\"field_of_study\":\"Tibetan and Himalayan Studies\",\"duration\":\"Sep 2023 - Jun 2025\",\"school_linkedin_url\":\"https://www.linkedin.com/company/4477/\",\"description\":\"Finished the first year of a 2-year Master's program\",\"school_logo_url\":\"https://media.licdn.com/dms/image/v2/D4E0BAQGnc4qXLbE8Sg/company-logo_400_400/company-logo_400_400/0/1709206435851/oxforduni_logo?e=1756944000&v=beta&t=-RaTxjhDFM4J3ruMg1f0ueU6NBoKq923iFAn4PbRHbI\",\"start_date\":{\"year\":2023,\"month\":\"Sep\"},\"end_date\":{\"year\":2025,\"month\":\"Jun\"},\"school_id\":\"4477\"}],\"certifications\":[{\"name\":\"Credential of Readiness, Pass with High Honors\",\"issuer\":\"Harvard Business School Online\",\"issued_date\":\"Issued Jul 2014\"}],\"languages\":[{\"language\":\"English\",\"proficiency\":\"Native or bilingual proficiency\"},{\"language\":\"German\",\"proficiency\":\"Limited working proficiency\"}]}\n\nCompany:\n\n {\"input_identifier\":\"https://www.linkedin.com/company/missionplus\",\"basic_info\":{\"name\":\"MISSION+\",\"universal_name\":\"missionplus\",\"description\":\"We build great products and help companies develop their engineering culture, empowering the visionaries of today with the freedom to build.\",\"website\":\"http://mission.plus\",\"linkedin_url\":\"https://www.linkedin.com/company/missionplus/\",\"specialties\":[\"Custom Development\",\"Dev Team Augmentation\",\"Tech Team for Hire\",\"Rapid Prototyping\",\"Design Thinking\",\"Fintech\",\"Insurtech\",\"Digital Transformation Sprint\",\"CTO\",\"Fractional CTO\"],\"industries\":[\"Computer Software\"],\"is_verified\":false,\"founded_info\":{\"year\":2019,\"month\":null,\"day\":null},\"page_type\":\"COMPANY\",\"verification\":{\"is_verified\":false,\"last_verified_at\":null}},\"stats\":{\"employee_count\":35,\"follower_count\":2223,\"employee_count_range\":{\"start\":51,\"end\":200},\"student_count\":null},\"locations\":{\"headquarters\":{\"country\":\"SG\",\"state\":\"Singapore\",\"city\":\"Singapore\",\"postal_code\":\"068914\",\"line1\":\"160 Robinson Road, #14-04\",\"line2\":null,\"is_hq\":true,\"description\":null},\"offices\":[{\"country\":\"HK\",\"state\":null,\"city\":\"Hong Kong\",\"postal_code\":null,\"line1\":\"No 1 Glenealy Tower\",\"line2\":\"2A, 17/F\",\"is_hq\":false,\"description\":null,\"region\":\"Hong Kong\"},{\"country\":\"SG\",\"state\":\"Singapore\",\"city\":\"Singapore\",\"postal_code\":\"068914\",\"line1\":\"160 Robinson Road, #14-04\",\"line2\":null,\"is_hq\":true,\"description\":null,\"region\":\"Singapore\"}],\"geo_coordinates\":{\"latitude\":22.421183,\"longitude\":114.1661}},\"media\":{\"logo_url\":\"https://media.licdn.com/dms/image/v2/C560BAQF2wc70vBeJ0A/company-logo_400_400/company-logo_400_400/0/1675063711821/missionplus_logo?e=1756944000&v=beta&t=g2UpLFVNXKrEPi0exGgSHOxxkjusxf2GZchRIEKUsg4\",\"cover_url\":\"https://media.licdn.com/dms/image/v2/D561BAQFTuV6ifmJvtQ/company-background_10000/B56ZXnrzamHEAU-/0/1743348775238/missionplus_cover?e=1752303600&v=beta&t=AVi2oE9qtcsxzfpTsY9-XOA3Pky46e5Nr_12IrmVyXI\",\"cropped_cover_url\":\"https://media.licdn.com/dms/image/v2/D563DAQFsFLkLnLSFfA/image-scale_191_1128/B56ZXnrzaaGQAk-/0/1743348775069/missionplus_cover?e=1752303600&v=beta&t=h0i5DryCAyFg1o-4BTA670nnMm40H7yM1TIvyLDW5r4\"},\"funding\":{\"total_rounds\":null,\"latest_round\":{\"type\":\"\",\"date\":null,\"url\":\"\",\"investors_count\":null},\"crunchbase_url\":\"\"},\"links\":{\"website\":\"http://mission.plus\",\"linkedin\":\"https://www.linkedin.com/company/missionplus/\",\"job_search\":\"https://www.linkedin.com/jobs/search?geoId=92000000&f_C=14626762\",\"sales_navigator\":null,\"crunchbase\":\"\"},\"company_urn\":\"14626762\"}\n\nOutput:\n\n[\n  {\n    \"output\": {\n      \"subject\": \"Automate your legal workflows like your Udemy D3 wizardry\",\n      \"body\": \"Hey Adam,\\n\\nJust stumbled across your D3.js course on Udemy (25K+ students? Impressive!) and your work as a Fractional CTO at Mission+. As someone bringing AI automation to innovative companies, I bet you're drowning in those repetitive tasks that eat up valuable time.\\n\\nI'm Dolly, AAAutomations's lifecycle marketing agent. We help legal professionals automate mundane tasks with n8n - think document generation, client onboarding, and syncing case notes across systems. All that toggle-switching between apps? Gone!\\n\\nGiven your technical background and hacker DNA (plus teaching experience), you'd probably appreciate our approach - we don't just hand you rigid templates. Our n8n-based systems give you full control and privacy consciousness. Perfect for someone who can teach 6+ hours of D3.js!\\n\\nCould save you hours weekly while reducing human error. Want to see how? Reply with \\\"Show me the automation\\\" and I'll share how it works.\\n\\nCheers,\\nDolly\\nAAAutomations\"\n    }\n  }\n]"
              }
            ]
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.7
      },
      {
        "id": "24c40f62-d345-477d-b8ae-a56b37f8df5a",
        "name": "OpenRouter Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "position": [
          560,
          1060
        ],
        "parameters": {
          "model": "anthropic/claude-3.7-sonnet",
          "options": {}
        },
        "credentials": {
          "openRouterApi": {
            "id": "ipzDVYsZqbum9bX4",
            "name": "OpenRouter account 2"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "6b3dc07d-0eb0-4017-b2d6-698b81996578",
        "name": "Gmail",
        "type": "n8n-nodes-base.gmail",
        "position": [
          900,
          1060
        ],
        "webhookId": "29b60782-4d89-4463-bd85-9b358c41f3f3",
        "parameters": {
          "sendTo": "={{ $('Get Leads').item.json.Email }}",
          "message": "={{ $json.output.body }}",
          "options": {
            "replyTo": "={{ $('Set Data').item.json.email_address }} ",
            "senderName": "={{ $('Set Data').item.json.sender_name }}",
            "appendAttribution": false
          },
          "subject": "={{ $json.output.subject }}",
          "emailType": "text"
        },
        "credentials": {
          "gmailOAuth2": {
            "id": "aXTuNMJaYuKFOKTa",
            "name": "Gmail account"
          }
        },
        "typeVersion": 2.1
      },
      {
        "id": "141db351-ecd4-42ea-92f0-0f5645c00e26",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          380,
          760
        ],
        "parameters": {
          "color": 6,
          "width": 720,
          "height": 460,
          "content": "## Write + Send the email\n- SET YOUR DATA HERE\n- LLM drafts your email\n- Send the enail from your Gmail account"
        },
        "typeVersion": 1
      },
      {
        "id": "ed19dc93-966d-431d-b13a-2cba3c5d8e63",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          160,
          880
        ],
        "parameters": {
          "width": 190,
          "height": 220,
          "content": "## Set your data\nSet data about your company here so that the bot will customize your offer based on your lead."
        },
        "typeVersion": 1
      },
      {
        "id": "1ea7f29d-393f-4631-9dc7-ab37f1d93188",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          720,
          1060
        ],
        "parameters": {
          "jsonSchemaExample": "{\n\t\"subject\": \"Bet you're tired of toggling between apps while managing MISSION+ tech projects\",\n\t\"body\": \"Adam,\\n\\nThe irony of being a Fractional CTO is real - you help others automate while probably juggling 17 tabs, 3 project management tools, and enough notifications to make your phone vibrate off the table. Been there!\\n\\nI noticed your work at MISSION+ involves managing remote engineering teams across multiple fintech projects like BCG FinTech Control Tower. I'm betting there are repetitive tasks eating up your time that could be automated.\\n\\nI'm Dolly, AAAutomations's lifecycle marketing agent. We build custom automations specifically for technical leaders like you who need to streamline operations and reduce human error. \\n\\nOur specialty? Using n8n (open-source automation tool) to connect literally any software you use - perfect for someone managing distributed teams across multiple projects. We can automate everything from document generation to deadline tracking across systems.\\n\\nUnlike rigid no-code platforms, we build deeply customized workflows that evolve with your needs - either fully managed by us or with coaching so you can learn to modify them yourself.\\n\\nCurious what tasks we could automate for you? I'd love to chat about your specific workflow challenges.\\n\\nCheers,\\nDolly\\n\\nP.S. When you're not being a tech wizard, do you find time to practice Tibetan Buddhist meditation between managing those engineering teams? Impressive balance!\"\n}"
        },
        "typeVersion": 1.2
      },
      {
        "id": "89554e8e-5516-4341-bf52-2c9c834bda29",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          180,
          -100
        ],
        "parameters": {
          "options": {}
        },
        "typeVersion": 3
      },
      {
        "id": "d6fd7250-7536-48f6-9add-cf60af83f141",
        "name": "Set Data",
        "type": "n8n-nodes-base.set",
        "position": [
          400,
          900
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "ffbf5f38-71e1-48cb-a1ff-8103616e2887",
                "name": "company_name",
                "type": "string",
                "value": "AAAutomations"
              },
              {
                "id": "bb214147-4456-4224-9ae1-1af71aad7a7d",
                "name": "email_address",
                "type": "string",
                "value": "hello@aaautomations.com"
              },
              {
                "id": "3d1b7e87-1004-4a20-98b0-257fc5059fff",
                "name": "company_info",
                "type": "string",
                "value": "At AAAutomations, we help legal professionals streamline their operations, save hours each week, and reduce human error by introducing powerful, tailor-made automations into their daily practice. We specialize in building automations with n8n, a robust and flexible open-source automation tool that connects virtually any software system you use — from document management and CRM platforms to e-signature tools, calendars, and client portals.\n\nWhether you're a solo practitioner or part of a large law firm, chances are you're spending too much time on repetitive admin. Think about tasks like:\n\nSorting incoming emails and attachments\n\nGenerating templated documents\n\nManaging client onboarding steps\n\nSyncing case notes across systems\n\nTracking deadlines and reminders\n\nCollecting signed contracts or forms\n\nLogging billable time across platforms\n\nWe can automate all of that — and much more.\n\nInstead of toggling between half a dozen apps or worrying about missed follow-ups, AAAutomations builds smart systems that do the work for you behind the scenes. You stay focused on what matters: serving your clients, building your cases, and practicing law.\n\nBuilt with n8n. Built for you.\nn8n is our weapon of choice because it’s privacy-conscious, endlessly adaptable, and gives you full control of your data. Unlike no-code platforms with rigid templates, n8n gives us (and you, if you want to learn) the power to create deeply customized automations that evolve with your business. Whether you host it yourself or let us manage everything for you, your workflows are always yours.\n\nLearn Automation Yourself — Or Let Us Handle It All\nSome lawyers prefer to hand off the tech and focus on the law. Others are curious and want to understand the nuts and bolts. At AAAutomations, we welcome both.\n\nWe offer done-for-you automation services, from scoping your processes to building and maintaining them. But we also have a growing community of automation-curious professionals, including other lawyers, tech-savvy assistants, and operational staff. We run live workshops, offer 1:1 coaching, and maintain a library of pre-built workflows to help you get started. If you’ve ever wanted to “learn to automate,” this is a great place to do it.\n\nWhy Legal Professionals Choose Us\nDeep respect for confidentiality and compliance\n\nCustom workflows that integrate with legal-specific tools\n\nOngoing support and optimization — we don’t just hand it over and disappear\n\nA friendly community of others learning the same skills\n\nAutomation isn't just a nice-to-have — it's rapidly becoming a competitive advantage in the legal industry. You don’t need to overhaul your systems. You just need to connect them.\n\nLet AAAutomations make your systems work for you — not the other way around."
              },
              {
                "id": "f81f8de9-7d03-4e95-90a7-18b2a1fa73ad",
                "name": "sender_name",
                "type": "string",
                "value": "Adam at AAAutomations"
              }
            ]
          }
        },
        "typeVersion": 3.4
      }
    ],
    "pinData": {},
    "connections": {
      "Gmail": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Data": {
        "main": [
          [
            {
              "node": "Generate Personalized Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Get LinkedIn Person",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Leads": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate1": {
        "main": [
          [
            {
              "node": "Set Company URL1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Google Search for Person LinkedIn",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Company URL": {
        "main": [
          [
            {
              "node": "Get LinkedIn Company",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Company URL1": {
        "main": [
          [
            {
              "node": "Get LinkedIn Company",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Only People Links": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Only Company Links": {
        "main": [
          [
            {
              "node": "Aggregate1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get LinkedIn Person": {
        "main": [
          [
            {
              "node": "Current Company Exists?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get LinkedIn Company": {
        "main": [
          [
            {
              "node": "Set Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Personalized Email",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Current Company Exists?": {
        "main": [
          [
            {
              "node": "Set Company URL",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Google Search for Company LinkedIn",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Generate Personalized Email",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Generate Personalized Email": {
        "main": [
          [
            {
              "node": "Gmail",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Search for Person LinkedIn": {
        "main": [
          [
            {
              "node": "Only People Links",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Search for Company LinkedIn": {
        "main": [
          [
            {
              "node": "Only Company Links",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‘Execute workflow’": {
        "main": [
          [
            {
              "node": "Get Leads",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "plZ7SEgRE5J3rK0O",
    "meta": {
      "instanceId": "d4624db7a3a7e9da97f0a286f3b55ac8518307cf24e917b7a02124c1506facab"
    },
    "name": "AI Follow-Up Messages from Fireflies Transcripts (Google Calendar)",
    "tags": [],
    "nodes": [
      {
        "id": "e80cc5e8-58c3-4820-879a-020f507d984b",
        "name": "GraphQL",
        "type": "n8n-nodes-base.graphql",
        "position": [
          512,
          544
        ],
        "parameters": {
          "query": "query GetTranscriptsByGuest($guestEmail: String!) {\n  transcripts(participant_email: $guestEmail) {\n    id\n    title\n    date\n    organizer_email\n    participants\n    duration\n    sentences {\n      text\n      speaker_name\n      start_time\n      end_time\n    }\n    summary {\n      overview\n      action_items\n      keywords\n    }\n  }\n}",
          "endpoint": "https://api.fireflies.ai/graphql",
          "variables": "={\n  \"guestEmail\": \"{{ $json.guest }}\"\n}",
          "authentication": "headerAuth"
        },
        "credentials": {
          "httpHeaderAuth": {
            "id": "v0UtRVb8pMrlktQ4",
            "name": "Header Auth account 2"
          }
        },
        "typeVersion": 1.1
      },
      {
        "id": "3e5a4755-e3cf-4d79-a41a-86171ac8eba7",
        "name": "Edit Fields",
        "type": "n8n-nodes-base.set",
        "position": [
          176,
          544
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "f15e7a75-aa69-4009-90fb-00a3e2701e8e",
                "name": "startTimeOfAppointment",
                "type": "string",
                "value": "={{ $json.start.dateTime }}"
              },
              {
                "id": "50bdfc5e-cada-41eb-869f-bd2af5a5615b",
                "name": "endTimeOfAppointment",
                "type": "string",
                "value": "={{ $json.end.dateTime }}"
              },
              {
                "id": "177b19e7-8194-4c16-9d4b-22079c067061",
                "name": "createdBy",
                "type": "string",
                "value": "={{ $json.creator.email }}"
              },
              {
                "id": "223c85e9-2322-4298-9728-040e739b1bf4",
                "name": "guest",
                "type": "string",
                "value": "={{ $json.attendees[0].email }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "fc1fc27a-445f-4ba9-bcad-94bd697f0c10",
        "name": "AI Agent",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          1184,
          544
        ],
        "parameters": {
          "text": "=Your Objective:\n\nBased strictly on the provided transcript, write a sequence of 12 persuasive follow-up messages to be sent to {{ $('Edit Fields').item.json.guest }} via email. The goal is to re-engage the client, address their specific concerns mentioned in the call, and gently guide them towards making a purchase.\n\n\nInstructions:\n\nDeep Personalization: Do not write generic messages.\n\nYour messages must reference specific topics, pain points, or interests that \nmentioned during the call. Use the exact context from the transcript.\n\nTRANSCRIPT: {{ $('GraphQL').item.json.data.transcripts[0].toJsonString() }}\n\nCore Task: Generate exactly 12 distinct follow-up messages.\nFinal Output Format:\nNumber each message clearly (Message 1, Message 2, etc.).\nDo not add any extra explanations, introductions, or comments.\nProvide only the raw text of the 12 messages as the final output. ",
          "options": {},
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "43cb1cc9-26c6-43fa-9159-dabec88a1456",
        "name": "Google Gemini Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "position": [
          1120,
          816
        ],
        "parameters": {
          "options": {},
          "modelName": "models/gemini-2.5-flash-lite"
        },
        "credentials": {
          "googlePalmApi": {
            "id": "KLWLV06GxDJSwJW5",
            "name": "Google Gemini(PaLM) Api account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "49b8d130-379b-4d5e-9b43-902a7e24c25e",
        "name": "Google Drive",
        "type": "n8n-nodes-base.googleDrive",
        "position": [
          1536,
          544
        ],
        "parameters": {
          "name": "={{ $('Edit Fields').item.json.guest }}",
          "content": "={{ $json.output }}",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive",
            "cachedResultUrl": "https://drive.google.com/drive/my-drive",
            "cachedResultName": "My Drive"
          },
          "options": {},
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "1sfBcplQZn2T5dGc50zXH8ng-8zqSKeWB",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1sfBcplQZn2T5dGc50zXH8ng-8zqSKeWB",
            "cachedResultName": "Followup Messages"
          },
          "operation": "createFromText"
        },
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "rmLddus1BEwVHyRF",
            "name": "Google Drive account"
          }
        },
        "typeVersion": 3
      },
      {
        "id": "6498ee53-cc4e-4282-9a03-319a594b26b6",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -96,
          240
        ],
        "parameters": {
          "width": 448,
          "height": 464,
          "content": "## 1. Get Appointment Data\n\nTriggers when a appointment is created in Google Calendar"
        },
        "typeVersion": 1
      },
      {
        "id": "bf96d4c8-72da-486e-9814-6a3676940a30",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          416,
          240
        ],
        "parameters": {
          "width": 288,
          "height": 464,
          "content": "## 2. Fetch Meeting Transcript\n\nQueries the Fireflies API using the guest's email to fetch the full meeting transcript and then formats it into a clean structure for the AI to process."
        },
        "typeVersion": 1
      },
      {
        "id": "4f5bd9ee-ff27-48fa-af4e-302e866a2e79",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1104,
          240
        ],
        "parameters": {
          "width": 608,
          "height": 464,
          "content": "## 4. Generate & Store AI Messages\n\nThe AI Agent uses the transcript to generate 12 personalized follow-up messages. Finally, these messages are saved to a specific Google Drive folder."
        },
        "typeVersion": 1
      },
      {
        "id": "802ab55e-9f94-4516-9747-b9128e3adfa4",
        "name": "Google Calendar Trigger",
        "type": "n8n-nodes-base.googleCalendarTrigger",
        "position": [
          -16,
          544
        ],
        "parameters": {
          "options": {},
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "triggerOn": "eventCreated",
          "calendarId": {
            "__rl": true,
            "mode": "list",
            "value": "bilalnaseer01@gmail.com",
            "cachedResultName": "WebSensePro - Bilal"
          }
        },
        "credentials": {
          "googleCalendarOAuth2Api": {
            "id": "A8NmTXpeHYIlbjWp",
            "name": "Google Calendar account 2"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "78f24abc-f4af-43ca-9da3-3fbf5cb60922",
        "name": "Filter",
        "type": "n8n-nodes-base.filter",
        "position": [
          880,
          544
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "01e2edad-4472-4549-bc68-d23aa8e32b5b",
                "operator": {
                  "type": "array",
                  "operation": "notEmpty",
                  "singleValue": true
                },
                "leftValue": "={{ $json.data.transcripts }}",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "00bac098-939a-4776-9afc-aa878f116dbc",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          768,
          240
        ],
        "parameters": {
          "width": 288,
          "height": 464,
          "content": "## 3. Skip if Empty\n\nIf there is no meeting with the guest eariler it will not proceed"
        },
        "typeVersion": 1
      },
      {
        "id": "9bfb20d6-238c-4f99-b68b-80c3ede88c06",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -96,
          -80
        ],
        "parameters": {
          "color": 4,
          "width": 368,
          "height": 288,
          "content": "## Video Tutorial\n\n** Detailed Youtube Tutorial **. @[youtube](5t9xXCz4DzM)"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "552abe99-2511-4560-af34-3c1d7e6641d1",
    "connections": {
      "Filter": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GraphQL": {
        "main": [
          [
            {
              "node": "Filter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Google Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "GraphQL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Calendar Trigger": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "meta": {
      "instanceId": "0a70652f43c1b29dd16c35b61a38fd31c8004f58bc7e723bf43262a797407c77"
    },
    "name": "Automated Sales Outreach with Slack",
    "tags": [],
    "nodes": [
      {
        "id": "1b7537b1-0b43-43ac-b50a-5df61641043d",
        "name": "Anthropic Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          -1220,
          560
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "claude-3-7-sonnet-20250219",
            "cachedResultName": "Claude 3.7 Sonnet"
          },
          "options": {}
        },
        "credentials": {
          "anthropicApi": {
            "id": "FQdE6twB8nCJNoxV",
            "name": "Anthropic account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "1eb46a9e-5b03-42a2-8132-ccda3f42b453",
        "name": "Loop Over Items",
        "type": "n8n-nodes-base.splitInBatches",
        "position": [
          632,
          540
        ],
        "parameters": {
          "options": {
            "reset": false
          },
          "batchSize": "={{ 1 }}"
        },
        "typeVersion": 3
      },
      {
        "id": "4965a3e2-fa71-4680-b0bd-6db416edbc25",
        "name": "Company Researcher",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -1220,
          390
        ],
        "parameters": {
          "text": "={{ $json.body.data }}",
          "options": {
            "maxIterations": 12,
            "systemMessage": "=You are a research analyst helping a sales agent write a highly personalized outbound email. Your job is to generate a detailed research brief that explains:\n\n1. **What the company does**\n2. **What the recent business event is**, and why it's significant\n3. **How the event might reflect on the company’s priorities, pain points, or growth goals**\n4. Any additional company context that might be useful for crafting a relevant sales message\n\n## Guidelines:\n- Your response should be **detailed, structured, and accurate**\n- You are writing **for another AI**, so don't hold back on context — more is better\n- You can assume the user already passed in the full event details (like a trigger type, a short summary, etc.)\n- Focus more on **interpreting** the event and **linking it to the company**\n- Write in **natural language**, using clear, concise, informative sentences — not marketing fluff or speculation\n- Keep your tone objective and analytical\n- Avoid repeating generic phrases like “the company is innovative” unless supported by facts\n\n## Inputs:\n- Business ID: {{ $json.body.business_id }}\n- Event: {{ $json.body.data }}\n\n## Output Structure:\nReturn your findings in 2-3 clear paragraphs. The first paragraph should describe the **event in detail** and explain why it may be relevant. The second should summarize what the **company does** and any other useful GTM signals (size, growth stage, recent changes, priorities, etc.).\n\nNow generate the research summary.\n"
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "d0af2b0e-80c5-43b8-af7d-8f8039c90883",
        "name": "Email Writer ( YES prospect data)",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          852,
          415
        ],
        "parameters": {
          "text": "=prospect_data: contact info:{{ $json.email }}, expereince:{{ $json.experience }},skills:{{ $json.skills }}.\ncompany data:{{ $('Company Researcher').first().json.output }}\nevent data: {{ $('Webhook - Product Launch').first().json.body }}\n\n",
          "options": {
            "systemMessage": "=You are a B2B outbound sales email generator.\n\nYour task is to write a short and effective cold outbound email (under 150 words) to a specific prospect at a company. The goal is to be relevant, concise, and persuasive, while introducing Explorium in a way that aligns with the prospect’s role and current company context.\n\n## Prospect Data\n{prospect_data}\n\n## Company \n{company_data}\n\n## Event Data\n{event_data}\n\n## About Explorium (Use this to inform the email — do not paste directly):\nExplorium is a data-powered intelligence platform on a mission to unlock the full potential of external data for the agent era. We serve as the infrastructure backbone for intelligent systems — helping go-to-market teams enrich company and prospect data, tap into real-time signals, and dynamically prioritize their best-fit accounts. Our platform fuels the agents and AI products that are redefining the future of sales and marketing.\n\n## MCP Playground (Link to include):\nInvite the prospect to explore Explorium’s capabilities hands-on via our [MCP Playground](https://www.explorium.ai/mcp-playground/), a public environment to experience the power of enriched external data.\n\n## Output Instructions:\n- Personalize the email using the provided prospect, company, and event information\n- Tailor the message to the prospect’s title, department, or function\n- Weave in how Explorium could support their work or goals based on what the company is focused on\n- The email should feel like it’s written by a real SDR — confident, relevant, and human\n- End the email with a soft CTA inviting them to check out the MCP Playground link but dont forget to also ask to set up a meeting / call\n- At the top of the email, output the selected email address to use. Choose the prospect’s **professional email** if available, or fallback to the next best alternative (personal, current, etc.)\n\nNow write the email.\n"
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "f7e3faae-1353-4570-bdca-f1055c4b5c5b",
        "name": "Email Writer (NO prospect data)",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -404,
          140
        ],
        "parameters": {
          "text": "=company data:{{ $('Company Researcher').first().json.output }}\nevent data: {{ $('Webhook - Product Launch').first().json.body }}\n",
          "options": {
            "systemMessage": "=You are a B2B outbound email assistant.\n\nYour task is to write a short, personalized outbound email (under 120 words) that connects Explorium to a recent business event or trigger at a target company. This email will be sent to a general marketing, growth, or data contact — no specific prospect information is available.\n\n## Context Provided:\n- Company Information: {company_data}\n- Event Information: {event_data}\n\n## About Explorium (Use as context — DO NOT paste directly):\nExplorium is on a mission to unlock the full potential of data for the agent era. From day one, we’ve been driven to be the data and infrastructure backbone that powers intelligent systems and delivers real business growth.\n\nWe partner with smart, driven teams to turn raw external data into actionable insight—fueling agents, AI products, and GTM strategies for the future of sales and marketing.\n\nIf relevant, you may mention that they can explore Explorium’s capabilities themselves via our [MCP Playground](https://www.explorium.ai/mcp-playground/), a public demo environment showcasing the power of enriched data. \n\ndont forget to always end with a call to action in setting up some sort of call or meeting to talk further\n\n## Instructions:\n- Reference the event to establish relevance and timing\n- Briefly describe what the company does (from the input)\n- Weave in Explorium’s value if it's applicable to their business priorities\n- If appropriate, suggest checking out the MCP Playground link\n- End with a warm, soft CTA\n\nNow write the email.\n"
          },
          "promptType": "define"
        },
        "typeVersion": 1.9
      },
      {
        "id": "5012126e-241d-4c5b-8c53-42452933e0a7",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1220,
          220
        ],
        "parameters": {
          "width": 260,
          "content": "## Reaserch\nThis agent uses the Explorium MCP to research the company that just had an event"
        },
        "typeVersion": 1
      },
      {
        "id": "11fafba4-861d-4766-b334-51f745bcd8bb",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -760,
          220
        ],
        "parameters": {
          "height": 140,
          "content": "## Crossroads \n\nif we cant find data about the company's employees, we fork up, to write a general email "
        },
        "typeVersion": 1
      },
      {
        "id": "e7a4cf37-325b-485a-aef7-e23c1ec4fac8",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -400,
          20
        ],
        "parameters": {
          "height": 100,
          "content": "## email writer #1\nGiven the research, this agents writes an email"
        },
        "typeVersion": 1
      },
      {
        "id": "6b29ded5-fb0a-4c29-8b35-a1a3726dacc3",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          140,
          400
        ],
        "parameters": {
          "height": 120,
          "content": "##  Employee Data \nGather data about the 5 employees we will write emails to."
        },
        "typeVersion": 1
      },
      {
        "id": "5ba21e97-46f0-4786-8de0-2b06cd2aeed3",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          860,
          260
        ],
        "parameters": {
          "height": 140,
          "content": "## Email Writer #2\nGiven both data about the email and the employee, the agent will write a highly personalized email to each employee\n"
        },
        "typeVersion": 1
      },
      {
        "id": "5363bc7a-b066-4fad-a5be-3fc9924aff55",
        "name": "Explorium MCP",
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "position": [
          -1020,
          560
        ],
        "parameters": {
          "sseEndpoint": "mcp.explorium.ai/sse",
          "authentication": "bearerAuth"
        },
        "credentials": {
          "httpBearerAuth": {
            "id": "aPjJXei6qDSctHNW",
            "name": "Bearer YOUR_TOKEN_HERE account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "c88fe320-1a7b-4c37-a799-52a06445245a",
        "name": "Webhook - Product Launch",
        "type": "n8n-nodes-base.webhook",
        "position": [
          -1440,
          390
        ],
        "webhookId": "09d12e26-7fb0-492f-913f-119f627de19b",
        "parameters": {
          "path": "https://lievi.app.n8n.cloud/webhook-test/product-launch",
          "options": {},
          "httpMethod": "POST"
        },
        "typeVersion": 2
      },
      {
        "id": "3f116b08-0ba1-45da-89c8-5ebf494fc48d",
        "name": "Explorium Prospects API Call",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -844,
          390
        ],
        "parameters": {
          "url": "https://api.explorium.ai/v1/prospects",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"mode\": \"full\",\n  \"page\": 1,\n  \"size\": 5,\n  \"page_size\": 5,\n  \"filters\": {\n    \"has_email\": { \"value\": true },\n    \"job_level\": {\n      \"values\": [\"owner\", \"cxo\", \"vp\", \"director\", \"manager\", \"senior\"]\n    },\n    \"job_department\": {\n      \"values\": [\"Marketing\"]\n    },\n    \"business_id\": {\n      \"values\": [\"{{ $('Webhook - Product Launch').item.json.body.business_id }}\"]\n    }\n  }\n}\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "content-type",
                "value": "application/json"
              },
              {
                "name": "api_key",
                "value": ""
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "3414b8fd-6410-4faa-a81b-f8352abb2f73",
        "name": "Is there data on the company?",
        "type": "n8n-nodes-base.if",
        "position": [
          -624,
          390
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "loose"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "8627133a-68d0-4907-b8ca-d8deba93089d",
                "operator": {
                  "type": "number",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.data.length }}\n",
                "rightValue": "=0"
              }
            ]
          },
          "looseTypeValidation": true
        },
        "typeVersion": 2.2
      },
      {
        "id": "93f5ca4d-b537-4e58-90c3-8fa85a9edf9e",
        "name": "Claude",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          -316,
          360
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "claude-sonnet-4-20250514",
            "cachedResultName": "Claude Sonnet 4"
          },
          "options": {}
        },
        "credentials": {
          "anthropicApi": {
            "id": "FQdE6twB8nCJNoxV",
            "name": "Anthropic account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "f0bcac46-cdd7-481b-8d51-b76f2382f0d5",
        "name": "Code - Format Object",
        "type": "n8n-nodes-base.code",
        "position": [
          -326,
          540
        ],
        "parameters": {
          "jsCode": "const candidates = $input.first().json.data;\n\nif (!Array.isArray(candidates) || candidates.length === 0) {\n  throw new Error(\"No candidates found in data.\");\n}\n\nconst result = candidates.map(candidate => {\n  return {\n    json: {\n      prospect_id: candidate.prospect_id,  \n      full_name: candidate.full_name,\n      first_name: candidate.first_name,\n      last_name: candidate.last_name,\n      title: candidate.job_title,\n      department: candidate.job_department,\n      seniority: candidate.job_seniority_level?.join(', ') || '',\n      company: candidate.company_name,\n      location: `${candidate.city}, ${candidate.region_name}, ${candidate.country_name}`,\n      linkedin: candidate.linkedin,\n      email: candidate.professional_email_hashed || '',\n      experience: candidate.experience?.join(' | ') || '',\n      skills: candidate.skills?.join(', ') || '',\n      interests: candidate.interests?.join(', ') || '',\n      business_id: candidate.business_id\n    }\n  };\n});\n\nreturn result;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "5122152e-4667-481e-899e-804feae479a2",
        "name": "Code - Get prospect_ids",
        "type": "n8n-nodes-base.code",
        "position": [
          -28,
          540
        ],
        "parameters": {
          "jsCode": "const prospectIds = $input.all()\n  .map(item => String(item.json.prospect_id).trim()) // Force string and trim whitespace\n  .filter(Boolean); // remove empty/null\n\nreturn [{\n  json: {\n    prospect_ids: prospectIds\n  }\n}];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "57258b5d-9040-40d0-89d5-4fa9723fe2aa",
        "name": "Send Slack Message",
        "type": "n8n-nodes-base.slack",
        "position": [
          -28,
          240
        ],
        "webhookId": "3bd7b28e-1c59-49a8-bdd0-cb2e314daee6",
        "parameters": {
          "text": "={{ $json.output }}",
          "user": {
            "__rl": true,
            "mode": "list",
            "value": "U08KUURMK2S",
            "cachedResultName": "itamar.levi"
          },
          "select": "user",
          "otherOptions": {},
          "authentication": "oAuth2"
        },
        "credentials": {
          "slackOAuth2Api": {
            "id": "eOfca8yNWglvt3Ib",
            "name": "Slack account"
          }
        },
        "typeVersion": 2.3
      },
      {
        "id": "c47f81d1-fa89-4a69-adb0-b239c5faa526",
        "name": "Explorium Contacts Information API Call",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          192,
          540
        ],
        "parameters": {
          "url": "https://api.explorium.ai/v1/prospects/contacts_information/bulk_enrich",
          "method": "POST",
          "options": {},
          "jsonBody": "={{ JSON.stringify({ prospect_ids: $json.prospect_ids }) }}\n\n",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "content-type",
                "value": "application/json"
              },
              {
                "name": "api_key",
                "value": ""
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "58f5da0c-9205-48cc-8965-ccb3c52973f0",
        "name": "Code - Merge profile with email info",
        "type": "n8n-nodes-base.code",
        "position": [
          412,
          540
        ],
        "parameters": {
          "jsCode": "// Get full profile data from the HTTP Request node\nconst profiles = $('Explorium Prospects API Call').first().json.data;\n\n// Get contact enrichment data from the current input\nconst contactEnrichments = $input.first().json.data;\n\n// Step 1: Create a lookup table for enriched contact info\nconst contactMap = {};\nfor (const contact of contactEnrichments) {\n  contactMap[contact.prospect_id] = contact.data;\n}\n\n// Step 2: Merge profile with email info\nconst result = profiles.map(profile => {\n  const contact = contactMap[profile.prospect_id];\n\n  // Determine the best email\n  let email = profile.email || \"\";\n  if (contact) {\n    email = contact.professions_email ||\n            (contact.emails?.find(e => e.type === \"professional\")?.address) ||\n            (contact.emails?.[0]?.address) ||\n            \"\";\n  }\n\n  return {\n    json: {\n      ...profile,\n      email // now includes enriched email if found\n    }\n  };\n});\n\nreturn result;\n"
        },
        "typeVersion": 2
      },
      {
        "id": "a3c17adf-18fc-4f93-8324-784c8e18590b",
        "name": "Anthropic - Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "position": [
          860,
          580
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "claude-3-7-sonnet-20250219",
            "cachedResultName": "Claude 3.7 Sonnet"
          },
          "options": {}
        },
        "credentials": {
          "anthropicApi": {
            "id": "FQdE6twB8nCJNoxV",
            "name": "Anthropic account"
          }
        },
        "typeVersion": 1.3
      },
      {
        "id": "ede07723-80d0-4de2-90c5-12c45bfbed56",
        "name": "Send Slack",
        "type": "n8n-nodes-base.slack",
        "position": [
          1228,
          540
        ],
        "webhookId": "5d5bb3f1-0bc6-494b-8705-f108ee11b313",
        "parameters": {
          "text": "={{ $json.output }}",
          "select": "channel",
          "channelId": {
            "__rl": true,
            "mode": "list",
            "value": "C08U1DDTQ7Q",
            "cachedResultName": "evergreen-outbound-campaign"
          },
          "otherOptions": {},
          "authentication": "oAuth2"
        },
        "credentials": {
          "slackOAuth2Api": {
            "id": "eOfca8yNWglvt3Ib",
            "name": "Slack account"
          }
        },
        "typeVersion": 2.3
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "",
    "connections": {
      "Claude": {
        "ai_languageModel": [
          [
            {
              "node": "Email Writer (NO prospect data)",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Send Slack": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Explorium MCP": {
        "ai_tool": [
          [
            {
              "node": "Company Researcher",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [],
          [
            {
              "node": "Email Writer ( YES prospect data)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Company Researcher": {
        "main": [
          [
            {
              "node": "Explorium Prospects API Call",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Anthropic Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Company Researcher",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Code - Format Object": {
        "main": [
          [
            {
              "node": "Code - Get prospect_ids",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Anthropic - Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Email Writer ( YES prospect data)",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Code - Get prospect_ids": {
        "main": [
          [
            {
              "node": "Explorium Contacts Information API Call",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook - Product Launch": {
        "main": [
          [
            {
              "node": "Company Researcher",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Explorium Prospects API Call": {
        "main": [
          [
            {
              "node": "Is there data on the company?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is there data on the company?": {
        "main": [
          [
            {
              "node": "Email Writer (NO prospect data)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code - Format Object",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Email Writer (NO prospect data)": {
        "main": [
          [
            {
              "node": "Send Slack Message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Email Writer ( YES prospect data)": {
        "main": [
          [
            {
              "node": "Send Slack",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code - Merge profile with email info": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Explorium Contacts Information API Call": {
        "main": [
          [
            {
              "node": "Code - Merge profile with email info",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "dSEgsAFEb4ekvPgY",
    "meta": {
      "instanceId": "50631c03cbd88440965b74e5a58aada5437cbc43e90372b516e36154908ad374"
    },
    "name": "Calendly Booking Link Generator",
    "tags": [],
    "nodes": [
      {
        "id": "c3c09ac6-013d-4a7a-aa62-76f868baf7bc",
        "name": "📋 WORKFLOW OVERVIEW",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          368,
          -128
        ],
        "parameters": {
          "color": 5,
          "width": 820,
          "height": 620,
          "content": "## 🔗 Calendly Booking Link Generator\n\n**What this workflow does:**\n1. 🔐 Authenticates with Calendly API\n2. 📋 Gets your event types\n3. 🔗 Creates single-use booking links\n4. ✉️ Personalizes links with recipient info\n5. 📊 Logs generated links to Google Sheets\n6. 💬 Notifies via Slack (optional)\n\n**Why Single-Use Links?**\nCalendly API does NOT allow direct booking.\nInstead, generate personalized links that:\n- Expire after one booking\n- Pre-fill invitee name/email\n- Can be tracked\n- Work seamlessly\n\n**Use Cases:**\n- CRM automation\n- Sales outreach\n- Customer support\n- Automated follow-ups"
        },
        "typeVersion": 1
      },
      {
        "id": "5fa6844e-dd8a-4f9b-8b28-60ee68c443aa",
        "name": "⚙️ SETUP GUIDE",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1216,
          -128
        ],
        "parameters": {
          "color": 6,
          "width": 860,
          "height": 620,
          "content": "## ⚙️ Setup Instructions\n\n**Step 1: Calendly OAuth2**\n1. Go to calendly.com/integrations\n2. Click \"API & Webhooks\"\n3. Set up OAuth2 application\n4. In n8n, add Calendly OAuth2 credential\n\n**Step 2: Google Sheets (Optional)**\n1. Create a spreadsheet for tracking\n2. Headers: Name, Email, Link, Event, Created\n3. Add Google Sheets OAuth2 credential\n4. Update document ID in node\n\n**Step 3: Slack (Optional)**\n1. Create Slack app at api.slack.com\n2. Add bot token scopes\n3. Add Slack credential in n8n\n4. Set channel ID\n\n---\n\n**⚠️ Important Notes:**\n- Single-use links expire after:\n  - 1 booking, OR\n  - 90 days unused\n- Links are unique per generation\n- Cannot be modified after creation"
        },
        "typeVersion": 1
      },
      {
        "id": "130cc077-ece1-4168-b37f-c1061ac0af77",
        "name": "Webhook Trigger",
        "type": "n8n-nodes-base.webhook",
        "notes": "POST with recipient details",
        "position": [
          368,
          544
        ],
        "webhookId": "booking-link-generator",
        "parameters": {
          "path": "generate-calendly-link",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "94e36147-7595-40bb-9fcf-66c636a5d468",
        "name": "🎯 INPUT FORMAT",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -64,
          480
        ],
        "parameters": {
          "color": 5,
          "width": 344,
          "height": 240,
          "content": "## 🎯 Webhook Input\n\n**POST Body:**\n```json\n{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"event_type_uri\": \"optional\"\n}\n```\n\nIf no event_type_uri,\nuses first active type."
        },
        "typeVersion": 1
      },
      {
        "id": "0798031a-8ff5-498a-ab6e-8e92cf0b621d",
        "name": "Set Configuration",
        "type": "n8n-nodes-base.set",
        "notes": "Extract recipient info from request",
        "position": [
          592,
          544
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "cfg1",
                "name": "recipient_email",
                "type": "string",
                "value": "={{ $json.body?.email || 'test@example.com' }}"
              },
              {
                "id": "cfg2",
                "name": "recipient_name",
                "type": "string",
                "value": "={{ $json.body?.name || 'Test User' }}"
              },
              {
                "id": "cfg3",
                "name": "requested_event_type",
                "type": "string",
                "value": "={{ $json.body?.event_type_uri || '' }}"
              },
              {
                "id": "cfg4",
                "name": "utm_source",
                "type": "string",
                "value": "={{ $json.body?.utm_source || 'n8n' }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "6d65c93a-0934-499e-9af7-7ca332f3ad59",
        "name": "Get Current User",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "GET /users/me",
        "onError": "continueRegularOutput",
        "position": [
          816,
          544
        ],
        "parameters": {
          "url": "https://api.calendly.com/users/me",
          "options": {},
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "calendlyOAuth2Api"
        },
        "credentials": {
          "calendlyOAuth2Api": {
            "id": "bM2GZrXliNxLC0qT",
            "name": "Calendly account"
          }
        },
        "typeVersion": 4.3
      },
      {
        "id": "584b2145-6d49-4f63-bb3f-39e1fff8e2f6",
        "name": "Extract User",
        "type": "n8n-nodes-base.set",
        "position": [
          1040,
          544
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "u1",
                "name": "user_uri",
                "type": "string",
                "value": "={{ $json.resource?.uri }}"
              },
              {
                "id": "u2",
                "name": "user_name",
                "type": "string",
                "value": "={{ $json.resource?.name }}"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "39688e69-141e-4053-b0ca-d2d4cf2367bc",
        "name": "Get Event Types",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "GET /event_types?user={uri}&active=true",
        "onError": "continueRegularOutput",
        "position": [
          1264,
          544
        ],
        "parameters": {
          "url": "https://api.calendly.com/event_types",
          "options": {},
          "sendQuery": true,
          "authentication": "predefinedCredentialType",
          "queryParameters": {
            "parameters": [
              {
                "name": "user",
                "value": "={{ $json.user_uri }}"
              },
              {
                "name": "active",
                "value": "true"
              }
            ]
          },
          "nodeCredentialType": "calendlyOAuth2Api"
        },
        "credentials": {
          "calendlyOAuth2Api": {
            "id": "bM2GZrXliNxLC0qT",
            "name": "Calendly account"
          }
        },
        "typeVersion": 4.3
      },
      {
        "id": "e0ed21e2-3258-415e-b414-b7db2cf76530",
        "name": "Select Event Type",
        "type": "n8n-nodes-base.set",
        "notes": "Pick requested or first event type",
        "position": [
          1488,
          544
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "et1",
                "name": "selected_event_type_uri",
                "type": "string",
                "value": "={{ $('Set Configuration').item.json.requested_event_type || ($json.collection && $json.collection.length > 0 ? $json.collection[0].uri : '') }}"
              },
              {
                "id": "et2",
                "name": "selected_event_type_name",
                "type": "string",
                "value": "={{ $json.collection && $json.collection.length > 0 ? $json.collection[0].name : '' }}"
              },
              {
                "id": "et3",
                "name": "selected_event_duration",
                "type": "number",
                "value": "={{ $json.collection && $json.collection.length > 0 ? $json.collection[0].duration : 30 }}"
              }
            ]
          },
          "includeOtherFields": true
        },
        "typeVersion": 3.4
      },
      {
        "id": "231c02e2-996d-42eb-a1a1-d6c59727a9cc",
        "name": "Create Single-Use Link",
        "type": "n8n-nodes-base.httpRequest",
        "notes": "POST /scheduling_links",
        "onError": "continueRegularOutput",
        "position": [
          1712,
          544
        ],
        "parameters": {
          "url": "https://api.calendly.com/scheduling_links",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"max_event_count\": 1,\n  \"owner\": \"{{ $json.selected_event_type_uri }}\",\n  \"owner_type\": \"EventType\"\n}",
          "sendBody": true,
          "specifyBody": "json",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "calendlyOAuth2Api"
        },
        "credentials": {
          "calendlyOAuth2Api": {
            "id": "bM2GZrXliNxLC0qT",
            "name": "Calendly account"
          }
        },
        "typeVersion": 4.3
      },
      {
        "id": "e75994d1-43a7-4a2f-a446-d0b57ed91638",
        "name": "Build Personalized Link",
        "type": "n8n-nodes-base.set",
        "notes": "Add prefill params to URL",
        "position": [
          1936,
          544
        ],
        "parameters": {
          "options": {},
          "assignments": {
            "assignments": [
              {
                "id": "pl1",
                "name": "base_booking_url",
                "type": "string",
                "value": "={{ $json.resource?.booking_url }}"
              },
              {
                "id": "pl2",
                "name": "personalized_booking_url",
                "type": "string",
                "value": "={{ $json.resource?.booking_url }}?name={{ encodeURIComponent($('Set Configuration').item.json.recipient_name) }}&email={{ encodeURIComponent($('Set Configuration').item.json.recipient_email) }}&utm_source={{ $('Set Configuration').item.json.utm_source }}"
              },
              {
                "id": "pl3",
                "name": "recipient_name",
                "type": "string",
                "value": "={{ $('Set Configuration').item.json.recipient_name }}"
              },
              {
                "id": "pl4",
                "name": "recipient_email",
                "type": "string",
                "value": "={{ $('Set Configuration').item.json.recipient_email }}"
              },
              {
                "id": "pl5",
                "name": "event_type_name",
                "type": "string",
                "value": "={{ $('Select Event Type').item.json.selected_event_type_name }}"
              },
              {
                "id": "pl6",
                "name": "event_duration",
                "type": "number",
                "value": "={{ $('Select Event Type').item.json.selected_event_duration }}"
              },
              {
                "id": "pl7",
                "name": "link_created_at",
                "type": "string",
                "value": "={{ new Date().toISOString() }}"
              }
            ]
          }
        },
        "typeVersion": 3.4
      },
      {
        "id": "bed3401a-0f1b-4454-9d0d-c67eb5123ea2",
        "name": "Log to Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "notes": "Track generated links",
        "onError": "continueRegularOutput",
        "position": [
          928,
          832
        ],
        "parameters": {
          "columns": {
            "value": {
              "Status": "Sent",
              "Created At": "={{ $json.link_created_at }}",
              "Event Type": "={{ $json.event_type_name }}",
              "Booking URL": "={{ $json.personalized_booking_url }}",
              "Duration (min)": "={{ $json.event_duration }}",
              "Recipient Name": "={{ $json.recipient_name }}",
              "Recipient Email": "={{ $json.recipient_email }}"
            },
            "schema": [
              {
                "id": "Recipient Name",
                "type": "string",
                "display": true
              },
              {
                "id": "Recipient Email",
                "type": "string",
                "display": true
              },
              {
                "id": "Event Type",
                "type": "string",
                "display": true
              },
              {
                "id": "Duration (min)",
                "type": "number",
                "display": true
              },
              {
                "id": "Booking URL",
                "type": "string",
                "display": true
              },
              {
                "id": "Created At",
                "type": "string",
                "display": true
              },
              {
                "id": "Status",
                "type": "string",
                "display": true
              }
            ],
            "mappingMode": "autoMapInputData",
            "matchingColumns": [],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {},
          "operation": "append",
          "sheetName": {
            "__rl": true,
            "mode": "list",
            "value": "gid=0",
            "cachedResultName": "Generated Links"
          },
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": "18gXcSrZuh-59Uv5N323vwZ3pZivaxeP9tnQ6XJqjRjc",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/18gXcSrZuh-59Uv5N323vwZ3pZivaxeP9tnQ6XJqjRjc/edit?usp=drivesdk",
            "cachedResultName": "n8n Template -Calendly Booking"
          }
        },
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "m7KJWht6snJWUiJc",
            "name": "Google Sheets - omerfayyaz.engr@gmail.com"
          }
        },
        "typeVersion": 4.7
      },
      {
        "id": "0b033070-77b3-4430-a5b1-c1de917feb85",
        "name": "Notify via Slack",
        "type": "n8n-nodes-base.slack",
        "notes": "Optional notification",
        "onError": "continueRegularOutput",
        "position": [
          1152,
          832
        ],
        "webhookId": "2f22a250-ff20-4531-8e09-f0fa455529e6",
        "parameters": {
          "text": "=🔗 *New Booking Link Generated*\n\n👤 *For:* {{ $json.recipient_name }}\n📧 *Email:* {{ $json.recipient_email }}\n📅 *Event:* {{ $json.event_type_name }} ({{ $json.event_duration }} min)\n\n🔗 <{{ $json.personalized_booking_url }}|Click to Book>",
          "select": "channel",
          "channelId": {
            "__rl": true,
            "mode": "id",
            "value": "general"
          },
          "otherOptions": {
            "mrkdwn": true,
            "unfurl_links": false
          }
        },
        "credentials": {
          "slackApi": {
            "id": "VI4wP9VPIS3KDiow",
            "name": "Slack account"
          }
        },
        "typeVersion": 2.3
      },
      {
        "id": "65523d31-14fa-4af0-8053-e1167212f18b",
        "name": "Respond to Webhook",
        "type": "n8n-nodes-base.respondToWebhook",
        "notes": "Return the generated link",
        "position": [
          1376,
          832
        ],
        "parameters": {
          "options": {
            "responseCode": 200,
            "responseHeaders": {
              "entries": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                }
              ]
            }
          },
          "respondWith": "json",
          "responseBody": "={\n  \"success\": true,\n  \"booking_url\": \"{{ $('Build Personalized Link').item.json.personalized_booking_url }}\",\n  \"base_url\": \"{{ $('Build Personalized Link').item.json.base_booking_url }}\",\n  \"recipient\": {\n    \"name\": \"{{ $('Build Personalized Link').item.json.recipient_name }}\",\n    \"email\": \"{{ $('Build Personalized Link').item.json.recipient_email }}\"\n  },\n  \"event\": {\n    \"name\": \"{{ $('Build Personalized Link').item.json.event_type_name }}\",\n    \"duration_minutes\": {{ $('Build Personalized Link').item.json.event_duration }}\n  },\n  \"created_at\": \"{{ $('Build Personalized Link').item.json.link_created_at }}\",\n  \"expires\": \"Single-use or 90 days\"\n}"
        },
        "typeVersion": 1.1
      },
      {
        "id": "0015b4fa-0244-40c2-83ad-e866999fe7f9",
        "name": "📤 RESPONSE",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2144,
          496
        ],
        "parameters": {
          "color": 5,
          "width": 396,
          "height": 268,
          "content": "## 📤 Response\n\n```json\n{\n  \"success\": true,\n  \"booking_url\": \"https://...\",\n  \"recipient\": {...},\n  \"event\": {...},\n  \"created_at\": \"...\",\n  \"expires\": \"Single-use or 90 days\"\n}\n```"
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "47464fb8-c865-46ca-98b5-a4278ec8a500",
    "connections": {
      "Extract User": {
        "main": [
          [
            {
              "node": "Get Event Types",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Event Types": {
        "main": [
          [
            {
              "node": "Select Event Type",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook Trigger": {
        "main": [
          [
            {
              "node": "Set Configuration",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Current User": {
        "main": [
          [
            {
              "node": "Extract User",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Notify via Slack": {
        "main": [
          [
            {
              "node": "Respond to Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Select Event Type": {
        "main": [
          [
            {
              "node": "Create Single-Use Link",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Configuration": {
        "main": [
          [
            {
              "node": "Get Current User",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Log to Google Sheets": {
        "main": [
          [
            {
              "node": "Notify via Slack",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create Single-Use Link": {
        "main": [
          [
            {
              "node": "Build Personalized Link",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Build Personalized Link": {
        "main": [
          [
            {
              "node": "Log to Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "z1y59Ygza4dbq9vD",
    "meta": {
      "instanceId": "d92ae4b43988b888be9e59a711908a679453e558f86530d2ed2c1c3491f22bf5",
      "templateCredsSetupCompleted": true
    },
    "name": "Automatically Generate Structured Summaries of Scientific Research PDFs with GPT-4o",
    "tags": [],
    "nodes": [
      {
        "id": "cdf76194-f7e3-4846-8d8b-cd13a3a0404b",
        "name": "Local File Trigger",
        "type": "n8n-nodes-base.localFileTrigger",
        "position": [
          -160,
          0
        ],
        "parameters": {
          "events": [
            "add"
          ],
          "options": {},
          "triggerOn": "folder"
        },
        "typeVersion": 1
      },
      {
        "id": "d376462c-b09c-4d35-b631-5fb3ecc73ceb",
        "name": "OpenAI Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "position": [
          600,
          160
        ],
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4o",
            "cachedResultName": "gpt-4o"
          },
          "options": {}
        },
        "credentials": {
          "openAiApi": {
            "id": "hghRc8fMDt5M0xCj",
            "name": "OpenAi account"
          }
        },
        "typeVersion": 1.2
      },
      {
        "id": "e759529e-fb21-4339-a981-a9cde3b9d63c",
        "name": "Summarizer",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          640,
          0
        ],
        "parameters": {
          "text": "={{ $json.text }}",
          "options": {
            "systemMessage": "=#Role \nYou are a research agent. You are very good at analyzing a research article and obtaining the best detail from it. You are a research expert who is providing data to another researcher. You are well versed in the scientific method. You will be provided data from a pdf {{ $json.text }}. You are to analyze this text and provide a thorough summary of it.\n\nProvide your summary in the format of:\nTitle\n\nIntroduction:\n-What is the importance of this study.\n-What are the specific aims of this study.\n-What questions are they trying to answer.\n-What studies have been done in the past in regards to this topic.\n\nMethods:\n-Go into detail about their methods.\n-What type of study is this.\n-How many subjects were included in the study.\n-How was their study designed.\n-What parameters or variables were they measuring. \n         -This is the most important part of this group. In the methods section of each paper they will define what the measurable outcomes of the study were. Sometimes they will have primary and secondary outcomes. You should include all of these.\n-What was their inclusion and exclusion criteria.\n\nResults:\n-This should be comprehensive.\n-It should give the results for every variable or measurable outcome tested.\n-specific numbers with statistical significance should be given.\n\nSummary:\n-You should provide the specific conclusions they came to from their results.\n-Provide how their results compare to other studies mentioned in their paper. In the summary section of the paper they often reference how their results compare to other studies. You should provide this in your summary.\n-Provide what their recommendations are based off the results.\n\nConclusion:\nProvide any weaknesses of the paper.\nProvide all examples of future studies they recommend be performed.\n\n\n\n#additional information\nIntroduction, methods, results, summary, and conclusion should all be new paragraphs. Your information should read smoothly and make sense. you can utilize bullet points or - if you would like for the individual points within the paragraphs. "
          },
          "promptType": "define"
        },
        "typeVersion": 1.7
      },
      {
        "id": "35c34c88-354b-4018-a66f-5cd2c3e8164a",
        "name": "Converter",
        "type": "n8n-nodes-base.code",
        "position": [
          40,
          0
        ],
        "parameters": {
          "jsCode": "return items.map(item => {\n  const originalPath = $input.first().json.path\n  const convertedPath = originalPath.replace(/\\\\/g, '/');\n  return {\n    json: {\n      ...item.json,\n      convertedPath\n    }\n  };\n});"
        },
        "typeVersion": 2
      },
      {
        "id": "e357d953-e875-46f5-89a8-4c876c3bdd6e",
        "name": "PDF Finder",
        "type": "n8n-nodes-base.readWriteFile",
        "position": [
          240,
          0
        ],
        "parameters": {
          "options": {},
          "fileSelector": "={{ $json.convertedPath }}"
        },
        "typeVersion": 1,
        "alwaysOutputData": true
      },
      {
        "id": "1905ff88-d54a-4435-9ad1-7c1597da57cb",
        "name": "PDF Extractor",
        "type": "n8n-nodes-base.extractFromFile",
        "position": [
          440,
          0
        ],
        "parameters": {
          "options": {},
          "operation": "pdf"
        },
        "typeVersion": 1
      },
      {
        "id": "48726ce0-5978-47f6-9688-7ff675128153",
        "name": "Publisher",
        "type": "n8n-nodes-base.convertToFile",
        "position": [
          1000,
          0
        ],
        "parameters": {
          "options": {},
          "operation": "toText",
          "sourceProperty": "output"
        },
        "typeVersion": 1.1
      },
      {
        "id": "5cc8a81d-3c55-4e8e-bb8c-1dd41e124ce1",
        "name": "Save to Folder",
        "type": "n8n-nodes-base.readWriteFile",
        "position": [
          1200,
          0
        ],
        "parameters": {
          "options": {},
          "operation": "write"
        },
        "typeVersion": 1
      },
      {
        "id": "be22bace-ec61-4494-8c88-8ef00b8624dd",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -80,
          -840
        ],
        "parameters": {
          "color": 5,
          "width": 1320,
          "height": 820,
          "content": "Right click and open local file trigger.\n-Insert the path to your folder.  Open the folder and copy and paste the path at the top.\n-Example C:/Desktop/PDF\n-In the above example, PDF is the name of the folder.\n \nCreate an open ai key:\n-Create an open AI account\n-Go to platform.openai.com/api-keys\n-After creating an account click on your name in the top right corner. Click on your profile.\n-On the left side click on API keys.\n-Create new secret key.\n-Give it a name (optional).\n-Create secret key and copy.\n-Open the n8n workflow.\n-Right click and open the OpenAI chat model under Summarizer tools Agent.\n-Click under credential to connect with and click create new credential.\n-Paste the copied API Key in this position in n8n.\n-IMPORTANT: This workflow uses GPT-4o. This cost ~$0.01 per run. You must put money, recommend no more than $5, into your open ai account.\n-Click on your profile again. On left hand side click on billing.  Add credit to balance.\n \n \n \nRight click on save to folder node.\n-Insert path to folder where you want the summary saved.\n-Example C:/Desktop/Summary/Summary.txt\nTips: you can try saving it as a pdf, but I found saving it as a txt had less errors. \n-You can copy the path again, but you must make sure all \\ are / in the path. This is how n8n interprets the pathway. The trigger node does not matter and should not be changed because the converter node does this automatically.\n \n \nCommon issues:\n-If your first open/read/write files from disk node has an error saying no data, try running n8n as administrator.\n-If running localhost, search command prompt or terminal, before opening right click and choose run as administrator. Then start n8n as you normally would.\n-If the pdf is too large open AI will not be able to summarize it and will have an error that you have reached your limit of requests.\n \n \n \nHow it works:\nYou will have a folder predetermined on your computer. When you find a pdf of a scientific article that you would like a summary of, open n8n and click test workflow. Then save the pdf to the dedicated folder. With n8n running you click test step on the trigger. It will automatically produce a summary of the pdf and save it to a specified folder.\n \nHow to improve:\nIf you have a specific expertise in a field of study, you can customize the output to that field. For example, if you are a marine biologist, you can change the portion of the text prompt in the summarizer tool from \"You are a research expert who is providing data to another researcher.\" to \"You are a marine biologist expert who is providing data to another marine biologist.\""
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "c633a47e-bed2-42fc-a64f-fcb02cb6eae1",
    "connections": {
      "Converter": {
        "main": [
          [
            {
              "node": "PDF Finder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Publisher": {
        "main": [
          [
            {
              "node": "Save to Folder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "PDF Finder": {
        "main": [
          [
            {
              "node": "PDF Extractor",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Summarizer": {
        "main": [
          [
            {
              "node": "Publisher",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "PDF Extractor": {
        "main": [
          [
            {
              "node": "Summarizer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Summarizer",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Local File Trigger": {
        "main": [
          [
            {
              "node": "Converter",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "nodes": [
      {
        "id": "73b64763-5e18-4ff1-bb52-ba25a08d3c3a",
        "name": "If params correct",
        "type": "n8n-nodes-base.if",
        "position": [
          500,
          200
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "2e968b41-88f7-4b28-9837-af50ae130979",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "voice_id",
                "rightValue": ""
              },
              {
                "id": "ad961bc9-6db8-4cac-8c63-30930e8beca7",
                "operator": {
                  "type": "string",
                  "operation": "exists",
                  "singleValue": true
                },
                "leftValue": "text",
                "rightValue": ""
              }
            ]
          }
        },
        "typeVersion": 2
      },
      {
        "id": "39079dec-54c5-458e-afa1-56ee5723f3a3",
        "name": "Respond to Webhook",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          960,
          180
        ],
        "parameters": {
          "options": {},
          "respondWith": "binary"
        },
        "typeVersion": 1.1
      },
      {
        "id": "b6a344f4-28ac-41a7-8e6a-a2782a5d1c68",
        "name": "Webhook",
        "type": "n8n-nodes-base.webhook",
        "position": [
          300,
          200
        ],
        "webhookId": "5acc6769-6c0f-42a8-a69c-b05e437e18a9",
        "parameters": {
          "path": "generate-voice",
          "options": {},
          "httpMethod": "POST",
          "responseMode": "responseNode"
        },
        "typeVersion": 2
      },
      {
        "id": "a25dec72-152b-4457-a18f-9cbbd31840ec",
        "name": "Generate voice",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          740,
          180
        ],
        "parameters": {
          "url": "=https://api.elevenlabs.io/v1/text-to-speech/{{ $json.body.voice_id }}",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n  \"text\":  \"{{ $json.body.text }}\"\n} ",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpCustomAuth",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "credentials": {
          "httpCustomAuth": {
            "id": "nhkU37chaiBU6X3j",
            "name": "Custom Auth account"
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "e862955e-76d9-4a24-9501-0d5eb8fbe778",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          280,
          -360
        ],
        "parameters": {
          "width": 806.0818150700699,
          "height": 495.17470523089514,
          "content": "## Generate Text-to-Speech Using Elevenlabs via API\nThis workflow provides an API endpoint to generate speech from text using [Elevenlabs.io](https://elevenlabs.io/), a popular text-to-speech service.\n\n### Step 1: Configure Custom Credentials in n8n\nTo set up your credentials in n8n, create a new custom authentication entry with the following JSON structure:\n```json\n{\n  \"headers\": {\n    \"xi-api-key\": \"your-elevenlabs-api-key\"\n  }\n}\n```\nReplace `\"your-elevenlabs-api-key\"` with your actual Elevenlabs API key.\n\n### Step 2: Send a POST Request to the Webhook\nSend a POST request to the workflow's webhook endpoint with these two parameters:\n- `voice_id`: The ID of the voice from Elevenlabs that you want to use.\n- `text`: The text you want to convert to speech.\n\nThis workflow has been a significant time-saver in my video production tasks. I hope it proves just as useful to you!\n\nHappy automating!  \nThe n8Ninja"
        },
        "typeVersion": 1
      },
      {
        "id": "275ca523-8b43-4723-9dc4-f5dc1832fcd1",
        "name": "Error",
        "type": "n8n-nodes-base.respondToWebhook",
        "position": [
          740,
          360
        ],
        "parameters": {
          "options": {},
          "respondWith": "json",
          "responseBody": "{\n  \"error\": \"Invalid inputs.\"\n}"
        },
        "typeVersion": 1.1
      }
    ],
    "pinData": {},
    "connections": {
      "Webhook": {
        "main": [
          [
            {
              "node": "If params correct",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate voice": {
        "main": [
          [
            {
              "node": "Respond to Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If params correct": {
        "main": [
          [
            {
              "node": "Generate voice",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Error",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  },
  {
    "id": "",
    "meta": {
      "instanceId": "",
      "templateCredsSetupCompleted": true
    },
    "name": "YTB Metadata Generator",
    "tags": [],
    "nodes": [
      {
        "id": "",
        "name": "Mistral Cloud Chat Model",
        "type": "@n8n/n8n-nodes-langchain.lmChatMistralCloud",
        "position": [
          700,
          -40
        ],
        "parameters": {
          "model": "mistral-large-latest",
          "options": {}
        },
        "credentials": {
          "mistralCloudApi": {
            "id": "",
            "name": "Mistral Cloud account"
          }
        },
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "No Operation, do nothing",
        "type": "n8n-nodes-base.noOp",
        "position": [
          -440,
          120
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "Structured Output Parser",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          860,
          -40
        ],
        "parameters": {
          "jsonSchemaExample": "[\n  {\n    \"name\": \"preview\",\n    \"type\": \"string\",\n    \"description\": \"Short preview (100–200 characters, no hashtags)\"\n  },\n  {\n    \"name\": \"timestamps\",\n    \"type\": \"string\",\n    \"description\": \"YouTube-style timestamps, each on a new line, starts with 00:00\"\n  },\n  {\n    \"name\": \"tags\",\n    \"type\": \"string\",\n    \"description\": \"Comma-separated keywords (no hashtags)\"\n  }\n]\n"
        },
        "typeVersion": 1.2
      },
      {
        "id": "",
        "name": "No Operation, do nothing1",
        "type": "n8n-nodes-base.noOp",
        "position": [
          700,
          100
        ],
        "parameters": {},
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "Check IF Finished",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -160,
          -80
        ],
        "parameters": {
          "url": "https://api.apify.com/v2/acts/streamers~youtube-scraper/runs/last?token=[YOUR_API_TOKEN]",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "",
        "name": "Get DataSet",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          240,
          -100
        ],
        "parameters": {
          "url": "https://api.apify.com/v2/acts/streamers~youtube-scraper/runs/last/dataset/items?token=[YOUR_API_TOKEN]",
          "options": {}
        },
        "typeVersion": 4.2
      },
      {
        "id": "",
        "name": "Scrape Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -440,
          -80
        ],
        "parameters": {
          "url": "https://api.apify.com/v2/acts/streamers~youtube-scraper/runs?token=[YOUR_API_TOKEN]",
          "method": "POST",
          "options": {},
          "jsonBody": "={\n    \"downloadSubtitles\": true,\n    \"preferAutoGeneratedSubtitles\": false,\n    \"startUrls\": [\n        {\n            \"url\": \"{{ $('Trigger New Video Posted').item.json.link }}\",\n            \"method\": \"GET\"\n        }\n    ],\n    \"subtitlesLanguage\": \"en\"\n}",
          "sendBody": true,
          "sendHeaders": true,
          "specifyBody": "json",
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "typeVersion": 4.2
      },
      {
        "id": "",
        "name": "If Finished",
        "type": "n8n-nodes-base.if",
        "position": [
          20,
          -80
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "",
                "operator": {
                  "name": "filter.operator.equals",
                  "type": "string",
                  "operation": "equals"
                },
                "leftValue": "={{ $json.data.status }}",
                "rightValue": "SUCCEEDED"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "",
        "name": "Wait",
        "type": "n8n-nodes-base.wait",
        "position": [
          180,
          120
        ],
        "webhookId": "",
        "parameters": {},
        "typeVersion": 1.1
      },
      {
        "id": "",
        "name": "If Recent",
        "type": "n8n-nodes-base.if",
        "position": [
          -660,
          20
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "",
                "operator": {
                  "type": "number",
                  "operation": "gt"
                },
                "leftValue": "={{ new Date($json[\"pubDate\"]).getTime() }}",
                "rightValue": "={{ new Date().getTime() - 10 * 60 * 1000 }}"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "",
        "name": "If Not Generated",
        "type": "n8n-nodes-base.if",
        "position": [
          460,
          -100
        ],
        "parameters": {
          "options": {},
          "conditions": {
            "options": {
              "version": 2,
              "leftValue": "",
              "caseSensitive": true,
              "typeValidation": "strict"
            },
            "combinator": "and",
            "conditions": [
              {
                "id": "",
                "operator": {
                  "type": "string",
                  "operation": "notContains"
                },
                "leftValue": "={{ $json.text }}",
                "rightValue": "00:00"
              }
            ]
          }
        },
        "typeVersion": 2.2
      },
      {
        "id": "",
        "name": "Generate Description",
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "position": [
          700,
          -200
        ],
        "parameters": {
          "text": "You are given the full script of a YouTube video. Your task is to extract metadata in a structured format to be used in a YouTube upload.",
          "messages": {
            "messageValues": [
              {
                "type": "HumanMessagePromptTemplate",
                "message": "=Script Input:\n{{ $json.subtitles[0].srt }}\n\nFinal Output Format:\n\nPreview:\n[short preview description]\n\nTimestamps:\n00:00 [Title]\n00:30 [Title]\n...\n\nTags:\ntag1,tag2,tag3,...\n\nFollow these instructions strictly:\n\n1. Short Preview Description\nWrite a short preview (100–200 characters max) of the video.\nUse engaging language, and include relevant keywords from the topic of the video.\nThis should be a single sentence or two, no hashtags, no line breaks.\n\n2. Timestamps\nFormat: MM:SS Timestamp Title (each on a new line)\nMust start with 00:00\nEach timestamp section must be at least 30 seconds apart\nOnly 3 to 7 total timestamps\nEach timestamp title should be maximum 3 words, summarize the section clearly\nExample format:\n\"00:00 Intro  \n00:47 Key Concept  \n02:12 Real Example\"\n\n3. Tags\nProvide 5 to 10 relevant SEO-friendly keywords separated by commas\nNo hashtags\nFormat like this:\n\"automation,n8n,ai workflows,youtube growth,openai\"\n"
              }
            ]
          },
          "promptType": "define",
          "hasOutputParser": true
        },
        "typeVersion": 1.5
      },
      {
        "id": "",
        "name": "Format ",
        "type": "n8n-nodes-base.code",
        "position": [
          1100,
          -200
        ],
        "parameters": {
          "jsCode": "// Assuming input data contains preview, timestamps, tags\nconst preview = $input.first().json.output[0].description;\nconst timestamps = $input.first().json.output[1].description;\n\n// Hardcoded links section (edit as needed)\nconst links = `\nLinks:\n- Website: https://example.com\n- Twitter: https://twitter.com/example\n- GitHub: https://github.com/example\n`;\n\n// Format description string\nconst description = preview + \"\\n\" +links + \"\\n\" +timestamps \n\n// Return the formatted description\nreturn [\n  {\n    json: {\n      description: description.trim(),\n    },\n  },\n];\n"
        },
        "typeVersion": 2
      },
      {
        "id": "",
        "name": "Sticky Note3",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -940,
          -100
        ],
        "parameters": {
          "color": 7,
          "width": 420,
          "height": 340,
          "content": "## 1- Input\nEnter the ID of the YTB channel to trigger the workflow when a new video is posted"
        },
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "Sticky Note",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -500,
          -180
        ],
        "parameters": {
          "color": 7,
          "height": 480,
          "content": "## 2- Create DataSet\nApify scrape the last YTB video of the channel"
        },
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          420,
          -280
        ],
        "parameters": {
          "color": 7,
          "width": 600,
          "height": 580,
          "content": "## 4- Check and Generate Metadata\nVerify if Metadata are not already generated and generate them with LLM\n"
        },
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1040,
          -280
        ],
        "parameters": {
          "color": 7,
          "width": 460,
          "height": 240,
          "content": "## 5- Output\nFormat all the data created and update YTB Video"
        },
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "Sticky Note4",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -240,
          -180
        ],
        "parameters": {
          "color": 7,
          "width": 640,
          "height": 500,
          "content": "## 3- Wait for Completion & Get DataSet\nWait until the dataset is completed in Apify and get it"
        },
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "Sticky Note5",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -940,
          -800
        ],
        "parameters": {
          "color": 7,
          "width": 780,
          "height": 240,
          "content": "## How it works?\n**1 -** Enter the ID of the YTB channel to trigger the workflow when a new video is posted\n**2 -** Apify scrape the last YTB video of the channel\n**3 -** Wait until the dataset is completed in Apify and get it\n**4 -** Verify if Metadata are not already generated and generate them with LLM\n**5 -** Format all the data created and update YTB Video\n\n**📺 Youtube Video Tutorial : https://youtu.be/HaQPAa6l5bU**\n**🛠️ Need Help with Your Workflows ? https://tally.so/r/wayeqB**\n**👨‍💻 More Workflows : https://n8n.io/creators/nasser/**"
        },
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "Sticky Note6",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -940,
          -540
        ],
        "parameters": {
          "color": 7,
          "width": 780,
          "height": 340,
          "content": "## SETUP\n\n**Setup Input YTB Chanel :** Go to the channel's page on YouTube, and look at the URL of the page. The channel ID is the value that comes after channel/ in the URL. Add it after \"?channel_id=\" You can also use free tools available to retrieve channel ID.\n\n**Setup Output YTB Video Update :** Connect your YTB account to your n8n instance thanks to the Google Cloud Console. You can find tutorials by typing \"youtube api Oauth\" on Google.\n\n**APIs :** For the following third-party integrations, replace [YOUR_API_TOKEN] with your API Token or connect your account via Client ID / Secret to your n8n instance : \n- Apify : https://docs.apify.com/api/v2/getting-started\n- Youtube : https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.youtube/?utm_source=n8n_app&utm_medium=node_settings_modal-credential_link&utm_campaign=n8n-nodes-base.youTube#templates-and-examples"
        },
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "Trigger New Video Posted",
        "type": "n8n-nodes-base.rssFeedReadTrigger",
        "position": [
          -880,
          20
        ],
        "parameters": {
          "feedUrl": "https://www.youtube.com/feeds/videos.xml?channel_id=[YOUR_CHANNEL_ID]",
          "pollTimes": {
            "item": [
              {
                "mode": "everyX",
                "unit": "minutes",
                "value": 10
              }
            ]
          }
        },
        "typeVersion": 1
      },
      {
        "id": "",
        "name": "Update YTB Video",
        "type": "n8n-nodes-base.youTube",
        "position": [
          1280,
          -200
        ],
        "parameters": {
          "title": "={{ $('Get DataSet').item.json.title }}",
          "videoId": "={{ $('Get DataSet').item.json.id }}",
          "resource": "video",
          "operation": "update",
          "regionCode": "US",
          "updateFields": {
            "tags": "={{ $('Generate Description').item.json.output[2].description }}",
            "description": "={{ $json.description }}"
          }
        },
        "credentials": {
          "youTubeOAuth2Api": {
            "id": "",
            "name": "YouTube account"
          }
        },
        "typeVersion": 1
      }
    ],
    "active": false,
    "pinData": {},
    "settings": {
      "executionOrder": "v1"
    },
    "versionId": "",
    "connections": {
      "Wait": {
        "main": [
          [
            {
              "node": "Check IF Finished",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format ": {
        "main": [
          [
            {
              "node": "Update YTB Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If Recent": {
        "main": [
          [
            {
              "node": "Scrape Video",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "No Operation, do nothing",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get DataSet": {
        "main": [
          [
            {
              "node": "If Not Generated",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If Finished": {
        "main": [
          [
            {
              "node": "Get DataSet",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Scrape Video": {
        "main": [
          [
            {
              "node": "Check IF Finished",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If Not Generated": {
        "main": [
          [
            {
              "node": "Generate Description",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "No Operation, do nothing1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check IF Finished": {
        "main": [
          [
            {
              "node": "If Finished",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Description": {
        "main": [
          [
            {
              "node": "Format ",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Mistral Cloud Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Generate Description",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Generate Description",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Trigger New Video Posted": {
        "main": [
          [
            {
              "node": "If Recent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    }
  }
]